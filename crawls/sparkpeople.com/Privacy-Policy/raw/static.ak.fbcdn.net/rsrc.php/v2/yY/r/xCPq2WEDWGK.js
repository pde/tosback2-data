/*1344463428,176832697*/

if (window.CavalryLogger) { CavalryLogger.start_js(["bS0QP"]); }

__d("AsyncDOM",["CSS","DOM"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i={invoke:function(j,k){for(var l=0;l<j.length;++l){var m=j[l],n=m[0],o=m[1],p=m[2],q=m[3],r=(p&&k)||null;if(o)r=h.scry(r||document.documentElement,o)[0];switch(n){case 'eval':(new Function(q)).apply(r);break;case 'hide':g.hide(r);break;case 'show':g.show(r);break;case 'setContent':h.setContent(r,q);break;case 'appendContent':h.appendContent(r,q);break;case 'prependContent':h.prependContent(r,q);break;case 'insertAfter':h.insertAfter(r,q);break;case 'insertBefore':h.insertBefore(r,q);break;case 'remove':h.remove(r);break;case 'replace':h.replace(r,q);break;default:}}}};e.exports=i;});
__d("AsyncResponse",["Bootloader","Env","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('Env'),i=b('copyProperties'),j=b('tx');function k(l,m){i(this,{error:0,errorSummary:null,errorDescription:null,onload:null,replay:false,payload:m||null,request:l||null,silentError:false,is_last:true});return this;}i(k,{defaultErrorHandler:function(l){try{if(!l.silentError){k.verboseErrorHandler(l);}else l.logErrorByGroup('silent',10);}catch(m){alert(l);}},verboseErrorHandler:function(l){try{var n=l.getErrorSummary(),o=l.getErrorDescription();l.logErrorByGroup('popup',10);if(l.silentError&&o=='')o="Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.";g.loadModules(['Dialog'],function(p){new p().setTitle(n).setBody(o).setButtons([p.OK]).setModal(true).setCausalElement(this.relativeTo).show();});}catch(m){alert(l);}}});i(k.prototype,{getRequest:function(){return this.request;},getPayload:function(){return this.payload;},getError:function(){return this.error;},getErrorSummary:function(){return this.errorSummary;},setErrorSummary:function(l){l=(l===undefined?null:l);this.errorSummary=l;return this;},getErrorDescription:function(){return this.errorDescription;},getErrorIsWarning:function(){return this.errorIsWarning;},logError:function(l,m){if(window.send_error_signal){var n={err_code:this.error,vip:(h.vip||'-')};if(m){n.duration=m.duration;n.xfb_ip=m.xfb_ip;}var o=this.request.getURI();n.path=o||'-';n.aid=this.request.userActionID;if(o&&o.indexOf('scribe_endpoint.php')!=-1)l='async_error_double';send_error_signal(l,JSON.stringify(n));}},logErrorByGroup:function(l,m){if(Math.floor(Math.random()*m)==0)if(this.error==1357010||this.error<15000){this.logError('async_error_oops_'+l);}else this.logError('async_error_logic_'+l);}});e.exports=k;});
__d("HTTPErrors",[],function(a,b,c,d,e,f){var g={get:bagofholding,getAll:bagofholding};e.exports=g;});
__d("AsyncRequest",["event-extensions","Arbiter","AsyncDOM","AsyncResponse","Bootloader","CSS","Env","HTTPErrors","JSCC","Parent","Run","ServerJS","URI","UserAgent","XHR","bind","copyProperties","evalGlobal","ge","goURI","isEmpty","tx"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncDOM'),i=b('AsyncResponse'),j=b('Bootloader'),k=b('CSS'),l=b('Env'),m=b('HTTPErrors'),n=b('JSCC'),o=b('Parent'),p=b('Run'),q=b('ServerJS'),r=b('URI'),s=b('UserAgent'),t=b('XHR'),u=b('bind'),v=b('copyProperties'),w=b('evalGlobal'),x=b('ge'),y=b('goURI'),z=b('isEmpty'),aa=b('tx');function ba(){try{return !window.loaded;}catch(ka){return true;}}function ca(ka){return ('upload' in ka)&&('onprogress' in ka.upload);}function da(ka){return 'withCredentials' in ka;}function ea(ka){return ka.status in {0:1,12029:1,12030:1,12031:1,12152:1};}function fa(ka){var la=!ka||typeof(ka)==='function';return la;}var ga=2,ha=ga;g.subscribe('page_transition',function(ka,la){ha=la.id;});function ia(ka){v(this,{transport:null,method:'POST',uri:'',timeout:null,timer:null,initialHandler:bagofholding,handler:null,uploadProgressHandler:null,errorHandler:null,transportErrorHandler:null,timeoutHandler:null,interceptHandler:bagofholding,finallyHandler:bagofholding,abortHandler:bagofholding,serverDialogCancelHandler:null,relativeTo:null,statusElement:null,statusClass:'',data:{},file:null,context:{},readOnly:false,writeRequiredParams:[],remainingRetries:0,userActionID:'-'});this.option={asynchronous:true,suppressErrorHandlerWarning:false,suppressEvaluation:false,suppressErrorAlerts:false,retries:0,jsonp:false,bundle:false,useIframeTransport:false,handleErrorAfterUnload:false};this.errorHandler=i.defaultErrorHandler;this.transportErrorHandler=u(this,'errorHandler');if(ka!==undefined)this.setURI(ka);}v(ia,{bootstrap:function(ka,la,ma){var na='GET',oa=true,pa={};if(ma||la&&(la.rel=='async-post'||la.getAttribute&&la.getAttribute('forcemethod')=='post')){na='POST';oa=false;if(ka){ka=r(ka);pa=ka.getQueryData();ka.setQueryData({});}}var qa=o.byClass(la,'stat_elem')||la;if(qa&&k.hasClass(qa,'async_saving'))return false;var ra=new ia(ka).setReadOnly(oa).setMethod(na).setData(pa).setNectarModuleDataSafe(la).setRelativeTo(la);if(la){ra.setHandler(function(ta){Event.fire(la,'success',{response:ta});});ra.setErrorHandler(function(ta){if(Event.fire(la,'error',{response:ta})!==false)i.defaultErrorHandler(ta);});}if(qa){ra.setStatusElement(qa);var sa=qa.getAttribute('data-status-class');sa&&ra.setStatusClass(sa);}if(la)Event.fire(la,'AsyncRequest/send',{request:ra});ra.send();return false;},post:function(ka,la){new ia(ka).setReadOnly(false).setMethod('POST').setData(la).send();return false;},getLastID:function(){return ga;},suppressOnloadToken:{},_inflight:[],_inflightCount:0,_inflightAdd:bagofholding,_inflightPurge:bagofholding,getInflightCount:function(){return this._inflightCount;},_inflightEnable:function(){if(s.ie()){v(ia,{_inflightAdd:function(ka){this._inflight.push(ka);},_inflightPurge:function(){ia._inflight=ia._inflight.filter(function(ka){return ka.transport&&ka.transport.readyState<4;});}});p.onUnload(function(){ia._inflight.forEach(function(ka){if(ka.transport&&ka.transport.readyState<4){ka.transport.abort();delete ka.transport;}});});}}});v(ia.prototype,{_dispatchResponse:function(ka){try{this.clearStatusIndicator();if(!this._isRelevant()){this._invokeErrorHandler(1010);return;}if(this.initialHandler(ka)===false)return;clearTimeout(this.timer);if(ka.jscc_map){var ma=(eval)(ka.jscc_map);n.init(ma);}var na;if(this.handler)try{na=this._shouldSuppressJS(this.handler(ka));}catch(oa){ka.is_last&&this.finallyHandler(ka);throw oa;}if(!na)this._handleJSResponse(ka);ka.is_last&&this.finallyHandler(ka);}catch(la){}},_shouldSuppressJS:function(ka){return ka===ia.suppressOnloadToken;},_handleJSResponse:function(ka){var la=this.getRelativeTo(),ma=ka.domops,na=ka.jsmods,oa=new q().setRelativeTo(la);if(na&&(na.define||na.instances||na.markup)){oa.handle({define:na.define,instances:na.instances,markup:na.markup});delete na.define;delete na.instances;delete na.markup;}if(ma)h.invoke(ma,la);if(na)oa.handle(na);this._handleJSRegisters(ka,'onload');if(this.lid)g.inform('tti_ajax',{s:this.lid,d:[this._sendTimeStamp||0,(this._sendTimeStamp&&this._responseTime)?(this._responseTime-this._sendTimeStamp):0]},g.BEHAVIOR_EVENT);this._handleJSRegisters(ka,'onafterload');},_handleJSRegisters:function(ka,la){var ma=ka[la];if(!ma)return;for(var na=0;na<ma.length;na++)try{(new Function(ma[na])).apply(this);}catch(oa){}},invokeResponseHandler:function(ka){if(typeof(ka.redirect)!=='undefined'){(function(){this.setURI(ka.redirect).send();}).bind(this).defer();return;}if(!this.handler&&!this.errorHandler&&!this.transportErrorHandler)return;if(typeof(ka.asyncResponse)!=='undefined'){if(!this._isRelevant()){this._invokeErrorHandler(1010);return;}var la=ka.asyncResponse;if(la.inlinejs)w(la.inlinejs);if(la.lid){this._responseTime=Date.now();if(a.CavalryLogger)this.cavalry=a.CavalryLogger.getInstance(la.lid);this.lid=la.lid;}j.setResourceMap(la.resource_map);if(la.bootloadable)j.enableBootload(la.bootloadable);var ma;if(la.getError()&&!la.getErrorIsWarning()){var na=this.errorHandler.bind(this);ma=this._dispatchErrorResponse.bind(this,la,na);}else ma=this._dispatchResponse.bind(this,la);ma=ma.defer.bind(ma);var oa=false;if(this.preBootloadHandler)oa=this.preBootloadHandler(la);la.css=la.css||[];la.js=la.js||[];j.loadResources(la.css.concat(la.js),ma,oa,this.getURI());}else if(typeof(ka.transportError)!=='undefined'){if(this._xFbServer){this._invokeErrorHandler(1008);}else this._invokeErrorHandler(1012);}else this._invokeErrorHandler(1007);},_invokeErrorHandler:function(ka){if(ba()&&!this.getOption('handleErrorAfterUnload'))return;var la;if(this.responseText===''){la=1002;}else if(this._requestAborted){la=1011;}else{try{la=ka||this.transport.status||1004;}catch(ma){la=1005;}if(false===navigator.onLine)la=1006;}if(!this.transportErrorHandler)return;var na=this.transportErrorHandler.bind(this),oa,pa,qa=true;if(la===1006){pa="No Network Connection";oa="Your browser appears to be offline. Please check your internet connection and try again.";}else if(la>=300&&la<=399){pa="Redirection";oa="Your access to Facebook was redirected or blocked by a third party at this time, please contact your ISP or reload. ";var ra=this.transport.getResponseHeader("Location");if(ra)y(ra,true);qa=true;}else{pa="Oops";oa="Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.";}!this.getOption('suppressErrorAlerts');var sa=new i(this);v(sa,{error:la,errorSummary:pa,errorDescription:oa,silentError:qa});this._dispatchErrorResponse(sa,na);},_dispatchErrorResponse:function(ka,la){var ma=ka.getError();try{this.clearStatusIndicator();var oa=this._sendTimeStamp&&{duration:Date.now()-this._sendTimeStamp,xfb_ip:this._xFbServer||'-'};ka.logError('async_error',oa);if(!this._isRelevant()||ma===1010){this.abort();return;}if(ma==1357008||ma==1357007||ma==1442002||ma==1357001){var pa=ma==1357008||ma==1357007;this.interceptHandler(ka);this._displayServerDialog(ka,pa);}else if(this.initialHandler(ka)!==false){clearTimeout(this.timer);try{la(ka);}catch(qa){this.finallyHandler(ka);throw qa;}this.finallyHandler(ka);}}catch(na){}},_displayServerDialog:function(ka,la){var ma=ka.getPayload();if(ma.__dialog!==undefined){this._displayServerLegacyDialog(ka,la);return;}var na=ma.__dialogx;new q().handle(na);j.loadModules(['ConfirmationDialog'],function(oa){oa.setupConfirmation(ka,this);}.bind(this));},_displayServerLegacyDialog:function(ka,la){var ma=ka.getPayload().__dialog;j.loadModules(['Dialog'],function(na){var oa=new na(ma);if(la)oa.setHandler(this._displayConfirmationHandler.bind(this,oa));oa.setCancelHandler(function(){var pa=this.getServerDialogCancelHandler();try{pa&&pa(ka);}catch(qa){throw qa;}finally{this.finallyHandler(ka);}}.bind(this)).setCausalElement(this.relativeTo).show();}.bind(this));},_displayConfirmationHandler:function(ka){this.data.confirmed=1;v(this.data,ka.getFormData());this.send();},_handleJSONPResponse:function(ka){this.is_first=(this.is_first===undefined);var la=this._interpretResponse(ka);la.asyncResponse.is_first=this.is_first;la.asyncResponse.is_last=this.transport.hasFinished();this.invokeResponseHandler(la);if(this.transport.hasFinished())delete this.transport;},_handleXHRResponse:function(ka){var la;if(this.getOption('suppressEvaluation')){la={asyncResponse:new i(this,ka)};}else{var ma=ka.responseText,na=null;try{var pa=this._unshieldResponseText(ma);try{var qa=(eval)('('+pa+')');la=this._interpretResponse(qa);}catch(oa){na='excep';la={transportError:'eval() failed on async to '+this.getURI()};}}catch(oa){na='empty';la={transportError:oa.message};}if(na)a.send_error_signal&&a.send_error_signal('async_xport_resp',[(this._xFbServer?'1008_':'1012_')+na,this._xFbServer||'-',this.getURI(),ma.length,ma.substr(0,1600)].join(':'));}this.invokeResponseHandler(la);},_unshieldResponseText:function(ka){var la="for (;;);",ma=la.length;if(ka.length<=ma)throw new Error('Response too short on async to '+this.getURI());var na=0;while(ka.charAt(na)==" "||ka.charAt(na)=="\n")na++;na&&ka.substring(na,na+ma)==la;return ka.substring(na+ma);},_interpretResponse:function(ka){if(ka.redirect)return {redirect:ka.redirect};var la=new i(this);if(ka.__ar!=1){la.payload=ka;}else v(la,ka);return {asyncResponse:la};},_onStateChange:function(){try{if(this.transport.readyState==4){ia._inflightCount--;ia._inflightPurge();try{if(typeof(this.transport.getResponseHeader)!=='undefined'&&this.transport.getResponseHeader('X-FB-Debug'))this._xFbServer=this.transport.getResponseHeader('X-FB-Debug');}catch(la){}if(this.transport.status>=200&&this.transport.status<300){ia.lastSuccessTime=Date.now();this._handleXHRResponse(this.transport);}else if(s.safari()&&(typeof(this.transport.status)=='undefined')){this._invokeErrorHandler(1002);}else if(l.retry_ajax_on_network_error&&ea(this.transport)&&this.remainingRetries>0){this.remainingRetries--;delete this.transport;this.send(true);return;}else this._invokeErrorHandler();if(this.getOption('asynchronous')!==false)delete this.transport;}}catch(ka){if(ba())return;delete this.transport;if(this.remainingRetries>0){this.remainingRetries--;this.send(true);}else{!this.getOption('suppressErrorAlerts');a.send_error_signal&&a.send_error_signal('async_xport_resp',[1007,this._xFbServer||'-',this.getURI(),ka.message].join(':'));this._invokeErrorHandler(1007);}}},_isMultiplexable:function(){if(this.getOption('jsonp')||this.getOption('useIframeTransport'))return false;if(!this.uri.isFacebookURI())return false;if(!this.getOption('asynchronous'))return false;return true;},handleResponse:function(ka){var la=this._interpretResponse(ka);this.invokeResponseHandler(la);},setMethod:function(ka){this.method=ka.toString().toUpperCase();return this;},getMethod:function(){return this.method;},setData:function(ka){this.data=ka;return this;},_setDataHash:function(){if(this.method!='POST'||this.data.phstamp)return;var ka=r.implodeQuery(this.data).length,la='';for(var ma=0;ma<this.data.fb_dtsg.length;ma++)la+=this.data.fb_dtsg.charCodeAt(ma);this.data.phstamp='1'+la+ka;},setRawData:function(ka){this.rawData=ka;return this;},getData:function(){return this.data;},setContextData:function(ka,la,ma){ma=ma===undefined?true:ma;if(ma)this.context['_log_'+ka]=la;return this;},_setUserActionID:function(){var ka=a.ArbiterMonitor&&a.ArbiterMonitor.getUE()||'-';this.userActionID=(a.EagleEye&&a.EagleEye.getSessionID()||'-')+'/'+ka;},setURI:function(ka){var la=r(ka);if(this.getOption('useIframeTransport')&&!la.isFacebookURI())return this;if(!this._allowCrossOrigin&&!this.getOption('jsonp')&&!this.getOption('useIframeTransport')&&!la.isSameOrigin())return this;this._setUserActionID();if(!ka||la.isEmpty()){if(a.send_error_signal&&a.get_error_stack){var ma={err_code:1013,vip:'-',duration:0,xfb_ip:'-',path:window.location.href,aid:this.userActionID};a.send_error_signal('async_error',JSON.stringify(ma));a.send_error_signal('async_xport_stack',[1013,window.location.href,null,a.get_error_stack()].join(':'));}return this;}this.uri=la;return this;},getURI:function(){return this.uri.toString();},setInitialHandler:function(ka){this.initialHandler=ka;return this;},setHandler:function(ka){if(fa(ka))this.handler=ka;return this;},getHandler:function(){return this.handler;},setUploadProgressHandler:function(ka){if(fa(ka))this.uploadProgressHandler=ka;return this;},setErrorHandler:function(ka){if(fa(ka))this.errorHandler=ka;return this;},setTransportErrorHandler:function(ka){this.transportErrorHandler=ka;return this;},getErrorHandler:function(){return this.errorHandler;},getTransportErrorHandler:function(){return this.transportErrorHandler;},setTimeoutHandler:function(ka,la){if(fa(la)){this.timeout=ka;this.timeoutHandler=la;}return this;},resetTimeout:function(ka){if(!(this.timeoutHandler===null))if(ka===null){this.timeout=null;clearTimeout(this.timer);this.timer=null;}else{var la=!this._allowCrossPageTransition;this.timeout=ka;clearTimeout(this.timer);this.timer=this._handleTimeout.bind(this).defer(this.timeout,la);}return this;},_handleTimeout:function(){this.abandon();this.timeoutHandler(this);},setNewSerial:function(){this.id=++ga;return this;},setInterceptHandler:function(ka){this.interceptHandler=ka;return this;},setFinallyHandler:function(ka){this.finallyHandler=ka;return this;},setAbortHandler:function(ka){this.abortHandler=ka;return this;},getServerDialogCancelHandler:function(){return this.serverDialogCancelHandler;},setServerDialogCancelHandler:function(ka){this.serverDialogCancelHandler=ka;return this;},setPreBootloadHandler:function(ka){this.preBootloadHandler=ka;return this;},setReadOnly:function(ka){if(!(typeof(ka)!='boolean'))this.readOnly=ka;return this;},setFBMLForm:function(){this.writeRequiredParams=["fb_sig"];return this;},getReadOnly:function(){return this.readOnly;},setRelativeTo:function(ka){this.relativeTo=ka;return this;},getRelativeTo:function(){return this.relativeTo;},setStatusClass:function(ka){this.statusClass=ka;return this;},setStatusElement:function(ka){this.statusElement=ka;return this;},getStatusElement:function(){return x(this.statusElement);},_isRelevant:function(){if(this._allowCrossPageTransition)return true;if(!this.id)return true;return this.id>ha;},clearStatusIndicator:function(){var ka=this.getStatusElement();if(ka){k.removeClass(ka,'async_saving');k.removeClass(ka,this.statusClass);}},addStatusIndicator:function(){var ka=this.getStatusElement();if(ka){k.addClass(ka,'async_saving');k.addClass(ka,this.statusClass);}},specifiesWriteRequiredParams:function(){return this.writeRequiredParams.every(function(ka){this.data[ka]=this.data[ka]||l[ka]||(x(ka)||{}).value;if(this.data[ka]!==undefined)return true;return false;},this);},setOption:function(ka,la){if(typeof(this.option[ka])!='undefined')this.option[ka]=la;return this;},getOption:function(ka){typeof(this.option[ka])=='undefined';return this.option[ka];},abort:function(){if(this.transport){var ka=this.getTransportErrorHandler();this.setOption('suppressErrorAlerts',true);this.setTransportErrorHandler(bagofholding);this._requestAborted=true;this.transport.abort();this.setTransportErrorHandler(ka);}this.abortHandler();},abandon:function(){clearTimeout(this.timer);this.setOption('suppressErrorAlerts',true).setHandler(bagofholding).setErrorHandler(bagofholding).setTransportErrorHandler(bagofholding);if(this.transport){this._requestAborted=true;this.transport.abort();}},setNectarData:function(ka){if(ka){if(this.data.nctr===undefined)this.data.nctr={};v(this.data.nctr,ka);}return this;},setNectarModuleDataSafe:function(ka){if(this.setNectarModuleData)this.setNectarModuleData(ka);return this;},setNectarImpressionIdSafe:function(){if(this.setNectarImpressionId)this.setNectarImpressionId();return this;},setAllowCrossPageTransition:function(ka){this._allowCrossPageTransition=!!ka;if(this.timer)this.resetTimeout(this.timeout);return this;},setAllowCrossOrigin:function(ka){this._allowCrossOrigin=!!ka;return this;},send:function(ka){ka=ka||false;if(!this.uri)return false;!this.errorHandler&&!this.getOption('suppressErrorHandlerWarning');if(this.getOption('jsonp')&&this.method!='GET')this.setMethod('GET');if(this.getOption('useIframeTransport')&&this.method!='GET')this.setMethod('GET');this.timeoutHandler!==null&&(this.getOption('jsonp')||this.getOption('useIframeTransport'));if(!this.getReadOnly()){this.specifiesWriteRequiredParams();if(this.method!='POST')return false;}v(this.data,t.getAsyncParams(this.method));if(!z(this.context)){v(this.data,this.context);this.data.ajax_log=1;}if(l.force_param)v(this.data,l.force_param);this._setUserActionID();if(this.getOption('bundle')&&this._isMultiplexable()){ja.schedule(this);return true;}this.setNewSerial();if(!this.getOption('asynchronous'))this.uri.addQueryData({__s:1});this.finallyHandler=a.async_callback(this.finallyHandler,'final');var la,ma;if(this.method=='GET'||this.rawData){la=this.uri.addQueryData(this.data).toString();ma=this.rawData||'';}else{la=this.uri.toString();this._setDataHash();ma=r.implodeQuery(this.data);}if(this.transport)return false;if(this.getOption('jsonp')||this.getOption('useIframeTransport')){d(['JSONPTransport'],function(qa){this.transport=new qa(this.getOption('jsonp')?'jsonp':'iframe',this.uri,this._handleJSONPResponse.bind(this));this.transport.send();}.bind(this));return true;}var na=t.create();if(!na)return false;na.onreadystatechange=a.async_callback(this._onStateChange.bind(this),'xhr');if(this.uploadProgressHandler&&ca(na))na.upload.onprogress=this.uploadProgressHandler.bind(this);if(!ka)this.remainingRetries=this.getOption('retries');if(a.send_error_signal||a.ArbiterMonitor)this._sendTimeStamp=this._sendTimeStamp||Date.now();this.transport=na;try{this.transport.open(this.method,la,this.getOption('asynchronous'));}catch(oa){return false;}var pa=l.svn_rev;if(pa)this.transport.setRequestHeader('X-SVN-Rev',String(pa));if(!this.uri.isSameOrigin()&&!this.getOption('jsonp')&&!this.getOption('useIframeTransport')){if(!da(this.transport))return false;if(this.uri.isFacebookURI())this.transport.withCredentials=true;}if(this.method=='POST'&&!this.rawData)this.transport.setRequestHeader('Content-Type','application/x-www-form-urlencoded');this.addStatusIndicator();this.transport.send(ma);if(this.timeout!==null)this.resetTimeout(this.timeout);ia._inflightCount++;ia._inflightAdd(this);return true;}});function ja(){this._requests=[];}v(ja,{multiplex:null,schedule:function(ka){if(!ja.multiplex){ja.multiplex=new ja();(function(){ja.multiplex.send();ja.multiplex=null;}).defer();}ja.multiplex.add(ka);}});v(ja.prototype,{add:function(ka){this._requests.push(ka);},send:function(){var ka=this._requests;if(!ka.length)return;var la;if(ka.length===1){la=ka[0];}else{var ma=ka.map(function(na){return [na.uri.getPath(),r.implodeQuery(na.data)];});la=new ia('/ajax/proxy.php').setAllowCrossPageTransition(true).setData({data:ma}).setHandler(this._handler.bind(this)).setTransportErrorHandler(this._transportErrorHandler.bind(this));}la.setOption('bundle',false).send();},_handler:function(ka){var la=ka.getPayload().responses;if(la.length!==this._requests.length)return;for(var ma=0;ma<this._requests.length;ma++){var na=this._requests[ma],oa=na.uri.getPath();na.id=this.id;if(la[ma][0]!==oa){na.invokeResponseHandler({transportError:'Wrong response order in bundled request to '+oa});continue;}na.handleResponse(la[ma][1]);}},_transportErrorHandler:function(ka){var la={transportError:ka.errorDescription},ma=this._requests.map(function(na){na.id=this.id;na.invokeResponseHandler(la);return na.uri.getPath();});}});e.exports=ia;});
__d("legacy:async",["AsyncRequest","AsyncResponse"],function(a,b,c,d){a.AsyncRequest=b('AsyncRequest');a.AsyncResponse=b('AsyncResponse');},3);
__d("legacy:css",["CSS"],function(a,b,c,d){a.CSS=b('CSS');},3);
__d("legacy:data-store",["DataStore"],function(a,b,c,d){a.DataStore=a.DataStore||b('DataStore');},3);
function EmuController(a,b){this.impression=b;this.containerId=a;DataStore.set($(a),'emuController',this);return this;}copyProperties(EmuController,{fromContainer:function(a){var b=ge(a);if(!b)return null;return DataStore.get(b,'emuController');},getEventClass:function(a){return "emuEvent"+String(a).trim();}});copyProperties(EmuController.prototype,{EVENT_HANDLER_PATH:'/ajax/emu/end.php',CLICK:1,FAN:"fad_fan",event:function(a,b,c,d){var e={eid:this.impression,f:0,ui:this.containerId,en:a,a:1};if(b)e.ed=JSON.stringify(b);if(!d)var d=bagofholding;var f=new AsyncRequest().setURI(this.EVENT_HANDLER_PATH).setData(e).setErrorHandler(d);if(c)f.setHandler(c);f.send();},redirect:function(){var a={eid:this.impression,f:0,ui:this.containerId,en:this.CLICK,a:0,sig:Math.floor(Math.random()*65535)+65536},b=new URI(this.EVENT_HANDLER_PATH);b.setQueryData(a);goURI(b);}});
var ShortClickHandlers={EVENT_NAME_CAME_BACK:'cameback',onclicked:function(a){if(this.onsite)return;if(a.button!==0||a.getModifiers().any)return;this.click_ts=(+new Date());if(this.listeners!==undefined)for(var b in this.listeners)this.listeners[b].remove();this.listeners={focus:Event.listen(window,'focus',ShortClickHandlers.oncameback.bind(this))};},oncameback:function(a){var b=(+new Date())-this.click_ts;this.listeners[a.type].remove();var c={click_ts:this.click_ts,length:b,trigger:a.type};this.sendData(ShortClickHandlers.EVENT_NAME_CAME_BACK,c);}};
function EmuTracker(a,b){this.base=EmuController.fromContainer(a);!this.base;this.onsite=b;var c=DOM.scry($(a),"a."+EmuController.getEventClass(EmuTracker.EVENT_CLICK));c.forEach(function(d){Event.listen(d,'click',ShortClickHandlers.onclicked.bind(this));}.bind(this));return this;}copyProperties(EmuTracker,{EVENT_CLICK:1});copyProperties(EmuTracker.prototype,{sendData:function(a,b){this.base.event(a,b);}});
__d("legacy:event-extensions",["event-extensions"],function(a,b,c,d){b('event-extensions');},3);
function BassWhitespaceListener(a,b){this.link=b;Event.listen(a,'click',this.onclicked.bind(this));}copyProperties(BassWhitespaceListener.prototype,{onclicked:function(a){if(Parent.byTag(a.getTarget(),'A'))return;switch(this.link.getAttribute('rel')){case 'async':Bootloader.loadComponents('async',function(){AsyncRequest.bootstrap(this.link.getAttribute('ajaxify'),this.link);}.bind(this));break;case 'theater':var b=Parent.byClass(a.getTarget(),'fbPhotoSnowlift');Bootloader.loadComponents('PhotoViewer',function(){PhotoViewer.bootstrap(this.link.getAttribute('ajaxify'),this.link);}.bind(this));if(b)return false;break;default:goURI(this.link.getAttribute('href'));}}});
__d("GenderConst",[],function(a,b,c,d,e,f){var g={UNKNOWN:0,FEMALE_SINGULAR:1,MALE_SINGULAR:2,FEMALE_SINGULAR_GUESS:3,MALE_SINGULAR_GUESS:4,MIXED_SINGULAR:5,MIXED_PLURAL:5,NEUTER_SINGULAR:6,UNKNOWN_SINGULAR:7,FEMALE_PLURAL:8,MALE_PLURAL:9,NEUTER_PLURAL:10,UNKNOWN_PLURAL:11};e.exports=g;});
__d("Button",["event-extensions","CSS","DataStore","DOM","Parent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('DataStore'),i=b('DOM'),j=b('Parent'),k='uiButtonDisabled',l='uiButtonDepressed',m='button:blocker',n='href',o='ajaxify';function p(t,u){var v=h.get(t,m);if(u){if(v){v.remove();h.remove(t,m);}}else if(!v)h.set(t,m,Event.listen(t,'click',bagof(false),Event.Priority.URGENT));}function q(t){var u=j.byClass(t,'uiButton');if(!u)throw new Error('invalid use case');return u;}function r(t){return i.isNodeOfType(t,'a');}var s={getInputElement:function(t){t=q(t);if(r(t))throw new Error('invalid use case');return i.find(t,'input');},isEnabled:function(t){return !g.hasClass(q(t),k);},setEnabled:function(t,u){t=q(t);g.conditionClass(t,k,!u);if(r(t)){var v=t.href,w=t.getAttribute('ajaxify'),x=h.get(t,n,'#'),y=h.get(t,o);if(u){if(!v)t.href=x;if(!w&&y)t.setAttribute('ajaxify',y);}else{if(v&&v!==x)h.set(t,n,v);if(w&&w!==y)h.set(t,o,w);t.removeAttribute('href');t.removeAttribute('ajaxify');}p(t,u);}else{var z=s.getInputElement(t);z.disabled=!u;p(z,u);}},setDepressed:function(t,u){g.conditionClass(q(t),l,u);},isDepressed:function(t){return g.hasClass(q(t),l);},setLabel:function(t,u){t=q(t);if(r(t)){var v=i.find(t,'span.uiButtonText');i.setContent(v,u);}else s.getInputElement(t).value=u;g.conditionClass(t,'uiButtonNoText',!u);},setIcon:function(t,u){if(u&&!i.isNode(u))return;t=q(t);var v=i.scry(t,'.img')[0];if(!u){v&&i.remove(v);return;}g.addClass(u,'customimg');if(v!=u)if(v){i.replace(v,u);}else i.prependContent(t,u);}};e.exports=s;});
__d("DOMControl",["DataStore","$","copyProperties"],function(a,b,c,d,e,f){var g=b('DataStore'),h=b('$'),i=b('copyProperties');function j(k){this.root=h(k);this.updating=false;g.set(k,'DOMControl',this);}i(j.prototype,{getRoot:function(){return this.root;},beginUpdate:function(){if(this.updating)return false;this.updating=true;return true;},endUpdate:function(){this.updating=false;},update:function(k){if(!this.beginUpdate())return this;this.onupdate(k);this.endUpdate();},onupdate:function(k){}});j.getInstance=function(k){return g.get(k,'DOMControl');};e.exports=j;});
__d("Input",["CSS","DOMQuery","DOMControl"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOMQuery'),i=b('DOMControl'),j=function(l){var m=l.getAttribute('maxlength');if(m&&m>0)d(['enforceMaxLength'],function(n){n(l,m);});},k={focus:function(l){try{l.focus();}catch(m){}},isEmpty:function(l){return !(/\S/).test(l.value||'')||g.hasClass(l,'DOMControl_placeholder');},getValue:function(l){return k.isEmpty(l)?'':l.value;},setValue:function(l,m){g.removeClass(l,'DOMControl_placeholder');l.value=m||'';j(l);var n=i.getInstance(l);n&&n.resetHeight&&n.resetHeight();},setPlaceholder:function(l,m){l.setAttribute('aria-label',m);l.setAttribute('placeholder',m);if(l==document.activeElement)return;if(k.isEmpty(l)){g.conditionClass(l,'DOMControl_placeholder',m);l.value=m||'';}},reset:function(l){var m=l!==document.activeElement?(l.getAttribute('placeholder')||''):'';l.value=m;g.conditionClass(l,'DOMControl_placeholder',m);l.style.height='';},setSubmitOnEnter:function(l,m){g.conditionClass(l,'enter_submit',m);},getSubmitOnEnter:function(l){return g.hasClass(l,'enter_submit');},setMaxLength:function(l,m){if(m>0){l.setAttribute('maxlength',m);j(l);}else l.removeAttribute('maxlength');}};e.exports=k;});
__d("Form",["event-extensions","AsyncRequest","AsyncResponse","CSS","DOM","DOMPosition","DOMQuery","DataStore","Env","Input","Parent","URI","createArrayFrom","trackReferrer"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h=b('AsyncResponse'),i=b('CSS'),j=b('DOM'),k=b('DOMPosition'),l=b('DOMQuery'),m=b('DataStore'),n=b('Env'),o=b('Input'),p=b('Parent'),q=b('URI'),r=b('createArrayFrom'),s=b('trackReferrer'),t='FileList' in window,u='FormData' in window;function v(x){var y={};q.implodeQuery(x).split('&').forEach(function(z){if(z){var aa=/^([^=]*)(?:=(.*))?$/.exec(z),ba=q.decodeComponent(aa[1]),ca=aa[2]?q.decodeComponent(aa[2]):null;y[ba]=ca;}});return y;}var w={getInputs:function(x){x=x||document;return [].concat(r(l.scry(x,'input')),r(l.scry(x,'select')),r(l.scry(x,'textarea')),r(l.scry(x,'button')));},getSelectValue:function(x){return x.options[x.selectedIndex].value;},setSelectValue:function(x,y){for(var z=0;z<x.options.length;++z)if(x.options[z].value==y){x.selectedIndex=z;break;}},getRadioValue:function(x){for(var y=0;y<x.length;y++)if(x[y].checked)return x[y].value;return null;},getElements:function(x){return r(x.tagName=='FORM'?x.elements:w.getInputs(x));},getAttribute:function(x,y){return (x.getAttributeNode(y)||{}).value||null;},setDisabled:function(x,y){w.getElements(x).forEach(function(z){if(z.disabled!==undefined){var aa=m.get(z,'origDisabledState');if(y){if(aa===undefined)m.set(z,'origDisabledState',z.disabled);z.disabled=y;}else if(aa!==true)z.disabled=false;}});},bootstrap:function(x,y){var z=(w.getAttribute(x,'method')||'GET').toUpperCase();y=p.byTag(y,'button')||y;var aa=p.byClass(y,'stat_elem')||x;if(i.hasClass(aa,'async_saving'))return;if(y&&(y.form!==x||(y.nodeName!='INPUT'&&y.nodeName!='BUTTON')||y.type!='submit')){var ba=l.scry(x,'.enter_submit_target')[0];ba&&(y=ba);}var ca=w.serialize(x,y);w.setDisabled(x,true);var da=w.getAttribute(x,'ajaxify')||w.getAttribute(x,'action');s(x,da);var ea=new g(da);ea.setData(ca).setNectarModuleDataSafe(x).setReadOnly(z=='GET').setMethod(z).setRelativeTo(x).setStatusElement(aa).setInitialHandler(w.setDisabled.curry(x,false)).setHandler(function(fa){Event.fire(x,'success',{response:fa});}).setErrorHandler(function(fa){if(Event.fire(x,'error',{response:fa})!==false)h.defaultErrorHandler(fa);}).setFinallyHandler(w.setDisabled.curry(x,false)).send();},forEachValue:function(x,y,z){w.getElements(x).forEach(function(aa){if(aa.name&&!aa.disabled&&aa.type!=='submit')if(!aa.type||((aa.type==='radio'||aa.type==='checkbox')&&aa.checked)||aa.type==='text'||aa.type==='password'||aa.type==='hidden'||aa.nodeName==='TEXTAREA'){z(aa.type,aa.name,o.getValue(aa));}else if(aa.nodeName==='SELECT'){for(var ba=0,ca=aa.options.length;ba<ca;ba++){var da=aa.options[ba];if(da.selected)z('select',aa.name,da.value);}}else if(t&&aa.type==='file'){var ea=aa.files;for(var fa=0;fa<ea.length;fa++)z('file',aa.name,ea.item(fa));}});if(y&&y.name&&y.type==='submit'&&l.contains(x,y)&&l.isNodeOfType(y,['input','button']))z('submit',y.name,y.value);},createFormData:function(x,y){if(!u)return null;var z=new FormData();if(x)if(l.isNode(x)){w.forEachValue(x,y,function(ca,da,ea){z.append(da,ea);});}else{var aa=v(x);for(var ba in aa)z.append(ba,aa[ba]);}return z;},serialize:function(x,y){var z={};w.forEachValue(x,y,function(aa,ba,ca){if(aa==='file')return;w._serializeHelper(z,ba,ca);});return w._serializeFix(z);},_serializeHelper:function(x,y,z){var aa=Object.prototype.hasOwnProperty,ba=/([^\]]+)\[([^\]]*)\](.*)/.exec(y);if(ba){if(!x[ba[1]]||!aa.call(x,ba[1])){var ca;x[ba[1]]=ca={};if(x[ba[1]]!==ca)return;}var da=0;if(ba[2]===''){while(x[ba[1]][da]!==undefined)da++;}else da=ba[2];if(ba[3]===''){x[ba[1]][da]=z;}else w._serializeHelper(x[ba[1]],da.concat(ba[3]),z);}else x[y]=z;},_serializeFix:function(x){var y=[];for(var z in x){if(x[z] instanceof Object)x[z]=w._serializeFix(x[z]);y.push(z);}if(y.length>0){var aa=0,ba=true;y.sort().forEach(function(da){if(da!=aa++)ba=false;});if(ba){var ca=[];y.forEach(function(da){ca[da]=x[da];});return ca;}}return x;},post:function(x,y,z){var aa=document.createElement('form');aa.action=x.toString();aa.method='POST';aa.style.display='none';if(z)aa.target=z;y.fb_dtsg=n.fb_dtsg;w.createHiddenInputs(y,aa);l.getRootElement().appendChild(aa);aa.submit();return false;},createHiddenInputs:function(x,y,z,aa){z=z||{};var ba=v(x);for(var ca in ba){if(ba[ca]===null)continue;if(z[ca]&&aa){z[ca].value=ba[ca];}else{var da=j.create('input',{type:'hidden',name:ca,value:ba[ca]});z[ca]=da;y.appendChild(da);}}return z;},getFirstElement:function(x,y){y=y||['input[type="text"]','textarea','input[type="password"]','input[type="button"]','input[type="submit"]'];var z=[];for(var aa=0;aa<y.length;aa++){z=l.scry(x,y[aa]);for(var ba=0;ba<z.length;ba++){var ca=z[ba];try{var ea=k.getElementPosition(ca);if(ea.y>0&&ea.x>0)return ca;}catch(da){}}}return null;},focusFirst:function(x){var y=w.getFirstElement(x);if(y){y.focus();return true;}return false;}};e.exports=w;});
__d("AsyncUploadBase",["ArbiterMixin","AsyncRequest","AsyncResponse","Form","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('AsyncResponse'),j=b('Form'),k=b('UserAgent'),l=b('copyProperties');function m(o){this.setURI(o);}m.isSupported=function(){if(k.safari()&&!k.chrome()&&k.windows())return false;return ('FileList' in window)&&('FormData' in window);};l(m.prototype,g,{_limit:10,setAllowCrossOrigin:function(o){this._allowCrossOrigin=!!o;return this;},setData:function(o){this._data=o;return this;},setLimit:function(o){this._limit=o;return this;},setRelativeTo:function(o){this._relativeTo=o;return this;},setStatusElement:function(o){this._statusElement=o;return this;},setURI:function(o){this._uri=o;return this;},_createFileUpload:function(o,p){return new n(o,p);},_parseFiles:function(o){var p={};for(var q in o){var r=o[q];if(Array.isArray(r)){p[q]=r;}else{p[q]=[];if(r instanceof window.FileList){for(var s=0;s<r.length;s++)p[q].push(r.item(s));}else if(r instanceof window.File||r instanceof window.Blob)p[q].push(r);}}return p;},_processQueue:function(){while(this._pending.length<this._limit){if(!this._waiting.length)break;var o=this._waiting.shift();this._processUpload(o);this._pending.push(o);}},_processUpload:function(o){this.inform('start',o);var p=j.createFormData(this._data);if(o.getFile())p.append(o.getName(),o.getFile());new h().setAllowCrossOrigin(this._allowCrossOrigin).setURI(this._uri).setRawData(p).setRelativeTo(this._relativeTo).setStatusElement(this._statusElement).setHandler(this._success.bind(this,o)).setErrorHandler(this._failure.bind(this,o)).setUploadProgressHandler(this._progress.bind(this,o)).setInitialHandler(this._initial.bind(this,o)).send();},_initial:function(o){this.inform('initial',o);},_success:function(o,p){this.inform('success',o.handleSuccess(p));this._complete(o);},_failure:function(o,p){if(this.inform('failure',o.handleFailure(p))!==false)i.defaultErrorHandler(p);this._complete(o);},_progress:function(o,event){this.inform('progress',o.handleProgress(event));},_complete:function(o){this._pending.remove(o);this._processQueue();if(!this._pending.length)this._inFlight=false;}});var n=function(o,p){this._name=o;this._file=p;this._success=null;this._response=null;this._progressEvent=null;};l(n.prototype,{getName:function(){return this._name;},getFile:function(){return this._file;},isComplete:function(){return this._success!==null;},isSuccess:function(){return this._success===true;},getResponse:function(){return this._response;},getProgressEvent:function(){return this._progressEvent;},handleSuccess:function(o){this._success=true;this._response=o;this._progressEvent=null;return this;},handleFailure:function(o){this._success=false;this._response=o;this._progressEvent=null;return this;},handleProgress:function(event){this._progressEvent=event;return this;}});e.exports=m;});
__d("AsyncUploadRequest",["AsyncUploadBase","Class","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncUploadBase'),h=b('Class'),i=b('copyProperties');function j(k){this.parent.construct(this,k);}j.isSupported=function(){return g.isSupported();};h.extend(j,g);i(j.prototype,{setFiles:function(k){this._files=this._parseFiles(k);return this;},send:function(){if(this._inFlight)return;this._inFlight=true;this._uploads=[];for(var k in this._files)this._files[k].forEach(function(l){this._uploads.push(this._createFileUpload(k,l));}.bind(this));if(this._uploads.length){this._waiting=this._uploads.slice(0);this._pending=[];this._processQueue();}else this._processUpload(this._createFileUpload(null,null));},_complete:function(k){this.parent._complete(k);if(!this._pending.length)this.inform('complete',this._uploads);}});e.exports=j;});
__d("JSONPTransport",["DOM","HTML","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('HTML'),i=b('URI'),j=b('copyProperties'),k={},l=2,m='jsonp',n='iframe';function o(p,q,r){this._type=p;this._uri=q;this._handler=r;k[this.getID()]=this;}j(o,{respond:function(p,q,r){var s=k[p];if(s){if(!r)delete k[p];if(s._type==n)q=JSON.parse(JSON.stringify(q));a.async_callback(s.handleResponse.bind(s),'json')(q);}else if(a.logJSError&&!r)a.logJSError('ajax',{error:'UnexpectedJsonResponse',extra:{id:p,uri:(q.payload&&q.payload.uri)||''}});}});j(o.prototype,{getID:function(){return this._id||(this._id=l++);},hasFinished:function(){return !(this.getID() in k);},getRequestURI:function(){return i(this._uri).addQueryData({__a:1,__adt:this.getID()});},createTransportFrame:function(){var p='transport_frame_'+this.getID(),q=h('<iframe class="hidden_elem" name="'+p+'" src="javascript:void(0)" />');return g.appendContent(document.body,q)[0];},send:function(){if(this._type===m){(function(){g.appendContent(document.body,g.create('script',{src:this.getRequestURI().toString(),type:'text/javascript'}));}).bind(this).defer();}else{this._iframe=this.createTransportFrame();this._iframe.src=this.getRequestURI().toString();}},handleResponse:function(p){if(!this._aborted)this._handler(p);if(this.hasFinished())if(this._iframe){g.remove.curry(this._iframe).defer();this._iframe=null;}},abort:function(){this._aborted=true;}});e.exports=o;});
__d("FileForm",["event-extensions","ArbiterMixin","AsyncRequest","AsyncUploadRequest","AsyncResponse","BehaviorsMixin","DataStore","DOMQuery","Env","Form","JSONPTransport","Parent","URI","UserAgent","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('AsyncUploadRequest'),j=b('AsyncResponse'),k=b('BehaviorsMixin'),l=b('DataStore'),m=b('DOMQuery'),n=b('Env'),o=b('Form'),p=b('JSONPTransport'),q=b('Parent'),r=b('URI'),s=b('UserAgent'),t=b('copyProperties');function u(w){var x={},y=m.scry(w,'input[type="file"]');y.forEach(function(z){x[z.name]=z.files;});return x;}function v(w,x,y){if(w.getAttribute('rel')==='async')throw new Error('FileForm cannot be used with Primer forms.');if(w.getAttribute('method').toUpperCase()!=='POST')throw new Error('FileForm must be used with POST forms.');this._form=w;this._form.enctype=this._form.encoding='multipart/form-data';x&&this.enableBehaviors(x);this._options=y||{};this.setAllowCrossOrigin(this._options.allowCrossOrigin);this.setUploadInParallel(this._options.uploadInParallel);this._listener=Event.listen(this._form,'submit',this._submit.bind(this));l.set(this._form,'FileForm',this);}t(v,{EVENTS:['submit','initial','progress','success','failure'],getInstance:function(w){return l.get(w,'FileForm');}});t(v.prototype,g,k,{getRoot:function(){return this._form;},setAllowCrossOrigin:function(w){this._allowCrossOrigin=!!w;return this;},setUploadInParallel:function(w){this._uploadInParallel=!!w;return this;},_submit:function(event){if(this.inform('submit')===false){event.prevent();return;}var w='FormData' in window;if(w)if(!r(this._form.action).isSameOrigin()&&!this._allowCrossOrigin)w=false;return w?this._sendViaXHR(event):this._sendViaFrame(event);},_sendViaFrame:function(event){var w=new h();w.setStatusElement(this._getStatusElement());w.addStatusIndicator();w.setOption('useIframeTransport',true);var x=w.handleResponse.bind(w),y=new p('iframe',this._form.action,x),z=y.createTransportFrame(),aa=y.getRequestURI().addQueryData({__iframe:true,__user:n.user});this._form.setAttribute('action',aa.toString());this._form.setAttribute('target',z.name);w.setURI(aa);w.setHandler(this.success.bind(this,null));w.setErrorHandler(this.failure.bind(this,null));w.setInitialHandler(this.initial.shield(this,null));},_sendViaXHR:function(event){var w;if(this._uploadInParallel&&i.isSupported()){w=new i().setData(o.serialize(this._form)).setFiles(u(this._form));var x=[w.subscribe('progress',function(y,z){this.progress(z,z.getProgressEvent());}.bind(this)),w.subscribe('initial',function(y,z){this.initial(z,z.getResponse());}.bind(this)),w.subscribe('success',function(y,z){this.success(z,z.getResponse());}.bind(this)),w.subscribe('failure',function(y,z){this.failure(z,z.getResponse());return false;}.bind(this)),w.subscribe('complete',function(){while(x.length)x.pop().unsubscribe();})];}else w=new h().setRawData(o.createFormData(this._form)).setHandler(this.success.bind(this,null)).setErrorHandler(this.failure.bind(this,null)).setUploadProgressHandler(this.progress.bind(this,null)).setInitialHandler(this.initial.shield(this,null));w.setAllowCrossOrigin(this._allowCrossOrigin).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();event.prevent();},initial:function(w){return this.inform('initial',{upload:w});},success:function(w,x){var y={response:x,upload:w};if(this.inform('success',y)!==false)Event.fire(this._form,'success',y);},failure:function(w,x){var y={response:x,upload:w};if(this.inform('failure',y)!==false)if(Event.fire(this._form,'error',y)!==false)j.defaultErrorHandler(x);},progress:function(w,event){this.inform('progress',{event:event,upload:w});},destroy:function(){this._listener.remove();this._listener=null;if(isNaN(s.ie())||(s.ie()>8))this._form.encoding=null;this._form.enctype=null;l.remove(this._form,'FileForm');},_getStatusElement:function(){return q.byClass(this._form,'stat_elem')||this._form;}});e.exports=v;});
__d("goOrReplace",["URI","UserAgent"],function(a,b,c,d,e,f){var g=b('URI'),h=b('UserAgent');function i(j,k,l){var m=new g(k);if(j.pathname=='/'&&m.getPath()!='/'&&m.isQuicklingEnabled()){var n=j.search?{}:{q:''};m=new g().setPath('/').setQueryData(n).setFragment(m.getUnqualifiedURI()).toString();k=m.toString();}if(l&&!(h.ie()<8)){j.replace(k);}else if(j.href==k){j.reload();}else j.href=k;}e.exports=i;});
__d("AjaxPipeRequest",["Arbiter","AsyncRequest","BigPipe","DOM","Env","JSCC","ScriptPathState","copyProperties","goOrReplace","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('BigPipe'),j=b('DOM'),k=b('Env'),l=b('JSCC'),m=b('ScriptPathState'),n=b('copyProperties'),o=b('goOrReplace'),p=b('ge'),q;function r(u,v){var w=p(u);if(w){if(!v)w.style.minHeight='600px';for(var x in i.pageletIDs)if(u!==x&&j.contains(w,x)){g.inform('ajaxpipe/clear_pagelet',{pagelet_id:x});l.clearForPagelet(x);delete i.pageletIDs[x];}j.empty(w);}}function s(u,v){var w=p(u);if(w)if(!v)w.style.minHeight='100px';}function t(u,v){this._uri=u;this._query_data=v;this._request=new h();this._canvas_id=null;this._allow_cross_page_transition=true;}n(t.prototype,{setCanvasId:function(u){this._canvas_id=u;return this;},setURI:function(u){this._uri=u;return this;},setData:function(u){this._query_data=u;return this;},getData:function(u){return this._query_data;},setAllowCrossPageTransition:function(u){this._allow_cross_page_transition=u;return this;},setAppend:function(u){this._append=u;return this;},send:function(){var u={ajaxpipe:1,ajaxpipe_token:k.ajaxpipe_token};n(u,m.getParams());m.reset();if(this._pageletCacheMiss)u.pcmiss=1;this._request.setOption('useIframeTransport',true).setURI(this._uri).setData(n(u,this._query_data)).setPreBootloadHandler(this._preBootloadHandler.bind(this)).setInitialHandler(this._onInitialResponse.bind(this)).setHandler(this._onResponse.bind(this)).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(this._allow_cross_page_transition);if(this._automatic){this._relevantRequest=q;}else q=this._request;this._request.send();return this;},_preBootloadFirstResponse:function(u){return false;},_fireDomContentCallback:function(){this._arbiter.inform('ajaxpipe/domcontent_callback',true,g.BEHAVIOR_STATE);},_fireOnloadCallback:function(){this._arbiter.inform('ajaxpipe/onload_callback',true,g.BEHAVIOR_STATE);},_isRelevant:function(u){return this._request==q||(this._automatic&&this._relevantRequest==q)||this._jsNonBlock||this._forceFinish;},_preBootloadHandler:function(u){var v=u.getPayload();if(!v||v.redirect||!this._isRelevant(u))return false;var w=false;if(u.is_first){!this._append&&!this._displayCallback&&r(this._canvas_id,this._constHeight);this._arbiter=new g();w=this._preBootloadFirstResponse(u);this.pipe=new i({arbiter:this._arbiter,rootNodeID:this._canvas_id,lid:this._request.lid,isAjax:true,domContentCallback:this._fireDomContentCallback.bind(this),onloadCallback:this._fireOnloadCallback.bind(this),domContentEvt:'ajaxpipe/domcontent_callback',onloadEvt:'ajaxpipe/onload_callback',jsNonBlock:this._jsNonBlock,forceFinish:this._forceFinish,automatic:this._automatic,displayCallback:this._displayCallback});}return w;},_redirect:function(u){if(u.redirect){if(u.force||!this.isPageActive(u.redirect)){var v=['ajaxpipe','ajaxpipe_token'].concat(this.getSanitizedParameters());o(window.location,URI(u.redirect).removeQueryData(v),true);}else PageTransitions.go(u.redirect,true);return true;}else return false;},isPageActive:function(u){return true;},getSanitizedParameters:function(){return [];},_versionCheck:function(u){return true;},_onInitialResponse:function(u){var v=u.getPayload();if(!this._isRelevant(u))return false;if(!v)return true;if(this._redirect(v)||!this._versionCheck(v))return false;return true;},_processFirstResponse:function(u){var v=u.getPayload();if(p(this._canvas_id)&&v.canvas_class!==null)CSS.setClass(this._canvas_id,v.canvas_class);},setFirstResponseCallback:function(u){this._firstResponseCallback=u;return this;},setFirstResponseHandler:function(u){this._processFirstResponse=u;return this;},_onResponse:function(u){var v=u.payload;if(!this._isRelevant(u))return h.suppressOnloadToken;if(u.is_first){this._processFirstResponse(u);this._firstResponseCallback&&this._firstResponseCallback();v.provides=v.provides||[];v.provides.push('uipage_onload');if(this._append)v.append=this._canvas_id;}if(v){if('content' in v.content&&this._canvas_id!==null&&this._canvas_id!='content'){v.content[this._canvas_id]=v.content.content;delete v.content.content;}if(this._pageletCacheMiss&&u.is_first){v.id=this._pageletCacheMiss.id;v.cacheable=true;v.cache_controller=this._pageletCacheMiss.cache_controller;v.cache_type=this._pageletCacheMiss.cache_type;v.key=this._pageletCacheMiss.key;}this.pipe.onPageletArrive(v);}if(u.is_last)s(this._canvas_id,this._constHeight);return h.suppressOnloadToken;},setNectarModuleDataSafe:function(u){this._request.setNectarModuleDataSafe(u);return this;},setFinallyHandler:function(u){this._request.setFinallyHandler(u);return this;},setErrorHandler:function(u){this._request.setErrorHandler(u);return this;},abort:function(){this._request.abort();if(q==this._request)q=null;this._request=null;return this;},setJSNonBlock:function(u){this._jsNonBlock=u;return this;},setForceFinish:function(u){this._forceFinish=u;return this;},setAutomatic:function(u){this._automatic=u;return this;},setDisplayCallback:function(u){this._displayCallback=u;return this;},setPageletCacheMiss:function(u){this._pageletCacheMiss=u;return this;},setConstHeight:function(u){this._constHeight=u;return this;},getAsyncRequest:function(){return this._request;}});n(t,{getCurrentRequest:function(){return q;},setCurrentRequest:function(u){q=u;}});e.exports=t;});
__d("Animation",["CSS","DOM","Style","UserAgent"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Style'),j=b('UserAgent');function k(l){if(a==this){return new k(l);}else{this.obj=l;this._reset_state();this.queue=[];this.last_attr=null;}}k.resolution=20;k.offset=0;k.prototype._reset_state=function(){this.state={attrs:{},duration:500};};k.prototype.stop=function(){this._reset_state();this.queue=[];return this;};k.prototype._build_container=function(){if(this.container_div){this._refresh_container();return;}if(this.obj.firstChild&&this.obj.firstChild.__animation_refs){this.container_div=this.obj.firstChild;this.container_div.__animation_refs++;this._refresh_container();return;}var l=document.createElement('div');l.style.padding='0px';l.style.margin='0px';l.style.border='0px';l.__animation_refs=1;var m=this.obj.childNodes;while(m.length)l.appendChild(m[0]);this.obj.appendChild(l);this._orig_overflow=this.obj.style.overflow;this.obj.style.overflow='hidden';this.container_div=l;this._refresh_container();};k.prototype._refresh_container=function(){this.container_div.style.height='auto';this.container_div.style.width='auto';this.container_div.style.height=this.container_div.offsetHeight+'px';this.container_div.style.width=this.container_div.offsetWidth+'px';};k.prototype._destroy_container=function(){if(!this.container_div)return;if(!--this.container_div.__animation_refs){var l=this.container_div.childNodes;while(l.length)this.obj.appendChild(l[0]);this.obj.removeChild(this.container_div);}this.container_div=null;this.obj.style.overflow=this._orig_overflow;};k.ATTR_TO=1;k.ATTR_BY=2;k.ATTR_FROM=3;k.prototype._attr=function(l,m,n){l=l.replace(/-[a-z]/gi,function(p){return p.substring(1).toUpperCase();});var o=false;switch(l){case 'background':this._attr('backgroundColor',m,n);return this;case 'margin':m=k.parse_group(m);this._attr('marginBottom',m[0],n);this._attr('marginLeft',m[1],n);this._attr('marginRight',m[2],n);this._attr('marginTop',m[3],n);return this;case 'padding':m=k.parse_group(m);this._attr('paddingBottom',m[0],n);this._attr('paddingLeft',m[1],n);this._attr('paddingRight',m[2],n);this._attr('paddingTop',m[3],n);return this;case 'backgroundColor':case 'borderColor':case 'color':m=k.parse_color(m);break;case 'opacity':m=parseFloat(m,10);break;case 'height':case 'width':if(m=='auto'){o=true;}else m=parseInt(m,10);break;case 'borderWidth':case 'lineHeight':case 'fontSize':case 'marginBottom':case 'marginLeft':case 'marginRight':case 'marginTop':case 'paddingBottom':case 'paddingLeft':case 'paddingRight':case 'paddingTop':case 'bottom':case 'left':case 'right':case 'top':case 'scrollTop':case 'scrollLeft':m=parseInt(m,10);break;default:throw new Error(l+' is not a supported attribute!');}if(this.state.attrs[l]===undefined)this.state.attrs[l]={};if(o)this.state.attrs[l].auto=true;switch(n){case k.ATTR_FROM:this.state.attrs[l].start=m;break;case k.ATTR_BY:this.state.attrs[l].by=true;case k.ATTR_TO:this.state.attrs[l].value=m;break;}};k._get_box_width=function(l){var m=parseInt(i.get(l,'paddingLeft'),10),n=parseInt(i.get(l,'paddingRight'),10),o=parseInt(i.get(l,'borderLeftWidth'),10),p=parseInt(i.get(l,'borderRightWidth'),10);return l.offsetWidth-(m?m:0)-(n?n:0)-(o?o:0)-(p?p:0);};k._get_box_height=function(l){var m=parseInt(i.get(l,'paddingTop'),10),n=parseInt(i.get(l,'paddingBottom'),10),o=parseInt(i.get(l,'borderTopWidth'),10),p=parseInt(i.get(l,'borderBottomWidth'),10);return l.offsetHeight-(m?m:0)-(n?n:0)-(o?o:0)-(p?p:0);};k.prototype.to=function(l,m){if(m===undefined){this._attr(this.last_attr,l,k.ATTR_TO);}else{this._attr(l,m,k.ATTR_TO);this.last_attr=l;}return this;};k.prototype.by=function(l,m){if(m===undefined){this._attr(this.last_attr,l,k.ATTR_BY);}else{this._attr(l,m,k.ATTR_BY);this.last_attr=l;}return this;};k.prototype.from=function(l,m){if(m===undefined){this._attr(this.last_attr,l,k.ATTR_FROM);}else{this._attr(l,m,k.ATTR_FROM);this.last_attr=l;}return this;};k.prototype.duration=function(l){this.state.duration=l?l:0;return this;};k.prototype.checkpoint=function(l,m){if(l===undefined)l=1;this.state.checkpoint=l;this.queue.push(this.state);this._reset_state();this.state.checkpointcb=m;return this;};k.prototype.blind=function(){this.state.blind=true;return this;};k.prototype.hide=function(){this.state.hide=true;return this;};k.prototype.show=function(){this.state.show=true;return this;};k.prototype.ease=function(l){this.state.ease=l;return this;};k.prototype.go=function(){var l=(new Date()).getTime();this.queue.push(this.state);for(var m=0;m<this.queue.length;m++){this.queue[m].start=l-k.offset;if(this.queue[m].checkpoint)l+=this.queue[m].checkpoint*this.queue[m].duration;}k.push(this);return this;};k.prototype._show=function(){g.show(this.obj);};k.prototype._hide=function(){g.hide(this.obj);};k.prototype._frame=function(l){var m=true,n=false,o=false,p;function q(aa){return document.documentElement[aa]||document.body[aa];}for(var r=0;r<this.queue.length;r++){var s=this.queue[r];if(s.start>l){m=false;continue;}if(s.checkpointcb){this._callback(s.checkpointcb,l-s.start);s.checkpointcb=null;}if(s.started===undefined){if(s.show)this._show();for(var t in s.attrs){if(s.attrs[t].start!==undefined)continue;switch(t){case 'backgroundColor':case 'borderColor':case 'color':p=k.parse_color(i.get(this.obj,t=='borderColor'?'borderLeftColor':t));if(s.attrs[t].by){s.attrs[t].value[0]=Math.min(255,Math.max(0,s.attrs[t].value[0]+p[0]));s.attrs[t].value[1]=Math.min(255,Math.max(0,s.attrs[t].value[1]+p[1]));s.attrs[t].value[2]=Math.min(255,Math.max(0,s.attrs[t].value[2]+p[2]));}break;case 'opacity':p=i.getOpacity(this.obj);if(s.attrs[t].by)s.attrs[t].value=Math.min(1,Math.max(0,s.attrs[t].value+p));break;case 'height':p=k._get_box_height(this.obj);if(s.attrs[t].by)s.attrs[t].value+=p;break;case 'width':p=k._get_box_width(this.obj);if(s.attrs[t].by)s.attrs[t].value+=p;break;case 'scrollLeft':case 'scrollTop':p=(this.obj===document.body)?q(t):this.obj[t];if(s.attrs[t].by)s.attrs[t].value+=p;s['last'+t]=p;break;default:p=parseInt(i.get(this.obj,t),10)||0;if(s.attrs[t].by)s.attrs[t].value+=p;break;}s.attrs[t].start=p;}if((s.attrs.height&&s.attrs.height.auto)||(s.attrs.width&&s.attrs.width.auto)){if(j.firefox()<3)o=true;this._destroy_container();for(var t in {height:1,width:1,fontSize:1,borderLeftWidth:1,borderRightWidth:1,borderTopWidth:1,borderBottomWidth:1,paddingLeft:1,paddingRight:1,paddingTop:1,paddingBottom:1})if(s.attrs[t])this.obj.style[t]=s.attrs[t].value+(typeof s.attrs[t].value=='number'?'px':'');if(s.attrs.height&&s.attrs.height.auto)s.attrs.height.value=k._get_box_height(this.obj);if(s.attrs.width&&s.attrs.width.auto)s.attrs.width.value=k._get_box_width(this.obj);}s.started=true;if(s.blind)this._build_container();}var u=(l-s.start)/s.duration;if(u>=1){u=1;if(s.hide)this._hide();}else m=false;var v=s.ease?s.ease(u):u;if(!n&&u!=1&&s.blind)n=true;if(o&&this.obj.parentNode){var w=this.obj.parentNode,x=this.obj.nextSibling;w.removeChild(this.obj);}for(var t in s.attrs)switch(t){case 'backgroundColor':case 'borderColor':case 'color':if(s.attrs[t].start[3]!=s.attrs[t].value[3]){this.obj.style[t]='rgba('+k.calc_tween(v,s.attrs[t].start[0],s.attrs[t].value[0],true)+','+k.calc_tween(v,s.attrs[t].start[1],s.attrs[t].value[1],true)+','+k.calc_tween(v,s.attrs[t].start[2],s.attrs[t].value[2],true)+','+k.calc_tween(v,s.attrs[t].start[3],s.attrs[t].value[3],false)+')';}else this.obj.style[t]='rgb('+k.calc_tween(v,s.attrs[t].start[0],s.attrs[t].value[0],true)+','+k.calc_tween(v,s.attrs[t].start[1],s.attrs[t].value[1],true)+','+k.calc_tween(v,s.attrs[t].start[2],s.attrs[t].value[2],true)+')';break;case 'opacity':i.set(this.obj,'opacity',k.calc_tween(v,s.attrs[t].start,s.attrs[t].value));break;case 'height':case 'width':this.obj.style[t]=v==1&&s.attrs[t].auto?'auto':k.calc_tween(v,s.attrs[t].start,s.attrs[t].value,true)+'px';break;case 'scrollLeft':case 'scrollTop':var y=this.obj===document.body;p=y?q(t):this.obj[t];if(s['last'+t]!==p){delete s.attrs[t];}else{var z=k.calc_tween(v,s.attrs[t].start,s.attrs[t].value,true);if(!y){z=this.obj[t]=z;}else{if(t=='scrollLeft'){a.scrollTo(z,q('scrollTop'));}else a.scrollTo(q('scrollLeft'),z);z=q(t);}s['last'+t]=z;}break;default:this.obj.style[t]=k.calc_tween(v,s.attrs[t].start,s.attrs[t].value,true)+'px';break;}if(u==1){this.queue.splice(r--,1);this._callback(s.ondone,l-s.start-s.duration);}}if(o)w[x?'insertBefore':'appendChild'](this.obj,x);if(!n&&this.container_div)this._destroy_container();return !m;};k.prototype.ondone=function(l){this.state.ondone=l;return this;};k.prototype._callback=function(l,m){if(l){k.offset=m;l.call(this);k.offset=0;}};k.calc_tween=function(l,m,n,o){return (o?parseInt:parseFloat)((n-m)*l+m,10);};k.parse_color=function(l){var m=/^#([a-f0-9]{1,2})([a-f0-9]{1,2})([a-f0-9]{1,2})$/i.exec(l);if(m){return [parseInt(m[1].length==1?m[1]+m[1]:m[1],16),parseInt(m[2].length==1?m[2]+m[2]:m[2],16),parseInt(m[3].length==1?m[3]+m[3]:m[3],16),1];}else{var n=/^rgba? *\(([0-9]+), *([0-9]+), *([0-9]+)(?:, *([0-9]+))?\)$/.exec(l);if(n){return [parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];}else if(l=='transparent'){return [255,255,255,0];}else throw 'Named color attributes are not supported.';}};k.parse_group=function(l){l=l.trim().split(/ +/);if(l.length==4){return l;}else if(l.length==3){return [l[0],l[1],l[2],l[1]];}else if(l.length==2){return [l[0],l[1],l[0],l[1]];}else return [l[0],l[0],l[0],l[0]];};k.push=function(l){if(!k.active)k.active=[];k.active.push(l);if(k.active.length===1){if(!k.requestAnimationFrame){var m=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame;if(m)k.requestAnimationFrame=m.bind(a);}if(k.requestAnimationFrame){k.requestAnimationFrame(k._animate);}else k.timeout=setInterval(k._animate,k.resolution,false);}if(k.requestAnimationFrame)k._updateEndingTimer();k._animate(Date.now(),true);};k._updateEndingTimer=function(){if(!k.requestAnimationFrame)throw new Error('Ending timer only valid with requestAnimationFrame');var l=0;for(var m=0;m<k.active.length;m++){var n=k.active[m];for(var o=0;o<n.queue.length;o++){var p=n.queue[o].start+n.queue[o].duration;if(p>l)l=p;}}if(k.timeout){clearTimeout(k.timeout);delete k.timeout;}var q=Date.now();if(l>q)k.timeout=setTimeout(k._animate.shield(),l-q,false);};k._animate=function(l,m){l=l||Date.now();for(var n=(m===true)?k.active.length-1:0;n<k.active.length;n++)try{if(!k.active[n]._frame(l))k.active.splice(n--,1);}catch(o){k.active.splice(n--,1);}if(k.active.length===0){if(k.timeout){if(k.requestAnimationFrame){clearTimeout(k.timeout);}else clearInterval(k.timeout);delete k.timeout;}}else if(k.requestAnimationFrame)k.requestAnimationFrame(k._animate);};k.ease={};k.ease.begin=function(l){return Math.sin(Math.PI/2*(l-1))+1;};k.ease.end=function(l){return Math.sin(.5*Math.PI*l);};k.ease.both=function(l){return .5*Math.sin(Math.PI*(l-.5))+.5;};k.prependInsert=function(l,m){k.insert(l,m,h.prependContent);};k.appendInsert=function(l,m){k.insert(l,m,h.appendContent);};k.insert=function(l,m,n){i.set(m,'opacity',0);n(l,m);new k(m).from('opacity',0).to('opacity',1).duration(400).go();};e.exports=k;});
__d("CSSSupport",[],function(a,b,c,d,e,f){var g={supportsBorderRadius:function(){var h=['KhtmlBorderRadius','OBorderRadius','MozBorderRadius','WebkitBorderRadius','msBorderRadius','borderRadius'],i=false,j=document.createElement('div');for(var k=h.length;k>=0;k--)if(i=j.style[h[k]]!==undefined)break;g.supportsBorderRadius=bagof(i);return i;}};e.exports=g;});
__d("Keys",[],function(a,b,c,d,e,f){var g={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,COMMA:188};e.exports=g;});
__d("Locale",["Style"],function(a,b,c,d,e,f){var g=b('Style'),h,i={isRTL:function(){if(h===undefined)h=('rtl'===g.get(document.body,'direction'));return h;}};e.exports=i;});
__d("Vector",["event-extensions","DOMDimensions","DOMPosition","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('DOMDimensions'),h=b('DOMPosition'),i=b('copyProperties');function j(k,l,m){i(this,{x:parseFloat(k),y:parseFloat(l),domain:m||'pure'});}i(j.prototype,{toString:function(){return '('+this.x+', '+this.y+')';},add:function(k,l){if(arguments.length==1){if(k.domain!='pure')k=k.convertTo(this.domain);return this.add(k.x,k.y);}var m=parseFloat(k),n=parseFloat(l);return new j(this.x+m,this.y+n,this.domain);},mul:function(k,l){if(typeof l=="undefined")l=k;return new j(this.x*k,this.y*l,this.domain);},sub:function(k,l){if(arguments.length==1){return this.add(k.mul(-1));}else return this.add(-k,-l);},distanceTo:function(k){return this.sub(k).magnitude();},magnitude:function(){return Math.sqrt((this.x*this.x)+(this.y*this.y));},convertTo:function(k){if(k!='pure'&&k!='viewport'&&k!='document')return new j(0,0);if(k==this.domain)return new j(this.x,this.y,this.domain);if(k=='pure')return new j(this.x,this.y);if(this.domain=='pure')return new j(0,0);var l=j.getScrollPosition('document'),m=this.x,n=this.y;if(this.domain=='document'){m-=l.x;n-=l.y;}else{m+=l.x;n+=l.y;}return new j(m,n,k);},setElementPosition:function(k){var l=this.convertTo('document');k.style.left=parseInt(l.x)+'px';k.style.top=parseInt(l.y)+'px';return this;},setElementDimensions:function(k){return this.setElementWidth(k).setElementHeight(k);},setElementWidth:function(k){k.style.width=parseInt(this.x,10)+'px';return this;},setElementHeight:function(k){k.style.height=parseInt(this.y,10)+'px';return this;},scrollElementBy:function(k){if(k==document.body){window.scrollBy(this.x,this.y);}else{k.scrollLeft+=this.x;k.scrollTop+=this.y;}return this;}});i(j,{getEventPosition:function(k,l){l=l||'document';var m=Event.getPosition(k),n=new j(m.x,m.y,'document');return n.convertTo(l);},getScrollPosition:function(k){k=k||'document';var l=h.getScrollPosition();return new j(l.x,l.y,'document').convertTo(k);},getElementPosition:function(k,l){l=l||'document';var m=h.getElementPosition(k);return new j(m.x,m.y,'viewport').convertTo(l);},getElementDimensions:function(k){var l=g.getElementDimensions(k);return new j(l.width,l.height);},getViewportDimensions:function(){var k=g.getViewportDimensions();return new j(k.width,k.height,'viewport');},getDocumentDimensions:function(k){var l=g.getDocumentDimensions(k);return new j(l.width,l.height,'document');},deserialize:function(k){var l=k.split(',');return new j(l[0],l[1]);}});e.exports=j;});
__d("getOverlayZIndex",["Style"],function(a,b,c,d,e,f){var g=b('Style');function h(i,j){j=j||document.body;var k=[];while(i&&i!==j){k.push(i);i=i.parentNode;}if(i!==j)return 0;for(var l=k.length-1;l>=0;l--){var m=k[l];if(g.get(m,'position')!='static'){var n=parseInt(g.get(m,'z-index'),10);if(!isNaN(n))return n;}}return 0;}e.exports=h;});
__d("Dialog",["array-extensions","event-extensions","AjaxPipeRequest","Animation","Arbiter","AsyncRequest","Bootloader","Button","CSS","CSSSupport","DOM","Form","HTML","Input","Keys","Locale","Parent","Run","Style","URI","UserAgent","Vector","bind","copyProperties","createArrayFrom","getObjectValues","getOverlayZIndex","tx"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('AjaxPipeRequest'),h=b('Animation'),i=b('Arbiter'),j=b('AsyncRequest'),k=b('Bootloader'),l=b('Button'),m=b('CSS'),n=b('CSSSupport'),o=b('DOM'),p=b('Form'),q=b('HTML'),r=b('Input'),s=b('Keys'),t=b('Locale'),u=b('Parent'),v=b('Run'),w=b('Style'),x=b('URI'),y=b('UserAgent'),z=b('Vector'),aa=b('bind'),ba=b('copyProperties'),ca=b('createArrayFrom'),da=b('getObjectValues'),ea=b('getOverlayZIndex'),fa=b('tx'),ga=function(){var ia=document.body,ja=document.createElement('div'),ka=document.createElement('div');ia.insertBefore(ja,ia.firstChild);ia.insertBefore(ka,ia.firstChild);ja.style.position='fixed';ja.style.top='20px';var la=ja.offsetTop!==ka.offsetTop;ia.removeChild(ja);ia.removeChild(ka);ga=bagof(la);return la;};function ha(ia){this._show_loading=true;this._auto_focus=true;this._submit_on_enter=false;this._fade_enabled=true;this._onload_handlers=[];this._top=125;this._uniqueID='dialog_'+ha._globalCount++;this._content=null;this._obj=null;this._popup=null;this._overlay=null;this._shim=null;this._causal_elem=null;this._previous_focus=null;this._buttons=[];this._buildDialog();if(ia)this._setFromModel(ia);ha._init();}ba(ha,{OK:{name:'ok',label:"Okay"},CANCEL:{name:'cancel',label:"Cancel",className:'inputaux'},CLOSE:{name:'close',label:"Close"},NEXT:{name:'next',label:"Next"},SAVE:{name:'save',label:"Save"},SUBMIT:{name:'submit',label:"Submit"},CONFIRM:{name:'confirm',label:"Confirm"},DELETE:{name:'delete',label:"Delete"},_globalCount:0,_bottoms:[0],max_bottom:0,_updateMaxBottom:function(){ha.max_bottom=Math.max.apply(Math,ha._bottoms);}});ba(ha,{OK_AND_CANCEL:[ha.OK,ha.CANCEL],_STANDARD_BUTTONS:[ha.OK,ha.CANCEL,ha.CLOSE,ha.SAVE,ha.SUBMIT,ha.CONFIRM,ha.DELETE],SIZE:{WIDE:555,STANDARD:445},_HALO_WIDTH:10,_BORDER_WIDTH:1,_PADDING_WIDTH:10,_PAGE_MARGIN:40,_stack:[],_isUsingCSSBorders:function(){return n.supportsBorderRadius()||y.ie()<7;},newButton:function(ia,ja,ka,la){var ma={name:ia,label:ja};if(ka)ma.className=ka;if(la)ma.handler=la;return ma;},getCurrent:function(){var ia=ha._stack;return ia.length?ia[ia.length-1]:null;},hideCurrent:function(){var ia=ha.getCurrent();ia&&ia.hide();},bootstrap:function(ia,ja,ka,la,ma,na){ja=ja||{};ba(ja,new x(ia).getQueryData());la=la||(ka?'GET':'POST');var oa=u.byClass(na,'stat_elem')||na;if(oa&&m.hasClass(oa,'async_saving'))return false;var pa=new j().setReadOnly(!!ka).setMethod(la).setRelativeTo(na).setStatusElement(oa).setURI(ia).setNectarModuleDataSafe(na).setData(ja),qa=new ha(ma).setCausalElement(na).setAsync(pa);qa.show();return false;},showFromModel:function(ia,ja){var ka=new ha(ia).setCausalElement(ja).show();if(ia.hiding)ka.hide();},_init:function(){this._init=bagofholding;v.onLeave(ha._tearDown.shield(null,false));i.subscribe('page_transition',ha._tearDown.shield(null,true));Event.listen(document.documentElement,'keydown',function(event){if(Event.getKeyCode(event)==s.ESC&&!event.getModifiers().any){if(ha._escape())event.kill();}else if(Event.getKeyCode(event)==s.RETURN&&!event.getModifiers().any)if(ha._enter())event.kill();});Event.listen(window,'resize',function(event){var ia=ha.getCurrent();ia&&ia._resetDialogObj();});},_findButton:function(ia,ja){if(ia)for(var ka=0;ka<ia.length;++ka)if(ia[ka].name==ja)return ia[ka];return null;},_tearDown:function(ia){var ja=ha._stack.slice();for(var ka=ja.length-1;ka>=0;ka--)if((ia&&!ja[ka]._cross_transition)||(!ia&&!ja[ka]._cross_quickling))ja[ka].hide();},_escape:function(){var ia=ha.getCurrent();if(!ia)return false;var ja=ia._semi_modal,ka=ia._buttons;if(!ka.length&&!ja)return false;if(ja&&!ka.length){ia.hide();return true;}var la,ma=ha._findButton(ka,'cancel');if(ia._cancelHandler){ia.cancel();return true;}else if(ma){la=ma;}else if(ka.length==1){la=ka[0];}else return false;ia._handleButton(la);return true;},_enter:function(){var ia=ha.getCurrent();if(!ia||!ia._submit_on_enter)return false;if(document.activeElement!=ia._frame)return false;var ja=ia._buttons;if(!ja)return false;ia._handleButton(ja[0]);return true;},call_or_eval:function(ia,ja,ka){if(!ja)return undefined;ka=ka||{};if(typeof ja=='string'){var la=Object.keys(ka).join(', ');ja=(eval)('({f: function('+la+') { '+ja+'}})').f;}return ja.apply(ia,da(ka));}});ba(ha.prototype,{_cross_quickling:false,_cross_transition:false,_loading:false,_showing:false,show:function(){this._showing=true;if(this._async_request){if(this._show_loading)this.showLoading();}else this._update();return this;},showLoading:function(){this._loading=true;m.addClass(this._frame,'dialog_loading_shown');this._renderDialog();return this;},hide:function(){if(!this._showing&&!this._loading)return this;this._showing=false;if(this._autohide_timeout){clearTimeout(this._autohide_timeout);this._autohide_timeout=null;}if(this._fade_enabled&&ha._stack.length<=1){this._fadeOut();}else this._hide();return this;},cancel:function(){if(!this._cancelHandler||this._cancelHandler()!==false)this.hide();},getRoot:function(){return this._obj;},getBody:function(){return o.scry(this._obj,'div.dialog_body')[0];},getButtonElement:function(ia){if(typeof ia=='string')ia=ha._findButton(this._buttons,ia);if(!ia||!ia.name)return null;var ja=o.scry(this._popup,'input'),ka=function(la){return la.name==ia.name;};return ja.filter(ka)[0]||null;},getContentNode:function(){return o.find(this._content,'div.dialog_content');},getFormData:function(){return p.serialize(this.getContentNode());},setAllowCrossPageTransition:function(ia){this._cross_transition=ia;return this;},setAllowCrossQuicklingNavigation:function(ia){this._cross_quickling=ia;return this;},setShowing:function(){this.show();return this;},setHiding:function(){this.hide();return this;},setTitle:function(ia){var ja=this._nodes.title,ka=this._nodes.title_inner,la=this._nodes.content;o.setContent(ka,this._format(ia||''));m.conditionShow(ja,!!ia);m.conditionClass(la,'dialog_content_titleless',!ia);return this;},setBody:function(ia){o.setContent(this._nodes.body,this._format(ia));return this;},setExtraData:function(ia){this._extra_data=ia;return this;},setReturnData:function(ia){this._return_data=ia;return this;},setShowLoading:function(ia){this._show_loading=ia;return this;},setFullBleed:function(ia){this._full_bleed=ia;this._updateWidth();m.conditionClass(this._obj,'full_bleed',ia);return this;},setCausalElement:function(ia){this._causal_elem=ia;return this;},setUserData:function(ia){this._user_data=ia;return this;},getUserData:function(){return this._user_data;},setAutohide:function(ia){if(ia){if(this._showing){this._autohide_timeout=setTimeout(this.hide.shield(this),ia);}else this._autohide=ia;}else{this._autohide=null;if(this._autohide_timeout){clearTimeout(this._autohide_timeout);this._autohide_timeout=null;}}return this;},setSummary:function(ia){var ja=this._nodes.summary;o.setContent(ja,this._format(ia||''));m.conditionShow(ja,!!ia);return this;},setButtons:function(ia){var ja,ka;if(!(ia instanceof Array)){ja=ca(arguments);}else ja=ia;for(var la=0;la<ja.length;++la)if(typeof ja[la]=='string'){ka=ha._findButton(ha._STANDARD_BUTTONS,ja[la]);ja[la]=ka;}this._buttons=ja;var ma=[];if(ja&&ja.length>0)for(var na=0;na<ja.length;na++){ka=ja[na];var oa=o.create('input',{type:'button',name:ka.name||'',value:ka.label}),pa=o.create('label',{className:'uiButton uiButtonLarge uiButtonConfirm'},oa);if(ka.className){ka.className.split(/\s+/).forEach(function(ra){m.addClass(pa,ra);});if(m.hasClass(pa,'inputaux')){m.removeClass(pa,'inputaux');m.removeClass(pa,'uiButtonConfirm');}if(m.hasClass(pa,'uiButtonSpecial'))m.removeClass(pa,'uiButtonConfirm');}if(ka.icon)o.prependContent(pa,o.create('img',{src:ka.icon,className:'img mrs'}));if(ka.disabled)l.setEnabled(pa,false);Event.listen(oa,'click',this._handleButton.bind(this,ka.name));for(var qa in ka)if(qa.indexOf('data-')===0&&qa.length>5)oa.setAttribute(qa,ka[qa]);ma.push(pa);}o.setContent(this._nodes.buttons,ma);this._updateButtonVisibility();return this;},setButtonsMessage:function(ia){o.setContent(this._nodes.button_message,this._format(ia||''));this._has_button_message=!!ia;this._updateButtonVisibility();return this;},_updateButtonVisibility:function(){var ia=this._buttons.length>0||this._has_button_message;m.conditionShow(this._nodes.button_wrapper,ia);m.conditionClass(this._obj,'omitDialogFooter',!ia);},setClickButtonOnEnter:function(ia,ja){this._clickOnEnterTarget=ia;if(!this._clickOnEnterListener)this._clickOnEnterListener=Event.listen(this._nodes.body,'keypress',function(event){var ka=event.getTarget();if(ka&&ka.id===this._clickOnEnterTarget)if(Event.getKeyCode(event)==s.RETURN){this._handleButton(ja);event.kill();}return true;}.bind(this));return this;},setStackable:function(ia,ja){this._is_stackable=ia;this._shown_while_stacked=ia&&ja;return this;},setHandler:function(ia){this._handler=ia;return this;},setCancelHandler:function(ia){this._cancelHandler=ha.call_or_eval.bind(null,this,ia);return this;},setCloseHandler:function(ia){this._close_handler=ha.call_or_eval.bind(null,this,ia);return this;},clearHandler:function(){return this.setHandler(null);},setPostURI:function(ia,ja){if(ja===undefined)ja=true;if(ja){this.setHandler(this._submitForm.bind(this,'POST',ia));}else this.setHandler(function(){p.post(ia,this.getFormData());this.hide();}.bind(this));return this;},setGetURI:function(ia){this.setHandler(this._submitForm.bind(this,'GET',ia));return this;},setModal:function(ia){this._modal=ia;m.conditionClass(this._obj,'generic_dialog_modal',ia);return this;},setSemiModal:function(ia){if(ia){this.setModal(true);this._semiModalListener=Event.listen(this._obj,'click',function(ja){if(!o.contains(this._popup,ja.getTarget()))this.hide();}.bind(this));}else this._semiModalListener&&this._semiModalListener.remove();this._semi_modal=ia;return this;},setWideDialog:function(ia){this._wide_dialog=ia;this._updateWidth();return this;},setContentWidth:function(ia){this._content_width=ia;this._updateWidth();return this;},setTitleLoading:function(ia){if(ia===undefined)ia=true;var ja=o.find(this._popup,'h2.dialog_title');if(ja)m.conditionClass(ja,'loading',ia);return this;},setSecure:function(ia){m.conditionClass(this._nodes.title,'secure',ia);return this;},setClassName:function(ia){ia.split(/\s+/).forEach(m.addClass.bind(m,this._obj));return this;},setFadeEnabled:function(ia){this._fade_enabled=ia;return this;},setFooter:function(ia){var ja=this._nodes.footer;o.setContent(ja,this._format(ia||''));m.conditionShow(ja,!!ia);return this;},setAutoFocus:function(ia){this._auto_focus=ia;return this;},setTop:function(ia){this._top=ia;this._resetDialogObj();return this;},onloadRegister:function(ia){ca(ia).forEach(function(ja){if(typeof ja=='string')ja=new Function(ja);this._onload_handlers.push(ja.bind(this));}.bind(this));return this;},setAsyncURL:function(ia){return this.setAsync(new j(ia));},setAsync:function(ia){var ja=function(ra){if(this._async_request!=ia)return;this._async_request=null;var sa=ra.getPayload(),ta=sa;if(this._loading)this._showing=true;if(typeof ta=='string'){this.setBody(ta);}else this._setFromModel(ta);this._update();}.bind(this),ka=ia.getData();ka.__d=1;ia.setData(ka);var la=ia.getHandler()||bagofholding;ia.setHandler(function(ra){la(ra);ja(ra);});var ma=ia,na=ma.getErrorHandler()||bagofholding,oa=ma.getTransportErrorHandler()||bagofholding,pa=function(){this._async_request=null;this._loading=false;if(this._showing&&this._shown_while_stacked){this._update();}else this._hide(this._is_stackable);}.bind(this),qa=ma.getServerDialogCancelHandler()||pa;ma.setAllowCrossPageTransition(this._cross_transition).setErrorHandler(function(ra){pa();na(ra);}).setTransportErrorHandler(function(ra){pa();oa(ra);}).setServerDialogCancelHandler(qa);ia.send();this._async_request=ia;if(this._showing)this.show();return this;},_format:function(ia){if(typeof ia=='string'){ia=q(ia);}else ia=q.replaceJSONWrapper(ia);if(ia instanceof q)ia.setDeferred(true);return ia;},_update:function(){if(!this._showing)return;if(this._autohide&&!this._async_request&&!this._autohide_timeout)this._autohide_timeout=setTimeout(aa(this,'hide'),this._autohide);m.removeClass(this._frame,'dialog_loading_shown');this._loading=false;this._renderDialog();this._runOnloads();this._previous_focus=document.activeElement;r.focus(this._frame);},_runOnloads:function(){for(var ia=0;ia<this._onload_handlers.length;++ia)try{this._onload_handlers[ia]();}catch(ja){}this._onload_handlers=[];},_updateWidth:function(){var ia=2*ha._BORDER_WIDTH;if(ha._isUsingCSSBorders())ia+=2*ha._HALO_WIDTH;if(this._content_width){ia+=this._content_width;if(!this._full_bleed)ia+=2*ha._PADDING_WIDTH;}else if(this._wide_dialog){ia+=ha.SIZE.WIDE;}else ia+=ha.SIZE.STANDARD;this._popup.style.width=ia+'px';},_updateZIndex:function(){if(!this._hasSetZIndex&&this._causal_elem){var ia=ea(this._causal_elem);this._hasSetZIndex=ia>(this._modal?400:200);w.set(this._obj,'z-index',this._hasSetZIndex?ia:'');}},_renderDialog:function(){this._updateZIndex();this._pushOntoStack();this._obj.style.height=(this._modal&&y.ie()<7)?z.getDocumentDimensions().y+'px':null;if(this._obj&&this._obj.style.display){this._obj.style.visibility='hidden';this._obj.style.display='';this.resetDialogPosition();this._obj.style.visibility='';this._obj.dialog=this;}else this.resetDialogPosition();clearInterval(this.active_hiding);this.active_hiding=setInterval(this._activeResize.bind(this),500);this._submit_on_enter=false;if(this._auto_focus){var ia=p.getFirstElement(this._content,['input[type="text"]','textarea','input[type="password"]']);if(ia){p.focusFirst.bind(this,this._content).defer();}else this._submit_on_enter=true;}var ja=z.getElementDimensions(this._content).y+z.getElementPosition(this._content).y;ha._bottoms.push(ja);this._bottom=ja;ha._updateMaxBottom();return this;},_buildDialog:function(){this._obj=o.create('div',{className:'generic_dialog',id:this._uniqueID});this._obj.style.display='none';o.appendContent(document.body,this._obj);if(!this._popup)this._popup=o.create('div',{className:'generic_dialog_popup'});this._obj.appendChild(this._popup);if(y.ie()<7&&!this._shim)k.loadModules(['IframeShim'],function(ua){this._shim=new ua(this._popup);});m.addClass(this._obj,'pop_dialog');if(t.isRTL())m.addClass(this._obj,'pop_dialog_rtl');var ia;if(ha._isUsingCSSBorders()){ia='<div class="pop_container_advanced">'+'<div class="pop_content" id="pop_content"></div>'+'</div>';}else ia='<div class="pop_container">'+'<div class="pop_verticalslab"></div>'+'<div class="pop_horizontalslab"></div>'+'<div class="pop_topleft"></div>'+'<div class="pop_topright"></div>'+'<div class="pop_bottomright"></div>'+'<div class="pop_bottomleft"></div>'+'<div class="pop_content pop_content_old" id="pop_content"></div>'+'</div>';o.setContent(this._popup,q(ia));var ja=o.find(this._popup,'div.pop_content');ja.setAttribute('tabIndex','0');ja.setAttribute('role','alertdialog');this._frame=this._content=ja;var ka=o.create('div',{className:'dialog_loading'},"Loading..."),la=o.create('span'),ma=o.create('h2',{className:'dialog_title hidden_elem',id:'title_'+this._uniqueID},la),na=o.create('div',{className:'dialog_summary hidden_elem'}),oa=o.create('div',{className:'dialog_body'}),pa=o.create('div'),qa=o.create('div',{className:'dialog_buttons_msg'}),ra=o.create('div',{className:'dialog_buttons clearfix hidden_elem'},[qa,pa]),sa=o.create('div',{className:'dialog_footer hidden_elem'}),ta=o.create('div',{className:'dialog_content'},[na,oa,ra,sa]);this._nodes={summary:na,body:oa,buttons:pa,button_message:qa,button_wrapper:ra,footer:sa,content:ta,title:ma,title_inner:la};o.setContent(this._frame,[ma,ta,ka]);},_updateShim:function(){return this._shim&&this._shim.show();},_activeResize:function(){if(this.last_offset_height!=this._content.offsetHeight){this.last_offset_height=this._content.offsetHeight;this.resetDialogPosition();}},resetDialogPosition:function(){if(!this._popup)return;this._resetDialogObj();this._updateShim();},_resetDialogObj:function(){var ia=2*ha._PAGE_MARGIN,ja=z.getViewportDimensions(),ka=ja.x-ia,la=ja.y-ia,ma=2*ha._HALO_WIDTH,na=z.getElementDimensions(this._content),oa=na.x+ma,pa=na.y+ma,qa=this._top,ra=ka-oa,sa=la-pa;if(sa<0){qa=ha._PAGE_MARGIN;}else if(qa>sa)qa=ha._PAGE_MARGIN+(Math.max(sa,0)/2);var ta=ga();if(!ta)qa+=z.getScrollPosition().y;w.set(this._popup,'marginTop',qa+'px');var ua=ta&&(ra<0||sa<0);m.conditionClass(this._obj,'generic_dialog_fixed_overflow',ua);m.conditionClass(document.documentElement,'generic_dialog_overflow_mode',ua);},_fadeOut:function(ia){if(!this._popup)return;try{new h(this._obj).duration(0).checkpoint().to('opacity',0).hide().duration(250).ondone(this._hide.bind(this,ia)).go();}catch(ja){this._hide(ia);}},_hide:function(ia){if(this._obj)this._obj.style.display='none';m.removeClass(document.documentElement,'generic_dialog_overflow_mode');this._updateShim();clearInterval(this.active_hiding);if(this._bottom){var ja=ha._bottoms;ja.splice(ja.indexOf(this._bottom),1);ha._updateMaxBottom();}if(this._previous_focus&&document.activeElement&&o.contains(this._obj,document.activeElement))r.focus(this._previous_focus);if(ia)return;this.destroy();},destroy:function(){this._popFromStack();if(this._obj){o.remove(this._obj);this._obj=null;this._shim&&this._shim.hide();this._shim=null;}this._clickOnEnterListener&&this._clickOnEnterListener.remove();if(this._close_handler)this._close_handler({return_data:this._return_data});},_handleButton:function(ia){if(typeof ia=='string')ia=ha._findButton(this._buttons,ia);var ja=ha.call_or_eval(ia,ia.handler);if(ja===false)return;if(ia.name=='cancel'){this.cancel();}else if(ha.call_or_eval(this,this._handler,{button:ia})!==false)this.hide();},_submitForm:function(ia,ja,ka){var la=this.getFormData();if(ka)la[ka.name]=ka.label;if(this._extra_data)ba(la,this._extra_data);var ma=new j().setURI(ja).setData(la).setMethod(ia).setNectarModuleDataSafe(this._causal_elem).setReadOnly(ia=='GET');this.setAsync(ma);return false;},_setFromModel:function(ia){var ja={};ba(ja,ia);for(var ka in ja){if(ka=='onloadRegister'){this.onloadRegister(ja[ka]);continue;}var la=this['set'+ka.substr(0,1).toUpperCase()+ka.substr(1)];la.apply(this,ca(ja[ka]));}},_updateBottom:function(){var ia=z.getElementDimensions(this._content).y+z.getElementPosition(this._content).y;ha._bottoms[ha._bottoms.length-1]=ia;ha._updateMaxBottom();},_pushOntoStack:function(){var ia=ha._stack;if(!ia.length)i.inform('layer_shown',{type:'Dialog'});ia.remove(this);ia.push(this);for(var ja=ia.length-2;ja>=0;ja--){var ka=ia[ja];if(!ka._is_stackable&&!ka._async_request){ka._hide();}else if(!ka._shown_while_stacked)ka._hide(true);}},_popFromStack:function(){var ia=ha._stack,ja=(ia[ia.length-1]===this);ia.remove(this);if(ia.length){if(ja)ia[ia.length-1].show();}else i.inform('layer_hidden',{type:'Dialog'});}});e.exports=ha;});
__d("ViewportBounds",["Style","ge"],function(a,b,c,d,e,f){var g=b('Style'),h=b('ge'),i={top:[],right:[],bottom:[],left:[]};function j(n){return function(){var o=0;i[n].forEach(function(p){o=Math.max(o,p.getSize());});return o;};}function k(n){return function(o){return new l(n,o);};}function l(n,o){this.getSide=bagof(n);this.getSize=function(){return typeof o==='function'?o():o;};i[n].push(this);}l.prototype.remove=function(){i[this.getSide()].remove(this);};var m={getTop:j('top'),getRight:j('right'),getBottom:j('bottom'),getLeft:j('left'),addTop:k('top'),addRight:k('right'),addBottom:k('bottom'),addLeft:k('left')};m.addTop(function(){var n=h('blueBar');if(n&&g.isFixed(n))return h('blueBarHolder').offsetHeight;return 0;});e.exports=m;});
__d("DOMScroll",["Animation","Arbiter","DOM","DOMQuery","Vector","ViewportBounds","ge"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('DOM'),j=b('DOMQuery'),k=b('Vector'),l=b('ViewportBounds'),m=b('ge'),n={SCROLL:'dom-scroll',getScrollState:function(){var o=k.getViewportDimensions(),p=k.getDocumentDimensions(),q=(p.x>o.x),r=(p.y>o.y);q+=0;r+=0;return new k(q,r);},_scrollbarSize:null,_initScrollbarSize:function(){var o=i.create('p');o.style.width='100%';o.style.height='200px';var p=i.create('div');p.style.position='absolute';p.style.top='0px';p.style.left='0px';p.style.visibility='hidden';p.style.width='200px';p.style.height='150px';p.style.overflow='hidden';p.appendChild(o);document.body.appendChild(p);var q=o.offsetWidth;p.style.overflow='scroll';var r=o.offsetWidth;if(q==r)r=p.clientWidth;document.body.removeChild(p);n._scrollbarSize=q-r;},getScrollbarSize:function(){if(n._scrollbarSize===null)n._initScrollbarSize();return n._scrollbarSize;},scrollTo:function(o,p,q,r,s){if(typeof p=='undefined'||p===true)p=750;if(!(o instanceof k)){var t=k.getScrollPosition().x,u=k.getElementPosition(m(o)).y;o=new k(t,u,'document');if(!r)o.y-=l.getTop()/(q?2:1);}if(q){o.y-=k.getViewportDimensions().y/2;}else if(r){o.y-=k.getViewportDimensions().y;o.y+=r;}o=o.convertTo('document');if(p){return new g(document.body).to('scrollTop',o.y).to('scrollLeft',o.x).ease(g.ease.end).duration(p).ondone(s).go();}else if(window.scrollTo){window.scrollTo(o.x,o.y);s&&s();}h.inform(n.SCROLL);},ensureVisible:function(o,p,q,r,s){if(q===undefined)q=10;o=m(o);if(p)o=j.find(o,p);var t=k.getScrollPosition().x,u=k.getScrollPosition().y,v=u+k.getViewportDimensions().y,w=k.getElementPosition(o).y,x=w+k.getElementDimensions(o).y;w-=l.getTop();w-=q;x+=q;if(w<u){n.scrollTo(new k(t,w,'document'),r,false,false,s);}else if(x>v)if(w-(x-v)<u){n.scrollTo(new k(t,w,'document'),r,false,false,s);}else n.scrollTo(new k(t,x,'document'),r,false,true,s);},scrollToTop:function(o){var p=k.getScrollPosition();n.scrollTo(new k(p.x,0,'document'),o!==false);}};e.exports=n;});
__d("HistoryManager",["event-extensions","function-extensions","Cookie","Env","URI","UserAgent","copyProperties","goOrReplace"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Cookie'),h=b('Env'),i=b('URI'),j=b('UserAgent'),k=b('copyProperties'),l=b('goOrReplace'),m={_IFRAME_BASE_URI:'http://static.ak.facebook.com/common/history_manager.php',history:null,current:0,fragment:null,_setIframeSrcFragment:function(n){n=n.toString();var o=m.history.length-1;m.iframe.src=m._IFRAME_BASE_URI+'?|index='+o+'#'+encodeURIComponent(n);return m;},getIframeSrcFragment:function(){return decodeURIComponent(i(m.iframe.contentWindow.document.location.href).getFragment());},nextframe:function(n,o){if(o){m._setIframeSrcFragment(n);return;}if(n!==undefined){m.iframeQueue.push(n);}else{m.iframeQueue.splice(0,1);m.iframeTimeout=null;m.checkURI();}if(m.iframeQueue.length&&!m.iframeTimeout){var p=m.iframeQueue[0];m.iframeTimeout=setTimeout(function(){m._setIframeSrcFragment(p);},100,false);}},isInitialized:function(){return !!m._initialized;},init:function(){if(!h.ALLOW_TRANSITION_IN_IFRAME&&window!=window.top)return;if(m._initialized)return m;var n=i(),o=n.getFragment()||'';if(o.charAt(0)==='!'){o=o.substr(1);n.setFragment(o);}if(i.getRequestURI(false).getProtocol().toLowerCase()=='https')m._IFRAME_BASE_URI='https://s-static.ak.facebook.com/common/history_manager.php';k(m,{_initialized:true,fragment:o,orig_fragment:o,history:[n],callbacks:[],lastChanged:Date.now(),canonical:i('#'),fragmentTimeout:null,user:0,iframeTimeout:null,iframeQueue:[],enabled:true,debug:bagofholding});if(window.history&&history.pushState){this.lastURI=document.URL;window.history.replaceState(this.lastURI,null);Event.listen(window,'popstate',function(p){if(p&&p.state&&m.lastURI!=p.state){m.lastURI=p.state;m.lastChanged=Date.now();m.notify(i(p.state).getUnqualifiedURI().toString());}}.bind(m));if(j.safari()<534||j.chrome()<=13){setInterval(m.checkURI,42,false);m._updateRefererURI(this.lastURI);}return m;}m._updateRefererURI(i.getRequestURI(false));if(j.safari()<500||j.firefox()<2){m.enabled=false;return m;}if(j.ie()<8){m.iframe=document.createElement('iframe');k(m.iframe.style,{width:'0',height:'0',frameborder:'0',left:'0',top:'0',position:'absolute'});m._setIframeSrcFragment(o);document.body.insertBefore(m.iframe,document.body.firstChild);}else if('onhashchange' in window){Event.listen(window,'hashchange',function(){m.checkURI.bind(m).defer();});}else setInterval(m.checkURI,42,false);return m;},registerURIHandler:function(n){m.callbacks.push(n);return m;},setCanonicalLocation:function(n){m.canonical=i(n);return m;},notify:function(n){if(n==m.orig_fragment)n=m.canonical.getFragment();for(var o=0;o<m.callbacks.length;o++)try{if(m.callbacks[o](n))return true;}catch(p){}return false;},checkURI:function(){if(Date.now()-m.lastChanged<400)return;if(window.history&&history.pushState){var n=i(document.URL).removeQueryData('ref').toString(),o=i(m.lastURI).removeQueryData('ref').toString();if(n!=o){m.lastChanged=Date.now();m.lastURI=n;if(j.safari()<534)m._updateRefererURI(n);m.notify(i(n).getUnqualifiedURI().toString());}return;}if(j.ie()<8&&m.iframeQueue.length)return;if(j.safari()&&window.history.length==200){if(!m.warned)m.warned=true;return;}var p=i().getFragment();if(p.charAt(0)=='!')p=p.substr(1);if(j.ie()<8)p=m.getIframeSrcFragment();p=p.replace(/%23/g,'#');if(p!=m.fragment.replace(/%23/g,'#')){m.debug([p,' vs ',m.fragment,'whl: ',window.history.length,'QHL: ',m.history.length].join(' '));for(var q=m.history.length-1;q>=0;--q)if(m.history[q].getFragment().replace(/%23/g,'#')==p)break;++m.user;if(q>=0){m.go(q-m.current);}else m.go('#'+p);--m.user;}},_updateRefererURI:function(n){n=n.toString();if(n.charAt(0)!='/'&&n.indexOf('//')==-1)return;var o=new i(window.location);if(o.isFacebookURI()){var p=o.getPath()+window.location.search;}else var p='';var q=i(n).getQualifiedURI().setFragment(p).toString(),r=2048;if(q.length>r)q=q.substring(0,r)+'...';g.set('x-referer',q);},go:function(n,o,p){if(window.history&&history.pushState){o||typeof(n)=='number';var q=i(n).removeQueryData('ref').toString();m.lastChanged=Date.now();this.lastURI=q;if(p){window.history.replaceState(n,null,q);}else window.history.pushState(n,null,q);if(j.safari()<534)m._updateRefererURI(n);return false;}m.debug('go: '+n);if(o===undefined)o=true;if(!m.enabled)if(!o)return false;if(typeof(n)=='number'){if(!n)return false;var r=n+m.current,s=Math.max(0,Math.min(m.history.length-1,r));m.current=s;r=m.history[s].getFragment()||m.orig_fragment;r=i(r).removeQueryData('ref').getUnqualifiedURI().toString();m.fragment=r;m.lastChanged=Date.now();if(j.ie()<8){if(m.fragmentTimeout)clearTimeout(m.fragmentTimeout);m._temporary_fragment=r;m.fragmentTimeout=setTimeout(function(){window.location.hash='#!'+r;delete m._temporary_fragment;},750,false);if(!m.user)m.nextframe(r,p);}else if(!m.user)l(window.location,window.location.href.split('#')[0]+'#!'+r,p);if(o)m.notify(r);m._updateRefererURI(r);return false;}n=i(n);if(n.getDomain()==i().getDomain())n=i('#'+n.getUnqualifiedURI());var t=m.history[m.current].getFragment(),u=n.getFragment();if(u==t||(t==m.orig_fragment&&u==m.canonical.getFragment())){if(o)m.notify(u);m._updateRefererURI(u);return false;}if(p)m.current--;var v=(m.history.length-m.current)-1;m.history.splice(m.current+1,v);m.history.push(i(n));return m.go(1,o,p);},getCurrentFragment:function(){var n=m._temporary_fragment!==undefined?m._temporary_fragment:i.getRequestURI(false).getFragment();return n==m.orig_fragment?m.canonical.getFragment():n;}};e.exports=m;});
__d("JSLogger",[],function(a,b,c,d,e,f){var g={MAX_HISTORY:500,counts:{},categories:{},seq:0,pageId:(Math.random()*2147483648|0).toString(36)};function h(l){if(l instanceof Error&&a.ErrorUtils)l=a.ErrorUtils.normalizeError(l);try{return JSON.stringify(l);}catch(m){return '{}';}}function i(l,event,m){if(!g.counts[l])g.counts[l]={};if(!g.counts[l][event])g.counts[l][event]=0;m=m==null?1:Number(m);g.counts[l][event]+=isFinite(m)?m:0;}g.logAction=function(event,l,m){if(this.type=='bump'){i(this.cat,event,l);}else if(this.type=='rate'){(l&&i(this.cat,event+'_n',m));i(this.cat,event+'_d',m);}else{var n={cat:this.cat,type:this.type,event:event,data:l!=null?h(l):null,date:Date.now(),seq:g.seq++};g.head=g.head?(g.head.next=n):(g.tail=n);while(g.head.seq-g.tail.seq>g.MAX_HISTORY)g.tail=g.tail.next;return n;}};function j(l){if(!g.categories[l]){g.categories[l]={};var m=function(n){var o={cat:l,type:n};g.categories[l][n]=function(){if(document.domain!='facebook.com')return;var p;try{p=a.top.require&&a.top.require('JSLogger')._.logAction;}catch(q){}(p&&p.apply(o,arguments));};};m('debug');m('log');m('warn');m('error');m('bump');m('rate');}return g.categories[l];}function k(l,m){var n=[];for(var o=m||g.tail;o;o=o.next)if(!l||l(o)){var p={type:o.type,cat:o.cat,date:o.date,event:o.event,seq:o.seq};if(o.data)p.data=JSON.parse(o.data);n.push(p);}return n;}e.exports={_:g,DUMP_EVENT:'jslogger/dump',create:j,getEntries:k};});
__d("LinkController",["event-extensions","DataStore","Parent","trackReferrer"],function(a,b,c,d,e,f){b('event-extensions');var g=b('DataStore'),h=b('Parent'),i=b('trackReferrer'),j='LinkControllerHandler',k=[],l=[];function m(event){var q=h.byTag(event.getTarget(),'a'),r=q&&q.getAttribute('href',2);if(!r||q.rel||!o(r)||g.get(q,j))return;var s=Event.listen(q,'click',function(t){if(r.charAt(r.length-1)=='#'){t.prevent();return;}i(q,r);n(q,t);});g.set(q,j,s);}function n(q,event){if(q.target||event.getModifiers().any||(event.which&&event.which!=1))return;var r=k.concat(l);for(var s=0,t=r.length;s<t;s++)if(r[s](q,event)===false)return event.kill();}function o(q){var r=q.match(/^(\w+):/);return !r||r[1].match(/^http/i);}var p={registerHandler:function(q){k.push(q);},registerFallbackHandler:function(q){l.push(q);}};Event.listen(document.documentElement,'mousedown',m);Event.listen(document.documentElement,'keydown',m);e.exports=p;});
__d("htmlSpecialChars",[],function(a,b,c,d,e,f){function g(h){if(typeof h=='undefined'||h===null||!h.toString)return '';if(h===false){return '0';}else if(h===true)return '1';return h.toString().replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#039;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}e.exports=g;});
__d("htmlize",["htmlSpecialChars"],function(a,b,c,d,e,f){var g=b('htmlSpecialChars');function h(i){return g(i).replace(/\r\n|[\r\n]/g,'<br />');}e.exports=h;});
__d("escapeJSQuotes",[],function(a,b,c,d,e,f){function g(h){if(typeof h=='undefined'||h==null||!h.valueOf())return '';return h.toString().replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/"/g,'\\x22').replace(/'/g,'\\\'').replace(/</g,'\\x3c').replace(/>/g,'\\x3e').replace(/&/g,'\\x26');}e.exports=g;});
__d("areObjectsEqual",[],function(a,b,c,d,e,f){function g(h,i){return JSON.stringify(h)==JSON.stringify(i);}e.exports=g;});
__d("computeRelativeURI",["URI","isEmpty"],function(a,b,c,d,e,f){var g=b('URI'),h=b('isEmpty');function i(k,l){if(!l)return k;if(l.charAt(0)=='/')return l;var m=k.split('/').slice(0,-1);m[0]!=='';l.split('/').forEach(function(n){if(!(n=='.'))if(n=='..'){if(m.length>1)m=m.slice(0,-1);}else m.push(n);});return m.join('/');}function j(k,l){var m=new g(),n=l;k=new g(k);l=new g(l);if(l.getDomain()&&!l.isFacebookURI())return n;var o=k,p=['Protocol','Domain','Port','Path','QueryData','Fragment'];p.forEach(function(q){var r=q=='Path'&&o===k;if(r)m.setPath(i(k.getPath(),l.getPath()));if(!h(l['get'+q]()))o=l;if(!r)m['set'+q](o['get'+q]());});return m;}e.exports=j;});
__d("startsWith",[],function(a,b,c,d,e,f){function g(h,i,j){var k=String(h);j=Math.min(Math.max(j||0,0),k.length);return k.lastIndexOf(String(i),j)===j;}e.exports=g;});
__d("PageTransitions",["event-extensions","Arbiter","Dialog","DOM","DOMScroll","Env","Form","HistoryManager","JSLogger","LinkController","OnloadHooks","htmlize","escapeJSQuotes","URI","UserAgent","Vector","areObjectsEqual","computeRelativeURI","copyProperties","ge","goOrReplace","startsWith","tx","userAction"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('Dialog'),i=b('DOM'),j=b('DOMScroll'),k=b('Env'),l=b('Form'),m=b('HistoryManager'),n=b('JSLogger'),o=b('LinkController'),p=b('OnloadHooks'),q=b('htmlize'),r=b('escapeJSQuotes'),s=b('URI'),t=b('UserAgent'),u=b('Vector'),v=b('areObjectsEqual'),w=b('computeRelativeURI'),x=b('copyProperties'),y=b('ge'),z=b('goOrReplace'),aa=b('startsWith'),ba=b('tx'),ca=b('userAction'),da={_transition_handlers:[],_scroll_positions:{},_scroll_locked:false,isInitialized:function(){return !!da._initialized;},_init:function(){if(!k.ALLOW_TRANSITION_IN_IFRAME&&window!=window.top)return;if(da._initialized)return da;da._initialized=true;var fa=s.getRequestURI(false),ga=fa.getUnqualifiedURI(),ha=s(ga).setFragment(null),ia=ga.getFragment();if(ia.charAt(0)==='!'&&ha.toString()===ia.substr(1))ga=ha;x(da,{_current_uri:ga,_most_recent_uri:ga,_next_uri:ga});var ja;if(aa(fa.getFragment(),'/')){ja=fa.getFragment();}else ja=ga;m.init().setCanonicalLocation('#'+ja).registerURIHandler(da._historyManagerHandler);o.registerFallbackHandler(da._rewriteHref);o.registerFallbackHandler(da._onlinkclick);Event.listen(document.documentElement,'submit',da._onformsubmit);Event.listen(window,'scroll',function(){if(!da._scroll_locked)da._scroll_positions[da._current_uri]=u.getScrollPosition();});return da;},registerHandler:function(fa,ga){da._init();ga=ga||5;if(!da._transition_handlers[ga])da._transition_handlers[ga]=[];da._transition_handlers[ga].push(fa);},getCurrentURI:function(fa){if(!da._current_uri&&!fa)return new s(da._most_recent_uri);return new s(da._current_uri);},getMostRecentURI:function(){return new s(da._most_recent_uri);},getNextURI:function(){return new s(da._next_uri);},_rewriteHref:function(fa){var ga=fa.getAttribute('href'),ha=w(da._most_recent_uri.getQualifiedURI(),ga).toString();if(ga!=ha)fa.setAttribute('href',ha);},_onlinkclick:function(fa){ea.lookBusy(fa);da.go(fa.getAttribute('href'));return false;},_onformsubmit:function(event){var fa=event.getTarget();if(l.getAttribute(fa,'rel')||l.getAttribute(fa,'target'))return;var ga=ca('form',fa,event).set_namespace('page_transition'),ha=a.ArbiterMonitor;if(ha)ha.initUA(ga,[fa]);var ia=new s(l.getAttribute(fa,'action')||''),ja=w(da._most_recent_uri,ia);fa.setAttribute('action',ja.toString());if((l.getAttribute(fa,'method')||'GET').toUpperCase()==='GET'){da.go(ja.addQueryData(l.serialize(fa)));event.kill();}},go:function(fa,ga){var ha=new s(fa).removeQueryData('quickling').getQualifiedURI();n.create('pagetransition').debug('go',{uri:ha.toString()});var ia=ha.getUnqualifiedURI();delete da._scroll_positions[ia];!ga&&ca('uri',{href:ha.toString()},null,'INDIRECT');ea.lookBusy();da._loadPage(ha,function(ja){if(ja){m.go(ha.toString(),false,ga);}else z(window.location,ha,ga);});},_historyManagerHandler:function(fa){if(fa.charAt(0)!='/')return false;ca('h',{href:fa},null);da._loadPage(new s(fa),function(ga){if(!ga)z(window.location,fa,true);});return true;},_loadPage:function(fa,ga){if(s(fa).getFragment()&&v(s(fa).setFragment(null).getQualifiedURI(),s(da._current_uri).setFragment(null).getQualifiedURI())){da._current_uri=da._most_recent_uri=fa;da.restoreScrollPosition();ea.stopLookingBusy();return;}var ha=da._scroll_positions[da._current_uri];da._current_uri=null;da._next_uri=fa;if(ha)j.scrollTo(ha,false);var ia=function(){da._scroll_locked=true;var ka=da._handleTransition(fa);ga&&ga(ka);},ja=p.runHooks('onbeforeleavehooks');if(ja){ea.stopLookingBusy();da._warnBeforeLeaving(ja,ia);}else ia();},_handleTransition:function(fa){window.onbeforeleavehooks=undefined;ea.lookBusy();if(!fa.isSameOrigin())return false;var ga=window.AsyncRequest&&window.AsyncRequest.getLastID();g.inform("pre_page_transition",{from:da.getMostRecentURI(),to:fa});for(var ha=da._transition_handlers.length-1;ha>=0;--ha){var ia=da._transition_handlers[ha];if(!ia)continue;for(var ja=ia.length-1;ja>=0;--ja)if(ia[ja](fa)===true){var ka={sender:this,uri:fa,id:ga};try{g.inform("page_transition",ka);}catch(la){}return true;}else ia.splice(ja,1);}return false;},unifyURI:function(){da._current_uri=da._most_recent_uri=da._next_uri;},transitionComplete:function(fa){da._executeCompletionCallback();ea.stopLookingBusy();da.unifyURI();if(!fa)da.restoreScrollPosition();try{if(document.activeElement&&document.activeElement.nodeName==='A')document.activeElement.blur();}catch(ga){}},_executeCompletionCallback:function(){if(da._completionCallback)da._completionCallback();da._completionCallback=null;},setCompletionCallback:function(fa){da._completionCallback=fa;},rewriteCurrentURI:function(fa,ga){da.registerHandler(function(){if(fa==da.getMostRecentURI().getUnqualifiedURI().toString()){da.transitionComplete();return true;}});da.go(ga,true);},_warnBeforeLeaving:function(fa,ga){new h().setTitle("Are you sure you want to leave this page?").setBody(q(fa)).setButtons([{name:'leave_page',label:"Leave this Page",handler:ga},{name:'continue_editing',label:"Stay on this Page",className:'inputaux'}]).setModal(true).show();},restoreScrollPosition:function(){da._scroll_locked=false;var fa=da._current_uri,ga=da._scroll_positions[fa];if(ga){j.scrollTo(ga,false);return;}function ha(ka){if(!ka)return null;var la="a[name='"+r(ka)+"']";return i.scry(document.body,la)[0]||y(ka);}var ia=ha(s(fa).getFragment());if(ia){var ja=u.getElementPosition(ia);ja.x=0;j.scrollTo(ja);}}},ea=window._BusyUIManager||{_looking_busy:false,_original_cursors:[],lookBusy:function(fa){if(fa)ea._giveProgressCursor(fa);if(ea._looking_busy)return;ea._looking_busy=true;ea._giveProgressCursor(document.documentElement);},stopLookingBusy:function(){if(!ea._looking_busy)return;ea._looking_busy=false;while(ea._original_cursors.length){var fa=ea._original_cursors.pop(),ga=fa[0],ha=fa[1];if(ga.style)ga.style.cursor=ha||'';}},_giveProgressCursor:function(fa){if(!t.safari()){ea._original_cursors.push([fa,fa.style.cursor]);fa.style.cursor='progress';}}};e.exports=da;});
__d("TextInputControl",["event-extensions","function-extensions","Class","DOMControl","Input","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Class'),h=b('DOMControl'),i=b('Input'),j=b('copyProperties');function k(l){this.parent.construct(this,l);var m=this.getRoot(),n=function(){this.update.bind(this).defer();}.bind(this);Event.listen(m,{keydown:n,paste:n});}g.extend(k,h);j(k.prototype,{setMaxLength:function(l){i.setMaxLength(this.getRoot(),l);return this;},getValue:function(){return i.getValue(this.getRoot());},isEmpty:function(){return i.isEmpty(this.getRoot());},setValue:function(l){i.setValue(this.getRoot(),l);this.update();return this;},clear:function(){return this.setValue('');},setPlaceholderText:function(l){i.setPlaceholder(this.getRoot(),l);return this;}});e.exports=k;});
__d("TextMetrics",["array-extensions","event-extensions","DOM","Style","UserAgent","debounce"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('DOM'),h=b('Style'),i=b('UserAgent'),j=b('debounce'),k;function l(){if(typeof k==='undefined'){var n=g.create('div',{className:'webkitZoomTest'}),o=function(){g.appendContent(document.body,n);k=100/n.clientHeight;g.remove(n);};Event.listen(window,'resize',j(o,100));o();}return k;}function m(n,o){this._node=n;this._flexible=!!o;var p='textarea',q='textMetrics';if(this._flexible){p='div';q+=' textMetricsInline';}this._shadow=g.create(p,{className:q});var r=['fontSize','fontStyle','fontWeight','fontFamily','wordWrap'];r.forEach(function(t){h.set(this._shadow,t,h.get(n,t));}.bind(this));var s=h.get(n,'lineHeight');if(i.chrome()||i.safari())s=Math.round(parseInt(s,10)*l())+'px';h.set(this._shadow,'lineHeight',s);document.body.appendChild(this._shadow);}m.prototype.measure=function(n){var o=this._node,p=this._shadow;n=(n||o.value)+'...';if(!this._flexible){var q=o.clientWidth-h.getFloat(o,'paddingLeft')-h.getFloat(o,'paddingRight');h.set(p,'width',Math.max(q,0)+'px');}g.setContent(p,n);return {width:p.scrollWidth,height:p.scrollHeight};};m.prototype.destroy=function(){g.remove(this._shadow);};e.exports=m;});
__d("TextAreaControl",["event-extensions","Arbiter","ArbiterMixin","Class","CSS","DOMControl","Style","TextInputControl","TextMetrics","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Class'),j=b('CSS'),k=b('DOMControl'),l=b('Style'),m=b('TextInputControl'),n=b('TextMetrics'),o=b('copyProperties');function p(q){this.autogrow=j.hasClass(q,'uiTextareaAutogrow');this.parent.construct(this,q);this.width=null;Event.listen(q,'focus',this._handleFocus.bind(this));}i.extend(p,m);o(p.prototype,h,{setAutogrow:function(q){this.autogrow=q;return this;},onupdate:function(){this.parent.onupdate();if(this.autogrow){var q=this.getRoot();if(!this.metrics)this.metrics=new n(q);if(typeof this.initialHeight==='undefined'){this.isBorderBox=l.get(q,'box-sizing')==='border-box'||l.get(q,'-moz-box-sizing')==='border-box'||l.get(q,'-webkit-box-sizing')==='border-box';this.borderBoxOffset=l.getFloat(q,'padding-top')+l.getFloat(q,'padding-bottom')+l.getFloat(q,'border-top-width')+l.getFloat(q,'border-bottom-width');this.initialHeight=q.offsetHeight-this.borderBoxOffset;}var r=this.metrics.measure(),s=Math.max(this.initialHeight,r.height);if(this.isBorderBox)s+=this.borderBoxOffset;if(s!==this.height){this.height=s;l.set(q,'height',s+'px');g.inform('reflow');this.inform('resize');}}else if(this.metrics){this.metrics.destroy();this.metrics=null;}},resetHeight:function(){this.height=-1;this.update();},_handleFocus:function(){this.width=null;}});p.getInstance=function(q){return k.getInstance(q)||new p(q);};e.exports=p;});
__d("URLScraper",["event-extensions","ArbiterMixin","Class","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('copyProperties');function j(ga){this.input=ga;this.enable();}i(j.prototype,g,{reset:function(){this.lastPermissiveMatch=null;},enable:function(){if(this.events)return;var ga=function(ha){setTimeout(this.check.bind(this,ha),30);};this.events=Event.listen(this.input,{paste:ga.bind(this,false),keydown:ga.bind(this,true)});},disable:function(){if(!this.events)return;for(var event in this.events)this.events[event].remove();this.events=null;},check:function(ga){var ha=this.input.value;if(ga&&j.trigger(ha))return;var ia=j.match(ha),ja=j.permissiveMatch(ha);if(ja&&(ja!=this.lastPermissiveMatch)){this.lastPermissiveMatch=ja;this.inform('match',{url:ia,alt_url:ja});}}});var k='!"#%&\'()*,-./:;<>?@[\\]^_`{|}',l='\u2000-\u206F\u00ab\u00bb',m='(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])',n='(?:(?:ht|f)tps?)://',o='(?:(?:'+m+'[.]){3}'+m+')',p='(?:\\b)www\\d{0,3}[.]',q='[^\\s'+k+l+']',r='(?:(?:[.:\\-_%@]|'+q+')*'+q+')',s='(?:[.][a-z]{2,4})',t='(?::\\d+){0,1}',u='(?=[\/?#])',v='(?:'+'(?:'+n+r+t+')|'+'(?:'+o+t+')|'+'(?:'+p+r+s+t+')|'+'(?:'+r+s+t+u+')'+')',w='[\/#?]',x='\\([^\\s()<>]+\\)',y='[^\\s()<>?#]+',z='[^\\s'+k+l+']',aa='(?:'+'(?:'+w+')'+'(?:'+'(?:'+x+'|'+y+')*'+'(?:'+x+'|'+z+')'+')*'+')*',ba=new RegExp('('+'(?:'+v+')'+'(?:'+aa+')'+')','im'),ca='(?:'+'(?:'+w+')'+'(?:'+'(?:'+x+'|'+y+')*'+')*'+')*',da=new RegExp('('+'(?:'+v+')'+'(?:'+ca+')'+')','im'),ea=new RegExp('('+'(?:'+n+r+t+')|'+'(?:'+p+r+s+t+')'+')'),fa=/[\s'";]/;j.match=function(ga){return j.matchToPattern(ga,ba);};j.permissiveMatch=function(ga){return j.matchToPattern(ga,da);};j.matchToPattern=function(ga,ha){var ia=(ha.exec(ga)||[])[1]||null;if(ia&&ia.indexOf('@')!=-1){return (ea.exec(ia))?ia:null;}else return ia;};j.trigger=function(ga){return !fa.test(ga.charAt(ga.length-1));};e.exports=j;});
__d("Composer",["function-extensions","Arbiter","ArbiterMixin","Button","Class","CSS","DOM","Env","FileForm","HTML","Input","PageTransitions","Parent","Run","ServerJS","TextAreaControl","URI","URLScraper","$","copyProperties","ge","tx","event-extensions"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Button'),j=b('Class'),k=b('CSS'),l=b('DOM'),m=b('Env'),n=b('FileForm'),o=b('HTML'),p=b('Input'),q=b('PageTransitions'),r=b('Parent'),s=b('Run'),t=b('ServerJS'),u=b('TextAreaControl'),v=b('URI'),w=b('URLScraper'),x=b('$'),y=b('copyProperties'),z=b('ge'),aa=b('tx');b('event-extensions');var ba=b('event-extensions').$E,ca=1,da=4,ea={},fa=function(){var ja=l.scry(this.root,'span.linkAttachment')[0];if(!ja&&this.isMetaComposer)ja=l.scry(this.root,'span.attachmentAcceptsLink')[0];if(!ja)return;var ka=r.byTag(ja,'form');this.scraper=new w(this.input);this.scraper.subscribe('match',function(la,ma){if(this.isMetaComposer){var na=this.form.xhpc_targetid,oa=new v('/ajax/metacomposer/attachment/link/scraper.php');oa.addQueryData({scrape_url:encodeURIComponent(ma.url),alt_scrape_url:encodeURIComponent(ma.alt_url),targetid:na.value});ka.action=oa.toString();}else{k.show(ja);ka.action='/ajax/composer/attachment/link/scraper.php?scrape_url='+encodeURIComponent(ma.url);}ka.xhpc.value=ja.id;ka.xhpc.disabled=false;ka.xhpc.click();}.bind(this));this.isMetaComposer&&this.scraper.check();},ga=function(ja){if(this.inform('submit')===false){ja.kill();return false;}if(this.submitHandler)return (new Function(this.submitHandler)).apply(this.form);};function ha(ja,ka,la,ma,na){ea[ja.id]=this;this.root=ja;this.resetCfg=ka;this.dataSource=ma;this.lazyEndpoint=this.resetCfg&&this.resetCfg.lazyEndpoint;this.focus=l.find(ja,'div.focus_target');this.form=l.find(ja,'form.attachmentForm');this.content=l.find(ja,'div.attachmentContent');this.isMetaComposer=la;if(this.isMetaComposer){this.messageBox=l.find(ja,'div.uiMetaComposerMessageBox');this.metaArea=l.find(ja,'div.attachmentMetaArea');this.bottomArea=l.find(ja,'div.attachmentBottomArea');this.barArea=l.find(ja,'div.attachmentBarArea');this.auxBarArea=l.find(ja,'.attachmentAuxBarArea');this.blurb=l.find(ja,'div.uiMetaComposerMessageBox div.textBlurb');this.input=l.find(ja,'div.uiMetaComposerMessageBox textarea.input');this.button=l.find(ja,'div.uiMetaComposerMessageBox label.submitBtn');this.privacy=l.find(ja,'div.uiMetaComposerMessageBox li.privacyWidget');this.boosting=l.scry(ja,'div.uiMetaComposerMessageBox li.boostingWidget');}else{this.blurb=l.find(ja,'div.uiComposerMessageBox div.textBlurb');this.input=l.find(ja,'div.uiComposerMessageBox textarea.input');this.button=l.find(ja,'div.uiComposerMessageBox label.submitBtn');this.privacy=l.find(ja,'div.uiComposerMessageBox li.privacyWidget');this.boosting=[];}Event.listen(this.form,'submit',ga.bind(this));if(this.isMetaComposer){Event.listen(this.input,'focus',this.onFocus.bind(this));if(na){if(document.activeElement===this.input)this.onFocus.bind(this).defer();}else if(r.byClass(this.input,'child_was_focused'))this.onFocus.bind(this).defer();}g.inform('xhpc/construct/'+ja.id,this,g.BEHAVIOR_STATE);}y(ha.prototype,h,{init:function(ja){this.mentionsInput=ja;if(this.mentionsInput)this.mentionsInput.subscribe('init',function(){var ka=this.mentionsInput.getTypeahead().getView();ka.subscribe(['reset','render'],function(la){k.conditionClass(this.root,'uiComposerMention',(la=='render'));}.bind(this));}.bind(this));fa.call(this);this.inform('init',null,g.BEHAVIOR_PERSISTENT);this.setupListen();s.onBeforeUnload(this._handleUnsavedChanges.bind(this));},setupListen:function(){Event.listen(this.root,'click',this.clickHandler.bind(this));},clickHandler:function(event){var ja=event.getTarget();if(r.byClass(ja,'collapsedPostButton'))this.focusInput.bind(this).defer();},setBlurb:function(ja){l.setContent(this.blurb,ja);},setEnabled:function(ja){i.setEnabled(this.button,ja);},getEndpoint:function(){return this.form.getAttribute('action');},setEndpoint:function(ja){this.form.setAttribute('action',ja);},setLoading:function(ja){k.conditionClass(this.root,'async_saving',!!ja);},setContentVisible:function(ja){k.conditionClass(this.root,'uiComposerHideContent',!ja);},setMessageBoxVisible:function(ja){k.conditionClass(this.root,'uiComposerHideMessageBox',!ja);},setInputVisible:function(ja){k.conditionClass(this.root,'uiComposerHideInput',!ja);},setStatusBoxVisible:function(ja){k.conditionClass(this.root,'uiComposerHideStatusBox',!ja);},setTopicTaggerVisible:function(ja){k.conditionClass(this.root,'uiTagComposerHidden',!ja);},mutate:function(ja){if(this.lastComposerInput)p.setValue(this.input,p.getValue(z(this.lastComposerInput)));var ka=z(ja.xhpc);if(ka){var la=l.scry(this.root,'.uiComposerAttachmentSelected')[0];if(ja.confirmAugmentation&&la!==ka)return;la&&k.removeClass(la,'uiComposerAttachmentSelected');k.addClass(ka,'uiComposerAttachmentSelected');if(!ja.disableCache)Event.listen(ka,'click',function(na){ba(na).stop();ja.disableCache=true;this.mutate(ja);}.bind(this));}if(!ja.keepContentAreas){this.setContentVisible(false);l.empty(this.content);if(this.isMetaComposer){this.mentionsInput&&this.mentionsInput.setAuxContent(null);l.empty(this.metaArea);l.empty(this.bottomArea);l.empty(this.barArea);l.empty(this.auxBarArea);}}if(ja.content){l.setContent(this.content,o(ja.content));this.setContentVisible(true);}if(this.isMetaComposer){ja.metaContent&&l.setContent(this.metaArea,o(ja.metaContent));ja.bottomContent&&l.setContent(this.bottomArea,o(ja.bottomContent));ja.barContent&&l.setContent(this.barArea,o(ja.barContent));ja.auxBarContent&&l.setContent(this.auxBarArea,o(ja.auxBarContent));}this.setMessageBoxVisible(!ja.messageBoxHidden);k.conditionClass(this.root,'uiComposerWhiteMessageBox',!ja.messageBoxHidden&&!ja.inputHidden&&!ja.content);this.setInputVisible(!ja.inputHidden);this.setStatusBoxVisible(!ja.statusBoxHidden);k.conditionShow(this.privacy,!ja.privacyWidgetHidden);if(this.boosting.length>0)k.conditionShow(this.boosting[0],!ja.boostingWidgetHidden);if(!ja.keepContentAreas){p.setPlaceholder(this.input,ja.placeholder);i.setLabel(this.button,ja.buttonLabel);}this.setBlurb(o(ja.blurb));if(ja.autoscrape){this.scraper&&this.scraper.enable();}else this.scraper&&this.scraper.disable();this.setEnabled(!ja.disabled);this.setTopicTaggerVisible(!ja.hideTopicTagger);this.setEndpoint(ja.endpoint);if(ja.formType==ca){this.form.setAttribute('rel','async');}else this.form.removeAttribute('rel');this.form.removeAttribute('target');if(ja.formType==da){if(!this._fileForm){this._fileForm=new n(this.form);this._fileForm.setAllowCrossOrigin(m.allowCrossOriginComposerUpload);this._fileForm.subscribe('submit',this.setLoading.bind(this,true));this._fileForm.subscribe('failure',this.setLoading.bind(this,false));}}else if(this._fileForm){this._fileForm.destroy();this._fileForm=null;}this.submitHandler=ja.submitHandler;this.lazyEndpoint=ja.lazyEndpoint;k.addClass(this.root,'uiComposerInteracted');k.addClass(this.root,'uiComposerOpen');if(ja.messageBoxFocused){var ma=document.activeElement;if(ma===document.body||r.byClass(ma,'attachmentLink'))this.focusInput.bind(this).defer();}if(ja.inputElement){p.setValue(z(ja.inputElement),p.getValue(this.input));u.getInstance(z(ja.inputElement)).update();}else u.getInstance(this.input).update();this.lastComposerInput=ja.inputElement;g.inform('composer/mutate',this);},subscribeToMutate:function(ja){return g.subscribe('composer/mutate',function(ka,la){if(la===this)ja();}.bind(this));},unsubscribeFromMutate:function(ja){ja.unsubscribe();},reset:function(ja){if(this.isMetaComposer){l.empty(this.metaArea);l.empty(this.bottomArea);l.empty(this.barArea);l.empty(this.auxBarArea);}if(this.resetCfg){this.mutate(this.resetCfg);}else{var ka=l.scry(this.root,'.uiComposerAttachmentSelected')[0];if(ka)k.removeClass(ka,'uiComposerAttachmentSelected');}if(!ja){p.reset(this.input);this.mentionsInput&&this.mentionsInput.reset();this.scraper&&this.scraper.reset();}k.removeClass(this.root,'uiComposerInteracted');k.setClass(this.focus,'focus_target');this.setLoading(false);g.inform('composer/reset');},onFocus:function(){if(this.lazyEndpoint){var ja=l.find(this.root,'form.attachmentSelectForm'),ka=new v(this.lazyEndpoint);ka.addQueryData({isAugmentation:true});ja.action=ka.toString();var la=l.scry(this.root,'.uiComposerAttachmentSelected')[0];ja.xhpc.value=la&&la.id;ja.xhpc.click();k.removeClass.curry(this.root,'async_saving').defer();}this.inform('focus');},focusInput:function(){p.focus(this.input);},getInput:function(){return this.input;},updateDataSourceToken:function(ja){if(this.dataSource)this.dataSource.updateToken(ja);},_handleUnsavedChanges:function(){var ja=q.getNextURI();if(ja.getQueryData().hasOwnProperty('theater'))return;if(this.input.offsetParent!==null&&!p.isEmpty(this.input)&&!(a.Dialog&&a.Dialog.getCurrent()))return "You haven't finished your post yet. Do you want to leave without finishing?";}});var ia;y(ha,{setNodeToConfigure:function(ja){ia=ja;},configure:function(ja,ka,la){var ma=r.byClass(ia,'uiComposer').id,na=g.subscribe('xhpc/construct/'+ma,function(oa,pa){(function(){na.unsubscribe();}).defer();pa.mutate(ja);pa.subscribe('init',function(){new t().handle(ka);new Function(la)();if(ja.attachmentJS)new Function(ja.attachmentJS).call(pa);});});},publish:function(ja,ka){ka=ka||{};ka.composer_id=ja;ka.composer=ha.getInstance(ja);ka.composer&&ka.composer.reset(false);if(ka.streamNode){ka.streamStory=ka.streamNode;}else if(ka.streamMarkup)ka.streamStory=o(ka.streamMarkup).getRootNode();g.inform('composer/publish',ka);},finish:function(ja){ha.getInstance(ja).setLoading(false);},getInstance:function(ja){var ka=r.byClass(x(ja),'uiComposer');return ka?ea[ka.id]:null;}});e.exports=ha;});
__d("legacy:Composer",["Composer"],function(a,b,c,d){a.Composer=b('Composer');},3);
function MetaComposerMessageBox(){}copyProperties(MetaComposerMessageBox.prototype,{init:function(a,b){this.inputContainer=DOM.scry(a,'div.inputContainer')[0];this.textInput=DOM.scry(a,'textarea.mentionsTextarea')[0];this.metaArea=DOM.scry(a,'div.attachmentMetaArea')[0];this.bottomArea=DOM.scry(a,'div.attachmentBottomArea')[0];this.barArea=DOM.scry(a,'div.attachmentBarArea')[0];Event.listen(this.inputContainer,'click',function(c){var d=c.getTarget();if(!DOM.contains(this.metaArea,d)&&d!==this.textInput)this.textInput.focus();}.bind(this));}});
__d("FBDesktopDetect",["UserAgent"],function(a,b,c,d,e,f){var g=b('UserAgent'),h='facebook.desktopplugin',i={mimeType:'application/x-facebook-desktop-1',isPluginInstalled:function(){if(g.osx())return false;var j=null;if(a.ActiveXObject){try{j=new a.ActiveXObject(h);if(j)return true;}catch(k){}}else if(a.navigator&&a.navigator.plugins){a.navigator.plugins.refresh(false);for(var l=0,m=a.navigator.plugins.length;l<m;l++){j=a.navigator.plugins[l];if(j.length&&j[0].type===this.mimeType)return true;}}return false;}};e.exports=i;});
__d("CacheStorage",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties'),h={localstorage:i};function i(){this._store=a.localStorage;}i.available=function(){return !!a.localStorage;};g(i.prototype,{keys:function(){var k=[];for(var l=0;l<this._store.length;l++)k.push(this._store.key(l));return k;},get:function(k){return this._store.getItem(k);},set:function(k,l){this._store.setItem(k,l);},remove:function(k){this._store.removeItem(k);},clear:function(){this._store.clear();}});function j(k,l){this._key_prefix=l||'_cs_';this._magic_prefix='_@_';if(k=='AUTO')for(var m in h){var n=h[m];if(n.available()){k=m;break;}}if(k)if(!h[k]||!h[k].available()){this._backend=null;}else this._backend=new h[k]();this._memcache={};}g(j.prototype,{keys:function(){var k=[];if(this._backend){var l=this._backend.keys();for(var m=0;m<l.length;m++)if(l[m].substr(0,this._key_prefix.length)==this._key_prefix)k.push(l[m].substr(this._key_prefix.length));return k;}for(var n in this._memcache)k.push(n);return k;},set:function(k,l){this._memcache[k]=l;if(this._backend){if(typeof l=='string'){l=this._magic_prefix+l;}else l=JSON.stringify(l);this._backend.set(this._key_prefix+k,l);}},get:function(k,l){if(this._memcache[k]!==undefined)return this._memcache[k];var m;if(this._backend){m=this._backend.get(this._key_prefix+k);if(m!==null){if(m.substr(0,this._magic_prefix.length)==this._magic_prefix){m=m.substr(this._magic_prefix.length);}else try{m=JSON.parse(m);}catch(n){m=undefined;}if(m!==undefined)this._memcache[k]=m;}else m=undefined;}if(m===undefined&&l!==undefined){m=l;this._memcache[k]=m;if(this._backend){var o;if(typeof m=='string'){o=this._magic_prefix+m;}else o=JSON.stringify(m);this._backend.set(this._key_prefix+k,o);}}return m;},remove:function(k){delete this._memcache[k];if(this._backend)this._backend.remove(this._key_prefix+k);}});e.exports=j;});
__d("FBDesktopPlugin",["CacheStorage","DOM","Env","FBDesktopDetect","HTML","URI","$"],function(a,b,c,d,e,f){var g=b('CacheStorage'),h=b('DOM'),i=b('Env'),j=b('FBDesktopDetect'),k=b('HTML'),l=b('URI'),m=b('$'),n=new g('localstorage','_socialfox_'),o={_plugin:'_not_checked',arbiterInform:function(p,q){var r=JSON.stringify({name:p,payload:q});this._transmitCommand('arbiterinform',r);},bringToFront:function(){this._transmitCommand('bringtofront');},dock:function(){this._transmitCommand('dock');},getPlugin:function(){if(this._plugin==='_not_checked'){this._plugin=null;if(j.isPluginInstalled()){var p=h.create('div');document.body.appendChild(p);h.setContent(p,k('<object id="kiwi_plugin" '+'type="'+j.mimeType+'" width="0" height="0">'+'</object>'));this._plugin=m('kiwi_plugin');}}return this._plugin;},getUserID:function(){var p=this.getPlugin();return p&&'getUserID' in p&&p.getUserID();},isAppRunning:function(){var p=this.getPlugin();return p&&'isAppRunning' in p&&p.isAppRunning();},launchApp:function(){var p=this.getPlugin();return p&&'launchApp' in p&&p.launchApp();},logout:function(p){p=p||"0";var q=this.getPlugin();if(q)q.logout(p);},recheck:function(){if(this._plugin===null)this._plugin='_not_checked';},shouldSuppressBeeper:function(){return this.isAppRunning();},shouldSuppressMessages:function(){var p=this.getUserID();if(p){return p===i.user;}else return this.isAppRunning();},shouldSuppressSidebar:function(){var p=this.getPlugin(),q=p&&'isAppDocked' in p&&p.isAppDocked(),r=n&&n.get('active')==='true';return q||r;},transferAuthToken:function(p,q){if(p&&p.length>0){var r=this.getPlugin();if(r){r.setAccessToken(p,q);var s=setInterval(function(){r.setAccessToken(p,q);},500);setTimeout(function(){clearInterval(s);},10*1000);}}if(this.redirectHome)window.location.href=l().setPath().toString();},_transmitCommand:function(p,q){q=q||'';var r=this.getPlugin();if(r&&'transmitCommand' in r)r.transmitCommand(p,q);}};e.exports=o;});
__d("ARIA",["DOM","ge"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('ge'),i,j,k=function(){i=h('ariaAssertiveAlert');if(!i){i=g.create('div',{id:'ariaAssertiveAlert',className:'accessible_elem',role:'alert','aria-live':'assertive'});g.appendContent(document.body,i);}j=h('ariaPoliteAlert');if(!j){j=i.cloneNode(false);j.setAttribute('id','ariaPoliteAlert');j.setAttribute('aria-live','polite');g.appendContent(document.body,j);}k=bagofholding;};function l(n,o){k();var p=o?i:j;g.setContent(p,n);}var m={owns:function(n,o){n.setAttribute('aria-owns',g.getID(o));},setPopup:function(n,o){var p=g.getID(o);n.setAttribute('aria-owns',p);n.setAttribute('aria-controls',p);n.setAttribute('aria-haspopup','true');if(n.tabIndex==-1)n.tabIndex=0;},announce:function(n){l(n,true);},notify:function(n){l(n);}};e.exports=m;});
__d("ContextualDialogFooterLink",["event-extensions","copyProperties","CSS","DOM"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('CSS'),i=b('DOM');function j(k){this._layer=k;}g(j.prototype,{_subscriptions:null,enable:function(){var k=this._layer.getRoot(),l=i.scry(k,'.uiContextualDialogFooterLink')[0],m='uiContextualDialogHoverFooterArrow';this._subscriptions=[Event.listen(l,'mouseenter',h.addClass.curry(k,m)),Event.listen(l,'mouseleave',h.removeClass.curry(k,m))];},disable:function(){this._subscriptions.forEach(function(k){k.remove();});this._subscriptions=null;}});e.exports=j;});
__d("ContextualThing",["DOM","ge"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('ge');function i(k){var l;while(k){if(k.getAttribute&&(l=k.getAttribute('data-ownerid')))return h(l);k=k.parentNode;}return null;}var j={register:function(k,l){k.setAttribute('data-ownerid',g.getID(l));},remove:function(k){k.removeAttribute('data-ownerid');},containsIncludingLayers:function(k,l){while(l){if(g.contains(k,l))return true;l=i(l);}return false;}};e.exports=j;});
__d("BootloadedReact",["Bootloader"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=function(j){g.loadModules(['React'],j);},i={isValidComponent:function(j){return (j&&typeof j.genMarkup==='function'&&typeof j.handleUpdateProps==='function');},initializeTouchEvents:function(j,k){h(function(l){l.initializeTouchEvents(j);k&&k();});},createComponent:function(j,k){h(function(l){var m=l.createComponent(j);k&&k(m);});},renderComponent:function(j,k,l){h(function(m){var n=m.renderComponent(j,k);l&&l(n);});},renderOrUpdateComponent:function(j,k,l){h(function(m){var n=m.renderOrUpdateComponent(j,k);l&&l(n);});},destroyAndReleaseReactRootNode:function(j,k){h(function(l){l.destroyAndReleaseReactRootNode(j);k&&k();});}};e.exports=i;});
__d("KeyEventController",["event-extensions","DOM","Run","copyProperties","isEmpty"],function(a,b,c,d,e,f){b('event-extensions');var g=b('DOM'),h=b('Run'),i=b('event-extensions').$E,j=b('copyProperties'),k=b('isEmpty');function l(){this.handlers={};document.onkeyup=this.onkeyevent.bind(this,'onkeyup');document.onkeydown=this.onkeyevent.bind(this,'onkeydown');document.onkeypress=this.onkeyevent.bind(this,'onkeypress');}j(l,{instance:null,getInstance:function(){return l.instance||(l.instance=new l());},defaultFilter:function(event,m){event=i(event);return l.filterEventTypes(event,m)&&l.filterEventTargets(event,m)&&l.filterEventModifiers(event,m);},filterEventTypes:function(event,m){if(m==='onkeydown')return true;return false;},filterEventTargets:function(event,m){var n=event.getTarget();if(n.contentEditable==='true')return false;return !g.isNodeOfType(n,l._interactiveElements)||(n.type in l._uninterestingTypes)||(g.isNodeOfType(n,['input','textarea'])&&n.value.length===0&&event.keyCode in l._controlKeys);},filterEventModifiers:function(event,m){if(event.ctrlKey||event.altKey||event.metaKey||event.repeat)return false;return true;},registerKey:function(m,n,o,p){if(o===undefined)o=l.defaultFilter;var q=l.getInstance(),r=q.mapKey(m);if(k(q.handlers))h.onLeave(q.resetHandlers.bind(q));var s={};for(var t=0;t<r.length;t++){m=r[t];if(!q.handlers[m]||p)q.handlers[m]=[];var u={callback:n,filter:o};s[m]=u;q.handlers[m].push(u);}return {remove:function(){for(var v in s){if(q.handlers[v]&&q.handlers[v].length){var w=q.handlers[v].indexOf(s[v]);w>=0&&q.handlers[v].splice(w,1);}delete s[v];}}};},keyCodeMap:{BACKSPACE:[8],TAB:[9],RETURN:[13],ESCAPE:[27],LEFT:[37,63234],UP:[38,63232],RIGHT:[39,63235],DOWN:[40,63233],DELETE:[46],COMMA:[188],PERIOD:[190],'`':[192],'[':[219],']':[221]},_interactiveElements:['input','select','textarea','object','embed'],_uninterestingTypes:{checkbox:1,radio:1,submit:1},_controlKeys:{8:1,9:1,13:1,27:1,37:1,63234:1,38:1,63232:1,39:1,63235:1,40:1,63233:1,46:1}});j(l.prototype,{mapKey:function(m){if(m>=0&&m<=9){if(typeof(m)!='number')m=m.charCodeAt(0)-48;return [48+m,96+m];}var n=l.keyCodeMap[m.toUpperCase()];if(n)return n;return [m.toUpperCase().charCodeAt(0)];},onkeyevent:function(m,n){n=i(n);var o=this.handlers[n.keyCode]||this.handlers[n.which],p,q,r;if(o)for(var s=0;s<o.length;s++){p=o[s].callback;q=o[s].filter;try{if(!q||q(n,m)){r=p(n,m);if(r===false)return Event.kill(n);}}catch(t){}}return true;},resetHandlers:function(){this.handlers={};}});e.exports=l;});
__d("Layer",["event-extensions","ArbiterMixin","BehaviorsMixin","BootloadedReact","Class","ContextualThing","CSS","DataStore","DOM","HTML","KeyEventController","Style","$","copyProperties","ge"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('BehaviorsMixin'),i=b('BootloadedReact'),j=b('Class'),k=b('ContextualThing'),l=b('CSS'),m=b('DataStore'),n=b('DOM'),o=b('HTML'),p=b('KeyEventController'),q=b('Style'),r=b('$'),s=b('copyProperties'),t=b('ge'),u=[];function v(w,x){this._config=w||{};if(x){this._configure(this._config,x);var y=this._config.addedBehaviors||[];this.enableBehaviors(this._getDefaultBehaviors().concat(y));}}s(v,g);s(v,{init:function(w,x){w.init(x);},initAndShow:function(w,x){w.init(x).show();},show:function(w){w.show();}});s(v.prototype,g,h,{_initialized:false,_root:null,_shown:false,_hiding:false,_causalElement:null,_reactContainer:null,init:function(w){this._configure(this._config,w);var x=this._config.addedBehaviors||[];this.enableBehaviors(this._getDefaultBehaviors().concat(x));this._initialized=true;return this;},_configure:function(w,x){if(x){var y=n.isNode(x),z=typeof x==='string'||o.isHTML(x);this.containsReactComponent=i.isValidComponent(x);if(z){x=o(x).getRootNode();}else if(this.containsReactComponent){var aa=document.createElement('div');i.renderComponent(x,aa);x=this._reactContainer=aa;}}this._root=this._buildWrapper(w,x);l.addClass(this._root,'uiLayer');if(w.causalElement)this._causalElement=t(w.causalElement);m.set(this._root,'layer',this);},_getDefaultBehaviors:function(){return [];},getCausalElement:function(){return this._causalElement;},setCausalElement:function(w){this._causalElement=w;},getInsertParent:function(){return this._insertParent||document.body;},getRoot:function(){return this._root;},_getContentRoot:function(){return this._root;},_buildWrapper:function(w,x){return x;},setInsertParent:function(w){if(w){if(this._shown&&w!==this.getInsertParent()){n.appendContent(w,this.getRoot());this.updatePosition();}this._insertParent=w;}return this;},show:function(){if(this._shown)return this;var w=this.getRoot();this.inform('beforeshow');q.set(w,'visibility','hidden');q.set(w,'overflow','hidden');l.show(w);n.appendContent(this.getInsertParent(),w);if(this.updatePosition()!==false){u.push(this);this._shown=true;this.inform('show');v.inform('show',this);}else n.remove(w);q.set(w,'visibility','');q.set(w,'overflow','');this.inform('aftershow');return this;},hide:function(){if(this._hiding||!this._shown||this.inform('beforehide')===false)return this;this._hiding=true;if(this.inform('starthide')!==false)this.finishHide();return this;},finishHide:function(){if(this._shown){u.remove(this);this._hiding=false;this._shown=false;n.remove(this.getRoot());this.inform('hide');v.inform('hide',this);}},isShown:function(){return this._shown;},updatePosition:function(){return true;},destroy:function(){if(this.containsReactComponent)i.destroyAndReleaseReactRootNode(this._reactContainer);this.finishHide();this.destroyBehaviors();this.inform('destroy');v.inform('destroy',this);m.remove(this._root,'layer');this._root=this._causalElement=null;}});Event.listen(document.documentElement,'keydown',function(event){if(p.filterEventTargets(event,'keydown'))for(var w=u.length-1;w>=0;w--)if(u[w].inform('key',event)===false)return false;},Event.Priority.URGENT);Event.listen(document.documentElement,'click',function(event){var w=event.getTarget(),x,y;for(var z=u.length-1;z>=0;z--){x=u[z];y=x._getContentRoot();if(k.containsIncludingLayers(y,w))return;if(x.inform('blur',event)===false)return;}});e.exports=v;});
__d("LayerAutoFocus",["function-extensions","copyProperties","DOMQuery","Input"],function(a,b,c,d,e,f){b('function-extensions');var g=b('copyProperties'),h=b('DOMQuery'),i=b('Input');function j(k){this._layer=k;}g(j.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('aftershow',this._focus.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_focus:function(){var k=h.scry(this._layer.getRoot(),'.autofocus')[0];k&&i.focus(k);}});e.exports=j;});
__d("LayerButtons",["event-extensions","Parent","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Parent'),h=b('copyProperties');function i(j){this._layer=j;}h(i.prototype,{_listener:null,enable:function(){this._listener=Event.listen(this._layer.getRoot(),'click',this._handle.bind(this));},disable:function(){this._listener.remove();this._listener=null;},_handle:function(j){var k=j.getTarget(),l=g.byClass(k,'layerConfirm');if(l){if(this._layer.inform('confirm',l)===false)j.prevent();return;}var m=g.byClass(k,'layerCancel');if(m){if(this._layer.inform('cancel',m)!==false)this._layer.hide();j.prevent();return;}var n=g.byClass(k,'layerButton');if(n)if(this._layer.inform('button',n)===false)j.prevent();}});e.exports=i;});
__d("LayerDestroyOnHide",["function-extensions","copyProperties"],function(a,b,c,d,e,f){b('function-extensions');var g=b('copyProperties');function h(i){this._layer=i;}g(h.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('hide',Function.prototype.defer.shield(this._layer.destroy.bind(this._layer)));},disable:function(){if(this._subscription){this._subscription.unsubscribe();this._subscription=null;}}});e.exports=h;});
__d("LayerFadeOnHide",["Animation","Layer","Style","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Layer'),i=b('Style'),j=b('UserAgent'),k=b('copyProperties');function l(m){this._layer=m;}k(l.prototype,{_subscription:null,enable:function(){if(j.ie()<9)return;this._subscription=this._layer.subscribe('starthide',this._handleStartHide.bind(this));},disable:function(){if(this._subscription){this._subscription.unsubscribe();this._subscription=null;}},_handleStartHide:function(){var m=true,n=h.subscribe('show',function(){n.unsubscribe();m=false;});(function(){n.unsubscribe();n=null;if(m){this._animate();}else this._layer.finishHide();}).bind(this).defer();return false;},_animate:function(){new g(this._layer.getRoot()).from('opacity',1).to('opacity',0).duration(150).ondone(this._finish.bind(this)).go();},_finish:function(){i.set(this._layer.getRoot(),'opacity','');this._layer.finishHide();}});e.exports=l;});
__d("LayerFadeOnShow",["Animation","Style","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Style'),i=b('UserAgent'),j=b('copyProperties');function k(l){this._layer=l;}j(k.prototype,{_subscriptions:null,enable:function(){if(i.ie()<9)return;this._subscriptions=[this._layer.subscribe('beforeshow',function(){h.set(this._layer.getRoot(),'opacity',0);}.bind(this)),this._layer.subscribe('show',this._animate.bind(this))];},disable:function(){if(this._subscriptions){while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;}},_animate:function(){var l=this._layer.getRoot();new g(l).from('opacity',0).to('opacity',1).duration(100).ondone(h.set.curry(l,'opacity','')).go();}});e.exports=k;});
__d("LayerFormHooks",["event-extensions","Form","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Form'),h=b('copyProperties');function i(j){this._layer=j;}h(i.prototype,{_subscriptions:null,enable:function(){var j=this._layer.getRoot();this._subscriptions=[Event.listen(j,'submit',this._onSubmit.bind(this)),Event.listen(j,'success',this._onSuccess.bind(this)),Event.listen(j,'error',this._onError.bind(this))];},disable:function(){this._subscriptions.forEach(function(j){j.remove();});this._subscriptions=null;},_onSubmit:function(event){if(this._layer.inform('submit',event)===false)event.kill();},_onSuccess:function(event){if(this._layer.inform('success',event)===false)event.kill();},_onError:function(event){var j=event.getData();if(this._layer.inform('error',{response:j.response})===false)event.kill();}});e.exports=i;});
__d("LayerHideOnBlur",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._layer=i;}g(h.prototype,{_subscriptions:null,_onBlur:null,enable:function(){this._subscriptions=[this._layer.subscribe('show',this._attach.bind(this)),this._layer.subscribe('hide',this._detach.bind(this))];if(this._layer.isShown())this._attach();},disable:function(){this._detach();while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;},_detach:function(){this._onBlur&&this._onBlur.unsubscribe();this._onBlur=null;},_attach:function(){(function(){this._onBlur=this._layer.subscribe('blur',this._layer.hide.shield(this._layer));}).bind(this).defer();}});e.exports=h;});
__d("LayerHideOnEscape",["event-extensions","copyProperties","Input","Keys"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('Input'),i=b('Keys');function j(k){this._layer=k;}g(j.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('key',this._handle.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_handle:function(k,event){if(Event.getKeyCode(event)===i.ESC){var l=this._layer.getCausalElement();if(l)if(l.tabIndex!=-1)h.focus(l);this._layer.hide();return false;}}});e.exports=j;});
__d("LayerHideOnSuccess",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._layer=i;}g(h.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('success',this._layer.hide.bind(this._layer));},disable:function(){if(this._subscription){this._subscription.unsubscribe();this._subscription=null;}}});e.exports=h;});
__d("LayerHideOnTransition",["Arbiter","Class","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Class'),i=b('copyProperties');function j(k){this._layer=k;}i(j.prototype,{_subscription:null,enable:function(){this._subscription=g.subscribe('page_transition',this._layer.hide.shield(this._layer),g.SUBSCRIBE_NEW);},disable:function(){if(this._subscription){this._subscription.unsubscribe();this._subscription=null;}}});e.exports=j;});
__d("TabbableElements",["Style","createArrayFrom"],function(a,b,c,d,e,f){var g=b('Style'),h=b('createArrayFrom'),i={find:function(j){function k(n){if(n.tabIndex>0)return true;switch(n.tagName){case "A":return n.href&&n.rel!="ignore";case "INPUT":return n.type!="hidden"&&n.type!="file"&&!n.disabled;case "SELECT":return !n.disabled;case "TEXTAREA":return !n.disabled;default:return false;}}function l(n){if(n.offsetHeight===0&&n.offsetWidth===0)return true;var o=n;while(o&&o!=j&&g.get(o,'visibility')!=='hidden')o=o.parentNode;return o!==j;}var m=h(j.getElementsByTagName("*"));return m.filter(function(n){return k(n)&&!l(n);});}};e.exports=i;});
__d("LayerTabIsolation",["event-extensions","copyProperties","TabbableElements","Keys","Input"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('TabbableElements'),i=b('Keys'),j=b('Input');function k(l){this._layer=l;}g(k.prototype,{_tabHandler:null,_subscriptions:[],enable:function(){this._subscriptions=[this._layer.subscribe('show',this._attachHandler.bind(this)),this._layer.subscribe('hide',this._detachHandler.bind(this))];},disable:function(){while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._detachHandler();},_attachHandler:function(){var l=this._layer.getRoot();this._tabHandler=Event.listen(l,'keydown',function(m){if(Event.getKeyCode(m)==i.TAB){var n=m.getTarget();if(n){var o=h.find(l),p=o[0],q=o[o.length-1],r=m.getModifiers().shift;if(r&&n==p){m.preventDefault();j.focus(q);}else if(!r&&n==q){m.preventDefault();j.focus(p);}}}});},_detachHandler:function(){if(this._tabHandler){this._tabHandler.remove();this._tabHandler=null;}}});e.exports=k;});
__d("LayerMouseHooks",["event-extensions","function-extensions","ContextualThing","DOM","Layer","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('ContextualThing'),h=b('DOM'),i=b('Layer'),j=b('copyProperties');function k(l){this._layer=l;}j(k.prototype,{_mouseSubscriptions:[],_layerSubscriptions:[],enable:function(){var l=this._layer.getRoot();this._mouseSubscriptions=[Event.listen(l,'mouseenter',this._onMouseEnter.bind(this)),Event.listen(l,'mouseleave',this._onMouseLeave.bind(this))];this._layerSubscriptions=[i.subscribe('show',this._onLayerShow.bind(this)),i.subscribe('hide',this._onLayerHide.bind(this))];},disable:function(){this._mouseSubscriptions.forEach(function(l){l.remove();});this._mouseSubscriptions=[];this._layerSubscriptions.forEach(function(l){i.unsubscribe(l);});this._layerSubscriptions=[];},_onMouseEnter:function(l){this._fireMouseLeaveOnLayerHide=false;if(!this._spawnedLayer)this._layer.inform('mouseenter');},_onMouseLeave:function(l){if(!this._spawnedLayer)this._layer.inform('mouseleave');this._fireMouseLeaveOnLayerHide=!!this._spawnedLayer;},_onLayerShow:function(l,m){var n=m.getContext&&m.getContext();if(n)if(h.contains(this._layer.getRoot(),n))this._spawnedLayer=m;},_onLayerHide:function(l,m){if(m===this._spawnedLayer){this._spawnedLayer=null;if(this._fireMouseLeaveOnLayerHide)this._onMouseLeave.bind(this).defer();}}});e.exports=k;});
__d("Overlay",["Arbiter","Class","CSS","DataStore","DOM","Layer","LayerAutoFocus","LayerButtons","LayerDestroyOnHide","LayerFadeOnHide","LayerFadeOnShow","LayerFormHooks","LayerHideOnBlur","LayerHideOnEscape","LayerHideOnSuccess","LayerHideOnTransition","LayerTabIsolation","LayerMouseHooks","$","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Class'),i=b('CSS'),j=b('DataStore'),k=b('DOM'),l=b('Layer'),m=b('LayerAutoFocus'),n=b('LayerButtons'),o=b('LayerDestroyOnHide'),p=b('LayerFadeOnHide'),q=b('LayerFadeOnShow'),r=b('LayerFormHooks'),s=b('LayerHideOnBlur'),t=b('LayerHideOnEscape'),u=b('LayerHideOnSuccess'),v=b('LayerHideOnTransition'),w=b('LayerTabIsolation'),x=b('LayerMouseHooks'),y=b('$'),z=b('copyProperties');function aa(ba,ca){ba=z({buildWrapper:true},ba||{});this._shouldBuildWrapper=ba.buildWrapper;this.parent.construct(this,ba,ca);}h.extend(aa,l);z(aa.prototype,{_configure:function(ba,ca){this.parent._configure(ba,ca);var da=this.getRoot();this._overlay=k.scry(da,'div.uiOverlay')[0]||da;i.hide(da);k.appendContent(this.getInsertParent(),da);j.set(this._overlay,'overlay',this);var ea=j.get(this._overlay,'width');ea&&this.setWidth(ea);if(this.setFixed)this.setFixed(j.get(this._overlay,'fixed')=='true');if(j.get(this._overlay,'fadeonshow')!='false')this.enableBehavior(q);if(j.get(this._overlay,'fadeonhide')!='false')this.enableBehavior(p);if(j.get(this._overlay,'hideonsuccess')!='false')this.enableBehavior(u);if(j.get(this._overlay,'hideonblur')=='true')this.enableBehavior(s);if(j.get(this._overlay,'destroyonhide')!='false')this.enableBehavior(o);return this;},_getDefaultBehaviors:function(){return this.parent._getDefaultBehaviors().concat([m,n,r,x,t,v,w]);},initWithoutBuildingWrapper:function(){this._shouldBuildWrapper=false;return this.init.apply(this,arguments);},_buildWrapper:function(ba,ca){ca=this.parent._buildWrapper(ba,ca);if(!this._shouldBuildWrapper){this._contentRoot=ca;return ca;}this._contentRoot=k.create('div',{className:'uiOverlayContent'},ca);return k.create('div',{className:'uiOverlay'},this._contentRoot);},_getContentRoot:function(){return this._contentRoot;},destroy:function(){j.remove(this.getRoot(),'overlay');this.parent.destroy();}});e.exports=aa;});
__d("ContextualDialogX",["event-extensions","ARIA","Arbiter","ArbiterMixin","Bootloader","Class","ContextualDialogFooterLink","ContextualThing","CSS","DataStore","DOM","Locale","Overlay","Parent","Style","Vector","$","copyProperties","getOverlayZIndex"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ARIA'),h=b('Arbiter'),i=b('ArbiterMixin'),j=b('Bootloader'),k=b('Class'),l=b('ContextualDialogFooterLink'),m=b('ContextualThing'),n=b('CSS'),o=b('DataStore'),p=b('DOM'),q=b('Locale'),r=b('Overlay'),s=b('Parent'),t=b('Style'),u=b('Vector'),v=b('$'),w=b('copyProperties'),x=b('getOverlayZIndex');function y(z,aa){this.parent.construct(this,z,aa);}k.extend(y,r);w(y,i,{ARROW_OFFSET:15,ARROW_LENGTH:16,ARROW_INSET:22,TOP_MARGIN:8,BOTTOM_MARGIN:30,LEFT_MARGIN:15,RIGHT_MARGIN:30,POSITION_TO_CLASS:{above:'uiContextualDialogAbove',below:'uiContextualDialogBelow',left:'uiContextualDialogLeft',right:'uiContextualDialogRight'},RIGHT_ALIGNED_CLASS:'uiContextualDialogRightAligned',ARROW_CLASS:{bottom:'uiContextualDialogArrowBottom',top:'uiContextualDialogArrowTop',right:'uiContextualDialogArrowRight',left:'uiContextualDialogArrowLeft'},POSITION_TO_ARROW:{above:'bottom',below:'top',left:'right',right:'left'},getInstance:function(z){var aa=o.get(z,'ContextualDialogX');if(!aa){var ba=s.byClass(z,'uiOverlay');if(ba)aa=o.get(ba,'overlay');}return aa;}});w(y.prototype,{_scrollListener:null,_scrollParent:null,_width:null,_fixed:false,_hasCustomArrow:false,_hasFooter:false,_showSubscription:null,_hideSubscription:null,_hovercardSubscription:null,_setContextSubscription:null,_resizeListener:null,_reflowSubscription:null,_configure:function(z,aa){this.parent._configure(z,aa);var ba=this.getRoot(),ca=o.get.curry(ba);this.setAlignH(ca('alignh','left'));this.setOffsetX(ca('offsetx',0));this.setOffsetY(ca('offsety',0));this.setPosition(ca('position','above'));this._hasCustomArrow=ca('hascustomarrow',false);this._hasFooter=ca('hasfooter',false);if(this._hasFooter){var da=p.scry(ba,'.uiContextualDialogFooterLink')[0];da&&this.enableBehavior(l);}this._setContextSubscription=this.subscribe('beforeshow',function(){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;var ea=ca('context');if(ea){this.setContext(v(ea));}else{ea=ca('contextselector');if(ea)this.setContext(p.find(document,ea));}}.bind(this));this._content=p.scry(ba,'.uiContextualDialogContent')[0];this._showSubscription=this.subscribe('show',function(){var ea=this.updatePosition.shield(this);this._resizeListener=Event.listen(window,'resize',ea);this._reflowSubscription=h.subscribe('reflow',ea);this._setupScrollListener(this._scrollParent);m.register(ba,this.context);h.inform('layer_shown',{type:'ContextualDialog'});}.bind(this));this._hideSubscription=this.subscribe('hide',function(){this._teardownResizeAndReflowListeners();this._teardownScrollListener();m.remove(ba);h.inform('layer_hidden',{type:'ContextualDialog'});}.bind(this));this._hovercardSubscription=h.subscribe('Hovercard/hide',function(ea,fa){if(a.Hovercard.contains(this.getContext()))this.hide();}.bind(this));return this;},_buildWrapper:function(z,aa){var ba=this.parent._buildWrapper(z,aa);if(!this._shouldBuildWrapper)return ba;n.addClass(ba,'uiContextualDialog');return p.create('div',{className:'uiContextualDialogPositioner'},ba);},setWidth:function(z){this._width=Math.floor(z);return this;},setFixed:function(z){z=!!z;n.conditionClass(this.getRoot(),'uiContextualDialogFixed',z);this._fixed=z;return this;},setAlignH:function(z){this.alignH=z;this._updateAlignmentClass();this._shown&&this.updatePosition();this.position&&this._updateArrow();return this;},getContent:function(){return this._content;},getContext:function(){return this.context;},setContext:function(z){if(this._setContextSubscription){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;}z=v(z);if(this.context&&this.context!=z)o.remove(this.context,'ContextualDialogX');this.context=z;g.setPopup(this.getCausalElement(),this.getRoot());var aa=s.byClass(z,'fbPhotoSnowlift');this.setInsertParent(aa||document.body);if(this._scrollListener&&this._scrollParent!==aa){this._teardownScrollListener();this._setupScrollListener(aa);}this._scrollParent=aa;var ba=x(z,this._insertParent);t.set(this.getRoot(),'z-index',ba>200?ba:'');o.set(this.context,'ContextualDialogX',this);return this;},getCausalElement:function(){return this.parent.getCausalElement()||this.context;},listen:function(z,aa){return Event.listen(this.getRoot(),z,aa);},setOffsetX:function(z){this.offsetX=parseInt(z,10)||0;this._shown&&this.updatePosition();return this;},setOffsetY:function(z){this.offsetY=parseInt(z,10)||0;this._shown&&this.updatePosition();return this;},setPosition:function(z){this.position=z;for(var aa in y.POSITION_TO_CLASS)n.conditionClass(this.getRoot(),y.POSITION_TO_CLASS[aa],z==aa);this._updateAlignmentClass();this._shown&&this.updatePosition();this._updateArrow();return this;},updatePosition:function(){if(!this.context)return false;if(this._width)t.set(this._overlay,'width',this._width+'px');var z=this._fixed?'viewport':'document',aa=u.getElementPosition(this.context,z),ba=this._scrollParent;if(ba)aa=aa.sub(u.getElementPosition(ba,'document')).add(ba.scrollLeft,ba.scrollTop);var ca=u.getElementDimensions(this.context),da=this.position=='above'||this.position=='below',ea=q.isRTL();if((this.position=='right'||(da&&this.alignH=='right'))!=ea)aa=aa.add(ca.x,0);if(this.position=='below')aa=aa.add(0,ca.y);var fa=new u(0,0);if(da&&this.alignH=='center'){fa=fa.add((ca.x-this._width)/2,0);}else{var ga=da?ca.x:ca.y,ha=2*y.ARROW_INSET;if(ga<ha){var ia=ga/2-y.ARROW_INSET;if(da&&(this.alignH=='right'!=ea))ia=-ia;fa=fa.add(da?ia:0,da?0:ia);}}fa=fa.add(this.offsetX,this.offsetY);if(ea)fa=fa.mul(-1,1);aa=aa.add(fa);if(this._fixed)aa=new u(aa.x,aa.y,'document');aa.setElementPosition(this.getRoot());this._adjustVerticalPosition();this._adjustHorizontalPosition();return true;},scrollTo:function(){if(this.context)j.loadModules(['DOMScroll'],function(z){z.scrollTo(this.context,true,true);}.bind(this));},destroy:function(){this.unsubscribe(this._showSubscription);this.unsubscribe(this._hideSubscription);this._hovercardSubscription.unsubscribe();if(this._setContextSubscription){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;}this._teardownScrollListener();this._teardownResizeAndReflowListeners();this.context&&o.remove(this.context,'ContextualDialogX');this.parent.destroy();},_adjustVerticalPosition:function(){if(this.position!='left'&&this.position!='right'){t.set(this._overlay,'top','');return;}var z=this.getRoot(),aa=u.getElementPosition(z,'viewport').y,ba=u.getElementDimensions(this._overlay).y,ca=u.getViewportDimensions().y,da=y.TOP_MARGIN,ea=Math.min(Math.max(0,aa+ba+y.BOTTOM_MARGIN-ca),Math.max(-da,aa-da),ba-2*y.ARROW_INSET);t.set(this._overlay,'top',(-1*ea)+'px');t.set(this._arrow,'top',y.ARROW_OFFSET+'px');t.set(this._arrow,'marginTop',ea+'px');},_adjustHorizontalPosition:function(){if((this.position!='above'&&this.position!='below')||this.alignH!='left'){t.set(this._overlay,'left','');t.set(this._overlay,'right','');return;}var z=this.getRoot(),aa=u.getElementPosition(z,'viewport').x,ba=u.getElementDimensions(this._overlay).x,ca=u.getViewportDimensions().x,da=q.isRTL(),ea;if(!da){ea=aa+ba+y.RIGHT_MARGIN-ca;}else ea=y.LEFT_MARGIN+ba-aa;ea=Math.min(Math.max(0,ea),ba-2*y.ARROW_INSET);t.set(this._overlay,da?'right':'left',-1*ea+'px');t.set(this._arrow,da?'right':'left',y.ARROW_OFFSET+'px');t.set(this._arrow,da?'marginRight':'marginLeft',ea+'px');},_updateArrow:function(){var z=0;if(this.position=='above'||this.position=='below')switch(this.alignH){case 'center':z=50;break;case 'right':z=100;break;}this._renderArrow(y.POSITION_TO_ARROW[this.position],z);},_renderArrow:function(z,aa){for(var ba in y.ARROW_CLASS)n.conditionClass(this._overlay,y.ARROW_CLASS[ba],z==ba);n.conditionClass(this._overlay,'uiContextualDialogWithFooterArrowBottom',z=='bottom'&&this._hasFooter);if(z=='none')return;if(!this._arrow){this._arrow=p.create('i',{className:'uiContextualDialogArrow'});p.appendContent(this._overlay,this._arrow);}t.set(this._arrow,'top','');t.set(this._arrow,'left','');t.set(this._arrow,'right','');t.set(this._arrow,'margin','');var ca=z=='top'||z=='bottom',da=ca?(q.isRTL()?'right':'left'):'top';aa=aa||0;t.set(this._arrow,da,aa+'%');var ea=y.ARROW_LENGTH+y.ARROW_OFFSET*2,fa=-(ea*aa/100-y.ARROW_OFFSET);t.set(this._arrow,'margin-'+da,fa+'px');if(this._hasCustomArrow)y.inform('arrow_rendered',{type:'ContextualDialog',root:this._root,position:z,side:da,offset_percent:aa,side_margin:fa});},_updateAlignmentClass:function(){n.conditionClass(this.getRoot(),y.RIGHT_ALIGNED_CLASS,(this.position=='above'||this.position=='below')&&this.alignH=='right');},_setupScrollListener:function(z){this._scrollListener=Event.listen(z||window,'scroll',this._adjustVerticalPosition.shield(this));},_teardownScrollListener:function(){if(this._scrollListener){this._scrollListener.remove();this._scrollListener=null;}},_teardownResizeAndReflowListeners:function(){if(this._resizeListener){this._resizeListener.remove();this._resizeListener=null;}if(this._reflowSubscription){this._reflowSubscription.unsubscribe();this._reflowSubscription=null;}}});e.exports=y;});
__d("Toggler",["array-extensions","event-extensions","Arbiter","ArbiterMixin","Class","ContextualDialogX","ContextualThing","CSS","DataStore","Dialog","DOM","copyProperties","createArrayFrom","ge","getObjectValues"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Class'),j=b('ContextualDialogX'),k=b('ContextualThing'),l=b('CSS'),m=b('DataStore'),n=b('Dialog'),o=b('DOM'),p=b('copyProperties'),q=b('createArrayFrom'),r=b('ge'),s=b('getObjectValues'),t=[],u;function v(){v=bagofholding;Event.listen(document.documentElement,'click',function(event){var z=event.getTarget();t.forEach(function(aa){aa.clickedTarget=z;aa.active&&!aa.sticky&&!k.containsIncludingLayers(aa.getActive(),z)&&!aa.inTargetFlyout(z)&&aa.inActiveDialog()&&aa.hide();});},Event.Priority.URGENT);}var w=function(){this.active=null;this.togglers={};this.setSticky(false);t.push(this);this.subscribe(['show','hide'],w.inform.bind(w));return v();};p(w.prototype,h,{show:function(z){var aa=x(this,z),ba=aa.active;if(z!==ba){ba&&aa.hide();aa.active=z;l.addClass(z,'openToggler');var ca=o.scry(z,'a[rel="toggle"]');if(ca.length>0&&ca[0].getAttribute('data-target'))l.removeClass(r(ca[0].getAttribute('data-target')),'toggleTargetClosed');o.appendContent(z,aa.getToggler('next'));o.prependContent(z,aa.getToggler('prev'));aa.inform('show',aa);}},hide:function(z){var aa=x(this,z),ba=aa.active;if(ba&&(!z||z===ba)){l.removeClass(ba,'openToggler');var ca=o.scry(ba,'a[rel="toggle"]');if(ca.length>0&&ca[0].getAttribute('data-target'))l.addClass(r(ca[0].getAttribute('data-target')),'toggleTargetClosed');s(aa.togglers).forEach(o.remove);aa.inform('hide',aa);aa.active=null;}},toggle:function(z){var aa=x(this,z);if(aa.active===z){aa.hide();}else aa.show(z);},getActive:function(){return x(this).active;},isShown:function(){return x(this).active&&l.hasClass(x(this).active,'openToggler');},inTargetFlyout:function(z){var aa=y(this.getActive());return aa&&k.containsIncludingLayers(aa,z);},inActiveDialog:function(){var z=n.getCurrent();return !z||o.contains(z.getRoot(),this.getActive());},getToggler:function(z){var aa=x(this);if(!aa.togglers[z]){aa.togglers[z]=o.create('button',{className:'hideToggler',onfocus:function(){var ba=o.scry(aa.active,'a[rel="toggle"]')[0];ba&&ba.focus();aa.hide();}});aa.togglers[z].setAttribute('type','button');}return this.togglers[z];},setSticky:function(z){var aa=x(this);z=z!==false;if(z!==aa.sticky){aa.sticky=z;if(z){aa._pt&&aa._pt.unsubscribe();}else aa._pt=g.subscribe('page_transition',aa.hide.bind(aa,null));}return aa;}});p(w,w.prototype);p(w,{bootstrap:function(z){var aa=z.parentNode;w.getInstance(aa).toggle(aa);},createInstance:function(z){var aa=new w().setSticky(true);m.set(z,'toggler',aa);return aa;},getInstance:function(z){while(z){var aa=m.get(z,'toggler');if(aa)return aa;if(l.hasClass(z,'uiToggleContext'))return w.createInstance(z);z=z.parentNode;}return (u=u||new w());},listen:function(z,aa,ba){return w.subscribe(q(z),function(ca,da){if(da.getActive()===aa)return ba(ca,da);});},subscribe:(function(z){return function(aa,ba){aa=q(aa);if(aa.contains('show'))t.forEach(function(ca){if(ca.getActive())ba.curry('show',ca).defer();});return z(aa,ba);};})(w.subscribe.bind(w))});function x(z,aa){if(z instanceof w)return z;return w.getInstance(aa);}function y(z){var aa=o.scry(z,'a[rel="toggle"]');if(aa.length>0&&aa[0].getAttribute('data-target'))return r(aa[0].getAttribute('data-target'));}e.exports=w;});
__d("Dock",["event-extensions","function-extensions","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Style","Toggler","Vector","copyProperties","ge"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('ChatQuietLinks'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('Parent'),n=b('Style'),o=b('Toggler'),p=b('Vector'),q=b('copyProperties'),r=b('ge');function s(){}q(s,h,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(t){this.init=bagofholding;this.rootEl=t;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();i.removeEmptyHrefs(this.rootEl);Event.listen(t,'click',this._onClick.bind(this));Event.listen(window,'resize',this._onWindowResize.bind(this));o.subscribe(['show','hide'],function(u,v){var w=v.getActive();if(!l.contains(t,w))return;if(j.hasClass(w,'fbNub')){this.notifyNub(w,u);if(u==='show')this._resizeNubFlyout(w);}else{var x=m.byClass(w,'fbNubFlyout');if(x)j.conditionClass(x,'menuOpened',u==='show');}}.bind(this));this.inform('init',{},g.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=p.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+p.getElementDimensions(this.rootEl).y;var t=r('blueBar');if(t){var u=n.isFixed(t)?'viewport':'document';this.flyoutHeightOffset+=p.getElementPosition(t,u).y+p.getElementDimensions(t).y;}},toggle:function(t){var u=this._findFlyout(t);if(!u)return;this.subscribe('init',function(){o.toggle(t);});},show:function(t){this.subscribe('init',function(){o.show(t);});},showNub:function(t){j.show(t);},hide:function(t){this.subscribe('init',function(){var u=o.getInstance(t);l.contains(t,u.getActive())&&u.hide();});},hideNub:function(t){j.hide(t);this.hide(t);},setUseMaxHeight:function(t,u){j.conditionClass(t,'maxHeight',u!==false);this._resizeNubFlyout(t);},_resizeNubFlyout:function(t){var u=this._findFlyout(t);if(!u||!(j.hasClass(t,'openToggler')||j.hasClass(t,'opened')))return;var v=l.find(u,'div.fbNubFlyoutOuter'),w=l.find(v,'div.fbNubFlyoutInner'),x=l.find(w,'div.fbNubFlyoutBody'),y=x.scrollTop,z=x.offsetHeight;n.set(x,'height','auto');var aa=p.getElementPosition(u,'viewport'),ba=p.getElementDimensions(u),ca=p.getElementDimensions(x),da=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-aa.y-ba.y);da=Math.max(da,0);n.set(u,'max-height',da+'px');n.set(v,'max-height',da+'px');ba=p.getElementDimensions(u);var ea=p.getElementDimensions(w),fa=ea.y-ca.y;if(ba.y>fa)n.set(x,'height',(ba.y-fa)+'px');j.removeClass(u,'swapDirection');var ga=p.getElementPosition(u).x;j.conditionClass(u,'swapDirection',function(){if(ga<0)return true;return (ga+ba.x>this.viewportDimensions.x);}.bind(this)());if(y+z>=ca.y){x.scrollTop=ca.y;}else x.scrollTop=y;this.notifyNub(t,'resize');},resizeAllFlyouts:function(){var t=l.scry(this.rootEl,'div.fbNub.openToggler');t=t.concat(l.scry(this.rootEl,'div.fbNub.opened'));var u=t.length;while(u--)this._resizeNubFlyout(t[u]);},_onClick:function(event){var t=event.getTarget(),u=m.byClass(t,'fbNub');if(u){if(m.byClass(t,'fbNubFlyoutTitlebar')){var v=m.byTag(t,'a');if(!v){this.hide(u);return false;}}this.notifyNub(u,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(t){return j.hasClass(t,'fbNubFlyout')?t:l.scry(t,'div.fbNubFlyout')[0]||null;},registerNubController:function(t,u){k.set(t,'dock:nub:controller',u);u.subscribe('nub/button/content-changed',this.inform.shield(this,'resize',t));u.subscribe('nub/flyout/content-changed',this._resizeNubFlyout.shield(this,t));},unregisterNubController:function(t){k.remove(t,'dock:nub:controller');},notifyNub:function(t,u,v){var w=k.get(t,'dock:nub:controller');w&&w.inform(u,v);}});e.exports=a.Dock||s;});
__d("NubController",["ArbiterMixin","Class","Dock","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('Class'),i=b('Dock'),j=b('copyProperties');function k(){}j(k.prototype,g,{init:function(l){this.el=l;i.registerNubController(l,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){i.hide(this.el);},show:function(){i.show(this.el);}});e.exports=k;});
__d("NavigationMessage",[],function(a,b,c,d,e,f){var g={NAVIGATION_BEGIN:'NavigationMessage/navigationBegin',NAVIGATION_SELECT:'NavigationMessage/navigationSelect',NAVIGATION_FIRST_RESPONSE:'NavigationMessage/navigationFirstResponse',NAVIGATION_COMPLETED:'NavigationMessage/navigationCompleted',NAVIGATION_FAILED:'NavigationMessage/navigationFailed',NAVIGATION_COUNT_UPDATE:'NavigationMessage/navigationCount',NAVIGATION_FAVORITE_UPDATE:'NavigationMessage/navigationFavoriteUpdate',NAVIGATION_ITEM_REMOVED:'NavigationMessage/navigationItemRemoved',NAVIGATION_ITEM_HIDDEN:'NavigationMessage/navigationItemHidden',INTERNAL_LOADING_BEGIN:'NavigationMessage/internalLoadingBegin',INTERNAL_LOADING_COMPLETED:'NavigationMessage/internalLoadingCompleted'};e.exports=g;});
__d("legacy:ui-side-nav-message",["NavigationMessage"],function(a,b,c,d){a.NavigationMessage=b('NavigationMessage');},3);
__d("DropdownContextualHelpLink",["copyProperties","DOM","ge"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('DOM'),i=b('ge'),j={set:function(k){var l=i('navHelpCenter');if(l!==null)h.replace(l,k);}};e.exports=j;});
__d("SimpleDrag",["event-extensions","ArbiterMixin","Class","UserAgent","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('UserAgent'),j=b('Vector'),k=b('copyProperties');function l(m){this.minDragDistance=0;Event.listen(m,'mousedown',this._start.bind(this));}k(l.prototype,g,{setMinDragDistance:function(m){this.minDragDistance=m;},_start:function(event){var m=false,n=true,o=null;if(this.inform('mousedown',event))n=false;if(this.minDragDistance){o=j.getEventPosition(event);}else{m=true;if(this.inform('start',event))n=false;}var p=i.ie()<9?document.documentElement:window,q=Event.listen(p,{selectstart:n?Event.prevent:bagofholding,mousemove:function(event){if(!m){var r=j.getEventPosition(event);if(o.distanceTo(r)<this.minDragDistance)return;m=true;this.inform('start',event);}this.inform('update',event);}.bind(this),mouseup:function(event){for(var r in q)q[r].remove();if(m){this.inform('end',event);}else this.inform('click',event);}.bind(this)});return !n;}});e.exports=l;});
__d("isRTL",[],function(a,b,c,d,e,f){function g(i){for(var j=0,k=i.length;j<k;j++){var l=i.charCodeAt(j);if(l>=1470&&l<=1920)return true;}return false;}function h(i){var j=0,k=0;i.split(/\s/,10).forEach(function(l){j++;g(l)&&k++;});return j&&(k/j>=.4);}e.exports=h;});
__d("legacy:bind",["bind"],function(a,b,c,d){a.bind=b('bind');},3);
__d("ScrollAwareDOM",["ArbiterMixin","CSS","DOM","DOMDimensions","DOMPosition","DOMQuery","HTML","Vector","ViewportBounds","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('CSS'),i=b('DOM'),j=b('DOMDimensions'),k=b('DOMPosition'),l=b('DOMQuery'),m=b('HTML'),n=b('Vector'),o=b('ViewportBounds'),p=b('copyProperties');function q(v,w){return function(){u.monitor(arguments[v],w.curry.apply(w,arguments));};}function r(v){if(!(v instanceof Array))v=[v];for(var w=0;w<v.length;w++){var x=m.replaceJSONWrapper(v[w]);if(x instanceof m){return x.getRootNode();}else if(i.isNode(x))return x;}return null;}function s(v){return k.getElementPosition(v).y>=o.getTop();}function t(v){var w=k.getElementPosition(v).y+j.getElementDimensions(v).height,x=j.getViewportDimensions().height-o.getBottom();return w>=x;}var u=p({monitor:function(v,w){var x=r(v);if(x){var y=!!x.offsetParent;if(y&&(s(x)||t(x)))return w();var z=n.getDocumentDimensions(),aa=w();if(y||(x.offsetParent&&!s(x))){var ba=n.getDocumentDimensions().sub(z),ca={delta:ba,target:x};if(u.inform('scroll',ca)!==false)ba.scrollElementBy(l.getDocumentScrollElement());}return aa;}else return w();},replace:function(v,w){var x=r(w);if(!x||h.hasClass(x,'hidden_elem'))x=v;return u.monitor(x,function(){i.replace(v,w);});},prependContent:q(1,i.prependContent),insertAfter:q(1,i.insertAfter),insertBefore:q(1,i.insertBefore),setContent:q(0,i.setContent),appendContent:q(1,i.appendContent),remove:q(0,i.remove),empty:q(0,i.empty)},g);e.exports=u;});
__d("legacy:ScrollAwareDOM",["ScrollAwareDOM"],function(a,b,c,d){a.ScrollAwareDOM=b('ScrollAwareDOM');},3);
__d("legacy:Style",["Style"],function(a,b,c,d){a.Style=b('Style');},3);
__d("legacy:dom-form",["Form"],function(a,b,c,d){a.Form=b('Form');},3);
__d("legacy:dom-html",["HTML"],function(a,b,c,d){a.HTML=b('HTML');},3);
function show(){for(var a=0;a<arguments.length;a++){var b=ge(arguments[a]);if(b&&b.style)b.style.display='';}return false;}function hide(){for(var a=0;a<arguments.length;a++){var b=ge(arguments[a]);if(b&&b.style)b.style.display='none';}return false;}function shown(a){a=ge(a);return (a.style.display!='none'&&!(a.style.display==''&&a.offsetWidth==0));}function toggle(){for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);b.style.display=Style.get(b,"display")=='block'?'none':'block';}return false;}function toggleDisplayNone(){for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);if(shown(b)){hide(b);}else show(b);}return false;}
__d("legacy:dom-scroll",["DOMScroll"],function(a,b,c,d){a.DOMScroll=b('DOMScroll');},3);
__d("SystemEvents",["Arbiter","Env","ErrorUtils","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Env'),i=b('ErrorUtils'),j=b('UserAgent'),k=b('copyProperties'),l=new g(),m=[],n=1000;setInterval(function(){for(var w=0;w<m.length;w++)m[w]();},n,false);function o(){return (/c_user=(\d+)/.test(document.cookie)&&RegExp.$1)||0;}var p=h.user,q=navigator.onLine;function r(){if(!q){q=true;l.inform(l.ONLINE,q);}}function s(){if(q){q=false;l.inform(l.ONLINE,q);}}if(j.ie()){if(j.ie()>=8){window.attachEvent('onload',function(){document.body.ononline=r;document.body.onoffline=s;});}else m.push(function(){(navigator.onLine?r:s)();});}else if(window.addEventListener)if(!j.chrome()){window.addEventListener('online',r,false);window.addEventListener('offline',s,false);}var t=p;m.push(function(){var w=o();if(t!=w){l.inform(l.USER,w);t=w;}});var u=Date.now();function v(){var w=Date.now(),x=w-u,y=x<0||x>10000;u=w;if(y)l.inform(l.TIME_TRAVEL,x);return y;}m.push(v);m.push(function(){if(window.onerror!=i.onerror)window.onerror=i.onerror;});a.SystemEvents=e.exports=k(l,{USER:'SystemEvents/USER',ONLINE:'SystemEvents/ONLINE',TIME_TRAVEL:'SystemEvents/TIME_TRAVEL',isPageOwner:function(w){return (w||o())==p;},isOnline:function(){return j.chrome()||q;},checkTimeTravel:v});},3);
__d("legacy:link-controller",["LinkController"],function(a,b,c,d){a.LinkController=b('LinkController');},3);
__d("IntlDateFormats",[],function(a,b,c,d,e,f){var g={},h={setFormats:function(i,j){g=j;},getFormat:function(i){if(!(i in g))return i;return g[i];}};e.exports=h;});
__d("legacy:vector",["Vector"],function(a,b,c,d){a.Vector2=b('Vector');},3);
__d("AsyncRequestNectarLogging",["AsyncRequest","Env","copyProperties","startsWith"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Env'),i=b('copyProperties'),j=b('startsWith');i(g.prototype,{setNectarModuleData:function(k){if(this.method=='POST'){var l=h.module;if(k&&l===undefined){var m={fbpage_fan_confirm:1},n=null;for(var o=k;o&&o!=document.body;o=o.parentNode){if(!o.id||typeof o.id!=='string')continue;if(j(o.id,'pagelet_')){l=o.id;break;}if(!n&&m[o.id])n=o.id;}if(l===undefined&&n)l=n;}if(l!==undefined){if(this.data.nctr===undefined)this.data.nctr={};this.data.nctr._mod=l;}}},setNectarImpressionId:function(){if(this.method=='POST'){var k=h.impid;if(k!==undefined){if(this.data.nctr===undefined)this.data.nctr={};this.data.nctr._impid=k;}}}});});
__d("legacy:async-postlude",["AsyncRequestNectarLogging"],function(a,b,c,d){b('AsyncRequestNectarLogging');},3);
__d("Base64",[],function(a,b,c,d,e,f){var g='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';function h(l){l=(l.charCodeAt(0)<<16)|(l.charCodeAt(1)<<8)|l.charCodeAt(2);return String.fromCharCode(g.charCodeAt(l>>>18),g.charCodeAt((l>>>12)&63),g.charCodeAt((l>>>6)&63),g.charCodeAt(l&63));}var i='>___?456789:;<=_______'+'\0\1\2\3\4\5\6\7\b\t\n\13\f\r\16\17\20\21\22\23\24\25\26\27\30\31'+'______\32\33\34\35\36\37 !"#$%&\'()*+,-./0123';function j(l){l=(i.charCodeAt(l.charCodeAt(0)-43)<<18)|(i.charCodeAt(l.charCodeAt(1)-43)<<12)|(i.charCodeAt(l.charCodeAt(2)-43)<<6)|i.charCodeAt(l.charCodeAt(3)-43);return String.fromCharCode(l>>>16,(l>>>8)&255,l&255);}var k={encode:function(l){l=unescape(encodeURI(l));var m=(l.length+2)%3;l=(l+'\0\0'.slice(m)).replace(/[\s\S]{3}/g,h);return l.slice(0,l.length+m-2)+'=='.slice(m);},decode:function(l){l=l.replace(/[^A-Za-z0-9+\/]/g,'');var m=(l.length+3)&3;l=(l+'AAA'.slice(m)).replace(/..../g,j);l=l.slice(0,l.length+m-3);try{return decodeURIComponent(escape(l));}catch(n){throw new Error('Not valid UTF-8');}},encodeObject:function(l){return k.encode(JSON.stringify(l));},decodeObject:function(l){return JSON.parse(k.decode(l));},encodeNums:function(l){return String.fromCharCode.apply(String,l.map(function(m){return g.charCodeAt((m|-(m>63))&-(m>0)&63);}));}};e.exports=k;});
__d("legacy:base64",["Base64"],function(a,b,c,d){a.Base64=b('Base64');},3);
__d("date-extensions",["IntlDateFormats","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('IntlDateFormats'),h=b('copyProperties'),i=b('tx'),j=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=["January","February","March","April","May","June","July","August","September","October","November","December"];function n(o,p){p=p||2;o=''+o;while(o.length<p)o='0'+o;return o;}Date.format=function(o,p,q){var r=p?new Date(p*1000):new Date();return r.format(o,q);};h(Date.prototype,{format:function(o,p){if(!o)return '';var q=[],r=null,s=null,t=(p?'getUTC':'get'),u=this[t+'Date'](),v=this[t+'Day'](),w=this[t+'Month'](),x=this[t+'FullYear'](),y=this[t+'Hours'](),z=this[t+'Minutes'](),aa=this[t+'Seconds'](),ba=this[t+'Milliseconds']();for(var ca=0;ca<o.length;ca++){s=o.charAt(ca);if(s=='\\'){ca++;q.push(o.charAt(ca));continue;}switch(s){case 'd':r=n(u);break;case 'D':r=j[v];break;case 'j':r=u;break;case 'l':r=k[v];break;case 'F':r=m[w];break;case 'm':r=n(w+1);break;case 'M':r=l[w];break;case 'n':r=w+1;break;case 'Y':r=x;break;case 'y':r=(''+x).slice(2);break;case 'a':r=y<12?'am':'pm';break;case 'A':r=y<12?'AM':'PM';break;case 'g':r=(y==0||y==12)?12:y%12;break;case 'G':r=y;break;case 'h':r=(y==0||y==12)?12:n(y%12);break;case 'H':r=n(y);break;case 'i':r=n(z);break;case 's':r=n(aa);break;case 'S':r=n(ba,3);break;default:r=s;}q.push(r);}return q.join('');}});a.IntlDateFormats=g;},3);
__d("legacy:ua",["UserAgent"],function(a,b,c,d){a.ua=b('UserAgent');},3);
__d("legacy:dialog",["Dialog"],function(a,b,c,d){var e=b('Dialog');a.Dialog=e;},3);
__d("csx",[],function(a,b,c,d,e,f){function g(h){throw new Error('csx(...): Unexpected class selector transformation.');}e.exports=g;});
__d("AccessibleLayer",["event-extensions","CSS","DOM","Input","copyProperties","csx","tx"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('DOM'),i=b('Input'),j=b('copyProperties'),k=b('csx'),l=b('tx');function m(n){this._layer=n;}j(m.prototype,{enable:function(){var n=this._layer.getRoot();if(n.tabIndex==-1)n.tabIndex=0;var o=h.create('a',{className:'accessible_elem',href:'#'},["Close popup and return"]);h.appendContent(n,o);this._listener=Event.listen(o,'click',this._closeListener.bind(this));this._afterShowSubscription=this._layer.subscribe('aftershow',this._onAfterShow.bind(this));},disable:function(){this._listener.remove();this._afterShowSubscription.unsubscribe();this._listener=this._afterShowSubscription=null;},_closeListener:function(event){var n=this._layer.getCausalElement();if(n){if(n.tabIndex==-1){n.tabIndex=0;g.addClass(n,"-cx-PRIVATE-accessibleLayer__noOutline");}i.focus(n);}this._layer.hide();},_onAfterShow:function(){var n=document.activeElement,o=this._layer.getRoot();if(!h.isNodeOfType(n,['input','textarea'])&&!h.contains(o,n))i.focus(o);}});e.exports=m;});
__d("Rect",["Vector","$","copyProperties"],function(a,b,c,d,e,f){var g=b('Vector'),h=b('$'),i=b('copyProperties');function j(k,l,m,n,o){if(arguments.length===1){if(k instanceof j)return k;if(k instanceof g)return new j(k.y,k.x,k.y,k.x,k.domain);return j.getElementBounds(h(k));}i(this,{t:k,r:l,b:m,l:n,domain:o||'pure'});}i(j.prototype,{w:function(){return this.r-this.l;},h:function(){return this.b-this.t;},toString:function(){return '(('+this.l+', '+this.t+'), ('+this.r+', '+this.b+'))';},contains:function(k){k=new j(k).convertTo(this.domain);var l=this;return (l.l<=k.l&&l.r>=k.r&&l.t<=k.t&&l.b>=k.b);},add:function(k,l){if(arguments.length==1){if(k.domain!='pure')k=k.convertTo(this.domain);return this.add(k.x,k.y);}var m=parseFloat(k),n=parseFloat(l);return new j(this.t+n,this.r+m,this.b+n,this.l+m,this.domain);},sub:function(k,l){if(arguments.length==1){return this.add(k.mul(-1));}else return this.add(-k,-l);},boundWithin:function(k){var l=0,m=0;if(this.l<k.l){l=k.l-this.l;}else if(this.r>k.r)l=k.r-this.r;if(this.t<k.t){m=k.t-this.t;}else if(this.b>k.b)m=k.b-this.b;return this.add(l,m);},getCenter:function(){return new g(this.l+this.w()/2,this.t+this.h()/2,this.domain);},getPositionVector:function(){return new g(this.l,this.t,this.domain);},getDimensionVector:function(){return new g(this.w(),this.h(),'pure');},convertTo:function(k){if(this.domain==k)return this;if(k=='pure')return new j(this.t,this.r,this.b,this.l,'pure');if(this.domain=='pure')return new j(0,0,0,0);var l=new g(this.l,this.t,this.domain).convertTo(k);return new j(l.y,l.x+this.w(),l.y+this.h(),l.x,k);}});i(j,{deserialize:function(k){var l=k.split(':');return new j(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]),parseFloat(l[0]));},newFromVectors:function(k,l){return new j(k.y,k.x+l.x,k.y+l.y,k.x,k.domain);},getElementBounds:function(k){return j.newFromVectors(g.getElementPosition(k),g.getElementDimensions(k));},getViewportBounds:function(){return j.newFromVectors(g.getScrollPosition(),g.getViewportDimensions());},minimumBoundingBox:function(k){var l=new j(Math.min(),Math.max(),Math.max(),Math.min()),m;for(var n=0;n<k.length;n++){m=k[n];l.t=Math.min(l.t,m.t);l.r=Math.max(l.r,m.r);l.b=Math.max(l.b,m.b);l.l=Math.min(l.l,m.l);}return l;}});e.exports=j;});
__d("Hovercard",["ClickRef","event-extensions","function-extensions","AccessibleLayer","Arbiter","AsyncRequest","AsyncSignal","ContextualDialogX","CSS","DOM","DOMQuery","LayerDestroyOnHide","LayerFadeOnHide","LayerFadeOnShow","Parent","Rect","UserAgent","URI","Vector","ViewportBounds","tx","userAction"],function(a,b,c,d,e,f){b('ClickRef');b('event-extensions');b('function-extensions');var g=b('AccessibleLayer'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('AsyncSignal'),k=b('ContextualDialogX'),l=b('CSS'),m=b('DOM'),n=b('DOMQuery'),o=b('LayerDestroyOnHide'),p=b('LayerFadeOnHide'),q=b('LayerFadeOnShow'),r=b('Parent'),s=b('Rect'),t=b('UserAgent'),u=b('URI'),v=b('Vector'),w=b('ViewportBounds'),x=b('tx'),y=b('userAction'),z=450,aa=385,ba={},ca={},da=null,ea=null,fa=null,ga=150,ha=700,ia=1000,ja=250,ka=null,la=null,ma=null,na=null;function oa(){if(t.ie()<7)return;Event.listen(document.documentElement,'mouseover',pa);Event.listen(window,'scroll',function(){kb.hide(true);});h.subscribe('page_transition',function(){va();kb.dirtyAll();},h.SUBSCRIBE_NEW);h.subscribe('layer_shown',function(lb,mb){if(mb.type!='Hovercard'&&mb.type!='ContextualDialog')va();},h.SUBSCRIBE_NEW);k.subscribe('arrow_rendered',xa,h.SUBSCRIBE_NEW);}function pa(event){var lb=r.byTag(event.getTarget(),'a');kb.processNode(lb)&&event.stop();}function qa(lb){ea=lb;if(!ra(lb)){var mb;if(!lb||!(mb=sa(lb))){ca.moveToken&&ca.moveToken.remove();ca={};return false;}if(ca.node!=lb){ca.moveToken&&ca.moveToken.remove();ca={node:lb,endpoint:mb,pos:null};}}return true;}function ra(lb){return lb&&da&&ca.node==lb;}function sa(lb){return lb.getAttribute('data-hovercard');}function ta(lb){var mb=Event.listen(lb,'mouseout',function(){clearTimeout(ka);clearTimeout(la);mb.remove();ea=null;kb.hide();});if(!ca.moveToken)ca.moveToken=Event.listen(lb,'mousemove',function(event){ca.pos=v.getEventPosition(event);});clearTimeout(ka);clearTimeout(la);clearTimeout(na);var nb=ga,ob=da?ja:ha;if(lb.getAttribute('data-hovercard-instant'))nb=ob=50;ka=setTimeout(gb.curry(lb),nb);la=setTimeout(ua.curry(lb),ob);}function ua(lb,mb){if(ca.node!=lb)return;var nb=ba[sa(lb)];if(nb){wa(nb);}else if(mb){wa(ib());}else{var ob=da?ja:ha;ma=setTimeout(ua.curry(lb,true),ia-ob);}}function va(){kb.hide(true);clearTimeout(la);}function wa(lb){var mb=ca.node,nb=da,ob=nb!=mb;if(da){var pb=k.getInstance(da);pb&&pb.hide();}if(!m.contains(document.body,mb)){kb.hide(true);return;}da=mb;fa=lb;cb();lb.setContext(mb).show();if(ob){(function(){new j('/ajax/hovercard/shown.php').send();y('himp',da,null,'FORCE',{ft:{evt:39}});}).defer();if(nb){h.inform('Hovercard/hide',{node:nb});}else h.inform('layer_shown',{type:'Hovercard'});h.inform('Hovercard/show',{node:mb});}}function xa(lb,mb){var nb=ba[ca.endpoint];if(mb.type!=='ContextualDialog'||!nb||!mb.root||mb.position!=='top')return;var ob=n.scry(mb.root,'.CustomArrow')[0];if(!ob)return;var pb=n.scry(ob,'.ArrowShadow')[0];if(!pb)return;var qb=null;if(ob.style.webkitMaskPosition!==undefined){qb=ab;}else if(ya(ob))qb=bb;if(qb){l.addClass(mb.root,'withCustomArrow');setTimeout(function(){qb(ob,pb,mb);},0);}}function ya(lb){if(!lb)lb=document.body;var mb=['transform','WebkitTransform','msTransform','MozTransform','OTransform'],nb;while(nb=mb.shift())if(lb.style[nb]!==undefined)return nb;return null;}function za(lb,mb,nb){var ob=lb.parentNode.offsetWidth,pb=Math.round(ob*nb.offset_percent/100);if(nb.side==='left'){pb=pb+nb.side_margin;}else if(nb.side==='right')pb=ob-pb-nb.side_margin-18;return pb;}function ab(lb,mb,nb){l.addClass(nb.root,'usingMask');var ob=za(lb,mb,nb);lb.style.webkitMaskPositionX=ob+'px';mb.style.left=ob+'px';}function bb(lb,mb,nb){var ob=n.scry(lb,'.CoverPhoto')[0];if(!ob)return;var pb=ya(lb);if(!pb)return;l.addClass(nb.root,'usingRotate');var qb=za(lb,mb,nb)+9,rb=Math.ceil(qb/Math.SQRT2);ob.style[pb]='translate('+(-rb)+'px, '+rb+'px) rotate(-45deg)';lb.style[pb]='translate('+qb+'px, 0) rotate(45deg)';}function cb(){var lb=v.getViewportDimensions(),mb=v.getElementPosition(da,'viewport'),nb=mb.convertTo('document'),ob=fb(da),pb='above',qb='left',rb=eb(nb,ob,'above');if(mb.y+rb<=aa){var sb=eb(nb,ob,'below');if(mb.y+sb+da.offsetHeight+aa<lb.y){pb='below';rb=sb;}}var tb=lb.x-w.getRight(),ub=db(nb,ob,'left');if(mb.x+ub+z>=tb){var vb=db(nb,ob,'right');if(mb.x+vb+da.offsetWidth>z){qb='right';ub=vb;}}fa.setPosition(pb).setAlignH(qb).setOffsetX(ub).setOffsetY(rb);}function db(lb,mb,nb){if(nb=='left')return mb.l-lb.x;return mb.r-(lb.x+da.offsetWidth);}function eb(lb,mb,nb){if(nb=='above')return mb.t-lb.y;return mb.b-(lb.y+da.offsetHeight);}function fb(lb){var mb=ca.pos,nb=lb.getClientRects();if(!mb||nb.length===0)return s.getElementBounds(lb);var ob,pb=false;for(var qb=0;qb<nb.length;qb++){var rb=new s(Math.round(nb[qb].top),Math.round(nb[qb].right),Math.round(nb[qb].bottom),Math.round(nb[qb].left),'viewport').convertTo('document'),sb=rb.getPositionVector(),tb=sb.add(rb.getDimensionVector());if(!ob||(sb.x<=ob.l&&sb.y>ob.t)){if(pb)break;ob=new s(sb.y,tb.x,tb.y,sb.x,'document');}else{ob.t=Math.min(ob.t,sb.y);ob.b=Math.max(ob.b,tb.y);ob.r=tb.x;}if(rb.contains(mb))pb=true;}return ob;}function gb(lb){if(lb.id&&ba[lb.id]!=null)return;var mb=sa(lb);if(ba[mb]!=null)return;hb(mb);var nb=function(){kb.dirty(mb);va();};new i(mb).setData({endpoint:mb}).setMethod('GET').setReadOnly(true).setErrorHandler(nb).setTransportErrorHandler(nb).send();}function hb(lb){ba[lb]=false;}var ib=function(){var lb=new k({},m.create('div',{className:'HovercardLoading'},"Loading..."));lb.disableBehavior(g).disableBehavior(o).disableBehavior(q).disableBehavior(p);jb(lb);ib=bagof(lb);return lb;};function jb(lb){lb.subscribe('mouseenter',function(){clearTimeout(na);ea=ca.node;});lb.subscribe('mouseleave',function(){kb.hide(false);ea=null;});}var kb={hide:function(lb){if(!da)return;if(lb){if(fa){h.inform('layer_hidden',{type:'Hovercard'});h.inform('Hovercard/hide',{node:da});fa.hide();}ea=null;da=null;fa=null;}else na=setTimeout(kb.hide.curry(true),ja);},setDialog:function(lb,mb){mb.disableBehavior(g);ba[lb]=mb;jb(mb);if(ca.endpoint==lb&&ea==ca.node)wa(mb);},getDialog:function(lb){return ba[lb];},contains:function(lb){if(fa)return m.contains(fa.getRoot(),lb);return false;},dirty:function(lb){var mb=ba[lb];if(mb){mb.destroy();delete ba[lb];}},dirtyAll:function(){for(var lb in ba){var mb=ba[lb];mb&&kb.dirty(lb);}h.inform('Hovercard/dirty');},processNode:function(lb){if(lb&&qa(lb)){ta(lb);return true;}return false;}};if(!a.Hovercard){oa();}else kb=a.Hovercard;e.exports=kb;a.Hovercard=e.exports;});
__d("legacy:array-utils",["createArrayFrom","hasArrayNature"],function(a,b,c,d){a.$A=b('createArrayFrom');a.hasArrayNature=b('hasArrayNature');},3);
__d("legacy:env",["Env"],function(a,b,c,d){var e=b('Env');a.Env=e;},3);
__d("legacy:page-transitions",["computeRelativeURI","HistoryManager","PageTransitions"],function(a,b,c,d){a.computeRelativeURI=b('computeRelativeURI');a.HistoryManager=a.HistoryManager||b('HistoryManager');a.PageTransitions=a.PageTransitions||b('PageTransitions');},3);
__d("FlipDirectionOnKeypress",["event-extensions","DOM","Input","Style"],function(a,b,c,d,e,f){b('event-extensions');var g=b('DOM'),h=b('Input'),i=b('Style');Event.listen(document.documentElement,'keyup',function(event){var j=event.getTarget();if(!g.isNodeOfType(j,['input','textarea']))return;if(g.isNodeOfType(j,'input')&&j.type=='password')return;if(j.getAttribute('data-prevent-auto-flip'))return;var k=h.getValue(j),l=(j.style&&j.style.direction);if(!l){var m=0,n=true;for(var o=0;o<k.length;o++){var p=k.charCodeAt(o);if(p>=48){if(n){n=false;m++;}if(p>=1470&&p<=1920){i.set(j,'direction','rtl');return;}if(m==5){i.set(j,'direction','ltr');return;}}else n=true;}}else if(k.length===0)i.set(j,'direction','');});});
__d("PlaceholderOnsubmitFormListener",["event-extensions","Input"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Input');Event.listen(document.documentElement,'submit',function(h){var i=h.getTarget().getElementsByTagName('*');for(var j=0;j<i.length;j++)if(i[j].getAttribute('placeholder')&&g.isEmpty(i[j]))g.setValue(i[j],'');});});
__d("RequiredFormListener",["event-extensions","Input"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Input');Event.listen(document.documentElement,'submit',function(h){var i=h.getTarget().getElementsByTagName('*');for(var j=0;j<i.length;j++)if(i[j].getAttribute('required')&&g.isEmpty(i[j])){i[j].focus();return false;}},Event.Priority.URGENT);});
__d("Live",["Arbiter","AsyncDOM","AsyncSignal","ChannelConstants","DOM","DataStore","ServerJS","createArrayFrom"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncDOM'),i=b('AsyncSignal'),j=b('ChannelConstants'),k=b('DOM'),l=b('DataStore'),m=b('ServerJS'),n=b('createArrayFrom');function o(q,r){r=JSON.parse(JSON.stringify(r));new m().setRelativeTo(q).handle(r);}var p={logAll:false,startup:function(){p.startup=bagofholding;g.subscribe(j.getArbiterType('live'),p.handleMessage.bind(p));},lookupLiveNode:function(q,r){var s=k.scry(document.body,'.live_'+q+'_'+r);s.forEach(function(t){if(l.get(t,'seqnum')===undefined){var u=JSON.parse(t.getAttribute('data-live'));l.set(t,'seqnum',u.seq);}});return s;},handleMessage:function(q,r){var s=r.obj,t=s.fbid,u=s.assoc,v=this.lookupLiveNode(t,u);if(!v)return false;v.forEach(function(w){if(s.expseq){var x=l.get(w,'seqnum'),y=l.get(w,'message_buffer');if(y===undefined){y={};l.set(w,'message_buffer',y);}var z={obj:s};y[s.expseq]=z;if(s.expseq!=x){p.log('mismatch',s.fbid,s.expseq,x);return false;}while(true){x=l.get(w,'seqnum');var aa=y[x];if(aa){h.invoke(aa.obj.updates,w);if(aa.obj.js)o(w,aa.obj.js);p.log('seqmatch',s.fbid,'exp',s.expseq,'cur',x);delete y[x];}else break;}}else{h.invoke(s.updates,w);if(s.js)o(w,s.js);}});},log:function(){if(p.logAll){var q=n(arguments).join(':');new i('/common/scribe_endpoint.php',{c:'live_sequence',m:q}).send();}}};e.exports=p;});
__d("legacy:live-js",["Live"],function(a,b,c,d){a.Live=b('Live');},3);
__d("legacy:JSLogger",["JSLogger"],function(a,b,c,d){a.JSLogger=b('JSLogger');},3);
__d("RenderManager",["function-extensions","copyProperties"],function(a,b,c,d,e,f){b('function-extensions');var g=b('copyProperties');function h(i){this._isDirty=false;this._obj=i;}g(h.prototype,{dirty:function(){if(!this._isDirty){this._isDirty=true;this._doPaint.bind(this).defer();}},_doPaint:function(){this._isDirty=false;this._obj.paint();}});e.exports=h;});
__d("CounterDisplay",["Arbiter","CSS","DOM","RenderManager","Run","$","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('RenderManager'),k=b('Run'),l=b('$'),m=b('copyProperties');function n(o,p,q,r,s,t){m(this,{_name:o,_valueNode:l(p),_wrapperNode:l(q)||null,_statusClass:s,_rm:new j(this),_arbiterSubscription:null,_count:0});var u=this._valueNode.firstChild;if(u){var v=parseInt(u.nodeValue,10);if(!isNaN(v))this._count=v;}this._statusNode=r?l(r):null;this._subscribeAll();n.instances.push(this);if(!t)k.onLeave(this._destroy.bind(this),true);}m(n,{EVENT_TYPE_ADJUST:'CounterDisplay/adjust',EVENT_TYPE_UPDATE:'CounterDisplay/update',instances:[],adjustCount:function(o,p){g.inform(n.EVENT_TYPE_ADJUST+'/'+o,p);},setCount:function(o,p){g.inform(n.EVENT_TYPE_UPDATE+'/'+o,p);}});m(n.prototype,{_destroy:function(){delete this._valueNode;delete this._wrapperNode;if(this._arbiterSubscription){this._arbiterSubscription.unsubscribe();delete this._arbiterSubscription;}n.instances.remove(this);},adjustCount:function(o){this._count=Math.max(0,this._count+o);this._rm.dirty();return this;},setCount:function(o){this._count=Math.max(0,o);this._rm.dirty();return this;},paint:function(){i.setContent(this._valueNode,this._count);this._toggleNodes();},_toggleNodes:function(){if(this._wrapperNode)h.conditionClass(this._wrapperNode,'hidden_elem',this._count<=0);if(this._statusClass&&this._statusNode)h.conditionClass(this._statusNode,this._statusClass,this._count>0);},_subscribeAll:function(){var o=[n.EVENT_TYPE_ADJUST+'/'+this._name,n.EVENT_TYPE_UPDATE+'/'+this._name];this._arbiterSubscription=g.subscribe(o,this._onInform.bind(this),g.SUBSCRIBE_NEW);},_onInform:function(o,p){p=parseInt(p);if(isNaN(p))return;if(o.indexOf(n.EVENT_TYPE_ADJUST)!=-1){this.adjustCount(p);}else if(o.indexOf(n.EVENT_TYPE_UPDATE)!=-1){this.setCount(p);}else return;return;}});e.exports=n;});
__d("Amoeba",["Run","copyProperties"],function(a,b,c,d,e,f){var g=b('Run'),h=b('copyProperties'),i={};h(i,{_instrumentQueue:[],_logger:null,instrument:function(j,k){if(i._logger){i._logger.instrument(j,k);}else i._instrumentQueue.push([j,k]);},flushQueue:function(j){if(j)i._instrumentQueue.map(j);i._instrumentQueue=[];},setLogger:function(j){i._logger=j;}});g.onLeave(function(){i.flushQueue(null);});e.exports=i;});
__d("cx",[],function(a,b,c,d,e,f){function g(h){throw new Error('cx(...): Unexpected class transformation.');}e.exports=g;});
__d("ModalLayer",["event-extensions","CSS","DOMQuery","ScrollAwareDOM","Style","URI","UserAgent","Vector","copyProperties","csx","debounce","ge"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('DOMQuery'),i=b('ScrollAwareDOM'),j=b('Style'),k=b('URI'),l=b('UserAgent'),m=b('Vector'),n=b('copyProperties'),o=b('csx'),p=b('debounce'),q=b('ge'),r=0,s=null,t=null;function u(){if(!t)t=h.scry(document.body,".-cx-PRIVATE-fbLayout__root")[0];return t;}function v(){h.scry(document.body,'div.swfObject').forEach(function(x){var y=x.getAttribute('data-swfid');if(y&&window[y]){var z=window[y];z.addParam('autostart','false');z.addParam('autoplay','false');z.addParam('play','false');z.addVariable('video_autoplay','0');z.addVariable('autoplay','0');z.addVariable('play','0');var aa=k(z.getAttribute('swf'));aa.addQueryData({autoplay:'0'});aa.setPath(aa.getPath().replace('autoplay=1','autoplay=0'));z.setAttribute('swf',aa.toString());z.write(x);}});}function w(x){this._layer=x;}n(w.prototype,{_subscription:null,_resizeListener:null,enable:function(){if(!u())return;this._subscription=this._layer.subscribe(['show','hide'],function(x){x=='show'?this._addModal():this._removeModal();}.bind(this));if(this._layer.isShown())this._addModal();},disable:function(){if(!u())return;this._subscription.unsubscribe();this._subscription=null;if(this._layer.isShown())this._removeModal();},_addModal:function(){g.addClass(this._layer.getRoot(),'modalWrapper');if(r++===0){s=m.getScrollPosition();var x=u(),y=x.offsetTop-s.y;j.set(x,'top',y+'px');g.addClass(document.documentElement,'modalOpen');if(l.ie()<7){var z=this._layer.getRoot(),aa=function(){var ca=-y+Math.max(z.offsetHeight,z.scrollHeight);j.set(x,'height',ca+'px');};aa();this._resizeListener=Event.listen(window,'resize',p(aa,100));}var ba=h.getDocumentScrollElement();ba.scrollTop=0;this._scrollSubscription=i.subscribe('scroll',function(ca,da){var ea=x.offsetTop-da.delta.y;j.set(x,'top',ea+'px');s=s.add(da.delta);return false;});if(l.firefox()<13)v.defer();}},_removeModal:function(){g.removeClass(this._layer.getRoot(),'modalWrapper');if(--r===0){g.removeClass(document.documentElement,'modalOpen');var x=u();j.set(x,'top','');if(l.ie()<7){j.set(x,'height','');this._resizeListener.remove();this._resizeListener=null;}var y=h.getDocumentScrollElement();y.scrollTop=s.y;this._scrollSubscription.unsubscribe();this._scrollSubscription=null;}}});e.exports=w;});
__d("DialogX",["event-extensions","function-extensions","AccessibleLayer","Arbiter","ArbiterMixin","Class","DOM","Layer","LayerButtons","LayerFormHooks","ModalLayer","Parent","Style","UserAgent","Vector","copyProperties","cx","debounce","getOverlayZIndex"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('AccessibleLayer'),h=b('Arbiter'),i=b('ArbiterMixin'),j=b('Class'),k=b('DOM'),l=b('Layer'),m=b('LayerButtons'),n=b('LayerFormHooks'),o=b('ModalLayer'),p=b('Parent'),q=b('Style'),r=b('UserAgent'),s=b('Vector'),t=b('copyProperties'),u=b('cx'),v=b('debounce'),w=b('getOverlayZIndex');function x(z,aa){this.parent.construct(this,z,aa);}j.extend(x,l);t(x,i);t(x.prototype,{_modal:false,_ie:null,_wrapper:null,_configure:function(z,aa){this.parent._configure(z,aa);if(z.modal){this._modal=true;this.enableBehavior(o);}if(z.autohide)var ba=this.subscribe('show',function(){ba.unsubscribe();this.hide.shield(this).defer(z.autohide);}.bind(this));},_getDefaultBehaviors:function(){return this.parent._getDefaultBehaviors().concat([y,g,m,n]);},_buildWrapper:function(z,aa){var ba=k.create('div',{className:"-cx-PRIVATE-uiDialog__content"},aa),ca;this._ie=r.ie();if(this._ie>6&&this._ie<9){ca=[k.create('div',{className:"-cx-PRIVATE-uiDialog__vertical"}),k.create('div',{className:"-cx-PRIVATE-uiDialog__horizontal"}),k.create('div',{className:"-cx-PRIVATE-uiDialog__topLeft"}),k.create('div',{className:"-cx-PRIVATE-uiDialog__topRight"}),k.create('div',{className:"-cx-PRIVATE-uiDialog__bottomLeft"}),k.create('div',{className:"-cx-PRIVATE-uiDialog__bottomRight"}),ba];}else ca=k.create('div',{className:"-cx-PUBLIC-uiDialog__border"},ba);this._wrapper=k.create('div',{className:"-cx-PUBLIC-uiDialog__wrapper"},ca);this.setWidth(z.width);var da="-cx-PRIVATE-uiDialog__positioner";if(z.className)da+=' '+z.className;var ea=k.create('div',{className:da},this._wrapper);if(z.id)ea.id=z.id;return ea;},_getContentRoot:function(){return this._wrapper;},updatePosition:function(){var z=s.getViewportDimensions().y-s.getElementDimensions(this._wrapper).y,aa;if(z<250){if(z>80){aa=z/2;}else aa=40;}else aa=125;if(!this._modal&&(!this._ie||this._ie<7))if(aa<=40){this.enableBehavior(o);}else this.disableBehavior(o);if(this._ie<7){var ba=s.getScrollPosition().y;q.set(this._wrapper,'top',aa+ba+'px');}else q.set(this._wrapper,'margin-top',aa+'px');if(this._causalElement){var ca=w(this._causalElement,this.getInsertParent());q.set(this.getRoot(),'z-index',ca>200?ca:'');}},setWidth:function(z){z=Math.floor(z);if(this._ie>6&&this._ie<9)z-=20;q.set(this._wrapper,'width',z+'px');}});function y(z){this._layer=z;}t(y.prototype,{_subscription:null,_resize:null,enable:function(){this._subscription=this._layer.subscribe(['show','hide'],function(z){if(z==='show'){this._attach();h.inform('layer_shown',{type:'DialogX'});}else{this._detach();h.inform('layer_hidden',{type:'DialogX'});}}.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;this._resize&&this._detach();},_attach:function(){this._layer.updatePosition();this._resize=Event.listen(window,'resize',v(this._layer.updatePosition.bind(this._layer)));},_detach:function(){this._resize.remove();this._resize=null;}});e.exports=x;});
__d("AsyncDialog",["AsyncRequest","Bootloader","copyProperties","CSS","cx","DialogX","DOM","Env","Parent","tx","URI"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Bootloader'),i=b('copyProperties'),j=b('CSS'),k=b('cx'),l=b('DialogX'),m=b('DOM'),n=b('Env'),o=b('Parent'),p=b('tx'),q=b('URI'),r=new l({width:465,className:"-cx-PRIVATE-uiDialog__loadingDialog"},m.create('div',{className:"-cx-PRIVATE-uiDialog__loadingText"},"Loading...")),s=1,t=[],u=0;function v(){u--;if(!u)r.hide();}function w(y,z){var aa=s++;t[aa]=z;i(y.getData(),{__asyncDialog:aa});var ba=false;u++;r.show();function ca(){if(!ba)v();}y.setInterceptHandler(function(da){ba=true;v();});y.setFinallyHandler(function(da){var ea=da.getPayload();if(ea&&ea.asyncURL)x.send(new g(ea.asyncURL));ca();});y.setAbortHandler(ca);y.send();}var x={send:function(y,z){w(y,z||bagofholding);},bootstrap:function(y,z,aa){if(!y)return;var ba=o.byClass(z,'stat_elem')||z;if(ba&&j.hasClass(ba,'async_saving'))return false;var ca=new q(y).getQueryData();ca.causal_element=z?m.getID(z):null;var da=aa==='dialog',ea=new g().setURI(y).setData(ca).setMethod(da?'GET':'POST').setReadOnly(da).setRelativeTo(z).setStatusElement(ba).setNectarModuleDataSafe(z);if(n.is_desktop){h.loadModules(['FbdDialogProvider'],function(fa){fa.sendDialog(ea,x.send);});return;}x.send(ea);},respond:function(y,z){var aa=t[y];if(aa){aa(z);delete t[y];}},getLoadingDialog:function(){return r;}};e.exports=x;});
__d("AsyncLayout",["AjaxPipeRequest","Arbiter","AsyncResponse","AsyncRequest","CSS","DOM","HTML","NavigationMessage","PageTransitions","URI","$","copyProperties","ge","goURI"],function(a,b,c,d,e,f){var g=b('AjaxPipeRequest'),h=b('Arbiter'),i=b('AsyncResponse'),j=b('AsyncRequest'),k=b('CSS'),l=b('DOM'),m=b('HTML'),n=b('NavigationMessage'),o=b('PageTransitions'),p=b('URI'),q=b('$'),r=b('copyProperties'),s=b('ge'),t=b('goURI');function u(v){this.canvasID=v;if(s('rightCol'))this.auxiliaryID='rightCol';if(s('headerArea'))this.headerID='headerArea';if(s('toolbarContainer'))this.toolbarID='toolbarContainer';this.waitingForAux=false;o.registerHandler(this.catchPageTransition.bind(this));this.subscription=h.subscribe(n.NAVIGATION_BEGIN,this.onNavigate.bind(this));}r(u.prototype,{catchPageTransition:function(v){this.subscription.unsubscribe();return false;},getCanvasID:function(v){return v.sidecol?'contentCol':'contentArea';},onNavigate:function(v,w){var x=w.useAjaxPipe;w=w.params;if(w.endpoint){if(this.request){this.request.setFinallyHandler(bagofholding);this.request.abort();}if(this.sideRequest)this.sideRequest.abort();if(x){this.request=new g().setURI(w.endpoint).setData(w).setCanvasId(this.getCanvasID(w)).setFinallyHandler(this.finallyHandler.bind(this)).setErrorHandler(this.errorHandler.bind(this)).setFirstResponseCallback(this.firstResponseCallback.bind(this)).send();}else{w.handled=true;this.waitingForAux=w.sidecol;var y=!!w.iframe,z=new j().setOption('useIframeTransport',y).setURI(new p(w.endpoint)).setReadOnly(true).setMethod('GET').setData(w).setHandler(this.onResponse.bind(this)).setErrorHandler(this.errorHandler.bind(this)).setFinallyHandler(this.finallyHandler.bind(this));this.request=z;z.send();}}},onSideResponse:function(v){var w=v.getPayload();if(w&&this.auxiliaryID)this.receivedAux(w);},receivedAux:function(v){!this.waitingForAux;this.waitingForAux=false;l.setContent(q(this.auxiliaryID),m(v));},onResponse:function(v){var w=v.getPayload();if(w.redirect){t(w.redirect);}else{var x=w.html||w;l.setContent(q(this.canvasID),m(x));if(w.side_html&&this.auxiliaryID)this.receivedAux(w.side_html);if(this.headerID&&!w.keep_header){var y=q(this.headerID);l.setContent(y,m(w.header_html||''));k.conditionShow(y,w.header_html);}if(w.toolbar_html&&this.toolbarID)l.setContent(q(this.toolbarID),m(w.toolbar_html));if(w.js)(new Function(w.js))();k.conditionClass('contentCol','hasRightCol',this.auxiliaryID&&!w.noRightSide);var z=s('rightCol');if(z&&w.noRightSide)l.empty(z);}var aa=v.getRequest().getData();h.inform(n.NAVIGATION_COMPLETED,aa.key);},errorHandler:function(v){i.verboseErrorHandler(v);h.inform(n.NAVIGATION_FAILED);this.request=null;},firstResponseCallback:function(v){window.scrollTo(0,0);h.inform(n.NAVIGATION_FIRST_RESPONSE);},finallyHandler:function(v){this.request=null;o.transitionComplete(true);h.inform(n.NAVIGATION_COMPLETED);}});e.exports=u;});
__d("ContextualLayer",["array-extensions","event-extensions","Arbiter","ARIA","Class","ContextualThing","CSS","DataStore","DOM","Layer","LayerHideOnTransition","Locale","Parent","Style","Vector","copyProperties","getOverlayZIndex"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('Arbiter'),h=b('ARIA'),i=b('Class'),j=b('ContextualThing'),k=b('CSS'),l=b('DataStore'),m=b('DOM'),n=b('Layer'),o=b('LayerHideOnTransition'),p=b('Locale'),q=b('Parent'),r=b('Style'),s=b('Vector'),t=b('copyProperties'),u=b('getOverlayZIndex');function v(aa){return aa.getPosition()==='left'||(aa.isVertical()&&aa.getAlignment()==='right');}function w(aa){var ba=aa.offsetParent;if(ba===document.body&&r.get(ba,'position')==='static')ba=document.documentElement;return ba;}function x(aa,ba){this.parent.construct(this,aa,ba);}var y=[];g.subscribe('reflow',function(){y.forEach(function(aa){if(aa.updatePosition()===false)aa.hide();});});i.extend(x,n);t(x.prototype,{_contentWrapper:null,_content:null,_contextNode:null,_contextSelector:null,_parentLayer:null,_parentSubscription:null,_orientation:null,_orientationClass:null,_configure:function(aa,ba){this.parent._configure(aa,ba);if(aa.context){this.setContext(aa.context);}else if(aa.contextID){this._setContextID(aa.contextID);}else if(aa.contextSelector)this._setContextSelector(aa.contextSelector);aa.position&&this.setPosition(aa.position);aa.alignment&&this.setAlignment(aa.alignment);aa.offsetX&&this.setOffsetX(aa.offsetX);aa.offsetY&&this.setOffsetY(aa.offsetY);this._content=ba;},_getDefaultBehaviors:function(){return this.parent._getDefaultBehaviors().concat([o]);},_buildWrapper:function(aa,ba){this._contentWrapper=m.create('div',{className:'uiContextualLayer'},ba);return m.create('div',{className:'uiContextualLayerPositioner'},this._contentWrapper);},getInsertParent:function(){var aa=this._insertParent;if(!aa){var ba=this.getContext();if(ba)aa=q.byClass(ba,'uiContextualLayerParent');}return aa||this.parent.getInsertParent();},setContent:function(aa){this._content=aa;m.setContent(this._contentWrapper,this._content);this._shown&&this.updatePosition();return this;},setContext:function(aa){this._contextNode=aa;this._contextSelector=this._contextScrollParent=null;if(this._shown){j.register(this.getRoot(),this._contextNode);this.updatePosition();}this._setParentSubscription();h.setPopup(this.getCausalElement(),this.getRoot());return this;},_setContextID:function(aa){this._contextSelector='#'+aa;this._contextNode=null;},_setContextSelector:function(aa){this._contextSelector=aa;this._contextNode=null;},getCausalElement:function(){return this.parent.getCausalElement()||this.getContext();},_setParentSubscription:function(){var aa=this.getContext(),ba=null;while(aa!==null){ba=l.get(aa,'layer');if(ba)break;aa=aa.parentNode;}if(ba===this._parentLayer)return;if(this._parentLayer&&this._parentSubscription){this._parentLayer.unsubscribe(this._parentSubscription);this._parentSubscription=null;}if(ba)this._parentSubscription=ba.subscribe('hide',this.hide.bind(this));this._parentLayer=ba;},setPosition:function(aa){this._getOrientation().setDefaultPosition(aa);this._shown&&this.updatePosition();return this;},setAlignment:function(aa){this._getOrientation().setDefaultAlignment(aa);this._shown&&this.updatePosition();return this;},setOffsetX:function(aa){this._getOrientation().setDefaultOffsetX(aa);this._shown&&this.updatePosition();return this;},setOffsetY:function(aa){this._getOrientation().setDefaultOffsetY(aa);this._shown&&this.updatePosition();return this;},_getOrientation:function(){if(!this._orientation)this._orientation=new z();return this._orientation;},_getContentRoot:function(){return this._contentWrapper;},getContent:function(){return this._content;},getContext:function(){if(!this._contextNode)this._contextNode=m.find(document,this._contextSelector);return this._contextNode;},getContextScrollParent:function(){if(!this._contextScrollParent)this._contextScrollParent=r.getScrollParent(this.getContext());return this._contextScrollParent;},setInsertParent:function(aa){this._insertScrollParent=null;return this.parent.setInsertParent(aa);},getInsertScrollParent:function(){if(!this._insertScrollParent)this._insertScrollParent=r.getScrollParent(this.getInsertParent());return this._insertScrollParent;},show:function(){this.parent.show();if(this._shown){j.register(this.getRoot(),this.getContext());y.push(this);this._resizeListener=this._resizeListener||Event.listen(window,'resize',this.updatePosition.bind(this));}return this;},hide:function(){j.remove(this.getRoot());y.remove(this);this._resizeListener&&this._resizeListener.remove();this._resizeListener=null;return this.parent.hide();},updatePosition:function(){var aa=this.getContext();if(!aa)return false;var ba=r.isFixed(aa)&&!r.isFixed(this.getInsertParent());if(!ba&&!aa.offsetParent)return false;var ca=this._getOrientation();this.inform('adjust',ca.reset());if(!ca.isValid())return false;this._updateWrapperPosition(ca);this._updateWrapperClass(ca);var da=this.getRoot();k.conditionClass(da,'uiContextualLayerPositionerFixed',ba);var ea,fa,ga=ba?'viewport':'document',ha=ba?document.documentElement:w(da);if(ha===document.documentElement){ea=new s(0,0);fa=document.documentElement.clientWidth;}else if(!ha){return false;}else{ea=s.getElementPosition(ha,ga);fa=ha.offsetWidth;if(ha!==document.body)ea=ea.sub(new s(ha.scrollLeft,ha.scrollTop));}var ia=s.getElementPosition(aa,ga),ja=ia.x-ea.x,ka=ia.y-ea.y,la=p.isRTL();if(ca.getPosition()==='below')ka+=aa.offsetHeight;if((ca.getPosition()==='right'||(ca.isVertical()&&ca.getAlignment()==='right'))!=la)ja+=aa.offsetWidth;var ma=ca.getOffsetX();if(ca.isVertical()&&ca.getAlignment()==='center')ma+=(aa.offsetWidth-this._content.offsetWidth)/2;if(la)ma*=-1;var na='left',oa=ja+ma;if(v(ca)!==la){na='right';oa=fa-oa;}r.set(da,na,oa+'px');r.set(da,na==='left'?'right':'left','');var pa=this.getInsertScrollParent(),qa;if(pa!==window){qa=pa.clientWidth;}else qa=document.documentElement.clientWidth;var ra=s.getElementPosition(da).x;if(na==='left'){if(qa-ra>0){r.set(da,'width',(qa-ra)+'px');}else r.set(da,'width','');}else r.set(da,'width',ra+da.offsetWidth+'px');r.set(da,'top',(ka+ca.getOffsetY())+'px');var sa=u(aa,this.getInsertParent());r.set(da,'z-index',sa>200?sa:'');this.inform('reposition',ca);return true;},_updateWrapperPosition:function(aa){var ba=aa.getPosition()==='above';r.set(this._contentWrapper,'bottom',ba?'0':null);var ca=p.isRTL()?'left':'right',da=v(aa);r.set(this._contentWrapper,ca,da?'0':null);},_updateWrapperClass:function(aa){var ba=aa.getClassName();if(ba===this._orientationClass)return;if(this._orientationClass)k.removeClass(this._contentWrapper,this._orientationClass);this._orientationClass=ba;k.addClass(this._contentWrapper,ba);},simulateOrientation:function(aa,ba){var ca=aa.getClassName();if(ca===this._orientationClass){return ba();}else{if(this._orientationClass)k.removeClass(this._contentWrapper,this._orientationClass);k.addClass(this._contentWrapper,ca);var da=ba();k.removeClass(this._contentWrapper,ca);if(this._orientationClass)k.addClass(this._contentWrapper,this._orientationClass);return da;}},destroy:function(){this.parent.destroy();this._contentWrapper=null;this._content=null;return this;}});function z(){this._default={_position:'above',_alignment:'left',_offsetX:0,_offsetY:0,_valid:true};this.reset();}z.OPPOSITE={above:'below',below:'above',left:'right',right:'left'};t(z.prototype,{setPosition:function(aa){this._position=aa;return this;},setAlignment:function(aa){this._alignment=aa;return this;},getOppositePosition:function(){return z.OPPOSITE[this.getPosition()];},invalidate:function(){this._valid=false;return this;},getPosition:function(){return this._position||'above';},getAlignment:function(){return this._alignment||'left';},getOffsetX:function(){var aa=this._offsetX||0;if(!this.isVertical()){if(this._default._position!==this._position)aa*=-1;}else if(this._default._alignment!==this._alignment)aa*=-1;return aa;},getOffsetY:function(){var aa=this._offsetY||0;if(this.isVertical()&&this._default._position!==this._position)aa*=-1;return aa;},getClassName:function(){var aa=this.getAlignment(),ba=this.getPosition();if(ba==='below'){if(aa==='left'){return 'uiContextualLayerBelowLeft';}else if(aa==='right'){return 'uiContextualLayerBelowRight';}else return 'uiContextualLayerBelowCenter';}else if(ba==='above'){if(aa==='left'){return 'uiContextualLayerAboveLeft';}else if(aa==='right'){return 'uiContextualLayerAboveRight';}else return 'uiContextualLayerAboveCenter';}else if(ba==='left'){return 'uiContextualLayerLeft';}else return 'uiContextualLayerRight';},isValid:function(){return this._valid;},isVertical:function(){return this.getPosition()==='above'||this.getPosition()==='below';},reset:function(aa,ba){t(this,this._default);return this;},setDefaultPosition:function(aa){this._default._position=aa;return this;},setDefaultAlignment:function(aa){this._default._alignment=aa;return this;},setDefaultOffsetX:function(aa){this._default._offsetX=aa;return this;},setDefaultOffsetY:function(aa){this._default._offsetY=aa;return this;}});e.exports=x;});
__d("KeyStatus",["event-extensions"],function(a,b,c,d,e,f){b('event-extensions');var g=null,h=null;function i(){if(!h)h=Event.listen(window,'blur',function(){g=null;j();});}function j(){if(h){h.remove();h=null;}}Event.listen(document.documentElement,'keydown',function(l){g=Event.getKeyCode(l);i();},Event.Priority.URGENT);Event.listen(document.documentElement,'keyup',function(l){g=null;j();},Event.Priority.URGENT);var k={isKeyDown:function(){return !!g;},getKeyDownCode:function(){return g;}};e.exports=k;});
__d("Menu",["event-extensions","Arbiter","CSS","DataStore","DOM","HTML","Keys","Parent","Run","Style","UserAgent","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('DOM'),k=b('HTML'),l=b('Keys'),m=b('Parent'),n=b('Run'),o=b('Style'),p=b('UserAgent'),q=b('copyProperties'),r=null,s='menu:mouseover',t=null;function u(ca){if(h.hasClass(ca,'uiMenuContainer'))return ca;return m.byClass(ca,'uiMenu');}function v(ca){return m.byClass(ca,'uiMenuItem');}function w(ca){if(document.activeElement){var da=v(document.activeElement);return ca.indexOf(da);}return -1;}function x(ca){return j.find(ca,'a.itemAnchor');}function y(ca){return h.hasClass(ca,'checked');}function z(ca){return !h.hasClass(ca,'disabled')&&o.get(ca,'display')!=='none';}function aa(event){var ca=document.activeElement;if(!ca||!m.byClass(ca,'uiMenu')||!j.isNodeOfType(ca,['input','textarea'])){var da=v(event.getTarget());da&&r.focusItem(da);}}function ba(ca){p.firefox()&&x(ca).blur();r.inform('select',{menu:u(ca),item:ca});}n.onLoad(function(){var ca={};ca.click=function(event){var da=v(event.getTarget());if(da&&z(da)){ba(da);var ea=x(da),fa=ea.href,ga=ea.getAttribute('rel');return (ga&&ga!=='ignore')||(fa&&fa.charAt(fa.length-1)!=='#');}};ca.keydown=function(event){var da=event.getTarget();if(event.getModifiers().any)return;if(!t||j.isNodeOfType(da,['input','textarea']))return;var ea=Event.getKeyCode(event),fa;switch(ea){case l.UP:case l.DOWN:var ga=r.getEnabledItems(t);fa=w(ga);r.focusItem(ga[fa+(ea===l.UP?-1:1)]);return false;case l.SPACE:var ha=v(da);if(ha){ba(ha);event.prevent();}break;default:var ia=String.fromCharCode(ea).toLowerCase(),ja=r.getEnabledItems(t);fa=w(ja);var ka=fa,la=ja.length;while((~fa&&(ka=++ka%la)!==fa)||(!~fa&&++ka<la)){var ma=r.getItemLabel(ja[ka]);if(ma&&ma.charAt(0).toLowerCase()===ia){r.focusItem(ja[ka]);return false;}}}};Event.listen(document.documentElement,ca);});r=e.exports=q(new g(),{focusItem:function(ca){if(ca&&z(ca)){this._removeSelected(u(ca));h.addClass(ca,'selected');x(ca).focus();}},getEnabledItems:function(ca){return r.getItems(ca).filter(z);},getCheckedItems:function(ca){return r.getItems(ca).filter(y);},getItems:function(ca){return j.scry(ca,'li.uiMenuItem');},getItemLabel:function(ca){return ca.getAttribute('data-label',2)||'';},isItemChecked:function(ca){return h.hasClass(ca,'checked');},register:function(ca,da){ca=u(ca);if(!i.get(ca,s))i.set(ca,s,Event.listen(ca,'mouseover',aa));if(da!==false)t=ca;},setItemEnabled:function(ca,da){if(!da&&!j.scry(ca,'span.disabledAnchor')[0])j.appendContent(ca,j.create('span',{className:j.find(ca,'a').className+' disabledAnchor'},k(x(ca).innerHTML)));h.conditionClass(ca,'disabled',!da);},toggleItem:function(ca){var da=!r.isItemChecked(ca);r.setItemChecked(ca,da);},setItemChecked:function(ca,da){h.conditionClass(ca,'checked',da);x(ca).setAttribute('aria-checked',da);},unregister:function(ca){ca=u(ca);var da=i.remove(ca,s);da&&da.remove();t=null;this._removeSelected(ca);},_removeSelected:function(ca){r.getItems(ca).filter(function(da){return h.hasClass(da,'selected');}).forEach(function(da){h.removeClass(da,'selected');});}});});
__d("ContextualLayerDimensions",["DOM","Locale","Rect","Vector","ViewportBounds","ge","getOverlayZIndex"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('Locale'),i=b('Rect'),j=b('Vector'),k=b('ViewportBounds'),l=b('ge'),m=b('getOverlayZIndex'),n={getViewportRect:function(o){var p=l('globalContainer'),q=o.getContext(),r=(p&&g.contains(p,q))||m(q)<300,s=i.getViewportBounds();if(r){s.t+=k.getTop();if(h.isRTL()){s.l+=k.getRight();}else s.r-=k.getRight();}return s;},getLayerRect:function(o,p){var q=o.getContext(),r=j.getElementPosition(q,'viewport'),s=o.simulateOrientation(p,function(){return j.getElementDimensions(o.getContent());}),t=r.y+p.getOffsetY();if(p.getPosition()==='above'){t-=s.y;}else if(p.getPosition()==='below')t+=q.offsetHeight;var u=r.x+p.getOffsetX();if(p.isVertical()){var v=p.getAlignment();if(v==='center'){u+=(q.offsetWidth-s.x)/2;}else if((v==='right')!==h.isRTL())u+=q.offsetWidth-s.x;}else if((p.getPosition()==='right')!==h.isRTL()){u+=q.offsetWidth;}else u-=s.x;return new i(t,u+s.x,t+s.y,u,'viewport');}};e.exports=n;});
__d("ContextualLayerAutoFlip",["array-extensions","event-extensions","ContextualLayerDimensions","DOM","Vector","copyProperties"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('ContextualLayerDimensions'),h=b('DOM'),i=b('Vector'),j=b('copyProperties');function k(l){this._layer=l;}j(k.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('adjust',this._adjustOrientation.bind(this));if(this._layer.isShown())this._layer.updatePosition();},disable:function(){this._subscription.unsubscribe();this._subscription=null;if(this._layer.isShown())this._layer.updatePosition();},_adjustOrientation:function(l,m){var n=this._getValidPositions(m);if(!n.length){m.invalidate();return;}var o=g.getViewportRect(this._layer),p=this._getValidAlignments(m);for(var q=0;q<p.length;q++){m.setAlignment(p[q]);for(var r=0;r<n.length;r++){m.setPosition(n[r]);var s=g.getLayerRect(this._layer,m);if(o.contains(s))return;}}m.setPosition(n.contains('below')?'below':n[0]).setAlignment(p[0]);},_getValidPositions:function(l){var m=[l.getPosition(),l.getOppositePosition()],n=this._layer.getContextScrollParent();if(n===window||n===h.getDocumentScrollElement())return m;var o=this._layer.getContext(),p=i.getElementPosition(n,'viewport').y,q=i.getElementPosition(o,'viewport').y;if(l.isVertical()){return m.filter(function(s){if(s==='above'){return q>=p;}else{var t=p+n.offsetHeight,u=q+o.offsetHeight;return u<=t;}});}else{var r=p+n.offsetHeight;if(q>=p&&q+o.offsetHeight<=r){return m;}else return [];}},_getValidAlignments:function(l){var m=['left','center','right'],n=l.getAlignment(),o=m.indexOf(n);if(o>0){m.splice(o,1);m.unshift(n);}return m;}});e.exports=k;});
__d("Tooltip",["event-extensions","ARIA","AsyncRequest","copyProperties","ContextualLayer","ContextualLayerAutoFlip","CSS","DataStore","DOM","Style","URI","tx"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ARIA'),h=b('AsyncRequest'),i=b('copyProperties'),j=b('ContextualLayer'),k=b('ContextualLayerAutoFlip'),l=b('CSS'),m=b('DataStore'),n=b('DOM'),o=b('Style'),p=b('URI'),q=b('tx'),r=null,s=null,t=null,u=[];function v(){if(!s){t=n.create('div',{className:'tooltipContent'});var ca=n.create('i',{className:'arrow'}),da=n.create('div',{className:'uiTooltipX'},[t,ca]);s=new j({},da);s.enableBehavior(k);}}function w(ca){return i({position:ca.getAttribute('data-tooltip-position')||'above',alignH:ca.getAttribute('data-tooltip-alignh')||'left'},m.get(ca,'tooltip'));}function x(ca,da){var ea=w(ca);m.set(ca,'tooltip',{content:da.content||ea.content,position:da.position||ea.position,alignH:da.alignH||ea.alignH});ca.setAttribute('data-hover','tooltip');}function y(ca,da){ba.set(ca,"Loading...");new h(da).setHandler(function(ea){ba.set(ca,ea.getPayload());}).setErrorHandler(bagofholding).send();}var z=/(\r\n|[\r\n])/;function aa(ca){return ca.split(z).map(function(da){return z.test(da)?n.create('br'):da;});}var ba={process:function(ca,da){if(!n.contains(ca,da))return;if(ca!==r){var ea=ca.getAttribute('data-tooltip-uri');if(ea){ca.removeAttribute('data-tooltip-uri');y(ca,ea);}var fa=ca.getAttribute('title');if(fa){ca.setAttribute('title','');var ga=w(ca);!ga.content&&ba.set(ca,fa);}ba.show(ca);}},remove:function(ca){m.remove(ca,'tooltip');ca.removeAttribute('data-hover');ca.removeAttribute('data-tooltip-position');ca.removeAttribute('data-tooltip-alignh');ca===r&&ba.hide();},hide:function(){if(r){s.hide();r=null;while(u.length)u.pop().remove();}},set:function(ca,da,ea,fa){if(ea||fa)x(ca,{position:ea,alignH:fa});if(da instanceof p){if(ca===r){y(ca,da);}else ca.setAttribute('data-tooltip-uri',da);}else{if(typeof da!=='string')da=n.create('div',{},da);x(ca,{content:da});ca===r&&ba.show(ca);}},show:function(ca){v();ba.hide();var da=w(ca);if(!da.content)return;var ea=0,fa=0;if(da.position==='left'||da.position==='right'){fa=(ca.offsetHeight-20)/2;}else if(da.alignH!=='center'){var ga=ca.offsetWidth;if(ga<18)ea=(ga-18)/2*(da.alignH==='right'?-1:1);}s.setContext(ca).setOffsetX(ea).setOffsetY(fa).setPosition(da.position).setAlignment(da.alignH);if(typeof da.content==='string'){l.addClass(s,'invisible_elem');var ha=n.create('span',{},aa(da.content)),ia=n.create('div',{className:'tooltipText'},ha);n.setContent(t,ia);s.show();g.notify(da.content);if(ia.offsetWidth<ha.offsetWidth){l.addClass(ia,'tooltipWrap');s.updatePosition();}l.removeClass(s,'invisible_elem');}else{n.setContent(t,da.content);s.show();g.notify(n.getText(t));}var ja=function(la){if(!n.contains(r,la.getTarget()))ba.hide();};u.push(Event.listen(document.documentElement,'mouseover',ja));u.push(Event.listen(document.documentElement,'focusin',ja));var ka=o.getScrollParent(ca);if(ka!==window)u.push(Event.listen(ka,'scroll',ba.hide));u.push(Event.listen(ca,'click',ba.hide));r=ca;}};Event.listen(window,'scroll',ba.hide);e.exports=ba;});
__d("Selector",["event-extensions","Arbiter","Button","ContextualLayer","copyProperties","CSS","DataStore","DOM","HTML","Input","Keys","KeyStatus","Menu","Parent","Style","Toggler","Tooltip","Vector"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('Button'),i=b('ContextualLayer'),j=b('copyProperties'),k=b('CSS'),l=b('DataStore'),m=b('DOM'),n=b('HTML'),o=b('Input'),p=b('Keys'),q=b('KeyStatus'),r=b('Menu'),s=b('Parent'),t=b('Style'),u=b('Toggler'),v=b('Tooltip'),w=b('Vector'),x,y,z=[],aa;function ba(ma){return s.byClass(ma,'uiSelector');}function ca(ma){return s.byClass(ma,'uiSelectorButton');}function da(){if(!y){y=new i({position:'below'},m.create('div'));k.addClass(y.getRoot(),'uiSelectorContextualLayer');}return y;}function ea(ma){return m.scry(ma,'select')[0];}function fa(ma){return m.find(ma,'div.uiSelectorMenuWrapper');}function ga(){ga=bagofholding;r.subscribe('select',function(ma,na){if(!x||!na||na.menu!==la.getSelectorMenu(x))return;var oa=ha(x),pa=ia(na.item);if(pa){var qa=x,ra=la.isOptionSelected(na.item),sa=la.inform('select',{selector:qa,option:na.item,clone:aa});if(sa===false)return;if(oa||!ra){la.setSelected(qa,la.getOptionValue(na.item),!ra);la.inform('toggle',{selector:qa,option:na.item});la.inform('change',{selector:qa});g.inform('Form/change',{node:qa});if(ja(qa))l.set(qa,'dirty',true);}}if(!oa||!pa)x&&la.toggle(x);});}function ha(ma){return !!ma.getAttribute('data-multiple');}function ia(ma){return k.hasClass(ma,'uiSelectorOption');}function ja(ma){return !!ma.getAttribute('data-autosubmit');}var ka={keydown:function(event){var ma=event.getTarget();if(m.isNodeOfType(ma,['input','textarea']))return;switch(Event.getKeyCode(event)){case p.DOWN:case p.SPACE:case p.UP:if(ca(ma)){var na=ba(ma);la.toggle(na);return false;}break;case p.ESC:if(x){la.toggle(x);return false;}break;}},mouseover:function(event){var ma=s.byAttribute(event.getTarget(),'ajaxify');if(ma&&k.hasClass(ma,'uiSelectorButton'))la.loadMenu(ba(ma));}};Event.listen(document.documentElement,ka);u.subscribe(['show','hide'],function(ma,na){var oa=ba(na.getActive());if(oa){ga();var pa=la.getSelectorButton(oa),qa=la.getSelectorMenu(oa),ra=ma==='show';pa.setAttribute('aria-expanded',ra?'true':'false');if(ra){x=oa;if(k.hasClass(pa,'uiButtonDisabled')){la.setEnabled(oa,false);return false;}qa=qa||la.loadMenu(oa);var sa=t.getScrollParent(oa),ta=sa!==window&&sa!==m.getDocumentScrollElement();if(ta||k.hasClass(oa,'uiSelectorUseLayer')){if(ta)z.push(Event.listen(sa,'scroll',function(){na.hide();}));aa=m.create('div',{className:oa.className});k.addClass(aa,'invisible_elem');w.getElementDimensions(oa).setElementDimensions(aa);m.replace(oa,aa);var ua=k.hasClass(oa,'uiSelectorRight'),va=k.hasClass(oa,'uiSelectorBottomUp');da().setContext(aa).setContent(oa).setPosition(va?'above':'below').setAlignment(ua?'right':'left').show();}r.register(qa);if(q.isKeyDown()){var wa=r.getCheckedItems(qa);if(!wa.length)wa=r.getEnabledItems(qa);r.focusItem(wa[0]);}}else{x=null;if(aa){while(z.length)z.pop().remove();m.replace(aa,oa);da().hide();aa=null;}qa&&r.unregister(qa);if(ja(oa)&&l.get(oa,'dirty')){var xa=m.scry(oa,'input.submitButton')[0];xa&&xa.click();l.remove(oa,'dirty');}}k.conditionClass(la.getSelectorButton(oa),'selected',ra);la.inform(ra?'open':'close',{selector:oa,clone:aa});}});var la=j(new g(),{attachMenu:function(ma,na,oa){ma=ba(ma);if(ma){x&&r.unregister(la.getSelectorMenu(x));m.setContent(fa(ma),na);x&&r.register(la.getSelectorMenu(ma));aa&&da().updatePosition();if(oa){var pa=ma.getAttribute('data-name');pa&&oa.setAttribute('name',pa);if(!ha(ma))oa.setAttribute('multiple',false);var qa=ea(ma);if(qa){m.replace(qa,oa);}else m.insertAfter(ma.firstChild,oa);}return true;}},getOption:function(ma,na){var oa=la.getOptions(ma),pa=oa.length;while(pa--)if(na===la.getOptionValue(oa[pa]))return oa[pa];return null;},getOptions:function(ma){var na=r.getItems(la.getSelectorMenu(ma));return na.filter(ia);},getEnabledOptions:function(ma){var na=r.getEnabledItems(la.getSelectorMenu(ma));return na.filter(ia);},getSelectedOptions:function(ma){return r.getCheckedItems(la.getSelectorMenu(ma));},getOptionText:function(ma){return r.getItemLabel(ma);},getOptionValue:function(ma){var na=ba(ma),oa=ea(na),pa=la.getOptions(na).indexOf(ma);return pa>=0?oa.options[pa+1].value:'';},getSelectorButton:function(ma){return m.find(ma,'a.uiSelectorButton');},getSelectorMenu:function(ma){return m.scry(ma,'div.uiSelectorMenu')[0];},getValue:function(ma){var na=ea(ma);if(!na)return null;if(!ha(ma))return na.value;var oa=[],pa=na.options;for(var qa=1,ra=pa.length;qa<ra;qa++)if(pa[qa].selected)oa.push(pa[qa].value);return oa;},isOptionSelected:function(ma){return r.isItemChecked(ma);},listen:function(ma,na,oa){return this.subscribe(na,function(pa,qa){if(qa.selector===ma)return oa(qa,pa);});},loadMenu:function(ma){var na=la.getSelectorMenu(ma);if(!na){var oa=la.getSelectorButton(ma),pa=oa.getAttribute('ajaxify');if(pa){d(['AsyncRequest'],function(ra){ra.bootstrap(pa,oa);});var qa=n('<div class="uiSelectorMenuWrapper uiToggleFlyout">'+'<div class="uiMenu uiSelectorMenu loading">'+'<ul class="uiMenuInner">'+'<li><span></span></li>'+'</ul>'+'</div>'+'</div>');m.appendContent(oa.parentNode,qa);na=la.getSelectorMenu(ma);oa.removeAttribute('onmouseover');}}return na;},setButtonLabel:function(ma,na){var oa=la.getSelectorButton(ma),pa=parseInt(oa.getAttribute('data-length'),10);na=na||oa.getAttribute('data-label')||'';h.setLabel(oa,na);if(typeof na==='string'){k.conditionClass(oa,'uiSelectorBigButtonLabel',na.length>pa);if(pa&&na.length>pa){oa.setAttribute('title',na);}else oa.removeAttribute('title');}},setButtonTooltip:function(ma,na){var oa=la.getSelectorButton(ma),pa=s.byTag(oa,'a');pa&&v.set(pa,na||oa.getAttribute('data-tooltip')||'');},updateButtonARIALabel:function(ma,na){var oa=la.getSelectorButton(ma),pa=s.byTag(oa,'a');if(pa){var qa=oa.getAttribute('data-ariaprefix');if(qa)oa.setAttribute('aria-label',qa+': '+na);}},setEnabled:function(ma,na){if(!na&&x&&ba(ma)===x)la.toggle(ma);h.setEnabled(la.getSelectorButton(ma),na);},setOptionEnabled:function(ma,na){r.setItemEnabled(ma,na);},setSelected:function(ma,na,oa){oa=oa!==false;var pa=la.getOption(ma,na);if(!pa)return;var qa=la.isOptionSelected(pa);if(oa!==qa){if(!ha(ma)&&!qa){var ra=la.getSelectedOptions(ma)[0];ra&&r.toggleItem(ra);}r.toggleItem(pa);}la.updateSelector(ma);},toggle:function(ma){u.toggle(m.scry(ba(ma),'div.wrap')[0]);},updateSelector:function(ma){var na=la.getOptions(ma),oa=la.getSelectedOptions(ma),pa=ea(ma).options,qa=[],ra=[];for(var sa=0,ta=na.length;sa<ta;sa++){var ua=oa.contains(na[sa]);pa[sa+1].selected=ua;if(ua){var va=la.getOptionText(na[sa]);qa.push(va);ra.push(na[sa].getAttribute('data-tooltip')||va);}}pa[0].selected=!oa.length;var wa=k.hasClass(ma,'uiSelectorDynamicLabel'),xa=k.hasClass(ma,'uiSelectorDynamicTooltip');if(wa||xa){var ya='';if(ha(ma)){var za=la.getSelectorButton(ma);ya=za.getAttribute('data-delimiter')||', ';}qa=qa.join(ya);ra=ra.join(ya);if(wa){la.setButtonLabel(ma,qa);la.updateButtonARIALabel(ma,qa);}xa&&la.setButtonTooltip(ma,ra);}}});e.exports=la;});
__d("DynamicIconSelector",["Button","CSS","DOM","Selector"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('Selector'),k={swapIcon:function(l){var m=j.getSelectedOptions(l)[0],n=m&&i.scry(m,'.itemIcon')[0],o=j.getSelectorButton(l);if(n){g.setIcon(o,n.cloneNode(true));}else{var p=i.scry(o,'.img')[0];p&&i.remove(p);}h.conditionClass(o,'uiSelectorChevronOnly',!n);}};j.subscribe('change',function(l,m){var n=m.selector;if(h.hasClass(n,'dynamicIconSelector'))k.swapIcon(n);});e.exports=k;});
__d("AudienceSelector",["Arbiter","CSS","DOM","DynamicIconSelector","PrivacyConst","Selector","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('DynamicIconSelector'),k=b('PrivacyConst'),l=b('Selector'),m=b('copyProperties');l.subscribe('select',function(p,q){if(!h.hasClass(q.selector,'audienceSelector'))return;var r=l.getOptionValue(q.option);g.inform('AudienceSelector/changed',q);if(r==k.BaseValue.CUSTOM&&!h.hasClass(q.option,'noDialog')){l.toggle(q.selector);return false;}if(h.hasClass(q.selector,'dataTooltip')){var s=i.find(q.option,'.itemAnchor').getAttribute('data-tooltip');l.setButtonTooltip(q.selector,s||null);}if(!h.hasClass(q.option,'specialOption'))return;var t=i.find(q.option,'a').getAttribute('data-type');if(h.hasClass(q.option,'moreOption')){h.addClass(q.selector,t);h.addClass(q.selector,'showSecondaryOptions');return false;}else if(h.hasClass(q.option,'returnOption')){h.removeClass(q.selector,'showSecondaryOptions');h.removeClass(q.selector,'friendList');return false;}});var n={},o={hasTags:function(p){return n.hasOwnProperty(p);},setHasTags:function(p){if(!p)return;n[p]=true;}};g.subscribe('CustomPrivacyOption/update',function(p,q){if(!h.hasClass(q.selector,'audienceSelector'))return;l.setSelected(q.selector,l.getOptionValue(q.option));j.swapIcon(q.selector);l.setButtonTooltip(q.selector,q.tooltip);g.inform('AudienceSelector/update',q.selector);});e.exports=o;});
__d("ContextualDialogArrow",["CSS","DOM","Locale","Style","Vector","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Locale'),j=b('Style'),k=b('Vector'),l=b('copyProperties'),m=b('cx'),n=15,o=16,p={bottom:"-cx-PRIVATE-uiContextualDialog__arrowBottom",top:"-cx-PRIVATE-uiContextualDialog__arrowTop",right:"-cx-PRIVATE-uiContextualDialog__arrowRight",left:"-cx-PRIVATE-uiContextualDialog__arrowLeft"},q={above:'bottom',below:'top',left:'right',right:'left'};function r(s){this._layer=s;}l(r.prototype,{_subscription:null,_arrow:null,enable:function(){this._subscription=this._layer.subscribe(['adjust','reposition'],this._handle.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_handle:function(s,t){if(s==='adjust'){this._repositionArrow(t);}else this._repositionRoot(t);},_repositionRoot:function(s){var t=this._layer.getRoot();if(!s.isVertical()){var u=parseInt(j.get(t,'top'),10);u-=n;j.set(t,'top',u+'px');}},_repositionArrow:function(s){var t=this._layer._contentWrapper,u=0,v=s.getAlignment(),w=s.getPosition();if(w=='above'||w=='below')if(v=='center'){u=50;}else if(v=='right')u=100;var x=q[w];for(var y in p)g.conditionClass(t,p[y],x===y);if(w=='none')return;if(!this._arrow){this._arrow=this._drawArrow();h.appendContent(t,this._arrow);}g.conditionClass(t,"-cx-PRIVATE-uiContextualDialog__withFooter",this._layer.getFooter());j.set(this._arrow,'top','');j.set(this._arrow,'left','');j.set(this._arrow,'right','');j.set(this._arrow,'margin','');var z=x=='top'||x=='bottom',aa=z?(i.isRTL()?'right':'left'):'top';u=u||0;j.set(this._arrow,aa,u+'%');var ba=o+(n*2),ca=n;if(z&&(v!='center')){var da=this._layer.getContext(),ea=k.getElementDimensions(da).x;if(ea<ba)ca=Math.max((ea/2)-(o/2),0);}j.set(this._arrow,'margin-'+aa,-(ba*u/100-ca)+'px');},_drawArrow:function(){return h.create('i',{className:"-cx-PRIVATE-uiContextualDialog__arrow"});}});r.OFFSET=n;r.LENGTH=o;e.exports=r;});
__d("ContextualDialogFitInViewport",["event-extensions","ContextualDialogArrow","ContextualLayerDimensions","Style","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ContextualDialogArrow'),h=b('ContextualLayerDimensions'),i=b('Style'),j=b('Vector'),k=b('copyProperties'),l=g.OFFSET,m=g.LENGTH,n=l+m;function o(p){this._layer=p;}k(o.prototype,{_scrollListener:null,_subscription:null,_minimumTop:null,enable:function(){this._subscription=this._layer.subscribe(['show','hide','reposition'],function(p,q){if(p=='reposition'){this._calculateMinimumTop(q);}else if(p=='show'){this._attachScroll();this._adjustForScroll();}else this._detachScroll();}.bind(this));if(this._layer.isShown())this._attachScroll();},disable:function(){if(this._layer.isShown())this._detachScroll();this._subscription.unsubscribe();this._subscription=null;},_attachScroll:function(){this._scrollListener=Event.listen(this._layer.getContextScrollParent()||window,'scroll',this._adjustForScroll.bind(this));},_detachScroll:function(){this._scrollListener.remove();this._scrollListener=null;},_getContentHeight:function(){return j.getElementDimensions(this._layer._contentWrapper).y;},_getContextY:function(){return j.getElementPosition(this._layer.getContext()).y;},_calculateMinimumTop:function(p){if(p.isVertical())return;this._minimumTop=(this._getContextY()-(this._getContentHeight()-n)+p.getOffsetY());},_adjustForScroll:function(){var p=this._layer._getOrientation();if(p.isVertical())return;var q=h.getViewportRect(this._layer),r=q.b-this._minimumTop;if(r<0)return;var s=this._getContentHeight(),t=s-(n+l),u=Math.max(0,Math.min(t,t-(r-s)));i.set(this._layer.getContent(),'top',-u+'px');}});e.exports=o;});
__d("ContextualDialog",["AccessibleLayer","Class","ContextualDialogFitInViewport","ContextualLayer","CSS","DOM","LayerButtons","LayerFormHooks","LayerMouseHooks","Style","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('AccessibleLayer'),h=b('Class'),i=b('ContextualDialogFitInViewport'),j=b('ContextualLayer'),k=b('CSS'),l=b('DOM'),m=b('LayerButtons'),n=b('LayerFormHooks'),o=b('LayerMouseHooks'),p=b('Style'),q=b('copyProperties'),r=b('csx'),s=b('cx');function t(u,v){this.parent.construct(this,u,v);}h.extend(t,j);q(t.prototype,{_footer:null,_configure:function(u,v){u.addedBehaviors.push(u.arrowBehavior);var w=l.scry(v,"div.-cx-PRIVATE-uiContextualDialog__footer");if(w.length)this._footer=w[0];this.parent._configure(u,v);},_getDefaultBehaviors:function(){return this.parent._getDefaultBehaviors().concat([g,i,m,n,o]);},_buildWrapper:function(u,v){k.addClass(v,"-cx-PRIVATE-uiContextualDialog__content");var w=this.parent._buildWrapper(u,v);k.addClass(this._contentWrapper,"-cx-PRIVATE-uiContextualDialog__wrapper");if(u.width)this.setWidth(u.width);return w;},setWidth:function(u){this._width=Math.floor(u);p.set(this._contentWrapper,'width',u+'px');return this;},getFooter:function(){return this._footer;}});q(t,{setContext:function(u,v){u.setContext(v);}});e.exports=t;});
__d("ContextualLayerHideOnScroll",["event-extensions","Class","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Class'),h=b('copyProperties');function i(j){this._layer=j;}h(i.prototype,{_subscriptions:[],enable:function(){this._subscriptions=[this._layer.subscribe('contextchange',this._handleContextChange.bind(this)),this._layer.subscribe('show',this.attach.bind(this)),this._layer.subscribe('hide',this.detach.bind(this))];},disable:function(){while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this.detach();},attach:function(){if(this._listener)return;var j=this._layer.getContextScrollParent();if(j===window)return;this._listener=Event.listen(j,'scroll',this._layer.hide.bind(this._layer));},detach:function(){this._listener&&this._listener.remove();this._listener=null;},_handleContextChange:function(){this.detach();if(this._layer.isShown())this.attach();}});e.exports=i;});
__d("ContextualLayerUpdateOnScroll",["event-extensions","Class","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Class'),h=b('copyProperties');function i(j){this._layer=j;}h(i.prototype,{_subscriptions:[],enable:function(){this._subscriptions=[this._layer.subscribe('show',this._attachScrollListener.bind(this)),this._layer.subscribe('hide',this._removeScrollListener.bind(this))];},disable:function(){while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this.detach();},_attachScrollListener:function(){if(this._listener)return;var j=this._layer.getContextScrollParent();this._listener=Event.listen(j,'scroll',this._layer.updatePosition.bind(this._layer));},_removeScrollListener:function(){this._listener&&this._listener.remove();this._listener=null;}});e.exports=i;});
__d("BasicTypeaheadRenderer",["DOM"],function(a,b,c,d,e,f){var g=b('DOM');function h(i,j){var k=[];if(i.icon)k.push(g.create('img',{alt:'',src:i.icon}));if(i.text)k.push(g.create('span',{className:'text'},[i.text]));if(i.subtext)k.push(g.create('span',{className:'subtext'},[i.subtext]));var l=g.create('li',{className:i.type||''},k);l.setAttribute('role','option');if(i.text)l.setAttribute('aria-label',i.text);return l;}h.className='basic';e.exports=h;});
__d("TypeaheadView",["event-extensions","ArbiterMixin","ARIA","BasicTypeaheadRenderer","Class","CSS","DOM","Parent","$","copyProperties","ge","tx"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('ARIA'),i=b('BasicTypeaheadRenderer'),j=b('Class'),k=b('CSS'),l=b('DOM'),m=b('Parent'),n=b('$'),o=b('copyProperties'),p=b('ge'),q=b('tx');function r(s,t){this.element=this.content=n(s);o(this,t);}o(r.prototype,g,{events:['highlight','render','reset','select','beforeRender','next','prev'],renderer:i,autoSelect:false,accessibleResultsText:"Autocomplete results are available. Use the up and down arrow keys to navigate the results.",accessibleEmptyText:"No autocomplete results are available.",ignoreMouseover:false,init:function(){this.init=bagofholding;this.initializeEvents();this.reset();},initializeEvents:function(){Event.listen(this.element,{mouseup:this.mouseup.bind(this),mouseover:this.mouseover.bind(this)});},setTypeahead:function(s){this.typeahead=s;},getElement:function(){return this.element;},mouseup:function(event){if(event.button!=2){this.select(true);event.kill();}},mouseover:function(event){if(this.ignoreMouseover){this.ignoreMouseover=false;return;}if(this.visible)this.highlight(this.getIndex(event));},reset:function(s){if(!s)this.disableAutoSelect=false;this.justRendered=false;this.justShown=false;this.index=-1;this.items=[];this.results=[];this.value='';this.content.innerHTML='';this.inform('reset');return this;},getIndex:function(event){return this.items.indexOf(m.byTag(event.getTarget(),'li'));},getSelection:function(){var s=this.results[this.index]||null;return this.visible?s:null;},isEmpty:function(){return !this.results.length;},isVisible:function(){return this.visible;},show:function(){k.show(this.element);if(this.results&&this.results.length)if(this.autoSelect){h.notify(q._("{name} is auto-selected. Use the up and down arrow keys to navigate more results.",{name:this.getItemText(this.selected)}));}else h.notify(this.accessibleResultsText);this.typeahead&&this.element.setAttribute('aria-expanded','true');this.visible=true;return this;},hide:function(){k.hide(this.element);h.notify('');this.typeahead&&this.typeahead.setAttribute('aria-expanded','false');this.visible=false;return this;},render:function(s,t,u){this.value=s;if(!t.length){if(this.results.length&&s)h.notify(this.accessibleEmptyText);this.reset(true);return;}this.justRendered=true;if(!this.results.length){this.justShown=true;if(!this.autoSelect&&this.isVisible()&&t.length)h.notify(this.accessibleResultsText);}var v={results:t,value:s};this.inform('beforeRender',v);t=v.results;var w=this.getDefaultIndex(t);if(this.index>0&&this.index!==this.getDefaultIndex(this.results)){var x=this.results[this.index];for(var y=0,z=t.length;y<z;++y)if(x.uid==t[y].uid){w=y;break;}}this.results=t;l.setContent(this.content,this.buildResults(t));this.items=this.getItems();this.highlight(w,false);this.inform('render',t);},getItems:function(){return l.scry(this.content,'li');},buildResults:function(s){var t,u=null;if(typeof this.renderer=='function'){t=this.renderer;u=this.renderer.className||'';}else{t=a.TypeaheadRenderers[this.renderer];u=this.renderer;}t=t.bind(this);var v=s.map(function(x,y){return x.node||t(x,y);}),w=l.create('ul',{className:u,id:'typeahead_list_'+(this.typeahead?l.getID(this.typeahead):l.getID(this.element))},v);w.setAttribute('role','listbox');return w;},getDefaultIndex:function(s){var t=(this.autoSelect&&!this.disableAutoSelect);return this.index<0&&!t?-1:0;},next:function(){this.highlight(this.index+1);this.inform('next',this.selected);},prev:function(){this.highlight(this.index-1);this.inform('prev',this.selected);},getItemText:function(s){var t='';if(s){t=s.getAttribute('aria-label');if(!t){t=l.getText(s);s.setAttribute('aria-label',t);}}return t;},setIsViewingSelectedItems:function(s){this.viewingSelected=s;return this;},getIsViewingSelectedItems:function(){return this.viewingSelected;},highlight:function(s,t){var u=true;this.selected&&k.removeClass(this.selected,'selected');if(s>this.items.length-1){s=-1;}else if(s<-1)s=this.items.length-1;if(s>=0&&s<this.items.length){if(this.selected&&this.getItemText(this.items[s])===this.getItemText(this.selected))u=false;this.selected=this.items[s];k.addClass(this.selected,'selected');}this.index=s;this.disableAutoSelect=(s==-1);var v=(s!==-1),w=this.getItemText(this.selected);if(s!==-1&&this.isVisible()&&w&&this.autoSelect)if(this.justShown){h.notify(q._("{name} is auto-selected. Use the up and down arrow keys to navigate more results.",{name:w}));this.justRendered=false;this.justShown=false;v=false;}else if(u&&this.justRendered){h.notify(q._("{name} is auto-selected.",{name:w}));this.justRendered=false;v=false;}if(u&&v)h.announce(w);if(t!==false)this.inform('highlight',{index:s,selected:this.results[s],element:this.selected});},select:function(s){var t=this.index,u=this.results[t];if(u){this.inform('select',{index:t,clicked:!!s,selected:u});this.inform('afterSelect');}}});e.exports=r;});
__d("BucketedTypeaheadView",["Class","DOM","TypeaheadView","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('DOM'),i=b('TypeaheadView'),j=b('copyProperties');function k(l,m){this.parent.construct(this,l,m);}g.extend(k,i);j(k.prototype,{render:function(l,m,n){m=this.buildBuckets(l,m);return this.parent.render(l,m,n);},highlight:function(l,m){if(l==-1&&this.index!==0)l=this.index;if(l>=0&&l<this.items.length&&this.results[l].type=='header')l=l+1;this.parent.highlight(l,m);},buildBuckets:function(l,m){if(!this.typeObjects)return m;var n=[],o={};for(var p=0;p<m.length;++p){var q=m[p],r=q.render_type||q.type;if(!o.hasOwnProperty(r)){o[r]=n.length;n.push([this.buildBucketHeader(r)]);}q.classNames=r;q.groupIndex=o[r];q.indexInGroup=n[q.groupIndex].length-1;n[q.groupIndex].push(q);}var s=[];for(var t=0;t<n.length;++t)s=s.concat(n[t]);return s;},buildBucketHeader:function(l){var m=this.typeObjects[l];if(m.markup){m.text=m.markup;delete m.markup;}return this.typeObjects[l];},buildResults:function(l){var m=this.parent.buildResults(l);if(this.typeObjects){return h.create('div',{className:'bucketed'},[m]);}else return m;},select:function(l){var m=this.results[this.index];if(m&&m.type!='header')this.parent.select(l);},getDefaultIndex:function(l){var m=(this.autoSelect&&!this.disableAutoSelect),n=l.length===0?-1:(l[0].type=='header'?1:0);return this.index<0&&!m?-1:n;},prev:function(){var l=this.results[this.index-1];if(l&&l.type=='header')this.index--;return this.parent.prev();},next:function(){var l=this.results[this.index+1];if(l&&l.type=='header')this.index++;return this.parent.next();}});e.exports=k;});
__d("ContextualTypeaheadView",["event-extensions","Class","ContextualLayer","ContextualLayerAutoFlip","ContextualLayerHideOnScroll","CSS","DOM","Style","BucketedTypeaheadView","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Class'),h=b('ContextualLayer'),i=b('ContextualLayerAutoFlip'),j=b('ContextualLayerHideOnScroll'),k=b('CSS'),l=b('DOM'),m=b('Style'),n=b('BucketedTypeaheadView'),o=b('Vector'),p=b('copyProperties');function q(r,s){this.parent.construct(this,r,s);}g.extend(q,n);p(q.prototype,{init:function(){this.initializeLayer();this.parent.init();},initializeLayer:function(){this.context=this.getContext();this.wrapper=l.create('div');l.appendContent(this.wrapper,this.element);k.addClass(this.element,'uiContextualTypeaheadView');this.layer=new h({context:this.context,position:'below',causalElement:this.causalElement},this.wrapper);this.layer.enableBehavior(j);if(m.isFixed(this.context))this.layer.enableBehavior(i);this.subscribe('render',this.renderLayer.bind(this));},show:function(){this.layer.show();o.getElementDimensions(this.context).setElementWidth(this.wrapper);return this.parent.show();},hide:function(){this.layer.hide();return this.parent.hide();},renderLayer:function(){if(!this.isVisible())return;if(this.layer.isShown()){this.layer.updatePosition();}else this.layer.show();},getContext:function(){return this.element.parentNode;}});e.exports=q;});
__d("CustomPrivacyOption",["event-extensions","AsyncRequest","Dialog","DOM","Form","Parent","Selector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h=b('Dialog'),i=b('DOM'),j=b('Form'),k=b('Parent'),l=b('Selector'),m=b('copyProperties');function n(){}m(n,{_instances:{},update:function(o,p,q,r){var s=n._instances[o];s._update(p,q)._updateOption(q,r);Arbiter.inform('Form/change',{node:s._container});},getData:function(o){return n._instances[o]._privacyData;}});m(n.prototype,{init:function(o,p,q,r,s){(function(){var t=this.initCustomState(o,p);if(!t)return;Event.listen(t,'click',function(event){this.openCustomDialog(event,o,q,s);}.bind(this));this._initSelector(t,r);}).bind(this).defer();},_initSelector:function(o,p){this._selector=k.byClass(o,'uiSelector');l.listen(this._selector,'select',function(q){if(q.option._id!=this._id)this.clearCustomState();}.bind(this));if(p)l.setButtonTooltip(this._selector,p);},_updateOption:function(o,p){var q=l.getOption(this._selector,o)||l.getOption(this._selector,PrivacyBaseValue.CUSTOM+'');Arbiter.inform('CustomPrivacyOption/update',{selector:this._selector,option:q,tooltip:p});return this;},_update:function(o,p){var q=p==PrivacyBaseValue.CUSTOM||!l.getOption(this._selector,p),r=this._selector.getAttribute('data-name');this.updateCustomState(o,q,r);return this;},initCustomState:function(o,p){var q=ge(o);if(!q)return q;n._instances[o]=this;this._container=i.find(q,'.customPrivacyInputs');this._id=p;this._privacyData={};var r=j.serialize(this._container);if(r.audience)this._privacyData=r.audience[p];return q;},openCustomDialog:function(event,o,p,q){var r=new g('/ajax/privacy/custom_dialog/').setData({option_id:o,id:this._id,privacy_data:this._privacyData,explain_tags:p,autosave:q});new h().setAsync(r).setModal(true).setCausalElement(event.getTarget()).show();},updateCustomState:function(o,p,q){this.clearCustomState();this._privacyData=m({},o);if(p)if(q){q=q.slice(0,-'[value]'.length);var r={};r[q]=o;j.createHiddenInputs(r,this._container,null,true);}},clearCustomState:function(){this._privacyData={};i.empty(this._container);}});e.exports=n;});
__d("TypeaheadUtil",["function-extensions"],function(a,b,c,d,e,f){b('function-extensions');var g=/[ ]+/g,h=/[^ ]+/g,i=/[.,+*?$|#{}()\^\-\[\]\\\/!@%'"~=<>_:;\u2010\u2011\u2012\u2013\u2014\u2015\u30fb\uff1a]/g,j={},k={a:"\u0430 \u00e0 \u00e1 \u00e2 \u00e3 \u00e4 \u00e5",b:"\u0431",c:"\u0446 \u00e7 \u010d",d:"\u0434 \u00f0 \u010f \u0111",e:"\u044d \u0435 \u00e8 \u00e9 \u00ea \u00eb \u011b",f:"\u0444",g:"\u0433 \u011f",h:"\u0445 \u0127",i:"\u0438 \u00ec \u00ed \u00ee \u00ef \u0131",j:"\u0439",k:"\u043a \u0138",l:"\u043b \u013e \u013a \u0140 \u0142",m:"\u043c",n:"\u043d \u00f1 \u0148 \u0149 \u014b",o:"\u043e \u00f8 \u00f6 \u00f5 \u00f4 \u00f3 \u00f2",p:"\u043f",r:"\u0440 \u0159 \u0155",s:"\u0441 \u015f \u0161 \u017f",t:"\u0442 \u0165 \u0167 \u00fe",u:"\u0443 \u044e \u00fc \u00fb \u00fa \u00f9 \u016f",v:"\u0432",y:"\u044b \u00ff \u00fd",z:"\u0437 \u017e",ae:"\u00e6",oe:"\u0153",ts:"\u0446",ch:"\u0447",ij:"\u0133",sh:"\u0448",ss:"\u00df",ya:"\u044f"};for(var l in k){var m=k[l].split(' ');for(var n=0;n<m.length;n++)j[m[n]]=l;}var o={};function p(v){return v?v.replace(i,' '):'';}function q(v){v=(''+v).toLowerCase();var w='',x='';for(var y=v.length;y--;){x=v.charAt(y);w=(j[x]||x)+w;}return w.replace(g,' ');}function r(v){var w=[],x=h.exec(v);while(x){x=x[0];w.push(x);x=h.exec(v);}return w;}function s(v,w){v=''+v;if(!o.hasOwnProperty(v)){var x=q(v),y=p(x);o[v]={value:v,flatValue:x,tokens:r(y),isPrefixQuery:y&&y[y.length-1]!=' '};}if(w&&typeof o[v].sortedTokens=='undefined'){o[v].sortedTokens=o[v].tokens.slice();o[v].sortedTokens.sort(function(z,aa){return aa.length-z.length;});}return o[v];}function t(v,w,x){var y=s(w,v=='prefix'),z=v=='prefix'?y.sortedTokens:y.tokens,aa=s(x).tokens,ba={},ca=y.isPrefixQuery&&v=='query'?z.length-1:null,da=function(ea,fa){for(var ga=0;ga<aa.length;++ga){var ha=aa[ga];if(!ba[ga]&&(ha==ea||((v=='query'&&fa===ca||v=='prefix')&&ha.indexOf(ea)===0)))return (ba[ga]=true);}return false;};return z.length&&z.every(da);}var u={parse:s,isExactMatch:t.curry('exact'),isQueryMatch:t.curry('query'),isPrefixMatch:t.curry('prefix')};e.exports=u;});
__d("DataSource",["array-extensions","ArbiterMixin","AsyncRequest","Class","TypeaheadUtil","copyProperties","createArrayFrom","createObjectFrom"],function(a,b,c,d,e,f){b('array-extensions');var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('Class'),j=b('TypeaheadUtil'),k=b('copyProperties'),l=b('createArrayFrom'),m=b('createObjectFrom');function n(o){this._maxResults=o.maxResults||10;this.token=o.token;this.queryData=o.queryData||{};this.queryEndpoint=o.queryEndpoint||'';this.bootstrapData=o.bootstrapData||{};this.bootstrapEndpoint=o.bootstrapEndpoint||'';this._exclusions=o.exclusions||[];this._indexedFields=o.indexedFields||['text','tokens'];this._alwaysPrefixMatch=o.alwaysPrefixMatch||false;this._deduplicationKey=o.deduplicationKey||null;this._minExactMatchLength=4;this._filters=[];}k(n.prototype,g,{events:['bootstrap','query','respond'],init:function(){this.init=bagofholding;this._fields=m(this._indexedFields);this._activeQueries=0;this.dirty();},dirty:function(){this.value='';this._bootstrapped=false;this._bootstrapping=false;this._data={};this.localCache={};this.queryCache={};this.inform('dirty',{});return this;},bootstrap:function(){if(this._bootstrapped)return;this.bootstrapWithoutToken();this._bootstrapped=true;this._bootstrapping=true;this.inform('bootstrap',{bootstrapping:true});},bootstrapWithoutToken:function(){this.fetch(this.bootstrapEndpoint,this.bootstrapData,{bootstrap:true,token:this.token});},bootstrapWithToken:function(){var o=k({},this.bootstrapData);o.token=this.token;this.fetch(this.bootstrapEndpoint,o,{bootstrap:true,replaceCache:true});},query:function(o,p,q){this.inform('beforeQuery',{value:o});var r=this.buildUids(o,[],q),s=this.respond(o,r);this.value=o;this.inform('query',{value:o,results:s});var t=j.parse(o).flatValue;if(p||!t||!this.queryEndpoint||this.getQueryCache().hasOwnProperty(t)||!this.shouldFetchMoreResults(s))return false;this.inform('queryEndpoint',{value:o});this.fetch(this.queryEndpoint,this.getQueryData(o,r),{value:o,exclusions:q});return true;},shouldFetchMoreResults:function(o){return o.length<this._maxResults;},getQueryData:function(o,p){var q=k({value:o},this.queryData||{});p=p||[];if(p.length)q.existing_ids=p.join(',');if(this._bootstrapping)q.bsp=true;return q;},setQueryData:function(o,p){if(p)this.queryData={};k(this.queryData,o);return this;},setBootstrapData:function(o,p){if(p)this.bootstrapData={};k(this.bootstrapData,o);return this;},getExclusions:function(){return l(this._exclusions);},setExclusions:function(o){this._exclusions=o||[];},addFilter:function(o){var p=this._filters;p.push(o);return {remove:function(){p.splice(p.indexOf(o),1);}};},clearFilters:function(){this._filters=[];},respond:function(o,p,q){var r=this.buildData(p);this.inform('respond',{value:o,results:r,isAsync:!!q});return r;},asyncErrorHandler:bagofholding,fetch:function(o,p,q){if(!o)return;var r=new h().setURI(o).setData(p).setMethod('GET').setReadOnly(true).setHandler(function(s){this.fetchHandler(s,q||{});}.bind(this));if(o===this.queryEndpoint)r.setFinallyHandler(function(){this._activeQueries--;if(!this._activeQueries)this.inform('activity',{activity:false});}.bind(this));r.setErrorHandler(this.asyncErrorHandler);this.inform('beforeFetch',{request:r,fetch_context:q});r.send();if(o===this.queryEndpoint){if(!this._activeQueries)this.inform('activity',{activity:true});this._activeQueries++;}},fetchHandler:function(o,p){var q=p.value,r=p.exclusions;if(!q&&p.replaceCache)this.localCache={};this.addEntries(o.getPayload().entries,q);this.inform('fetchComplete',{response:o,value:q,fetch_context:p});var s=(!q&&this.value)?this.value:q;this.respond(s,this.buildUids(s,[],r),true);if(!q){if(this._bootstrapping){this._bootstrapping=false;this.inform('bootstrap',{bootstrapping:false});}if(p.token&&o.getPayload().token!==p.token)this.bootstrapWithToken();}},addEntries:function(o,p){var q=this.processEntries(l(o||[]),p),r=this.buildUids(p,q);if(p){var s=this.getQueryCache();s[j.parse(p).flatValue]=r;}else this.fillCache(r);},processEntries:function(o,p){return o.map(function(q,r){var s=(q.uid=q.uid+''),t=this.getEntry(s);if(!t){t=q;t.query=p;this.setEntry(s,t);}else k(t,q);t.index===undefined&&(t.index=r);return s;},this);},getAllEntries:function(){return this._data||{};},getEntry:function(o){return this._data[o]||null;},setEntry:function(o,p){this._data[o]=p;},fillCache:function(o){var p=this.localCache;o.forEach(function(q){var r=this.getEntry(q);if(!r)return;r.bootstrapped=true;var s=j.parse(this.getTextToIndex(r)).tokens;for(var t=0,u=s.length;t<u;++t){var v=s[t];if(!p.hasOwnProperty(v))p[v]={};p[v][q]=true;}},this);},getTextToIndex:function(o){if(o.textToIndex&&!o.needs_update)return o.textToIndex;var p=[];for(var q in this._fields){var r=o[q];if(r)p.push(r.join?r.join(' '):r);}o.needs_update=false;return (o.textToIndex=p.join(' '));},mergeUids:function(o,p,q,r){var s=function(t,u){var v=this.getEntry(t),w=this.getEntry(u);if(v.extended_match!==w.extended_match)return v.extended_match?1:-1;if(v.index!==w.index)return v.index-w.index;if(v.text.length!==w.text.length)return v.text.length-w.text.length;return v.uid<w.uid;}.bind(this);this._checkExtendedMatch(r,o);return this.deduplicateByKey(o.sort(s).concat(p,q));},_checkExtendedMatch:function(o,p){var q=this._alwaysPrefixMatch?j.isPrefixMatch:j.isQueryMatch;for(var r=0;r<p.length;++r){var s=this.getEntry(p[r]);s.extended_match=s.tokens?!q(o,s.text):false;}},buildUids:function(o,p,q){if(!p)p=[];if(!o)return p;if(!q)q=[];var r=this.buildCacheResults(o,this.localCache),s=this.buildQueryResults(o),t=this.mergeUids(r,s,p,o),u=m(q.concat(this._exclusions)),v=t.filter(function(w){if(u.hasOwnProperty(w)||!this.getEntry(w))return false;for(var x=0;x<this._filters.length;++x)if(!this._filters[x](this.getEntry(w),o))return false;return (u[w]=true);},this);return this.uidsIncludingExact(o,v,u);},uidsIncludingExact:function(o,p,q){var r=p.length;if(o.length<this._minExactMatchLength||r<=this._maxResults)return p;for(var s=0;s<r;++s){var t=this.getEntry(p[s]);t.text_lower||(t.text_lower=t.text.toLowerCase());if(t.text_lower===j.parse(o).flatValue){if(s>=this._maxResults){var u=p.splice(s,1);p.splice(this._maxResults-1,0,u);}break;}}return p;},buildData:function(o){var p=[],q=Math.min(o.length,this._maxResults);for(var r=0;r<q;++r)p.push(this.getEntry(o[r]));return p;},findQueryCache:function(o){var p=0,q=null,r=this.getQueryCache();for(var s in r)if(o.indexOf(s)===0&&s.length>p){p=s.length;q=s;}return r[q]||[];},buildQueryResults:function(o){var p=j.parse(o).flatValue,q=this.findQueryCache(p);if(this.getQueryCache().hasOwnProperty(p))return q;return this.filterQueryResults(o,q);},filterQueryResults:function(o,p){var q=this._alwaysPrefixMatch?j.isPrefixMatch:j.isQueryMatch;return p.filter(function(r){return q(o,this.getTextToIndex(this.getEntry(r)));},this);},buildCacheResults:function(o,p){var q=j.parse(o,this._alwaysPrefixMatch),r=this._alwaysPrefixMatch?q.sortedTokens:q.tokens,s=r.length,t=q.isPrefixQuery?s-1:null,u={},v={},w={},x=[],y=false,z={},aa=0;for(var ba=0;ba<s;++ba){var ca=r[ba];if(!z.hasOwnProperty(ca)){aa++;z[ca]=true;}else continue;for(var da in p)if((!u.hasOwnProperty(da)&&da===ca)||((this._alwaysPrefixMatch||t===ba)&&da.indexOf(ca)===0)){if(da===ca){if(v.hasOwnProperty(da))y=true;u[da]=true;}else{if(u.hasOwnProperty(da)||v.hasOwnProperty(da))y=true;v[da]=true;}for(var ea in p[da])if(ba===0||(w.hasOwnProperty(ea)&&w[ea]==aa-1))w[ea]=aa;}}for(var fa in w)if(w[fa]==aa)x.push(fa);if(y||aa<s)x=this.filterQueryResults(o,x);return x;},deduplicateByKey:function(o){if(!this._deduplicationKey)return o;var p=m(o.map(this._getDeduplicationKey.bind(this)),o);return o.filter(function(q){return p[this._getDeduplicationKey(q)]==q;}.bind(this));},_getDeduplicationKey:function(o){var p=this.getEntry(o);return p[this._deduplicationKey]||'__'+o+'__';},getQueryCache:function(){return this.queryCache;},setMaxResults:function(o){this._maxResults=o;this.value&&this.respond(this.value,this.buildUids(this.value));},updateToken:function(o){this.token=o;this.dirty();return this;}});e.exports=n;});
__d("Dcode",[],function(a,b,c,d,e,f){var g,h={},i={_:'%',A:'%2',B:'000',C:'%7d',D:'%7b%22',E:'%2c%22',F:'%22%3a',G:'%2c%22ut%22%3a1',H:'%2c%22bls%22%3a',I:'%2c%22n%22%3a%22%',J:'%22%3a%7b%22i%22%3a0%7d',K:'%2c%22pt%22%3a0%2c%22vis%22%3a',L:'%2c%22ch%22%3a%7b%22h%22%3a%22',M:'%7b%22v%22%3a2%2c%22time%22%3a1',N:'.channel%22%2c%22sub%22%3a%5b',O:'%2c%22sb%22%3a1%2c%22t%22%3a%5b',P:'%2c%22ud%22%3a100%2c%22lc%22%3a0',Q:'%5d%2c%22f%22%3anull%2c%22uct%22%3a',R:'.channel%22%2c%22sub%22%3a%5b1%5d',S:'%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a',T:'%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a',U:'%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',V:'%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a',W:'%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a',X:'%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1',Y:'%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',Z:'%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a'};(function(){var k=[];for(var l in i){h[i[l]]=l;k.push(i[l]);}k.reverse();g=new RegExp(k.join("|"),'g');})();var j={encode:function(k){return encodeURIComponent(k).replace(/([_A-Z])|%../g,function(l,m){return m?'%'+m.charCodeAt(0).toString(16):l;}).toLowerCase().replace(g,function(l){return h[l];});},decode:function(k){return decodeURIComponent(k.replace(/[_A-Z]/g,function(l){return i[l];}));}};e.exports=j;});
__d("DialogHideOnSuccess",["copyProperties","CSS","cx"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('CSS'),i=b('cx');function j(k){this._layer=k;}g(j.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('success',this._handle.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_handle:function(k,event){if(h.hasClass(event.getTarget(),"-cx-PRIVATE-uiDialog__form"))this._layer.hide();}});e.exports=j;});
__d("DocRPC",[],function(a,b,c,d,e,f){var g={_apis:{},_dispatch:function(h){var i;try{h=JSON.parse(h);}catch(j){throw new Error('DocRPC unparsable dispatch: "'+h+'"');}if(g._apis.hasOwnProperty(h.api)){var k=g._apis[h.api];if(k[h.method])i=k[h.method].apply(k,h.args);}if(i===undefined)i=null;return JSON.stringify(i);},publish:function(h,i){g._apis[i]=h;},proxy:function(h,i,j){var k={};j.forEach(function(l){k[l]=function(){var m={api:i,method:l,args:Array.prototype.slice.call(arguments)},n=h.DocRPC._dispatch(JSON.stringify(m));if(typeof(n)=='string')try{n=JSON.parse(n);}catch(o){throw new Error('DocRPC '+i+'.'+l+' unparsable return: "'+n+'"');}return n;};});return k;}};e.exports=a.DocRPC=g;});
__d("DocumentTitle",["Arbiter"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=document.title,i=null,j=1500,k=[],l=0,m=null,n=false;function o(){if(k.length>0){if(!n){p(k[l].title);l=++l%k.length;}else q();}else{clearInterval(m);m=null;q();}}function p(s){document.title=s;n=true;}function q(){r.set(i||h,true);n=false;}var r={get:function(){return h;},set:function(s,t){document.title=s;if(!t){h=s;i=null;g.inform('update_title',s);}else i=s;},blink:function(s){var t={title:s};k.push(t);if(m===null)m=setInterval(o,j);return {stop:function(){var u=k.indexOf(t);if(u>=0){k.splice(u,1);if(l>u){l--;}else if(l==u&&l==k.length)l=0;}}};}};e.exports=r;});
__d("Emote",["DOM","Env","htmlize"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('Env'),i=b('htmlize'),j=e.exports={_initialized:false,_imageBase:null,_emoteMap:null,_emoteOrderMap:null,_fbidEmoticonPattern:'\\[\\[([A-Za-z0-9\\.]+)\\]\\]',_fbidEmoticonRegex:null,_imageURLs:null,_regex:null,_regexWithoutFBIDs:null,_init:function(){var k=h.static_base;j._imageBase=k+'images/emote/';j._blankImgSrc=k+'images/blank.gif';var l=['smile','frown','tongue','grin','gasp','wink','glasses','sunglasses','grumpy','unsure','cry','devil','angel','kiss','heart','kiki','squint','confused','upset','pacman','colonthree','like'];j._emoteMap={':-)':['\\:\\-\\)','smile'],':)':['\\:\\)','smile'],':]':['\\:\\]','smile'],'=)':['=\\)','smile'],':-(':['\\:\\-\\(','frown'],':(':['\\:\\(','frown'],':[':['\\:\\[','frown'],'=(':['=\\(','frown'],':-P':['\\:\\-P','tongue'],':P':['\\:P','tongue'],':-p':['\\:\\-p','tongue'],':p':['\\:p','tongue'],'=P':['=P','tongue'],':-D':['\\:\\-D','grin'],':D':['\\:D','grin'],'=D':['=D','grin'],':-O':['\\:\\-O','gasp'],':O':['\\:O','gasp'],':-o':['\\:\\-o','gasp'],':o':['\\:o','gasp'],';-)':['\\;\\-\\)','wink'],';)':['\\;\\)','wink'],'8-)':['8\\-\\)','glasses'],'8)':['8\\)','glasses'],'B-)':['B\\-\\)','glasses'],'B)':['B\\)','glasses'],'8-|':['8\\-\\|','sunglasses'],'8|':['8\\|','sunglasses'],'B-|':['B\\-\\|','sunglasses'],'B|':['B\\|','sunglasses'],'>:(':['>\\:\\(','grumpy'],'>:-(':['>\\:\\-\\(','grumpy'],':/':['\\:/','unsure'],':-/':['\\:\\-/','unsure'],':\\':['\\:\\\\','unsure'],':-\\':['\\:\\-\\\\','unsure'],":'(":["\\:'\\(",'cry'],'3:)':['3\\:\\)','devil'],'3:-)':['3\\:\\-\\)','devil'],'O:)':['O\\:\\)','angel'],'O:-)':['O\\:\\-\\)','angel'],':-*':['\\:\\-\\*','kiss'],':*':['\\:\\*','kiss'],'<3':['<3','heart'],'&lt;3':['&lt\\;3','heart'],'\u2665':['\u2665','heart'],'^_^':['\\^_\\^','kiki'],'-_-':['\\-_\\-','squint'],'o.O':['o\\.O','confused'],'O.o':['O\\.o','confused'],'>:O':['>\\:O','upset'],'>:-O':['>\\:\\-O','upset'],'>:o':['>\\:o','upset'],'>:-o':['>\\:\\-o','upset'],'>_<':['>_<','upset'],'>.<':['>\\.<','upset'],':v':['\\:v','pacman'],':|]':['\\:\\|\\]','robot'],':3':['\\:3','colonthree'],'<(")':['<\\(\\"\\)','penguin'],':putnam:':['\\:putnam\\:','putnam'],'(^^^)':['\\(\\^\\^\\^\\)','shark'],':42:':['\\:42\\:','42'],':like:':['\\:like\\:','like'],'(y)':['\\(y\\)','like'],'(Y)':['\\(Y\\)','like']};var m=[],n=[];if(h.fbid_emoticons){j._fbidEmoticonRegex=new RegExp(j._fbidEmoticonPattern);m.push(j._fbidEmoticonPattern);}for(var o in j._emoteMap){var p=j._emoteMap[o][0];m.push(p);n.push(p);}var q='(?:^|\\s|\'|"|\\.)('+m.join('|')+')(?:\\s|\'|"|\\.|,|!|\\?|<br>|$)',r='(?:^|\\s|\'|"|\\.)('+n.join('|')+')(?:\\s|\'|"|\\.|,|!|\\?|<br>|$)';j._regex=new RegExp(q);j._regexWithoutFBIDs=new RegExp(r);j._emoteOrderMap={};for(var s=0;s<l.length;s++)j._emoteOrderMap[l[s]]=s;j._initialized=true;},htmlEmote:function(k,l){return j._htmlEmote(k,l,true);},htmlEmoteWithoutFBID:function(k,l){return j._htmlEmote(k,l,false);},_getRegex:function(k){return k?j._regex:j._regexWithoutFBIDs;},_htmlEmote:function(k,l,m){if(typeof l!='function')l=i;if(!j._initialized)j._init();var n=k,o=[];while(true){var p=j._getRegex(m),q=p.exec(n);if(!q||!q.length)break;var r=q[1],s=n.indexOf(r),t=n.substring(0,s);if(t)o.push(l(t));o.push('<span class="emote_text">');o.push(r);o.push('</span>');var u={title:r},v=j._fbidEmoticonRegex&&(j._fbidEmoticonRegex.exec(r)||[])[1];if(v){u.className='emote_custom';u.src=window.location.protocol+'//graph.facebook.com/'+encodeURIComponent(v)+'/picture';}else{var w=j._emoteMap[r][1],x=j._emoteOrderMap[w];if(x===undefined){u.className='emote_custom';u.src=j._imageBase+w+'.gif';}else{var y=x*-16;u.className='emote_img';u.src=j._blankImgSrc;u.style={backgroundPosition:y+'px 0'};}}var z=g.create('img',u);o.push(g.create('span',{},z).innerHTML);n=n.substring(s+r.length);}if(n)o.push(l(n));return o.join('');}};});
__d("SupportedEmoji",["cx"],function(a,b,c,d,e,f){var g=b('cx');e.exports={utf16Regex:/\u203C|\u2049|[\u2100-\u21FF]|[\u2300-\u27FF]|[\u2900-\u29FF]|[\u2B00-\u2BFF]|[\u3000-\u30FF]|[\u3200-\u32FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDEFF]/,emoji:{127744:"-cx-PRIVATE-fbEmoji__icon_1f300",127746:"-cx-PRIVATE-fbEmoji__icon_1f302",127754:"-cx-PRIVATE-fbEmoji__icon_1f30a",127769:"-cx-PRIVATE-fbEmoji__icon_1f319",127775:"-cx-PRIVATE-fbEmoji__icon_1f31f",127793:"-cx-PRIVATE-fbEmoji__icon_1f331",127796:"-cx-PRIVATE-fbEmoji__icon_1f334",127797:"-cx-PRIVATE-fbEmoji__icon_1f335",127799:"-cx-PRIVATE-fbEmoji__icon_1f337",127800:"-cx-PRIVATE-fbEmoji__icon_1f338",127801:"-cx-PRIVATE-fbEmoji__icon_1f339",127802:"-cx-PRIVATE-fbEmoji__icon_1f33a",127803:"-cx-PRIVATE-fbEmoji__icon_1f33b",127806:"-cx-PRIVATE-fbEmoji__icon_1f33e",127808:"-cx-PRIVATE-fbEmoji__icon_1f340",127809:"-cx-PRIVATE-fbEmoji__icon_1f341",127810:"-cx-PRIVATE-fbEmoji__icon_1f342",127811:"-cx-PRIVATE-fbEmoji__icon_1f343",127818:"-cx-PRIVATE-fbEmoji__icon_1f34a",127822:"-cx-PRIVATE-fbEmoji__icon_1f34e",127827:"-cx-PRIVATE-fbEmoji__icon_1f353",127828:"-cx-PRIVATE-fbEmoji__icon_1f354",127864:"-cx-PRIVATE-fbEmoji__icon_1f378",127866:"-cx-PRIVATE-fbEmoji__icon_1f37a",127873:"-cx-PRIVATE-fbEmoji__icon_1f381",127875:"-cx-PRIVATE-fbEmoji__icon_1f383",127876:"-cx-PRIVATE-fbEmoji__icon_1f384",127877:"-cx-PRIVATE-fbEmoji__icon_1f385",127880:"-cx-PRIVATE-fbEmoji__icon_1f388",127881:"-cx-PRIVATE-fbEmoji__icon_1f389",127885:"-cx-PRIVATE-fbEmoji__icon_1f38d",127886:"-cx-PRIVATE-fbEmoji__icon_1f38e",127887:"-cx-PRIVATE-fbEmoji__icon_1f38f",127888:"-cx-PRIVATE-fbEmoji__icon_1f390",127891:"-cx-PRIVATE-fbEmoji__icon_1f393",127925:"-cx-PRIVATE-fbEmoji__icon_1f3b5",127926:"-cx-PRIVATE-fbEmoji__icon_1f3b6",127932:"-cx-PRIVATE-fbEmoji__icon_1f3bc",128013:"-cx-PRIVATE-fbEmoji__icon_1f40d",128014:"-cx-PRIVATE-fbEmoji__icon_1f40e",128017:"-cx-PRIVATE-fbEmoji__icon_1f411",128018:"-cx-PRIVATE-fbEmoji__icon_1f412",128020:"-cx-PRIVATE-fbEmoji__icon_1f414",128023:"-cx-PRIVATE-fbEmoji__icon_1f417",128024:"-cx-PRIVATE-fbEmoji__icon_1f418",128025:"-cx-PRIVATE-fbEmoji__icon_1f419",128026:"-cx-PRIVATE-fbEmoji__icon_1f41a",128027:"-cx-PRIVATE-fbEmoji__icon_1f41b",128031:"-cx-PRIVATE-fbEmoji__icon_1f41f",128032:"-cx-PRIVATE-fbEmoji__icon_1f420",128033:"-cx-PRIVATE-fbEmoji__icon_1f421",128037:"-cx-PRIVATE-fbEmoji__icon_1f425",128038:"-cx-PRIVATE-fbEmoji__icon_1f426",128039:"-cx-PRIVATE-fbEmoji__icon_1f427",128040:"-cx-PRIVATE-fbEmoji__icon_1f428",128041:"-cx-PRIVATE-fbEmoji__icon_1f429",128043:"-cx-PRIVATE-fbEmoji__icon_1f42b",128044:"-cx-PRIVATE-fbEmoji__icon_1f42c",128045:"-cx-PRIVATE-fbEmoji__icon_1f42d",128046:"-cx-PRIVATE-fbEmoji__icon_1f42e",128047:"-cx-PRIVATE-fbEmoji__icon_1f42f",128048:"-cx-PRIVATE-fbEmoji__icon_1f430",128049:"-cx-PRIVATE-fbEmoji__icon_1f431",128051:"-cx-PRIVATE-fbEmoji__icon_1f433",128052:"-cx-PRIVATE-fbEmoji__icon_1f434",128053:"-cx-PRIVATE-fbEmoji__icon_1f435",128055:"-cx-PRIVATE-fbEmoji__icon_1f437",128056:"-cx-PRIVATE-fbEmoji__icon_1f438",128057:"-cx-PRIVATE-fbEmoji__icon_1f439",128058:"-cx-PRIVATE-fbEmoji__icon_1f43a",128059:"-cx-PRIVATE-fbEmoji__icon_1f43b",128062:"-cx-PRIVATE-fbEmoji__icon_1f43e",128064:"-cx-PRIVATE-fbEmoji__icon_1f440",128066:"-cx-PRIVATE-fbEmoji__icon_1f442",128067:"-cx-PRIVATE-fbEmoji__icon_1f443",128068:"-cx-PRIVATE-fbEmoji__icon_1f444",128069:"-cx-PRIVATE-fbEmoji__icon_1f445",128070:"-cx-PRIVATE-fbEmoji__icon_1f446",128071:"-cx-PRIVATE-fbEmoji__icon_1f447",128072:"-cx-PRIVATE-fbEmoji__icon_1f448",128073:"-cx-PRIVATE-fbEmoji__icon_1f449",128074:"-cx-PRIVATE-fbEmoji__icon_1f44a",128075:"-cx-PRIVATE-fbEmoji__icon_1f44b",128076:"-cx-PRIVATE-fbEmoji__icon_1f44c",128077:"-cx-PRIVATE-fbEmoji__icon_1f44d",128078:"-cx-PRIVATE-fbEmoji__icon_1f44e",128079:"-cx-PRIVATE-fbEmoji__icon_1f44f",128080:"-cx-PRIVATE-fbEmoji__icon_1f450",128102:"-cx-PRIVATE-fbEmoji__icon_1f466",128103:"-cx-PRIVATE-fbEmoji__icon_1f467",128104:"-cx-PRIVATE-fbEmoji__icon_1f468",128105:"-cx-PRIVATE-fbEmoji__icon_1f469",128107:"-cx-PRIVATE-fbEmoji__icon_1f46b",128110:"-cx-PRIVATE-fbEmoji__icon_1f46e",128111:"-cx-PRIVATE-fbEmoji__icon_1f46f",128113:"-cx-PRIVATE-fbEmoji__icon_1f471",128114:"-cx-PRIVATE-fbEmoji__icon_1f472",128115:"-cx-PRIVATE-fbEmoji__icon_1f473",128116:"-cx-PRIVATE-fbEmoji__icon_1f474",128117:"-cx-PRIVATE-fbEmoji__icon_1f475",128118:"-cx-PRIVATE-fbEmoji__icon_1f476",128119:"-cx-PRIVATE-fbEmoji__icon_1f477",128120:"-cx-PRIVATE-fbEmoji__icon_1f478",128123:"-cx-PRIVATE-fbEmoji__icon_1f47b",128124:"-cx-PRIVATE-fbEmoji__icon_1f47c",128125:"-cx-PRIVATE-fbEmoji__icon_1f47d",128126:"-cx-PRIVATE-fbEmoji__icon_1f47e",128127:"-cx-PRIVATE-fbEmoji__icon_1f47f",128128:"-cx-PRIVATE-fbEmoji__icon_1f480",128130:"-cx-PRIVATE-fbEmoji__icon_1f482",128131:"-cx-PRIVATE-fbEmoji__icon_1f483",128133:"-cx-PRIVATE-fbEmoji__icon_1f485",128139:"-cx-PRIVATE-fbEmoji__icon_1f48b",128143:"-cx-PRIVATE-fbEmoji__icon_1f48f",128144:"-cx-PRIVATE-fbEmoji__icon_1f490",128145:"-cx-PRIVATE-fbEmoji__icon_1f491",128147:"-cx-PRIVATE-fbEmoji__icon_1f493",128148:"-cx-PRIVATE-fbEmoji__icon_1f494",128150:"-cx-PRIVATE-fbEmoji__icon_1f496",128151:"-cx-PRIVATE-fbEmoji__icon_1f497",128152:"-cx-PRIVATE-fbEmoji__icon_1f498",128153:"-cx-PRIVATE-fbEmoji__icon_1f499",128154:"-cx-PRIVATE-fbEmoji__icon_1f49a",128155:"-cx-PRIVATE-fbEmoji__icon_1f49b",128156:"-cx-PRIVATE-fbEmoji__icon_1f49c",128157:"-cx-PRIVATE-fbEmoji__icon_1f49d",128162:"-cx-PRIVATE-fbEmoji__icon_1f4a2",128164:"-cx-PRIVATE-fbEmoji__icon_1f4a4",128166:"-cx-PRIVATE-fbEmoji__icon_1f4a6",128168:"-cx-PRIVATE-fbEmoji__icon_1f4a8",128169:"-cx-PRIVATE-fbEmoji__icon_1f4a9",128170:"-cx-PRIVATE-fbEmoji__icon_1f4aa",128187:"-cx-PRIVATE-fbEmoji__icon_1f4bb",128189:"-cx-PRIVATE-fbEmoji__icon_1f4bd",128190:"-cx-PRIVATE-fbEmoji__icon_1f4be",128191:"-cx-PRIVATE-fbEmoji__icon_1f4bf",128192:"-cx-PRIVATE-fbEmoji__icon_1f4c0",128222:"-cx-PRIVATE-fbEmoji__icon_1f4de",128224:"-cx-PRIVATE-fbEmoji__icon_1f4e0",128241:"-cx-PRIVATE-fbEmoji__icon_1f4f1",128242:"-cx-PRIVATE-fbEmoji__icon_1f4f2",128250:"-cx-PRIVATE-fbEmoji__icon_1f4fa",128276:"-cx-PRIVATE-fbEmoji__icon_1f514",128513:"-cx-PRIVATE-fbEmoji__icon_1f601",128514:"-cx-PRIVATE-fbEmoji__icon_1f602",128515:"-cx-PRIVATE-fbEmoji__icon_1f603",128516:"-cx-PRIVATE-fbEmoji__icon_1f604",128518:"-cx-PRIVATE-fbEmoji__icon_1f606",128521:"-cx-PRIVATE-fbEmoji__icon_1f609",128523:"-cx-PRIVATE-fbEmoji__icon_1f60b",128524:"-cx-PRIVATE-fbEmoji__icon_1f60c",128525:"-cx-PRIVATE-fbEmoji__icon_1f60d",128527:"-cx-PRIVATE-fbEmoji__icon_1f60f",128530:"-cx-PRIVATE-fbEmoji__icon_1f612",128531:"-cx-PRIVATE-fbEmoji__icon_1f613",128532:"-cx-PRIVATE-fbEmoji__icon_1f614",128534:"-cx-PRIVATE-fbEmoji__icon_1f616",128536:"-cx-PRIVATE-fbEmoji__icon_1f618",128538:"-cx-PRIVATE-fbEmoji__icon_1f61a",128540:"-cx-PRIVATE-fbEmoji__icon_1f61c",128541:"-cx-PRIVATE-fbEmoji__icon_1f61d",128542:"-cx-PRIVATE-fbEmoji__icon_1f61e",128544:"-cx-PRIVATE-fbEmoji__icon_1f620",128545:"-cx-PRIVATE-fbEmoji__icon_1f621",128546:"-cx-PRIVATE-fbEmoji__icon_1f622",128547:"-cx-PRIVATE-fbEmoji__icon_1f623",128548:"-cx-PRIVATE-fbEmoji__icon_1f624",128549:"-cx-PRIVATE-fbEmoji__icon_1f625",128552:"-cx-PRIVATE-fbEmoji__icon_1f628",128553:"-cx-PRIVATE-fbEmoji__icon_1f629",128554:"-cx-PRIVATE-fbEmoji__icon_1f62a",128555:"-cx-PRIVATE-fbEmoji__icon_1f62b",128557:"-cx-PRIVATE-fbEmoji__icon_1f62d",128560:"-cx-PRIVATE-fbEmoji__icon_1f630",128561:"-cx-PRIVATE-fbEmoji__icon_1f631",128562:"-cx-PRIVATE-fbEmoji__icon_1f632",128563:"-cx-PRIVATE-fbEmoji__icon_1f633",128565:"-cx-PRIVATE-fbEmoji__icon_1f635",128567:"-cx-PRIVATE-fbEmoji__icon_1f637",128568:"-cx-PRIVATE-fbEmoji__icon_1f638",128569:"-cx-PRIVATE-fbEmoji__icon_1f639",128570:"-cx-PRIVATE-fbEmoji__icon_1f63a",128571:"-cx-PRIVATE-fbEmoji__icon_1f63b",128572:"-cx-PRIVATE-fbEmoji__icon_1f63c",128573:"-cx-PRIVATE-fbEmoji__icon_1f63d",128575:"-cx-PRIVATE-fbEmoji__icon_1f63f",128576:"-cx-PRIVATE-fbEmoji__icon_1f640",128587:"-cx-PRIVATE-fbEmoji__icon_1f64b",128588:"-cx-PRIVATE-fbEmoji__icon_1f64c",128589:"-cx-PRIVATE-fbEmoji__icon_1f64d",128591:"-cx-PRIVATE-fbEmoji__icon_1f64f",9757:"-cx-PRIVATE-fbEmoji__icon_261d",9786:"-cx-PRIVATE-fbEmoji__icon_263a",9889:"-cx-PRIVATE-fbEmoji__icon_26a1",9924:"-cx-PRIVATE-fbEmoji__icon_26c4",9994:"-cx-PRIVATE-fbEmoji__icon_270a",9995:"-cx-PRIVATE-fbEmoji__icon_270b",9996:"-cx-PRIVATE-fbEmoji__icon_270c",9728:"-cx-PRIVATE-fbEmoji__icon_2600",9729:"-cx-PRIVATE-fbEmoji__icon_2601",9748:"-cx-PRIVATE-fbEmoji__icon_2614",9749:"-cx-PRIVATE-fbEmoji__icon_2615",10024:"-cx-PRIVATE-fbEmoji__icon_2728",10084:"-cx-PRIVATE-fbEmoji__icon_2764"}};});
__d("Utf16",[],function(a,b,c,d,e,f){var g={decode:function(h){switch(h.length){case 1:return h.charCodeAt(0);case 2:return 65536|((h.charCodeAt(0)-55296)*1024)|(h.charCodeAt(1)-56320);}},encode:function(h){if(h<65536){return String.fromCharCode(h);}else return String.fromCharCode(55296+((h-65536)>>10))+String.fromCharCode(56320+(h%1024));}};e.exports=g;});
__d("Emoji",["cx","DOM","Emote","SupportedEmoji","htmlize","Utf16"],function(a,b,c,d,e,f){var g=b('cx'),h=b('DOM'),i=b('Emote'),j=b('SupportedEmoji'),k=b('htmlize'),l=b('Utf16'),m=e.exports={htmlEmojiAndEmote:function(n,o){return m.htmlEmoji(n,function(p){return i.htmlEmote(p,o);});},htmlEmoji:function(n,o){if(typeof o!='function')o=k;var p=n,q=[];while(true){var r=j.utf16Regex.exec(p);if(!r||!r.length)break;var s=r[0],t=p.indexOf(s);q.push(o(p.substring(0,t)));var u=l.decode(s);if(j.emoji[u]){var v="-cx-PRIVATE-fbEmoji__icon -cx-PRIVATE-fbEmoji__size_16"+' '+j.emoji[u],w=h.create('span',{className:v});q.push(h.create('span',{},w).innerHTML);}else q.push(o(s));p=p.substring(t+s.length);}q.push(o(p));return q.join('');}};});
__d("ErrorDialog",["Dialog"],function(a,b,c,d,e,f){var g=b('Dialog'),h={showAsyncError:function(i){try{return h.show(i.getErrorSummary(),i.getErrorDescription());}catch(j){alert(i);}},show:function(i,j,k,l){return (new g()).setTitle(i).setBody(j).setButtons([g.OK]).setStackable(true).setModal(true).setHandler(k||bagofholding).setButtonsMessage(l||'').show();}};e.exports=h;});
__d("throttle",["debounce"],function(a,b,c,d,e,f){var g=b('debounce');function h(i,j,k){return g(i,j,k,false,true);}e.exports=h;});
__d("FullScreen",["event-extensions","Arbiter","CSS","UserAgent","copyProperties","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('UserAgent'),j=b('copyProperties'),k=b('throttle'),l=j(new g(),{listenForEvent:function(m){var n=k(this.onChange,0,this);Event.listen(m,{webkitfullscreenchange:n,mozfullscreenchange:n,fullscreenchange:n});Event.listen(document,{webkitfullscreenchange:n,mozfullscreenchange:n,fullscreenchange:n});},enableFullScreen:function(m){this.listenForEvent(m);if(m.webkitRequestFullScreen){if(i.chrome()){m.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);}else m.webkitRequestFullScreen();}else if(m.mozRequestFullScreen){m.mozRequestFullScreen();}else if(m.requestFullScreen){m.requestFullScreen();}else return false;return true;},disableFullScreen:function(){if(document.webkitCancelFullScreen){document.webkitCancelFullScreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.cancelFullScreen){document.cancelFullScreen();}else if(document.exitFullScreen){document.exitFullScreen();}else return false;return true;},isFullScreen:function(){return (document.webkitIsFullScreen||document.fullScreen||document.mozFullScreen);},toggleFullScreen:function(m){if(this.isFullScreen()){this.disableFullScreen();return false;}else return this.enableFullScreen(m);return false;},onChange:function(){var m=this.isFullScreen();h.conditionClass(document.body,'fullScreen',m);this.inform('changed');},isSupported:function(){return (document.webkitCancelFullScreen&&i.chrome())||document.mozCancelFullScreen||document.cancelFullScreen||document.exitFullScreen;}});e.exports=l;});
__d("ImageUtils",["UserAgent"],function(a,b,c,d,e,f){var g=b('UserAgent'),h={hasLoaded:function(i){if(i.naturalWidth!==undefined){return i.complete&&i.width!==0;}else if(i.height==20&&i.width==20&&i.complete){return false;}else if(i.complete===undefined&&g.safari()<500){var j=new Image();j.src=i.src;return j.complete;}return i.complete;}};e.exports=h;});
__d("flattenArray",[],function(a,b,c,d,e,f){function g(h){var i=[];while(h.length){var j=h.pop();if(Array.isArray(j)){Array.prototype.push.apply(h,j);}else i.push(j);}return i.reverse();}e.exports=g;});
__d("JSXDOM",["DOM","flattenArray"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('flattenArray'),i=['a','br','button','checkbox','dd','div','dl','dt','form','h1','h2','h3','h4','h5','h6','hr','i','iframe','img','input','label','li','option','p','pre','select','span','strong','table','td','textarea','th','tr','ul'],j={};i.forEach(function(k){var l=function(m){var n;if(m.children){n=Array.isArray(m.children)?h(m.children):h([m.children]);delete m.children;}return g.create(k,m,n);};j[k]=l;});e.exports=j;});
__d("LayerStopBlur",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._layer=i;}g(h.prototype,{_subscriptions:null,_onBlur:null,enable:function(){this._subscriptions=[this._layer.subscribe('show',this._attach.bind(this)),this._layer.subscribe('hide',this._detach.bind(this))];if(this._layer.isShown())this._attach();},disable:function(){this._detach();while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;},_detach:function(){this._onBlur&&this._onBlur.unsubscribe();this._onBlur=null;},_attach:function(){(function(){this._onBlur=this._layer.subscribe('blur',function(){return false;});}).bind(this).defer();}});e.exports=h;});
__d("ScrollableArea",["array-extensions","event-extensions","Animation","ArbiterMixin","CSS","DataStore","DOM","Parent","Run","SimpleDrag","Style","UserAgent","Vector","copyProperties"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('Animation'),h=b('ArbiterMixin'),i=b('CSS'),j=b('DataStore'),k=b('DOM'),l=b('Parent'),m=b('Run'),n=b('SimpleDrag'),o=b('Style'),p=b('UserAgent'),q=b('Vector'),r=b('copyProperties');function s(t,u){if(!t)return;u=u||{};this._elem=t;this._wrap=k.find(t,'div.uiScrollableAreaWrap');this._body=k.find(this._wrap,'div.uiScrollableAreaBody');this._content=k.find(this._body,'div.uiScrollableAreaContent');this._track=k.find(t,'div.uiScrollableAreaTrack');this._gripper=k.find(this._track,'div.uiScrollableAreaGripper');this._options=u;this.adjustGripper.bind(this).defer();this._listeners=[Event.listen(this._wrap,'scroll',this._handleScroll.bind(this))];if(u.fade!==false)this._listeners.push(Event.listen(t,'mouseenter',this.showScrollbar.shield(this)),Event.listen(t,'mousemove',this._handleMousemove.bind(this)),Event.listen(t,'mouseout',this.hideScrollbar.shield(this)));if(p.safari()||p.chrome()){this._listeners.push(Event.listen(t,'mousedown',function(){var v=Event.listen(window,'mouseup',function(){if(t.scrollLeft)t.scrollLeft=0;v.remove();});}));}else if(p.firefox())this._wrap.addEventListener('DOMMouseScroll',function(event){event.axis===event.HORIZONTAL_AXIS&&event.preventDefault();},false);this.initDrag();j.set(this._elem,'ScrollableArea',this);if(!u.persistent)m.onLeave(this.destroy.bind(this));}r(s,{renderDOM:function(){var t=k.create('div',{className:'uiScrollableAreaContent'}),u=k.create('div',{className:'uiScrollableAreaBody'},t),v=k.create('div',{className:'uiScrollableAreaWrap'},u),w=k.create('div',{className:'uiScrollableArea native'},v);return {root:w,wrap:v,body:u,content:t};},fromNative:function(t,u){if(!i.hasClass(t,'uiScrollableArea')||!i.hasClass(t,'native'))return;u=u||{};i.removeClass(t,'native');var v=k.create('div',{className:'uiScrollableAreaTrack'},k.create('div',{className:'uiScrollableAreaGripper'}));if(u.fade!==false){i.addClass(t,'fade');i.addClass(v,'invisible_elem');}else i.addClass(t,'nofade');k.appendContent(t,v);var w=new s(t,u);w.resize();return w;},getInstance:function(t){var u=l.byClass(t,'uiScrollableArea');return u?j.get(u,'ScrollableArea'):null;},poke:function(t){var u=s.getInstance(t);u&&u.poke();}});r(s.prototype,h,{initDrag:function(){var t=new n(this._gripper);t.subscribe('start',function(u,event){if(!((event.which&&event.which===1)||(event.button&&event.button===1)))return;var v=q.getEventPosition(event).y,w=this._gripper.offsetTop,x=t.subscribe('update',function(z,event){var aa=q.getEventPosition(event).y-v,ba=this._elem.clientHeight,ca=this._content.offsetHeight,da=this._track.offsetHeight,ea=ba/ca*da,fa=ca-this._wrap.offsetHeight,ga=w+aa,ha=da-ea;ga=Math.max(Math.min(ga,ha),0);var ia=ga/ha*fa;this._wrap.scrollTop=ia;}.bind(this)),y=t.subscribe('end',function(){t.unsubscribe(x);t.unsubscribe(y);});}.bind(this));},adjustGripper:function(){var t=this._elem.clientHeight,u=this._content.offsetHeight,v=this._track.offsetHeight,w=t/u*v;if(w<v){o.set(this._gripper,'height',w+'px');var x=this._wrap.scrollTop/u*v;o.set(this._gripper,'top',x+'px');i.show(this._gripper);}else i.hide(this._gripper);this._checkContentBoundaries();return this;},_checkContentBoundaries:function(){i.conditionClass(this._elem,'contentBefore',this._wrap.scrollTop>0);i.conditionClass(this._elem,'contentAfter',!this.isScrolledToBottom());},destroy:function(){this._listeners.forEach(function(t){t.remove();});this._listeners.length=0;},_handleMousemove:function(event){var t=q.getElementPosition(this._track).x,u=q.getElementDimensions(this._track).x;if(Math.abs(t+u/2-q.getEventPosition(event).x)<25){this.showScrollbar(false);}else this.hideScrollbar();},_handleScroll:function(event){this.adjustGripper();if(this._options.fade!==false)this.showScrollbar();this.inform('scroll');},hideScrollbar:function(t){if(!this._scrollbarVisible)return this;this._scrollbarVisible=false;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}if(t){o.set(this._track,'opacity',0);i.addClass.curry(this._track,'invisible_elem');}else this._hideTimeout=function(){if(this._hideAnimation){this._hideAnimation.stop();this._hideAnimation=null;}this._hideAnimation=(new g(this._track)).from('opacity',1).to('opacity',0).duration(250).ondone(i.addClass.curry(this._track,'invisible_elem')).go();}.bind(this).defer(750);return this;},resize:function(){var t=q.getElementDimensions(this._elem).x;if(!this._options.fade)t-=10;t=Math.max(0,t);o.set(this._body,'width',t+'px');return this;},showScrollbar:function(t){this.adjustGripper();if(this._scrollbarVisible)return this;this._scrollbarVisible=true;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}if(this._hideAnimation){this._hideAnimation.stop();this._hideAnimation=null;}o.set(this._track,'opacity',1);i.removeClass(this._track,'invisible_elem');if(t!==false)this.hideScrollbar();return this;},isScrolledToBottom:function(){return this._wrap.scrollTop>=this._wrap.scrollHeight-this._wrap.clientHeight;},scrollToBottom:function(t){this.setScrollTop(this._wrap.scrollHeight,t);},scrollToTop:function(t){this.setScrollTop(0,t);},scrollIntoView:function(t,u){var v=this._wrap.clientHeight,w=t.offsetHeight,x=this._wrap.scrollTop,y=x+v,z=t.offsetTop,aa=z+w;if(z<x||v<w){this.setScrollTop(z,u);}else if(aa>y)this.setScrollTop(x+(aa-y),u);},poke:function(){var t=this._wrap.scrollTop;this._wrap.scrollTop+=1;this._wrap.scrollTop-=1;this._wrap.scrollTop=t;return this.showScrollbar(false);},getScrollTop:function(){return this._wrap.scrollTop;},getScrollHeight:function(){return this._wrap.scrollHeight;},setScrollTop:function(t,u){if(u!==false){if(this._scrollTopAnimation)this._scrollTopAnimation.stop();this._scrollTopAnimation=(new g(this._wrap)).to('scrollTop',t).ease(g.ease.end).go();}else this._wrap.scrollTop=t;}});e.exports=s;});
__d("ScrollableTypeaheadBehavior",["DOM","CSS","Style","Parent","cx","ScrollableArea","copyProperties"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('CSS'),i=b('Style'),j=b('Parent'),k=b('cx'),l=b('ScrollableArea'),m=b('copyProperties');function n(o){this._typeahead=o;}m(n.prototype,{_subscriptions:null,_scrollableElems:null,_scrollableArea:null,_showScrollbar:null,enable:function(){this._scrollableElems=(l.renderDOM());h.addClass(this._scrollableElems.root,"-cx-PRIVATE-scrollableTypeahead__ScrollableTypeaheadArea");g.appendContent(this._typeahead.getView().element,this._scrollableElems.root);this._typeahead.getView().content=this._scrollableElems.content;this._scrollableArea=(l.fromNative(this._scrollableElems.root,{fade:false}));this._subscriptions=[this._typeahead.getView().subscribe('reset',this._reset.bind(this)),this._typeahead.getView().subscribe('render',this._render.bind(this)),this._typeahead.getView().subscribe('beforeRender',this._beforeRender.bind(this)),this._typeahead.getView().subscribe('next',this._scrollHelper.bind(this)),this._typeahead.getView().subscribe('prev',this._scrollHelper.bind(this))];i.set(this._scrollableElems.wrap,'height','0px');h.removeClass(this._scrollableElems.root,"-cx-PRIVATE-scrollableTypeahead__hasResults");},disable:function(){while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;},_reset:function(){i.set(this._scrollableElems.wrap,'height','0px');h.removeClass(this._scrollableElems.root,"-cx-PRIVATE-scrollableTypeahead__hasResults");this._scrollableArea.scrollToTop();},_render:function(){this._scrollableArea.poke();this._showScrollbar?this._scrollableArea.showScrollbar(false):this._scrollableArea.hideScrollbar(true);h.addClass(this._scrollableElems.root,"-cx-PRIVATE-scrollableTypeahead__hasResults");},_beforeRender:function(o,p){var q=5;if(this._typeahead.getView().maxResults<10)q=3;i.set(this._scrollableElems.body,'width',this._scrollableElems.wrap.offsetWidth+'px');if(p.results.length<q){i.set(this._scrollableElems.wrap,'height',(38*p.results.length+4)+'px');this._showScrollbar=false;}else{this._scrollableArea.showScrollbar(false);i.set(this._scrollableElems.wrap,'height',(38*q+4)+'px');this._showScrollbar=true;}},_scrollHelper:function(o,p){if(!j.byClass(p,'uiScrollableArea'))return;this._typeahead.getView().ignoreMouseover=true;var q=j.byClass(p,'uiScrollableAreaWrap'),r=p.offsetTop-q.offsetTop;if(r<q.scrollTop){q.scrollTop=r;return;}var s=r+p.offsetHeight;if(s>q.scrollTop+q.offsetHeight)q.scrollTop=s-q.offsetHeight;}});e.exports=n;});
__d("legacy:LegacyScrollableTypeaheadBehavior",["ScrollableTypeaheadBehavior"],function(a,b,c,d){var e=b('ScrollableTypeaheadBehavior');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.scrollArea=function(f){f.enableBehavior(e);};},3);
__d("MultiBootstrapDataSource",["Class","DataSource"],function(a,b,c,d,e,f){var g=b('Class'),h=b('DataSource');function i(j){this._bootstrapEndpoints=j.bootstrapEndpoints;this.parent.construct(this,j);}g.extend(i,h);i.prototype.bootstrapWithoutToken=function(){for(var j=0;j<this._bootstrapEndpoints.length;j++)this.fetch(this._bootstrapEndpoints[j].endpoint,this._bootstrapEndpoints[j].data||{},{bootstrap:true});};e.exports=i;});
__d("OnVisible",["event-extensions","Arbiter","DOM","Run","Vector","copyProperties","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('DOM'),i=b('Run'),j=b('Vector'),k=b('copyProperties'),l=b('throttle');function m(n,o,p,q){this.element=n;this.handler=o;this.strict=p;this.buffer=q||300;this.scrollHandler=null;this.reset();i.onLeave(this.remove.bind(this));}k(m.prototype,{reset:function(){if(this.scrollListener)return;this.removed=false;this.scrollHandler=l(function(n){var o=j.getElementPosition(this.element);if(!o||this.removed){this.remove();return;}this.targetY=o.y;var p=j.getScrollPosition().y,q=j.getViewportDimensions().y,r=p+q+this.buffer;if(r>this.targetY){var s=!this.strict||(p-this.buffer<(this.targetY+j.getElementDimensions(this.element).y));if(s){this.remove();this.handler(!n);}}return true;},100,this);(function(){this.scrollListener=Event.listen(window,'scroll',this.scrollHandler);this.resizeListener=Event.listen(window,'resize',this.scrollHandler);this.domScrollListener=g.subscribe('dom-scroll',this.scrollHandler);this.scrollHandler.defer();}).bind(this).defer();},remove:function(){this.removed=true;if(this.scrollListener){this.scrollListener.remove();this.resizeListener.remove();this.domScrollListener.unsubscribe();this.scrollListener=this.resizeListener=this.domScrollListener=null;}},setBuffer:function(n){this.buffer=n;this.scrollHandler&&this.scrollHandler.defer();}});e.exports=m;});
__d("Poller",["AsyncRequest","Cookie","copyProperties","Env"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Cookie'),i=b('copyProperties'),j=b('Env');function k(l,m,n){this._clearOnQuicklingEvent=!n;this._requestCallback=m;this.setTimePeriod(l);}k.MIN_TIME_PERIOD=2000;i(k.prototype,{stop:function(){clearTimeout(this._token);this._token=null;this._cancelRequest();},scheduleRequest:function(){this.stop();if(this._timePeriod)this._token=this._makeRequest.bind(this).defer(this._timePeriod,this._clearOnQuicklingEvent);},requestNow:function(){this.stop();this._makeRequest();},_timePeriod:null,setTimePeriod:function(l){l=l||null;if(l&&(isNaN(l)||l<k.MIN_TIME_PERIOD))return;if(l&&this._timePeriod==null)this._token=this._makeRequest.bind(this).defer(l,this._clearOnQuicklingEvent);this._timePeriod=l;},_makeRequest:function(){this._cancelRequest();if(!this._isLoadUser())return;var l=new g(),m=true;l.setInitialHandler(function(){return m;});this._cancelRequest=function(){m=false;};l.setFinallyHandler(this.scheduleRequest.bind(this));l.setInitialHandler=bagofholding;l.setFinallyHandler=bagofholding;this._requestCallback(l);if(m)l.send();},_isLoadUser:function(){return j.user==h.get('c_user');},_cancelRequest:bagofholding,getTimePeriod:function(){return this._timePeriod;}});e.exports=k;});
__d("Popover",["event-extensions","Arbiter","ArbiterMixin","Class","ContextualLayer","ContextualLayerHideOnScroll","CSS","DataStore","DOM","Input","KeyStatus","LayerHideOnEscape","Toggler","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Class'),j=b('ContextualLayer'),k=b('ContextualLayerHideOnScroll'),l=b('CSS'),m=b('DataStore'),n=b('DOM'),o=b('Input'),p=b('KeyStatus'),q=b('LayerHideOnEscape'),r=b('Toggler'),s=b('copyProperties');r.subscribe(['show','hide'],function(u,v){var w=m.get(v.getActive(),'Popover');if(w)if(u==='show'){w.showLayer();}else w.hideLayer();});function t(u,v,w,x){this._root=u;this._triggerElem=v;this._behaviors=w;this._config=x;if(!(v.nodeName==='A'&&v.rel==='toggle'))Event.listen(v,'click',function(){r.bootstrap(v);});m.set(u,'Popover',this);}s(t.prototype,h,{_layer:null,_closeListener:null,ensureInit:function(){if(!this._layer)this._init();},showLayer:function(){this.ensureInit();this._layer.show();r.show(this._root);l.addClass(this._root,'selected');this.inform('show');this._triggerElem.setAttribute('aria-expanded','true');},hideLayer:function(){this._layer.hide();this._triggerElem.setAttribute('aria-expanded','false');},isShown:function(){return this._layer.isShown();},setLayerContent:function(u){this.ensureInit();this._layer.setContent(u);},_init:function(){var u=new j({context:this._triggerElem,position:'below'},n.create('div'));u.enableBehaviors([k,q]);r.createInstance(u.getRoot()).setSticky(false);u.subscribe('hide',this._onLayerHide.bind(this));this._behaviors&&u.enableBehaviors(this._behaviors);this._layer=u;if(this._config.alignh)this._layer.setAlignment(this._config.alignh);if(this._config.layer_content)this._layer.setContent(this._config.layer_content);this.inform('init',null,g.BEHAVIOR_PERSISTENT);},_onLayerHide:function(){r.hide(this._root);l.removeClass(this._root,'selected');this.inform('hide');if(p.isKeyDown())o.focus(this._triggerElem);}});e.exports=t;});
__d("PopoverMenuInterface",["Arbiter","ArbiterMixin","Class","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Class'),j=b('copyProperties');function k(){}j(k.prototype,h,{getRoot:bagofholding,onShow:bagofholding,onHide:bagofholding,focusAnItem:bagof(false),blur:bagofholding,handleKeydown:bagof(false),done:function(){this.inform('done');}});e.exports=k;});
__d("PopoverAsyncMenuLoading",["Class","copyProperties","DOM","PopoverMenuInterface"],function(a,b,c,d,e,f){var g=b('Class'),h=b('copyProperties'),i=b('DOM'),j=b('PopoverMenuInterface');function k(l){this.parent.construct(this);this._className=l||'';}g.extend(k,j);h(k.prototype,{_root:null,getRoot:function(){if(!this._root)this._root=i.create('div',{className:this._className},i.create('div',{className:'uiMenuXBorder'},i.create('div',{className:'uiMenuX uiMenuXLoading'},i.create('span',{className:'spinner'}))));return this._root;}});e.exports=k;});
__d("PopoverMenu",["event-extensions","Arbiter","ArbiterMixin","ARIA","BehaviorsMixin","Class","Input","Keys","KeyStatus","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('ARIA'),j=b('BehaviorsMixin'),k=b('Class'),l=b('Input'),m=b('Keys'),n=b('KeyStatus'),o=b('copyProperties');function p(q,r,s,t){this._popover=q;this._triggerElem=r;this._initialMenu=s;q.subscribe('init',this._onLayerInit.bind(this));q.subscribe('show',this._onPopoverShow.bind(this));q.subscribe('hide',this._onPopoverHide.bind(this));t&&this.enableBehaviors(t);}o(p.prototype,h,j);o(p.prototype,{_keydownListener:null,_popoverShown:false,setMenu:function(q){this._menu=q;var r=q.getRoot();this._popover.setLayerContent(r);q.subscribe('done',this._onMenuDone.bind(this));if(this._popoverShown)this._menu.onShow();i.owns(this._triggerElem,r);this.inform('setMenu',null,g.BEHAVIOR_PERSISTENT);},getPopover:function(){return this._popover;},getTriggerElem:function(){return this._triggerElem;},getMenu:function(){return this._menu;},_onLayerInit:function(){this.setMenu(this._initialMenu);},_onPopoverShow:function(){if(this._menu){this._menu.onShow();if(n.isKeyDown())this._menu.focusAnItem();this._keydownListener=Event.listen(document.documentElement,'keydown',this._handleKeydown.bind(this));}this._popoverShown=true;},_onPopoverHide:function(){if(this._menu)this._menu.onHide();if(this._keydownListener){this._keydownListener.remove();this._keydownListener=null;}this._popoverShown=false;},_handleKeydown:function(q){if(q.getModifiers().any)return;var r=Event.getKeyCode(q);switch(r){case m.RETURN:return;case m.UP:case m.DOWN:this._menu.handleKeydown(r);break;default:if(this._menu.handleKeydown(r)===false){this._menu.blur();this._menu.handleKeydown(r);}break;}q.prevent();},_onMenuDone:function(q){this._popover.hideLayer.bind(this._popover).defer();if(n.isKeyDown())l.focus(this._triggerElem);}});e.exports=p;});
__d("PopoverAsyncMenu",["event-extensions","AsyncRequest","Class","CSS","DOM","PopoverAsyncMenuLoading","PopoverMenu","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h=b('Class'),i=b('CSS'),j=b('DOM'),k=b('PopoverAsyncMenuLoading'),l=b('PopoverMenu'),m=b('copyProperties'),n={},o=0;function p(q,r,s,t,u){this._endpoint=t;this._loadingMenu=s;this._instanceId=o++;n[this._instanceId]=this;this._mouseoverListener=Event.listen(r,'mouseover',this._fetchMenu.bind(this));this.parent.construct(this,q,r,null,u);}p.setMenu=function(q,r){n[q].setMenu(r);};h.extend(p,l);m(p.prototype,{_fetched:false,_mouseoverListener:null,_onLayerInit:function(){if(!this._menu)this.setMenu(this._loadingMenu);this._fetchMenu();},_fetchMenu:function(){if(this._fetched)return;new g().setURI(this._endpoint).setData({pmid:this._instanceId}).send();this._fetched=true;if(this._mouseoverListener){this._mouseoverListener.remove();this._mouseoverListener=null;}}});e.exports=p;});
__d("PopoverMenuOverlappingBorder",["function-extensions","CSS","DOM","Style","copyProperties"],function(a,b,c,d,e,f){b('function-extensions');var g=b('CSS'),h=b('DOM'),i=b('Style'),j=b('copyProperties');function k(l){this._popoverMenu=l;this._popover=l.getPopover();this._triggerElem=l.getTriggerElem();}j(k.prototype,{_shortBorder:null,_setMenuSubscription:null,_showSubscription:null,_menuSubscription:null,enable:function(){this._setMenuSubscription=this._popoverMenu.subscribe('setMenu',this._onSetMenu.bind(this));},disable:function(){this._popoverMenu.unsubscribe(this._setMenuSubscription);this._setMenuSubscription=null;this._removeBorderSubscriptions();this._removeShortBorder();},_onSetMenu:function(){this._removeBorderSubscriptions();this._menu=this._popoverMenu.getMenu();this._renderShortBorder(this._menu.getRoot());this._showSubscription=this._popover.subscribe('show',this._updateBorder.bind(this));this._menuSubscription=this._menu.subscribe(['change','resize'],Function.prototype.defer.shield(this._updateBorder.bind(this)));this._updateBorder();},_updateBorder:function(){var l=this._menu.getRoot(),m=this._triggerElem.offsetWidth;i.set(l,'min-width',m+'px');var n=Math.max(l.offsetWidth-m,0);i.set(this._shortBorder,'width',n+'px');},_renderShortBorder:function(l){this._shortBorder=h.create('div',{className:'uiMenuXShortBorder'});h.appendContent(l,this._shortBorder);g.addClass(l,'uiMenuXWithShortBorder');},_removeShortBorder:function(){if(this._shortBorder){h.remove(this._shortBorder);this._shortBorder=null;g.removeClass(this._popoverMenu.getMenu().getRoot(),'uiMenuXShortBorder');}},_removeBorderSubscriptions:function(){if(this._showSubscription){this._popover.unsubscribe(this._showSubscription);this._showSubscription=null;}if(this._menuSubscription){this._menu.unsubscribe(this._menuSubscription);this._menuSubscription=null;}}});e.exports=k;});
__d("PrivacyModel",["PrivacyConst","copyProperties"],function(a,b,c,d,e,f){var g=b('PrivacyConst'),h=b('copyProperties');function i(){this.value=g.BaseValue.ALL_FRIENDS;this.friends=g.FriendsValue.NO_FRIENDS;this.networks=[];this.objects=[];this.lists=[];this.lists_x=[];this.list_anon=0;this.ids_anon=[];this.list_x_anon=0;this.ids_x_anon=[];this.tdata={};return this;}h(i.prototype,{init:function(j,k,l,m,n,o,p,q,r,s,t){this.value=j;this.friends=k;this.networks=l.slice();this.objects=m.slice();this.lists=n.slice();this.lists_x=o.slice();this.list_anon=p;this.ids_anon=q.slice();this.list_x_anon=r;this.ids_x_anon=s.slice();t=t||{};h(this.tdata,t);},clone:function(){var j=new i();j.init(this.value,this.friends,this.networks,this.objects,this.lists,this.lists_x,this.list_anon,this.ids_anon,this.list_x_anon,this.ids_x_anon,this.tdata);return j;},getData:function(){var j=['value','friends','networks','objects','lists','lists_x','list_anon','ids_anon','list_x_anon','ids_x_anon'],k={};for(var l=0;l<j.length;++l){var m=j[l];k[m]=this[m];}return k;}});e.exports=i;});
__d("UIPagelet",["AjaxPipeRequest","AsyncRequest","DOM","HTML","ScriptPathState","URI","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('AjaxPipeRequest'),h=b('AsyncRequest'),i=b('DOM'),j=b('HTML'),k=b('ScriptPathState'),l=b('URI'),m=b('copyProperties'),n=b('ge');function o(p,q,r,s){this._id=p||null;this._element=n(p||i.create('div'));this._src=q||null;this._context_data=r||{};this._data=s||{};this._handler=bagofholding;this._request=null;this._use_ajaxpipe=false;this._is_bundle=true;this._allow_cross_page_transition=false;this._append=false;return this;}o.loadFromEndpoint=function(p,q,r,s){s=s||{};var t='/ajax/pagelet/generic.php/';if(s.intern)t='/intern'+t;var u=(t+p).replace(/\/+/g,'/');if(s.subdomain)u=l(u).setSubdomain(s.subdomain);var v=new o(q,u,r).setUseAjaxPipe(s.usePipe).setPageletCacheMiss(s.pageletCacheMiss).setBundleOption(p.substring(0,8)!='/intern/'&&s.bundle!==false).setAppend(s.append).setJSNonBlock(s.jsNonblock).setForceFinish(s.forceFinish).setAutomatic(s.automatic).setDisplayCallback(s.displayCallback).setConstHeight(s.constHeight).setAllowCrossPageTransition(s.crossPage);s.handler&&v.setHandler(s.handler);v.go();return v;};m(o.prototype,{getElement:function(p){p=p||false;if(p)this._element=n(this._id);return this._element;},setHandler:function(p){this._handler=p;return this;},go:function(p,q){if(arguments.length>=2||typeof p=='string'){this._src=p;this._data=q||{};}else if(arguments.length==1)this._data=p;this.refresh();return this;},setAllowCrossPageTransition:function(p){this._allow_cross_page_transition=p;return this;},setBundleOption:function(p){this._is_bundle=p;return this;},refresh:function(p){var q=function(t){this._request=null;if(p&&this._id)this._element=n(this._id);var u=j(t.getPayload());if(this._append){i.appendContent(this._element,u);}else i.setContent(this._element,u);this._handler();}.bind(this);if(this._use_ajaxpipe){k.setIsUIPageletRequest(true);this._request=new g();this._request.setCanvasId(this._id).setAppend(this._append).setConstHeight(this._constHeight).setJSNonBlock(this._jsNonblock).setForceFinish(this._forceFinish).setAutomatic(this._automatic).setPageletCacheMiss(this._pageletCacheMiss).setDisplayCallback(this._displayCallback);}else{var r=this._displayCallback;this._request=new h().setMethod('GET').setReadOnly(true).setOption('bundle',this._is_bundle).setHandler(function(t){if(r){r(q.curry(t));}else q(t);});}var s={};m(s,this._context_data);m(s,this._data);this._request.setURI(this._src).setAllowCrossPageTransition(this._allow_cross_page_transition).setData({data:JSON.stringify(s)}).send();return this;},cancel:function(){if(this._request)this._request.abort();},setUseAjaxPipe:function(p){this._use_ajaxpipe=!!p;return this;},setPageletCacheMiss:function(p){this._pageletCacheMiss=p;return this;},setAppend:function(p){this._append=!!p;return this;},setJSNonBlock:function(p){this._jsNonblock=!!p;return this;},setForceFinish:function(p){this._forceFinish=!!p;return this;},setAutomatic:function(p){this._automatic=!!p;return this;},setDisplayCallback:function(p){this._displayCallback=p;return this;},setConstHeight:function(p){this._constHeight=!!p;return this;}});e.exports=o;});
__d("ScrollingPager",["Arbiter","copyProperties","CSS","OnVisible","UIPagelet","$","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('copyProperties'),i=b('CSS'),j=b('OnVisible'),k=b('UIPagelet'),l=b('$'),m=b('ge'),n={};function o(p,q,r,s){this.scroll_loader_id=p;this.pagelet_src=q;this.data=r;this.options=s||{};if(this.options.target_id){this.target_id=this.options.target_id;this.options.append=true;}else this.target_id=p;this.handler=null;}h(o,{REGISTERED:'ScrollingPager/registered',getInstance:function(p){return n[p];}});h(o.prototype,{setBuffer:function(p){this.options.buffer=p;this.onvisible&&this.onvisible.setBuffer(p);},getBuffer:function(){return this.options.buffer;},register:function(){this.onvisible=new j(l(this.scroll_loader_id),this.getHandler(),false,this.options.buffer,this.options);n[this.scroll_loader_id]=this;g.inform(o.REGISTERED,{id:this.scroll_loader_id});},getInstance:function(p){return n[p];},getHandler:function(){if(this.handler)return this.handler;function p(q){var r=m(this.scroll_loader_id);if(!r){this.onvisible.remove();return;}i.addClass(r.firstChild,'async_saving');var s=this.options.handler;this.options.handler=function(){g.inform('ScrollingPager/loadingComplete');s&&s.apply(null,arguments);};if(q)this.data.pager_fired_on_init=true;k.loadFromEndpoint(this.pagelet_src,this.target_id,this.data,this.options);}return p.bind(this);},setHandler:function(p){this.handler=p;},removeOnVisible:function(){this.onvisible.remove();}});e.exports=o;});
__d("InputSelection",["DOM","Input"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('Input'),i={get:function(j){if(!document.selection)return {start:j.selectionStart,end:j.selectionEnd};var k=document.selection.createRange();if(k.parentElement()!==j)return {start:0,end:0};var l=j.value.length;if(g.isNodeOfType(j,'input')){return {start:-k.moveStart('character',-l),end:-k.moveEnd('character',-l)};}else{var m=k.duplicate();m.moveToElementText(j);m.setEndPoint('StartToEnd',k);var n=l-m.text.length;m.setEndPoint('StartToStart',k);return {start:l-m.text.length,end:n};}},set:function(j,k,l){if(typeof l=='undefined')l=k;if(document.selection){if(j.tagName=='TEXTAREA'){var m=(j.value.slice(0,k).match(/\r/g)||[]).length,n=(j.value.slice(k,l).match(/\r/g)||[]).length;k-=m;l-=m+n;}var o=j.createTextRange();o.collapse(true);o.moveStart('character',k);o.moveEnd('character',l-k);o.select();}else{j.selectionStart=k;j.selectionEnd=Math.min(l,j.value.length);h.focus(j);}}};e.exports=i;});
__d("ControlledReferer",["event-extensions","URI"],function(a,b,c,d,e,f){b('event-extensions');var g=b('URI'),h={useFacebookReferer:function(i,j,k){var l=false;function m(){if(l)return;l=true;i.contentWindow.document.body.style.margin=0;j();}var n;if(document.domain!=='facebook.com'){n='/intern/common/referer_frame.php';}else if(g().isSecure()){n='https://s-static.ak.facebook.com/common/referer_frame.php';}else n='http://static.ak.facebook.com/common/referer_frame.php';if(k)n+='?fb_source='+k;Event.listen(i,'load',m);i.src=n;},useFacebookRefererHtml:function(i,j,k){h.useFacebookReferer(i,function(){i.contentWindow.document.body.innerHTML=j;},k);}};e.exports=h;});
__d("swfobject",["AsyncRequest","Bootloader","ControlledReferer","copyProperties","CSS","DOM","function-extensions","ge","htmlSpecialChars"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Bootloader'),i=b('ControlledReferer'),j=b('copyProperties'),k=b('CSS'),l=b('DOM');b('function-extensions');var m=b('ge'),n=b('htmlSpecialChars');if(typeof o=="undefined")var o={};if(typeof o.util=="undefined")o.util={};if(typeof o.SWFObjectUtil=="undefined")o.SWFObjectUtil={};o.SWFObject=function(u,v,w,x,y,z,aa,ba,ca,da){if(!document.getElementById)return;this.DETECT_KEY=da?da:'detectflash';this.skipDetect=o.util.getRequestParameter(this.DETECT_KEY);this.params={};this.variables={};this.attributes=[];this.fallback_html='';this.fallback_js_fcn=function(){};if(u)this.setAttribute('swf',u);if(v)this.setAttribute('id',v);if(w)this.setAttribute('width',w);if(x)this.setAttribute('height',x);this.installedVer=o.SWFObjectUtil.getPlayerVersion();if(y){if(!(y instanceof Array))y=[y];var ea;y.forEach(function(ha){ea=new o.PlayerVersion(ha.toString().split('.'));if(ea.major==this.installedVer.major){this.setAttribute('version',ea);return;}else if(!this.getAttribute('version')||ea.major<this.getAttribute('version').major)this.setAttribute('version',ea);}.bind(this));}if(!window.opera&&document.all&&this.installedVer.major>7)if(!o.unloadSet){o.SWFObjectUtil.prepUnload=function(){var ha=function(){},ia=function(){};window.attachEvent("onunload",o.SWFObjectUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",o.SWFObjectUtil.prepUnload);o.unloadSet=true;}if(z)this.addParam('bgcolor',z);var fa=aa?aa:'high';this.addParam('quality',fa);this.setAttribute('useExpressInstall',false);this.setAttribute('doExpressInstall',false);var ga=(ba)?ba:window.location;this.setAttribute('xiRedirectUrl',ga);this.setAttribute('redirectUrl','');if(ca)this.setAttribute('redirectUrl',ca);this.setAttribute('useIframe',false);};o.SWFObject.ieWorkaroundApplied=false;o.SWFObject.ensureIEWorkaroundAttached=function(){if(!o.SWFObject.ieWorkaroundApplied&&document.attachEvent){o.SWFObject.ieWorkaroundApplied=true;document.attachEvent('onpropertychange',o.SWFObject.onDocumentPropertyChange);}};o.SWFObject.onDocumentPropertyChange=function(event){if(event.propertyName=="title"){var u=document.title;if(u!=null&&u.indexOf('#!')!=-1){u=u.substring(0,u.indexOf('#!'));document.title=u;}}};j(o.SWFObject.prototype,{useExpressInstall:function(u){this.xiSWFPath=!u?"/swf/expressinstall.swf":u;this.setAttribute('useExpressInstall',true);},setAttribute:function(u,v){this.attributes[u]=v;},getAttribute:function(u){return this.attributes[u]||"";},addParam:function(u,v){this.params[u]=v;},getParams:function(){return this.params;},addVariable:function(u,v){this.variables[u]=v;},getVariable:function(u){return this.variables[u]||"";},getVariables:function(){return this.variables;},getVariablePairs:function(){var u=[],v,w=this.getVariables();for(v in w)u[u.length]=v+"="+w[v];return u.join('&');},getSWFHTML:function(){var u,v,w;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute('swf',this.xiSWFPath);}v={type:'application/x-shockwave-flash',src:this.getAttribute('swf'),width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;',id:this.getAttribute('id'),name:this.getAttribute('id')};var x=this.getParams();for(var y in x)v[y]=x[y];w=this.getVariablePairs();if(w)v.flashvars=w;u=t('embed',v,null);}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute('swf',this.xiSWFPath);}v={id:this.getAttribute('id'),classid:'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000',width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;'};var z=t('param',{name:'movie',value:this.getAttribute('swf')},null),x=this.getParams();for(var y in x)z+=t('param',{name:y,value:x[y]},null);w=this.getVariablePairs();if(w)z+=t('param',{name:'flashvars',value:w},null);u=t('object',v,z);}return u;},write:function(u){if(this.getAttribute('useExpressInstall')){var v=new o.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(v)&&!this.installedVer.versionIsValid(this.getAttribute('version'))){this.setAttribute('doExpressInstall',true);this.addVariable("MMredirectURL",escape(this.getAttribute('xiRedirectUrl')));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}var w=(typeof u=='string')?document.getElementById(u):u;if(!w)return false;k.addClass(w,'swfObject');w.setAttribute('data-swfid',this.getAttribute('id'));if(this.skipDetect||this.getAttribute('doExpressInstall')||this.installedVer.versionIsValid(this.getAttribute('version'))){if(!this.getAttribute('useIframe')){o.SWFObject.ensureIEWorkaroundAttached();w.innerHTML=this.getSWFHTML();}else this._createIframe(w);return true;}else{if(this.getAttribute('redirectUrl')!="")document.location.replace(this.getAttribute('redirectUrl'));var x=this.getAttribute('version').major+'.'+this.getAttribute('version').minor+'.'+this.getAttribute('version').release+'.'+this.getAttribute('version').build,y=this.installedVer.major+'.'+this.installedVer.minor+'.'+this.installedVer.release+'.'+this.installedVer.build;this.fallback_js_fcn(y,x);w.innerHTML=this.fallback_html;}return false;},_createIframe:function(u){var v=l.create('iframe',{width:this.getAttribute('width'),height:this.getAttribute('height'),frameBorder:0});l.empty(u);u.appendChild(v);i.useFacebookRefererHtml.bind(null,v,this.getSWFHTML(),this.getAttribute('iframeSource')).defer();}});o.SWFObjectUtil.getPlayerVersion=function(){var u=new o.PlayerVersion([0,0,0,0]),v;if(navigator.plugins&&navigator.mimeTypes.length){for(var w=0;w<navigator.plugins.length;w++)try{var y=navigator.plugins[w];if(y.name=='Shockwave Flash'){v=new o.PlayerVersion(y.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+(r|d)|\s+b[0-9]+)/,".").split("."));if(typeof u=='undefined'||v.major>u.major||(v.major==u.major&&(v.minor>u.minor||(v.minor==u.minor&&(v.release>u.release||(v.release==u.release&&v.build>u.build))))))u=v;}}catch(x){}}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var z=1,aa=3;while(z)try{aa++;z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+aa);u=new o.PlayerVersion([aa,0,0]);}catch(ba){z=null;}}else{try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(ca){try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");u=new o.PlayerVersion([6,0,21]);z.AllowScriptAccess="always";}catch(da){if(u.major==6)return u;}try{z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(ea){}}if(z!=null)u=new o.PlayerVersion(z.GetVariable("$version").split(" ")[1].split(","));}return u;};o.PlayerVersion=function(u){this.major=u[0]!=null?parseInt(u[0],10):0;this.minor=u[1]!=null?parseInt(u[1],10):0;this.release=u[2]!=null?parseInt(u[2],10):0;this.build=u[3]!=null?parseInt(u[3],10):0;};o.PlayerVersion.prototype.versionIsValid=function(u){if(this.major<u.major)return false;if(this.major>u.major)return true;if(this.minor<u.minor)return false;if(this.minor>u.minor)return true;if(this.release<u.release)return false;if(this.release>u.release)return true;if(this.build<u.build)return false;return true;};o.util={getRequestParameter:function(u){var v=document.location.search||document.location.hash;if(u==null)return v;if(v){var w=v.substring(1).split("&");for(var x=0;x<w.length;x++)if(w[x].substring(0,w[x].indexOf("="))==u)return w[x].substring((w[x].indexOf("=")+1));}return "";}};o.SWFObjectUtil.cleanupSWFs=function(){var u=document.getElementsByTagName("OBJECT");for(var v=u.length-1;v>=0;v--){u[v].style.display='none';for(var w in u[v])if(typeof u[v][w]=='function')u[v][w]=function(){};}};if(!document.getElementById&&document.all)document.getElementById=function(u){return document.all[u];};var p=o.util.getRequestParameter,q=o.SWFObject,r=o.SWFObject;o.spawn_flash_update_dialog=function(){new g().setURI('/ajax/flash_update_dialog.php').setMethod('GET').setReadOnly(true).send();};function s(u,v){var w=m(u),x=o.SWFObjectUtil.getPlayerVersion(),y;v.forEach(function(ba){ba=new o.PlayerVersion(ba.toString().split('.'));if(ba.major==x.major){y=ba;return;}else if(typeof y=='undefined'||ba.major<y.major)y=ba;}.bind(this));if(w&&x.major>0){var z=x.major+'.'+x.minor+'.'+x.release+'.'+x.build,aa=y.major+'.'+y.minor+'.'+y.release+'.'+y.build;l.setContent(w,l.tx._("Flash {required-version} is required to view this content. Your current version is {current-version}. Please download the latest Flash Player.",{'required-version':aa,'current-version':z}));}}o.showFlashErrorDialog=function(u,v){h.loadModules(['ErrorDialog'],function(w){w.show(u,v);});};function t(u,v,w){var x=/^[A-Za-z0-9\-]+$/;if(!u.match(x))throw new Error('Invalid tag '+u);var y='<'+u;for(var z in v){if(!z.match(x))throw new Error('Invalid attr '+z);y+=' '+z+'="'+n(v[z])+'"';}if(w===null){return y+'/>';}else return y+'>'+w+'</'+u+'>';}e.exports=a.deconcept||o;});
__d("swfobject2",[],function(a,b,c,d,e,f){var g=function(){var h="undefined",i="object",j="Shockwave Flash",k="ShockwaveFlash.ShockwaveFlash",l="application/x-shockwave-flash",m="SWFObjectExprInst",n="onreadystatechange",o=window,p=document,q=navigator,r=false,s=[ka],t=[],u=[],v=[],w,x,y,z,aa=false,ba=false,ca,da,ea=true,fa=function(){var eb=typeof p.getElementById!=h&&typeof p.getElementsByTagName!=h&&typeof p.createElement!=h,fb=q.userAgent.toLowerCase(),gb=q.platform.toLowerCase(),hb=gb?/win/.test(gb):/win/.test(fb),ib=gb?/mac/.test(gb):/mac/.test(fb),jb=/webkit/.test(fb)?parseFloat(fb.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,kb=!+"\v1",lb=[0,0,0],mb=null;if(typeof q.plugins!=h&&typeof q.plugins[j]==i){mb=q.plugins[j].description;if(mb&&!(typeof q.mimeTypes!=h&&q.mimeTypes[l]&&!q.mimeTypes[l].enabledPlugin)){r=true;kb=false;mb=mb.replace(/^.*\s+(\S+\s+\S+$)/,"$1");lb[0]=parseInt(mb.replace(/^(.*)\..*$/,"$1"),10);lb[1]=parseInt(mb.replace(/^.*\.(.*)\s.*$/,"$1"),10);lb[2]=/[a-zA-Z]/.test(mb)?parseInt(mb.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else if(typeof o.ActiveXObject!=h)try{var ob=new ActiveXObject(k);if(ob){mb=ob.GetVariable("$version");if(mb){kb=true;mb=mb.split(" ")[1].split(",");lb=[parseInt(mb[0],10),parseInt(mb[1],10),parseInt(mb[2],10)];}}}catch(nb){}return {w3:eb,pv:lb,wk:jb,ie:kb,win:hb,mac:ib};}(),ga=function(){if(!fa.w3)return;if((typeof p.readyState!=h&&p.readyState=="complete")||(typeof p.readyState==h&&(p.getElementsByTagName("body")[0]||p.body)))ha();if(!aa){if(typeof p.addEventListener!=h)p.addEventListener("DOMContentLoaded",ha,false);if(fa.ie&&fa.win){p.attachEvent(n,function(){if(p.readyState=="complete"){p.detachEvent(n,arguments.callee);ha();}});if(o==top)(function(){if(aa)return;try{p.documentElement.doScroll("left");}catch(eb){setTimeout(arguments.callee,0);return;}ha();})();}if(fa.wk)(function(){if(aa)return;if(!/loaded|complete/.test(p.readyState)){setTimeout(arguments.callee,0);return;}ha();})();ja(ha);}}();function ha(){if(aa)return;try{var fb=p.getElementsByTagName("body")[0].appendChild(xa("span"));fb.parentNode.removeChild(fb);}catch(eb){return;}aa=true;var gb=s.length;for(var hb=0;hb<gb;hb++)s[hb]();}function ia(eb){if(aa){eb();}else s[s.length]=eb;}function ja(eb){if(typeof o.addEventListener!=h){o.addEventListener("load",eb,false);}else if(typeof p.addEventListener!=h){p.addEventListener("load",eb,false);}else if(typeof o.attachEvent!=h){ya(o,"onload",eb);}else if(typeof o.onload=="function"){var fb=o.onload;o.onload=function(){fb();eb();};}else o.onload=eb;}function ka(){if(r){la();}else ma();}function la(){var eb=p.getElementsByTagName("body")[0],fb=xa(i);fb.setAttribute("type",l);var gb=eb.appendChild(fb);if(gb){var hb=0;(function(){if(typeof gb.GetVariable!=h){var ib=gb.GetVariable("$version");if(ib){ib=ib.split(" ")[1].split(",");fa.pv=[parseInt(ib[0],10),parseInt(ib[1],10),parseInt(ib[2],10)];}}else if(hb<10){hb++;setTimeout(arguments.callee,10);return;}eb.removeChild(fb);gb=null;ma();})();}else ma();}function ma(){var eb=t.length;if(eb>0)for(var fb=0;fb<eb;fb++){var gb=t[fb].id,hb=t[fb].callbackFn,ib={success:false,id:gb};if(fa.pv[0]>0){var jb=wa(gb);if(jb)if(za(t[fb].swfVersion)&&!(fa.wk&&fa.wk<312)){bb(gb,true);if(hb){ib.success=true;ib.ref=na(gb);hb(ib);}}else if(t[fb].expressInstall&&oa()){var kb={};kb.data=t[fb].expressInstall;kb.width=jb.getAttribute("width")||"0";kb.height=jb.getAttribute("height")||"0";if(jb.getAttribute("class"))kb.styleclass=jb.getAttribute("class");if(jb.getAttribute("align"))kb.align=jb.getAttribute("align");var lb={},mb=jb.getElementsByTagName("param"),nb=mb.length;for(var ob=0;ob<nb;ob++)if(mb[ob].getAttribute("name").toLowerCase()!="movie")lb[mb[ob].getAttribute("name")]=mb[ob].getAttribute("value");pa(kb,lb,gb,hb);}else{qa(jb);if(hb)hb(ib);}}else{bb(gb,true);if(hb){var pb=na(gb);if(pb&&typeof pb.SetVariable!=h){ib.success=true;ib.ref=pb;}hb(ib);}}}}function na(eb){var fb=null,gb=wa(eb);if(gb&&gb.nodeName=="OBJECT")if(typeof gb.SetVariable!=h){fb=gb;}else{var hb=gb.getElementsByTagName(i)[0];if(hb)fb=hb;}return fb;}function oa(){return !ba&&za("6.0.65")&&(fa.win||fa.mac)&&!(fa.wk&&fa.wk<312);}function pa(eb,fb,gb,hb){ba=true;y=hb||null;z={success:false,id:gb};var ib=wa(gb);if(ib){if(ib.nodeName=="OBJECT"){w=ra(ib);x=null;}else{w=ib;x=gb;}eb.id=m;if(typeof eb.width==h||(!/%$/.test(eb.width)&&parseInt(eb.width,10)<310))eb.width="310";if(typeof eb.height==h||(!/%$/.test(eb.height)&&parseInt(eb.height,10)<137))eb.height="137";p.title=p.title.slice(0,47)+" - Flash Player Installation";var jb=fa.ie&&fa.win?"ActiveX":"PlugIn",kb="MMredirectURL="+o.location.toString().replace(/&/g,"%26")+"&MMplayerType="+jb+"&MMdoctitle="+p.title;if(typeof fb.flashvars!=h){fb.flashvars+="&"+kb;}else fb.flashvars=kb;if(fa.ie&&fa.win&&ib.readyState!=4){var lb=xa("div");gb+="SWFObjectNew";lb.setAttribute("id",gb);ib.parentNode.insertBefore(lb,ib);ib.style.display="none";(function(){if(ib.readyState==4){ib.parentNode.removeChild(ib);}else setTimeout(arguments.callee,10);})();}sa(eb,fb,gb);}}function qa(eb){if(fa.ie&&fa.win&&eb.readyState!=4){var fb=xa("div");eb.parentNode.insertBefore(fb,eb);fb.parentNode.replaceChild(ra(eb),fb);eb.style.display="none";(function(){if(eb.readyState==4){eb.parentNode.removeChild(eb);}else setTimeout(arguments.callee,10);})();}else eb.parentNode.replaceChild(ra(eb),eb);}function ra(eb){var fb=xa("div");if(fa.win&&fa.ie){fb.innerHTML=eb.innerHTML;}else{var gb=eb.getElementsByTagName(i)[0];if(gb){var hb=gb.childNodes;if(hb){var ib=hb.length;for(var jb=0;jb<ib;jb++)if(!(hb[jb].nodeType==1&&hb[jb].nodeName=="PARAM")&&!(hb[jb].nodeType==8))fb.appendChild(hb[jb].cloneNode(true));}}}return fb;}function sa(eb,fb,gb){var hb,ib=wa(gb);if(fa.wk&&fa.wk<312)return hb;if(ib){if(typeof eb.id==h)eb.id=gb;if(fa.ie&&fa.win){var jb="";for(var kb in eb)if(eb[kb]!=Object.prototype[kb])if(kb.toLowerCase()=="data"){fb.movie=eb[kb];}else if(kb.toLowerCase()=="styleclass"){jb+=' class="'+eb[kb]+'"';}else if(kb.toLowerCase()!="classid")jb+=' '+kb+'="'+eb[kb]+'"';var lb="";for(var mb in fb)if(fb[mb]!=Object.prototype[mb])lb+='<param name="'+mb+'" value="'+fb[mb]+'" />';ib.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+jb+'>'+lb+'</object>';u[u.length]=eb.id;hb=wa(eb.id);}else{var nb=xa(i);nb.setAttribute("type",l);for(var ob in eb)if(eb[ob]!=Object.prototype[ob])if(ob.toLowerCase()=="styleclass"){nb.setAttribute("class",eb[ob]);}else if(ob.toLowerCase()!="classid")nb.setAttribute(ob,eb[ob]);for(var pb in fb)if(fb[pb]!=Object.prototype[pb]&&pb.toLowerCase()!="movie")ta(nb,pb,fb[pb]);ib.parentNode.replaceChild(nb,ib);hb=nb;}}return hb;}function ta(eb,fb,gb){var hb=xa("param");hb.setAttribute("name",fb);hb.setAttribute("value",gb);eb.appendChild(hb);}function ua(eb){var fb=wa(eb);if(fb&&fb.nodeName=="OBJECT")if(fa.ie&&fa.win){fb.style.display="none";(function(){if(fb.readyState==4){va(eb);}else setTimeout(arguments.callee,10);})();}else fb.parentNode.removeChild(fb);}function va(eb){var fb=wa(eb);if(fb){for(var gb in fb)if(typeof fb[gb]=="function")fb[gb]=null;fb.parentNode.removeChild(fb);}}function wa(eb){var fb=null;try{fb=p.getElementById(eb);}catch(gb){}return fb;}function xa(eb){return p.createElement(eb);}function ya(eb,fb,gb){eb.attachEvent(fb,gb);v[v.length]=[eb,fb,gb];}function za(eb){var fb=fa.pv,gb=eb.split(".");gb[0]=parseInt(gb[0],10);gb[1]=parseInt(gb[1],10)||0;gb[2]=parseInt(gb[2],10)||0;return (fb[0]>gb[0]||(fb[0]==gb[0]&&fb[1]>gb[1])||(fb[0]==gb[0]&&fb[1]==gb[1]&&fb[2]>=gb[2]))?true:false;}function ab(eb,fb,gb,hb){if(fa.ie&&fa.mac)return;var ib=p.getElementsByTagName("head")[0];if(!ib)return;var jb=(gb&&typeof gb=="string")?gb:"screen";if(hb){ca=null;da=null;}if(!ca||da!=jb){var kb=xa("style");kb.setAttribute("type","text/css");kb.setAttribute("media",jb);ca=ib.appendChild(kb);if(fa.ie&&fa.win&&typeof p.styleSheets!=h&&p.styleSheets.length>0)ca=p.styleSheets[p.styleSheets.length-1];da=jb;}if(fa.ie&&fa.win){if(ca&&typeof ca.addRule==i)ca.addRule(eb,fb);}else if(ca&&typeof p.createTextNode!=h)ca.appendChild(p.createTextNode(eb+" {"+fb+"}"));}function bb(eb,fb){if(!ea)return;var gb=fb?"visible":"hidden";if(aa&&wa(eb)){wa(eb).style.visibility=gb;}else ab("#"+eb,"visibility:"+gb);}function cb(eb){var fb=/[\\\"<>\.;]/,gb=fb.exec(eb)!=null;return gb&&typeof encodeURIComponent!=h?encodeURIComponent(eb):eb;}var db=function(){if(fa.ie&&fa.win)window.attachEvent("onunload",function(){var eb=v.length;for(var fb=0;fb<eb;fb++)v[fb][0].detachEvent(v[fb][1],v[fb][2]);var gb=u.length;for(var hb=0;hb<gb;hb++)ua(u[hb]);for(var ib in fa)fa[ib]=null;fa=null;for(var jb in g)g[jb]=null;g=null;});}();return {registerObject:function(eb,fb,gb,hb){if(fa.w3&&eb&&fb){var ib={};ib.id=eb;ib.swfVersion=fb;ib.expressInstall=gb;ib.callbackFn=hb;t[t.length]=ib;bb(eb,false);}else if(hb)hb({success:false,id:eb});},getObjectById:function(eb){if(fa.w3)return na(eb);},embedSWF:function(eb,fb,gb,hb,ib,jb,kb,lb,mb,nb){var ob={success:false,id:fb};if(fa.w3&&!(fa.wk&&fa.wk<312)&&eb&&fb&&gb&&hb&&ib){bb(fb,false);ia(function(){gb+="";hb+="";var pb={};if(mb&&typeof mb===i)for(var qb in mb)pb[qb]=mb[qb];pb.data=eb;pb.width=gb;pb.height=hb;var rb={};if(lb&&typeof lb===i)for(var sb in lb)rb[sb]=lb[sb];if(kb&&typeof kb===i)for(var tb in kb)if(typeof rb.flashvars!=h){rb.flashvars+="&"+tb+"="+kb[tb];}else rb.flashvars=tb+"="+kb[tb];if(za(ib)){var ub=sa(pb,rb,fb);if(pb.id==fb)bb(fb,true);ob.success=true;ob.ref=ub;}else if(jb&&oa()){pb.data=jb;pa(pb,rb,fb,nb);return;}else bb(fb,true);if(nb)nb(ob);});}else if(nb)nb(ob);},switchOffAutoHideShow:function(){ea=false;},ua:fa,getFlashPlayerVersion:function(){return {major:fa.pv[0],minor:fa.pv[1],release:fa.pv[2]};},hasFlashPlayerVersion:za,createSWF:function(eb,fb,gb){if(fa.w3){return sa(eb,fb,gb);}else return undefined;},showExpressInstall:function(eb,fb,gb,hb){if(fa.w3&&oa())pa(eb,fb,gb,hb);},removeSWF:function(eb){if(fa.w3)ua(eb);},createCSS:function(eb,fb,gb,hb){if(fa.w3)ab(eb,fb,gb,hb);},addDomLoadEvent:ia,addLoadEvent:ja,getQueryParamValue:function(eb){var fb=p.location.search||p.location.hash;if(fb){if(/\?/.test(fb))fb=fb.split("?")[1];if(eb==null)return cb(fb);var gb=fb.split("&");for(var hb=0;hb<gb.length;hb++)if(gb[hb].substring(0,gb[hb].indexOf("="))==eb)return cb(gb[hb].substring((gb[hb].indexOf("=")+1)));}return "";},expressInstallCallback:function(){if(ba){var eb=wa(m);if(eb&&w){eb.parentNode.replaceChild(w,eb);if(x){bb(x,true);if(fa.ie&&fa.win)w.style.display="block";}if(y)y(z);}ba=false;}}};}();e.exports=g;});
__d("SoundPlayer",["Arbiter","ChatConfig","Env","swfobject","swfobject2","URI","createArrayFrom"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChatConfig'),i=b('Env'),j=b('swfobject').SWFObject,k=b('swfobject2'),l=b('URI'),m=b('createArrayFrom'),n={},o=null,p=false,q='so_sound_player',r='/swf/SoundPlayerHater.swf',s='10.0.22.87',t=null,u=h.get('sound.useswfobject_2',false),v=h.get('sound.force_flash',false);function w(ea){var fa=l(ea);if(!fa.getDomain())return l(i.static_base).setPath(fa.getPath()).toString();return ea;}function x(ea){if(/\.mp3$/.test(ea))return 'audio/mpeg';if(/\.og[ga]$/.test(ea))return 'audio/ogg';return '';}function y(){if(!t&&!v){var ea=document.createElement('audio');if(!ea||!ea.canPlayType)return null;ea.setAttribute('preload','auto');document.body.appendChild(ea);t=ea;}return t;}function z(){var ea=document[q]||window[q];if(ea)if(!ea.playSound&&ea.length)ea=ea[0];return (ea&&ea.playSound&&ea.loopSound)?ea:null;}function aa(){return p;}function ba(ea,fa,ga){o={path:ea,sync:fa,loop:ga};}function ca(){p=true;if(o){var ea=z();if(o.loop){ea.loopSound(o.path,o.sync);}else ea.playSound(o.path,o.sync);}}var da={init:function(ea){ea=m(ea);var fa;for(var ga=0;ga<ea.length;++ga){fa=ea[ga];if(n[fa])return;}var ha=y();for(ga=0;ha&&ga<ea.length;++ga){fa=ea[ga];if(ha.canPlayType(fa)){n[fa]=true;return;}}n['audio/mpeg']=true;if(z())return;try{g.registerCallback(ca,['sound/player_ready','sound/ready']);var ja=document.createElement('div');ja.id='sound_player_holder';document.body.appendChild(ja);if(u){k.embedSWF(r,ja.id,'1px','1px',s,null,{swf_id:q},{allowscriptaccess:'always',wmode:'transparent'},null,function(la){window[q]=la.ref;g.inform('sound/player_ready');});}else{var ka=new j(r,q,'1px','1px',[s],'#ffffff');ka.addParam('allowscriptaccess','always');ka.addParam('wmode','transparent');ka.addVariable('swf_id',q);ka.fallback_html=' ';ka.write(ja.id);window[q]=ka;g.inform('sound/player_ready');}}catch(ia){}},play:function(ea,fa){ea=m(ea);var ga=y(),ha,ia;for(var ja=0;ga&&ja<ea.length;++ja){ha=ea[ja];ia=x(ha);if(!ga.canPlayType(ia))continue;da.init([ia]);ga.src=w(ha);if(fa){ga.setAttribute('loop','');}else ga.removeAttribute('loop');ga.play();return;}for(ja=0;ja<ea.length;++ja){ha=w(ea[ja]);ia=x(ha);if(ia!='audio/mpeg')continue;da.init([ia]);var ka=z();if(!aa()){ba(ha,true,fa);return;}else if(ka){if(fa){ka.loopSound(ha,true);}else ka.playSound(ha,true);return;}}},stop:function(ea){ea=m(ea);for(var fa=0;fa<ea.length;++fa){var ga=w(ea[fa]),ha=y(),ia=z();if(ha&&ha.src==ga){ha.pause();ha.src=undefined;}else ia&&ia.stopSound(ga);}}};e.exports=da;});
__d("SoundSynchronizer",["event-extensions","hasArrayNature","SoundPlayer","createArrayFrom"],function(a,b,c,d,e,f){b('event-extensions');var g=b('hasArrayNature'),h=b('SoundPlayer'),i=b('createArrayFrom'),j='fb_sounds_playing3';function k(){if(window.localStorage)try{var p=window.localStorage[j];if(p){p=JSON.parse(p);if(g(p))return p;}}catch(o){}return [];}function l(o){if(window.localStorage){var p=k();p.push(o);while(p.length>5)p.shift();try{window.localStorage[j]=JSON.stringify(p);}catch(q){}}}function m(o){return k().some(function(p){return p===o;});}var n={play:function(o,p,q){o=i(o);p=p||(o[0]+Math.floor(Date.now()/1000));if(m(p))return;h.play(o,q);l(p);},isSupported:function(){return !!window.localStorage;}};e.exports=n;});
__d("SoundRPC",["event-extensions","SoundSynchronizer"],function(a,b,c,d,e,f){b('event-extensions');var g=b('SoundSynchronizer');function h(j,k,l){g.play(j,k,l);}var i={playLocal:h,playRemote:function(j,k,l,m){var n={paths:k,sync:l,loop:m};j.postMessage(JSON.stringify(n),'*');},supportsRPC:function(){return !!window.postMessage;},_listen:function(){Event.listen(window,'message',function(j){if(!/\.facebook.com$/.test(j.origin))return;var k=JSON.parse(j.data);h(k.paths,k.sync,k.loop);});}};e.exports=i;});
__d("Sound",["SoundPlayer","SoundRPC","SoundSynchronizer","UserAgent"],function(a,b,c,d,e,f){var g=b('SoundPlayer'),h=b('SoundRPC'),i=b('SoundSynchronizer'),j=b('UserAgent'),k=null,l={init:function(o){if(!k)g.init(o);},play:function(o,p,q){if(k){h.playRemote(k.contentWindow,o,p,false);}else h.playLocal(o,p,q);},stop:function(o){if(!k)g.stop(o);}},m=location.host.replace(/^[^.]+/,'www');function n(){if(j.ie()<9)return false;return i.isSupported()&&h.supportsRPC();}if(location.host!==m&&n()){k=document.createElement('iframe');k.setAttribute('src','//'+m+'/sound_iframe.php');k.style.display='none';document.body.appendChild(k);}e.exports=l;});
__d("Token",["CSS","DataStore","DOM","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DataStore'),i=b('DOM'),j=b('copyProperties'),k=b('tx');function l(m,n){this.info=m;this.paramName=n;}j(l.prototype,{getInfo:function(){return this.info;},getText:function(){return this.info.text;},getValue:function(){return this.info.uid;},isFreeform:function(){return !!this.info.freeform;},getElement:function(){if(!this.element)this.setElement(this.createElement());return this.element;},setElement:function(m){h.set(m,'Token',this);this.element=m;return this;},isRemovable:function(){return g.hasClass(this.element,'removable');},createElement:function(){var m=this.paramName,n=this.getText(),o=this.getValue(),p=i.create('a',{href:'#','aria-label':k._("Remove {item}",{item:n}),className:'remove uiCloseButton uiCloseButtonSmall'}),q=i.create('input',{type:'hidden',value:o,name:m+'[]',autocomplete:'off'}),r=i.create('input',{type:'hidden',value:n,name:'text_'+m+'[]',autocomplete:'off'}),s=i.create('span',{className:'removable uiToken'},[n,q,r,p]);return s;}});e.exports=l;});
__d("StickyPlaceholderInput",["event-extensions","CSS","DOM","Input","Parent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('DOM'),i=b('Input'),j=b('Parent');function k(o){return j.byClass(o,'uiStickyPlaceholderInput');}function l(o){return h.scry(o,'.placeholder')[0];}function m(o){o=o||window.event;var p=o.target||o.srcElement;if(h.isNodeOfType(p,['input','textarea'])){var q=k(p);if(q){var r=o.type;(function(){if((r==='keydown'||r==='paste')&&p.value.length)g.removeClass(q,'uiStickyPlaceholderEmptyInput');if((r==='blur'||r==='focusout')&&!p.value.length)g.addClass(q,'uiStickyPlaceholderEmptyInput');}).defer();}}}var n={init:function(){n.init=bagofholding;Event.listen(document.documentElement,{keydown:m,paste:m});if(document.documentElement.addEventListener){document.documentElement.addEventListener('blur',m,true);}else Event.listen(document.documentElement,'focusout',m);},registerInput:function(o){n.init();var p=o.getAttribute('placeholder')||'';if(p.length)if(document.activeElement===o){var q=Event.listen(o,'blur',function(){n.manipulateInput(o,p);q.remove();});}else n.manipulateInput(o,p);},manipulateInput:function(o,p){var q=h.create('div',{className:'placeholder','aria-hidden':'true'},p),r=h.create('div',{className:'uiStickyPlaceholderInput'},q);if(h.isNodeOfType(o,'textarea'))g.addClass(r,'uiStickyPlaceholderTextarea');Event.listen(q,'click',function(){o.focus();});if(o.value===p)o.value='';g.removeClass(o,'DOMControl_placeholder');o.setAttribute('placeholder','');h.replace(o,r);h.appendContent(r,o);g.conditionClass(r,'uiStickyPlaceholderEmptyInput',!o.value.length);},setPlaceholderText:function(o,p){var q=k(o);if(!q){i.setPlaceholder(o,p);}else{var r=l(q);r&&h.setContent(r,p);}},getPlaceholderText:function(o){var p=k(o),q=l(p);return q&&h.getText(q);},update:function(o){var p=k(o);if(p)g.conditionClass(p,'uiStickyPlaceholderEmptyInput',!o.value.length);},getVisibleText:function(o){var p=k(o);if(g.hasClass(p,'uiStickyPlaceholderEmptyInput')){var q=l(p);return q&&h.getText(q);}else return o.value;}};e.exports=n;});
__d("Tokenizer",["array-extensions","event-extensions","Arbiter","ArbiterMixin","Class","CSS","DataStore","DOM","DOMQuery","Input","Keys","Parent","StickyPlaceholderInput","Style","TextMetrics","Token","UserAgent","copyProperties","createObjectFrom"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Class'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('DOMQuery'),n=b('Input'),o=b('Keys'),p=b('Parent'),q=b('StickyPlaceholderInput'),r=b('Style'),s=b('TextMetrics'),t=b('Token'),u=b('UserAgent'),v=b('copyProperties'),w=b('createObjectFrom');function x(y,z){this.element=y;this.typeahead=z;this.input=z.getCore().getElement();k.set(this.element,'Tokenizer',this);}x.getInstance=function(y){var z=p.byClass(y,'uiTokenizer');return z?k.get(z,'Tokenizer'):null;};v(x.prototype,h,{inline:false,maxTokens:null,excludeDuplicates:true,placeholder:'',init:function(y,z,aa,ba){this.init=bagofholding;this.tokenarea=y;this.paramName=z;if(!this.placeholder)this.placeholder=this.input.getAttribute('data-placeholder')||'';v(this,ba||{});this.initEvents();this.initTypeahead();this.reset(aa);this.initBehaviors();g.inform('Tokenizer/init',this,g.BEHAVIOR_PERSISTENT);},reset:function(y){this.tokens=[];this.unique={};if(y){this.populate(y);}else l.empty(this.tokenarea);this.updateTokenarea();},populate:function(y){var z=[];this.tokens=this.getTokenElements().map(function(aa,ba){var ca=y[ba];z.push(this._tokenKey(ca));return this.createToken(ca,aa);},this);this.unique=w(z,this.tokens);},getElement:function(){return this.element;},getTypeahead:function(){return this.typeahead;},getInput:function(){return this.input;},initBehaviors:function(){this.behaviors=this.behaviors||[];if(this.behaviors instanceof Array){this.behaviors.forEach(function(aa){aa.behavior(this,aa.config);}.bind(this));}else for(var y in (this.behaviors||{})){var z=window.TokenizerBehaviors&&window.TokenizerBehaviors[y];z.call(null,this,this.behaviors[y]);}},initTypeahead:function(){var y=this.typeahead.getCore();y.resetOnSelect=true;y.setValueOnSelect=false;y.preventFocusChangeOnTab=true;if(this.inline){var z=this.typeahead.getView();j.addClass(z.getElement(),'uiInlineTokenizerView');}this.typeahead.subscribe('select',function(aa,ba){var ca=ba.selected;if('uid' in ca){this.updateInput();this.addToken(this.createToken(ca));}}.bind(this));this.typeahead.subscribe('blur',this.handleBlur.bind(this));},handleBlur:function(event){this.inform('blur',{event:event});this.updatePlaceholder();},initEvents:function(){var y=this.handleEvents.bind(this),z=u.firefox()<4?'keypress':'keydown';Event.listen(this.tokenarea,{click:y,keydown:y});Event.listen(this.input,'paste',this.paste.bind(this));Event.listen(this.input,z,this.keydown.bind(this));},handleEvents:function(event){var y=event.getTarget(),z=y&&this.getTokenElementFromTarget(y);if(!z)return;if(event.type!='keydown'||Event.getKeyCode(event)==o.RETURN)this.processEvents(event,y,z);},processEvents:function(event,y,z){if(p.byClass(y,'remove')){var aa=z.nextSibling;aa=aa&&m.scry(z.nextSibling,'.remove')[0];var ba=this.getTokenFromElement(z);ba=this.addTokenData(ba,y);this.removeToken(ba);this.focusOnTokenRemoval(event,aa);event.kill();}},focusOnTokenRemoval:function(event,y){n.focus(event.type=='keydown'&&y||this.input);},addTokenData:function(y,z){return y;},keydown:function(event){this.inform('keydown',{event:event});var y=Event.getKeyCode(event),z=this.input;if(this.inline&&y==o.BACKSPACE&&n.isEmpty(z)){var aa=this.getLastToken();if(aa&&aa.isRemovable())this.removeToken(aa);}this.updateInput();},paste:function(event){this.inform('paste',{event:event});this.updateInput(true);},focusInput:function(){n.focus(this.input);},updateInput:function(y){if(!this.inline)return;setTimeout(function(){this.adjustWidth(this.input.value);if(y)this.input.value=this.input.value;}.bind(this),20);q.setPlaceholderText(this.input,'');},setPlaceholder:function(y){this.placeholder=y;if(this.stickyPlaceholder)q.setPlaceholderText(this.input,y);this.updatePlaceholder();},updatePlaceholder:function(){if(!this.inline||this.input.value)return;var y=!this.tokens.length,z='';if(y||this.stickyPlaceholder){this.adjustWidth(this.placeholder);z=this.placeholder;}q.setPlaceholderText(this.input,z);},adjustWidth:function(y){if(!this.inline||!this._getIsInDOM())return;if(!y&&this.stickyPlaceholder&&this.input.value==='')y=this.placeholder;var z=this._getMetrics().measure(y),aa=z.width+this._getWidthOffset()+10;r.set(this.input,'width',aa+'px');},getToken:function(y){return this.unique[y]||null;},getTokens:function(){return this.tokens||[];},getTokenElements:function(){return m.scry(this.tokenarea,'span.uiToken');},getTokenElementFromTarget:function(y){return p.byClass(y,'uiToken');},getTokenFromElement:function(y){return k.get(y,'Token');},getTokenValues:function(){return this.tokens.map(function(y){return y.getValue();});},getFirstToken:function(){return this.tokens[0]||null;},getLastToken:function(){return this.tokens[this.tokens.length-1]||null;},hasMaxTokens:function(){return this.maxTokens&&this.maxTokens<=this.tokens.length;},createToken:function(y,z){var aa=this.getToken(this._tokenKey(y));aa=aa||new t(y,this.paramName);z&&aa.setElement(z);return aa;},addToken:function(y){if(this.hasMaxTokens())return;var z=this._tokenKey(y.getInfo());if(z in this.unique)return;this.unique[z]=y;this.tokens.push(y);this.insertToken(y);this.updateTokenarea();this.inform('addToken',y);g.inform('Form/change',{node:this.element});},insertToken:function(y){l.appendContent(this.tokenarea,y.getElement());},removeToken:function(y){if(!y)return;var z=this.tokens.indexOf(y);if(z<0)return;this.tokens.splice(this.tokens.indexOf(y),1);delete this.unique[this._tokenKey(y.getInfo())];l.remove(y.getElement());this.updateTokenarea();this.inform('removeToken',y);g.inform('Form/change',{node:this.element});},removeAllTokens:function(){this.reset();this.inform('removeAllTokens');},updateTokenarea:function(){var y=this.typeahead.getCore(),z=this.getTokenValues();if(this.excludeDuplicates){this._exclusions||(this._exclusions=y.getExclusions());y.setExclusions(z.concat(this._exclusions));}y.setEnabled(!this.hasMaxTokens());this.updateTokenareaVisibility();this.updatePlaceholder();this.adjustWidth(this.placeholder);},updateTokenareaVisibility:function(){j.conditionShow(this.tokenarea,this.tokens.length!==0);},_tokenKey:function(y){return y.uid+(y.freeform?':':'');},_widthOffset:null,_getWidthOffset:function(){if(this._widthOffset===null){var y=this.input.clientWidth,z=r.getFloat(this.input,'width');if(y==z){this._widthOffset=r.getFloat(this.input,'paddingLeft')+r.getFloat(this.input,'paddingRight');}else this._widthOffset=0;}return this._widthOffset;},_metrics:null,_getMetrics:function(){if(!this._metrics)this._metrics=new s(this.input,this.inline);return this._metrics;},_getIsInDOM:function(){return this._isInDOM||(this._isInDOM=m.contains(document.body,this.input));}});e.exports=x;});
__d("Typeahead",["array-extensions","event-extensions","ArbiterMixin","BehaviorsMixin","Class","DataStore","DOM","Parent","Run","copyProperties","ge"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('ArbiterMixin'),h=b('BehaviorsMixin'),i=b('Class'),j=b('DataStore'),k=b('DOM'),l=b('Parent'),m=b('Run'),n=b('copyProperties'),o=b('ge');function p(q,r,s,t){this.args={data:q,view:r,core:s};j.set(t,'Typeahead',this);this.element=t;}p.getInstance=function(q){var r=l.byClass(q,'uiTypeahead');return r?j.get(r,'Typeahead'):null;};n(p.prototype,g,h,{init:function(q){this.init=bagofholding;this.getCore();this.proxyEvents();this.initBehaviors(q||[]);this.inform('init',this);this.data.bootstrap();this.core.focus();},getData:function(){if(!this.data){var q=this.args.data;this.data=q;this.data.init();}return this.data;},getView:function(){if(!this.view){var q=this.args.view,r=o(q.node_id);if(!r){r=k.create('div',{className:'uiTypeaheadView'});k.appendContent(this.element,r);}if(typeof q.ctor==='string'){this.view=new window[q.ctor](r,q.options||{});}else this.view=new q.ctor(r,q.options||{});this.view.init();this.view.setTypeahead(this.element);}return this.view;},getCore:function(){if(!this.core){var q=this.args.core;if(typeof q.ctor==='string'){this.core=new window[q.ctor](q.options||{});}else this.core=new q.ctor(q.options||{});this.core.init(this.getData(),this.getView(),this.getElement());}return this.core;},getElement:function(){return this.element;},swapData:function(q){var r=this.core;this.data=this.args.data=q;q.init();if(r){r.data=q;r.initData();r.reset();}q.bootstrap();return q;},proxyEvents:function(){[this.data,this.view,this.core].forEach(function(q){q.subscribe(q.events,this.inform.bind(this));},this);},initBehaviors:function(q){q.forEach(function(r){if(typeof r==='string'){if(a.TypeaheadBehaviors&&a.TypeaheadBehaviors[r]){a.TypeaheadBehaviors[r](this);}else m.onLoad(function(){if(a.TypeaheadBehaviors)(a.TypeaheadBehaviors[r]||bagofholding)(this);}.bind(this));}else this.enableBehavior(r);},this);}});p.initNow=function(q,r,s){if(s)s.init(q);q.init(r);};p.init=function(q,r,s,t){if(!k.isNodeOfType(q,['input','textarea']))q=k.scry(q,'input')[0]||k.scry(q,'textarea')[0];var u=false;try{u=document.activeElement===q;}catch(v){}if(u){p.initNow(r,s,t);}else var w=Event.listen(q,'focus',function(){p.initNow(r,s,t);w.remove();});};e.exports=p;});
__d("TypeaheadCore",["event-extensions","Arbiter","ArbiterMixin","Class","CSS","DOM","Input","InputSelection","Keys","UserAgent","bind","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Class'),j=b('CSS'),k=b('DOM'),l=b('Input'),m=b('InputSelection'),n=b('Keys'),o=b('UserAgent'),p=b('bind'),q=b('copyProperties');function r(s){q(this,s);}q(r.prototype,h,{events:['blur','focus','click','unselect','loading'],keepFocused:true,resetOnSelect:false,resetOnKeyup:true,setValueOnSelect:false,queryTimeout:250,preventFocusChangeOnTab:false,init:function(s,t,u){this.init=bagofholding;this.data=s;this.view=t;this.root=u;this.initInput();this.inputWrap=k.find(u,'div.wrap');this.hiddenInput=k.find(u,'input.hiddenInput');this.value='';this.nextQuery=null;this.selectedText=null;if(this.setValueOnSelect&&j.hasClass(this.inputWrap,'selected'))this.selectedText=this.getValue();this.initView();this.initData();this.initEvents();this.initToggle();this._exclusions=[];},initInput:function(){this.element=k.find(this.root,'.textInput');var s=k.scry(this.element,'input')[0];if(s)this.element=s;},initView:function(){this.view.subscribe('highlight',function(s,t){this.element.focus();this.element.setAttribute('aria-activedescendant',(t.index!==-1)?k.getID(t.element):'');}.bind(this));this.view.subscribe('select',function(s,t){this.select(t.selected);}.bind(this));this.view.subscribe('afterSelect',function(){this.afterSelect();}.bind(this));},initData:function(){this.data.subscribe('respond',function(s,t){if(t.forceDisplay||t.value==this.getValue()&&!this.element.disabled)this.view.render(t.value,t.results,t.isAsync);}.bind(this));this.data.subscribe('activity',function(s,t){this.fetching=t.activity;if(!this.fetching)this.nextQuery&&this.performQuery();if(this.loading!=this.fetching){this.loading=this.fetching;this.inform('loading',{loading:this.loading});}}.bind(this));},initEvents:function(){Event.listen(this.view.getElement(),{mouseup:this.viewMouseup.bind(this),mousedown:this.viewMousedown.bind(this)});var s={blur:p(this,'blur'),focus:p(this,'focus'),click:p(this,'click'),keyup:p(this,'keyup'),keydown:p(this,'keydown')};if(o.firefox())s.text=s.keyup;if(o.firefox()<4){s.keypress=s.keydown;delete s.keydown;}Event.listen(this.element,s);Event.listen(this.element,'keypress',p(this,'keypress'));},initToggle:function(){this.subscribe('blur',this.view.hide.bind(this.view));this.subscribe('focus',this.view.show.bind(this.view));},viewMousedown:function(){this.selecting=true;},viewMouseup:function(){this.selecting=false;},blur:function(){if(this.selecting){this.selecting=false;return;}this.inform('blur');},click:function(){var s=m.get(this.element);if(s.start==s.end)this.element.select();this.inform('click');},focus:function(){this.checkValue();this.inform('focus');},keyup:function(){if(this.resetOnKeyup&&!this.getValue())this.view.reset();this.checkValue();},keydown:function(event){if(!this.view.isVisible()||this.view.isEmpty()){this.checkValue.bind(this).defer();return;}switch(Event.getKeyCode(event)){case n.TAB:this.handleTab(event);return;case n.UP:this.view.prev();break;case n.DOWN:this.view.next();break;case n.ESC:this.view.reset();break;default:this.checkValue.bind(this).defer();return;}event.kill();},keypress:function(event){if(this.view.getSelection()&&Event.getKeyCode(event)==n.RETURN){this.view.select();event.kill();}},handleTab:function(event){if(this.preventFocusChangeOnTab)if(this.view.getSelection()){event.kill();}else event.preventDefault();this.view.select();},select:function(s){if(s&&this.setValueOnSelect){this.setValue(s.text);this.setHiddenValue(s.uid);this.selectedText=s.text;j.addClass(this.inputWrap,'selected');}},afterSelect:function(){this.keepFocused?this.element.focus():this.element.blur();this.resetOnSelect?this.reset():this.view.reset();},unselect:function(){if(this.setValueOnSelect){this.selectedText=null;j.removeClass(this.inputWrap,'selected');}this.setHiddenValue();this.inform('unselect',this);},setEnabled:function(s){var t=s===false;this.element.disabled=t;j.conditionClass(this.root,'uiTypeaheadDisabled',t);},reset:function(){this.unselect();this.setValue();!this.keepFocused&&l.reset(this.element);this.view.reset();this.inform('reset');},getElement:function(){return this.element;},setExclusions:function(s){this._exclusions=s;},getExclusions:function(){return this._exclusions;},setValue:function(s){this.value=this.nextQuery=s||'';l.setValue(this.element,this.value);},setHiddenValue:function(s){this.hiddenInput.value=(s||s===0)?s:'';g.inform('Form/change',{node:this.hiddenInput});},getValue:function(){return l.getValue(this.element);},getHiddenValue:function(){return this.hiddenInput.value||'';},checkValue:function(){var s=this.getValue();if(s==this.value)return;if(this.selectedText&&this.selectedText!=s)this.unselect();var t=Date.now(),u=t-this.time;this.time=t;this.value=this.nextQuery=s;this.performQuery(u);},performQuery:function(s){if(this.selectedText)return;s=s||0;if(this.fetching&&s<this.queryTimeout){this.data.query(this.nextQuery,true,this._exclusions);}else{this.data.query(this.nextQuery,false,this._exclusions);this.nextQuery=null;}}});e.exports=r;});
__d("UntrustedLink",["DOM","event-extensions","URI","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('event-extensions'),i=b('URI'),j=b('UserAgent'),k=b('copyProperties');function l(m,n,o,p){this.dom=m;this.url=m.href;this.hash=n;this.func_get_params=p||function(){return {};};Event.listen(this.dom,'click',this.onclick.bind(this));Event.listen(this.dom,'mousedown',this.onmousedown.bind(this));Event.listen(this.dom,'mouseup',this.onmouseup.bind(this));Event.listen(this.dom,'mouseout',this.onmouseout.bind(this));this.onmousedown(h.$E(o));}l.bootstrap=function(m,n,o,p){if(m.__untrusted)return;m.__untrusted=true;new l(m,n,o,p);};l.prototype.getRewrittenURI=function(){var m=k({u:this.url,h:this.hash},this.func_get_params(this.dom)),n=new i('/l.php');return n.setQueryData(m).setSubdomain('www').setProtocol('http');};l.prototype.onclick=function(){(function(){this.setHref(this.url);}).bind(this).defer(100);this.setHref(this.getRewrittenURI());};l.prototype.onmousedown=function(m){if(m.button==2)this.setHref(this.getRewrittenURI());};l.prototype.onmouseup=function(){this.setHref(this.getRewrittenURI());};l.prototype.onmouseout=function(){this.setHref(this.url);};l.prototype.setHref=function(m){if(j.ie()<9){var n=g.create('span');g.appendContent(this.dom,n);this.dom.href=m;g.remove(n);}else this.dom.href=m;};e.exports=l;});
__d("UIIntentionalStreamMessage",[],function(a,b,c,d,e,f){var g={SET_AUTO_INSERT:'UIIntentionalStream/setAutoInsert',UPDATE_STREAM:'UIIntentionalStreamRefresh/updateStream',REFRESH_STREAM:'UIIntentionalStreamRefresh/refreshStream',UPDATE_AUTOREFRESH_CONFIG:'UIIntentionalStream/updateAutoRefreshConfig',UPDATE_HTML_CONTENT:'UIIntentionalStream/updateHtmlContent',UPDATE_LAST_REFRESH_TIME:'UIIntentionalStream/updateLastRefreshTime',INSERT_STORIES:'UIIntentionalStream/updateLastRefreshTime',UNLOAD:'UIIntentionalStream/unload'};e.exports=g;});
__d("collectSubtreeData",[],function(a,b,c,d,e,f){function g(i,j,k,l,m){if(i.offsetWidth===0&&i.offsetHeight===0)return m;var n={};if(i.getAttribute)for(r=0;r<j.length;r++){t=j[r];var o=i.getAttribute(k[t]);if(o){n[t]={};var p=JSON.parse(o);for(var q in l)if(p[q]!==undefined){n[t][q]=true;if(m[t]===undefined)m[t]={};if(m[t][q]===undefined)m[t][q]=[];if(l[q].length>0)m[t][q].push(l[q]);m[t][q].push('('+p[q]);}}}for(var r=0;r<i.childNodes.length;r++){var s=i.childNodes[r];g(s,j,k,l,m);}for(var t in n)for(var u in n[t]){var v=m[t][u][m[t][u].length-1];if(v.length>0&&v.charAt(0)=='('){m[t][u][m[t][u].length-1]=v.substr(1);}else m[t][u].push(')');}return m;}function h(i,j){var k={};for(var l=0;l<j.length;++l)k[j[l]]='data-'+j[l];var m={tn:"","tn-debug":","},n={};g(i,j,k,m,n);for(var o in n)for(var p in n[o])n[o][p]=n[o][p].join('');return n;}e.exports=h;});
__d("ViewportTracking",["event-extensions","Arbiter","DOM","NavigationMessage","Run","Style","UIIntentionalStreamMessage","Vector","$","collectSubtreeData","copyProperties","debounce","userAction"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('DOM'),i=b('NavigationMessage'),j=b('Run'),k=b('Style'),l=b('UIIntentionalStreamMessage'),m=b('Vector'),n=b('$'),o=b('collectSubtreeData'),p=b('copyProperties'),q=b('debounce'),r=b('userAction'),s='vpv';function t(){}p(t.prototype,{init:function(u){p(this,{readStoryIDs:{},minSizeToBeVisible:200,listeners:[],arbiterSubscriptions:[]});this.getDataFromConfig(u);this.fireTimer();var v=q(this.fireTimer,this.getTimeout(),this);this.listeners.push(Event.listen(window,'scroll',v));this.listeners.push(Event.listen(window,'resize',v));this.arbiterSubscriptions.push(g.subscribe(l.UPDATE_HTML_CONTENT,v));j.onLeave(this.cleanup.bind(this));this.arbiterSubscriptions.push(g.subscribe(i.NAVIGATION_BEGIN,this.cleanup.bind(this)));},cleanup:function(){this.listeners.forEach(function(u){u.remove();});this.listeners=[];this.arbiterSubscriptions.forEach(function(u){u.unsubscribe();});this.arbiterSubscriptions=[];},fireTimer:function(){this.getStoriesInView().forEach(this.markStoryRead.bind(this));},getStoriesInView:function(){var u=this.getAllStories(),v=[],w=false;for(var x=0;x<u.length;x++){var y=u[x],z=this.getStoryID(y);if(this.hasBeenVisible(z))continue;if(this.isVisible(y)){v.push(y);w=true;}else if(w)break;}return v;},hasBeenVisible:function(u){return u in this.readStoryIDs;},isVisible:function(u){var v=m.getViewportDimensions(),w=m.getElementPosition(u,'viewport'),x=m.getElementDimensions(u),y=Math.max(w.y,0),z=Math.min(w.y+x.y,v.y),aa=Math.min(x.y,this.minSizeToBeVisible);return (z-y)>=aa;},markStoryRead:function(u){var v=this.getStoryID(u);if(!v)return;if(!this.hasBeenVisible(v)){this.readStoryIDs[v]=true;var w=this.getDataToLog(u);r(s,u,null,'FORCE',w);}}});e.exports=t;});
__d("XHPTemplate",["event-extensions","DataStore","DOM","HTML","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('DataStore'),h=b('DOM'),i=b('HTML'),j=b('copyProperties');function k(m){this._model=m;}j(k.prototype,{render:function(){if(i.isHTML(this._model))this._model=h.setContent(document.createDocumentFragment(),this._model)[0];return this._model.cloneNode(true);},build:function(){return new l(this.render());}});j(k,{getNode:function(m,n){return k.getNodes(m)[n];},getNodes:function(m){var n=g.get(m,'XHPTemplate:nodes');if(!n){n={};var o=h.scry(m,'[data-jsid]');o.push(m);var p=o.length;while(p--){var q=o[p];n[q.getAttribute('data-jsid')]=q;q.removeAttribute('data-jsid');}g.set(m,'XHPTemplate:nodes',n);}return n;}});function l(m){this._root=m;this._populateNodes();}j(l.prototype,{_populateNodes:function(){this._nodes={};this._leaves={};var m=this._root.getElementsByTagName('*');for(var n=0,o=m.length;n<o;n++){var p=m[n],q=p.getAttribute('data-jsid');if(q){p.removeAttribute('data-jsid');this._nodes[q]=p;this._leaves[q]=!p.childNodes.length;}}},getRoot:function(){return this._root;},getNode:function(m){return this._nodes[m];},setNodeProperty:function(m,n,o){this.getNode(m)[n]=o;return this;},setNodeContent:function(m,n){if(!this._leaves[m])throw new Error("Can't setContent on non-leaf node: "+m);h.setContent(this.getNode(m),n);return this;}});e.exports=k;});
__d("enforceMaxLength",["event-extensions","function-extensions","DOM","Input","InputSelection"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('DOM'),h=b('Input'),i=b('InputSelection'),j=function(m,n){var o=h.getValue(m),p=o.length,q=p-n;if(q>0){var r,s;try{r=i.get(m);s=r.end;}catch(t){r=null;s=0;}if(s>=q)p=s;var u=p-q;if(u&&(o.charCodeAt(u-1)&64512)===55296)u--;s=Math.min(s,u);h.setValue(m,o.slice(0,u)+o.slice(p));if(r)i.set(m,Math.min(r.start,s),s);}},k=function(event){var m=event.getTarget(),n=m.getAttribute&&parseInt(m.getAttribute('maxlength'),10);if(n>0&&g.isNodeOfType(m,['input','textarea']))j.bind(null,m,n).defer();},l='maxLength' in g.create('input')&&'maxLength' in g.create('textarea');if(!l)Event.listen(document.documentElement,{keydown:k,paste:k});e.exports=j;});
__d("htmlHyperlink",["Env","htmlize","UntrustedLink","URI","URLScraper"],function(a,b,c,d,e,f){var g=b('Env'),h=b('htmlize'),i=b('UntrustedLink'),j=b('URI'),k=b('URLScraper');function l(m,n,o,p){if(typeof m==='undefined'||!m.toString)return '';if(typeof n!=='function')n=h;if(typeof o!=='function')o=h;var m=m.toString(),q=[],r;while((r=k.match(m))){var s=m.indexOf(r);if(s>=0)q.push(n(m.substring(0,s)));var t=o(r),u=r.replace(/"/g,'%22');if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(r)))u='http://'+u;q.push('<a target="_blank" rel="nofollow" href="'+u+'"');if(p&&!j(u).isFacebookURI()){a.UntrustedLink=i;q.push(' onmousedown="UntrustedLink.bootstrap(this, \''+g.lhsh+'\', event)"');}q.push('>'+t+'</a>');m=m.substring(s+r.length);}m&&q.push(n(m));return q.join('');}e.exports=l;});
__d("randomInt",[],function(a,b,c,d,e,f){function g(h,i){if(arguments.length===1){i=h;h=0;}var j=this.random||Math.random;return Math.floor(h+j()*(i-h));}e.exports=g;});
__d("setIntervalAcrossTransitions",[],function(a,b,c,d,e,f){function g(h,i){return setInterval(h,i,false);}e.exports=g;});
__d("setTimeoutAcrossTransitions",[],function(a,b,c,d,e,f){function g(h,i){return setTimeout(h,i,false);}e.exports=g;});
__d("submitForm",["DOM"],function(a,b,c,d,e,f){var g=b('DOM'),h=function(i){var j=g.scry(i,'input[type="submit"]')[0];if(j){j.click();}else{j=g.create('input',{type:'submit',className:'hidden_elem'});g.appendContent(i,j);j.click();g.remove(j);}};e.exports=h;});
__d("debounceAcrossTransitions",["debounce"],function(a,b,c,d,e,f){var g=b('debounce');function h(i,j,k){return g(i,j,k,true);}e.exports=h;});
__d("legacy:onvisible",["OnVisible"],function(a,b,c,d){a.OnVisible=b('OnVisible');},3);
__d("PhotoEverstoreLogger",["event-extensions","AsyncRequest","copyProperties","ImageUtils"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h=b('copyProperties'),i=b('ImageUtils'),j={BATCH_WINDOW_MS:500,storedLog:[]};function k(){}h(k,{_log:function(m){j.storedLog.push(m);if(j.storedLog.length==1)setTimeout(l,j.BATCH_WINDOW_MS,false);},logImmediately:function(m){k._log(m);},registerForLogging:function(m){if(i.hasLoaded(m)){k._log(m.src);}else Event.listen(m,'load',function(event){k._log(m.src);});}});function l(){var m=j.storedLog;j.storedLog=[];var n=JSON.stringify(m);new g().setURI('/ajax/photos/logging/everstore_logging.php').setData({loggedUrls:n}).setMethod('POST').setOption('suppressErrorHandlerWarning',true).setOption('suppressErrorAlerts',true).send();}e.exports=k;});
__d("PhotoSessionLog",["AsyncRequest","Run","Vector","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Run'),i=b('Vector'),j=b('copyProperties');function k(){}j(k,{UNKNOWN:0,ESC:1,X:2,OUTSIDE:3,UNLOAD:4,NAVIGATE:5,AGGREGATE:6,LEAVE:7,PERMALINK:0,SNOWLIFT:6,AGGREGATION_COUNT:20,set:null,time:null,views:0,fbidList:[],details:{},width:0,height:0,first:false,last:false,logIds:false,version:null,buttonLikes:0,pagingAction:'',faceTagImpressions:0,cycle:false,endOfRelevant:false,relevantCount:0,initLogging:function(l){this.set=null;this.time=new Date();this.views=0;this.hiResLoads=0;this.fullScreenViews={};this.first=true;this.last=false;this.logIds=false;this.version=l;this.buttonLikes=0;this.pagingAction='';this.faceTagImpressions=0;this.cycle=false;this.endOfRelevant=false;this.relevantCount=0;if(l===k.SNOWLIFT){var m=i.getViewportDimensions();this.width=m.x;this.height=m.y;}},setLogFbids:function(l){this.logIds=l;},setPhotoSet:function(l){this.set=l;},addButtonLike:function(){this.buttonLikes++;},setPagingAction:function(l){this.pagingAction=l;},addFaceTagImpression:function(){this.faceTagImpressions++;},setCycle:function(l){this.cycle=l;},setEndOfRelevant:function(l){this.endOfRelevant=l;},setRelevantCount:function(l){this.relevantCount=l;},setEndMetrics:function(l){this.endMetrics=l;},addPhotoView:function(l,m,n){if(this.logIds&&this.views>=this.AGGREGATION_COUNT)this.logPhotoViews(this.AGGREGATE);this.views++;if(l)this.fbidList.push([l.fbid,l.owner,Date.now()]);if(m)this.hiResLoads++;if(n)this.fullScreenViews[l.fbid]=true;},logEnterFullScreen:function(l){this.fullScreenViews[l]=true;},addDetailData:function(l,m){if(!this.details[l])this.details[l]={t:m.num_tags,l:m.has_location,c:m.has_caption,cm:m.comment_count,lk:m.like_count,w:m.width,h:m.height,ad:'{}',p:this.pagingAction};},updateAdData:function(l,m){if(this.details[l])this.details[l].ad=JSON.stringify(m);},logPhotoViews:function(l){if((!this.views)||(this.version===k.SNOWLIFT&&l==k.LEAVE))return;if(l!=this.AGGREGATE)this.last=true;var m={set:this.set,time:new Date()-this.time,fbids:this.logIds?this.fbidList:[],details:this.logIds?this.details:{},first:this.first,last:this.last,close:l?l:this.UNKNOWN,button_likes:this.buttonLikes,version:this.version,face_imp:this.faceTagImpressions,endmetric:this.endMetrics,cycle:this.cycle,end_relev:this.endOfRelevant,relev_count:this.relevantCount};if(this.version===k.SNOWLIFT){var n=i.getViewportDimensions();m.width=n.x||this.width;m.height=n.y||this.height;if(this.hiResLoads>0)m.hires_loads=this.hiResLoads;if(this.last){var o=Object.keys(this.fullScreenViews).length;if(o>0)m.fullscreen=o;}}new g().setURI('/ajax/photos/logging/session_logging.php').setAllowCrossPageTransition(true).setOption('asynchronous',(l!=k.UNLOAD)).setOption('suppressErrorHandlerWarning',true).setData(m).send();this.views=0;this.hiResLoads=0;this.fbidList=[];this.details={};this.first=false;this.buttonLikes=0;if(this.last){this.set=null;this.logIds=false;this.fullScreenViews={};}}});h.onUnload(function(){k.logPhotoViews(k.UNLOAD);});h.onLeave(function(){k.logPhotoViews(k.LEAVE);});e.exports=k;});
__d("PhotosConst",[],function(a,b,c,d,e,f){var g={VIEWER_PERMALINK:0,VIEWER_SNOWLIFT:6,VIEWER_VAULTBOX:8,BULK_EDITOR:3,FLASH_UPLOADER:4,HTML5_UPLOADER:10,SIZE_NORMAL:'n'};e.exports=g;});
__d("PhotosUtils",["copyProperties","Rect","Vector"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('Rect'),i=b('Vector');function j(){}g(j,{getNearestBox:function(k,l){var m=Infinity,n=null;for(var o in k){var p=k[o];if(p.contains(l)){var q=l.distanceTo(p.getCenter());if(q<m){m=q;n=o;}}}return n;},absoluteToNormalizedPosition:function(k,l){var m=i.getElementPosition(k),n=i.getElementDimensions(k),o=l.sub(m).mul(100/n.x,100/n.y);o.domain='pure';return o;},normalizedToAbsolutePosition:function(k,l){var m=i.getElementPosition(k),n=i.getElementDimensions(k),o=l.mul(n.x/100,n.y/100).add(m);o.domain='document';return o;},isFacebox:function(k){return k.match(/^face:/);}});e.exports=j;});
__d("PhotoStreamCache",["array-extensions","HTML","PhotosConst","PhotoEverstoreLogger","Rect","UIPagelet","URI","Vector","copyProperties","createArrayFrom"],function(a,b,c,d,e,f){b('array-extensions');var g=b('HTML'),h=b('PhotosConst'),i=b('PhotoEverstoreLogger'),j=b('Rect'),k=b('UIPagelet'),l=b('URI'),m=b('Vector'),n=b('copyProperties'),o=b('createArrayFrom');function p(){}n(p,{ERROR:'error',HTML:'html',IMAGE_DATA:'image',EXTRA:'extra',BUFFER_SIZE:3,INIT_BUCKET_SIZE:4,FULL_BUCKET_SIZE:12,ERROR_ID:-1,INIT_PLACEHOLDER:1});n(p.prototype,{init:function(q,r){this.version=q;this.pageletName=r;this.bufferSize=p.BUFFER_SIZE;this.fullBucketSize=p.FULL_BUCKET_SIZE;this.initError=false;this.isActive=true;this.leftLock=false;this.rightLock=false;this.reset();},reset:function(){this.cache={image:{},extra:{},html:{}};this.fbidList=[];this.loaded=false;this.allLoaded=false;this.permalinkMap={};this.position=0;this.totalCount=null;this.firstCursor=null;this.firstCursorIndex=null;},waitForInitData:function(){this.fbidList.push(p.INIT_PLACEHOLDER);},destroy:function(){this.reset();this.isActive=false;},isLoaded:function(){return this.loaded;},canPage:function(){if(!this.isLoaded())return false;if(this.totalCount!==null)return this.totalCount>1;return this.getLength()>1;},errorInCurrent:function(){if(this.initError){return true;}else if(!this.isLoaded())return false;return this.checkErrorAt(this.getCursor());},getLength:function(){return this.fbidList.length;},getPhotoSet:function(){return this.photoSetQuery.set;},getPhotoSetQuery:function(){return this.photoSetQuery;},getCurrentImageData:function(){return this.getImageData(this.getCursor());},getImageData:function(q){return this.getCacheContent(q,p.IMAGE_DATA);},getCurrentHtml:function(){return this.getCacheContent(this.getCursor(),p.HTML);},getCurrentExtraData:function(){return this.getCacheContent(this.getCursor(),p.EXTRA);},getCacheContent:function(q,r){if(!q||q===p.ERROR_ID||q===p.INIT_PLACEHOLDER)return null;return this.cache[r][q];},getCursorPos:function(){return this.position;},getCursor:function(){if(this.position>=0&&this.position<this.getLength())return this.fbidList[this.position];return null;},getCursorForURI:function(q){return this.permalinkMap[q];},calculatePositionForMovement:function(q){var r=this.position+q;if(this.allLoaded){var s=this.getLength();r=(s+r%s)%s;}return r;},isValidMovement:function(q){if(!this.isLoaded()||!this.canPage())return false;var r=this.calculatePositionForMovement(q);return this.getCursor()>0||(r>=0&&r<this.getLength());},moveCursor:function(q){if(!this.isValidMovement(q))return;this.position=this.calculatePositionForMovement(q);if(q!==0)this.loadMoreIfNeccessary(q>0);},checkErrorAt:function(q){if(!this.isLoaded())return false;if(q===p.ERROR_ID)return true;return false;},getRelativeMovement:function(q){for(var r=0;r<this.getLength();r++)if(this.fbidList[r]==q)return r-this.position;return null;},preloadImages:function(q){var r,s,t=this.getLength(),u=this.cache.image,v=p.BUFFER_SIZE;if(t>v*2){r=(this.position+t-v%t)%t;s=(this.position+v)%t;}else{r=0;s=t-1;}while(r!=s){var w=this.fbidList[r];if(u[w]&&u[w].url)if(q&&!u[w].resource){u[w].resource=new Image();u[w].resource.src=u[w].url;if(u[w].everstoreLogThis===true)i.logImmediately(u[w].resource.src);}else if(!q&&!u[w].small){u[w].small=new Image();u[w].small.src=u[w].smallurl||u[w].url;if(u[w].everstoreLogThis===true)i.logImmediately(u[w].small.src);}r=(r+1)%t;}},loadMoreIfNeccessary:function(q){if(this.allLoaded||(q&&this.rightLock)||(!q&&this.leftLock))return;var r=q?1:-1,s=this.position+this.bufferSize*r;if(s<0&&!this.checkErrorAt(this.getEndCursor(false))){this.leftLock=true;this.fetch(this.fullBucketSize,false);}else if(s>this.getLength()&&!this.checkErrorAt(this.getEndCursor(true))){this.rightLock=true;this.fetch(this.fullBucketSize,true);}},getEndCursor:function(q){return q?this.fbidList[this.getLength()-1]:this.fbidList[0];},calculateRelativeIndex:function(q,r,s){if(!this.totalCount)return null;var t=this.fbidList.indexOf(r),u=this.fbidList.indexOf(s);if(t===-1||u===-1)return null;var v=u-t;return (q+v+this.totalCount)%this.totalCount;},calculateDistance:function(q,r){var s=this.fbidList.indexOf(q),t=this.fbidList.indexOf(r);if(s===-1||t===-1)return null;return (t-s+this.getLength())%this.getLength();},fetch:function(q,r){var s=this.getEndCursor(r),t=n({cursor:s,version:this.version,end:this.getEndCursor(!r),fetchSize:r?q:-1*q,relevant_count:this.relevantCount},this.photoSetQuery);if(this.totalCount&&this.firstCursorIndex!==null){t.total=this.totalCount;t.cursorIndex=this.calculateRelativeIndex(this.firstCursorIndex,this.firstCursor,s);}k.loadFromEndpoint(this.pageletName,null,t,{usePipe:true,jsNonblock:true,crossPage:true});},storeToCache:function(q){var r={};if(!this.isActive)return r;if('error' in q){this.processErrorResult(q.error);r.error=true;return r;}if('init' in q){this.processInitResult(q.init);r.init={logids:q.init.logids,fbid:q.init.fbid,loggedin:q.init.loggedin,fromad:q.init.fromad};}if('image' in q){this.processImageResult(q.image);r.image=true;}if('data' in q){this.processDataResult(q.data);r.data=true;}return r;},processInitResult:function(q){if(this.loaded)return;this.loaded=true;this.photoSetQuery=q.query;if(q.bufferSize)this.bufferSize=q.bufferSize;if(q.fullBucketSize)this.fullBucketSize=q.fullBucketSize;if(this.fbidList.length===0){this.fbidList.push(q.fbid);this.rightLock=true;}else{var r=this.fbidList.indexOf(p.INIT_PLACEHOLDER);if(r!=-1)this.fbidList[r]=q.fbid;}this.firstCursor=q.fbid;if('initIndex' in q&&'totalCount' in q){this.firstCursorIndex=q.initIndex;this.totalCount=q.totalCount;}if(this.version==h.VIEWER_PERMALINK)this.fetch(p.INIT_BUCKET_SIZE,true);},processImageResult:function(q){for(var r in q){if(r===this.firstCursor&&q[r].everstoreLogThis)i.logImmediately(q[r].url);this.cache.image[r]=q[r];if(q[r].dimensions)this.cache.image[r].dimensions=m.deserialize(q[r].dimensions);if(q[r].smalldims)this.cache.image[r].smalldims=m.deserialize(q[r].smalldims);this.permalinkMap[l(q[r].info.permalink).getUnqualifiedURI().toString()]=r;}},attachToFbidsList:function(q,r,s){if(this.allLoaded)return;if(r===-1){for(var t=q.length-1;t>=0;t--){this.fbidList.unshift(q[t]);this.position++;}this.leftLock=false;}else{for(var u=0;u<q.length;u++)this.fbidList.push(q[u]);this.rightLock=false;}if(s)this.setAllLoaded();},setAllLoaded:function(){this.allLoaded=true;if(this.getCursor()===null)this.position=this.calculatePositionForMovement(0);},processDataResult:function(q){for(var r in q){if(!this.cache.html[r])this.cache.html[r]={};for(var s in q[r].html){var t=q[r].html[s];if(typeof t==='string')t=g(t).getRootNode();this.cache.html[r][s]=o(t.childNodes);}if(!('extra' in q[r])){this.cache.extra[r]=null;continue;}this.cache.extra[r]={tagRects:{}};if(!Array.isArray(q[r].extra.tagRects))for(var u in q[r].extra.tagRects)if(q[r].extra.tagRects[u])this.cache.extra[r].tagRects[u]=j.deserialize(q[r].extra.tagRects[u]);}},processErrorResult:function(q){if(!this.isLoaded()){this.initError=true;return;}var r=q.side,s=[p.ERROR_ID];this.attachToFbidsList(s,r);},setTotalCount:function(q){this.totalCount=q;},setFirstCursorIndex:function(q){this.firstCursorIndex=q;}});e.exports=p;});
__d("PhotoSnowliftAds",["array-extensions","event-extensions","copyProperties","CSS","csx","DataStore","DOM","PhotoSessionLog","UIPagelet","URI","Vector"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('copyProperties'),h=b('CSS'),i=b('csx'),j=b('DataStore'),k=b('DOM'),l=b('PhotoSessionLog'),m=b('UIPagelet'),n=b('URI'),o=b('Vector'),p={DEFAULT_UNITS_REFRESH_RATE:30000,UNITS_REGISTER_DELAY:1000,root:null,availableDimensions:null,loadQuery:null,lastLoadTime:0,minAds:100,units:null,isLogAdData:null,showSmallerAd:false,egoEnabled:false,refreshUnitsRate:null,adsStatus:'null',adsEvents:{},resetEvents:function(){this.adsStatus='reset';this.adsEvents={};},addEvent:function(q,r){if(r)this.adsStatus=q;var s=Date.now();this.adsEvents[q+'_'+s]=s;},init:function(q,r,s){this.reset();this.root=q;this.snowlift=r;this.showSmallerAd=s.showsmallerad;this.egoEnabled=s.ego_enabled;this.minAds=s.min_ads;this.addEvent('init',true);this.refreshUnitsRate=p.DEFAULT_UNITS_REFRESH_RATE;if(s.refresh_fast)this.refreshUnitsRate=s.refresh_rate;},reset:function(){this.lastLoadTime=0;this.units=[];this.resetEvents();this.addEvent('reset',true);},resize:function(q){this.availableDimensions=q;this.loadQuery=this.snowlift.getLoadQuery();this.processResize();},calculateUnitSizes:function(q,r){var s={};q.forEach(function(t){var u=t.root.firstChild.offsetHeight;t.units.forEach(function(w){if(!h.hasClass(w,'hidden')){var x=this.getHeight(w.firstChild,r);u-=x;}}.bind(this));var v={height:u,visible:false};t.units.forEach(function(w){var x=this.getIsAds(w),y=this.getHeight(w.firstChild,r),z=this.getUnitId(w);s[z]={height:y,visible:false,priority:0,is_ads:x,section_ref:v};}.bind(this));}.bind(this));return s;},calculateVisibleUnits:function(q,r,s){var t=0,u=this.getUnitPriority(r);u.forEach(function(v){if(r.hasOwnProperty(v)){var w=r[v],x=w.height;if(!w.section_ref.visible)x+=w.section_ref.height;w.height_below=s-x;w.visible=w.height_below>=0&&x>0;if(w.visible){w.section_ref.visible=true;s-=x;t++;}}}.bind(this));return r;},displayUnits:function(q,r){q.forEach(function(s){var t=false;s.units.forEach(function(u){var v=this.getUnitId(u),w=r[v],x=w.visible,y=w.height_below,z=w.is_ads;h.conditionClass(u,'hidden',!x);t=t||x;this.calcUnitStats(this.units[z][v],x,y);}.bind(this));h.conditionClass(s.root,'hidden',!t);}.bind(this));},getUnitPriority:function(q){var r=[],s=0,t=0;for(var u in q){var v=q[u];r.push(u);var w=this.minAds+s+t;if(v.is_ads){if(t<this.minAds)w=t;t++;}else s++;v.priority=w;}r=r.sort(function(x,y){var z=q[x],aa=q[y];return z.priority-aa.priority;}.bind(this));return r;},updateUnitsStatus:function(){var q=this.availableDimensions.x,r=this.availableDimensions.y,s=this.calculateUnitSizes(this.sections,q);s=this.calculateVisibleUnits(this.sections,s,r);this.displayUnits(this.sections,s);},calcUnitStats:function(q,r,s){var t=Date.now();if(q.visible)q.totalTime+=t-q.lastShowTime;if(q.trackingCode!==null&&q.totalTime>=this.UNITS_REGISTER_DELAY){var u=q.trackingCode;q.trackingCode=null;this.registerImpression(u,q.registerUrl);}q.visible=r;q.heightBelow=s;q.lastShowTime=t;},prepareResize:function(){var q=function(r){var s=k.create('div',{className:'inner'}),t=k.create('div',{className:'wrapper'},s);k.replace(r,t);k.setContent(s,r);return t;};this.sections=k.scry(this.root,'div.ego_section').map(function(r){return {root:q(r),units:k.scry(r,'div.ego_unit').map(q)};});},processResize:function(){if(this.isLoading||this.lastLoadTime===0||this.availableDimensions===null){this.setLogData();return;}this.updateUnitsStatus();this.setLogData();var q=this.nextRegisterTime();if(q!==Infinity)this.processResize.bind(this).defer(q,true);},setIsLogAdData:function(q){this.isLogAdData=q;this.addEvent('setIsLogAdData',false);this.setLogData();},setLogData:function(){var q=this.snowlift.getImageId();if(this.isLogAdData&&q){var r=o.getElementDimensions(this.snowlift.getImage()),s=o.getElementDimensions(this.snowlift.getRHCHeader()),t=o.getElementDimensions(this.snowlift.getRHCBody()),u=o.getElementDimensions(this.snowlift.getRHCFooter()),v={query_set:this.snowlift.getLoadQuery().set,window_x:window.innerWidth,window_y:window.innerHeight,image_x:r.x,image_y:r.y,header_x:s.x,header_y:s.y,body_x:t.x,body_y:t.y,footer_x:u.x,footer_y:u.y,ads_below_space:this.getAdsBelowSpace(),time:Date.now(),adsStatus:this.adsStatus,adsEvents:this.adsEvents};l.updateAdData(q,v);}},getAdsBelowSpace:function(){var q=[],r=this.units[1];for(var s in r)if(r.hasOwnProperty(s))q.push(r[s].heightBelow);return q;},getIsAds:function(q){var r=k.scry(q,"div.-cx-PRIVATE-fbAdUnit__root");return r.length;},getUnitId:function(q){if(this.getIsAds(q)){return this.getAdId(q);}else return this.getEgoId(q);},getEgoId:function(q){var r=k.find(q,'div.fbEgoUnit'),s=r.getAttribute('data-ego'),t=JSON.parse(s).egoid;return t;},getAdId:function(q){var r=k.find(q,"div.-cx-PRIVATE-fbAdUnit__root"),s=r.getAttribute('data-ad'),t=JSON.parse(s).adid;return t;},nextRegisterTime:function(){var q=Infinity,r=g(g({},this.units[0]),this.units[1]);for(var s in r)if(r.hasOwnProperty(s)){var t=r[s];if(t.trackingCode!==null&&t.visible)q=Math.min(q,this.UNITS_REGISTER_DELAY-t.totalTime);}return q;},getHeight:function(q,r){var s=j.get(q,'height');if(s&&s.x===r)return s.y;return this.cacheHeight(q,r);},cacheHeight:function(q,r){var s={x:r,y:q.offsetHeight};j.set(q,'height',s);return s.y;},loadAdsAndEgo:function(){this.resetEvents();this.addEvent('adsRequested',true);m.loadFromEndpoint('WebEgoPane',this.root,{pid:34,data:[this.loadQuery.set,true,this.egoEnabled]},{crossPage:true,bundle:false});},unitsLoaded:function(q,r){var s;if(r){s='/ai.php';this.addEvent('adsLoaded',true);}else{s='/ajax/ei.php';this.addEvent('egoLoaded',true);}var t={};for(var u in q)if(q.hasOwnProperty(u))t[u]={trackingCode:q[u],totalTime:0,lastShowTime:0,heightBelow:-10000,visible:false,registerUrl:s};this.units[r]=t;if(r)this.waitForImages(this.imagesLoaded.bind(this));},imagesLoaded:function(){this.prepareResize();this.addEvent('imagesLoaded',true);this.lastLoadTime=Date.now();this.isLoading=false;this.processResize();h.removeClass(this.root,'loading');},loadAdsFromUserActivity:function(){var q=Date.now(),r=this.refreshUnitsRate;if(!this.isLoading&&q-this.lastLoadTime>r){h.addClass(this.root,'loading');this.isLoading=true;this.loadAdsAndEgo();}},registerImpression:function(q,r){var s=k.create('iframe',{src:n(r).addQueryData({aed:q}),width:0,height:0,frameborder:0,scrolling:'no',className:'fbEmuTracking'});s.setAttribute('aria-hidden','true');k.appendContent(this.root,s);},waitForImages:function(q){var r=k.scry(this.root,'img.img'),s=r.length,t=s;if(t===0)q();var u=function(){t--;if(t===0)q.defer();};for(var v=0;v<s;v++){var w=r[v];if(w.complete){u();}else Event.listen(w,{load:u,error:u,abort:u});}}};e.exports=p;});
__d("PhotoViewer",["Bootloader","copyProperties"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('copyProperties');function i(){this.image=null;this.root=null;this.stream=null;}h(i,{bootstrap:function(j,k){g.loadModules(['PhotoSnowlift'],function(l){l.bootstrap(j,k);});}});h(i.prototype,{getEventPrefix:bagof(null),getEventString:function(j){var k=this.getEventPrefix();if(k)return k+'.'+j;return null;},getImage:function(){return this.image;},getPosition:function(){return this.stream?this.stream.getCursor():null;},getRoot:function(){return this.root;},getSourceString:bagof(null),getVersionConst:bagof(null)});e.exports=i;});
__d("PhotoSnowlift",["array-extensions","event-extensions","function-extensions","Amoeba","Arbiter","AsyncDialog","AsyncRequest","Bootloader","Class","CSS","Dialog","DOM","DOMControl","DOMScroll","FullScreen","ImageUtils","KeyEventController","Keys","LinkController","Locale","PageTransitions","Parent","PhotosConst","PhotoSessionLog","PhotoSnowliftAds","PhotoStreamCache","PhotosUtils","PhotoViewer","Rect","ScrollableArea","Style","Toggler","UIPagelet","URI","UserAgent","Vector","$","computeRelativeURI","copyProperties","createArrayFrom","ge","goURI","tx","csx","userAction"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');b('function-extensions');var g=b('Amoeba'),h=b('Arbiter'),i=b('AsyncDialog'),j=b('AsyncRequest'),k=b('Bootloader'),l=b('Class'),m=b('CSS'),n=b('Dialog'),o=b('DOM'),p=b('DOMControl'),q=b('DOMScroll'),r=b('FullScreen'),s=b('ImageUtils'),t=b('KeyEventController'),u=b('Keys'),v=b('LinkController'),w=b('Locale'),x=b('PageTransitions'),y=b('Parent'),z=b('PhotosConst'),aa=b('PhotoSessionLog'),ba=b('PhotoSnowliftAds'),ca=b('PhotoStreamCache'),da=b('PhotosUtils'),ea=b('PhotoViewer'),fa=b('Rect'),ga=b('ScrollableArea'),ha=b('Style'),ia=b('Toggler'),ja=b('UIPagelet'),ka=b('URI'),la=b('UserAgent'),ma=b('Vector'),na=b('$'),oa=b('computeRelativeURI'),pa=b('copyProperties'),qa=b('createArrayFrom'),ra=b('ge'),sa=b('goURI'),ta=b('tx'),ua=b('csx'),va=b('userAction'),wa=b('event-extensions').$E;function xa(){this.parent.construct(this);}pa(xa,{STATE_ERROR:'error',STATE_HTML:'html',STATE_IMAGE_PIXELS:'image_pixels',STATE_IMAGE_DATA:'image',LOADING_TIMEOUT:2000,PAGER_FADE:3000,FULL_SCREEN_PADDING:10,STAGE_HIRES_MAX:{x:2048,y:2048},STAGE_NORMAL_MAX:{x:960,y:960},STAGE_MIN:{x:520,y:520},SIDEBAR_SIZE_MAX:340,SIDEBAR_SIZE_MIN:285,STAGE_CHROME:{x:102,y:42},VIDEO_BOTTOM_BAR_SPACE:40,GOPREV_AREA:120,TIMELINE_STRETCH_WIDTH:843,TIMELINE_STRETCH_MIN:480,MIN_TAG_DISTANCE:83,PADDING_MIN:40,_instance:null,getInstance:function(){if(!xa._instance)xa._instance=new xa();return xa._instance;},initInstance:function(ya,za){xa.getInstance().init(ya,za);},addPhotoFbids:function(ya,za,ab,bb){xa.getInstance().addPhotoFbids(ya,za,ab,bb);},attachFollowFlyout:function(ya){o.insertAfter(na('fbPhotoSnowliftSubscribe'),ya);},attachSubscribeFlyout:function(ya){o.insertAfter(na('fbPhotoSnowliftSubscribe'),ya);},attachTagger:function(ya){xa.getInstance().attachTagger(ya);},preload:function(ya,za){xa.getInstance().preload(ya,za);},bootstrap:function(ya,za){if(za.getAttribute('data-vaultbox')){k.loadModules(['VaultBox'],function(ab){ab.bootstrap(ya,za);});return;}if(ya&&ka(ya).getQueryData().hasOwnProperty('share_id')){k.loadModules(['SpotlightShareViewer'],function(ab){ab.bootstrap(ya,za);});return;}xa.getInstance().bootstrap(ya,za);},closeRefresh:function(){xa.getInstance().closeRefresh();},deletePhoto:function(ya){xa.getInstance().deletePhoto(ya);},getImage:function(){return xa.getInstance().getImage();},getImageId:function(){return xa.getInstance().getImageId();},getLoadQuery:function(){return xa.getInstance().getLoadQuery();},getRHCBody:function(){return xa.getInstance().getRHCBody();},getRHCFooter:function(){return xa.getInstance().getRHCFooter();},getRHCHeader:function(){return xa.getInstance().getRHCHeader();},getRoot:function(){return xa.getInstance().getRoot();},likePhotoSkipConfirmation:function(ya){xa.getInstance().likePhotoSkipConfirmation(ya);},saveTagsFromPayload:function(ya){xa.getInstance().saveTagsFromPayload(ya);},saveTagsFromPayloadDelayed:function(ya){xa.saveTagsFromPayload.curry(ya).defer(2000);},handleServerError:function(ya,za){xa.getInstance().handleServerError(ya,za);},storeFromData:function(ya){xa.getInstance().storeFromData(ya);},swapData:function(){xa.getInstance().swapData();},touchMarkup:bagofholding,updateTotalCount:function(ya,za,ab){xa.getInstance().updateTotalCount(ya,za,ab);}});l.extend(xa,ea);pa(xa.prototype,{switchTimer:null,imageRefreshTimer:null,imageLoadingTimer:null,lastPage:0,currentMinSize:null,extraClass:null,currentImageSize:null,resetUriStack:true,thumbSrc:null,shouldStretch:false,stageMax:xa.STAGE_NORMAL_MAX,stageChrome:xa.STAGE_CHROME,stagePagerPrev:null,ua:null,PhotoTagger:null,showHiRes:false,showHover:false,skipLikePhotoConfirmation:false,isShowingLikePhotoConfirmation:false,preload:function(ya,za){k.loadModules(['PhotoTagger','fb-photos-snowlift-css','Live','PhotoTagApproval','PhotoTags','TagTokenizer','fb-photos-snowlift-fullscreen-css'],function(bb){this.PhotoTagger=bb;}.bind(this));var ab=this.getImageSrc(ka(ya).getQueryData());if(ab)(new Image()).src=ab;},bootstrap:function(ya,za){this.preload(ya,za);ba.reset();this.resetUriStack=true;if(this.isOpen)if(this.openExplicitly){this.closeCleanup();this.resetUriStack=false;}else return;this.ua=va('snowlift',za,null,'FORCE').set_namespace('snowlift').set_ua_id('open');this.returningToStart=false;this.loading&&m.removeClass(this.loading,'loading');if(za){m.addClass((this.loading=za),'loading');this.getThumbAndSize(za);}else this.loading=null;h.inform('PhotoSnowlift.GO',ya,h.BEHAVIOR_STATE);this.loadFrameIfUninitialized();},getEventPrefix:function(){return 'PhotoSnowlift';},getRoot:function(){return this.root;},getSourceString:function(){return 'snowlift';},getVersionConst:function(){return z.VIEWER_SNOWLIFT;},getImage:function(){return this.image;},getImageId:function(){return this.stream.getCursor();},getRHCHeader:function(){return this.rhcHeader;},getRHCBody:function(){return this.ufiForm;},getRHCFooter:function(){return this.rhcFooter;},getLoadQuery:function(){return this.loadQuery;},getOwnerId:function(){var ya=this.stream.getCurrentImageData();if(ya)return ya.info.owner;return null;},getThumbAndSize:function(ya){this.currentImageSize=null;this.thumbSrc=null;var za=ka(ya.getAttribute('ajaxify')).getQueryData();if(!za.size)return;var ab=ma.deserialize(za.size);if(!ab.x||!ab.y)return;this.currentImageSize=ab;if(!m.hasClass(ya,'uiMediaThumb')&&!m.hasClass(ya,'uiPhotoThumb')&&!m.hasClass(ya,'uiScaledThumb'))return;if(ya.getAttribute('data-cropped'))return;var bb=o.scry(ya,'img')[0],cb=o.scry(ya,'i')[0],db=y.byAttribute(ya,'data-size');this.shouldStretch=db&&this.currentImageSize&&bb&&db.getAttribute('data-size')==="2"&&this.currentImageSize.x>this.currentImageSize.y&&this.currentImageSize.x<=xa.TIMELINE_STRETCH_WIDTH&&bb.offsetWidth===xa.TIMELINE_STRETCH_WIDTH;var eb;if(bb){eb=bb.src;}else if(cb){eb=ha.get(cb,'backgroundImage').replace(/.*url\("?([^"]*)"?\).*/,'$1');}else return;this.thumbSrc=eb;},loadFrameIfUninitialized:function(){if(this.root)return;new j('/ajax/photos/snowlift/init.php').setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();},init:function(ya,za){this.showHiRes=za.hires;this.showHover=za.pivot_hover;aa.setEndMetrics(za.pivot_end_metric);this.showEndPivot=za.pivot_end;this.fullscreen=za.hires&&r.isSupported();this.showOGVideos=za.og_videos;this.stageMax=this.showHiRes?xa.STAGE_HIRES_MAX:xa.STAGE_NORMAL_MAX;var ab=ra('fbPhotoSnowlift');if(!ab){ab=o.appendContent(document.body,ya)[0];this.initialLoad=false;}if(this.root==ab)return;this.initializeNodes(ab);ba.init(this.sideAdUnit,this,za);if(!this.subscription){v.registerHandler(this.handleNavigateAway.bind(this));this.subscription=h.subscribe('PhotoSnowlift.GO',function(bb,cb){this.openExplicitly=true;this.loading&&m.removeClass(this.loading,'loading');this.open(cb);}.bind(this));}this.transitionHandlerRegistered=false;this.returningToStart=false;x.registerHandler(this.openHandler.bind(this));this.openHandlerRegistered=true;h.subscribe('PhotoTagApproval.HILITE_TAG',this.onHiliteTag.bind(this));h.subscribe('PhotoTagApproval.UPDATE_TAG_BOX',this.onUpdateTagBox.bind(this));if(this.fullscreen)r.subscribe('changed',this.onFullScreenChange.bind(this));},onFullScreenChange:function(){if(r.isFullScreen()){if(!m.hasClass(this.root,'fbPhotoSnowliftEditMode'))this.collapseRHC();var ya=this.stream.getCurrentImageData();if(ya&&ya.url&&this.image.src!==ya.url&&this.shouldShowHiRes(ya))this.switchImage(ya.url);this.adjustForResize();}else this.uncollapseRHC();ia.hide();},initializeNodes:function(ya){this.root=ya;this.container=o.find(ya,'div.fbPhotoSnowliftContainer');g.instrument(this.container,'snowlift');this.snowliftPopup=o.find(this.container,'div.fbPhotoSnowliftPopup');this.rhc=o.find(this.snowliftPopup,'div.rhc');this.rhcHeader=o.find(this.rhc,'div.rhcHeader');this.rhcFooter=o.find(this.rhc,'div.rhcFooter');this.ufiForm=o.find(this.rhc,'form.fbPhotosSnowliftFeedbackForm');this.ufiInputContainer=na('fbPhotoSnowliftFeedbackInput');this.scroller=o.find(this.ufiForm,'div.rhcScroller');this.scrollerBody=o.find(this.scroller,'div.uiScrollableAreaBody');this.stageWrapper=o.find(this.snowliftPopup,'div.stageWrapper');this.overlay=o.find(this.snowliftPopup,'div.snowliftOverlay');this.errorBox=o.find(this.stageWrapper,'div.stageError');this.image=o.find(this.stageWrapper,'img.spotlight');this.stage=o.find(this.stageWrapper,'div.stage');this.videoStage=o.find(this.stageWrapper,'div.videoStage');this.prevPager=o.find(this.snowliftPopup,'a.snowliftPager.prev');g.instrument(this.prevPager,"prev_pager");this.nextPager=o.find(this.snowliftPopup,'a.snowliftPager.next');g.instrument(this.nextPager,"next_pager");this.stageActions=o.find(ya,'div.stageActions');this.buttonActions=o.find(this.stageActions,'div.fbPhotosPhotoButtons');this.sideAdUnit=o.find(ya,".-cx-PRIVATE-snowliftAds__root");m.conditionClass(this.root,'fullScreenAvailable',this.fullscreen);},initializeScroller:function(){this.initializeScroller=bagofholding;this.scrollableArea=ga.fromNative(this.scroller,{fade:true,persistent:true});var ya=function(event){var za=wa(event).getTarget();if(o.contains(this.ufiInputContainer,za)){var ab=p.getInstance(za);if(ab){this.scrollableArea.scrollToBottom();var bb=ab.subscribe('resize',function(){var db=this.scrollableArea.isScrolledToBottom();this.adjustScroller();db&&this.scrollableArea.scrollToBottom();}.bind(this)),cb=Event.listen(za,'blur',function(){ab.unsubscribe(bb);cb.remove();});}}}.bind(this);h.subscribe('ufi/comment',function(za,ab){if(this.ufiForm===ab.form){this.adjustScrollerIfNecessary();this.scrollableArea.scrollToBottom();}}.bind(this));Event.listen(this.rhc,'click',function(event){var za=event.getTarget();if(y.byTag(za,'a')||y.byTag(za,'button')||o.isNodeOfType(za,'input'))this.adjustScrollerIfNecessary();}.bind(this));h.subscribe('reflow',function(){if(this.isOpen)this.adjustScroller();}.bind(this));h.subscribe(['reflow','CommentUFI.Pager'],function(){if(this.isOpen)this.adjustScroller();}.bind(this));if(this.ufiForm.attachEvent){this.ufiForm.attachEvent('onfocusin',ya);}else this.ufiForm.addEventListener('focus',ya,true);},openHandler:function(ya){if(this.isOpen||ya.getPath()!='/photo.php'||this.returningToStart||ya.getQueryData().closeTheater||ya.getQueryData().permPage||ya.getQueryData().makeprofile){this.openHandlerRegistered=false;return false;}this.open(ya);this._uriStack.push(ka(ya).getQualifiedURI().toString());x.transitionComplete();return true;},getImageSrc:function(ya){if(ya.smallsrc){if(!ya.size)return ya.smallsrc;var za=ma.deserialize(ya.size),ab=this.getStageSize(za);if(ab.x<=xa.STAGE_NORMAL_MAX.x&&ab.y<=xa.STAGE_NORMAL_MAX.y)return ya.smallsrc;}return ya.src;},open:function(ya){var za=ka(ya).getQueryData(),ab=this.getImageSrc(za);if(ab){delete za.src;delete za.smallsrc;}if(this.resetUriStack)this._uriStack=[];if(!this.initialLoad){za.firstLoad=true;this.initialLoad=true;}this.sessionID=Date.now();this.loadQuery=pa(za,{ssid:this.sessionID});this.isOpen=true;this.pagersShown=false;this.refreshOnClose=false;this.hilitedTag=null;this.loadingStates={image:false,html:false};this.replaceUrl=false;this.stream=new ca();this.stream.init(z.VIEWER_SNOWLIFT,'PhotoViewerPagelet');this.fetchInitialData();this.setLoadingState(xa.STATE_HTML,true);this.rhcCollapsed=false;this.keyHandlers=[t.registerKey('ESCAPE',this.closeListener.bind(this))];k.loadModules(['fb-photos-snowlift-css'],this._open.bind(this,ya,ab));if(this.showEndPivot)k.loadModules(['PhotoPivot'],function(bb){this.pivots=bb.getInstance();if(za.relevant_count)this.pivots.setRelevantCount(za.relevant_count);}.bind(this));k.loadModules(['PhotosButtonTooltips'],function(bb){bb.init();});},_open:function(ya,za){this.createLoader(za);m.show(this.root);(function(){var cb=ma.getScrollPosition();m.addClass(document.documentElement,'theaterMode');var db=q.getScrollbarSize();if(db===0){this.extraClass='zeroScrollbar';}else if(db===20){this.extraClass='scrollbar20';}else this.extraClass='defaultScrollbar';m.addClass(document.body,this.extraClass);q.scrollTo(cb,0);}).defer();this.ua&&this.ua.add_event('frame');h.inform('layer_shown',{type:'PhotoSnowlift'});h.inform('PhotoSnowlift.OPEN');this.stageHandlers=[Event.listen(window,'resize',this.adjustForResize.bind(this)),Event.listen(this.root,'click',this.closeListener.bind(this)),Event.listen(this.stageWrapper,'click',this.buttonListener.bind(this)),Event.listen(this.stageWrapper,'mouseleave',function(event){this.unhiliteAllTags();this.hidePagers();}.bind(this)),Event.listen(this.stageWrapper,'mousemove',this.hilitePagerOnMouseMove.bind(this)),Event.listen(this.stageWrapper,'mousemove',this.hiliteTagsOnMouseMove.bind(this)),Event.listen(this.overlay,'mouseenter',this.unhiliteAllTags.bind(this))];this.stageHandlers.push(Event.listen(this.container,'click',(function(event){var cb=event.getTarget();if(y.byClass(cb,'rotateRight')){this.rotate('right');}else if(y.byClass(cb,'rotateLeft')){this.rotate('left');}else if(this.fullscreen)if(y.byClass(cb,'fbPhotoSnowliftFullScreen')){this.toggleFullScreen();}else if(y.byClass(cb,'fbPhotoSnowliftCollapse'))this.toggleCollapse();}).bind(this)));var ab=ra('fbPhotoSnowliftFeedback');if(ab)this.stageHandlers.push(Event.listen(ab,'click',function(event){if(y.byClass(event.getTarget(),'like_link')||y.byClass(event.getTarget(),'UFILikeLink'))this.toggleLikeButton();var cb=y.byClass(event.getTarget(),'uiUfiCollapsedComment');if(cb)m.addClass(cb,'uiUfiCollapsedCommentToggle');}.bind(this)));var bb=ra('fbPhotoSnowliftOnProfile');if(bb)this.stageHandlers.push(Event.listen(bb,'click',function(event){if(y.byClass(event.getTarget(),'fbPhotoRemoveFromProfileLink'))this.refreshOnClose=true;}.bind(this)));if(this.resetUriStack)this.startingURI=ka.getMostRecentURI().addQueryData({closeTheater:1}).getUnqualifiedURI();if(!za)this.setLoadingState(xa.STATE_IMAGE_DATA,true);if(!this.transitionHandlerRegistered){x.registerHandler(this.transitionHandler.bind(this));this.transitionHandlerRegistered=true;}aa.initLogging(aa.SNOWLIFT);if(this.pivots)aa.setRelevantCount(this.pivots.relevantCount);if(la.firefox()<13)this.turnFlashAutoplayOff.defer();(function(){this.root.focus();}).bind(this).defer();},toggleFullScreen:function(){var ya=r.toggleFullScreen(document.documentElement);if(ya){var za=this.stream.getCurrentImageData();if(za&&za.url&&this.image.src!==za.url&&this.shouldShowHiRes(za))(new Image()).src=za.url;aa.logEnterFullScreen(this.stream.getCursor());}},getStream:function(){return this.stream;},fetchInitialData:function(){this.ua&&this.ua.add_event('init_data');this.stream.waitForInitData();ja.loadFromEndpoint('PhotoViewerInitPagelet',null,this.loadQuery,{usePipe:true,jsNonblock:true,crossPage:true});},turnFlashAutoplayOff:function(){o.scry(document,'div.swfObject').forEach(function(ya){var za=ya.getAttribute('data-swfid');if(za&&window[za]){var ab=window[za];ab.addParam('autostart','false');ab.addParam('autoplay','false');ab.addParam('play','false');ab.addVariable('video_autoplay','0');ab.addVariable('autoplay','0');ab.addVariable('play','0');var bb=ka(ab.getAttribute('swf'));bb.addQueryData({autoplay:'0'});bb.setPath(bb.getPath().replace('autoplay=1','autoplay=0'));ab.setAttribute('swf',bb.toString());ab.write(ya);}});},toggleCollapse:function(){if(this.rhcCollapsed){this.uncollapseRHC();}else this.collapseRHC();},collapseRHC:function(){this.rhcCollapsed=true;m.addClass(this.root,'collapseRHC');this.adjustForResize();},uncollapseRHC:function(){this.rhcCollapsed=false;m.removeClass(this.root,'collapseRHC');this.adjustForResize();},closeHandler:function(){if(!this.isOpen)return;if(ka.getMostRecentURI().addQueryData({closeTheater:1}).getUnqualifiedURI().toString()==this.startingURI.toString()){this.close();return;}this.close();this.returnToStartingURI(this.refreshOnClose);},returnToStartingURI:function(ya,za){if(!ya)if(za){this.squashNextTransition(sa.curry(za));}else this.squashNextTransition();this.returningToStart=true;var ab=h.subscribe('page_transition',function(){this.returningToStart=false;ab.unsubscribe();}),bb=ya||isNaN(la.opera()),cb=this._uriStack.length;if(bb&&cb<window.history.length){window.history.go(-cb);}else{var db=this.startingURI,eb=new ka(db).removeQueryData('closeTheater');if(db.getQueryData().sk=='approve'&&db.getPath()=='/profile.php'){eb.removeQueryData('highlight');eb.removeQueryData('notif_t');}sa(eb);}},squashNextTransition:function(ya){this.squashNext=true;x.registerHandler(function za(){if(this.squashNext){this.squashNext=false;if(ya)ya.defer();x.transitionComplete();return true;}return false;}.bind(this),7);},handleNavigateAway:function(ya){var za=oa(x._most_recent_uri.getQualifiedURI(),ya.getAttribute('href'));if(this.isOpen&&(za instanceof ka)&&za.getUnqualifiedURI().toString()!=this.startingURI.toString()&&za.getPath()!='/photo.php'){if(!this.closingAction)this.closingAction=aa.NAVIGATE;this.close();this.returnToStartingURI(false,za);return false;}return true;},closeListener:function(event){if(this.isOpen&&!n.getCurrent()){if(Event.getKeyCode(event)==u.ESC){if(!m.hasClass(this.root,'taggingMode')&&!m.hasClass(this.root,'fbPhotoSnowliftEditMode')){this.closingAction=aa.ESC;Event.kill(event);this.closeHandler();}return;}var ya=event.getTarget(),za=y.byClass(ya,'closeTheater'),ab=za||ya==this.root||ya==o.find(this.root,'div.fbPhotoSnowliftOuter')||ya==o.find(this.root,'div.fbPhotoSnowliftInner');if(ab){if(r.isFullScreen()){if(za)r.toggleFullScreen();return;}if(za){this.closingAction=aa.X;}else this.closingAction=aa.OUTSIDE;Event.kill(event);this.closeHandler();}}},close:function(){if(!this.isOpen)return;if(this.fullscreen)r.disableFullScreen();va('snowlift',null,null,'FORCE').set_namespace('snowlift').set_ua_id('close');m.hide(this.root);this.openExplicitly=false;this.closeCleanup.bind(this).defer();},closeCleanup:function(){var ya=ma.getScrollPosition();m.removeClass(document.documentElement,'theaterMode');m.removeClass(document.body,this.extraClass);q.scrollTo(ya,0);m.removeClass(this.root,'dataLoaded');this.keyHandlers.forEach(function(ab){ab.remove();});this.keyHandlers=null;aa.logPhotoViews(this.closingAction);this.destroy();m.hide(this.errorBox);m.hide(this.image);this.currentImageSize=null;this.thumbSrc=null;this.shouldStretch=false;this.resetUriStack=true;m.removeClass(this.stageWrapper,'showVideo');o.empty(this.videoStage);this.uncollapseRHC();this.currentMinSize=null;this.setStagePagersState('reset');this.recacheData();o.empty(this.sideAdUnit);this.stream.destroy();var za=this.closingAction===aa.NAVIGATE;this.closingAction=null;if(!this.openHandlerRegistered){x.registerHandler(this.openHandler.bind(this));this.openHandlerRegistered=true;}h.inform('layer_hidden',{type:'PhotoSnowlift'});h.inform('PhotoSnowlift.CLOSE',za);this.root.setAttribute('aria-busy','true');this.isOpen=false;},createLoader:function(ya){if(this.currentImageSize===null){this.adjustStageSize(xa.STAGE_MIN);}else{var za=this.getStageSize(this.currentImageSize);za=new ma(Math.max(za.x,xa.STAGE_MIN.x),Math.max(za.y,xa.STAGE_MIN.y));var ab=this.getImageSizeInStage(this.currentImageSize,za);if(this.thumbSrc===null){this.adjustStageSize(ab);}else this.useImage(o.create('img',{className:'spotlight',alt:'',src:this.thumbSrc,style:{width:ab.x+'px',height:ab.y+'px'}}),ab,false);}this.setLoadingState(this.STATE_IMAGE_PIXELS,true);if(ya)(function(){var bb=new Image();bb.onload=a.async_callback(function(){if(!this.isOpen||this.pendingImageUrl!=ya)return;if(!this.stream||!this.stream.errorInCurrent()){this.switchImage(ya,this.currentImageSize);this.ua&&this.ua.add_event('image');this.setLoadingState(xa.STATE_IMAGE_DATA,false);}}.bind(this),'photo_theater');bb.src=this.pendingImageUrl=ya;}).bind(this).defer();m.hide(this.stageActions);this.setStagePagersState('disabled');},initDataFetched:function(ya){aa.setPhotoSet(this.stream.getPhotoSet());aa.setLogFbids(ya.logids);var za=this.stream.getCurrentImageData();aa.addPhotoView(za.info,this.shouldShowHiRes(za),this.fullscreen&&r.isFullScreen());if(!this.pageHandlers){this.pageHandlers=[Event.listen(this.root,'click',this.pageListener.bind(this)),Event.listen(this.root,'mouseleave',this.mouseLeaveListener.bind(this))];this.keyHandlers=this.keyHandlers.concat([t.registerKey('LEFT',this.pageListener.bind(this)),t.registerKey('RIGHT',this.pageListener.bind(this)),t.registerKey('L',this.likePhotoWithKey.bind(this),function(event,ab){event=wa(event);return (ab=='onkeyup'&&t.filterEventTargets(event,ab)&&t.filterEventModifiers(event,ab));})]);}m.show(this.stageActions);this.root.setAttribute('aria-busy','false');this.isLoggedInViewer=ya.loggedin;this.disableAds=!this.isLoggedInViewer||ya.fromad;this.loadAds();},adjustScrollerIfNecessary:function(){clearTimeout(this.scrollerTimeout);this.scrollerTimeout=this.adjustScroller.bind(this).defer();},adjustScroller:function(){clearTimeout(this.scrollerTimeout);this.initializeScroller();this.scrollableArea.resize();var ya=ma.getElementDimensions(this.rhc),za=ya.y;za-=ma.getElementDimensions(this.rhcHeader).y;za-=ma.getElementDimensions(this.ufiInputContainer).y;var ab=ma.getElementDimensions(this.scrollerBody).y;if(ab>=za){ha.set(this.scroller,'height',za+'px');m.addClass(this.rhc,'pinnedUfi');za=0;}else{ha.set(this.scroller,'height','auto');m.removeClass(this.rhc,'pinnedUfi');za-=ab;}var bb=ma.getElementDimensions(this.ufiInputContainer).y;ha.set(this.ufiForm,'padding-bottom',bb+'px');ba.resize(new ma(ya.x,za));this.scrollableArea.adjustGripper();},adjustForResize:function(){this.currentMinSize=null;this.adjustStageSize();this.adjustForNewData();},shouldShowHiRes:function(ya){if(!this.showHiRes||!ya||!ya.smallurl)return false;var za=this.getStageSize(ya.dimensions),ab=this.getImageSizeInStage(ya.dimensions,za);return (ab.x>xa.STAGE_NORMAL_MAX.x||ab.y>xa.STAGE_NORMAL_MAX.y);},getImageURL:function(ya){if(ya.video){return null;}else if(ya.smallurl&&!this.shouldShowHiRes(ya))return ya.smallurl;return ya.url;},getImageDimensions:function(ya){if(ya.smalldims&&(!this.shouldShowHiRes(ya)||this.image.src===ya.smallurl))return ya.smalldims;return ya.dimensions;},getStageSize:function(ya,za){var ab=ma.getViewportDimensions(),bb=new ma(ya.x,ya.y);if(za)bb=new ma(Math.max(ya.x,za.x),Math.max(ya.y,za.y));var cb,db;if(this.fullscreen&&r.isFullScreen()){return new ma((this.rhcCollapsed?screen.width:screen.width-xa.SIDEBAR_SIZE_MAX),screen.height-xa.FULL_SCREEN_PADDING*2);}else{cb=Math.min(bb.x,this.stageMax.x,(ab.x-xa.SIDEBAR_SIZE_MAX-xa.STAGE_CHROME.x));db=Math.min(bb.y,this.stageMax.y,ab.y-xa.STAGE_CHROME.y);}if(cb===0&&db===0)return new ma(0,0);var eb=cb/db,fb=bb.x/bb.y;if(eb<fb)return new ma(cb,Math.ceil(cb/fb));return new ma(Math.ceil(db*fb),db);},getImageSizeInStage:function(ya,za){var ab=ya.x,bb=ya.y;if(ab>=za.x||bb>=za.y){var cb=za.x/za.y,db=ab/bb;if(cb<db){ab=za.x;bb=Math.ceil(ab/db);}else if(cb>db){bb=za.y;ab=Math.ceil(bb*db);}else{ab=za.x;bb=za.y;}}return new ma(ab,bb);},adjustStageSize:function(ya){var za=this.currentImageSize;if(ya){za=ya;}else{var ab=this.stream&&this.stream.getCurrentImageData();if(ab)za=this.getImageDimensions(ab);}if(!za)return;this.currentImageSize=za;var bb=0;if(this.shouldStretch&&!this.getVideoOnStage()&&za.x>za.y&&za.x<=xa.TIMELINE_STRETCH_WIDTH&&za.x>=xa.TIMELINE_STRETCH_MIN){za.y=Math.round(za.y*xa.TIMELINE_STRETCH_WIDTH/za.x);za.x=xa.TIMELINE_STRETCH_WIDTH;}else if(this.getVideoOnStage()){bb=xa.VIDEO_BOTTOM_BAR_SPACE*2;za.y+=bb;}var cb=this.getStageSize(za,this.currentMinSize);if(!this.currentMinSize)this.currentMinSize=new ma(0,0);this.currentMinSize=new ma(Math.max(cb.x,xa.STAGE_MIN.x,this.currentMinSize.x),Math.max(cb.y,xa.STAGE_MIN.y,this.currentMinSize.y));var db=this.getImageSizeInStage(za,this.currentMinSize),eb=this.currentMinSize.x-db.x,fb=this.currentMinSize.y-db.y;if(eb>0&&eb<xa.PADDING_MIN){this.currentMinSize.x-=eb;}else if(fb>0&&fb<xa.PADDING_MIN)this.currentMinSize.y-=fb;var gb=this.currentMinSize.x+xa.SIDEBAR_SIZE_MAX;if(this.rhcCollapsed)gb=this.currentMinSize.x;this.snowliftPopup.style.cssText='width:'+gb+'px;'+'height:'+this.currentMinSize.y+'px;';var hb=this.currentMinSize.y-bb+'px';if(la.firefox()||la.ie()<8){var ib=ha.get(this.stageWrapper,'font-size');if(la.ie()&&ib.indexOf('px')<0){var jb=o.create('div');jb.style.fontSize=ib;jb.style.height='1em';ib=jb.style.pixelHeight;}hb=((this.currentMinSize.y-bb)/parseFloat(ib))+'em';}this.stageWrapper.style.cssText='width:'+this.currentMinSize.x+'px;'+'line-height:'+hb+';';if(la.ie()<8){ha.set(this.root,'height',ma.getViewportDimensions().y+'px');ha.set(this.container,'min-height',(this.currentMinSize.y+xa.STAGE_CHROME.y)+'px');}this.image.style.cssText='width:'+db.x+'px;'+'height:'+db.y+'px;';this.adjustScrollerIfNecessary();},adjustForNewData:function(){if(!this.image)return;var ya=o.scry(this.stage,'div.tagsWrapper')[0],za=ma.getElementDimensions(this.image);if(ya){ha.set(ya,'width',za.x+'px');ha.set(ya,'height',za.y+'px');if(la.ie()<=7){var ab=o.scry(this.root,'div.tagContainer')[0];if(ab)m.conditionClass(ya,'ie7VerticalFix',ma.getElementDimensions(ab).y>za.y);}}},setLoadingState:function(ya,za){switch(ya){case xa.STATE_IMAGE_PIXELS:m.conditionClass(this.root,'imagePixelsLoading',za);break;case xa.STATE_IMAGE_DATA:this.loadingStates[ya]=za;m.conditionClass(this.root,'imageLoading',za);break;case xa.STATE_HTML:this.loadingStates[ya]=za;m.conditionClass(this.root,'dataLoading',za);this.rhc.setAttribute('aria-busy',za?'true':'false');break;}},destroy:function(){this.stageHandlers.forEach(function(ya){ya.remove();});if(this.pageHandlers){this.pageHandlers.forEach(function(ya){ya.remove();});this.pageHandlers=null;}},checkState:function(ya){if(ya!=xa.STATE_ERROR&&!this.loadingStates[ya])return;switch(ya){case xa.STATE_IMAGE_DATA:var za=this.stream.getCurrentImageData();if(za){var ab=this.getImageURL(za);if(ab){this.switchImage(ab,null,true);}else if(za.video)this.switchVideo(za.video,true);this.setLoadingState(ya,false);}break;case xa.STATE_HTML:if(this.stream.getCurrentHtml()){this.swapData();this.setLoadingState(ya,false);}break;default:if(this.stream.errorInCurrent()){m.hide(this.image);m.show(this.errorBox);}break;}},buttonListener:function(event){var ya=event.getTarget(),za=Date.now();if(y.byClass(ya,'fbPhotoTagApprovalBox'))return;if(za-this.lastPage<350)return;if(y.byClass(ya,'fbPhotosPhotoLike')){this.likePhoto();}else if(y.byClass(ya,'tagApproveIgnore'))this.updateTagBox(event,ya);},likePhoto:function(){aa.addButtonLike();var ya=na('fbPhotoSnowliftFeedback'),za=o.scry(ya,'button.like_link')[0];if(!za)za=o.scry(ya,'a.UFILikeLink')[0];za.click();},toggleLikeButton:function(){var ya=o.scry(this.buttonActions,'a.fbPhotosPhotoLike')[0];if(ya){m.toggleClass(ya,'viewerLikesThis');m.removeClass(ya,'viewerAlreadyLikedThis');}},likePhotoWithKey:function(){if(this.isShowingLikePhotoConfirmation)return;if(this.skipLikePhotoConfirmation){this.likePhoto();}else i.send(new j('/photos/confirm_like.php'),function(ya){this.isShowingLikePhotoConfirmation=true;ya.subscribe('confirm',this.onCloseLikePhotoConfirmDialog.bind(this));ya.subscribe('cancel',this.onCloseLikePhotoConfirmDialog.bind(this));}.bind(this));return false;},likePhotoSkipConfirmation:function(ya){this.skipLikePhotoConfirmation=ya;this.likePhoto();},onCloseLikePhotoConfirmDialog:function(){this.isShowingLikePhotoConfirmation=false;},updateTagBox:function(ya,za){this.unhiliteAllTags();var ab=ra(ya);if(!ab)return;m.addClass(ab,'tagBox');m.addClass(ab,'tagBoxPendingResponse');m.removeClass(ab,'tagBoxPending');m.hide(o.find(ab,'span.tagForm'));if(za){m.show(o.find(ab,'span.tagApproved'));}else m.show(o.find(ab,'span.tagIgnored'));},rotate:function(ya){var za=this.stream.getCursor();if(this.getVideoOnStage()){var ab=(ya=='left')?270:90;k.loadModules(['VideoRotate'],function(cb){new cb(za).motionRotate(ab);});return;}var bb=pa({fbid:za,cs_ver:z.VIEWER_SNOWLIFT},this.stream.getPhotoSetQuery());bb[ya]=1;this.setLoadingState(xa.STATE_IMAGE_DATA,true);this.setLoadingState(this.STATE_IMAGE_PIXELS,true);m.hide(this.image);new j('/ajax/photos/photo/rotate/').setAllowCrossPageTransition(true).setData(bb).setErrorHandler(this.rotationError.bind(this,za)).setFinallyHandler(this.rotationComplete.bind(this,za)).setMethod('POST').setReadOnly(false).send();},rotationComplete:function(ya,za){if(ya==this.stream.getCursor()){this.setLoadingState(xa.STATE_IMAGE_DATA,false);this.switchImage(this.getImageURL(this.stream.getCurrentImageData()));this.swapData();}},rotationError:function(ya,za){if(ya==this.stream.getCursor()){this.setLoadingState(xa.STATE_IMAGE_DATA,false);this.switchImage(this.getImageURL(this.stream.getCurrentImageData()));k.loadModules(['AsyncResponse'],function(ab){ab.defaultErrorHandler(za);});}},saveTagsFromPayload:function(ya){this.storeFromData(ya);if('data' in ya&&this.stream.getCursor() in ya.data)this.swapData();},saveEdit:function(){if(!m.hasClass(this.root,'fbPhotoSnowliftEditMode'))return;k.loadModules(['PhotoInlineEditor','Form'],function(ya,za){var ab=ya.getInstance(this.getViewerConst());ab&&za.bootstrap(ab.getForm().controller);}.bind(this));},mouseLeaveListener:function(event){this.unhiliteAllTags();this.reHilitePendingTag();},hilitePagerOnMouseMove:function(event){var ya=ma.getEventPosition(event),za=ma.getElementPosition(this.stage);if(w.isRTL()){var ab=ma.getElementDimensions(this.stage);this.stagePagerPrev=ab.x-(ya.x-za.x)<xa.GOPREV_AREA;}else this.stagePagerPrev=ya.x-za.x<xa.GOPREV_AREA;m.conditionClass(this.prevPager,'hilightPager',this.stagePagerPrev);m.conditionClass(this.nextPager,'hilightPager',!this.stagePagerPrev);var bb,cb=event.getTarget();if(!y.byClass(cb,'snowliftOverlay')&&!y.byClass(cb,'bottomBarActions')&&!y.byClass(cb,'snowliftPager'))bb=xa.PAGER_FADE;this.showPagers(bb);},showPagers:function(ya){clearTimeout(this.fadePagerTimer);this.setStagePagersState('active');if(typeof ya!=='undefined')this.fadePagerTimer=this.hidePagers.bind(this).defer(ya);},hidePagers:function(){var ya=o.scry(this.getRoot(),'.fbPhotosPhotoActionsMenu')[0];if(ya)return;clearTimeout(this.fadePagerTimer);this.setStagePagersState('inactive');},getTagger:function(){if(!this.PhotoTagger)return null;var ya=this.PhotoTagger.getInstance(z.VIEWER_SNOWLIFT);if(!ya||!ya.tagHoverFacebox)return null;return ya;},unhiliteAllTags:function(){o.scry(this.stage,'div.tagsWrapper div.hover').forEach(function(za){m.removeClass(za,'hover');});this.hilitedTag=null;if(!m.hasClass(this.root,'taggingMode')){var ya=this.getTagger();if(ya){ya.hideTagger();ya.setCurrentFacebox(null);}}},switchHilitedTags:function(ya,za){if(this.switchTimer!==null){clearTimeout(this.switchTimer);this.switchTimer=null;}this.unhiliteAllTags();var ab=ra(ya);if(ab){this.hilitedTag=ya;if(!m.hasClass(this.root,'taggingMode')&&da.isFacebox(this.hilitedTag)){var bb=this.getTagger();if(bb){m.addClass(ab,'hover');var cb=bb.getFacebox(ya);bb.setCurrentFacebox(cb);if(cb)bb.addTagFromFacebox(cb);}}else m.addClass(ab,'hover');if(m.hasClass(ab,'tagBoxPending')&&!m.hasClass(ab,'showPendingTagName')&&za===true){o.scry(this.stage,'div.tagsWrapper div.showPendingTagName').forEach(function(db){m.removeClass(db,'showPendingTagName');});m.addClass(ab,'showPendingTagName');}}},reHilitePendingTag:function(){var ya=ra(this.hilitedTag);if(ya&&m.hasClass(ya,'showPendingTagName'))return;var za=o.scry(this.stage,'div.tagsWrapper div.showPendingTagName')[0];if(za)this.switchHilitedTags(za.id);},hiliteTagsOnMouseMove:function(event){if(!this.stream.getCurrentExtraData()||this.getVideoOnStage())return;if(this.switchTimer!==null)return;var ya=event.getTarget();if(y.byClass(ya,'snowliftOverlay')||y.byClass(ya,'fbPhotoSnowliftTagApproval')||y.byClass(ya,'tagPointer')||y.byClass(ya,'photoTagTypeahead'))return;var za=y.byClass(ya,'tagBoxPending'),ab=false;if(this.hilitedTag){var bb=ra(this.hilitedTag);ab=bb&&m.hasClass(bb,'tagBoxPending');}var cb=((!this.hilitedTag&&za)||(!ab&&za));if(cb){this.switchHilitedTags(za.id);return;}if(za&&(za.id==this.hilitedTag))return;var db=250,eb=da.absoluteToNormalizedPosition(this.image,ma.getEventPosition(event));if(this.currentTagHasPrecedence(eb))return;var fb=da.getNearestBox(this.stream.getCurrentExtraData().tagRects,eb);if(!fb){if(!ab){this.unhiliteAllTags();this.reHilitePendingTag();}return;}var gb=null;if(ab){var hb={};hb[this.hilitedTag]=this.stream.getCurrentExtraData().tagRects[this.hilitedTag];gb=da.getNearestBox(hb,eb);}if(gb!==null&&ab)return;if(this.hilitedTag!=fb)if(ab){this.switchTimer=this.switchHilitedTags.bind(this,fb).defer(db);}else{if(this.showHover){if(!this.seenTags)this.seenTags=[];if(!this.seenTags[fb]){aa.addFaceTagImpression();this.seenTags[fb]=true;}}this.switchHilitedTags(fb);}},currentTagHasPrecedence:function(ya){if(!this.hilitedTag)return false;var za=this.stream.getCurrentExtraData().tagRects[this.hilitedTag],ab=new fa(za.t+(za.h()/2),za.r,za.b+(da.isFacebox(this.hilitedTag)?10:0),za.l,za.domain);return ab.contains(ya);},getVideoOnStage:function(){var ya=this.stream&&this.stream.getCurrentImageData();return ya&&ya.video;},shouldPageOnAction:function(ya,za){if(!this.isOpen||this.isShowingLikePhotoConfirmation)return false;var ab=o.isNode(za)&&(y.byClass(za,'snowliftPager')||y.byClass(za,'stagePagers')||y.byClass(za,'pivotPageColumn')),bb=o.isNode(za)&&y.byClass(za,'stage'),cb=m.hasClass(za,'faceBox'),db=((bb&&m.hasClass(this.root,'taggingMode'))||y.byClass(za,'tagBoxPending')||y.byClass(za,'tagBoxPendingResponse')||y.byClass(za,'fbPhotoTagApprovalBox')||y.byClass(za,'tag'));if(db)return false;return ya==u.LEFT||ya==u.RIGHT||(!m.hasClass(this.root,'taggingMode')&&cb)||ab||bb;},pageListener:function(event){var ya=Event.getKeyCode(event),za=event.getTarget();if(!this.shouldPageOnAction(ya,za))return;var ab=0;if(ya==u.RIGHT){ab=1;aa.setPagingAction('key_right');}else if(ya==u.LEFT){ab=-1;aa.setPagingAction('key_left');}else if(y.byClass(za,'next')){ab=1;aa.setPagingAction('click_next');}else if(y.byClass(za,'prev')){ab=-1;aa.setPagingAction('click_prev');}else if(!this.stagePagerPrev){ab=1;aa.setPagingAction('click_stage');}else{ab=-1;aa.setPagingAction('click_stage_back');}if(m.hasClass(this.root,'fbPhotoSnowliftEditMode')){this.warnLeavePage(ab);}else{this.page(ab);va('a',za,event,'FORCE').set_namespace('snowlift').set_ua_id(aa.pagingAction);}},warnLeavePage:function(ya){new n().setTitle("Are you sure you want to leave this page?").setBody("You have unsaved changes that will be lost if you leave the page.").setButtons([{name:'leave_page',label:"Leave this Page",handler:this.page.bind(this,ya)},{name:'continue_editing',label:"Stay on this Page",className:'inputaux'}]).setModal(true).show();},page:function(ya,za){if(!this.stream.isValidMovement(ya)){this.showPagers(xa.PAGER_FADE);return;}this.lastPage=Date.now();this.unhiliteAllTags();this.seenTags=[];var ab=this.getVideoOnStage();if(ab)this.switchVideo(ab,false);if(this.pivots&&this.pivots.page(ya))return;h.inform('PhotoSnowlift.PAGE');ia.hide();this.recacheData();this.stream.moveCursor(ya);m.hide(this.image);if(this.stream.errorInCurrent()){this.setLoadingState(xa.STATE_HTML,true);m.show(this.errorBox);return;}var bb=this.stream.getCurrentImageData();if(bb){var cb=this.getImageURL(bb);if(cb){this.switchImage(cb,null,true);}else if(bb.video)this.switchVideo(bb.video,true);if(!za){this.replaceUrl=true;sa(bb.info.permalink);}this.setLoadingState(xa.STATE_IMAGE_DATA,false);}else{this.setLoadingState(xa.STATE_IMAGE_PIXELS,true);this.setLoadingState(xa.STATE_IMAGE_DATA,true);}if(this.stream.getCurrentHtml()){this.swapData();}else this.setLoadingState(xa.STATE_HTML,true);this.disableAds=!this.isLoggedInViewer;this.loadAds();},logImpressionDetailsForPhoto:function(){var ya=[].concat(o.scry(na('fbPhotoSnowliftTagList'),'input.photoImpressionDetails'),o.scry(na('fbPhotoSnowliftFeedback'),'input.photoImpressionDetails'));if(ya.length===0)return;var za={};for(var ab=0;ab<ya.length;ab++)za[ya[ab].name]=ya[ab].value;if(this.getVideoOnStage()){za.width=0;za.height=0;}else{var bb=this.getImageDimensions(this.stream.getCurrentImageData());za.width=bb.x;za.height=bb.y;}aa.addDetailData(this.stream.getCursor(),za);ba.setIsLogAdData(true);},loadAds:function(){if(this.disableAds)return;ba.loadAdsFromUserActivity();},transitionHandler:function(ya){if(ya.getQueryData().closeTheater||ya.getQueryData().permPage||ya.getQueryData().makeprofile||this.returningToStart){if(this.isOpen)this.close();this.transitionHandlerRegistered=false;return false;}if(this.replaceUrl){this.replaceUrl=false;this._uriStack.push(ya.getQualifiedURI().toString());x.transitionComplete();return true;}var za=this._uriStack.length;if(za>=2&&this._uriStack[za-2]==ya.getQualifiedURI().toString())this._uriStack.pop();var ab=this.stream.getCursorForURI(ya.getUnqualifiedURI().toString());if(ab){var bb=this.stream.getRelativeMovement(ab);this.page(bb,true);x.transitionComplete();return true;}if(this.isOpen){this.close();x.transitionComplete();return true;}this.transitionHandlerRegistered=false;return false;},recacheData:function(){if(!this.loadingStates.html){var ya=this.stream.getCurrentHtml();for(var za in ya){ya[za]=qa(na(za).childNodes);o.empty(na(za));}}},reloadIfTimeout:function(){if(!s.hasLoaded(this.image)){var ya=this.makeNewImage(this.image.src,true);Event.listen(ya,'load',this.useImage.bind(this,ya,null,true));}},useImage:function(ya,za,ab){if(ab&&s.hasLoaded(this.image))return;o.replace(this.image,ya);this.image=ya;this.adjustStageSize(za);},makeNewImage:function(ya,za){if(this.imageLoadingTimer){clearTimeout(this.imageLoadingTimer);this.imageLoadingTimer=null;}else if(!za)this.imageRefreshTimer=setTimeout(this.reloadIfTimeout.bind(this),xa.LOADING_TIMEOUT);var ab=o.create('img',{className:'spotlight',alt:''});ab.setAttribute('aria-describedby','fbPhotosSnowliftCaption');ab.setAttribute('aria-busy','true');Event.listen(ab,'load',a.async_callback(function(){clearTimeout(this.imageRefreshTimer);this.image.setAttribute('aria-busy','false');this.setLoadingState(this.STATE_IMAGE_PIXELS,false);(function(){if(this.isOpen){this.adjustStageSize();this.adjustForNewData();}}).bind(this).defer();}.bind(this),'photo_theater'));ab.src=ya;return ab;},switchImage:function(ya,za,ab){m.hide(this.image);m.hide(this.errorBox);this.setLoadingState(this.STATE_IMAGE_PIXELS,true);var bb=this.stream&&this.stream.getCurrentImageData();if(bb)aa.addPhotoView(bb.info,this.shouldShowHiRes(bb),this.fullscreen&&r.isFullScreen());this.useImage(this.makeNewImage(ya,false),za,false);if(ab)this.stream.preloadImages(this.shouldShowHiRes(bb));},switchVideo:function(ya,za){var ab='swf_'+ya;if(za){m.addClass(this.stageWrapper,'showVideo');var bb=o.create('div',{className:'videoStageContainer'});o.appendContent(this.videoStage,bb);bb.id=ya;if(window[ab]&&!ra(ab))window[ab].write(ya);this.adjustStageSizeForVideo.bind(this,ab).defer();}else{window[ab]&&window[ab].addVariable('video_autoplay',0);this.videoLoadTimer&&clearTimeout(this.videoLoadTimer);o.empty(this.videoStage);m.removeClass(this.stageWrapper,'showVideo');}},checkVideoStatus:function(ya){if(this.videoLoadTimer)clearTimeout(this.videoLoadTimer);var za=this.getVideoOnStage();if(!za){return;}else{var ab='swf_'+za;if(ya!==ab)return;this.adjustStageSizeForVideo(ya);}},adjustStageSizeForVideo:function(ya){var za=ra(ya);if(!za){this.videoLoadTimer=setTimeout(this.checkVideoStatus.bind(this,ya),200);}else this.adjustStageSize(new ma(za.width,za.height));},handleServerError:function(ya,za){o.setContent(this.errorBox,ya);this.storeFromData(za);},swapData:function(){var ya,za=this.stream.getCurrentHtml();if(za){this.setLoadingState(xa.STATE_HTML,false);for(var ab in za){ya=ra(ab);ya&&o.setContent(ya,za[ab]);}h.inform('PhotoSnowlift.DATA_CHANGE',this.stream.getCurrentImageData().info,h.BEHAVIOR_STATE);if(this.stream.getCurrentExtraData())h.inform('PhotoSnowlift.EXTRA_DATA_CHANGE',this.stream.getCurrentExtraData(),h.BEHAVIOR_STATE);}this.showPagers(xa.PAGER_FADE);this.adjustScroller();this.scrollableArea.showScrollbar(false);this.adjustForNewData();this.logImpressionDetailsForPhoto();},updateTotalCount:function(ya,za,ab){var bb=this.stream.getCurrentHtml();if(bb){var cb=na('fbPhotoSnowliftPositionAndCount');o.replace(cb,ab);cb=ab;m.show(cb);var db='fbPhotoSnowliftPositionAndCount';bb[db]=qa(cb.childNodes);}this.stream.setTotalCount(ya);this.stream.setFirstCursorIndex(za);},addPhotoFbids:function(ya,za,ab,bb){if(bb&&this.sessionID&&bb!=this.sessionID)return;var cb=this.stream.getCursor()===null;this.stream.attachToFbidsList(ya,za,ab);if(ab&&cb)this.page(0,true);if(this.pivots&&ab)this.pivots.setCycleCount(this.stream.calculateDistance(this.stream.getCursor(),this.stream.firstCursor));if(!this.pagersShown&&this.stream.canPage())this.setStagePagersState('ready');},attachTagger:function(ya){o.appendContent(this.stageActions,ya);},storeFromData:function(ya){if(!this.isOpen)return;if(ya.ssid&&this.sessionID&&this.sessionID!=ya.ssid)return;var za=this.stream.storeToCache(ya);if('error' in za){this.checkState(xa.STATE_ERROR);return;}if('init' in za){this.initDataFetched(za.init);if(this.openExplicitly){this.replaceUrl=true;sa(this.stream.getCurrentImageData().info.permalink);}if(this.stream.canPage())this.setStagePagersState('ready');this.ua&&this.ua.add_event('ufi');}if('image' in za)this.checkState(xa.STATE_IMAGE_DATA);if('data' in za)this.checkState(xa.STATE_HTML);},setStagePagersState:function(ya){switch(ya){case 'ready':m.addClass(this.root,'pagingReady');this.pagersShown=true;this.ua&&this.ua.add_event('arrows');return;case 'active':m.addClass(this.root,'pagingActivated');return;case 'inactive':m.removeClass(this.root,'pagingActivated');return;case 'disabled':case 'reset':m.removeClass(this.root,'pagingReady');return;}},deletePhoto:function(ya){this.closeRefresh();},closeRefresh:function(){this.refreshOnClose=true;this.closeHandler();},onHiliteTag:function(ya,za){if(za.version!=z.VIEWER_SNOWLIFT)return;var ab=za.tag;if(ab)this.switchHilitedTags(ab,true);},onUpdateTagBox:function(ya,za){if(za.version==z.VIEWER_SNOWLIFT)this.updateTagBox(za.id,za.approve);}});e.exports=xa;});
__d("legacy:AudienceSelector",["AudienceSelector"],function(a,b,c,d){b('AudienceSelector');},3);
__d("legacy:CustomPrivacyOption",["CustomPrivacyOption"],function(a,b,c,d){a.CustomPrivacyOption=b('CustomPrivacyOption');},3);
__d("legacy:Selector",["Selector"],function(a,b,c,d){a.Selector=b('Selector');},3);
var FriendListPrivacyOptions=(function(){var a=false,b=false,c=null,d={},e=function(f){if(is_empty(d))PageTransitions.registerHandler(function(){d={};a=false;b=false;});var g=f.getAttribute('data-name');d[g]=f;Selector.listen(f,'select',function(h){var i=h.option,j=DOM.find(i,'a.itemAnchor'),k=j.getAttribute('data-flid');if(!k)return;var l=j.getAttribute('data-dynamic');if(l&&a){FriendListPrivacyOptions.showSmartListNux(i,k);}else if(!l&&b)FriendListPrivacyOptions.showDumbListNux([k]);});};return {listen:function(f,g,h){var i=ge(f);if(!i)return;var j=Parent.byClass(i,'audienceSelector');if(j){e(j);a=g;b=h;}},showSmartListNux:function(f,g){new AsyncRequest('/ajax/friends/lists/smart_list_publish_nux.php').setData({option_id:f.id,flid:g}).send();a=false;},setContextualDialog:function(f,g){var h=Parent.byClass(g,'audienceSelector');if(h){f.setContext(h);f.show();var i=Arbiter.subscribe('composer/publish',function(){f.hide();});f.subscribe('hide',function(){i.unsubscribe();});}},showDumbListNux:function(f){new AsyncRequest('/ajax/friends/lists/dumb_list_publish_nux.php').setData({flids:f}).send();b=false;},showBothListsNux:function(f,g){c=f;FriendListPrivacyOptions.showDumbListNux(g);},setDialog:function(){if(!c)return;var f=Dialog.getCurrent();if(f)f.setCloseHandler(function(){FriendListPrivacyOptions.showSmartListNux(c);c=null;});}};})();
__d("legacy:privacy-common",["PrivacyConst","PrivacyModel"],function(a,b,c,d){var e=b('PrivacyConst');a.PrivacyModel=b('PrivacyModel');a.PrivacyBaseValue=e.BaseValue;a.PrivacyFriendsValue=e.FriendsValue;},3);
function OnlyMePrivacyOption(){}copyProperties(OnlyMePrivacyOption.prototype,{init:function(a){this._selector=Parent.byClass(a,'composerAudienceSelector');this._plusLabel=DOM.find(a,'.plusLabel');if(!this._selector)return;this._elem=a;this._taggedIDs=[];this._tags=[];this._eventTag=null;this._recalculateTooltipAndLabel();this._updateSelector();Arbiter.subscribe('Composer/changedtags',function(b,c){var d=this._eventTag;this._eventTag=c.eventTag;this._tags=c.withTags.map(function(f){return f.getText();});this._taggedIDs=c.withTags.map(function(f){return f.getValue();});for(var e in c.mention)if(c.mention[e].type=='user'&&c.mention[e].uid!=Env.user){this._tags.push(c.mention[e].text);this._taggedIDs.push(c.mention[e].uid);}if(this._eventTag&&d!=this._eventTag&&Selector.isOptionSelected(this._elem))Arbiter.inform('EventTagged/changed',this._getChangedData());if(this._recalculateTooltipAndLabel()&&Selector.isOptionSelected(this._elem)){this._updateSelector();Arbiter.inform('SelectedPrivacyOption/changed',this._getChangedData());}}.bind(this));Selector.listen(this._selector,'change',this._updateSelector.bind(this));},_getChangedData:function(){return {eventTag:this._eventTag,tags:this._taggedIDs,privacy:PrivacyFriendsValue.SELF};},_recalculateTooltipAndLabel:function(){var a=this._tooltip,b=this._label;if(this._taggedIDs.length){this._tooltip="Anyone tagged";this._label="Only Me"+' (+)';}else{this._tooltip="Only you";this._label="Only Me";}CSS.conditionShow(this._plusLabel,this._taggedIDs.length);return (a!=this._tooltip)||(b!=this._label);},_updateSelector:function(){if(Selector.isOptionSelected(this._elem)){Selector.setButtonLabel(this._selector,this._label);Selector.setButtonTooltip(this._selector,this._tooltip);return false;}return true;}});
__d("legacy:ui-scrolling-pager-js",["ScrollingPager"],function(a,b,c,d){a.ScrollingPager=b('ScrollingPager');},3);
__d("TypeaheadBestName",["TypeaheadUtil","copyProperties"],function(a,b,c,d,e,f){var g=b('TypeaheadUtil'),h=b('copyProperties');function i(j){this._typeahead=j;}h(i.prototype,{_subscription:null,enable:function(){var j=this._typeahead.getView();this._subscription=j.subscribe('beforeRender',function(k,l){var m=l.value;for(var n=0;n<l.results.length;++n){var o=l.results[n];if(o.alternate_names==null)continue;if(g.isQueryMatch(m,o.default_name)){o.text=o.default_name;return;}for(var p=0;p<o.alternate_names.length;p++)if(g.isQueryMatch(m,o.alternate_names[p])){o.text=o.alternate_names[p];return;}o.text=o.default_name;}});},disable:function(){this._typeahead.getView().unsubscribe(this._subscription);this._subscription=null;}});e.exports=i;});
__d("legacy:BestNameTypeaheadBehavior",["TypeaheadBestName"],function(a,b,c,d){var e=b('TypeaheadBestName');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.buildBestAvailableNames=function(f){f.enableBehavior(e);};},3);
var StreamShareVideo={_endpoints:[],_thumbs:[],registerThumb:function(a,b,c,d){StreamShareVideo._endpoints[a+' '+c]=d;StreamShareVideo._thumbs[a+' '+c]=b;},clickTitle:function(a,b,event){this.expandInlineOrRedirect(a,b,event);},expandInlineOrRedirect:function(a,b,event){if(StreamShareVideo._shouldFollowHref(event))return true;var c=StreamShareVideo._thumbs[a+' '+b],d=ge(c);if(d){CSS.addClass(d,"uiVideoThumbLoading");AsyncRequest.bootstrap(StreamShareVideo._endpoints[a+' '+b],d.parentElement);return false;}return true;},clickTimeline:function(a,b,event){if(StreamShareVideo._shouldFollowHref(event))return true;CSS.addClass(a,"-cx-PRIVATE-fbTimelineExternalShareUnit__loading");CSS.removeClass(a,"-cx-PRIVATE-fbTimelineExternalShareUnit__video");AsyncRequest.bootstrap(b,a);return false;},_shouldFollowHref:function(event){event=$E(event);if(!event)return false;if(event.getModifiers().any||event.isMiddleClick())return true;return false;}};
function tz_calculate(a){var b=new Date(),c=b.getTimezoneOffset()/30,d=b.getTime()/1000,e=Math.round((a-d)/1800),f=Math.round(c+e)%48;if(f==0){return 0;}else if(f>24){f-=Math.ceil(f/48)*48;}else if(f<-28)f+=Math.ceil(f/-48)*48;return f*30;}function tz_autoset(a,b){if(!a||undefined==b)return;if(window.tz_autoset.calculated)return;window.tz_autoset.calculated=true;var c=-tz_calculate(a);if(c!=b){var d='/ajax/autoset_timezone_ajax.php';new AsyncRequest().setURI(d).setData({gmt_off:c}).setErrorHandler(bagofholding).setTransportErrorHandler(bagofholding).setOption('suppressErrorAlerts',true).send();}}
__d("TypingDetector",["event-extensions","function-extensions","ArbiterMixin","Class","Input","Run","copyProperties","createObjectFrom"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('Input'),j=b('Run'),k=b('copyProperties'),l=b('createObjectFrom');function m(n){this._input=n;this._ignoreKeys={};}m.INACTIVE=0;m.TYPING=1;m.QUITTING=2;k(m.prototype,g,{_timeout:7000,_currentState:m.INACTIVE,init:function(){this.init=bagofholding;this.reset();Event.listen(this._input,'keyup',this._update.bind(this));j.onUnload(this._onunload.bind(this));},reset:function(){clearTimeout(this._checkTimer);this._checkTimer=null;this._lastKeystrokeAt=null;this._currentState=m.INACTIVE;},setIgnoreKeys:function(n){this._ignoreKeys=l(n);},_onunload:function(){if(this._currentState==m.TYPING)this._transition(m.QUITTING);},_update:function(event){var n=Event.getKeyCode(event),o=this._currentState;if(!this._ignoreKeys[n])if(i.getValue(this._input).trim().length===0){if(o==m.TYPING)this._transition(m.INACTIVE);}else if(o==m.TYPING){this._recordKeystroke();}else if(o==m.INACTIVE){this._transition(m.TYPING);this._recordKeystroke();}},_transition:function(n){this.reset();this._currentState=n;this.inform('change',n);},_recordKeystroke:function(){this._lastKeystrokeTime=Date.now();if(!this._checkTimer)this._checkTimer=this._checkTyping.bind(this).defer(this._timeout);},_checkTyping:function(){var n=this._lastKeystrokeTime+this._timeout,o=Date.now();if(o>n){this._transition(m.INACTIVE);}else{clearTimeout(this._checkTimer);this._checkTimer=this._checkTyping.bind(this).defer(n-o+10);}}});e.exports=m;});
__d("MentionsInputMatchers",[],function(a,b,c,d,e,f){var g=['@','\\uff20','+','\\uff0b'].join(''),h='.,*?$|#{}()\\^\\-\\[\\]\\\\\/!%&\'"~=<>_:;',i='\\b[A-Z][^ A-Z'+h+']',j='([^'+g+h+']|['+h+'][^ '+h+'])',k='(?:^|\\s)(?:['+g+']('+j+'{0,20}))',l='(?:(?:'+i+'+)|'+k+')',m='(?:'+i+'{4,})',n={trigger:new RegExp('['+g+']$'),mainMatcher:new RegExp(k+'$'),autoMatcher:new RegExp(l+'$'),userMatcher:new RegExp(m+'$')};e.exports=n;});
__d("MentionsInput",["event-extensions","function-extensions","Arbiter","ArbiterMixin","Class","CSS","DataStore","DOM","HTML","Input","InputSelection","Parent","htmlize","Style","Typeahead","TypeaheadUtil","UserAgent","copyProperties","MentionsInputMatchers"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Class'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('HTML'),n=b('Input'),o=b('InputSelection'),p=b('Parent'),q=b('htmlize'),r=b('Style'),s=b('Typeahead'),t=b('TypeaheadUtil'),u=b('UserAgent'),v=b('copyProperties'),w=b('MentionsInputMatchers');function x(y,z,aa,ba,ca,da){k.set(y,'MentionsInput',this);this._root=y;this._typeahead=z;this._input=aa;var ea=false;try{ea=document.activeElement===this._input;}catch(fa){}if(ea){this.init.bind(this,ba,ca,da).defer();}else var ga=Event.listen(this._input,'focus',function(){this.init.bind(this,ba,ca,da).defer();ga.remove();}.bind(this));}x.getInstance=function(y){var z=p.byClass(y,'uiMentionsInput');return z?k.get(z,'MentionsInput'):null;};v(x.prototype,h,{init:function(y,z,aa){this.init=Function.prototype;this._initialized=true;this._highlighter=l.find(this._root,'.highlighter');this._highlighterInner=this._highlighter.firstChild;this._highlighterContent=l.find(this._root,'.highlighterContent');this._hiddenInput=l.find(this._root,'.mentionsHidden');this._placeholder=this._input.getAttribute('placeholder')||'';this._maxMentions=y.max||6;this._metrics=aa;if(u.firefox()<4){this._input.blur();setTimeout(function(){this._input.focus();}.bind(this));}if(!this._hiddenInput.name){var ba=this._input.name;this._input.name=ba+'_text';this._hiddenInput.name=ba;}this._initEvents();this._initTypeahead();this.reset(z);this.inform('init',null,g.BEHAVIOR_STATE);},reset:function(y){if(!this._initialized)return;this._mentioned={};this._orderedUIDs=[];this._numMentioned=0;this._filterData=null;this._hiddenInput&&(this._hiddenInput.value='');this._highlighterContent&&l.empty(this._highlighterContent);this._highlighterAuxContent&&l.remove(this._highlighterAuxContent);this._highlighterAuxContent=null;n.setPlaceholder(this._input,this._placeholder);r.set(this._typeahead.getElement(),'height','auto');if(y){n.setValue(this._input,y.flattened);for(var z in y.mention_data)this._addToken({uid:z,text:y.mention_data[z],type:'unknown'});}this._updateTypeahead();this._updateWidth();this._update();},getValue:function(){return n.getValue(this._input);},getRawValue:function(){this._update();return n.getValue(this._hiddenInput);},checkValue:function(){var y=this._typeahead.getCore().getValue();if(w.trigger.exec(y)||y==='')this.inform('sessionEnd',{});},getTypeahead:function(){return this._typeahead;},_initEvents:function(){var y=this._update.bind(this);Event.listen(this._input,{input:y,keyup:y,change:y,blur:this._handleBlur.bind(this),focus:this._handleFocus.bind(this)});if(this._metrics){this._metrics._reset();this._metrics.bindSessionStart(this._typeahead,'render',true);this._metrics.bindSessionEnd(this._typeahead.getView(),'select',true);this._metrics.bindSessionEnd(this,'sessionEnd',false);Event.listen(this._input,'keyup',function(event){this.checkValue.bind(this).defer();}.bind(this));}},_initTypeahead:function(){this._typeahead.subscribe('select',function(ca,da){var ea=da.selected;this._addToken({uid:ea.uid,text:ea.text,type:ea.type});this.updateValue();}.bind(this));var y=this._input,z=null,aa=function(){if(z===null){z=n.getSubmitOnEnter(y);n.setSubmitOnEnter(y,false);}},ba=function(){if(z!==null){n.setSubmitOnEnter(y,z);z=null;}};this._typeahead.subscribe('render',aa);this._typeahead.subscribe('reset',ba);this._typeahead.subscribe('highlight',function(ca,da){da.index>=0?aa():ba();});this._typeahead.subscribe('query',function(){this._filterData=null;}.bind(this));this._typeahead.getCore().suffix='';this._handleFocus();},_handleBlur:function(){if(this._filterToken){this._filterToken.remove();this._filterToken=null;}},_handleFocus:function(){if(!this._filterToken)this._filterToken=this._typeahead.getData().addFilter(this._filterResults.bind(this));this._updateWidth();},_filterResults:function(y){if(this._filterData===null){var z=o.get(this._input).start||0;for(var aa=0;aa<this._offsets.length;aa++){var ba=this._offsets[aa];if(z>ba[0]&&z<=ba[1]){this._filterData={caretIsInsideMention:true};return false;}}var ca=this._typeahead.getCore();this._filterData={value:ca.getValue(),rawValue:ca.getRawValue()};}if(this._filterData.caretIsInsideMention)return false;if(w.mainMatcher.test(this._filterData.rawValue))return true;if(y.type!='user')return false;if(w.userMatcher.test(this._filterData.value))return true;return t.isExactMatch(this._filterData.value,this._typeahead.getData().getTextToIndex(y));},_addToken:function(y){var z=y.uid;if(!this._mentioned.hasOwnProperty(z)){this._mentioned[z]=y;this._orderedUIDs.push(z);this._numMentioned++;this._updateTypeahead();}},_removeToken:function(y){if(this._mentioned.hasOwnProperty(y)){delete this._mentioned[y];this._orderedUIDs.remove(y);this._numMentioned--;this._updateTypeahead();}},_reduceToken:function(y,z){var aa=z.split(' '),ba=[];for(var ca=0;ca<aa.length;ca++)if(y.indexOf(aa[ca])!=-1)ba.push(aa[ca]);aa=ba;for(ca=1;ca<aa.length;ca++)for(var da=1;da<aa[ca-1].length+1;da++)if(y.indexOf(aa[ca-1].substr(0,da)+aa[ca])!=-1)aa.splice(ca-1,1);while(y.indexOf(aa.join(' '))==-1)aa.splice(0,1);return aa.join(' ');},_update:function(){var y=this.getValue();if(y==this._value)return;this._updateTokens();this.updateValue();this._updateDirection();},_updateTokens:function(){var y=this.getValue(),z=false;for(var aa=0;aa<this._orderedUIDs.length;++aa){var ba=this._orderedUIDs[aa],ca=this._mentioned[ba],da=ca.text,ea;if(ca.type=='user'&&(ea=this._reduceToken(y,da))!==''){if(ea==da.substring(0,da.lastIndexOf(' '))&&y==this._value.substring(0,this._value.length-1)){y=y.substring(0,y.lastIndexOf(' '));z=true;}ca.text=ea;}else if(!da||y.indexOf(da)==-1||typeof da!=='string')this._removeToken(ba);}this._value=y;if(z)n.setValue(this._input,y);},updateValue:function(){var y=this.getValue(),z=this._orderedUIDs,aa=[],ba,ca,da,ea;for(ea=0;ea<z.length;++ea){ca=this._mentioned[z[ea]].text;y=y.replace(ca,function(fa,ga){aa.push([ga,ga+ca.length]);return ca;});}for(ea=0;ea<z.length;++ea){da=z[ea];ca=this._mentioned[da].text;y=y.replace(ca,'@['+da+':]');}ba=q(y);for(ea=0;ea<z.length;++ea){da=z[ea];ca=this._mentioned[da].text;ba=ba.replace('@['+da+':]','<b>'+q(ca)+'</b>');ca=ca.replace(/[\\\]:]/g,function(fa){return '\\'+fa;});y=y.replace('@['+da+':]','@['+da+':'+ca+']');}if(u.ie()){ba=ba.replace(/ {2}/g,'&nbsp;<wbr />&nbsp;<wbr />');ba=ba.replace(/ (?=[^\/]|\/[^>])/g,'&nbsp;<wbr />');}this._offsets=aa;this._hiddenInput.value=y;l.setContent(this._highlighterContent,m(ba));this._updateHighlighter();this._updateHeight();},_updateDirection:function(){var y=r.get(this._input,'direction');if(y==this._dir)return;this._dir=y;r.set(this._highlighter,'direction',y);if(y=='rtl'){r.set(this._highlighter,'text-align','right');}else r.set(this._highlighter,'text-align','left');},_updateWidth:function(){var y=r.getFloat.curry(this._input),z=this._input.offsetWidth-y('paddingLeft')-y('paddingRight')-y('borderLeftWidth')-y('borderRightWidth');if(u.firefox())z-=2;if(u.ie()<=7){z-=r.getFloat(this._highlighterInner,'paddingLeft');this._highlighter.style.zoom=1;}this._highlighterInner.style.width=Math.max(z,0)+'px';},_updateHeight:function(){if(this._highlighterAuxContent){var y=this._highlighter.offsetHeight,z=this._typeahead.getElement();if(y>z.offsetHeight){r.set(z,'height',y+'px');g.inform('reflow');}}},_updateTypeahead:function(){var y=this._typeahead.getCore(),z=null;if(!this._maxMentions||this._numMentioned<this._maxMentions)z=w.autoMatcher;y.matcher=z;y.setExclusions(this._orderedUIDs);this.inform('update',{mentioned:this._mentioned});},setPlaceholder:function(y){this._placeholder=y;if(!this.hasAuxContent())n.setPlaceholder(this._input,y);},_updateHighlighter:function(){if(this._highlighterContent)j.conditionShow(this._highlighterContent,this._numMentioned>0||this.hasAuxContent());},setAuxContent:function(y){if(this._highlighterContent){if(!this._highlighterAuxContent){this._highlighterAuxContent=l.create('span',{className:'highlighterAuxContent'});l.insertAfter(this._highlighterContent,this._highlighterAuxContent);}l.setContent(this._highlighterAuxContent,y);if(y){n.setPlaceholder(this._input,'');}else n.setPlaceholder(this._input,this._placeholder);this._updateHighlighter();this._updateHeight();}},hasAuxContent:function(){var y=this.getAuxContentRoot();return y&&y.innerHTML.length>0;},getAuxContentRoot:function(){return this._highlighterAuxContent;},addMention:function(y){var z=this.getValue();n.setValue(this._input,z+" "+y.text);this._addToken(y);this._update();},getMentions:function(){return this._mentioned;}});e.exports=x;});
__d("OptimisticUFI",["event-extensions","Arbiter","AsyncRequest","AsyncResponse","CommentPrelude","CSS","DOM","Form","HTML","Input","MentionsInput","Parent","htmlize","XHPTemplate","randomInt"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('AsyncResponse'),j=b('CommentPrelude'),k=b('CSS'),l=b('DOM'),m=b('Form'),n=b('HTML'),o=b('Input'),p=b('MentionsInput'),q=b('Parent'),r=b('htmlize'),s=b('XHPTemplate'),t=b('randomInt'),u={_commentSeqNo:0,init:function(v){this._commentTemplate=v;if(!this._loaded){Event.listen(document.documentElement,'click',this._clickHandler.bind(this),Event.Priority.URGENT);this._loaded=true;}},_clickHandler:function(event){var v=event.getTarget(),w=v.name=='comment'&&v.parentNode&&q.byClass(v,'optimistic_submit');if(!w)return true;var x=v.form,y=l.scry(x,'textarea')[0];if(o.isEmpty(y))return true;j.uncollapse(x);var z,aa,ba=l.scry(v,'^.commentList li.uiUfiAddComment')[0];if(!ba){z=this._commentTemplate.render();aa=s.getNode(z,'text');l.setContent(aa,n(r(y.value.trim())));}var ca=l.scry(x,'ul.commentList')[0];if(!ca)return true;var da;if(ba){da=ba.previousSibling;k.show(da);k.hide(ba);}else{k.show(ca.parentNode);ca.appendChild(z);da=ca.lastChild;}var ea=t(0,4294967295);da.id='optimistic_comment_'+ea+'_'+this._commentSeqNo++;var fa=m.serialize(x);fa.comment_replace=da.id;fa.comment=1;function ga(){new h(m.getAttribute(x,'action')).setData(fa).setRelativeTo(x).setErrorHandler(function(ia){k.addClass(da,'uiUfiCommentFailed');i.defaultErrorHandler(ia);}).setServerDialogCancelHandler(function(){l.remove(da);}).send();}if(!ba)Event.listen(s.getNode(z,'retry_link'),'click',ga);ga();y.value=y.style.height='';y.focus();var ha=p.getInstance(y);ha&&ha.reset();if(ba){l.remove(ba);}else g.inform('ufi/comment',{form:x});return false;}};e.exports=u;});
__d("UFIUpdate",["CommentPrelude","CSS","DOM","DOMQuery","HTML","MentionsInput","Parent","ScrollableArea","ScrollAwareDOM"],function(a,b,c,d,e,f){var g=b('CommentPrelude'),h=b('CSS'),i=b('DOM'),j=b('DOMQuery'),k=b('HTML'),l=b('MentionsInput'),m=b('Parent'),n=b('ScrollableArea'),o=b('ScrollAwareDOM'),p={expandFeedback:function(q,r,s){i.scry(q,r).forEach(function(t){g.expand(t,s);});},uncollapseFeedback:function(q){g.uncollapse(m.byTag(i.find(q,'.fbUfi'),'form'));},multiContentReplaceGlobal:function(q,r){this.multiContentReplace(document.documentElement,q,r);},multiContentReplace:function(q,r,s){s=s instanceof k?s.getRootNode():s;i.scry(q,r).forEach(function(t){o.replace(t,s.cloneNode(true));});},refocusCommentBox:function(q,r){var s=i.find(q,'textarea');s.value=s.style.height="";if(r){s.blur();s.focus.defer();}else document.documentElement.onfocusin({target:s});},resetMentionsInput:function(q){var r=l.getInstance(i.find(q,'div.uiMentionsInput'));r&&r.reset();},insertAtBottom:function(q,r,s,t){var u=i.scry(q,'.comment_'+s).length;if(r)u+=i.scry(q,'#'+r).length;if(!u){var v=i.find(q,'.commentList'),w=n.getInstance(v),x=w&&w.isScrolledToBottom();o.appendContent(v,t);x&&w.scrollToBottom(false);}},updateUnsubscribeLink:function(q,r){var s=i.scry(q,'.unsub_link')[0];if(s){i.replace(s,r);}else if(r)i.insertAfter(i.find(q,'.comment_link'),[" \xB7 ",r]);},updateSeenCount:function(q){j.scry(q,'.uiUfiSeenBar').forEach(function(t){h.hide(t);});j.scry(q,'.uiUfiViewSeenCount').forEach(function(t){h.hide(t);});var r=j.scry(q,'.uiUfiLike')[0];if(r&&r.childNodes.length===0)r=null;r=r||j.scry(q,'.uiUfiSeenBar')[0];if(!r)return;var s=j.scry(r,'.uiUfiViewSeenCount')[0];if(!s)return;h.show(s);h.show(r);}};e.exports=p;});
function ufi_add_ft_hidden_node(a){if(a.link_data)return;var b=collect_data_attribs(a,['ft']).ft;if(Object.keys(b).length){var c=DOM.create('input',{type:'hidden',name:'link_data',value:JSON.stringify(b)});a.appendChild(c);}}function ufi_add_all_link_data(){Bootloader.loadComponents('dom-collect',function(){DOM.scry(document.body,'form.commentable_item').forEach(ufi_add_ft_hidden_node);});}function question_add_all_link_data(){Bootloader.loadComponents('dom-collect',function(){DOM.scry(document.body,'form.fbEigenpollForm').forEach(ufi_add_ft_hidden_node);DOM.scry(document.body,'form.fbQuestionPollForm').forEach(ufi_add_ft_hidden_node);});}
__d("legacy:UIPagelet",["UIPagelet"],function(a,b,c,d){a.UIPagelet=b('UIPagelet');},3);
__d("Scrollable",["event-extensions","Parent","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Parent'),h=b('UserAgent'),i=function(event){var k=g.byClass(event.getTarget(),'scrollable');if(!k)return;if((typeof event.axis!=='undefined'&&event.axis===event.HORIZONTAL_AXIS)||(event.wheelDeltaX&&!event.wheelDeltaY))return;var l=event.wheelDelta?event.wheelDelta:-event.detail,m=k.scrollHeight,n=k.clientHeight;if(m>n){var o=k.scrollTop;if((l>0&&o===0)||(l<0&&o>=m-n)){event.prevent();}else if(h.ie()<9)if(k.currentStyle){var p=k.currentStyle.fontSize;if(p.indexOf('px')<0){var q=document.createElement('div');q.style.fontSize=p;q.style.height='1em';p=q.style.pixelHeight;}else p=parseInt(p,10);k.scrollTop=o-Math.round(l/120*p);event.prevent();}}},j=document.documentElement;if(h.firefox()){j.addEventListener('DOMMouseScroll',i,false);}else Event.listen(j,'mousewheel',i);});
__d("TinyViewport",["event-extensions","CSS","DOM","debounce"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('DOM'),i=b('debounce'),j=i(function(){var k=document.documentElement,l=h.getDocumentScrollElement(),m=k.clientHeight<400||l.clientWidth<l.scrollWidth;g.conditionClass(k,'tinyViewport',m);g.conditionClass(k,'canHaveFixedElements',!m);});j();Event.listen(window,'resize',j);});
__d("legacy:Toggler",["Toggler"],function(a,b,c,d){a.Toggler=b('Toggler');},3);
__d("legacy:Button",["Button"],function(a,b,c,d){a.Button=b('Button');},3);
__d("ButtonGroup",["function-extensions","copyProperties","createArrayFrom","CSS","DataStore","Parent"],function(a,b,c,d,e,f){b('function-extensions');var g=b('copyProperties'),h=b('createArrayFrom'),i=b('CSS'),j=b('DataStore'),k=b('Parent'),l='firstItem',m='lastItem';function n(s,t){var u=k.byClass(s,t);if(!u)throw new Error('invalid use case');return u;}function o(s){return i.shown(s)&&h(s.childNodes).some(i.shown);}function p(s){var t,u,v;h(s.childNodes).forEach(function(w){v=o(w);i.removeClass(w,l);i.removeClass(w,m);i.conditionShow(w,v);if(v){t=t||w;u=w;}});t&&i.addClass(t,l);u&&i.addClass(u,m);i.conditionShow(s,t);}function q(s,t){var u=n(t,'uiButtonGroupItem');s(u);p(u.parentNode);}function r(s){this._root=n(s,'uiButtonGroup');j.set(this._root,'ButtonGroup',this);p(this._root);}r.getInstance=function(s){var t=n(s,'uiButtonGroup'),u=j.get(t,'ButtonGroup');return u||new r(t);};g(r.prototype,{hideItem:q.curry(i.hide),showItem:q.curry(i.show),toggleItem:q.curry(i.toggle)});e.exports=r;});
__d("legacy:MentionsInput",["MentionsInput"],function(a,b,c,d){a.MentionsInput=b('MentionsInput');},3);
__d("FormDisableOnSubmit",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._form=i;}g(h.prototype,{_subscription:null,_disabled:false,enable:function(){this._subscription=this._form.subscribe(['submit','reset'],this._handle.bind(this));},disable:function(){this._form.unsubscribe(this._subscription);this._subscription=null;},_handle:function(i,j){if(i=='submit'){if(this._disabled)return false;this._disabled=true;return true;}this._disabled=false;}});e.exports=h;});
__d("FormSubmitOnChange",["event-extensions","copyProperties","submitForm"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('submitForm');function i(j){this._form=j;}g(i.prototype,{_listener:null,enable:function(){this._listener=Event.listen(this._form.getRoot(),'change',this._submit.bind(this));},disable:function(){this._listener.remove();this._listener=null;},_submit:function(){h(this._form.getRoot());}});e.exports=i;});
__d("UIForm",["event-extensions","ArbiterMixin","BehaviorsMixin","Class","DOM","Form","FormDisableOnSubmit","FormSubmitOnChange","Run","areObjectsEqual","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('BehaviorsMixin'),i=b('Class'),j=b('DOM'),k=b('Form'),l=b('FormDisableOnSubmit'),m=b('FormSubmitOnChange'),n=b('Run'),o=b('areObjectsEqual'),p=b('copyProperties');function q(r,s,t,u){this._root=r;this.controller=r;this._message=s;n.onAfterLoad(function(){this._originalState=k.serialize(this._root);}.bind(this));this._forceDirty=t;this._submitted=false;Event.listen(this._root,'submit',this._handleSubmit.bind(this));if(u&&u.length)this.enableBehaviors(u);var v=true;n.onBeforeUnload(this.checkUnsaved.bind(this),v);}p(q.prototype,g,h,{getRoot:function(){return this._root;},_handleSubmit:function(){if(this.inform('submit')===false)return false;this._submitted=true;return true;},reset:function(){this.inform('reset');this._submitted=false;},isDirty:function(){if(this._submitted||!j.contains(document.body,this._root))return false;if(this._forceDirty)return true;var r=k.serialize(this._root);return !o(r,this._originalState);},checkUnsaved:function(){if(this.isDirty())return this._message;return null;}});e.exports=a.UIForm||q;});
__d("legacy:ScrollableArea",["ScrollableArea"],function(a,b,c,d){a.ScrollableArea=b('ScrollableArea');},3);
__d("TooltipLink",["Parent","Tooltip"],function(a,b,c,d,e,f){var g=b('Parent'),h=b('Tooltip'),i={setTooltipText:function(j,k){j=g.byTag(j,'a');j&&h.set(j,k);}};e.exports=i;});
__d("SubMenu",["event-extensions","Arbiter","copyProperties","CSS"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('copyProperties'),i=b('CSS');function j(){}h(j.prototype,{_subMenu:null,_mainMenu:null,_forward:null,_backward:null,init:function(k,l,m,n){this._subMenu=k;this._mainMenu=l;this._forward=m;this._backward=n;g.subscribe('SubMenu/Reset',this._goToMainMenu.bind(this));Event.listen(m,'click',this._goToSubMenu.bind(this));Event.listen(n,'click',this._goToMainMenu.bind(this));},initAsyncChildMenu:function(k){Event.listen(this._forward,'click',function(){this._goToSubMenu();k.load();}.bind(this));},_goToMainMenu:function(){i.hide(this._subMenu);i.show(this._mainMenu);},_goToSubMenu:function(){i.hide(this._mainMenu);i.show(this._subMenu);}});e.exports=j;});
__d("legacy:ui-submenu",["SubMenu"],function(a,b,c,d){a.SubMenu=b('SubMenu');},3);
__d("AsyncMenu",["AsyncRequest","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('copyProperties');function i(){}h(i.prototype,{_uri:null,_elem:null,init:function(j,k){this._uri=j;this._elem=k;},load:function(){this.load=bagofholding;g.bootstrap(this._uri,this._elem);}});e.exports=i;});
__d("legacy:ui-asyncmenu",["AsyncMenu"],function(a,b,c,d){a.AsyncMenu=b('AsyncMenu');},3);
function FutureSideNav(){FutureSideNav.instance&&FutureSideNav.instance.uninstall();FutureSideNav.instance=this;}FutureSideNav.instance=null;FutureSideNav.getInstance=function(){return FutureSideNav.instance||new FutureSideNav();};copyProperties(FutureSideNav.prototype,{init:function(a,b,c){this.root=a;this.items={};this.sections={};this.editor=null;this.editing=false;this.selected=null;this.loading=null;this.keyParam='sk';this.defaultKey=b;this.uri=URI.getRequestURI();this.ajaxPipe=c;this.ajaxPipeEndpoints={};this.sidecol=true;this._installed=true;this._handlePageTransitions=true;PageTransitions.registerHandler(function(d){return this._handlePageTransitions&&this.handlePageTransition(d);}.bind(this));this._eventHandlers=[];this._arbiterSubscriptions=[Arbiter.subscribe(NavigationMessage.NAVIGATION_COMPLETED,this.navigationComplete.bind(this)),Arbiter.subscribe(NavigationMessage.NAVIGATION_FAILED,this.navigationFailed.bind(this)),Arbiter.subscribe(NavigationMessage.NAVIGATION_COUNT_UPDATE,this.navigationCountUpdate.bind(this)),Arbiter.subscribe(NavigationMessage.NAVIGATION_SELECT,this.navigationSelect.bind(this)),Arbiter.subscribe(ChannelConstants.getArbiterType('nav_update_counts'),this.navigationCountUpdateFromPresence.bind(this))];this._explicitHover=[];this._ensureHover('sideNavItem');this._eventHandlers.push(Event.listen(window,'resize',this._handleResize.bind(this)));this._checkNarrow();this._selectorSubscriptions=[];window.Selector&&this._selectorSubscriptions.push(Selector.subscribe(['open','close'],function(d,e){var f=Parent.byClass(e.selector,'sideNavItem');f&&CSS.conditionClass(f,'editMenuOpened',d==='open');}));onleaveRegister(this.uninstall.bind(this));if(this._pendingSections)this._pendingSections.forEach(function(d){this.initSection.apply(this,d);}.bind(this));},_handleResize:(function(){var a;return function(){a&&clearTimeout(a);a=this._checkNarrow.bind(this).defer(200);};})(),_checkNarrow:function(){CSS.conditionClass(this.root,'uiNarrowSideNav',Vector2.getElementPosition(this.root).x<20);},_ensureHover:function(a){if(ua.ie()<8)Bootloader.loadComponents('explicit-hover',function(){this._explicitHover.push(new ExplicitHover(this.root,a));}.bind(this));},uninstall:function(){if(this._installed){this._installed=false;this._handlePageTransitions=false;this._arbiterSubscriptions.forEach(Arbiter.unsubscribe);this._selectorSubscriptions.forEach(function(a){Selector.unsubscribe(a);});this._eventHandlers.forEach(function(a){a.remove();});this._explicitHover.forEach(function(a){a.uninstall();});}},initSection:function(a,b){if(!this._installed){this._pendingSections=this._pendingSections||[];this._pendingSections.push(arguments);return;}this._initItems(b);this._initSection(a);},addItem:function(a,b){this._initItem(a,b);},_initItems:function(a){var b=function(c,d){var e=this._initItem(c,d);if(c.children)c.children.forEach(function(f){b(f,e);});}.bind(this);$A(a).forEach(function(c){b(c,null);});},_initItem:function(a,b){var c=this.items[a.id]=this._constructItem(a,b);if(c.equals(this.selected)||a.selected)this.setSelected(c);var d=c.getLinkNode();d&&this._eventHandlers.push(Event.listen(d,'click',function(event){return !this.editing;}.bind(this)));return c;},_initSection:function(a){var b=this.sections[a.id]=this._constructSection(a);this._eventHandlers.push(Event.listen(b.node,'click',this.handleSectionClick.bind(this,b)));DOM.scry(b.node,'div.bookmarksMenuButton').forEach(CSS.show);return b;},_constructItem:function(a,b){return new FutureSideNavItem(a,b);},_constructSection:function(a){return new FutureSideNavSection(a);},handleSectionClick:function(a,event){var b=this._getEventTarget(event,'a'),c=this._getItemForNode(b);if(!b){return;}else if(CSS.hasClass(b.parentNode,'uiMenuItem')){this._handleMenuClick(a,c,b.parentNode,event);}else this._handleLinkClick(a,b,event);},_getEventTarget:function(event,a){var b=event.getTarget();if(b.tagName!==a.toUpperCase()){return Parent.byTag(b,a);}else return b;},_handleMenuClick:function(a,b,c,event){if(CSS.hasClass(c,'rearrange'))this.beginEdit(a);},_handleLinkClick:function(a,b,event){if(CSS.hasClass(b,'navEditDone')){this.editing?this.endEdit():this.beginEdit(a);event.kill();}},getItem:function(a){if(this._isCurrentPath(a)){return this._getItemForKey(this._getKey(a.getQueryData())||this.defaultKey);}else return this._getItemForPath(a.getPath());},getNodeForKey:function(a){var b=this._getItemForKey(a);if(b)return b.node;},_isCurrentPath:function(a){return a.getDomain()===this.uri.getDomain()&&a.getPath()===this.uri.getPath();},_getKey:function(a){return a[this.keyParam];},_getItemForNode:function(a){a=Parent.byClass(a,'sideNavItem');return a&&this.items[a.id];},_getItemForKey:function(a){return this._findItem(function(b){return b.matchKey(a);});},_getItemForPath:function(a){return this._findItem(function(b){return b.matchPath(a);});},_findItem:function(a){for(var b in this.items)if(a(this.items[b]))return this.items[b];},removeItem:function(a){if(a&&this.items[a.id]){DOM.remove(a.node);delete this.items[a.id];}},removeItemByKey:function(a){this.removeItem(this._getItemForKey(a));},moveItem:function(a,b,c){var d=DOM.find(a.node,'ul.uiSideNav');(c?DOM.prependContent:DOM.appendContent)(d,b.node);},setLoading:function(a){this.loading&&this.loading.hideLoading();this.loading=a;this.loading&&this.loading.showLoading();},setSelected:function(a){this.setLoading(null);if(this.selected){this.selected.hideSelected();this.selected.getTop().hideChildren();}this.selected=a;if(this.selected){this.selected.showSelected();this.selected.getTop().showChildren();}},handlePageTransition:function(a){var b=this.getItem(a),c=b&&b.endpoint&&this._doPageTransition(b,a);return c;},_doPageTransition:function(a,b){this.setLoading(a);this._sendPageTransition(a.endpoint,copyProperties(this._getTransitionData(a,b),b.getQueryData()));return true;},_sendPageTransition:function(a,b){b.endpoint=a;Arbiter.inform(NavigationMessage.NAVIGATION_BEGIN,{useAjaxPipe:this._useAjaxPipe(a),params:b});},_getTransitionData:function(a,b){var c={};c.sidecol=this.sidecol;c.path=b.getPath();c[this.keyParam]=a.textKey;c.key=a.textKey;return c;},_useAjaxPipe:function(a){return this.ajaxPipe||this.ajaxPipeEndpoints[a];},navigationComplete:function(){this.loading&&this.setSelected(this.loading);},navigationFailed:function(){this.setLoading(null);},navigationSelect:function(a,b){var c=this._getItemForKey(this._getKey(b));if(b.asLoading){this.setLoading(c);}else this.setSelected(c);},navigationCountUpdate:function(a,b){var c=this._getItemForKey(b&&b.key);if(c)if(typeof b.count!=="undefined"){c.setCount(b.count,b.hide);}else if(typeof b.increment!=="undefined")c.incrementCount(b.increment,b.hide);},navigationCountUpdateFromPresence:function(a,b){b=b.obj;if(b)if(!b.class_name||b.class_name&&CSS.hasClass(this.root,b.class_name))if(b.items)for(var c=0;c<b.items.length;c++)this.navigationCountUpdate(a,b.items[c]);},beginEdit:function(a){if(!this.editing){this.editing=true;CSS.addClass(this.root,'editMode');this._updateTrackingData();Bootloader.loadComponents('sortable-side-nav-js',this._initEditor.bind(this,a));}},endEdit:function(){if(this.editing){CSS.removeClass(this.root,'editMode');this.editor.endEdit();this.editor=null;this.editing=false;this._updateTrackingData();}},_updateTrackingData:function(a){var b=this.root.getAttribute('data-gt')||"{}";try{b=JSON.parse(b);if(this.editing){b.editing=true;}else delete b.editing;this.root.setAttribute('data-gt',JSON.stringify(b));}catch(c){}},_initEditor:function(a){this.editor=a.getEditor();this.editor.beginEdit();}});function FutureSideNavSection(a){this.id=a.id;this.node=this.node||$(a.id);this.editEndpoint=a.editEndpoint;}copyProperties(FutureSideNavSection.prototype,{equals:function(a){return a&&a.id===this.id;},getEditor:function(){return new SortableSideNav(DOM.find(this.node,'ul.uiSideNav'),this.editEndpoint);}});function FutureSideNavItem(a,b){this.id=a.id;this.up=b;this.endpoint=a.endpoint;this.type=a.type;this.node=a.node||$(a.id);this.paths=a.path?$A(a.path):[];this.keys=a.key?$A(a.key):[];var c=this._findKeys(this.keys);this.numericKey=c.numeric||this.keys[0];this.textKey=c.text||this.keys[0];this._pathPattern=this._buildRegex(this.paths);this._keyPattern=this._buildRegex(this.keys);this.hideLoading();this.hideSelected();}copyProperties(FutureSideNavItem.prototype,{equals:function(a){return a&&a.id===this.id;},getLinkNode:function(){return (DOM.scry(this.node,'a.item')[0]||DOM.scry(this.node,'a.subitem')[0]);},matchPath:function(a){return this._matchInput(this._pathPattern,a);},matchKey:function(a){return this._matchInput(this._keyPattern,a);},_matchInput:function(a,b){var c=a&&a.exec(b);return c&&c.slice(1);},getTop:function(){return this.isTop()?this:this.up.getTop();},isTop:function(a){return !this.up;},setCount:function(a,b){return this._updateCount(a,true);},incrementCount:function(a,b){return this._updateCount(a,false);},_updateCount:function(a,b,c){var d=DOM.scry(this.node,'span.count')[0],e=d&&DOM.scry(d,'span.countValue')[0];if(e){var f=b?0:parseInt(DOM.getText(e),10),g=Math.max(0,f+a),h=this.isTop()?'hidden':'hiddenSubitem';DOM.setContent(e,g);c&&CSS.conditionClass(this.node,h,!g);CSS.conditionClass(d,'hidden_elem',!g);if(this.isTop()){var i=DOM.scry(this.node,'div.linkWrap')[0];if(i){CSS.conditionClass(i,'noCount',!g);CSS.conditionClass(i,'hasCount',g);}}}Arbiter.inform('NavigationMessage.COUNT_UPDATE_DONE');},showLoading:function(){CSS.addClass(this.node,'loading');},hideLoading:function(){CSS.removeClass(this.node,'loading');},showSelected:function(){CSS.addClass(this.node,'selectedItem');CSS.hasClass(this.node,'hider')&&CSS.addClass(this._getExpanderParent(),'expandedMode');},hideSelected:function(){CSS.removeClass(this.node,'selectedItem');},showChildren:function(){CSS.addClass(this.node,'open');},hideChildren:function(){CSS.removeClass(this.node,'open');},_getExpanderParent:function(){return Parent.byClass(this.node,'expandableSideNav');},_buildRegex:function(a){if(a.length){var b=a.map(function(c){if(typeof c==="string"){return c.replace(/([^a-z0-9_])/ig,'\\$1');}else if(c&&c.regex)return c.regex;});return new RegExp('^(?:'+b.join('|')+')$');}},_findKeys:function(a){var b=/^(app|group|fl)_/,c={};for(var d=0;d<a.length;d++){var e=b.test(a[d]);if(e&&!c.numeric){c.numeric=a[d];}else if(!e&&!c.text)c.text=a[d];if(c.numeric&&c.text)break;}return c;}});
__d("legacy:LayerDestroyOnHide",["LayerDestroyOnHide"],function(a,b,c,d){a.LayerDestroyOnHide=b('LayerDestroyOnHide');},3);
__d("legacy:ContextualDialogX",["ContextualDialogX"],function(a,b,c,d){a.ContextualDialogX=b('ContextualDialogX');},3);
__d("legacy:Tooltip",["Tooltip"],function(a,b,c,d){a.Tooltip=b('Tooltip');},3);
__d("ClearableTypeahead",["event-extensions"],function(a,b,c,d,e,f){b('event-extensions');var g={resetOnCloseButtonClick:function(h,i){Event.listen(i,'click',function(){var j=h.getCore();j.reset();j.getElement().focus();});}};e.exports=g;});
__d("TypeaheadAreaCore",["Class","InputSelection","TypeaheadCore","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('InputSelection'),i=b('TypeaheadCore'),j=b('copyProperties');function k(l){this.parent.construct(this,l);this.matcher=new RegExp(this.matcher+'$');this.preventFocusChangeOnTab=true;}g.extend(k,i);j(k.prototype,{prefix:'',suffix:', ',matcher:"\\b[^,]*",click:bagofholding,select:function(l){this.parent.select(l);var m=this.element.value,n=this.prefix+l.text+this.suffix;this.expandBounds(m,n);var o=m.substring(0,this.start),p=m.substring(this.end);this.element.value=o+n+p;h.set(this.element,o.length+n.length);},expandBounds:function(l,m){l=l.toLowerCase().trim();m=m.toLowerCase();var n,o,p,q,r=/\s/;o=l.substring(this.start,this.end);p=m.indexOf(o);n=this.start;while(n>=0&&p>=0){q=l.charAt(n-1);if(!q||r.test(q))this.start=n;o=q+o;p=m.indexOf(o);n--;}o=l.substring(this.start,this.end);p=m.indexOf(o);n=this.end;while(n<=l.length&&p>=0){q=l.charAt(n);if(!q||r.test(q))this.end=n;o=o+q;p=m.indexOf(o);n++;}},getRawValue:function(){var l=h.get(this.element).start||0;return this.parent.getValue().substring(0,l);},getValue:function(){var l=this.matcher&&this.matcher.exec(this.getRawValue());if(!l)return '';var m=l[0],n=l.index+m.length;m=m.replace(/^\s/,'');var o=m.length;m=m.replace(/\s$/,'');var p=o-m.length;this.start=n-o;this.end=n+p;return l[1]||l[0];}});e.exports=k;});
__d("TypeaheadMetrics",["event-extensions","AsyncRequest","copyProperties","Typeahead"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h=b('copyProperties'),i=b('Typeahead');function j(k){this.extraData={};h(this,k);}h(j.prototype,{endPoint:'/ajax/typeahead/record_basic_metrics.php',init:function(k){this.init=bagofholding;this.core=k.getCore();this.view=k.getView();this.data=k.getData();this.stats={};this.sessionActive=false;this._sessionStartEvents=[];this._sessionEndEvents=[];this._reset();this.initEvents();},_reset:function(){this.stats={};this.avgStats={};this.sessionActive=false;this.sid=Math.floor(Date.now()*Math.random());this.data.setQueryData({sid:this.sid});},recordSelect:function(k){var l=k.selected;if(l.uid==null){this.recordStat('selected_id','SELECT_NULL');}else this.recordStat('selected_id',l.uid);this.recordStat('selected_type',l.type);this.recordStat('selected_position',k.index);this.recordStat('selected_with_mouse',k.clicked?1:0);this._sessionEnd();},bindSessionStart:function(k,event,l){if(l)for(var m=0;m<this._sessionStartEvents.length;++m){var n=this._sessionStartEvents[m];n.obj.unsubscribe(n.token);}this._sessionStartEvents.push({obj:k,token:k.subscribe(event,function(o,p){this._sessionStart();}.bind(this))});},bindSessionEnd:function(k,event,l){if(l)for(var m=0;m<this._sessionEndEvents.length;++m){var n=this._sessionEndEvents[m];n.obj.unsubscribe(n.token);}this._sessionEndEvents.push({obj:k,token:k.subscribe(event,function(o,p){this._sessionEnd();}.bind(this))});},initEvents:function(){this.bindSessionStart(this.core,'focus',false);this.bindSessionEnd(this.core,'blur',false);this.view.subscribe('select',function(k,l){this.recordSelect(l);}.bind(this));this.bindSessionEnd(this.view,'select',false);this.view.subscribe('render',function(k,l){this.results=l;}.bind(this));this.data.subscribe('beforeQuery',function(k,l){if(!l.value)return;this.query=l.value;this.recordCountStat('num_queries');}.bind(this));this.data.subscribe('beforeFetch',function(k,l){if(l.fetch_context.bootstrap){this.bootstrapBegin=Date.now();}else l.fetch_context.queryBegin=Date.now();}.bind(this));this.data.subscribe('fetchComplete',function(k,l){if(l.fetch_context.bootstrap){this.recordAvgStat('bootstrap_latency',Date.now()-this.bootstrapBegin);var m={};l.response.payload.entries.forEach(function(n){if(!m[n.type]){m[n.type]=1;}else m[n.type]++;});this.recordStat('bootstrap_response_types',m);this.bootstrapped=true;}else this.recordAvgStat('avg_query_latency',Date.now()-l.fetch_context.queryBegin);}.bind(this));this.data.subscribe('dirty',function(k,l){this.bootstrapped=false;});},_sessionStart:function(){if(this.sessionActive)return;this.sessionActive=true;},_sessionEnd:function(){if(!this.sessionActive)return;this.sessionActive=false;this.submit();this._reset();},recordStat:function(k,l){this.stats[k]=l;},recordCountStat:function(k){var l=this.stats[k];this.stats[k]=l?l+1:1;},recordAvgStat:function(k,l){if(this.avgStats[k]){this.avgStats[k][0]+=l;++this.avgStats[k][1];}else this.avgStats[k]=[l,1];},submit:function(){if(Object.keys(this.stats).length){h(this.stats,this.extraData);if(this.results){var k=(this.results).map(function(n,o){return n.uid;});this.recordStat('candidate_results',JSON.stringify(k));}if(this.query)this.recordStat('query',this.query);if(this.sid)this.recordStat('sid',this.sid);if(this.bootstrapped)this.recordStat('bootstrapped',1);for(var l in this.avgStats){var m=this.avgStats[l];this.stats[l]=m[0]/m[1];}new g().setURI(this.endPoint).setMethod('POST').setData({stats:this.stats}).send();this._reset();}}});j.register=function(k,l,m){if(document.activeElement===k){l.init(m);}else var n=Event.listen(k,'focus',function(){l.init(m);n.remove();});};e.exports=j;});
__d("TypeaheadHoistFriends",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._typeahead=i;}g(h.prototype,{_subscription:null,enable:function(){var i=this._typeahead.getView();this._subscription=i.subscribe('beforeRender',function(j,k){var l=[],m=[];for(var n=0;n<k.results.length;++n){var o=k.results[n];if(o.type=='user'&&o.bootstrapped){m.push(o);}else l.push(o);}k.results=m.concat(l);});},disable:function(){this._typeahead.getView().unsubscribe(this._subscription);this._subscription=null;}});e.exports=h;});
__d("legacy:HoistFriendsTypeaheadBehavior",["TypeaheadHoistFriends"],function(a,b,c,d){var e=b('TypeaheadHoistFriends');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.hoistFriends=function(f){f.enableBehavior(e);};},3);
__d("TypeaheadShowLoadingIndicator",["CSS","copyProperties"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('copyProperties');function i(j){this._typeahead=j;}h(i.prototype,{_subscription:null,enable:function(){this._subscription=this._typeahead.subscribe('loading',function(j,k){g.conditionClass(this._typeahead.getElement(),'typeaheadLoading',k.loading);g.conditionClass(this._typeahead.getView().getElement(),'typeaheadViewLoading',k.loading);}.bind(this));},disable:function(){this._typeahead.unsubscribe(this._subscription);this._subscription=null;}});e.exports=i;});
__d("legacy:ShowLoadingIndicatorTypeaheadBehavior",["TypeaheadShowLoadingIndicator"],function(a,b,c,d){var e=b('TypeaheadShowLoadingIndicator');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.showLoadingIndicator=function(f){f.enableBehavior(e);};},3);
__d("CompactTypeaheadRenderer",["DOM"],function(a,b,c,d,e,f){var g=b('DOM');function h(i,j){var k=[],l=i.photo;if(l){if(l instanceof Array){var m=[g.create('span',{className:'splitpic leftpic'},[g.create('img',{alt:'',src:l[0]})]),g.create('span',{className:'splitpic'+(l[2]?' toppic':'')},[g.create('img',{alt:'',src:l[1]})])];if(l[2])m.push(g.create('span',{className:'splitpic bottompic'},[g.create('img',{alt:'',src:l[2]})]));l=g.create('span',{className:'splitpics clearfix'},m);}else l=g.create('img',{alt:'',src:l});k.push(l);}if(i.text)k.push(g.create('span',{className:'text'},[i.text]));var n=i.subtext,o=i.category;if(n||o){var p=[];n&&p.push(n);n&&o&&p.push(" \u00b7 ");o&&p.push(o);k.push(g.create('span',{className:'subtext'},p));}var q=g.create('li',{className:i.type||''},k);q.setAttribute('role','option');if(i.text)q.setAttribute('aria-label',i.text);return q;}h.className='compact';e.exports=h;});
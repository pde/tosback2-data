(function(){var d=YAHOO.util;var g=YAHOO.lang;var f=YAHOO.widget;var c=YAHOO.util.Dom;var b=YAHOO.util.Event;var h=getPackageForName("com.forddirect.ng.util");var a=getPackageForName("com.forddirect.ng.widgets");var e=200;a.Autocomplete=function(m,i,l,j,o){this.el=m;o.maxEntries=o.maxEntries||10;var q=m.parentNode;if(!l){l=h.Dom.getElementByClassName("autocompletions","div",q);}if(!l){l=document.createElement("div");l.className="autocompletions";q.insertBefore(l,null);}var k=new f.AutoComplete(m,l,i,{maxResultsDisplayed:o.maxEntries});var p=h.Dom.getElementByClassName("autocompletions_bottom","div",q);if(!p){p=document.createElement("div");p.className="autocompletions_bottom";q.insertBefore(p,null);}var n=new f.AutoComplete(m,p,i,{maxResultsDisplayed:o.maxEntries});if(o.footerHTML){k.setFooter(o.footerHTML);n.setFooter(o.footerHTML);}if(o.reverse){k.applyLocalFilter=true;k.filterResults=function(u,s,t,r){t.results=t.results.slice(0,k.maxResultsDisplayed).reverse();return t;};}this.siteSearchInputObject=o.siteSearchInputObject;k.siteSearchInputObject=n.siteSearchInputObject=o.siteSearchInputObject;k.generateRequest=n.generateRequest=function(r){return r.replace(new RegExp("[%20]+$"),"")+"*";};k.doBeforeLoadData=n.doBeforeLoadData=function(t,r,s){if(!r.results.length){this.collapseContainer();}return true;};k.formatResult=n.formatResult=function(s,t,r){return h.Text.ellipse(r,e);};k.resultTypeList=n.resultTypeList=false;k.minQueryLength=n.minQueryLength=1;k.autoHighlight=n.autoHighlight=false;k.itemSelectEvent.subscribe(this.onItemSelect);n.itemSelectEvent.subscribe(this.onItemSelect);if(o.reverse){b.on(window,"scroll",function(u,s){var r=c.getViewportHeight()/2;var t=c.getY(m)-c.getDocumentScrollTop();if(t>r){s.autocomplete.getContainerEl().style.visibility="visible";s.autocomplete_bottom.getContainerEl().style.visibility="hidden";}else{s.autocomplete.getContainerEl().style.visibility="hidden";s.autocomplete_bottom.getContainerEl().style.visibility="visible";}},{el:m,autocomplete:k,autocomplete_bottom:n});p.style.visibility="hidden";}else{p.style.display="none";}};a.Autocomplete.prototype={onItemSelect:function(l,k){var i=null;try{i=k[2]["Location[0].DimValueName"];}catch(j){}if(i){_widgets.context.SearchContext.triggerSearch(i,this.siteSearchInputObject);}}};}());
(function(){var c=YAHOO.util.Dom;var b=YAHOO.util.Event;var f=getPackageForName("com.forddirect.ng.util");var a=getPackageForName("com.forddirect.ng.widgets");var d=getPackageForName("com.forddirect.ng.context");a.SiteSearchInput=function(i,k){k.reverse=k.reverse||false;k.maxEntries=k.maxEntries||10;k.preventEmptySubmission=(typeof(k.preventEmptySubmission)!=="undefined")?k.preventEmptySubmission:true;this.el=i;this.params=k;this.searchForm=f.Dom.getElementByClassName("site-search-form","form",this.el);this.searchText=f.Dom.getElementByClassName("site-search-input","input",this.el);this.searchButton=f.Dom.getElementByClassName("search-go","input",this.el);var h=(this.params&&this.params.autocomplete)||false;var g=(this.params.autocompleteurl||"");var j=new a.Autocomplete(this.searchText,_widgets.context.SearchContext.getAutocompleteDataSource(g),false,false,{maxEntries:k.maxEntries,reverse:k.reverse,siteSearchInputObject:this,footerHTML:(this.params.footerHTML||"")});this.searchType=(this.params.searchType||"search");_widgets.context.SearchContext.subscribe(this.searchType+"TextChange",this.handleTextChange,this,true);this.onSearchTextBlur();b.on(this.searchText,"focus",this.onSearchTextFocus,this,true);b.on(this.searchText,"blur",this.onSearchTextBlur,this,true);if(k.preventEmptySubmission){b.on(this.searchForm,"submit",this.searchSubmitPrevent,this,true);}b.on(this.searchForm,"submit",this.searchSubmitMetrics,this,true);b.on(this.searchText,"keydown",this.onSearchKeyDown,this,true);b.on(this.searchText,"click",this.onSearchTextClick,this,true);};var e=a.SiteSearchInput.prototype;e.show=function(){c.removeClass(this.el,"inactive");};e.hide=function(){c.addClass(this.el,"inactive");};e.onSearchTextFocus=function(g){if(this.searchText.value===_widgets.context.SearchContext.DEFAULT_SEARCH_STRING_NEW){this.searchText.value="";c.removeClass(this.searchText,"default-text");}else{this.searchText.select();c.removeClass(this.searchText,"default-text");}};e.onSearchTextBlur=function(g){if(this.searchText.value===""||f.Array.contains(_widgets.context.SearchContext.DEFAULT_VALUES,this.searchText.value)){if(this.searchForm.name==="endecaLiveSearchForm"){this.searchText.value=_widgets.context.SearchContext.DEFAULT_SEARCH_STRING_NEW;}else{this.searchText.value=_widgets.context.SearchContext.DEFAULT_SEARCH_STRING;}c.addClass(this.searchText,"default-text");}};e.searchSubmitPrevent=function(g){var h=f.trimString(this.searchText.value);if(h===""||f.Array.contains(_widgets.context.SearchContext.DEFAULT_VALUES,h)){this.searchText.value=_widgets.context.SearchContext.DEFAULT_NOWORD_STRING;this.searchText.focus();this.searchText.select();b.stopEvent(g);}};e.searchSubmitMetrics=function(g){if((this.el.id==="search-endeca-live")&&(this.params.widgetloc)){oMetricsTracker.trackMicroData("liveSearchAskResults");}};e.onSearchKeyDown=function(g){if(g.keyCode===13){g.returnValue=false;g.cancel=true;this.searchButton.click();}};e.handleTextChange=function(g){if(g.newValue){this.searchText.value=g.newValue;}};e.onSearchTextClick=function(g){if(f.Array.contains(_widgets.context.SearchContext.DEFAULT_VALUES,this.searchText.value)){this.searchText.value="";}};}());
var timeout=500;var closetimer=0;var ddmenuitem=0;function mclose(){if(ddmenuitem){ddmenuitem.style.visibility="hidden";}}function mclosetime(){closetimer=window.setTimeout(mclose,timeout);}function mcancelclosetime(){if(closetimer){window.clearTimeout(closetimer);closetimer=null;}}function mopen(a){mcancelclosetime();if(ddmenuitem){ddmenuitem.style.visibility="hidden";}ddmenuitem=document.getElementById(a);ddmenuitem.style.visibility="visible";}document.onclick=mclose;
(function(f,g,h){var b=f.document;var c=f.location;var d=f.console||{log:function(){}};var e=f.NextGen=f.NextGen||{};var a=g(e);e.baseURL=null;e.ready=false;e.events={AUTHENTICATION_COMPLETE_EVENT:"AUTHENTICATION_COMPLETE_EVENT",METRIC_TRACKER_EVENT:"METRIC_TRACKER_EVENT",AUTHENTICATION_STARTED:"AUTHENTICATION_STARTED",AUTHENTICATION_ENDED:"AUTHENTICATION_ENDED",AUTHENTICATION_LOGOUT_EVENT:"AUTHENTICATION_LOGOUT_EVENT",SAVE_STARTED:"SAVE_STARTED",SAVE_ENDED:"SAVE_ENDED"};e.widgets={MY_SAVED_ITEM_WIDGET_NAME:"MSI",UPGRADE_USER:"UPGRADE_USER",SAVE_WIDGET_NAME:"SAVE"};e.SaveAPI=(function(){var i=function(){};i.prototype={init:function(){},getBase:function(){return"/services/user/"+e.AuthenticationWidget.userId+"/SavedItems";},getAccessToken:function(){return e.AuthenticationWidget.accessToken;},getBrandSite:function(){return e.make==="Ford"?"www.ford.com":"www.lincoln.com";},getParameters:function(){return"accessToken="+this.getAccessToken()+"&brandSite="+this.getBrandSite();},makeRequest:function(k,l,m,j){if(typeof j==="undefined"){j=this.defaultErrorHandler;}return g.ajax(k,l).done(m).fail(j);},defaultErrorHandler:function(l,k,j){throw new Error(j);},getSavedItems:function(n,k){var m=+new Date();var j=this.getBase()+".json?"+this.getParameters()+"&t="+m;var l={type:"GET"};return this.makeRequest(j,l,n,k);},deleteSavedItems:function(m,k){var j=this.getBase()+"?"+this.getParameters();var l={type:"DELETE"};return this.makeRequest(j,l,m,k);},createConfigVehicle:function(l,o,k,n){var j;if(n){j=this.getBase()+"/ConfigVehicle/"+n+"?"+this.getParameters();}else{j=this.getBase()+"/ConfigVehicle/?"+this.getParameters();}var m={type:"POST",data:l};return this.makeRequest(j,m,o,k);},deleteConfigVehicle:function(n,m,k){var j=this.getBase()+"/ConfigVehicle/"+n+"?"+this.getParameters();var l={type:"DELETE"};return this.makeRequest(j,l,m,k);},createInventoryVehicle:function(l,o,k,n){var j;if(n){j=this.getBase()+"/InventoryVehicle/"+n+"?"+this.getParameters();}else{j=this.getBase()+"/InventoryVehicle/?"+this.getParameters();}var m={type:"POST",data:l};return this.makeRequest(j,m,o,k);},deleteInventoryVehicle:function(n,m,k){var j=this.getBase()+"/InventoryVehicle/"+n+"?"+this.getParameters();var l={type:"DELETE"};return this.makeRequest(j,l,m,k);},createCPOVehicle:function(l,o,k,n){var j;if(n){j=this.getBase()+"/CPOVehicle/"+n+"?"+this.getParameters();}else{j=this.getBase()+"/CPOVehicle/?"+this.getParameters();}var m={type:"POST",data:l};return this.makeRequest(j,m,o,k);},deleteCPOVehicle:function(n,m,k){var j=this.getBase()+"/CPOVehicle/"+n+"?"+this.getParameters();var l={type:"DELETE"};return this.makeRequest(j,l,m,k);},createBrandContent:function(l,o,k,n){var j;if(n){j=this.getBase()+"/BrandContent/"+n+"?"+this.getParameters();}else{j=this.getBase()+"/BrandContent/?"+this.getParameters();}var m={type:"POST",data:l};return this.makeRequest(j,m,o,k);},deleteBrandContent:function(n,m,k){var j=this.getBase()+"/BrandContent/"+n+"?"+this.getParameters();var l={type:"DELETE"};return this.makeRequest(j,l,m,k);},createCompareVehicle:function(l,o,k,n){var j;if(n){j=this.getBase()+"/VehicleCompare/"+n+"?"+this.getParameters();}else{j=this.getBase()+"/VehicleCompare/?"+this.getParameters();}var m={type:"POST",data:l};return this.makeRequest(j,m,o,k);},deleteCompareVehicle:function(n,m,k){var j=this.getBase()+"/InventoryVehicle/"+n+"?"+this.getParameters();var l={type:"DELETE"};return this.makeRequest(j,l,m,k);},deleteItem:function(m,n,l,k){var j;switch(m){case"image":case"video":case"technology":j="deleteBrandContent";break;case"cpo":j="deleteCPOVehicle";break;case"inventory_bp":case"inventory_si":j="deleteInventoryVehicle";break;case"config":j="deleteConfigVehicle";break;case"compare":j="deleteCompareVehicle";break;}return i[j].call(i,n,l,k);}};i=new i();return i;}());e.AuthenticationWidget=(function(){var l;var j;var i;var k;var o;var m={FACEBOOK:"/services/authentication/oauth/requesttoken/facebook?redirectUrl=",TWITTER:"/services/authentication/oauth/requesttoken/twitter?redirectUrl=",GOOGLE:"/services/authentication/openid/discovery/google?redirectUrl=",YAHOO:"/services/authentication/openid/discovery/yahoo?redirectUrl=",ANONYMOUS:"/services/authentication/aauth/requesttoken/anonymous?redirectUrl="};var n=function(){this.userId=null;this.accessToken=null;this.provider=null;this.planType=null;this.authenticationWindow=null;this.authenticationTimer=null;this.contentAfterIcon=null;this.divider=null;this.mainContentDiv=null;this.isUpgraded=false;};n.prototype={init:function(){l=e.SavePopupWidget;j=e.SaveWidget;o=e.FallbackWidget;if(!f.ThirdPartyAuthenticator){return;}i=new f.ThirdPartyAuthenticator();k=new f.AXZAuthenticator();n.contentAfterIcon=g("#FNASW_content_after_icon");n.divider=g("#FNASW_divider");n.mainContentDiv=g("#main_content_div");n.bindHandlers();n.setProperties();},bindHandlers:function(){g(b).delegate("a[rel='ng_auth_btn_']","click",function(){var p=g(this).data("provider");n.authenticateWithNextGenService(p);});},getFallbackUrl:function(){return e.baseURL+"/save/fallback";},getProviderUrl:function(q){var p=e.baseURL+m[q];if(p.indexOf("redirectUrl")>-1){p=p+n.getFallbackUrl();}return p;},startPollingForUserID:function(){n.authenticationTimer=f.setTimeout(function(){var q=i.getUserId();var r=i.getProvider()||"ANONYMOUS";var p=j.saveData?j.saveData.model:"";if(n.callerWidget===e.widgets.UPGRADE_USER){if(q&&r!=="ANONYMOUS"){a.trigger(e.events.METRIC_TRACKER_EVENT,[e.events.AUTHENTICATION_ENDED,n.provider,null,p]);n.getAuthenticationStatus(true);return;}}else{if(q){a.trigger(e.events.METRIC_TRACKER_EVENT,[e.events.AUTHENTICATION_ENDED,n.provider,null,p]);n.getAuthenticationStatus(true);return;}}n.startPollingForUserID();},250);},stopPollingForUserID:function(){f.clearTimeout(n.authenticationTimer);},authenticateWithNextGenService:function(t){var p=n.getProviderUrl(t);var r="ngAuthWindow";var q="status=1,resizable=1,scrollbars=1,height=500,width=800";if(p){n.authenticationWindow=f.open(p,r,q);n.startPollingForUserID();}},setProperties:function(){n.userId=i.getUserId();n.accessToken=i.getAccessToken();n.provider=i.getProvider()||"ANONYMOUS";n.planType=k.getPlanTypeForDisplay();if(n.userId){n.setRegisteredCookie();}},logoutUser:function(){i.logoutUser();n.setProperties();a.trigger(e.events.AUTHENTICATION_LOGOUT_EVENT);},setRegisteredCookie:function(){var p=1000*60*60*24*365;h.u.cookie.set("save-registered",1,{domain:"."+e.make.toLowerCase()+".com",expires:p,path:"/"});},validateUser:function(r,t){var p=t||false;n.setProperties();n.callerWidget=r;if(n.isUpgraded){n.updateAuthScreen(false);}var q=j.saveData?j.saveData.model:"";if(n.userId){n.setRegisteredCookie();a.trigger(e.events.AUTHENTICATION_COMPLETE_EVENT,[true,n.userId,n.accessToken,n.provider,n.callerWidget,p]);}else{l.open("Sign In","#FNASW_authentication_content");a.trigger(e.events.METRIC_TRACKER_EVENT,[e.events.AUTHENTICATION_STARTED,null,null,q]);}},upgradeUser:function(){n.updateAuthScreen(true);n.callerWidget=e.widgets.UPGRADE_USER;l.open("Sign In","#FNASW_authentication_content");},updateAuthScreen:function(p){if(p){n.contentAfterIcon.hide();n.divider.hide();n.isUpgraded=true;}else{n.contentAfterIcon.show();n.divider.show();n.isUpgraded=false;}},getAuthenticationStatus:function(p){n.setProperties();n.stopPollingForUserID();if(p){l.close();a.trigger(e.events.AUTHENTICATION_COMPLETE_EVENT,[true,n.userId,n.accessToken,n.provider,n.callerWidget]);}}};n=new n();return n;}());e.SavePopupWidget=(function(){var i;var k;var j=function(){this.visible=false;this.$container=null;this.$background=null;this.$screens=null;this.$headingTitle=null;};j.prototype={init:function(){if(!f.ThirdPartyAuthenticator){return;}i=new f.ThirdPartyAuthenticator();k=e.DataCollectionWidget;j.$container=g("#nextgen_auth_save_widget_container");j.$background=g("#nextgen_auth_save_container_background");j.$screens=j.$container.find(".changable_content");j.$headingTitle=g("#FNASW_window_title");j.bindHandlers();},bindHandlers:function(){g(b).delegate("#ng_popup_close_btn","click",j.close);g(b).delegate("#nextgen_auth_save_container_background","click",j.close);},setWindowHeading:function(l){j.$headingTitle.html(l);},hideAllWindows:function(){j.$screens.hide();},open:function(l,m){j.setWindowHeading(l);j.hideAllWindows();j.$container.find(m).show();if(!j.visible){j.$background.show();j.$container.show();j.visible=true;}},close:function(){if(j.visible){j.$background.hide();j.$container.hide();j.visible=false;}}};j=new j();return j;}());e.FallbackWidget=(function(){var j=function(){};if(!f.ThirdPartyAuthenticator){return;}var i=new f.ThirdPartyAuthenticator();j.prototype={init:function(){f.resizeTo(800,500);j.bindHandlers();},hideConciergeButton:function(){var m=i.getProvider()||"ANONYMOUS";var l=h.u.cookie.get("authenticatedDomain");var k=g("#baseurl").data("baseurl");if((k.toLowerCase().indexOf(l)<0)||(m==="ANONYMOUS")){g(b).find("#fallback_goto_concierge_btn").css("display","none");g(b).find("#fallback_ok_btn").css("margin-left","97px");return false;}},bindHandlers:function(){g(b).delegate("#fallback_ok_btn","click",j.closeWindow);g(b).delegate("#fallback_goto_concierge_btn","click",j.openconcierge);},openconcierge:function(){f.opener.document.location.href=g("#baseurl").data("baseurl")+"/concierge";f.close();},closeWindow:function(){f.open("","_self","");f.close();}};j=new j();return j;}());e.SaveWidget=(function(){var l;var m;var k;var p;var B;var r;var x=/<sup\\?>(\d+|[\u2020\u2021]+|&dagger;)<\/sup\\?>/gi;var y=/<\/?\w+\s*\/?\\?>/gi;var v=function(C){if(C){C=C.replace(x,"");C=C.replace(y,"");return C;}};var o=function(C){if(C){C=C.replace(/\\/gi,"");return C;}};var j="%E2%80%A6";var u=j.length;var w=200-u;var n=500-u;var A=200-u;var z="Add a note...";var t=22+"px";var i=function(D,C){var E;D=D.replace(/[^a-z0-9\s,\.\|]/gi,function(F){return encodeURIComponent(F);});if(D.length>C){D=D.slice(0,C);E=D.lastIndexOf(" ");if(E>-1){D=D.slice(0,E);}D=D+j;}return D;};var q=function(){this.saveData=null;};q.prototype={init:function(){if(!f.ThirdPartyAuthenticator){return;}l=e.AuthenticationWidget;m=e.SaveAPI;k=e.SavePopupWidget;p=e.DataCollectionWidget;B=new f.AXZAuthenticator();r=new f.ThirdPartyAuthenticator();q.planType=B.getPlanTypeForServices();q.bindHandlers();},bindHandlers:function(){a.bind(e.events.AUTHENTICATION_COMPLETE_EVENT,q.resumeSave);g(b).delegate("#submit_btn","click",q.validate);g(b).delegate("#continue_btn","click",k.close);g(b).delegate("#goto_save_btn","click",q.gotoMySavedItem);g(b).delegate("#cancel_btn","click",k.close);g(b).delegate("#FNASW_ng_notes","click",q.clearTextInput);g(b).delegate("#FNASW_ng_notes","keyup",q.expandTextArea);g(b).delegate("#concierge_continue_btn","click",k.close);g(b).delegate("#schedule_dealer_btn","click",q.scheduleDealerFlip);},scheduleDealerFlip:function(){k.close();shopOpenScheduleDealer();},validate:function(){var C=g("#FNASW_ng_save_title").val();var D=g("#FNASW_ng_notes").val();if(D===z){D="";}if(C){q.saveData.title=C.replace(/</gi,"").replace(/>/gi,"");q.saveData.notes=D;q.selectServiceAndCall(q.saveData);}else{f.alert("Title field cannot be empty");}},clearTextInput:function(D){var C=g(this).val();if(C===z){g(this).val("");}},expandTextArea:function(C){while(g(this).outerHeight()<this.scrollHeight+parseFloat(g(this).css("borderTopWidth"))+parseFloat(g(this).css("borderBottomWidth"))){if(parseInt(g(this).height(),10)>=70){break;}else{g(this).height(g(this).height()+1);}}},gotoMySavedItem:function(){c.href=e.baseURL+"/mysaveditems";},loadErrorScreen:function(){k.open("Error","#FNASW_save_auth_error_content");},loadMaxItemsReachedErrorScreen:function(){var C={channel:s.channel,hier1:s.hier1,evar11:s.eVar11};p.clickMetrics("max-saved-items",C);k.open("Maximum Saved Items","#FNASW_save_max_item_error_content");},loadSuccessScreen:function(){var C=g("#FNASW_window_title").text();if(C==="Concierge"){if(q.saveData.thumbnailUrl!=="na"){g("#FNASW_concierge_save_success_content #ng_save_item_image").attr("src",q.saveData.thumbnailUrl);}g("#FNASW_concierge_save_success_content #FNASW_vehicle_info").html(q.saveData.title);if(q.saveData.itemType==="config"||q.saveData.itemType==="inventory_si"||q.saveData.itemType==="inventory_bp"){g("#FNASW_concierge_save_success_content #schedule_dealer_btn").css("display","block");}else{g("#FNASW_concierge_save_success_content #schedule_dealer_btn").css("display","none");}k.open("Concierge","#FNASW_concierge_save_success_content");}else{if(q.saveData.thumbnailUrl!=="na"){g("#FNASW_save_success_content #ng_save_item_image").attr("src",q.saveData.thumbnailUrl);}k.open("Save An Item","#FNASW_save_success_content");}},loadSaveScreen:function(D){var C=D||false;if(q.saveData){a.trigger(e.events.METRIC_TRACKER_EVENT,[e.events.SAVE_STARTED,null,null,q.saveData.model]);if(q.saveData.thumbnailUrl==="na"){g("#ng_save_item_image").addClass("ng_save_item_hide_thumbnail");}else{g("#ng_save_item_image").attr("src",q.saveData.thumbnailUrl);}g("#FNASW_ng_notes").val(z).height(t);g("#FNASW_ng_save_title").val(q.saveData.title);if(C){k.open("Concierge","#FNASW_save_content");}else{k.open("Save An Item","#FNASW_save_content");}}},selectServiceAndCall:function(G){var I=G.itemType;var E=G.id||"";var C;switch(I){case"config":C="createConfigVehicle";break;case"inventory_bp":case"inventory_si":C="createInventoryVehicle";break;case"cpo":C="createCPOVehicle";break;case"image":case"video":case"technology":C="createBrandContent";break;case"compare":C="createCompareVehicle";break;default:break;}if(!C){q.loadErrorScreen();return;}G=g.extend(true,{},G);var J=["configToken","description","title","notes","price","competitorVehicleADescription","competitorVehicleBDescription"];g.each(G,function(L,M){if(g.inArray(L,J)===-1){G[L]=encodeURIComponent(M);}});if(G.title){G.title=i(G.title,w);}if(G.notes){G.notes=i(G.notes,n);}var F=function(P,L,O){var N=O.status;var M=q.saveData?q.saveData.model:"";q.loadSuccessScreen();a.trigger(e.events.METRIC_TRACKER_EVENT,[e.events.SAVE_ENDED,null,I,M]);};var D=function(){g(MySavedItems).trigger(MySavedItems.Events.DATA_REQUEST_START);};var K=function(O,N,L){var M=O.status;if(M===403){q.loadMaxItemsReachedErrorScreen();}else{q.loadErrorScreen();}};var H=function(){d.log("error");};if(E){m[C](G,D,H,E);}else{m[C](G,F,K);}},processData:function(D){D.title=o(v(D.title));D.description=o(v(D.description));D.description=i(D.title+"||"+D.description,A);var C=h.u.cookie&&h.u.cookie.zip&&h.u.cookie.zip();D.postalCode=C||"00000";if(q.planType){D.planType=q.planType;}return D;},loadSaveWidget:function(H,D){var C=g("#kill-switch-status");var E=C.data("status");var G=C.data("make").toLowerCase();var F=r.getUserId();var I=r.getProvider();q.saveData=q.processData(H);if(!f.ThirdPartyAuthenticator){return;}if(E==="on"&&G==="lincoln"){if(F===null){if(D&&D.length>0&&D.hasClass("lc-mobile-auth-trigger")){h._message_bus.send(b.body,"open-mobile-auth",{target:D,saveData:q.saveData});}else{Concierge.AuthWidget.openFlipForSave(q.saveData);}}else{if(I==="ANONYMOUS"){l.validateUser(e.widgets.SAVE_WIDGET_NAME);}else{l.validateUser(e.widgets.SAVE_WIDGET_NAME,true);}}}else{l.validateUser(e.widgets.SAVE_WIDGET_NAME);}},resumeSave:function(I,C,G,F,J,D,H){var E=H||false;if(C&&D===e.widgets.SAVE_WIDGET_NAME){q.loadSaveScreen(E);}}};q=new q();return q;}());e.DataCollectionWidget=(function(){var m;var j;var k;var i;var l=function(){};l.prototype={init:function(){if(!f.ThirdPartyAuthenticator){return;}i=new f.ThirdPartyAuthenticator();m=e.AuthenticationWidget;j=e.SaveWidget;k=e.SavePopupWidget;l.bindHandlers();l.show();l.configMetrics();},show:function(){g(b.body).addClass("ng_save");},bindHandlers:function(){a.bind(e.events.METRIC_TRACKER_EVENT,l.metric_tracker_handler);a.bind(e.events.AUTHENTICATION_COMPLETE_EVENT,l.authenticationCompleteHandler);g(b).delegate("a[rel=ng_save_bookmark]","click",l.formObjectAndInvokeSave);},formObjectAndInvokeSave:function(o){o.preventDefault();var n=g(this).readDataAttr();j.loadSaveWidget(n,g(this));},formObjectAndUpdateItem:function(n){var o=g(n).parent().readDataAttr();o.notes=g(n).parent().siblings(".msi-note-field").val();j.selectServiceAndCall(o);},authenticationCompleteHandler:function(r,n,q,p,t,o){if(n&&o===e.widgets.MY_SAVED_ITEM_WIDGET_NAME){d.log(e.widgets.MY_SAVED_ITEM_WIDGET_NAME);}else{if(n&&o===e.widgets.UPGRADE_USER){d.log(e.widgets.UPGRADE_USER);}}},metric_tracker_handler:function(p,r,v,u,o){if(u==="config"){u="bp";}if(typeof o==="undefined"){o="";}else{if(o==="SuperDuty"){o="Super Duty";}}var q={itemType:u,channel:s.channel,hier1:s.hier1,evar11:s.eVar11,evar16:o};switch(r){case e.events.SAVE_STARTED:l.clickMetrics("saveStarted",q);break;case e.events.SAVE_ENDED:l.clickMetrics("saveEnded",q);break;case e.events.AUTHENTICATION_STARTED:l.clickMetrics("authStarted",q);break;case e.events.AUTHENTICATION_ENDED:h.metrics.constructor();var n=new ThirdPartyAuthenticator();var t=n.getProfileStatus();if(t==="1"){l.clickMetrics("regComplete",q);}else{l.clickMetrics("authComplete",q);}break;default:break;}},configMetrics:function(){var u;var p=e.make.toLowerCase();if(p==="ford"){u="fv: myfolder: ";}else{u="ln: myfolder: ";}var q=function(v){return v.itemType;};var t=function(v){return v.channel;};var n=function(v){return v.hier1;};var r=function(v){return v.evar11;};var o=function(v){if(v.evar16){return p+" "+v.evar16.toLowerCase();}return"";};h.metrics.config({click:{saveStarted:{pe:"o",prop5:"myfolder: start",pev2:u+"save item: start",channel:t,hier1:n,prop11:r,eVar11:r,eVar16:o,prop16:o},saveEnded:{pe:"o",prop5:"myfolder: complete",pev2:u+"save item: complete",channel:t,hier1:n,prop11:r,eVar11:r,eVar16:o,prop16:o,prop49:q,prop48:"event: save content",eVar49:q,eVar48:"event: save content",events:["event43"]},authStarted:{pe:"o",pev2:u+"login: start",channel:t,hier1:n,prop11:r,eVar11:r,eVar16:o,prop16:o,prop42:"logged out",eVar42:"logged out"},regComplete:{pe:"o",pev2:u+"login: complete",channel:t,hier1:n,prop11:r,eVar11:r,eVar16:o,prop16:o,events:["event14","event47"]},authComplete:{pe:"o",pev2:u+"login: complete",channel:t,hier1:n,prop11:r,eVar11:r,eVar16:o,prop16:o,events:["event47"]},"max-saved-items":{pe:"o",pev2:u+"saves exceeded",channel:t,hier1:n,prop11:r,eVar11:r}}});},clickMetrics:function(o,n){h.metrics.click(o,n);},pageMetrics:function(n,o){h.metrics.page(n,o);}};l=new l();return l;}());e.init=function(i){if(e.ready){return;}e.ready=true;e.baseURL=i.baseURL;e.make=i.make;e.SaveAPI.init();e.AuthenticationWidget.init();e.SavePopupWidget.init();e.SaveWidget.init();e.DataCollectionWidget.init();};g(b).ready(function(){var l=null;var k;var j;var i=f.setInterval(function(){l=g("#nextgen_auth_save_widget_container");if(l.length){f.clearInterval(i);k=l.data("baseUrl");j=l.data("make");e.init({baseURL:k,make:j});h._message_bus.listen(b.body,"lc-init",function(){h._message_bus.send(b.body,"nextgen-loaded");});}},100);if(g("#fallback_ok_btn").length){e.FallbackWidget.init();e.FallbackWidget.hideConciergeButton();}});}(window,jQuery,ngbs));
ngbs.widget("lad-header-form",function(a,b){var c=function(d){this.$container=d;this.init();};c.prototype={init:function(){var d=this;var f=jQuery(document.body);this.updateZipCode();if(__params){var e="skin-"+__params.make.toLowerCase();if(!f.hasClass(e)){f.addClass(e);}}this.bindEvents();this._configMetrics();},_configMetrics:function(){ngbs.metrics.config({click:{"zipcode-flip-submit":{channel:true,hier11:true,eVar11:true,prop11:true,prop5:"find dealer: submit zip code",eVar16:function(d){return d.nameplate;},prop16:function(d){return d.nameplate;},pev2:function(e){var d;if(e.make==="lincoln"){d="ln:vehicle:dealerships:zip code flip:submit zip";}else{d="dd:vehicle:dealerships:zip code flip:submit zip";}return d;}}}});},bindEvents:function(){var d=this;this.$container.on("click","button",function(){d.submitForm();});this.$container.on("keypress",".zip-form",function(){d.clearErrorMessage();});this.$container.on("keypress",function(f){if(f.keyCode===13){d.submitForm();return false;}});this.$container.on("mouseover",".zip-form",function(){if(jQuery(".zip-form input").val()===""){var e=ngbs.u.cookie.getSub("FPI","zip");d.updateZipCode(e);}});},updateZipCode:function(d){if(!d){if(_widgets.context&&_widgets.context.UserContext){d=_widgets.context.UserContext.get("zIPCode");}if(!d){d=ngbs.u.cookie.getSub("FPI","zip");}}this.$container.find("input").val(d);},getZipCodeFromPosition:function(d){var e=this,g="http://ws.geonames.org/findNearbyPostalCodesJSON?formatted=true&maxRows=1",f=g+"&lat="+d.coords.latitude+"&lng="+d.coords.longitude;jQuery.getJSON(f,function(h){e.updateZipCode(h.postalCodes[0].postalCode);});},geolocate:function(){var d=this;navigator.geolocation.getCurrentPosition(function(e){var f=d.getZipCodeFromPosition(e);});},validateZipCode:function(g,h){var e=this;var f=false;var d=/^\d{5}$/;if(d.test(g)&&g!=="00000"){jQuery.ajax({url:"/services/geo/PostalCodes?postalCode="+g,success:function(k){var i=jQuery(k).find("Response").attr("status");if(i==="OK"){var j=jQuery(k).find("State").text();if(j!=="STATE-NOT-KNOWN"){f=true;}}if(f===false){e.showErrorMessage();}else{if(f){h.call(this);}}},error:function(){e.showErrorMessage();},dataType:"XML"});}else{this.showErrorMessage();}},showErrorMessage:function(){var e='<p class="error">Invalid ZIP code. Please try again.</p>';var d=this.$container.find(".zip-form");d.after(e);d.find("input").css("border-color","#f10000");this.$container.addClass("expanded");},clearErrorMessage:function(){this.$container.find(".error").remove();this.$container.find("input").css("border-color","#D9DADC");this.$container.removeClass("expanded");},submitForm:function(){var d=this;var e=this.$container.find("input").val();var f=".ford.com";this.clearErrorMessage();if(d.$container.find(".zip-form").data("host").indexOf(".dev.ngbs.digital.teamdetroit.com")!==-1){f=".teamdetroit.com";}this.validateZipCode(e,function(){ngbs.metrics.click("zipcode-flip-submit");ngbs.u.cookie.setSub("FPI","zip",e,{path:"/",domain:f});window.location.href=d.$container.find(".zip-form").data("host")+"/dealerships/locate/results?showResults=1&zipCode="+e;return false;});}};jQuery(document).ready(function(){if(b.length>0){var d=new c(b);}});});
YAHOO.util.Event.onDOMReady(function(){_instances.bsLoader.initCompleteEvent.subscribe(function(){var m=201,k=1063,r=false,l=document,d=l.getElementById("_bapw-link"),o=(l.location.protocol==="https:"),n=(o?"https":"http")+"://",p=n+(o?"a248.e.akamai.net/betterad.download.akamai.com/91609":"cdn.betrad.com")+"/pub/",q;if(d){q=function(a){var b=new Image();b.src=n+"l.betrad.com/pub/p.gif?pid="+m+"&ocid="+k+"&i"+a+"=1&r="+Math.random();};d.onmouseover=function(){if(/#$/.test(d.href)){d.href="http://info.evidon.com/pub_info/"+m+"?v=1";}};d.onclick=function(){var a=window._bap_p_overrides;function b(i,f){var h=l.getElementsByTagName("head")[0]||l.documentElement,c=r,e=l.createElement("script");function g(){e.onload=e.onreadystatechange=null;h.removeChild(e);f();}e.src=i;e.onreadystatechange=function(){if(!c&&(this.readyState==="loaded"||this.readyState==="complete")){c=true;g();}};e.onload=g;h.insertBefore(e,h.firstChild);}if(a&&a.hasOwnProperty(m)){if(a[m].new_window){q("c");return true;}}this.onclick="return"+r;b(n+"ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js",function(){b(p+"pub2.js",function(){window.BAPW.i(d,{pid:m,ocid:k});});});return r;};q("i");}});});
(function(){var c=YAHOO.util.Dom;var b=YAHOO.util.Event;var d=YAHOO.widget;var e=getPackageForName("com.forddirect.ng.util");var a=getPackageForName("com.forddirect.ng.widgets");a.BSPanel=function(h,i){var o="roundedShadow";var j;this.el=h;var f={visible:false,constraintoviewport:true,draggable:false,underlay:"none",flip:"default"};if(i){for(j in i){if(i.hasOwnProperty(j)){f[j]=i[j];}}}this.CALLING_FLIP=f.flip;f.close=false;a.BSPanel.superclass.constructor.call(this,h,f);this.render();var q=c.getElementsByClassName("container-close",null,this.el);if(q&&q.length>0){var g=q[0];b.on(g,"click",this.hide,null,this);}if(f.underlay===o){var l=["tl quoin","tr quoin","shadow-content","bl quoin","br quoin"];var n=document.createElement("div");c.addClass(n,"rounded-shadow");this.el.appendChild(n);for(j in l){if(l.hasOwnProperty(j)){var m=document.createElement("div");c.addClass(m,l[j]);n.appendChild(m);}}}};YAHOO.extend(a.BSPanel,d.Panel,{init:function(g,f){a.BSPanel.superclass.init.apply(this,arguments);this.initAttributes(g,f);},initAttributes:function(g,f){},setPanelHeader:function(h,g){var f=c.getElementsByClassName("headerText",null,this.el);if(f&&f.length>0){f[0].innerHTML=h;if(g){var i="<div class='subtitle'>"+g+"</div>";f[0].innerHTML=h+i;}}},addScroller:function(h,g,f){return null;},hide:function(){a.BSPanel.superclass.hide.apply(this,arguments);if("part-details"===this.CALLING_FLIP){e.removeModalBackground("view-bd","panel");}},show:function(){a.BSPanel.superclass.show.apply(this,arguments);if("part-details"===this.CALLING_FLIP){e.addModalBackground("view-bd","panel");}},alignTo:function(g,f){if(f&&f.elementAlign&&f.contextAlign){this.cfg.setProperty("context",[g,f.elementAlign,f.contextAlign]);this.align(f.elementAlign,f.contextAlign);}else{this.alignTo(g,a.BSPanel.ALIGN_BOTTOM_LEFT);}},update:function(){}});a.BSPanel.ALIGN_TOP_LEFT={elementAlign:"tl",contextAlign:"tl"};a.BSPanel.ALIGN_TOP_RIGHT={elementAlign:"tl",contextAlign:"tr"};a.BSPanel.ALIGN_BOTTOM_LEFT={elementAlign:"bl",contextAlign:"bl"};a.BSPanel.ALIGN_BOTTOM_RIGHT={elementAlign:"bl",contextAlign:"br"};}());
(function(){var c="com.forddirect.ng.widgets";var a=getPackageForName(c);var d=getPackageForName("com.forddirect.ng.util");var b=YAHOO.util.Dom;a.PromotionalArea=function(g,h){var j=b.getElementsByClassName("ng-widget promotional-tile","div",g);var f;for(f=0;f<j.length;f++){var e=new a.PromotionalTile(j[f],h);}};}());
(function(){var c="com.forddirect.ng.widgets";var a=getPackageForName(c);var d=getPackageForName("com.forddirect.ng.util");var b=YAHOO.util.Dom;a.PromotionalTile=function(h,i){var f=b.getElementsByClassName("promo-content","div",h);if(f&&f.length>0){var g=f[0];var e=g.getAttribute("dynamic");if(e){this.loadDynamicContent(h,g,i);}}};a.PromotionalTile.prototype.loadDynamicContent=function(g,f,i){var l=g.id;var k=f.id;var h=b.get("loading:"+k);if(h){d.Navigation.swapBlocks(k,h);}var e=f.getAttribute("promo-id");var j="?widget=promotional-tile&promo-area="+i+"&promo-id="+e;d.Navigation.swapWith(l,j);};}());
ngbs.widget("group-flip",function(a,c){function b(f){var e=this;this.currently_open=null;this.close_callback=function(){};jQuery(".close",f).click(function(){a.send(this,"close");});a.listen(f,"open",function(h,g){e.open(g,this);});a.listen(f,"close",function(){e.close(this);});a.listen(document,"close-flips",function(){a.send(f,"close");});}b.prototype.open=function(f,h){var m=jQuery(h);var e=0;var n=document.domain;if(NextGen&&NextGen.make==="Ford"){var g=jQuery("#view").outerHeight();e=Math.round(g.top)-1;}this.currently_open=h;m.addClass("active");if(f){m.data({close_callback:f.onclose||function(){}});if(f.scrollTop){m.css("top",f.scrollTop);}else{if(jQuery(".cpo-content-holder").length>0){m.css("position","absolute");m.css("top",Math.max(0,((jQuery(window).height()-m.outerHeight())/2)+jQuery(window).scrollTop())+"px");}else{m.css("top","");}}if(f.screen){m.data("has_screen",true);if(NextGen&&NextGen.make==="Lincoln"){this.$screen=jQuery('<div class="screen"></div>').insertAfter("#header").css("top","inherit");}else{this.$screen=jQuery('<div class="screen"></div>').appendTo("#view-container");}if(e>0){jQuery(".screen").height(e);}}if(jQuery(".ie8.skin-lincoln").length>0){if(jQuery(".ie-shadow").length===0){var j=m.position(),k=parseInt(m.width(),10)+50,i=parseInt(m.height(),10),l=parseInt(j.top,10)-15;this.$ieShadow=jQuery('<div class="ie-shadow"></div>').appendTo("#view");this.$ieShadow.css({top:l,width:k,height:i,display:"block"});}else{jQuery(".ie-shadow").show();}}}else{m.data({close_callback:function(){}});}if(jQuery.browser.msie){jQuery(h).find(".sharev2_elements .share-twitter").css("visibility","visible");}};b.prototype.close=function(e){jQuery(e).removeClass("active");if(jQuery(e).data().close_callback){jQuery(e).data().close_callback();}if(jQuery(e).data("has_screen")){this.$screen.remove();}if(this.$ieShadow){jQuery(".ie7 .ie-shadow, .ie8 .ie-shadow").hide();}if(jQuery.browser.msie){jQuery(e).find(".sharev2_elements .share-twitter").css("visibility","hidden");}};if(c.length){var d=new b(c);}});
(function(a,b){b.widget("overview-sidebar-social-media",function(c,e){var d=function(f){this.$element=a(f);this.$widgetGroup=this.$element.parents(".ng-widget-group");this.initialize();};d.prototype={initialize:function(){this.moveToViewSocial();this.initFacebookLike();},moveToViewSocial:function(){var g=a("#overview-sidebar-rating");var f=a("#view-social").find(".wrap");if(g.length&&f.length){this.$element.detach();this.$element.appendTo(f);this.$widgetGroup.remove();}},initFacebookLike:function(){var h=a("#overview-sidebar-facebook-like");var g=h.data();var f;if(h.length){f=document.createElement("iframe");f.src=g.url;f.scrolling="no";f.frameborder="0";f.allowTransparency="true";h.append(f);}}};e.each(function(){var f=this;var g=new d(f);});});}(jQuery,ngbs));
(function(){ngbs.metrics.config({click:{vhpSocial:{pev2:function(a){return"fv: home: exit: social: "+a.nameplate;},pe:"e",channel:"vehicle",hier1:function(a){return"vehicle:"+a.year+":"+a.segment+":"+a.nameplate;},eVar11:true,eVar12:function(a){return a.year;},eVar14:"ford",eVar15:"fordvehicles.com",eVar16:function(a){return a.nameplate;},eVar54:true,prop5:function(a){return"home: social: "+a.socialsitetitle.toLowerCase();},prop11:"fv: vehicle: home",prop12:function(a){return a.year;},prop14:"ford",prop15:"fordvehicles.com",prop16:function(a){return a.nameplate;},prop54:true}}});jQuery("#socialMediaLinks").on("click","a",function(a){a.stopPropagation();var b=jQuery(this).data();ngbs.metrics.click("vhpSocial",b);});}());
ngbs.widget("disclaimers",function(b,c){var a,d;if(c.length){if(c.length>1){a=c.filter(".ng-widget.disclaimers");}else{a=c.first();}d=document.getElementById("disclaimer-flip");a.find("#view-disclaimers").click(function(){b.send(d,"open");});b.listen(c,"disclaimer-scroll",function(i,h){var k,g,f=jQuery(d);jQuery("html,body").scrollTop(f.offset().top);if(h.footnote){k="disclaimer"+h.footnote;}else{if(h.id){k=h.id;}}b.send(d,"open");g=jQuery("#"+k);if(g.length){var j=f.find("dl");j.scrollTop(g[0].offsetTop-j[0].offsetTop);}});}});
(function(){var e=YAHOO.lang,d=YAHOO.Bubbling,b=getPackageForName("com.forddirect.ng.widgets"),c=_instances,a=_widgets,f={autoplay:1,data:[{id:1,thumb:"",video:"",image:"",duration:"",description:""}]};f.current=f.data[0].id;b.VideoPlayer=function(h,j){var g={},i=function(n,o){var m=0,l=null,p=null;this.videoMetadata=n;if(n.data&&n.data.length){for(m=0;m<n.data.length;m+=1){l=n.data[m];p=l.id;if(typeof p!=="number"){l.id=m+1;g[p]=l.id;}}if(n.current){this.setCurrentVideo(n.current);}else{this.setCurrentVideo(o||n.data[0].id);}}},k=function(){var o=this.videoMetadata,l=null,m=0;try{l=c.flashFramework.thisMovie(this.widgetId);if(l&&l.eventHandler){l.eventHandler("update",o,this.jsInstanceName+".onUpdateComplete");}}catch(n){}};j=j||{};this.el=h;this.status="";this.initCompleted=false;this.jsInstanceName=j.jsInstanceName;this.widgetId=j.widgetID||"VideoPlayer";this.bgColor=j.bgColor;this.width=j.width||1200;this.height=j.height||540;this.swfPath=j.swfPath;this.wmode=j.wmode||"transparent";this.videoStarted=false;this.emit=function(n,p,q){var m=c.flashFramework.thisMovie(this.widgetId),l=false;if(m&&m.eventHandler){try{m.eventHandler(n,p,q?(this.jsInstanceName+"."+q):null);l=true;}catch(o){}}return l;};this.getFlashID=function(m){var l=g[m]||m;return l;};this.setCurrentVideo=function(m){var l=this.getFlashID(m);if(typeof l!=="number"){throw"Cannot set the current video ID to a value that was not included in the constructor to this video player. '"+m+"' is not recognized.";}this.videoMetadata.current=l;};i.apply(this,[j.videoMetadata||f,j.initialVideoID]);this.getMetadata=function(){return this.videoMetadata;};this.resetRelaunchTrigger=function(){if(this.relaunchTrigger){clearTimeout(this.relaunchTrigger);this.relaunchTrigger=null;}};this.onInitComplete=function(){this.initCompleted=true;k.call(this);};this.onUpdateComplete=function(){this.resetRelaunchTrigger();if(this.videoMetadata.autoplay){this.videoStarted=true;}};this.onUnloadComplete=function(){if(this.el){this.el.innerHTML="";}};this.onVideoStart=function(){this.videoStarted=true;};this.onVideoEnd=function(){a.context.SelectedContext.fireEvent("fullVideoViewed",{type:"fullVideoViewed",id:this.widgetId});this.videoStarted=false;};this.onVideoLoaded=function(){};this.onContextChange=function(p){var n=p[0],l=p[1],m=null,o=null;if(n&&typeof l!=="undefined"){m=l.p1;o=l.p2;if(m&&o){a.context.SelectedContext.set(m,o);}}};this.onFlashEvent=function(n){var m=n[0],l=n[1];};this.onFlashAction=function(n){var m=n[0],l=n[1];d.triggerDefaultAction(m,l);};};e.augmentProto(b.VideoPlayer,{prototype:{init:function(g){if(!this.initCompleted){if(!g){g="";}c.flashFramework.loadFlashMovie(this.el,this.widgetId,this.swfPath,this.width,this.height,this.jsInstanceName,this.bgColor,this.wmode,g);}},launchVideo:function(g){if(this.videoStarted){this.stopVideo();}this.setCurrentVideo(g);this.emit("launchVideo",{id:this.videoMetadata.current},"onUpdateComplete");},stopVideo:function(){if(this.videoStarted){this.videoStarted=false;var h={};h.dummy="";try{c.flashFramework.thisMovie(this.widgetId).eventHandler("stopVideo",h,null);}catch(g){}}},unload:function(){try{this.stopVideo();}catch(g){this.onUnloadComplete(true);}}}});}());
(function(){var a=_widgets,c,b=false;td_site.page.videoPlayer={v:{groups:{},curOn:false,playing:{},flashVersion:9,reserved:{},dateHack:0,playerOrder:["flash","html","noplayer"],htmlCodecs:{m4v:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'}},u:{getAry:function(d){return a.context.SelectedContext.get(d);},convertAll:function(h,d){var g={},f="";d=d||a.context.SelectedContext.get(h);for(f in d){if(d.hasOwnProperty(f)){g[f]=this.convertOne(h,d[f]);}}return g;},convertOne:function(d,i){var k,f,h=i.flip?i.flip.media:i,l=i.carsid,e=null,j=null,g=null;switch(d){case"model.highlights":if(typeof l!=="undefined"){k=a.context.SelectedContext.get("model.videos");f=a.context.SiteContext.get("url.media");e=k[l];if(h.videos){j=f+e.posterboardimage;g=f+e.lowbandhiresflash;return{img:j,alt:h.images.image_1.alttag,video:g,duration:e.length,posterFrame:h.videos.video_1.posterFrame};}}else{if(h.videos){return{img:h.images.image_1.size_thumb.source,alt:h.images.image_1.alttag,video:h.videos.video_1.defaultSize.source,duration:h.videos.video_1.duration,posterFrame:h.videos.video_1.posterFrame};}}return false;case"innovationTopic.highlights":if(h.videos){return{img:h.images.image_1.size_thumb.source,alt:h.images.image_1.alttag,video:h.videos.video_1.defaultSize.source,duration:h.videos.video_1.duration,posterFrame:h.videos.video_1.posterFrame};}return false;default:return{img:h.image,alt:"",video:h.video,duration:h.duration,posterFrame:h.posterFrame};}},metrics:function(n,f,d,j,k,q){function p(){if(!b){var e=__params.make.toLowerCase()==="lincoln"?"lngen2":"fvflup";ngbs.metrics.dart({u1:function(u){var i,l=window.location.pathname;switch(l){case"/benew/":i="fordescape";break;case"/electric/focuselectric/2013/":i="ford focus electric";break;default:i="";break;}return u.nameplate||i;},u2:0,u3:0,u4:0,cat:"vidcom",type:e});c=null;}b=true;}var r=[".flv",".m4v"],o=f.toLowerCase(),t,m,h;for(m=0,h=r.length;m<h;m=m+1){t=r[m];if(o.indexOf(t,f.length-t.length)!==-1){f=f.substr(0,f.length-t.length);break;}}switch(n.type){case"seeking":s.Media.stop(f,d);clearTimeout(c);c=null;break;case"pause":s.Media.stop(f,d);clearTimeout(c);c=null;break;case"seeked":if(q.playing){c=setTimeout(function(){p();},(750*j)-(1000*d));s.Media.play(f,d);}break;case"videostart":case"play":if(!q.playing){s.Media.autoTrack=false;s.Media.trackMilestones="25,50,75,100";s.Media.playerName=k;s.Media.trackWhilePlaying=true;s.Media.segmentByMilestones=true;s.Media.trackUsingContextData=true;s.Media.contextDataMapping={"a.media.name":"eVar56,prop56","a.media.segment":"eVar55","a.media.timePlayed":"event61","a.media.view":"event56","a.media.segmentView":"event62","a.media.milestones":{25:"event58",50:"event59",75:"event57",100:"event60"}};s.Media.open(f,j,k);q.playing=true;var g=__params.make.toLowerCase()==="lincoln"?"lngen2":"fvflup";ngbs.metrics.dart({u1:function(l){var e,i=window.location.pathname;switch(i){case"/urban/":e="fordescape";break;case"/electric/focuselectric/2013/":e="ford focus electric";break;default:e="";break;}return l.nameplate||e;},u2:0,u3:0,u4:0,cat:"vidst",type:g});}if(!c){c=setTimeout(function(){p();},(750*j)-(1000*d));}s.Media.play(f,d);break;case"destroyVideo":case"ended":clearTimeout(c);if(q.playing){s.Media.stop(f,d);s.Media.close(f);q.playing=false;}c=null;b=false;break;}},inish:function(d,e){this.par=e;this.name=d;}},funs:{},play:function(d){this.v.groups[d].play();},testEnabled:function(){},addNew:function(n,d,m,h,f){var j,k,g,l;d=d||this.v.playerOrder;this.v.canPlayFlash=false;if(this.v.groups[n]){this.v.groups[n].destroyVideo();}for(j=0,k=d.length;j<k;j+=1){g=d[j];if(this.funs[g]){this.v.groups[n]=new this.funs[g](h,this,this.site,n,m);if(f){this.v.groups[n].callBack=f;}if(this.v.groups[n].enabled()){break;}delete this.funs[g];this.v.groups[n]=false;}}if(!this.v.groups[n]){for(l in this.funs){if(this.funs.hasOwnProperty(l)){this.v.groups[n]=new this.funs[l](h,this,this.site,n,m);if(this.v.groups[n].enabled()){break;}this.v.groups[n]=false;}}}this.setConfigFromObject(n,{imageurl:null,videourl:null});return this.v.groups[n];},extendExisting:function(e,d,f){this.funs[e]=f||function(){d.apply(this,arguments);};if(typeof d==="string"){d=this.funs[d];this.funs[e].prototype=new d(false,this,this.site,"",{divHolder:"x"});}else{this.funs[e].prototype=d;}this.funs[e].prototype.superclass=d;return this.funs[e].prototype;},setHolder:function(d,e){this.v.groups[d].setHolder(e);},loadVideo:function(d,f,e){if(e){if(e-this.v.dateHack<500){return;}this.v.dateHack=e;}if(this.v.groups[d].playing){this.endVideo(d);}this.v.groups[d].loadVideo(f);},hideVideo:function(d){this.v.groups[d].hideVideo();},endVideo:function(d){this.v.groups[d].endVideo();},stopVideo:function(d,e){if(typeof d==="string"){d=this.v.groups[d];}if(d&&d.stopVideo){if(this.v.curOn&&d===this.v.curOn){this.v.curOn=false;}d.stopVideo(e);}},destroyVideo:function(e){var d=this.v.groups[e];if(d&&d.destroyVideo){if(this.v.curOn&&d===this.v.curOn){this.v.curOn=false;}d.destroyVideo();}},playerReady:function(d){if(this.v.groups[d].playerReady){this.v.groups[d].playerReady(d);}},addPlayList:function(d,e){if(this.v.groups[d].addPlayList){this.v.groups[d].addPlayList(e);}},create:function(d){if(typeof d==="string"){d=this.v.groups[d];}if(!this.v.curOn||(this.v.curOn&&this.v.curOn!==d)){if((d.bOnlyOne&&this.v.curOn)||(this.v.curOn&&this.v.curOn.bOnlyOne)){this.stopVideo(this.v.curOn,true);}this.v.curOn=d;d.create();}},cueVideo:function(d,e){if(this.v.groups[d].cueVideo!==null){return this.v.groups[d].cueVideo(e);}return false;},metricEvent:function(e,f,d){d="video"+d;if(f!==false){td_site.fireThoseMetrics.yo(0,0,"",d,0,1,{videoState:{j:d,k:f}});}},hasGroup:function(d){return this.v.groups[d];},check:function(h,i,f){var d=td_site.u.clone(f),g;for(g in i){if(i.hasOwnProperty(g)&&!d[g]){if(i[g]===null){h.er.push("Missing value: "+g);}else{d[g]=i[g];}}}return{log:h,params:d};},onInitComplete:function(d){},setConfig:function(d,e,f){this.v.groups[d].setConfig(e,f);},setConfigFromObject:function(d,e){this.v.groups[d].setConfigFromObject(e);},getConfig:function(d,e){return this.v.groups[d].getConfig(e);},controls:function(d,e){if(this.v.groups[d]){this.v.groups[d].controls(e);}},dispError:function(d){},inish:td_site.inish};td_site.page.videoPlayer.distroyVideo=td_site.page.videoPlayer.destroyVideo;td_site.page.videoPlayer.playVideo=td_site.page.videoPlayer.create;td_site.inish("td_site",td_site,0);}());(function(){function b(){}var a=td_site.videoPlayer.extendExisting("base",{},function(f,g,d,e,c){this._playerConfig={};this._hashReference={};if(typeof c.divHolder==="string"){this.oDivPlayer=td_site.s.id(c.divHolder);}else{this.oDivPlayer=c.divHolder;}});a.controls=b;a.play=b;a.create=b;a.endVideo=b;a.setHolder=function(c){this.oDivPlayer=this.site.s.id(c.holder);};a.addPlayList=function(f){var e=f,d,c;this._hashReference={};if(!(f instanceof Array)){f=[];for(d in e){if(e.hasOwnProperty(d)){c=f.push(e[d])-1;f[c].id=d;this._hashReference[d]=c;}}}this.playList=f;};a.convertId=function(d){if(typeof d==="string"){var c=parseInt(d,10);if(isNaN(c)){d=this._hashReference[d];}else{d=c;}}return d;};a.getVideoById=function(c){return this.playList[this.convertId(c)];};a.setCurrentVideo=function(c){this.curVideoId=this.convertId(c);this.currentVideo=this.getVideoById(c);this.setConfig("imageurl",this.currentVideo.img);this.setConfig("videourl",this.currentVideo.video);this.setConfig("autoplay","true");};a.getNext=function(){var c=this.curVideoId+1;if(c>=this.playList.length){c=0;}return this.playList[c];};a.getPrevious=function(){var c=0;if(this.curVideoId>c){c=this.curVideoId-1;}return this.playList[c];};a.loadVideo=function(c){if(this.getVideoById(c.id)){this.setCurrentVideo(c.id);if(c.bPlay){this.create();}}};a.playVideo=a.create;a.hideVideo=function(){clearTimeout(this.metricsTO);if(this.controler){this.controler.distroy(this.par,this.name,"stopVideo");}else{this.par.distroy(this.name);}};a.stopVideo=b;a.destroyVideo=b;a.setConfig=function(c,d){this._playerConfig[c]=d;};a.setConfigFromObject=function(c){td_site.u.extend(this._playerConfig,c);};a.getConfig=function(c){return this._playerConfig[c];};a.enabled=function(){return true;};}());(function(){var a=td_site.videoPlayer.extendExisting("flash","base",function(e,f,c,d,b){this.controler=e;this.par=f;this.site=c;this.name=d;this.supported=true;this.playing=false;this.error=false;this.curVideoId=0;this.holderContents="";td_site.videoPlayer.funs.base.apply(this,arguments);if(!this.par.v.reserved.flash){this.par.v.reserved.flash={canPlayFlash:null};}this.setVars("new",b);});a.metrics=function(c){var b=this;window.setTimeout(function(){if(c.isFullscreen===true){if(!b.isFullscreen){oMetricsTracker.trackMicroData("videoPlayerFullScreen");b.isFullscreen=true;}}else{if(b.isFullscreen){b.isFullscreen=false;}}if(c.event==="nextVideoRequest"){var d;for(d in td_site.page.videoPlayer.v.groups){if(td_site.page.videoPlayer.v.groups.hasOwnProperty(d)){if(td_site.page.videoPlayer.v.groups[d].callBack){td_site.page.videoPlayer.v.groups[d].callBack.fun[td_site.page.videoPlayer.v.groups[d].callBack.cb]();}}}}else{b.par.u.metrics({type:c.videoEvent},c.videoName,c.currentTime,c.duration,c.playerName,b);}},1);};a.endVideo=function(){if(this.movie&&this.movie.eventHandler){this.movie.eventHandler("destroyVideo",{dummy:""},null);}};a.setVars=function(j,c){var d={instance:this.name,script:this.par.name,type:"",er:[]},b=__params.make.toLowerCase()==="lincoln"?"/ngtemplates/ngassets/com/lincoln/ng/widgets/video/player_lincoln.swf":"/ngtemplates/ngassets/com/forddirect/ng/widgets/video-player/player_ford.swf",f={},i,h,g;if(j==="new"){d.type="new vars";f={width:593,height:348,posterWidth:590,posterHeight:332,divReplace:false,id:"highlightVideoPlayer",bOnlyOne:true,persist:false,position:"relative",player:b,posterFrame:["<div class='td_video_posterFrame' style='border:1px solid red'>","hi","</div>"],currentVideo:{img:false,alt:false,video:false,duration:false}};i=this;}h=this.par.check(d,f,c);d=h.log;c=h.params;if(!d.er.length){for(g in c){if(c.hasOwnProperty(g)){i[g]=c[g];}}if(j==="new"){this.addPlayList(c.playList);}}else{this.par.dispError(d);this.error=true;}};a.buildFlashVars=function(f,d,b,e){var c={e:f+".v.groups['"+d+"']."+b,v:this.getConfig("videourl"),i:this.getConfig("imageurl"),p:"nextgenplayer",a:"true"};return c;};a.buildFlash=function(e,g,j,h,i,b,f){var c=this.par.site.name+"."+this.par.name,d={allowScriptAccess:"always",wmode:"opaque",quality:"high",allowFullScreen:true,bgcolor:"#000000",play:true};swfobject.embedSWF(b,i,j,h,"10",null,this.buildFlashVars(c,e,g,f.id),d);};a.onInitComplete=function(b){var c={autoplay:1,current:1,data:[this.currentVideo]};};a.onUpdateComplete=function(){};a.create=function(){var b=this.oDivPlayer;if(b){b.style.display="block";if(!this.movie){this.holderContents=document.createElement("div");this.holderContents.id=this.id;b.appendChild(this.holderContents);this.buildFlash(this.name,"metrics",this.width,this.height,this.id,this.player,{id:this.curVideoId});this.movie=document.getElementById(this.id);}b.style.display="";}};a.playVideo=a.create;a.destroyVideo=function(){if(this.movie&&this.movie.eventHandler){try{this.movie.eventHandler("destroyVideo",{dummy:""},null);}catch(b){}}swfobject.removeSWF(this.id);this.movie=null;};a.pauseVideo=function(){this.movie.eventHandler("stopVideo",{dummy:""},null);};a.enabled=function(){this.testFlash();return(this.supported&&!this.error);};a.setConfig=function(b,c){if(b==="autoplay"){c=c.toString();}td_site.videoPlayer.funs.base.prototype.setConfig.call(this,b,c);};a.testFlash=function(){var c=null,b=false;try{if(typeof ActiveXObject==="undefined"){c=document.createElement("object");c.setAttribute("type","application/x-shockwave-flash");document.body.appendChild(c);b=!!c.GetVariable;document.body.removeChild(c);}else{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b=!!c.GetVariable("$version");}}catch(d){b=false;}this.supported=this.par.v.reserved.flash.canPlayFlash=b;return this.supported;};}());(function(){var a=td_site.videoPlayer.extendExisting("noplayer","base",function(e,f,c,d,b){this.controler=e;this.par=f;this.site=c;this.name=d;this.supported=true;this.error=false;td_site.videoPlayer.funs.base.apply(this,arguments);this.setVars=function(m,g){var h={instance:this.name,script:this.par.name,type:"",er:[]},i={},l,k,j;if(m==="new"){h.type="new vars";i={width:593,height:348,posterWidth:590,posterHeight:332,divReplace:"td_future",id:"highlightVideoPlayer",persist:false,position:"relative",player:document.createElement("video"),posterFrame:["<div class='td_video_posterFrame' style='border:1px solid red'>","hi","</div>"],currentVideo:{img:false,alt:false,video:false,duration:false}};l=this;}k=this.par.check(h,i,g);h=k.log;g=k.params;if(!h.er.length){for(j in g){if(g.hasOwnProperty(j)){l[j]=g[j];}}if(m==="new"){this.addPlayList(g.playList);}this.player=false;}else{this.par.dispError(h);this.error=true;}};this.setVars("new",b);});a.create=function(){if(this.player){this.destroyVideo();}if(this.currentVideo.img){this.player=document.createElement("img");this.player.src=this.currentVideo.img;this.player.width=this.posterWidth;this.player.height=this.posterHeight;this.oDivPlayer.appendChild(this.player);}};a.destroyVideo=function(){if(this.player&&this.player.parentNode){this.player.parentNode.removeChild(this.player);delete this.player;}};}());(function(){var a=td_site.videoPlayer.extendExisting("html","base",function(e,f,c,d,b){td_site.videoPlayer.funs.base.apply(this,arguments);this.controler=e;this.par=f;this.site=c;this.name=d;this.supported=true;this.error=false;this.playing=false;this.dragTO=false;this.metricsVideoName=false;this.curVideoId=0;this.fileType="";if(this.site.v.isIpad){this.ipadIntVersion=parseInt(navigator.userAgent.toLowerCase().split("cpu os ").pop(),10);}this.setVars("new",b);});a.setVars=function(b,i){var d={instance:this.name,script:this.par.name,type:"",er:[]},k={},f,j=false,g="",c,h;if(b==="new"){d.type="new vars";k={width:593,height:348,posterWidth:590,posterHeight:332,divReplace:"td_future",id:"highlightVideoPlayer",persist:false,position:"relative",player:document.createElement("video"),bibAppendElm:"body",bibDiv:false,currentVideo:{img:false,alt:false,video:false,duration:false}};f=this;}if(!k.player){this.supported=false;return false;}if(k.player.canPlayType){for(h in this.par.v.htmlCodecs){if(this.par.v.htmlCodecs.hasOwnProperty(h)){g=k.player.canPlayType(this.par.v.htmlCodecs[h]);if(g.length){j=true;this.fileType=h;if(g==="probably"){break;}}}}}if(!j){this.supported=false;return false;}c=this.par.check(d,k,i);d=c.log;i=c.params;if(!d.er.length){for(h in i){if(i.hasOwnProperty(h)){f[h]=i[h];}}if(b==="new"){this.addPlayList(i.playList);}this.player=false;}else{this.par.dispError(d);this.error=true;}};a.play=function(){this.player.play();};a.create=function(){var c=this.oDivPlayer,d,b;this.destroyVideo();if(!this.player){this.player=this.site.s.aC(c,"video");}d=new this.site.fun.event(this,this.player,{});this.site.u.addListener(this.player,["loadedmetadata","seeked","seeking","play","pause","ended"],d.run);this.player.poster=this.currentVideo.img;this.player.controls=true;this.player.autoplay=this.getConfig("autoplay");this.player.width=this.width;this.player.height=this.height;this.player.id=this.id;b=this.currentVideo.video.split(".");this.metricsVideoName=this.currentVideo.video.split("/").pop();b.pop();b.push(this.fileType);this.player.src=b.join(".");this.player.load();this.metricsTO=this.site.u.TO(this,"setVideoSource",{site:this.site,t:this},100,false);if(this.site.v.isIpad&&this.ipadIntVersion<4){clearTimeout(this.metricsTO);}};a.playVideo=a.create;a.setVideoSource=function(){if(!this.player.readyState){this.player.load();}};a.hideVideo=function(){clearTimeout(this.metricsTO);if(this.controler){this.controler.destroy(this.par,this.name,"destroyVideo");}else{this.par.destroyVideo(this.name);}};a.stopVideo=function(){this.player.paused=true;};a.destroyVideo=function(){if(this.player){this.player.src="";this.event({type:"ended"},this.player,this,{});if(this.player.parentNode){this.player.parentNode.removeChild(this.player);}this.player=false;clearTimeout(this.metricsTO);}};a.enabled=function(){return(this.supported&&!this.error);};a.event=function(f,g,c,d){var b=c.player;c.par.u.metrics(f,c.metricsVideoName,c.player.currentTime,c.player.duration,"HTML5Player",c);switch(f.type){case"error":c.setVideoSource();break;case"loadedmetadata":break;case"click":if(c.controler&&c.controler.click){c.controler.click(c.par,c.name,d);}else{if(c.par&&c.par.click){c.par.click(c.name,d);}else{c[d.action](d);}}break;}};a.controls=function(b){this.player.controls=b;};}());(function(){var a=td_site.videoPlayer.extendExisting("skinnable-html","html",function(){td_site.videoPlayer.funs.html.apply(this,arguments);this.scrubber_width=0;this.mouse_original=0;this.time_original=0;this.volume_height=0;this.cached_controls=null;this._controls={"video-controls":{play:document.createElement("div"),replay:document.createElement("div"),nextVideo:document.createElement("div"),bar:{buffered:document.createElement("div"),played:document.createElement("div"),scrubber:document.createElement("div")},time:{current:document.createElement("time"),duration:document.createElement("time")},fullscreen:document.createElement("div"),audio:{volume:{level:document.createElement("div"),grip:document.createElement("div")},mute:document.createElement("div")}}};});a.addEventsFromObject=function(b,c){var d=new b.site.fun.event(b,c["video-controls"].play,{action:"clickPlay"});b.site.u.addListener(c["video-controls"].play,["click"],d.run);b.site.u.addListener(c["video-controls"].replay,["click"],d.run);d=new b.site.fun.event(b,c["video-controls"].audio.mute,{action:"clickMute"});b.site.u.addListener(c["video-controls"].audio.mute,["click"],d.run);d=new b.site.fun.event(b,c["video-controls"].fullscreen,{action:"clickFullScreen"});b.site.u.addListener(c["video-controls"].fullscreen,["click"],d.run);b.site.u.addListener(c["video-controls"].bar.scrubber,["mousedown"],function(){b.mousedownScrubber.apply(b,arguments);});b.site.u.addListener(c["video-controls"].nextVideo,["click"],function(){b.playNext(b);});b.site.u.addListener(c["video-controls"].audio.volume.grip,["mousedown"],function(){b.mousedownVolume.apply(b,arguments);});b.site.u.addListener(c["video-controls"].audio.mute.parentNode,["mouseover"],function(){b.mouseoverMute.apply(b,arguments);});b.site.u.addListener(c["video-controls"].audio.mute.parentNode,["mouseout"],function(){b.mouseoutMute.apply(b,arguments);});if(b.volume_height===0){b.volume_height=c["video-controls"].audio.volume.grip.parentNode.offsetHeight;}c["video-controls"].audio.volume.grip.parentNode.style.display="none";c["video-controls"].audio.volume.grip.parentNode.style.height=0;};a.clickPlay=function(){if(this.player.paused){this.player.play();}else{this.player.pause();}};a.clickFullScreen=function(){};a.clickMute=function(){this.player.muted=!this.player.muted;};a.mouseoverMute=function(f){var d=this._controls["video-controls"].audio.mute.parentNode,b=f.relatedTarget,c;while(b&&b!==d){b=b.parentNode;}if(b!==d){c=this._controls["video-controls"].audio.volume.grip.parentNode;c.style.display="block";td_site.animation.stop(c).go(c,{height:this.volume_height},1000,"exponential");}};a.mouseoutMute=function(f){var d=this._controls["video-controls"].audio.mute.parentNode,b=f.relatedTarget,c;while(b&&b!==d){b=b.parentNode;}if(b!==d){c=this._controls["video-controls"].audio.volume.grip.parentNode;td_site.animation.stop(c).go(c,{height:0},1000,"exponential",function(){c.style.display="none";});}};a.mousedownScrubber=function(c){var b=this;td_site.u.addListener(document,["mousemove"],b.mousemoveScrubber,b);td_site.u.addListener(document,["mouseup"],b.mouseupScrubber,b);this.scrubber_width=this._controls["video-controls"].bar.scrubber.parentNode.offsetWidth;this.mouse_original=c.screenX;this.time_original=this.player.currentTime;this.player.pause();};a.mousemoveScrubber=function(c,b){b.player.currentTime=((c.screenX-b.mouse_original)/b.scrubber_width)*b.player.duration+b.time_original;};a.mouseupScrubber=function(c,b){td_site.u.removeListener(document,["mousemove"],b.mousemoveScrubber);td_site.u.removeListener(document,["mouseup"],b.mouseupScrubber);b.player.play();};a.mousedownVolume=function(c){var b=this;td_site.u.addListener(document,["mousemove"],b.mousemoveVolume,b);td_site.u.addListener(document,["mouseup"],b.mouseupVolume,b);this.scrubber_width=this._controls["video-controls"].audio.volume.grip.parentNode.offsetHeight;this.mouse_original=c.screenY;this.time_original=this.player.volume;};a.mousemoveVolume=function(c,b){var d=-((c.screenY-b.mouse_original)/b.scrubber_width)+b.time_original;if(d>1){b.player.volume=1;}else{if(d<0){b.player.volume=0;}else{b.player.volume=-((c.screenY-b.mouse_original)/b.scrubber_width)+b.time_original;}}};a.mouseupVolume=function(c,b){td_site.u.removeListener(document,["mousemove"],b.mousemoveVolume);td_site.u.removeListener(document,["mouseup"],b.mouseupVolume);};a.buildElementsFromObject=function(f,b,e){var c,d;for(c in e){if(e.hasOwnProperty(c)){d=td_site.u.isDOMNode(e[c])?e[c]:this.buildElementsFromObject(f+"-"+c,document.createElement("div"),e[c]);d.id=f+"-"+c;d.className=f+"-"+c+" "+c;b.appendChild(d);}}return b;};a.updateTime=function(c,b){var d=Math.floor(b%60).toString();if(d<10){d="0"+d;}this._controls["video-controls"].time[c].innerHTML=Math.floor(b/60)+":"+d;};a.destroyVideo=function(){if(this.player){this.player.src="";if(this.player.parentNode){this.player.parentNode.removeChild(this.player);}this.player=null;clearTimeout(this.metricsTO);this.destroyControls(this.name);}};a.create=function(){var c=this.oDivPlayer,d,b;this.destroyVideo();if(this.site.v.isIpad){window.scrollBy(1,0);}if(!this.player){this.player=this.site.s.aC(c,"video");if(!this.cached_controls){this.cached_controls=this.buildControls(this.name,c);this.cached_controls=this.cached_controls.getElementsByClassName("video-controls")[0];}else{c.appendChild(this.cached_controls);}}d=new this.site.fun.event(this,this.player,{});this.site.u.addListener(this.player,["timeupdate","progress","loadeddata","volumechange","loadedmetadata","seeked","seeking","play","pause","ended"],d.run);this.player.poster=this.currentVideo.img;this.player.autoplay=this.getConfig("autoplay");this.player.width=this.width;this.player.height=this.height;b=this.currentVideo.video.split(".");this.metricsVideoName=this.currentVideo.video.split("/").pop();b.pop();b.push(this.fileType);this.player.src=b.join(".");this.player.load();if(this.site.v.isIpad){window.scrollBy(-1,0);}this.metricsTO=this.site.u.TO(this,"setVideoSource",{site:this.site,t:this},100,false);if(this.site.v.isIpad&&this.ipadIntVersion<4){clearTimeout(this.metricsTO);}};a.playVideo=a.create;a.event=function(f,c,b,e){var g=0,d=0;b.par.u.metrics(f,b.metricsVideoName,c.currentTime,c.duration,"HTML5Player",b);switch(f.type){case"play":b.hideFinalControls();td_site.u.className.add(this._controls["video-controls"].play,"pause");td_site.u.className.remove(this._controls["video-controls"].play,"play");break;case"pause":td_site.u.className.add(this._controls["video-controls"].play,"play");td_site.u.className.remove(this._controls["video-controls"].play,"pause");break;case"timeupdate":b._controls["video-controls"].bar.scrubber.style.left=((c.currentTime/c.duration)*100)+"%";b._controls["video-controls"].bar.played.style.width=((c.currentTime/c.duration)*100)+"%";b.updateTime("current",c.currentTime);break;case"loadedmetadata":b.updateTime("duration",c.duration);break;case"loadeddata":case"progress":if(c.buffered&&c.buffered.length>0){g=c.buffered.start(0);d=c.buffered.end(0)-g;}b._controls["video-controls"].bar.buffered.style.left=((g/c.duration)*100)+"%";b._controls["video-controls"].bar.buffered.style.width=((d/c.duration)*100)+"%";break;case"volumechange":b._controls["video-controls"].audio.volume.grip.style.bottom=(c.volume*100)+"%";b._controls["video-controls"].audio.volume.level.style.height=(c.volume*100)+"%";if(c.muted){td_site.u.className.add(b._controls["video-controls"].audio.mute,"muted");}else{td_site.u.className.remove(b._controls["video-controls"].audio.mute,"muted");}break;case"error":b.setVideoSource();break;case"ended":b.player.pause();b.showFinalControls(b);break;case"mouseover":case"mouseout":b[e.action](e);break;case"click":if(b.controler&&b.controler.click){b.controler.click(b.par,b.name,e);}else{if(b.par&&b.par.click){b.par.click(b.name,e);}else{b[e.action](e);}}break;}};a.showFinalControls=function(){var e,d,j,b,h,g=this._controls["video-controls"].replay,c=this._controls["video-controls"].nextVideo,k="",f=jQuery("#"+this.divHolder),i=jQuery(document.createElement("div"));if(this.playList){d=this.playList.length;if(d>1){e=this.currentVideo;b=this.getNextVideo();if(b.thumb&&b.title){g.className="carousel-video-controls-replay replay";if(this.currentVideo.posterFrame){i.addClass("videoOverlay");i.css("background","url("+this.currentVideo.posterFrame+") no-repeat top left");i.css("height",f.height()+"px");i.css("width",f.width()+"px");i.html('<div class="videoOverlay-bg"></div>');f.append(i);}k+='<img src="'+b.thumb+'"/>';k+='<p><strong>Next Video</strong><span class="next-btn-title">'+b.title+"</span>";k+='<span class="next-btn-arrow"></span></p>';c.innerHTML=k;c.style.display="block";}else{g.className=g.className+" center-replay-btn";}}else{g.className=g.className+" center-replay-btn";}g.style.display="block";}};a.hideFinalControls=function(){if(jQuery(".videoOverlay").length>0){jQuery(".videoOverlay").remove();}this._controls["video-controls"].replay.style.display="none";this._controls["video-controls"].nextVideo.style.display="none";};a.getNextVideo=function(){var d,f,c,e,b;f=parseInt(this.curVideoId,10);if(f>=(this.playList.length-1)){c=0;}else{c=f+1;}b=this.playList[c];e={vid:c,thumb:b.thumb,title:b.alt,videoSrc:b.video};return e;};a.playNext=function(){var b=this.getNextVideo();this.setCurrentVideo(b.vid);this.destroyVideo();this.create();var c;for(c in td_site.page.videoPlayer.v.groups){if(td_site.page.videoPlayer.v.groups.hasOwnProperty(c)){if(td_site.page.videoPlayer.v.groups[c].callBack){td_site.page.videoPlayer.v.groups[c].callBack.fun[td_site.page.videoPlayer.v.groups[c].callBack.cb]();}}}};a.buildControls=function(d,b){var c=null;this._controls["video-controls"].spacer=document.createElement("div");this.player.controls=false;c=this.buildElementsFromObject(d,b,this._controls);this.addEventsFromObject(this,this._controls);return c;};a.destroyControls=function(){this.cached_controls.parentNode.removeChild(this.cached_controls);};a.controls=function(b){if(this.cached_controls){if(b){this.cached_controls.style.display="block";}else{this.cached_controls.style.display="none";}}};}());
(function(){ngbs.metrics.config({click:{eff_appst:{pev2:"fv",pe:"o",eff:{category:"appst"}},eff_creditst:{pev2:"fv",pe:"o",eff:{category:"creditst"}},applyCreditFooter:{pev2:"referral:exit",pe:"e",prop5:"referral: flmc: apply for credit",prop6:"flmc:apply for credit",eVar6:"flmc:apply for credit",events:["event4"],hier1:true,channel:true,prop11:true,eVar11:true,dart:{src:"690327",type:"fvflup",cat:"credapp",u1:function(a){return a.nameplate;},u6:"0"},eff:{category:"creditst"}}}});}());
ngbs.widget("shopping-tools-list",function(a,d){function c(f){ngbs.metrics.click(f);}var b=jQuery("#tdi_globalNav_shoppingtools_div"),e=jQuery("#shopping-tools-list");b.find("a.apply-credit-link").on("click",function(f){c("eff_creditst");});b.find("a.trade-in-link").on("click",function(f){c("eff_appst");});e.find("a.apply-credit").on("click",function(f){f.stopPropagation();c("applyCreditFooter");});e.find("a.trade-in").on("click",function(f){c("eff_appst");});});
ngbs.widget("getupdates",function(r,q){var j,d,b,c,f,h={},a=["open","close","submit","setVehicle","setMode","setLock","setType"],e={"customer.language":"EN"},s=/^[a-z0-9!#\$%&'\*\-\+\/=\?\^_`{\|}~\.]+@[a-z0-9\-]+\.[a-z0-9\.\-]+/i,i="0848",p=/^0848/,o=5000,g=3;function n(t){b.each(function(){if(this.checked){this.disabled=false;}else{if(!this.checked||!t){this.disabled=t;}}});}function m(){var v,u={},t=this;v=ngbs.u.anchor.getQuery();if(v.guflip){if(v.gutitle){v.gutype="brochures";}if(v.gumode){u.mode=v.gumode.split("+");}if(v.gutype&&v.gutype==="brochures"){u.type=v.gutype;}if(v.srccode){u.listid=v.srccode;}this.open(u);}jQuery(document.body).on("click",".get-updates-link",function(x){var w=jQuery(this).data();x.preventDefault();t.open(w);});}var k=m.prototype;k._load=function(){var t=this;this.loaded=true;this.submitted=false;this.opened=false;j=q.find(".group-flip");d=j.find("form");c=d.find(".toggle");b=d.find(".vehicle-list input");f=d.find(":input");h=d.data();h.mode=h.mode.split(" ");h.vehicles=h.vehicles.split(";");if(window.MP&&window.MP.UrlLang&&window.MP.UrlLang==="es"){e["customer.language"]="SP";}d.on("submit",function(u){u.preventDefault();t.submit();});d.on("change",".toggle",function(){var u=[];c.filter(":checked").each(function(){var v=t.fordESvalue(this.value);u.push(v);});if(u.length){t.setMode(u);}else{this.checked=true;}});d.on("change",".vehicle-list input",function(){var u=b.filter(":checked").length;if(u>=g){n(true);}else{n(false);}});r.listen(j,"close",function(){t.close();});};k.open=function(t){t=t||{};if(!this.loaded){this._load();}this.setOptions(t);f.filter(':not([type="checkbox"]):not([type="radio"]):not([type="submit"])').val("");f.filter(":checked[name]").prop("checked",false);r.send(j,"close-flips");r.send(j,"open",{screen:true});this.opened=true;window.scrollTo(0,0);if(this.type==="brochures"){ngbs.metrics.page("brochures.open",{vehicles:b.filter(":checked")});}else{ngbs.metrics.page("getupdates.open",{vehicles:b.filter(":checked")});}};k.close=function(){if(!this.submitted&&this.opened){if(this.type!=="brochures"){ngbs.metrics.click("getupdates.close",{vehicles:b.filter(":checked"),mode:this.mode});}}this.opened=false;};k.setOptions=function(t){var u=t.qacodes;this.setVehicle(t.vehicles||h.vehicles);this.setMode(t.mode||h.mode);this.setLock(t.lock||h.lock);this.setType(t.type||h.type);this.setThankYou();e.listid=t.listid||h.listid;e.qacodes=h.qacodes;if(u){if(!p.test(u)){u=i+u;}e.qacodes+="|"+u;}d.removeClass("error");f.parent().removeClass("error");};k.validate=function(){var v,t=[],u=true;jQuery.each(this.mode,function(){t.push('[data-required~="'+this+'"]');});f.filter(t.join(",")).each(function(){var D=jQuery(this),B=D.val(),A=D.data(),z=D.attr("pattern"),y=false;if(B===""&&A.required){u=false;y=true;}if(z){var C=new RegExp(z);if(!C.test(B)){u=false;y=true;}}if(D.attr("type")==="email"&&!s.test(B)){u=false;y=true;}if(A.confirm){var x=f.filter('[name="'+A.confirm+'"]');if(x.val()!==B){x.parent().addClass("error");y=true;u=false;}}if(y){D.parent().addClass("error");}else{D.parent().removeClass("error");}});d.removeClass("error");if(!u){d.addClass("error");j.find(".form").scrollTop(0);if(this.type==="brochures"){var w=false;if(b.filter(":checked").eq(0).data("metricsname")==="truck commercial connection"){w=true;}ngbs.metrics.page("brochures.error",{vehicles:b.filter(":checked"),isCommConnection:w});}}return u;};k.serialize=function(){var v=d.serialize(),t=jQuery.param(e),u={make:[],model:[],year:[],brochureCode:[]};b.filter(":checked").each(function(){var w=jQuery(this).data();u.make.push(w.make);u.year.push(w.year);u.model.push(w.ngpid);u.brochureCode.push(w.brochurecode);});jQuery.each(u,function(w){v+="&"+w+"="+this.join(";");});if(t){v+="&"+t;}return v;};k.submit=function(){if(this.validate()){var u=this,t=jQuery.support.cors?"json":"jsonp";jQuery.ajax(this.action+".json",{data:this.serialize(),dataType:t,timeout:o}).fail(function(v){if(v.responseText&&v.responseText.indexOf("zipcode")!==-1){f.filter('[name="customer.address.zipcode"]').parent().addClass("error");}if(window.console&&window.console.error){window.console.log("Could not submit form: "+v.statusText+": "+v.responseText);}d.addClass("error");j.find(".form").scrollTop(0);if(u.type==="brochures"){var w=false;if(b.filter(":checked").eq(0).data("metricsname")==="truck commercial connection"){w=true;}ngbs.metrics.page("brochures.error",{vehicles:b.filter(":checked"),isCommConnection:w});}}).done(function(v){u.setThankYou(true);});}};k.setVehicle=function(t){t=typeof t==="string"?[t]:t;if(t.length>g){t.length=g;}b.each(function(){if(jQuery.inArray(jQuery(this).data("ngpid"),t)!==-1){this.checked=true;}else{this.checked=false;}});if(t.length===g){n(true);}else{n(false);}};k.setType=function(t){j.removeClass("updates brochures").addClass(t);if(t==="brochures"){this.type=t;this.action=d.data("brochuresaction");this.setMode(["email","mail"]);this.setLock("mail");}else{this.type="";this.action=d.data("action");}};k.setThankYou=function(u){var t,x=[],v="",w="thankyou";u=u||false;j.removeClass(w);if(u){t=b.filter(":checked");t.each(function(){x.push(this.value);});if(x.length){w+=" vehicles";v="<ul><li>"+x.join("</li><li>")+"</li></ul>";}jQuery("#thankyou-vehicles").html(v);j.removeClass("updates brochures").addClass(w);this.submitted=true;if(this.type==="brochures"){var y=false;if(t.eq(0).data("metricsname")==="truck commercial connection"){y=true;}ngbs.metrics.page("brochures.submit",{vehicles:t,mode:this.mode,isCommConnection:y});}else{ngbs.metrics.page("getupdates.submit",{vehicles:t,mode:this.mode});}r.send(q,"getupdates.submitted");}};k.setMode=function(u){var t=this;u=(typeof u==="string"?[u]:u);if(!u.length){return;}if(u.length===1&&u[0]==="mail"){this.action=d.data("brochuresaction");}else{this.action=d.data("action");}this.mode=u;d.removeClass("email mail").addClass(u.join(" "));c.each(function(){var v=t.fordESvalue(this.value);if(jQuery.inArray(v,u)!==-1){this.checked=true;}else{this.checked=false;}});};k.fordESvalue=function(u){var t=u;if(u==="correo electrnico"){t="email";}else{if(u==="correo"){t="mail";}}return t;};k.setLock=function(u){var t=this;c.each(function(){var v=t.fordESvalue(this.value);if(v===u){this.disabled=true;}else{this.disabled=false;}});};if(q.length){var l=new m();jQuery.each(a,function(){var t=this;r.listen(q,"getupdates."+t,function(v,u){if(!l.loaded){l._load();}l[t].call(l,u);});});}});
(function(f){var c="fv",d="fvflup",h="ford";if(window.__params&&__params.make&&__params.make==="Lincoln"){c="ln";d="lngen2";h="lincoln";}function b(j){var i=[];j=j instanceof Array?j.join(" "):j;if(j.indexOf("email")!==-1){i.push("email");j=j.replace("email","");}if(j.indexOf("mail")!==-1){i.push("postal");}return i.join("-");}function g(i,k){k=typeof k==="undefined"?": ":k;var j="";if(i.length){j=k+i.eq(0).data("metricsname");}if(j==="truck commercial connection"){j="ford truck commercial connection";}if(j===":truck commercial connection"){j=":ford truck commercial connection";}return j;}function a(i){var l,j,k="";if(i.length){l=i.eq(0).data();if(l.segment){j=l.segment;if(l.segment==="commercial-trucks"||l.segment==="commercial-truck"||l.segment==="truck"){j="truck-commercial";}}k+=j?":"+j:"";k+=l.metricsname?":"+l.metricsname:"";if(l.metricsname==="truck commercial connection"){k=":"+j+":ford truck commercial connection";}}return k;}function e(i){var j="";if(i.length){j=i.eq(0).data("year");}return j;}f.metrics.config({page:{"getupdates.open":{channel:"get updates",hier1:function(i){return"shopping tools:get updates"+a(i.vehicles);},pageName:function(i){return c+": vehicle: get updates: 1: info"+g(i.vehicles);},eVar11:c+": vehicle: get updates: 1: info",prop11:c+": vehicle: get updates: 1: info",eVar12:function(i){return e(i.vehicles);},prop12:function(i){return e(i.vehicles);},eVar16:function(i){return g(i.vehicles,"");},prop16:function(i){return g(i.vehicles,"");}},"getupdates.submit":{channel:"get updates",hier1:function(i){return"shopping tools:get updates"+a(i.vehicles);},pageName:function(i){return c+": vehicle: get updates: 2: thank you"+g(i.vehicles);},eVar11:c+": vehicle: get updates: 2: thank you",prop11:c+": vehicle: get updates: 2: thank you",eVar12:function(i){return e(i.vehicles);},prop12:function(i){return e(i.vehicles);},eVar16:function(i){return g(i.vehicles,"");},prop16:function(i){return g(i.vehicles,"");},eVar48:"get updates",prop48:"get updates",eVar49:function(i){return b(i.mode);},prop49:function(i){return b(i.mode);},prop20:function(l){var k=[],j,i,m=l.mode instanceof Array?l.mode.join(" "):l.mode;if(m.indexOf("email")!==-1){m.replace("email","");j=true;}if(m.indexOf("mail")!==-1){i=true;}if(!i&&j){return"email only opt-in";}return"email opt-in full";},prop18:"get updates",eVar28:"get updates",events:["event10","event13","event43"],dart:{type:d,cat:"up",u1:function(i){return g(i.vehicles,"").replace(" ","");},u6:0},eff:{brand:h,site:"t1",category:"up"}},"brochures.open":{channel:"brochures",hier1:function(i){return"shopping tools:brochures:"+e(i.vehicles)+a(i.vehicles);},pageName:function(i){return c+":vehicle:brochures:mailed:contact"+g(i.vehicles,":");},eVar11:c+":vehicle:brochures:mailed:contact",prop11:c+":vehicle:brochures:mailed:contact",eVar12:function(i){return e(i.vehicles);},prop12:function(i){return e(i.vehicles);},eVar16:function(i){return g(i.vehicles,"");},prop16:function(i){return g(i.vehicles,"");}},"brochures.error":{channel:"brochures",hier1:function(j){var i=null;if(j.isCommConnection){i="shopping tools:brochures";}else{i="shopping tools:brochures:"+e(j.vehicles)+a(j.vehicles);}return i;},pageName:function(i){return c+":vehicle:brochures:mailed:contact:error"+g(i.vehicles,":");},eVar11:c+":vehicle:brochures:mailed:contact:error",prop11:c+":vehicle:brochures:mailed:contact:error",eVar12:function(j){var i=null;if(!j.isCommConnection){i=e(j.vehicles);}return i;},prop12:function(j){var i=null;if(!j.isCommConnection){i=e(j.vehicles);}return i;},eVar16:function(i){var j=null;if(!i.isCommConnection){j=g(i.vehicles,"");}return j;},prop16:function(j){var i=null;if(!j.isCommConnection){i=g(j.vehicles,"");}return i;}},"brochures.submit":{channel:"brochures",hier1:function(j){var i=null;if(j.isCommConnection){i="shopping tools:brochures";}else{i="shopping tools:brochures:"+e(j.vehicles)+a(j.vehicles);}return i;},pageName:function(i){return c+":vehicle:brochures:mailed:confirm"+g(i.vehicles,":");},eVar11:c+":vehicle:brochures:mailed:confirm",prop11:c+":vehicle:brochures:mailed:confirm",eVar12:function(j){var i=null;if(!j.isCommConnection){i=e(j.vehicles);}return i;},prop12:function(j){var i=null;if(!j.isCommConnection){i=e(j.vehicles);}return i;},eVar16:function(i){var j=null;if(!i.isCommConnection){j=g(i.vehicles,"");}return j;},prop16:function(j){var i=null;if(!j.isCommConnection){i=g(j.vehicles,"");}return i;},prop18:"brochure: identified: usps",prop20:"email opt-in full",eVar28:"brochure: identified: usps",events:["event5","event13"],dart:[{type:d,cat:"br",u1:function(i){return g(i.vehicles,"").replace(" ","");},u6:0},{type:d,cat:"eopt",u1:function(i){return g(i.vehicles,"").replace(" ","");},u6:0}],eff:{brand:h,site:"t1",category:"br"}}},click:{"getupdates.close":{channel:"get updates",hier1:function(i){return"shopping tools:get updates"+a(i.vehicles);},pe:"o",pev2:function(i){return c+": vehicle: get updates: close"+g(i.vehicles);},prop5:function(i){return"get updates: close: "+b(i.mode);},eVar11:true,prop11:true,eVar12:function(i){return e(i.vehicles);},prop12:function(i){return e(i.vehicles);},eVar16:function(i){return g(i.vehicles,"");},prop16:function(i){return g(i.vehicles,"");}}}});}(ngbs));
ngbs.widget("axz-price-update",function(b,c){if(td_site.pricing.shouldShowMessage()){var a=td_site.pricing.getPlanTypeDisplay();c.find(".PlanType").html(a);td_site.pricing.setMessageShown();b.send(jQuery("#axz-price-update"),"open",{screen:true});}});
(function(){function a(f,g){var e=document.getElementsByTagName("head")[0]||document.documentElement;var d=document.createElement("script");d.async=true;d.src=f;var c=false;d.onload=d.onreadystatechange=function(){if(!c&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c=true;if(g&&typeof g==="function"){g.call(null);}d.onload=d.onreadystatechange=null;if(e&&d.parentNode){e.removeChild(d);}}};e.insertBefore(d,e.firstChild);}function b(){var d=YAHOO.util.Cookie;var f=d.get("worldApp");var e;if(f===null){var i=Math.floor(Math.random()*10000);d.set("worldApp",i,{path:"/"});var c=_widgets.context.SelectedContext.get("urlPath");var h=_widgets.context.SelectedContext.get("xmlUrlPagename");var j=_widgets.context.SelectedContext.get("xmlUrlOverride");if(c===h){e=j;}else{e=s.pageName;}var g=__params.baseURL;runInterceptRules(i.toString(),e,g);}}_instances.bsLoader.initCompleteEvent.subscribe(function(){var c=_widgets.context.SelectedContext.get("activateWorldApp");if(c==="true"){var d=_widgets.context.SelectedContext.get("worldAPjs");a(d+"/js/intercept.js",function(){b();});}});}());

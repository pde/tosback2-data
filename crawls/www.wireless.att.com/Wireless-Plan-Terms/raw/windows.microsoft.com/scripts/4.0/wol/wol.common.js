//
// Copyright (c) Microsoft Corporation.  All rights reserved.
//

function processDocumentLoaded(){var n=jQuery(".feedbackRatingButton:disabled"),t;if(n)for(t=0;t<n.length;t++)n[t].removeAttribute("disabled");jQuery(".feedbackCommentVerboseText").bind("paste",processVerboseFeedbackPaste)}function processRatingExplanationClick(n){window.open(n)}function processRatingClick(n,t,i,r,u,f){var e,o,s,h;if(!Wol.Logging){Sys.Debug.assert(!1,"Logging library is not available",!0);return}if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}return wolFeedbackId=createFeedbackId(),Wol.Logging.isEnabled()&&(e=new Wol.Logging.Logger(Wol.Logging.commonLoggerTemplate()),e.setScalar(Wol.Logging.Const.FieldName.InteractionId,Wol.Logging.Const.InteractionTypeId.Rating),e.setScalar(Wol.Logging.Const.FieldName.FeedbackId,wolFeedbackId),e.setScalar(Wol.Logging.Const.FieldName.Rating,n),e.log()),Wol.ContentInstrumentation.Logging.LogCustomBI("Rating",{Rating:n,FeedbackId:wolFeedbackId}),o=jQuery("#"+t)[0],s=jQuery("#"+i)[0],n=="0"?(jQuery("#"+r)[0].innerHTML=jQuery("#commentNoPrompt")[0].innerHTML,jQuery("#"+u)[0].value=jQuery("#commentNoYesString")[0].innerHTML,jQuery("#"+f)[0].value=jQuery("#commentNoNoString")[0].innerHTML):n=="0.5"&&(jQuery("#"+r)[0].innerHTML=jQuery("#commentSomewhatPrompt")[0].innerHTML,jQuery("#"+u)[0].value=jQuery("#commentSomewhatYesString")[0].innerHTML,jQuery("#"+f)[0].value=jQuery("#commentSomewhatNoString")[0].innerHTML),o.style.display="none",s.style.display="block",h=jQuery("#commentVerboseText")[0],h.focus(),!1}function processVerboseFeedbackKeyUp(){processTextChange()}function processVerboseFeedbackChange(){processTextChange()}function processVerboseFeedbackFocus(){processTextChange()}function processVerboseFeedbackPaste(){window.setTimeout(processTextChange,200)}function processTextChange(){var f=5,n=jQuery("#commentVerboseText")[0],e=parseInt(jQuery("#commentMaxSize")[0].innerHTML),s=parseInt(jQuery("#commentMaxEncodedSize")[0].innerHTML);n.value.length>e&&(n.value=n.value.substr(0,e));var t=escape(n.value),h=t.length,i=s-f;if(h>i){var r=t.substr(0,i),u=t.substr(i,f),o=u.lastIndexOf("%"),c;r+=o==-1?u:u.substr(0,o),n.value=unescape(r)}}function processCommentClick(n,t,i){var u,r,f,e;if(!Wol.Logging){Sys.Debug.assert(!1,"Logging library is not available",!0);return}if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}return u=jQuery("#commentVerboseText")[0],n=="1"&&u.value.length>0&&(Wol.Logging.isEnabled()&&(r=new Wol.Logging.Logger(Wol.Logging.requiredLoggerTemplate()),r.setScalar(Wol.Logging.Const.FieldName.InteractionId,Wol.Logging.Const.InteractionTypeId.VerboseFeedback),r.setScalar(Wol.Logging.Const.FieldName.FeedbackId,wolFeedbackId),setVerboseFeedback(r,u.value),r.log()),Wol.ContentInstrumentation.Logging.LogCustomBI("Feedback",{Verbatim:u.value,FeedbackId:wolFeedbackId})),f=jQuery("#"+t)[0],e=jQuery("#"+i)[0],f.style.display="none",e.style.display="block",!1}function setVerboseFeedback(n,t){var r=25,o=parseInt(jQuery("#commentMaxSize")[0].innerHTML),s=Math.ceil(o/r),u=Math.min(o,t.length),i,f,e,h;if(u!=0)for(i=0,f=1;i<u&&f<=s;)e=i+r<=u?r:u-i,h=t.substr(i,e),n.setScalar("eVar"+f,h),i=i+r,f=f+1}function createRandomFourDigitHex(){var n=Math.floor(Math.random()*65536).toString(16),t=n.length;return t==4||(n=t==3?"0"+n:t==2?"00"+n:"000"+n),n}function createFeedbackId(){return createRandomFourDigitHex()+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+createRandomFourDigitHex()+createRandomFourDigitHex()}var WolLoggingVars,link_expandAllText,link_collapseAllText,wolFeedbackId;(function(n,t){"use strict";n.es3Shims={},Object.create===t&&(n.es3Shims.create=function(i,r){function u(){}i!==null&&(u.prototype=i);var f=new u;return r!==t&&n.es3Shims.defineProperties(f,r),f},n.es3Shims.defineProperty=function(n,i,r){if(n!==null)if(r.value!==t)n[i]=r.value;else if(r.get)n[i]=r.get.call(n);else throw"Can not shim property";},n.es3Shims.defineProperties=function(n,i){var r,u;if(n!==null)for(r in i)u=i[r],u.value!==t&&(n[r]=u.value)},n.es3Shims.freeze=function(n){return n},n.es3Shims.keys=function(n){var t=[],i;for(i in n)t.push(i);return t}),n.es3Shims.bind=function(n){var i=this,t=Array.prototype.slice,r=t.call(arguments,1);return function(){return i.apply(n,r.concat(t.call(arguments)))}},Object.create=Object.create||n.es3Shims.create,Object._defineProperty=function(){if(Object.defineProperty)try{return Object.defineProperty({},"x",{}),Object.defineProperty}catch(t){return n.es3Shims.defineProperty}else return Object.defineProperty=n.es3Shims.defineProperty}(),Object.defineProperties=Object.defineProperties||n.es3Shims.defineProperties,Object.freeze=Object.freeze||n.es3Shims.freeze,Object.keys=Object.keys||n.es3Shims.keys,Function.prototype.bind=Function.prototype.bind||n.es3Shims.bind,Date.now||(Date.now=function(){return(new Date).valueOf()})})(this),function(n,t){"use strict";function i(n,i){for(var s=Object.keys(i),u,e=0,h=s.length;e<h;e++){var f=s[e],o=f.charCodeAt(0)!==95,r=i[f];if(r&&typeof r=="object"&&(r.value!==t||typeof r.get=="function"||typeof r.set=="function")){r.enumerable===t&&(r.enumerable=o),u=u||{},u[f]=r;continue}if(!o){u=u||{},u[f]={value:r,enumerable:o,configurable:!0,writable:!0};continue}n[f]=r}u&&Object.defineProperties(n,u)}(function(t){function u(n,t,r){for(var u=n,o=t.split("."),e,f=0,s=o.length;f<s;f++)e=o[f],u[e]||Object._defineProperty(u,e,{value:{},writable:!1,enumerable:!0,configurable:!0}),u=u[e];return r&&i(u,r),u}function f(t,i){return u(n,t,i)}n[t]||(n[t]=Object.create(Object.prototype));var r=n[t];r.Namespace||(r.Namespace=Object.create(Object.prototype)),Object.defineProperties(r.Namespace,{defineWithParent:{value:u,writable:!0,enumerable:!0,configurable:!0},define:{value:f,writable:!0,enumerable:!0,configurable:!0}})})("WinJS"),function(n){function t(n,t,r){return n=n||function(){},t&&i(n.prototype,t),r&&i(n,r),n}function r(n,r,u,f){if(n){r=r||function(){};var e=n.prototype;return r.prototype=Object.create(e),Object._defineProperty(r.prototype,"constructor",{value:r,writable:!0,configurable:!0,enumerable:!0}),u&&i(r.prototype,u),f&&i(r,f),r}return t(r,u,f)}function u(n){n=n||function(){};for(var t=1,r=arguments.length;t<r;t++)i(n.prototype,arguments[t]);return n}n.Namespace.define("WinJS.Class",{define:t,derive:r,mix:u})}(WinJS)}(this),function(n){"use strict";function i(n){var t="_on"+n+"state";return{get:function(){var n=this[t];return n&&n.userHandler},set:function(i){var r=this[t];i?(r||(r={wrapper:function(n){return r.userHandler(n)},userHandler:i},Object._defineProperty(this,t,{value:r,enumerable:!1,writable:!0,configurable:!0}),this.addEventListener(n,r.wrapper,!1)),r.userHandler=i):r&&(this.removeEventListener(n,r.wrapper,!1),this[t]=null)},enumerable:!0}}function r(){for(var r={},u,t=0,f=arguments.length;t<f;t++)u=arguments[t],r["on"+u]=i(u);return r}var u=n.Class.define(function(n,t,i){this.detail=t,this.target=i,this.timeStamp=Date.now(),this.type=n},{bubbles:{value:!1,writable:!1},cancelable:{value:!1,writable:!1},currentTarget:{get:function(){return this.target}},defaultPrevented:{get:function(){return this._preventDefaultCalled}},trusted:{value:!1,writable:!1},eventPhase:{value:0,writable:!1},target:null,timeStamp:null,type:null,preventDefault:function(){this._preventDefaultCalled=!0},stopImmediatePropagation:function(){this._stopImmediatePropagationCalled=!0},stopPropagation:function(){}},{supportedForProcessing:!1}),f={_listeners:null,addEventListener:function(n,t,i){var r,u,e,f;for(i=i||!1,this._listeners=this._listeners||{},r=this._listeners[n]=this._listeners[n]||[],u=0,e=r.length;u<e;u++)if(f=r[u],f.useCapture===i&&f.listener===t)return;r.push({listener:t,useCapture:i})},dispatchEvent:function(n,t){var i=this._listeners&&this._listeners[n],r,f,e;if(i){for(r=new u(n,t,this),i=i.slice(0,i.length),f=0,e=i.length;f<e&&!r._stopImmediatePropagationCalled;f++)i[f].listener(r);return r.defaultPrevented||!1}return!1},removeEventListener:function(n,t,i){var r,u,e,f;if(i=i||!1,r=this._listeners&&this._listeners[n],r)for(u=0,e=r.length;u<e;u++)if(f=r[u],f.listener===t&&f.useCapture===i){r.splice(u,1),r.length===0&&delete this._listeners[n];break}}};n.Namespace.define("WinJS.Utilities",{_createEventProperty:i,createEventProperties:r,eventMixin:f})}(WinJS),function(n){"use strict";n.fn.isVisible=function(){return this.is(":visible")&&this.css("visibility")!=="hidden"}}(jQuery),Type.registerNamespace("Wol.Util"),Wol.Util.TypeCheck={StringType:1,NumberType:2,BooleanType:4,isString:function(n){return n==undefined||n==null?!1:typeof n=="string"?!0:n instanceof String?!0:!1},isNumber:function(n){return n==undefined||n==null?!1:typeof n=="number"?!0:n instanceof Number?!0:!1},isBoolean:function(n){return n==undefined||n==null?!1:typeof n=="boolean"?!0:n instanceof Boolean?!0:!1},isOfType:function(n,t){if(Sys.Debug.assert(arguments.length==2),!Wol.Util.TypeCheck.isNumber(t))throw Error.argument("type","type must be integer!");var i=!1;return t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.StringType&&(i=Wol.Util.TypeCheck.isString(n),i==!0)?!0:t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.NumberType&&(i=Wol.Util.TypeCheck.isNumber(n),i==!0)?!0:t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.BooleanType&&(i=Wol.Util.TypeCheck.isBoolean(n),i==!0)?!0:i}},Wol.Util.Event=function(n){Sys.Debug.assert(arguments.length<=1),n?(Sys.Debug.assert(Wol.Util.TypeCheck.isString(n)),this._name=n):this._name="GenericEvent"},Wol.Util.Event.prototype={get_events:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},addHandler:function(n){Sys.Debug.assert(arguments.length==1),Sys.Debug.assert(n!=undefined&&n!=null),this.get_events().addHandler(this._name,n)},removeHandler:function(n){Sys.Debug.assert(arguments.length==1),Sys.Debug.assert(n!=undefined&&n!=null),this.get_events().removeHandler(this._name,n)},raiseEvent:function(n){Sys.Debug.assert(arguments.length<=1);var t=this.get_events().getHandler(this._name);t&&((n==undefined||n==null)&&(n=Sys.EventArgs.Empty),t(this,n))}},Wol.Util.Event.registerClass("Wol.Util.Event"),Wol.Util.RefCountEvent=function(){Wol.Util.RefCountEvent.initializeBase(this),this._handlerList=[]},Wol.Util.RefCountEvent.prototype={get_HandlersCount:function(){return this._handlerList.length},onHandlersChange:new Wol.Util.Event("on"+this._name+"_HandlersChange"),addHandler:function(n){var t=!1,i;return this._handlerList&&!Array.contains(this._handlerList,n)&&(Array.add(this._handlerList,n),t=!0),i=Wol.Util.RefCountEvent.callBaseMethod(this,"addHandler",[n]),t&&this.onHandlersChange.raiseEvent(),i},removeHandler:function(n){var t=!1,i;return this._handlerList&&(Array.remove(this._handlerList,n),t=!0),i=Wol.Util.RefCountEvent.callBaseMethod(this,"removeHandler",[n]),t&&this.onHandlersChange.raiseEvent(),i}},Wol.Util.RefCountEvent.registerClass("Wol.Util.RefCountEvent",Wol.Util.Event),Wol.Util.Tools={cloneProperties:function(n,t,i){Sys.Debug.assert(arguments.length==3),Sys.Debug.assert(n!=undefined&&n!=null),Sys.Debug.assert(t!=undefined&&t!=null),Sys.Debug.assert(i!=undefined&&i!=null&&i.length>=0);for(var r=0;r<i.length;r++)t[i[r]]=n[i[r]].clone()},parseUrlParams:function(n){var r,e,t,o;if(n===null||n==="")return{};if(typeof n!="string")throw"parseUrlParams: the input parameter must be a string";var i={},u=n.trim().split("&"),f=/[?#&]*([^=]+)(\=([^#]*))?/;for(r=0,e=u.length;r<e;r++){t=f.exec(u[r]);try{t[2]?(o=t[3].replace(/\+/g,"%20"),i[decodeURIComponent(t[1])]=jQuery.trim(decodeURIComponent(o))):i[decodeURIComponent(t[1])]=null}catch(s){}}return i},toUrlParams:function(n){var f=[],i=[],r,t,u,e;for(t in n)n.hasOwnProperty(t)&&(r=typeof n[t],r==="string"||r==="number"||r==="boolean"||n[t]===null)&&i.push(t);for(i.sort(),u=0,e=i.length;u<e;u++)value=n[i[u]],t=encodeURIComponent(i[u]),value===null?f.push(t):(value=encodeURIComponent(value).replace(/\%20/g,"+").replace(/'/g,"%27"),f.push(t+"="+value));return f.join("&")},truncateWithEllipsis:function(n,t,i){var r=n.text(),f;if(n.width()<=i)return r;var e=t+r,o=function(t){return n.text(e.substring(0,t+1)),n.width()<=i},u=Wol.Util.Algorithm.partitionPoint(e,o)-t.length;return n.text(r),u<0?"":u<2?t:(f=r.substring(0,u),f=jQuery.trim(f)+t)}},Wol.Util.OnBeforeUnload=function(){"use strict";var t=new Wol.Util.RefCountEvent("onBeforeUnloadEvent"),n=!1,i;$(function(){window.addEventListener?window.addEventListener("beforeunload",r,!0):window.attachEvent&&window.attachEvent("onbeforeunload",r)});var r=function(r){n?(clearTimeout(i),n=!1):t.raiseEvent(r)},u=function(n){t.addHandler(n)},f=function(n){t.removeHandler(n)},e=function(){n=!0,clearTimeout(i),i=setTimeout(function(){n=!1},1e3)};return{attach:u,detach:f,suppressNextEvent:e}}(),Wol.Util.HashParameters=function(){var t=!("onhashchange"in window),n;return t&&(n=function(){var i=!0,f=300,t=null,r=window.location.hash,n=new Wol.Util.RefCountEvent("hashChangeEvent"),u=function(){i&&n.get_HandlersCount()!==0?t||(t=setInterval(e,f)):(clearInterval(t),t=null)},o,e;return n.onHandlersChange.addHandler(u),o=function(t){i&&(i=!1,u()),n.raiseEvent(t)},e=function(){var t=window.location.hash;return r!==t?(r=t,n.raiseEvent(),!0):!1},{onHashChange:n}}()),{attachToHashChangeEvent:function(i){t&&n?n.onHashChange.addHandler(i):jQuery(window).bind("hashchange",i)},detachFromHashChangeEvent:function(i){t&&n?n.onHashChange.removeHandler(i):jQuery(window).unbind("hashchange",i)},getHash:function(n){var t=Wol.Util.Tools.parseUrlParams(window.location.hash);return n!==undefined?t[n.toString()]:t},setHash:function(i,r){var e=window.location.hash,u="",f=typeof i,o;if(i===undefined||f!=="object"&&f!=="string")throw"Wol.Util.HashParameters: setHash() requires an object or a string to set the hash.";else u=f==="string"?i:"#"+Wol.Util.Tools.toUrlParams(i);r===undefined&&(r=!1),e!==u&&(_hashLastValue=u,r?(o=window.location.href.split("#",1)[0],$.browser.msie&&Wol.Util.OnBeforeUnload.suppressNextEvent(),window.location.replace(o+u)):window.location.hash=u,t&&n&&n.onHashChange.raiseEvent())},setHashValue:function(n,t,i){var r=Wol.Util.HashParameters.getHash();if(n===undefined)throw"Wol.Util.HashParameters: setHashValue() parameterName must be defined";r[n]=t,Wol.Util.HashParameters.setHash(r,i)}}}(),Wol.Util.CustomEvent=function(){var n={_oSourceElement:null};return{Handlers:{},Attach:function(n,t){t!=null&&n!=null&&(this.Handlers[n]=t)},Detach:function(n){n!=null&&this.Handlers[n]&&delete this.Handlers[n]},Raise:function(t){n._oSourceElement=typeof t!="undefined"?t:null;for(var i in this.Handlers)this.Handlers[i](n._oSourceElement)}}},Wol.Util.AnchorClick=function(n){"use strict";var i=function(n){var t=n.target;do{if(t.tagName.toUpperCase()==="A")return!0;t=t.parentElement}while(t);return!1},r=function(t,i){var r=n(t),u=r.attr("href");u&&(Wol.ContentInstrumentation.Logging.FireClickEvent(i,r.get(0)),window.location=u)};return{isClickOnAnchorElement:i,clickOnAnchor:r}}(jQuery),Wol.Util.Visibility=function(n,t){"use strict";var i=function(i,r){var u=n(i),f;if(!u.length||u.length!==1||u[0].nodeType!==1)throw"element parameter must be a single valid HTML element";if(!r||typeof r!="function")throw"hideCallback parameter must be a valid function";if(u.addClass("hideListener"),f=u.data("hideListener"),f)if(typeof f!="object")throw"element data already has item 'hideListener' with an unexpected type";else if(f.hideCallbacks){if(typeof f.hideCallbacks!="object"||f.hideCallbacks.length===t)throw"element data already has item 'hideListener.hideCallback' with an unexpected type";}else f.hideCallbacks=[];else u.data("hideListener",{hideCallbacks:[]});u.data("hideListener").hideCallbacks.push(r)},r=function(i){var r=n(i),u;if(!r.length||r.length!==1||r[0].nodeType!==1)throw"rootElement parameter must be a single valid HTML element";u=this,r.find(".hideListener").each(function(){var r=n(this).data("hideListener");r&&r.hideCallbacks&&typeof r.hideCallbacks=="object"&&r.hideCallbacks.length!==t&&n.each(r.hideCallbacks,function(){typeof this=="function"&&this.call(u,i)})})};return{initHideListener:i,notifyHideListeners:r}}(jQuery),Wol.Util.Algorithm=function(){"use strict";var i=function(n,t){for(var r=0,i=n.length,u,f;i>0;)u=Math.floor(i/2),f=r+u,t(f)?(r=f+1,i=i-u-1):i=u;return r};return{partitionPoint:i}}(jQuery),Wol.Util.BrowserSpecific=function(){"use strict";var i=document.all&&!document.querySelector,r=function(){return i};return{isIE7orLower:r}}(jQuery),typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.Cookies=="undefined"&&(Ms.Wol.Cookies={}),Ms.Wol.Cookies=function(){var n={_bCookiesEnabled:null,_sCookieNs:"Ms.Wol.",_GetCookieEnabledState:function(){return n._bCookiesEnabled===null&&(document.cookie="cookiesEnabled=true;",n._bCookiesEnabled=document.cookie.indexOf("cookiesEnabled=true")>-1?!0:!1),n._bCookiesEnabled},_UniquePageIdAvailable:function(){return typeof PageData!="undefined"&&typeof PageData.TopLevelAssetSystemId!="undefined"?!0:!1},_GetUniquePageId:function(){return typeof PageData!="undefined"&&typeof PageData.TopLevelAssetSystemId!="undefined"?PageData.TopLevelAssetSystemId:null},_BuildCookie:function(t,i){var r=i?"":n._GetUniquePageId()+".";return n._sCookieNs+r+t},_GetCurrentDatePlusDays:function(n){var t=new Date;return t.setDate(t.getDate()+n),t.toUTCString()}};return{SetCookie:function(t,i,r,u){if(u||n._UniquePageIdAvailable()&&n._GetCookieEnabledState()&&t&&i){var f=typeof r=="number"?"; expires="+n._GetCurrentDatePlusDays(r):"",e="; path=/";document.cookie=n._BuildCookie(t,u)+"="+escape(i)+f+e}},SetCookieField:function(t,i,r,u,f){var o,s,e,h,c,l;if((f||n._UniquePageIdAvailable()&&n._GetCookieEnabledState())&&i&&r){if(o=this.GetCookie(t,!0),newCookieVal=i+"="+r,o)for(s=o.split("&"),e=0;e<s.length;e++)if(h=s[e],c=h.split("="),c.length===2){if(l=c[0],l==i)continue;newCookieVal+="&"+h}this.SetCookie(t,newCookieVal,u,f)}},GetCookie:function(t,i){var r,u;if(i||n._UniquePageIdAvailable()&&n._GetCookieEnabledState()&&t){var e=n._BuildCookie(t,i),f=document.cookie.split("; "),o=/^([^=]*)=(.*)/i;for(r=0;r<f.length;r++)if(u=o.exec(f[r]),u&&e===u[1])return unescape(u[2])}return null},DeleteCookie:function(n){this.SetCookie(n,"",-1,!0)},CookiesEnabled:function(){return n._GetCookieEnabledState()},CookieStringNotNullEmpty:function(n){return n?!0:!1}}}(),typeof Wol=="undefined"&&(Wol={}),typeof Wol.ContentInstrumentation=="undefined"&&(Wol.ContentInstrumentation={}),Wol.ContentInstrumentation.Logging={Max_UInt32:4294967295,Max_Int64:0x7FFFFFFFFFFFFFFF,Min_Int64:-0x7FFFFFFFFFFFFFFF,Str_NullArg:"Parameter must not be null or empty",clientBiSettingsUri:"ClientBISettings.js",customEventField:"CustomEvent",coreTags:[],coreTagsRegex:null,envDomain:null,env:null,explicitBiInitParam:"&cot=201",explicitClickEventParam:"&cot=206",explicitSamplingInitParam:"&cot=202",httpScheme:"http:",impressionFilter:"*",initLogging:null,isBiSelectorSupported:typeof document.querySelectorAll!="undefined",maxPartitionKey:"0",sampling_None:{"":{InSample:1,IsDefault:!0,FlexField:""}},sampling_Default:null,sessionDomain:".microsoft.com",scriptPath:null,scriptIsReady:!1,tagPrefix:"ms",tagRegex:null,viewDataIsReady:!1,batchBeacons:[],customEventMaps:[],clickEvents:[],samplingEvents:[],onInitComplete:null,Annotate:function(n,t,i){var r=Wol.ContentInstrumentation.Logging,u,f;try{if(n==null||n=="")throw Error.argument("dataname",r.Str_NullArg);if(u=r._getDomTarget([i,this]),u==null)throw Error.argument("element","Parameter can only be null if 'this' is a DOM element");f=r._getAnnotationName(n),jQuery(u).attr(f,t)}catch(e){r._logError(e)}},AnnotateMetatag:function(n,t){var i=Wol.ContentInstrumentation.Logging,r;try{if(n==null||n=="")throw Error.argument("dataname",i.Str_NullArg);r=i._getAnnotationName(n),i._setAnnotatedMetatag(r,t)}catch(u){i._logError(u)}},AnnotateMany:function(n,t){var i=Wol.ContentInstrumentation.Logging,r;try{if(n==null)throw Error.argument("dictionary",i.Str_NullArg);for(r in n)i.Annotate(r,n[r],t)}catch(u){i._logError(u)}},AnnotateManyMetaTag:function(n){var t=Wol.ContentInstrumentation.Logging,i;try{if(n==null)throw Error.argument("dictionary",t.Str_NullArg);for(i in n)t.AnnotateMetatag(i,n[i])}catch(r){t._logError(r)}},GetSessionID:function(){var n=Wol.ContentInstrumentation.Logging,t="",i;try{i=Wol.Mscom.sessionGuidCookieName,t=n._getCookieValue(i)}catch(r){n._logError("GetSessionID Error:"+r)}return t},GetUserHash:function(){return Wol.Mscom.userHashField},GuidTo32bit:function(n){var i=Wol.ContentInstrumentation.Logging,t=null;return n&&typeof n=="string"&&n.length===32&&(t=i.HexTo32bit(n)),t},HexTo32bit:function(n){var t=Wol.ContentInstrumentation.Logging;return t.HexToInt(n.substring(0,8))},HexToInt:function(n){var t=isNaN("0x"+n)?null:parseInt(n,16);return t&&isFinite(t)?t:null},SetSessionID:function(n){var t=Wol.ContentInstrumentation.Logging,i=Wol.Mscom,r=i.sessionGuidCookieName,u;i.previousSessionID=t.GetSessionID(),u=r+"="+escape(n)+";domain="+t.sessionDomain+";path=/",document.cookie=u,t.InitSessionID()},SetUserHash:function(n){var i=Wol.ContentInstrumentation.Logging,t=Wol.Mscom;t.userHashField!==n&&(t.userHashField=typeof n=="string"&&n.length>0&&n.length<=16?n:"")},LogCustomEventsBatch:function(n,t,i){var r=Wol.ContentInstrumentation.Logging,o=Wol.Mscom,h,e,u,f,b,k,s,g,c;if(r.initLogging===!0&&r._checkSampling(i))try{if(n==null||n=="")throw Error.argument("eventName",r.Str_NullArg);if(t==null||typeof t!="object")throw Error.argument("eventBatch","Parameter must not be a non-null array of json objects");t=jQuery.makeArray(t);var y=1800,p=o.GetBaseSrcString()+o.customEventParam,l="&"+r._getAnnotationName(n)+"=",a="%1E",w="%1D",v="";for(jQuery.each(r._getAnnotatedMetatags(),function(n,t){v+=t.shortname+"="+t.value+w}),h="",e=o.Encode(v);t.length>0;)if(u=t.pop(),typeof u=="object"){f={biDataObject:null,element:null},f.element=r._getDomTarget([u.element,u]),f.biDataObject=typeof u.biDataObject=="object"?u.biDataObject:u!==f.element?u:null,b=r._getBiDataMap(null,f.biDataObject,f.element),k="";for(s in b.Values)g=s.indexOf(r.tagPrefix)===0?s.substr(r.tagPrefix.length+1):s,k+=s+"="+b.Values[s]+w;c=o.Encode(k),y<c.length?r.LogCustomBI(n,f.biDataObject,f.element):y>=l.length+e.length+c.length+a.length?e+=a+c:(h=p+l+e,r.batchBeacons.push(h),e=o.Encode(v)+a+c)}e!==""&&(h=p+l+e,r.batchBeacons.push(h)),r._flushQueuedEvents()}catch(d){r._logError(d)}},LogCustomBI:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,e,f;if(u.initLogging===!0&&u._checkSampling(r))try{if(n==null||n=="")throw Error.argument("eventName",u.Str_NullArg);e=u._getDomTarget([i,this]),f=u._getBiDataMap(n,t,e),f.Push(u.customEventField,n),u.customEventMaps.push(f),u._flushQueuedEvents()}catch(o){u._logError(o)}},LogImpressions:function(n,t){var i=Wol.ContentInstrumentation.Logging,r,f,u,e;if(i.initLogging===!0&&i.impressionFilter!==""&&i._checkSampling(t))try{if(r=i._getDomTarget([n,this]),r==null)throw Error.argument("element","Parameter 'element' can only be null if 'this' is a DOM element");f=i._getAnnotatedComponents(r),u=jQuery(f).filter(i.impressionFilter),u.length>0&&(e=u.map(function(){return{biDataObject:null,element:this}}),i.LogCustomEventsBatch("Impression",e))}catch(o){i._logError(o)}},SetEnvironment:function(n){var t=Wol.ContentInstrumentation.Logging;n!=""&&(t.envDomain=n)},SetTagConfig:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging;try{u.tagPrefix=n,u.impressionFilter=r,u.coreTags=jQuery.map(i,function(n){return u.tagPrefix+"."+n}),u._initRegex()}catch(f){u._logError("SetTagConfig Error: "+f)}},SetClientConfig:function(n){var t=Wol.ContentInstrumentation.Logging;(n==null||n=="")&&(n="ClientBISettings.js"),n.indexOf(":")<0&&t.scriptPath!=null&&(n=t.scriptPath+n),t.clientBiSettingsUri=n},Init:function(n){var t=Wol.ContentInstrumentation.Logging,i,r;if(typeof n=="undefined"&&(n=!0),t.initLogging!=!1&&(t.initLogging=t._getLogEnabledHHSetting()&&t._getLogEnabledMetatagValue()),t.initLogging){if(t.envDomain==null||t.envDomain=="")throw Error.argument("env","WEDCS Environment has not properly initialized");t.viewDataIsReady=!0,i=!1,r=function(){i&&t.scriptIsReady&&typeof Wol.ContentInstrumentation.BiSettings!="undefined"&&(n?t.FirePageViewEvent():t._flushQueuedEvents())},typeof Ms!="undefined"&&typeof Ms.Wol!="undefined"&&typeof Ms.Wol.BIPreloadDatabag!="undefined"&&t.AnnotateManyMetaTag(Ms.Wol.BIPreloadDatabag),t.InitClientSettings(r),jQuery(document).ready(function(){i=!0,r()})}},InitClientSettings:function(n){var t=Wol.ContentInstrumentation.Logging,r,i,u;try{r=new Date,r.setMinutes(0,0,0),i=t.clientBiSettingsUri.indexOf("?")>=0?"&":"?",u=t.clientBiSettingsUri+i+"t="+r.getTime().toString(),jQuery.ajax({url:u,dataType:"script",cache:!0,success:function(){var i,r;typeof Wol.ContentInstrumentation.BiSettings!="undefined"&&(i=Wol.ContentInstrumentation.BiSettings,i.get=function(n,t){return typeof i[n]=="undefined"?t:i[n]},t.initLogging=i.get("BILog",t.initLogging),t.impressionFilter=i.get("ImpressionFilter",t.impressionFilter),t.maxPartitionKey=i.get("MaxPartitionKey",t.maxPartitionKey),t.sessionDomain=i.get("SessionDomain",t.sessionDomain),t.httpScheme=i.get("BIScheme",t.httpScheme),t.httpScheme==="auto"&&(t.httpScheme=window.location.protocol),t.env=t.httpScheme+"//"+t.envDomain,r=Wol.Mscom,r.tagPrefix=(t.tagPrefix+".").toLowerCase(),r.wedcsUriBase=t.env,r.browserDelay=i.get("BrowserDelay",r.browserDelay),r.varClickTracking=i.ClickTracking!=null&&typeof i.ClickTracking!="undefined"?i.ClickTracking:!0,t.InitSessionID(n))}})}catch(f){t._logError("InitClientSettings Error: "+f)}},InitSessionID:function(n){var t=Wol.ContentInstrumentation.Logging,r,i,u,f,e;try{r=Wol.Mscom,i=Wol.ContentInstrumentation.BiSettings,i.FlexInfo||(i.FlexInfo={}),r.InitFlexInfo(i.FlexInfo),u=function(){var e,u,f;for(r.InitRoute(i.ControlCode,i.RoutingCode,t._getPartitionKey()),t.InitSampling(),t.scriptIsReady=!0,e=[t.onInitComplete,n],u=0;u<e.length;u++)if(f=e[u],typeof f=="function"&&f!==null)try{f()}catch(o){t._logError("SessionInit Completed callback error: "+o)}},f=t.GetSessionID(),f&&f.length>0?u():(r.InitRoute(i.ControlCode,i.RoutingCode,"I"),e=r.GetBaseSrcString()+t.explicitBiInitParam,r.SendBeacon(e,u))}catch(o){t._logError("InitSessionID Error: "+o)}},InitSampling:function(){var n=Wol.ContentInstrumentation.Logging,t=Wol.ContentInstrumentation.BiSettings,r=Wol.Mscom,u,e,f,i,o,s,h;if(n.initLogging===!0&&t)try{if(u=!0,e="",t.Sampling){o=0;for(i in t.Sampling)t.Sampling.hasOwnProperty(i)&&(o++,f=t.Sampling[i],u=n._initSamplingRule(i,f)&&u,e+=f.FlexField+";");s=t.SamplingDefault||(o===1?i:""),n.sampling_Default=t.Sampling[s]||n.sampling_None}else t.Sampling=n.sampling_None,n.sampling_Default=n.sampling_None[""];u||(r.samplingInfo=e,h=r.GetBaseSrcString()+n.explicitSamplingInitParam,n.samplingEvents=[h],r.samplingInfo="")}catch(c){n._logError("InitSampling Error: "+c)}},FirePageViewEvent:function(n,t){var i=Wol.ContentInstrumentation.Logging,r;if(i.initLogging===!0)try{r=function(){i.viewDataIsReady===!0&&i.scriptIsReady===!0&&i._checkSampling(t)&&(n==null?Wol.Mscom.Init():i._logJsonPageViewEvent(n),i.LogImpressions(document.body),i._flushQueuedEvents())},r()}catch(u){i._logError("FirePageView Error: "+u)}},FireClickEvent:function(n,t,i,r,u,f){var s=Wol.ContentInstrumentation.Logging,o=Wol.Mscom,a,e,p;if(s.initLogging===!0&&s._checkSampling(f))try{a=s._getBiDataMap(null,n,t),jQuery.each(s._getAnnotatedMetatags(),function(n,t){a.Push(t.shortname,t.value)});var v=o.GetBaseSrcString(),y=o.EncodeCustomEventStr(a.ToArray()),l="",c="",h="";if(t&&(e=s._getDomTarget([t,this]),e&&e.tagName)){l=o.GetId(e);switch(e.tagName){case"A":c=e.innerText||"",h=e.href||"";break;case"IMG":c=e.alt||"",h=o.GetImageHREF(e);break;case"AREA":c=e.alt||"",h=e.href||"";break;case"INPUT":type=e.type,(type=="button"||type=="reset"||type=="submit"||type=="image"||type=="text"||type=="search")&&(p=e.value||e.name||e.alt||e.id,c=p||"",h=e.form?e.form.action||window.location.pathname:window.location.pathname)}}l=u||l,eventTile=r||c,h=i||h;var w="&cn="+o.GetUrlParameter("cn",o.Encode(eventTile))+"&cid="+o.GetUrlParameter("cid",o.Encode(l))+"&ct="+o.GetUrlParameter("ct",o.Encode(h)),b=v+s.explicitClickEventParam+w+y,k=o.EnsureBeaconSrcLength(b);s.clickEvents.push(k),s._flushQueuedEvents(),o.browserDelay>0&&o.Pause(o.browserDelay)}catch(d){s._logError("FireClickEvent Error: "+d)}},FireClickTrackingEvent:function(n,t){var i=Wol.ContentInstrumentation.Logging;if(i.initLogging===!0&&i._checkSampling(t))try{if(n==null)throw Error.argument("event",i.Str_NullArg);Wol.Mscom.ProcessClick(n)}catch(r){i._logError(r)}},_checkSampling:function(n){var t=Wol.ContentInstrumentation.Logging,r=Wol.ContentInstrumentation.BiSettings,i;return t.initLogging===!0&&t.scriptIsReady===!0?(t._flushQueuedSamplingEvents(),i=n&&(n.InSample===0||n.InSample===1)?n:t.sampling_Default,Wol.Mscom.samplingInfo=i.FlexField||"",i.InSample):!0},_getBiDataMap:function(n,t,i){var u=Wol.ContentInstrumentation.Logging,r={Values:{},Push:function(t,i){var f,e,o,s;if(i!==null&&typeof i!="undefined"&&(f=i.toString(),f!=="")){e=!1,o=u._getAnnotationName(t,n);for(s in r.Values)if(s.toLowerCase()===o.toLowerCase()){e=!0;break}e||(r.Values[o]=f)}},PushCaller:function(){var n=this;r.Push(n.name,n.value)},ToArray:function(){var n=[],t,i;for(t in r.Values)i=r.Values[t],typeof i=="string"&&n.push(t,i);return n}};if(t!=null&&jQuery.each(t,r.Push),i!=null){var f=jQuery(i),e=f.map(u._getAnnotatedData),o=f.parents().map(u._getAnnotatedData);jQuery.each(e,r.PushCaller),jQuery.each(o,r.PushCaller)}return r},_getPartitionKey:function(){var n=Wol.ContentInstrumentation.Logging,r,t,i;if(n.maxPartitionKey&&n.maxPartitionKey!=""){r=n._getRandPartition(n.maxPartitionKey),t=r;try{i=n.GetSessionID(),i!=null&&i.length>=n.maxPartitionKey.length&&(i=i.toLowerCase(),t=i.substring(0,n.maxPartitionKey.length),t=t<=n.maxPartitionKey.toLowerCase()?t:r)}catch(u){n._logError("Error determining partition key: "+u)}return t}return""},_getRandPartition:function(n){try{var t=parseInt(n,16);return Math.floor(Math.random()*(t+1)).toString(16)}catch(i){return Math.floor(Math.random()*16).toString(16)}},_getDomTarget:function(n){return jQuery.grep(n,function(n){return typeof n!="undefined"&&typeof n.nodeType!="undefined"&&n.nodeType==1}).shift()},_getElementsUnder:function(n,t){var i=jQuery(t);return jQuery(n).filter(function(){return i.has(this).length>0})},_getAnnotationName:function(n,t){var i=Wol.ContentInstrumentation.Logging;return t=t==null||typeof t!=" string"?"":t+".",i._isBiAnnotation(n)?n:i.tagPrefix+"."+t+n},_getAnnotatedData:function(){var n=this,t=Wol.ContentInstrumentation.Logging;return jQuery.map(n.attributes,function(i){var r;return t._isBiAnnotation(i.name)&&i.value!=""&&(r={domElement:n,name:i.name,shortname:i.name.substr(t.tagPrefix.length+1),value:i.value}),r})},_getCookieValue:function(n){for(var r=null,u=document.cookie.split("; "),i,t=0;t<u.length;t++)if(i=u[t].split("="),i.length===2&&i[0]===n){r=unescape(i[1]);break}return r},_initRegex:function(){var n=Wol.ContentInstrumentation.Logging;n.tagRegex=new RegExp("^"+n.tagPrefix,"i"),n.coreTagsRegex=new RegExp(n._getCoreTagsRegex(),"i")},_isBiAnnotation:function(n){var t=Wol.ContentInstrumentation.Logging.tagRegex;return t!=null?t.test(n):!1},_getComponentSelectors:function(){var n=Wol.ContentInstrumentation.Logging;return n._getHasAttributeSelectors(n.coreTags)},_getCoreTagsRegex:function(){var t=Wol.ContentInstrumentation.Logging,n=t.coreTags;return typeof n=="string"&&(n=[n]),"^("+jQuery.map(n,function(n){return t._escapeAttributeName(n)}).join("|")+")$"},_getHasAttributeSelectors:function(n){var t=Wol.ContentInstrumentation.Logging;return typeof n=="string"&&(n=[n]),jQuery.map(n,function(n){return"["+t._escapeAttributeName(n)+"]"}).join(", ")},_getAnnotatedComponents:function(n){var t=Wol.ContentInstrumentation.Logging,i=t.isBiSelectorSupported?t._getComponentSelectors():"*",r=t.isBiSelectorSupported?null:t.coreTagsRegex;return t._findChildrenByAttributes(n,i,r)},_findBySingleAttribute:function(n,t){var i=Wol.ContentInstrumentation.Logging,r=i.isBiSelectorSupported?i._getHasAttributeSelectors(t):"*",u=i.isBiSelectorSupported?null:new RegExp("^"+i._escapeAttributeName(t)+"$");return i._findChildrenByAttributes(n,r,u)},_findChildrenByAttributes:function(n,t,i){var u=Wol.ContentInstrumentation.Logging,r=u._getElementsUnder(t,n);return i!=null&&(r=jQuery.grep(r,function(n){if(n.attributes&&n.attributes.length)for(var t=0;t<n.attributes.length;t++)if(i.test(n.attributes[t].name))return!0;return!1})),r},_escapeAttributeName:function(n){return n.replace(/\./g,"\\.")},_getMetaTagSelector:function(n){return"meta[name='"+n+"']"},_getLogEnabledHHSetting:function(){try{return!(typeof window.external=="object"&&typeof window.external.NoImplicitFeedback=="boolean"&&window.external.NoImplicitFeedback==!0)}catch(n){return!0}},_getLogEnabledMetatagValue:function(){var n=Wol.ContentInstrumentation.Logging;return jQuery(n._getMetaTagSelector("BI.Log")).filter(function(){return!new Boolean(jQuery(this).attr("content"))}).length==0},_getAnnotatedMetatags:function(){var n=Wol.ContentInstrumentation.Logging;return jQuery("meta[name^='"+n.tagPrefix+"']").map(function(){var t=this,i=jQuery(t),r=i.attr("name"),u=i.attr("content");return{domElement:t,name:r,shortname:r.substr(n.tagPrefix.length+1),value:u}})},_getSessionSampleHash:function(){var n=Wol.ContentInstrumentation.Logging,t=n.GetSessionID();return n.GuidTo32bit(t)},_getRandomSampleHash:function(){return Math.random()*Wol.ContentInstrumentation.Logging.Max_UInt32},_initSamplingRule:function(n,t){var r=Wol.ContentInstrumentation.Logging,f=!0,u=1,i,e;return n&&t&&(typeof t.Type=="undefined"&&(t.Type=0),t.Type===1?!t.Rate||t.Rate<0||t.Rate>100?(t.Rate=100,t.inSample=1):(i=null,u=t.Rate/100,typeof t.getUserHash=="function"&&t.getUserHash!==null&&(i=t.getUserHash()),(!i||isNaN(i)||i<0||i>r.Max_UInt32)&&(i=r._getSessionSampleHash()||r._getRandomSampleHash()),t.InSample=i<u*r.Max_UInt32?1:0):t.InSample=1,e=u===1?"":u.toString().substring(2,6),t.FlexField=n+":"+t.Type.toString()+","+e+","+t.InSample.toString(),f=t.InSample),f},_setAnnotatedMetatag:function(n,t){var u=Wol.ContentInstrumentation.Logging,r=u._getMetaTagSelector(n),i;jQuery(r).length==0?(i=document.createElement("meta"),i.setAttribute("name",n),i.setAttribute("content",t),jQuery("head").get(0).appendChild(i)):jQuery(r).get(0).attr("content",t)},_flushQueuedEvents:function(){var n=Wol.ContentInstrumentation.Logging,i,t;if(n.scriptIsReady===!0){for(t=0;t<n.batchBeacons.length;t++)Wol.Mscom.SendBeacon(n.batchBeacons[t]);for(n.batchBeacons=[],t=0;t<n.customEventMaps.length;t++)i=n.customEventMaps[t],n._logToWedcs(i.ToArray());for(n.customEventMaps=[],t=0;t<n.clickEvents.length;t++)Wol.Mscom.SendBeacon(n.clickEvents[t]);n.clickEvents=[]}},_flushQueuedSamplingEvents:function(){var n=Wol.ContentInstrumentation.Logging,t;if(n.scriptIsReady===!0&&n.samplingEvents&&n.samplingEvents.length>0){for(t=0;t<n.samplingEvents.length;t++)Wol.Mscom.SendBeacon(n.samplingEvents[t]);n.samplingEvents=[]}},_initCurrentScriptPath:function(){var n=Wol.ContentInstrumentation.Logging;if(n.scriptPath==null){try{var r=document.getElementsByTagName("script"),i=r[r.length-1].src,t=i.lastIndexOf("/");t=t<0?i.lastIndexOf("\\"):t,t=t<0?0:t,n.scriptPath=i.substring(0,t)+"/"}catch(u){n.scriptPath="/",n._logError(u)}n.clientBiSettingsUri=n.scriptPath+n.clientBiSettingsUri}},_logToWedcs:function(n){Wol.Mscom.CustomEvent.apply(this,n)},_logJsonPageViewEvent:function(n){var i=Wol.ContentInstrumentation.Logging,t,u,r,f,e;i.initLogging==!0&&(t=Wol.Mscom,t.HandleSession(),t.setEvents(),u=t.GetBaseSrcString(),r=i._getBiDataMap(null,n,null),jQuery.each(i._getAnnotatedMetatags(),function(n,t){r.Push(t.shortname,t.value)}),f=t.EncodeCustomEventStr(r.ToArray()),e=t.EnsureBeaconSrcLength(u+f),t.SendBeacon(e))},_logError:function(n){if(n!=null&&typeof console!="undefined"&&typeof console.log!="undefined"){var t=n.toString();console.log(t)}}},Wol.ContentInstrumentation.Logging._initCurrentScriptPath(),Wol.Mscom={fl:0,sessionId:"",sessionDuration:18e5,sessionCookieName:"MC0",sessionGuidCookieName:"MS0",cookieDisabled:0,pvInfo:[],metaTags:"",customTags:"",clickInfo:"",flexInfo:"",qs:"",currTimeTicks:0,currTimeAsString:"",imgArray:[],imgArrayIndex:0,customInfo:"",tz:420,slC:"",flC:"",cntC:"",bsC:"",clickedElements:["A","IMG","AREA","INPUT"],pKey:"",routeCode:"",ctrlCode:"",routeParams:"",customEventParam:"&cot=5",tagPrefix:"ms.",clickPrefix:"Click.",debugOn:!1,previousSessionID:"",samplingInfo:"",userHashField:"",disableDefaultLoggingAttribute:"data-disabledefaultlogging",queryParamLength:{ti:[1e3,1e3],sr:[20,0],bs:[20,0],cn:[500,500],cid:[100,100],ct:[500,500]},optInfoHandler:null,wedcsUriBase:"http://__REPLACE_FQDN__",varClickTracking:0,browserDelay:0,CustomEvent:function(){var n=Wol.Mscom;try{n.HandleSession(),n.customInfo+=n.EncodeCustomEventStr(arguments),n.customInfo!=""&&n.Beacon()}catch(t){n.debug("CustomEvent:"+t)}},EncodeCustomEventStr:function(n){for(var i=Wol.Mscom,r="",f=n.length,u,t=0;t<f;t=t+2)u=n[t].toString().toLowerCase(),u.indexOf(i.tagPrefix)==0&&(r+="&"+i.Encode(u)+"="+(n[t+1]==undefined?"":i.Encode(n[t+1].toString())));return r},SetPVInfoCore:function(){var n=Wol.Mscom,t;n.SetTime(),n.pvInfo.push("tz="+n.tz/-60),window.varSegmentation!=undefined&&varSegmentation==1&&n.pvInfo.push("&cs=1"),n.cookieDisabled==1&&n.pvInfo.push("&cd=1"),n.pvInfo.push("&ti="+n.GetUrlParameter("ti",n.Encode(document.title))),t=n.Encode(document.referrer),t!=null&&t!=""&&n.pvInfo.push("&r="+t),n.pvInfo.push("&ts="+n.currTimeAsString),typeof screen=="object"&&n.pvInfo.push("&sr="+n.GetUrlParameter("sr",screen.width+"x"+screen.height)),n.GetBrowserSize(),n.samplingInfo!=""&&n.pvInfo.push("&ff3="+n.samplingInfo),n.userHashField!=""&&n.pvInfo.push("&ff4="+n.userHashField),n.previousSessionID!=""&&(n.pvInfo.push("&ff5="+n.previousSessionID),n.previousSessionID=""),n.flexInfo!=""&&n.pvInfo.push(n.flexInfo)},SetPVInfo:function(){var n=Wol.Mscom;n.SetPVInfoCore(),n.optInfoHandler!==null&&typeof n.optInfoHandler=="object"&&n.optInfoHandler()},GetBrowserSize:function(){var n=Wol.Mscom;if(n.bsC!=""){n.pvInfo.push(n.bsC);return}document.body.clientWidth!=undefined?n.bsC=document.body.clientWidth+"x"+document.body.clientHeight:document.documentElement&&document.documentElement.clientWidth!=undefined?n.bsC=document.documentElement.clientWidth+"x"+document.documentElement.clientHeight:window.innerWidth!=undefined&&(n.bsC=window.innerWidth+"x"+window.innerHeight),n.bsC!=""&&(n.bsC="&bs="+n.GetUrlParameter("bs",n.bsC),n.pvInfo.push(n.bsC))},HandleSession:function(){var n=Wol.Mscom,i,t,r,u;if(n.SetTime(),i="",t=document.cookie.indexOf(n.sessionCookieName+"="),t==-1){if(n.sessionId=n.currTimeAsString,n.cookieDisabled==1)return;i=n.sessionCookieName+"="+n.sessionId}else r=t+n.sessionCookieName.length+1,u=document.cookie.length,i=n.sessionCookieName+"="+document.cookie.substring(r,u);document.cookie=i,t=document.cookie.indexOf(n.sessionCookieName+"="),t==-1&&(n.cookieDisabled=1)},SetTime:function(){var n=Wol.Mscom,t=new Date;n.tz=t.getTimezoneOffset(),n.currTimeTicks=Math.max(n.currTimeTicks+1,t.getTime()),n.currTimeAsString=n.currTimeTicks.toString()},debug:function(n){Wol.Mscom.debugOn===!0&&Wol.ContentInstrumentation.Logging(n)},Pause:function(n){for(var t=new Date,i=t.getTime()+n;t.getTime()<i;)t=new Date},GetUrlParameter:function(n,t){var i=Wol.Mscom;return n in i.queryParamLength&&t.length>i.queryParamLength[n][0]&&(t=t.substring(0,i.queryParamLength[n][1])),t},ProcessClick:function(n){var t=Wol.Mscom,l=Wol.ContentInstrumentation.Logging,f,i,o,r,s,c,e,h,u,a,v;try{if(t.HandleSession(),f=n||window.event,f)for(i=f.srcElement||f.target;i.tagName&&t.IsInList(i.tagName)==!1;)i=i.parentElement||i.parentNode;if(i&&i.tagName&&typeof jQuery(i).attr(t.disableDefaultLoggingAttribute)=="undefined"){switch(i.tagName){case"A":o=document.all?i.innerText||"":i.text||"",t.clickInfo="&cot=1&cn="+t.GetUrlParameter("cn",t.Encode(o))+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",i.href?t.Encode(i.href):"");break;case"IMG":t.clickInfo="&cot=2&cn="+t.GetUrlParameter("cn",i.alt?t.Encode(i.alt):"")+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",t.GetImageHREF(i));break;case"AREA":t.clickInfo="&cot=3&cn="+t.GetUrlParameter("cn",i.alt?t.Encode(i.alt):"")+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",i.href?t.Encode(i.href):"");break;case"INPUT":if(r=i.type||"",s="",r&&(r=="button"||r=="reset"||r=="submit"||r=="image"||r=="text"||r=="search")&&(f.which||f.keyCode)==13){if(c=i.value||i.name||i.alt||i.id,t.clickInfo="&cot=4&cn="+t.GetUrlParameter("cn",c?t.Encode(c):"")+"&cid="+t.GetId(i)+"&ct=",i.form)for(t.clickInfo+=t.GetUrlParameter("ct",t.Encode(i.form.action)||t.Encode(window.location.pathname)),e=i.form.elements,h=1,u=0;u<e.length;u++)a=e[u].type,a=="text"&&(s+="&t"+h+"="+t.Encode(e[u].name||e[u].id)+"&v"+h+"="+t.Encode(e[u].value),h++);else t.clickInfo+=t.GetUrlParameter("ct",t.Encode(window.location.pathname));s!=""&&(t.clickInfo+=s)}break;default:t.clickInfo=""}t.clickInfo!=""&&(v=l._getBiDataMap(null,null,i),t.customTags=t.EncodeCustomEventStr(v.ToArray()),t.Beacon(),t.browserDelay>0&&t.Pause(t.browserDelay))}}catch(i){t.debug("ProcessClick:"+i)}},Beacon:function(){var n=Wol.Mscom,i,t;try{i=n.GetFullSrcParts(),t=i.join(""),t=n.EnsureBeaconSrcLength(t),n.SendBeacon(t)}catch(r){n.debug("Beacon:"+r)}},EnsureBeaconSrcLength:function(n){return n.length>2048&&(n=n.substring(0,2042),n.lastIndexOf("&")>=0&&(n=n.substring(0,n.lastIndexOf("&"))),n=n+"&tr=1"),n},SendBeacon:function(n,t){var i=Wol.Mscom,r;try{document.images?(r=document.createElement("IMG"),t&&(r.onload=t,r.onerror=t),i.imgArray[i.imgArrayIndex]=r,i.imgArray[i.imgArrayIndex].src=n,i.imgArrayIndex++):(document.write('<IMG ALT="" BORDER="0" NAME="bImg" WIDTH="1" HEIGHT="1" SRC="'+n+'"/>'),t&&setTimeout(t,250))}catch(u){i.debug("SendBeacon:"+u)}finally{i.clickInfo="",i.customInfo="",i.customTags=""}},GetBaseSrcParts:function(){var n=Wol.Mscom,t;try{return t=[],t.push(n.wedcsUriBase+"/trans_pixel.aspx?"),n.routeParams!=""&&t.push(n.routeParams),n.pvInfo.length=0,n.SetPVInfo(),t.push(n.pvInfo.join("")),t}catch(i){n.debug("GetBaseSrcParts:"+i)}},GetFullSrcParts:function(){var n=Wol.Mscom,t;try{return t=n.GetBaseSrcParts(),n.clickInfo!=""&&t.push(n.clickInfo),n.InitMeta(),n.metaTags!=""&&t.push(n.metaTags),n.customTags!=""&&t.push(n.customTags),n.customInfo!=""&&(t.push(n.customEventParam),t.push(n.customInfo)),t}catch(i){n.debug("GetFullSrcParts:"+i)}},GetBaseSrcString:function(){var n=Wol.Mscom;return n.GetBaseSrcParts().join("")},GetId:function(n){var t=Wol.Mscom;return n?n.id==undefined?"":t.GetUrlParameter("cid",t.Encode(n.id)):""},GetImageHREF:function(n){var i=Wol.Mscom,t=n;if(n){if(n=n.parentElement||n.parentNode,n&&n.tagName=="A")return n.href?i.Encode(n.href):"";if(t&&t.src)return i.Encode(t.src)}return""},ReadAllTags:function(n){for(var i=Wol.Mscom,t=[];n&&n!="undefined";)t.push(i.ReadElementTags(n)),n=n.parentElement||n.parentNode;return t.join("")},ReadClickTags:function(n){var t=Wol.Mscom,r=[],i,u;return r.push(t.ReadElementTags(n,t.clickPrefix)),i=n.parentElement||n.parentNode,typeof i!="undefined"&&i!==null&&(u=t.ReadAllTags(i)),r.join("")+u},ReadElementTags:function(n,t){var i=Wol.Mscom,e="",u,r,f;if(n)for(u in n.attributes)u!=undefined&&n.attributes[u]!=null&&n.attributes[u]!=undefined&&(r=n.attributes[u].name,r!=null&&r!=undefined&&(f=r.toLowerCase(),f.indexOf(i.tagPrefix)==0?(t!=null&&(r=i.tagPrefix+t+r.substring(i.tagPrefix.length)),e+="&"+i.Encode(r)+"="+i.Encode(n.attributes[u].value)):(f.indexOf("s.")==0||f.indexOf("wt.")==0||f.indexOf("dcs.")==0||f.indexOf("dcsext.")==0)&&(e+="&"+i.Encode(r)+"="+i.Encode(n.attributes[u].value))));return e},IsInList:function(n){var t=Wol.Mscom,i;for(i in t.clickedElements)if(t.clickedElements[i]==n.toUpperCase())return!0;return!1},setEvents:function(){var n=Wol.Mscom;n.varClickTracking!=undefined&&n.varClickTracking==1&&jQuery(document.body).click(n.ProcessClick)},InitMeta:function(){var n=Wol.Mscom;n.metaTags=n.GetMetaTagsStr()},GetMetaTagsStr:function(){var r=Wol.Mscom,n,f,u,i,t;if(document.all?n=document.all.tags("meta"):document.documentElement&&(n=document.getElementsByTagName("meta")),f="",typeof n!="undefined")for(u=0;u<n.length;u++)i=n.item(u),i.name&&(t=i.name.toLowerCase(),(t.indexOf(r.tagPrefix)==0||t.indexOf("s.")==0||t.indexOf("wt.")==0||t.indexOf("dcs.")==0||t.indexOf("dcsext.")==0)&&(f+="&"+r.Encode(i.name)+"="+r.Encode(i.content)));return f},Init:function(){var n=Wol.Mscom;try{n.HandleSession(),n.setEvents(),n.Beacon()}catch(t){n.debug("Mscom - Init:"+t)}},InitRoute:function(n,t,i){var r=Wol.Mscom;r.ctrlCode=n,r.routeCode=t,r.pKey=i,r.pKey&&r.pKey!==""&&r.routeCode&&r.routeCode!==""&&r.ctrlCode&&r.ctrlCode!==""&&(r.routeParams="pKey="+r.pKey+"&route="+r.routeCode+"&ctrl="+r.ctrlCode+"&")},InitFlexInfo:function(n){var t=Wol.Mscom,i;if(t.flexInfo="",n!==null&&typeof n=="object")for(i in n)t.flexInfo+="&"+t.Encode(i)+"="+t.Encode(n[i])},Encode:function(n){return typeof encodeURIComponent=="function"?encodeURIComponent(n):escape(n)}},typeof Wol=="undefined"&&(Wol={}),typeof Wol.ContentInstrumentation=="undefined"&&(Wol.ContentInstrumentation={}),typeof Wol.ContentInstrumentation.Logging=="undefined"&&(Wol.ContentInstrumentation.Logging={}),Wol.ContentInstrumentation.Logging.Rio={InitRIO:function(n,t,i,r,u,f){var e=Wol.ContentInstrumentation.Logging,p,c,w;if(typeof e!="undefined"&&(e.rioEnv=null,e.initLogging))try{var l=e._getAnnotationName(i),a=e._getMetaTagSelector(l),h=jQuery(a).attr("content"),v=e._getAnnotationName(r),y=e._getMetaTagSelector(v),o=e._getAnnotationName(u),s=jQuery(y).attr("content");s||(p=e._findBySingleAttribute(document.body,o),s=jQuery(p).first().attr(o)),h&&s&&(e.rioEnv=window.location.protocol+"//"+n+"/RioTracking2.js",jQuery.getScript(e.rioEnv,function(){typeof RioTracking!="undefined"?(RioTracking.guestCellCode=h,RioTracking.uniqueActionTagCode=s):e._logError(new Error("RIO tracking client script was downloaded, but not evaluated successfully - RioTracking namespace is not defined."))}),c=e._getAnnotationName(f),w=e._findBySingleAttribute(document.body,c),jQuery(w).click(function(){try{var t=jQuery(this),i=t.attr(c),n=t.attr(o);n||(n=t.parents().filter(function(){return typeof jQuery(this).attr(o)!="undefined"}).first().attr(o)),n||(n=s),RioTracking.clickNoWait(i,n)}catch(r){e._logError(r)}}))}catch(b){e._logError(b)}}},typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.BIPreloadDatabag=="undefined"&&(Ms.Wol.BIPreloadDatabag={}),typeof Wol=="undefined"&&(Wol={}),typeof Wol.SiteInstrumentation=="undefined"&&(Wol.SiteInstrumentation={}),Wol.SiteInstrumentation.Logging={queryStringParameters:{semid:"MS.PaidSearch",ocid:"MS.CampaignRef"},InitCustomInstrumentation:function(){var t=Wol.SiteInstrumentation.Logging,i=t.queryStringParameters,n=window.location.search.replace(/\+/g," "),r,u;try{n=decodeURIComponent(n.substr(1))}catch(f){n=""}for(r in i)try{u=t.ParseQueryString(n,r),u!=""&&(Ms.Wol.BIPreloadDatabag[i[r]]=u)}catch(f){}},ParseQueryString:function(n,t){for(var r=n.split("&"),u,i=0;i<r.length;i++)if(u=r[i].split("="),jQuery.trim(u[0].toLowerCase())==t)return jQuery.trim(u[1]);return""}},Wol.SiteInstrumentation.Logging.InitCustomInstrumentation(),Type.registerNamespace("Wol.Logging"),Wol.Logging.InternalVars=function(){this._isEnabled=!1,this._isClickThroughEnabled=!0,this._isLoggerReady=!1,this._shouldIgnoreError=!0,this._loggerReadyEvent=new Wol.Util.Event("loggerReadyEvent"),this._requiredLoggerTemplate=null,this._commonLoggerTemplate=null},WolLoggingVars=new Wol.Logging.InternalVars,Wol.Logging={isEnabled:function(){return WolLoggingVars._isEnabled},isClickThroughEnabled:function(){return WolLoggingVars._isClickThroughEnabled},shouldIgnoreError:function(){return WolLoggingVars._shouldIgnoreError},isLoggerReady:function(){return WolLoggingVars._isLoggerReady},loggerReadyEvent:function(){return WolLoggingVars._loggerReadyEvent},requiredLoggerTemplate:function(){return WolLoggingVars._requiredLoggerTemplate},commonLoggerTemplate:function(){return WolLoggingVars._commonLoggerTemplate},getTargetUrlElement:function(n){if(arguments.length!=1)throw Error.argument();return n==undefined||n==null?null:n.href!=null&&n.href!=undefined&&n.tagName!=null&&n.tagName!=undefined&&n.tagName.toUpperCase()=="A"?n:this.getTargetUrlElement(n.parentElement||n.parentNode)},getTargetUrl:function(n){var t=this.getTargetUrlElement(n);return t==undefined||t==null?null:t.href},_getKeyValue:function(n,t,r,u){var f,e,o;if(n&&t&&u&&r&&(f=n.split(u),f&&f.length>0))for(i=0;i<f.length;i++)if(e=f[i].replace(/^\s+|\s+$\g/,""),o=t+r,e.indexOf(o)==0&&e.length>o.length)return e.substring(o.length);return null},_getCookie:function(n){var t=document.cookie;return t&&n?Wol.Logging._getKeyValue(t,n,"=",";"):null},_getUserIdCookie:function(){var n=Wol.Logging._getCookie("A");return n&&n!=""?Wol.Logging._getKeyValue(n,"I","=","&"):null},getVisitor:function(){try{var n=Wol.Logging._getUserIdCookie();return n!=undefined&&n!=null&&(n=n.replace(/-/g,"")),n}catch(t){if(WolLoggingVars._shouldIgnoreError)return null;throw t;}},_getEncodedLengthForScalar:function(n){if(n==undefined||n==null)return 0;if(Wol.Util.TypeCheck.isOfType(n,Wol.Util.TypeCheck.StringType|Wol.Util.TypeCheck.NumberType|Wol.Util.TypeCheck.BooleanType))return escape(n.toString()).length;throw Error.argument("value","_getEncodedLengthForScalar value parameter must be string, int or boolean type!");},_getEncodedLength:function(n){var i,t;if(Sys.Debug.assert(arguments.length==1),n instanceof Array){for(i=0,t=0;t<n.length;t++)i+=Wol.Logging._getEncodedLengthForScalar(n[t])+1;return i}return Wol.Logging._getEncodedLengthForScalar(n)},normalizeToLowerCaseString:function(n){return n!=null&&n!=undefined?n.toString().toLowerCase():n}},Wol.Logging.WhenReady={register:function(n){Wol.Logging.isLoggerReady()?n():Wol.Logging.loggerReadyEvent().addHandler(n)}},Wol.Logging.Const={MaxAllowedUrlLength:2083,BaseUrlLength:380,LinkClickOverhead:600,PropOverhead:5},Wol.Logging.Const.FieldName={Channel:"channel",PageName:"pageName",PageUrl:"pageURL",Referrer:"referrer",Site:"prop1",RequestedCulture:"prop2",Title:"prop3",ContentPurpose:"prop4",Provider:"prop5",ContentSet:"prop6",TopicArea:"prop7",ContentType:"prop8",TabAssetUsageId:"prop9",SilverlightVersion:"prop10",FlashVersion:"prop11",TargetUrl:"prop12",InteractionId:"prop13",Application:"prop14",BwcSku:"prop15",OSSku:"prop16",TabControlIds:"prop17",TabAssetUsageIds:"prop18",FailedAssetId:"prop19",StatusCode:"prop20",Lcid:"prop21",TopLevelAssetRev:"prop28",ChildAssetIds:"prop29",TopLevelAssetId:"prop30",SearchResultCount:"prop31",SearchTerm1:"prop32",SearchTerm2:"prop33",SearchTerm3:"prop34",SearchTerm4:"prop35",SearchResultClickPosition:"prop36",IsBestBetPresent:"prop37",IsClickedBestBet:"prop38",QueryId:"prop39",FeedbackId:"prop49",Rating:"prop50",VerboseFeedback1:"eVar1",VerboseFeedback2:"eVar2",VerboseFeedback3:"eVar3",VerboseFeedback4:"eVar4",VerboseFeedback5:"eVar5",VerboseFeedback6:"eVar6",VerboseFeedback7:"eVar7",VerboseFeedback8:"eVar8",VerboseFeedback9:"eVar9",VerboseFeedback10:"eVar10",VerboseFeedback11:"eVar11",VerboseFeedback12:"eVar12",VerboseFeedback13:"eVar13",VerboseFeedback14:"eVar14",VerboseFeedback15:"eVar15",VerboseFeedback16:"eVar16"},Wol.Logging.Const.InteractionTypeId={Click:0,PageLoad:1,PrimaryNavBar:2,SecondaryNavBar:3,Footer:4,PerformSearch:8,SearchResultClick:9,SearchSiteEscalation:10,ChangeSearchOption:11,SearchSpelling:12,TabClick:13,WauBuyButtonClick:15,WauPageLoad:16,SuperHeroClick:17,HeroMouseOver:18,HeroVideoStart:19,HeroVideoReachEnd:20,HeroVideoStop:21,HeroPageLoad:22,SubHeroClick:23,DownLevelHeroClick:24,TocBookNodeClick:25,Rating:26,VerboseFeedback:27,TertiaryNavBar:28,Header:29,TocTopicClick:30,SilverlightComponentLoaded:31,SilverlightPluginAvailable:32},Wol.Logging.Const.FieldMaxLength={Channel:100,PageName:100,PageUrl:256,Referrer:255,Prop:100,EVar:100},Wol.Logging.Const.PropNArray={Length:50,MaxLength:Wol.Logging.Const.FieldMaxLength.Prop,NamePrefix:"prop",NameStartingAt:1},Wol.Logging.Const.EVarNArray={Length:50,MaxLength:Wol.Logging.Const.FieldMaxLength.EVar,NamePrefix:"eVar",NameStartingAt:1},Wol.Logging.Const.ElementAttrib={InteractionTypeId:"logginginteractiontypeid",InteractionTypeIdSep:":",AdditionalProp:"loggingAdditionalProp",AdditionalPropSep:"_"},Wol.Logging.Const.OmnitureWTMappings=[[Wol.Logging.Const.FieldName.Title,"WT.ti"]],Wol.Logging.LogTypeEnum=function(){throw Error.notImplemented();},Wol.Logging.LogTypeEnum.prototype={ClickThrough:0,PageLoad:1},Wol.Logging.LogTypeEnum.registerEnum("Wol.Logging.LogTypeEnum"),Wol.Logging.PropTypeEnum=function(){throw Error.notImplemented();},Wol.Logging.PropTypeEnum.prototype={Scalar:1,List:2,TableName:3,TableValue:4},Wol.Logging.PropTypeEnum.registerEnum("Wol.Logging.PropTypeEnum"),Wol.Logging.ResultId=function(){throw Error.notImplemented();},Wol.Logging.ResultId.prototype={Success:0,GeneralFailure:1,LengthTooLongFailure:2},Wol.Logging.ResultId.registerEnum("Wol.Logging.ResultId"),Wol.Logging.Prop=function(n,t,i,r,u){Sys.Debug.assert(arguments.length>=2&&arguments.length<=5),Sys.Debug.assert(Wol.Util.TypeCheck.isString(n)),Sys.Debug.assert(Wol.Util.TypeCheck.isNumber(t)),i!=undefined&&Sys.Debug.assert(Wol.Util.TypeCheck.isBoolean(i)),this.name=n,this.maxLength=t,this.isCaseSensitive=i||!1,this.type=r||Wol.Logging.PropTypeEnum.Scalar,this.keyPropName=u,this.value=null,this.encodedLength=0},Wol.Logging.Prop.prototype={checkForNonScalarType:function(){Sys.Debug.assert(this.type==Wol.Logging.PropTypeEnum.List||this.type==Wol.Logging.PropTypeEnum.TableName||this.type==Wol.Logging.PropTypeEnum.TableValue)},clone:function(){var n,t;if(Sys.Debug.assert(arguments.length==0),n=new Wol.Logging.Prop(this.name,this.maxLength,this.isCaseSensitive,this.type,this.keyPropName),this.type==Wol.Logging.PropTypeEnum.Scalar||this.value==undefined||this.value==null)n.value=this.value;else for(n.value=[],t=0;t<this.value.length;t++)n.value[t]=this.value[t];return n.encodedLength=this.encodedLength,n},setValue:function(n,t){if(Sys.Debug.assert(arguments.length==1||arguments.length==2),this.isCaseSensitive)this.value=n;else if(this.type==Wol.Logging.PropTypeEnum.Scalar)this.value=Wol.Logging.normalizeToLowerCaseString(n);else if(n==undefined||n==null)this.value=n;else{this.value=new Array(n.length);for(var i=0;i<n.length;i++)this.value[i]=Wol.Logging.normalizeToLowerCaseString(n[i])}t==undefined||t==null||t==0?this.encodedLength=Wol.Logging._getEncodedLength(this.value):(Sys.Debug.assert(t>=0),this.encodedLength=t)},getValue:function(){return Sys.Debug.assert(arguments.length==0),this.type==Wol.Logging.PropTypeEnum.Scalar?this.value:this.value!=null&&this.value!=undefined?this.value.join(","):null},append:function(n,t){this.checkForNonScalarType(),Sys.Debug.assert(arguments.length>=1&&arguments.length<=2),(this.value==undefined||this.value==null)&&(this.value=[],this.encodedLength=0),this.isCaseSensitive||(n=Wol.Logging.normalizeToLowerCaseString(n)),t==undefined||t==null||t==0?t=Wol.Logging._getEncodedLength(n):Sys.Debug.assert(this.encodedLength>=0),this.value.push(n),this.encodedLength+=t+1},setAt:function(n,t){this.checkForNonScalarType(),Sys.Debug.assert(arguments.length==2),Sys.Debug.assert(this.value.length>n),this.isCaseSensitive||(t=Wol.Logging.normalizeToLowerCaseString(t));var i=Wol.Logging._getEncodedLength(this.value[n]),r=Wol.Logging._getEncodedLength(t);this.value[n]=t,this.encodedLength+=r-i},indexOf:function(n){if(this.checkForNonScalarType(),Sys.Debug.assert(arguments.length==1),this.value==null||this.value==undefined)return-1;this.isCaseSensitive||(n=Wol.Logging.normalizeToLowerCaseString(n));for(var t=0;t<this.value.length;t++)if(n.toString()==this.value[t].toString())return t;return-1}},Wol.Logging.Prop.registerClass("Wol.Logging.Prop"),Wol.Logging.PropArray=function(n,t,i,r,u){Sys.Debug.assert(arguments.length==4||arguments.length==5),Sys.Debug.assert(Wol.Util.TypeCheck.isNumber(n)),Sys.Debug.assert(Wol.Util.TypeCheck.isNumber(t)),Sys.Debug.assert(Wol.Util.TypeCheck.isString(i)),Sys.Debug.assert(Wol.Util.TypeCheck.isNumber(r)),u!=undefined&&Sys.Debug.assert(Wol.Util.TypeCheck.isBoolean(u)),Sys.Debug.assert(n>0),Sys.Debug.assert(t>0),Sys.Debug.assert(r>=0),this.arrayLength=n,this.propMaxLength=t,this.namePrefix=i,this.startingNameAppendix=r,this.data=[],u||this.init()},Wol.Logging.PropArray.prototype={init:function(){var n,t,i;for(Sys.Debug.assert(arguments.length==0),n=0,t=this.startingNameAppendix;n<this.arrayLength;n++,t++)i=new Wol.Logging.Prop(this.namePrefix+t.toString(),this.propMaxLength),this.data[n]=i},clone:function(){var t,n;for(Sys.Debug.assert(arguments.length==0),t=new Wol.Logging.PropArray(this.arrayLength,this.propMaxLength,this.namePrefix,this.startingNameAppendix,!0),n=0;n<this.data.length;n++)t.data[n]=this.data[n].clone();return t},getAt:function(n){return Sys.Debug.assert(arguments.length==1),Wol.Util.TypeCheck.isString(n)&&(n=Number.parseInvariant(n)),Sys.Debug.assert(Wol.Util.TypeCheck.isNumber(n)),Sys.Debug.assert(n>=this.startingNameAppendix&&n-this.startingNameAppendix<this.arrayLength),this.data[n-this.startingNameAppendix]},findProp:function(n){if(Sys.Debug.assert(arguments.length==1),Sys.Debug.assert(Wol.Util.TypeCheck.isString(n)),n.indexOf(this.namePrefix)==0){var t=n.substr(this.namePrefix.length);return this.getAt(t)}return null}},Wol.Logging.PropArray.registerClass("Wol.Logging.PropArray"),Wol.Logging.LoggerTemplate=function(n){var i,e,r,u,t,f;try{if(arguments.length>1)throw Error.argument();if(i=[Wol.Logging.Const.FieldName.Channel,Wol.Logging.Const.FieldName.PageName,Wol.Logging.Const.FieldName.PageUrl,Wol.Logging.Const.FieldName.Referrer],e=["_props","_eVars"],n!=undefined&&n!=null){if(!(n instanceof Wol.Logging.LoggerTemplate))throw Error.argumentType("template",typeof n,"Wol.Logging.LoggerTemplate");this.set_omLogger(n.get_omLogger()),this.set_totalLength(n.get_totalLength()),this._maxEncodedLength=n._maxEncodedLength,this._nonScalarProps=n._nonScalarProps,Wol.Util.Tools.cloneProperties(n,this,i),Wol.Util.Tools.cloneProperties(n,this,e)}else this.set_totalLength(0),this._maxEncodedLength=Wol.Logging.Const.MaxAllowedUrlLength-Wol.Logging.Const.BaseUrlLength,this._nonScalarProps=[Wol.Logging.Const.FieldName.TabControlIds,Wol.Logging.Const.FieldName.TabAssetUsageIds,Wol.Logging.Const.FieldName.ChildAssetIds],this[Wol.Logging.Const.FieldName.Channel]=new Wol.Logging.Prop(Wol.Logging.Const.FieldName.Channel,Wol.Logging.Const.FieldMaxLength.Channel),this[Wol.Logging.Const.FieldName.PageName]=new Wol.Logging.Prop(Wol.Logging.Const.FieldName.PageName,Wol.Logging.Const.FieldMaxLength.PageName),this[Wol.Logging.Const.FieldName.PageUrl]=new Wol.Logging.Prop(Wol.Logging.Const.FieldName.PageUrl,Wol.Logging.Const.FieldMaxLength.PageUrl),this[Wol.Logging.Const.FieldName.Referrer]=new Wol.Logging.Prop(Wol.Logging.Const.FieldName.Referrer,Wol.Logging.Const.FieldMaxLength.Referrer),this._props=new Wol.Logging.PropArray(Wol.Logging.Const.PropNArray.Length,Wol.Logging.Const.PropNArray.MaxLength,Wol.Logging.Const.PropNArray.NamePrefix,Wol.Logging.Const.PropNArray.NameStartingAt),this._eVars=new Wol.Logging.PropArray(Wol.Logging.Const.EVarNArray.Length,Wol.Logging.Const.EVarNArray.MaxLength,Wol.Logging.Const.EVarNArray.NamePrefix,Wol.Logging.Const.EVarNArray.NameStartingAt),this._initNonScalarProps();for(this._allProps=[],t=0;t<i.length;t++)this._allProps.push(this[i[t]]);for(this._allProps=this._allProps.concat(this._props.data).concat(this._eVars.data),r=[Wol.Logging.Const.FieldName.Channel,Wol.Logging.Const.FieldName.PageName,Wol.Logging.Const.FieldName.PageUrl,Wol.Logging.Const.FieldName.Referrer,Wol.Logging.Const.FieldName.RequestedCulture,Wol.Logging.Const.FieldName.ContentPurpose,Wol.Logging.Const.FieldName.ContentSet,Wol.Logging.Const.FieldName.TopicArea,Wol.Logging.Const.FieldName.ContentType,Wol.Logging.Const.FieldName.TabAssetUsageId,Wol.Logging.Const.FieldName.TargetUrl,Wol.Logging.Const.FieldName.InteractionId,Wol.Logging.Const.FieldName.Application,Wol.Logging.Const.FieldName.BwcSku,Wol.Logging.Const.FieldName.OSSku,Wol.Logging.Const.FieldName.TabControlIds,Wol.Logging.Const.FieldName.TabAssetUsageIds,Wol.Logging.Const.FieldName.FailedAssetId,Wol.Logging.Const.FieldName.StatusCode,Wol.Logging.Const.FieldName.Lcid,Wol.Logging.Const.FieldName.IsBestBetPresent,Wol.Logging.Const.FieldName.IsClickedBestBet,Wol.Logging.Const.FieldName.QueryId,Wol.Logging.Const.FieldName.FeedbackId],u={},t=0;t<r.length;t++)u[r[t]]=!0;for(t=0;t<this._allProps.length;t++)f=this._allProps[t],f.isCaseSensitive=u[f.name]==!0?!1:!0}catch(o){this.throwOrIgnore(o)}},Wol.Logging.LoggerTemplate.prototype={get_omLogger:function(){return this._omLogger},set_omLogger:function(n){this._omLogger=n},get_totalLength:function(){return this._totalLength},set_totalLength:function(n){this._totalLength=n},setScalar:function(n,t){var i,r,u,f;try{if(arguments.length!=2)throw Error.argument();if(i=this._getAndValidateProp(n,Wol.Logging.PropTypeEnum.Scalar),!Wol.Util.TypeCheck.isOfType(t,Wol.Util.TypeCheck.StringType|Wol.Util.TypeCheck.NumberType|Wol.Util.TypeCheck.BooleanType)&&t!=null)throw Error.argumentType("propValue",Object.getType(t),String);return t!=null&&(t=this._replaceInvalidCharsWithSpace(t)),r=Wol.Logging._getEncodedLengthForScalar(t),u=r-i.encodedLength,r==0&&(u-=Wol.Logging.Const.PropOverhead),(i.encodedLength==null||i.encodedLength==undefined||i.encodedLength==0)&&(u+=Wol.Logging.Const.PropOverhead),f=this.get_totalLength()+u,f>this._maxEncodedLength?Wol.Logging.ResultId.LengthTooLongFailure:(i.setValue(t,r),this.set_totalLength(f),Wol.Logging.ResultId.Success)}catch(e){return this.throwOrIgnore(e)}},insertIntoList:function(n,t){var i,e,r,u,f;try{if(arguments.length!=2)throw Error.argument();if(n==null||n==undefined||n=="")throw Error.argumentNull("propName","propName must be a valid omniture property name!");return(i=this._getAndValidateProp(n,Wol.Logging.PropTypeEnum.List),t=this._getValidatedNonScalarPropValue(t),e=i.indexOf(t),e>=0)?Wol.Logging.ResultId.Success:(r=Wol.Logging._getEncodedLengthForScalar(t),u=0,u=i.encodedLength==null||i.encodedLength==undefined||i.encodedLength==0?r+Wol.Logging.Const.PropOverhead:r+1,f=this.get_totalLength()+u,f>this._maxEncodedLength?Wol.Logging.ResultId.LengthTooLongFailure:(i.append(t,r),this.set_totalLength(f),Wol.Logging.ResultId.Success))}catch(o){return this.throwOrIgnore(o)}},insertIntoTable:function(n,t){var r,f,i,o,s,k,a,v,y,p,h,w,u,e,b,c,l;try{if(arguments.length!=2)throw Error.argument();if(n==null||n==undefined||n.length<2||!(n instanceof Array))throw Error.argument("propNames");if(t==null||t==undefined||t.length<2||!(t instanceof Array))throw Error.argument("propValues");if(n.length!=t.length)throw Error.argument("propNamespropValues","propNames and propValues array length are different!");for(r=[],f=[],i=0;i<n.length;i++){if(o=n[i],s=t[i],o==null||o==undefined||o=="")throw Error.argumentNull("propName","propName must be a valid omniture property name!");k=this._getAndValidateProp(o,i==0?Wol.Logging.PropTypeEnum.TableName:Wol.Logging.PropTypeEnum.TableValue),s=this._getValidatedNonScalarPropValue(s),r[i]=k,f[i]=s}for(a=r[0].keyPropName,i=1;i<r.length;i++)if(r[i].keyPropName!=a)throw Error.create("Wol.Logging.MultipleKeyPropNamesException");for(v=0,i=0;i<this._nonScalarProps.length;i++)if(y=this._get(this._nonScalarProps[i]),y.keyPropName==a){for(v++,p=!1,h=0;h<r.length;h++)if(r[h].name==y.name){p=!0;break}if(!p)throw Error.create("Wol.Logging.MissingPropException");}if(v!=r.length)throw Error.create("Wol.Logging.DuplicatePropNamesException");if(w=r[0].indexOf(f[0]),w>=0){for(e=[],b=0,i=1;i<r.length;i++)e[i]=r[i].clone(),e[i].setAt(w,f[i]),b+=e[i].encodedLength-r[i].encodedLength;if(u=this.get_totalLength()+b,u>this._maxEncodedLength)return Wol.Logging.ResultId.LengthTooLongFailure;for(i=1;i<r.length;i++)r[i].setValue(e[i].value,e[i].encodedLength);return this.set_totalLength(u),Wol.Logging.ResultId.Success}for(c=0,l=[],i=0;i<r.length;i++)l[i]=Wol.Logging._getEncodedLengthForScalar(f[i]),c+=l[i]+1;if((r[0].encodedLength==null||r[0].encodedLength==undefined||r[0].encodedLength==0)&&(c+=r.length*Wol.Logging.Const.PropOverhead),u=this.get_totalLength()+c,u>this._maxEncodedLength)return Wol.Logging.ResultId.LengthTooLongFailure;for(i=0;i<r.length;i++)r[i].append(f[i],l[i]);return this.set_totalLength(u),Wol.Logging.ResultId.Success}catch(d){return this.throwOrIgnore(d)}},throwOrIgnore:function(n){if(Wol.Logging.shouldIgnoreError())return Wol.Logging.ResultId.GeneralFailure;throw n;},_initNonScalarProps:function(){var n=this._props.findProp(Wol.Logging.Const.FieldName.TabControlIds),t,i;n.type=Wol.Logging.PropTypeEnum.TableName,n.keyPropName=Wol.Logging.Const.FieldName.TabControlIds,t=this._props.findProp(Wol.Logging.Const.FieldName.TabAssetUsageIds),t.type=Wol.Logging.PropTypeEnum.TableValue,t.keyPropName=Wol.Logging.Const.FieldName.TabControlIds,i=this._props.findProp(Wol.Logging.Const.FieldName.ChildAssetIds),i.type=Wol.Logging.PropTypeEnum.List},_getValidatedNonScalarPropValue:function(n){if(!Wol.Util.TypeCheck.isOfType(n,Wol.Util.TypeCheck.StringType|Wol.Util.TypeCheck.NumberType|Wol.Util.TypeCheck.BooleanType))throw Error.argumentType("propValue",Object.getType(n),String);n=n.toString().replace(/[,]+/g," ");var t=this._replaceInvalidCharsWithSpace(n);if(t==""||t==" ")throw Error.argument("propValue","Empty propValue is not allowed for non-scalar type");return t},_getAndValidateProp:function(n,t){if(n==null||n==undefined||n=="")throw Error.argumentNull("propName","propName must be a valid omniture property name!");var i=this._get(n);if(i!=undefined&&i!=null&&i instanceof Wol.Logging.Prop){if(i.type!=t)throw Error.argument("Invalid property type.");}else throw Error.argument("Can not find prop for given propName");return i},_get:function(n){var t=this[n];return t&&t instanceof Wol.Logging.Prop?t:(t=this._props.findProp(n),t&&t instanceof Wol.Logging.Prop)?t:this._eVars.findProp(n)},_replaceInvalidCharsWithSpace:function(n){return n.toString().replace(/[\s\u2122]+/g," ")}},Wol.Logging.LoggerTemplate.registerClass("Wol.Logging.LoggerTemplate"),Wol.Logging.Logger=function(n,t,i){try{if(arguments.length<1||arguments.length>3)throw Error.argument("invalid number of arguments!");if(!(n instanceof Wol.Logging.LoggerTemplate))throw Error.argumentType("template",Object.getType(n),Wol.Logging.LoggerTemplate);if(Wol.Logging.Logger.initializeBase(this,[n]),(t==undefined||t==null)&&(t=Wol.Logging.LogTypeEnum.ClickThrough),!Wol.Util.TypeCheck.isNumber(t))throw Error.argumentType("loggingType",Object.getType(t),Number);if(this.loggingType=t,this.srcElement=i,t==Wol.Logging.LogTypeEnum.ClickThrough&&i!=null&&i!=undefined){this._maxEncodedLength=Wol.Logging.Const.MaxAllowedUrlLength-Wol.Logging.Const.BaseUrlLength-Wol.Logging.Const.LinkClickOverhead;var r=Wol.Logging.getTargetUrl(i);this.setScalar(Wol.Logging.Const.FieldName.TargetUrl,r)}else this._maxEncodedLength=Wol.Logging.Const.MaxAllowedUrlLength-Wol.Logging.Const.BaseUrlLength;if(this.get_totalLength()>this._maxEncodedLength)throw Error.create("Wol.Logging.LengthTooLongException");}catch(u){this.throwOrIgnore(u)}},Wol.Logging.Logger.prototype.logToWT=function(){var n,r,i,t,u,f;try{if(arguments.length>0)throw Error.argument();for(n=[],r=Wol.Logging.Const.OmnitureWTMappings,i=0;i<r.length;i++)(t=r[i],t!=null&&t!=undefined)&&(u=this._get(t[0]),f=u.getValue(),n.push(t[1]),n.push(f));return n.push("WT.dl"),this.loggingType==Wol.Logging.LogTypeEnum.PageLoad?n.push("0"):n.push("1"),dcsMultiTrack.apply(this.srcElement,n),Wol.Logging.ResultId.Success}catch(e){return this.throwOrIgnore(e)}},Wol.Logging.Logger.prototype.log=function(){var r,n,t,i;try{if(arguments.length>0)throw Error.argument();for(r=this.get_omLogger(),n=Wol.Logging.ResultId.Success,t=0;t<this._allProps.length;t++)i=this._allProps[t],r[i.name]=i.getValue();return this.loggingType==Wol.Logging.LogTypeEnum.PageLoad?n=this.logToWT():Wol.Logging.isClickThroughEnabled()&&(n=this.logToWT()),n}catch(u){return this.throwOrIgnore(u)}},Wol.Logging.Logger.registerClass("Wol.Logging.Logger",Wol.Logging.LoggerTemplate),Wol.Logging.Internal={enableClickThroughLogging:function(){Sys.Debug.assert(arguments.length==0),document.body!=undefined&&document.body!=null&&(document.body.onclick=this.onClick)},onClick:function(n){var r,e,i,h,c,f,t;try{if(r=typeof event!="undefined"?window.event.srcElement:n.target,e=Wol.Logging.getTargetUrlElement(r),e==null||e==undefined)return;r=e;var o=Wol.Logging.Const.InteractionTypeId.Click,s=new Wol.Logging.Logger(Wol.Logging.commonLoggerTemplate(),Wol.Logging.LogTypeEnum.ClickThrough,r),u=Wol.Logging.Internal._findInteractionTypeIdElement(r);if(u!=null&&(i=u.attributes[Wol.Logging.Const.ElementAttrib.InteractionTypeId].value,i!=null&&i!=undefined)){if(i.toLowerCase()=="none")return;if(h=i.indexOf(Wol.Logging.Const.ElementAttrib.InteractionTypeIdSep),h<0)o=Number.parseInvariant(i);else{if(o=Number.parseInvariant(i.substr(0,h)),c=i.substr(h),c.toLowerCase()!=Wol.Logging.Const.ElementAttrib.InteractionTypeIdSep.toLowerCase()+Wol.Logging.Const.ElementAttrib.AdditionalProp.toLowerCase())throw Error.create("Wol.Logging.InvalidInteractionTypeIdException");for(f=[],t=r;t!=null&&t!=undefined&&t!=u;)f.push(t),t=t.parentElement||t.parentNode;f.push(u);do t=f.pop(),Wol.Logging.Internal._setPropFromElement(s,t);while(f.length>0)}}s.setScalar(Wol.Logging.Const.FieldName.InteractionId,o),s.log()}catch(l){Wol.Logging.LoggerTemplate.prototype.throwOrIgnore(l)}},createOMLogger:function(n){try{if(arguments.length!=1||!Wol.Util.TypeCheck.isString(n))throw Error.argument("s_account","s_account must be the only parameter, and its type must be string!");var t=s_gi(n);return t.m_Media_c="='s_media_'+m._in+'_~=new Function(~m.ae(mn,l,\"'+p+'\",~;`H~o.'+f~o.Get~=function(~){var m=this~}^9 p');p=tcf(o)~setTimeout(~x,x!=2?p:-1,o)}~=parseInt(~m.s.d.getElementsByTagName~ersionInfo~'`z_c_il['+m._in+'],~'o','var e,p=~QuickTime~if(~}catch(e){p=~s.wd.addEventListener~m.s.rep(~=new Object~layState~||^D~m.s.wd[f1]~Media~.name~Player '+~s.wd.attachEvent~'a','b',c~;o[f1]~tm.getTime()/1~m.s.isie~.current~,tm=new Date,~p<p2||p-p2>5)~m.e(n,1,o^F~m.close~i.lx~=v+',n,~){this.e(n,~MovieName()~);o[f~i.lo~m.ol~o.controls~load',m.as~==3)~script';x.~,t;try{t=~Version()~else~o.id~){mn=~1;o[f7]=~Position~);m.~(x==~)};m.~&&m.l~l[n])~var m=s~!p){tcf~xc=m.s.~Title()~();~7+'~)}};m.a~\"'+v+';~3,p,o);~5000~return~i.lt~';c2='~Change~n==~',f~);i.~==1)~{p='~4+'=n;~()/t;p~.'+n)}~~`z.m_i('`P'`uopen`6n,l,p,b`7,i`L`Ya='',x;l`Bl)`3!l)l=1`3n&&p){`H!m.l)m.l`L;n=`Km.s.rep(`Kn,\"\\n\",''),\"\\r\",''),'--**--','')`3m.`y`b(n)`3b&&b.id)a=b.id;for (x in m.l)`Hm.l[x]`x[x].a==a)`b(m.l[x].n^Fn=n;i.l=l;i.p=p;i.a=a;i.t=0;i.s`B`V000);`c=0;^A=0;`h=0;i.e='';m.l[n]=i}};`b`6n`e0,-1`wplay`6n,o`7,i;i=`am`1`Ei`3m.l){i=m.l[\"'+`Ki.n,'\"','\\\\\"')+'\"]`3i){`H`c^Gm.e(i.n,3,-1^Fmt=`9i.m,^8)}}'^Fm(`wstop`6n,o`e2,o`we`6n,x,o`7,i=n`x&&m.l[n]?m.l[n]:0`Yts`B`V000),d='--**--'`3i){if `v3||(x!=`c&&(x!=2||`c^G)) {`Hx){`Ho<0&&^A>0){o=(ts-^A)+`h;o=o<i.l?o:i.l-1}o`Bo)`3`v2||x`l&&`h<o)i.t+=o-`h`3x!=3){i.e+=`v1?'S':'E')+o;`c=x;}`p `H`c!=1)`alt=ts;`h=o;m.s.pe='media';m.s.pev3=i.n+d+i.l+d+i.p+d+i.t+d+i.s+d+i.e+`v3?'E'+o:''`us.t(0,'`P^K`p{m.e(n,2,-1`ul[n]=0;m.s.fbr('`P^K}}^9 i};m.ae`6n,l,p,x,o,b){`Hn&&p`7`3!m.l||!m.`ym.open(n,l,p,b`ue(n,x,o^5`6o,t`7,i=`q?`q:o`Q,n=o`Q,p=0,v,c,c1,c2,^1h,x,e,f1,f2`0oc^E3`0t^E4`0s^E5`0l^E6`0m^E7`0c',tcf,w`3!i){`H!m.c)m.c=0;i`0'+m.c;m.c++}`H!`q)`q=i`3!o`Q)o`Q=n=i`3!`i)`i`L`3`i[i])^9;`i[i]=o`3!xc)^1b;tcf`1`F0;try{`Ho.v`D&&o`X`P&&`j)p=1`I0`8`3^0`1`F0`n`5`G`o`3t)p=2`I0`8`3^0`1`F0`n`5V`D()`3t)p=3`I0`8}}v=\"`z_c_il[\"+m._in+\"],o=`i['\"+i+\"']\"`3p^G^HWindows `P `Ro.v`D;c1`dp,l,x=-1,cm,c,mn`3o){cm=o`X`P;c=`j`3cm&&c`rcm`Q?cm`Q:c.URL;l=cm.duration;p=c`X`t;n=o.p`M`3n){`H^D8)x=0`3n`lx=1`3^D1`N2`N4`N5`N6)x=2;}^B`Hx>=0)`2`A}';c=c1+c2`3`W&&xc){x=m.s.d.createElement('script');x.language='j`mtype='text/java`mhtmlFor=i;x.event='P`M^C(NewState)';x.defer=true;x.text=c;xc.appendChild(x`g6]`1c1+'`Hn`l{x=3;'+c2+'}`9`46+',^8)'`g6]()}}`Hp==2)^H`G `R(`5Is`GRegistered()?'Pro ':'')+`5`G`o;f1=f2;c`dx,t,l,p,p2,mn`3o`r`5`f?`5`f:`5URL^3n=`5Rate^3t=`5TimeScale^3l=`5Duration^J=`5Time^J2=`45+'`3n!=`44+'||`Z{x=2`3n!=0)x=1;`p `Hp>=l)x=0`3`Z`22,p2,o);`2`A`Hn>0&&`4^4>=10){`2^7`4^4=0}`4^4++;`4^I`45+'=p;`9^6`42+'(0,0)\",500)}'`U`1`T`g4]=-`s0`U(0,0)}`Hp`l^HReal`R`5V`D^3f1=n+'_OnP`M^C';c1`dx=-1,l,p,mn`3o`r`5^2?`5^2:`5Source^3n=`5P`M^3l=`5Length()/1000;p=`5`t()/1000`3n!=`44+'){`Hn`lx=1`3^D0`N2`N4`N5)x=2`3^D0&&(p>=l||p==0))x=0`3x>=0)`2`A`H^D3&&(`4^4>=10||!`43+')){`2^7`4^4=0}`4^4++;`4^I^B`H`42+')`42+'(o,n)}'`3`O)o[f2]=`O;`O`1`T1+c2)`U`1`T1+'`9^6`41+'(0,0)\",`43+'?500:^8);'+c2`g4]=-1`3`W)o[f3]=`s0`U(0,0^5s`1'e',`El,n`3m.autoTrack&&`C){l=`C(`W?\"OBJECT\":\"EMBED\")`3l)for(n=0;n<l.length;n++)m.a(`y;}')`3`S)`S('on`k);`p `H`J)`J('`k,false)",t.m_i("Media"),t.charSet="utf-8",t.trackInlineStats=!1,t.trackDownloadLinks=!1,t.trackExternalLinks=!1,t.loadModule("Media"),t.Media.autoTrack=!0,t.Media.trackVars="",t.Media.trackEvents="None",t.visitorID=Wol.Logging.getVisitor(),t}catch(i){return Wol.Logging.LoggerTemplate.prototype.throwOrIgnore(i)}},_findInteractionTypeIdElement:function(n){return n==null||n==undefined?null:n.attributes&&n.attributes[Wol.Logging.Const.ElementAttrib.InteractionTypeId]?n:Wol.Logging.Internal._findInteractionTypeIdElement(n.parentElement||n.parentNode)},_setPropFromElement:function(n,t){for(var r=Wol.Logging.Const.ElementAttrib.AdditionalProp+Wol.Logging.Const.ElementAttrib.AdditionalPropSep,u,r=r.toLowerCase(),i=0;i<t.attributes.length;i++)if(t.attributes[i].name.toLowerCase().indexOf(r)==0&&(u=n.setScalar(t.attributes[i].name.substr(r.length),t.attributes[i].value),u!=Wol.Logging.ResultId.Success))throw Error.create("Wol.Logging.SetScalarFailedException");}},typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.Dogfood=="undefined"&&(Ms.Wol.Dogfood={}),Ms.Wol.GetQueryParameters=function(){for(var r={},u=location.search.substring(1),t=u.split("&"),i,f,e,n=0;n<t.length;n++)(i=t[n].indexOf("="),i!=-1)&&(f=t[n].substring(0,i),e=t[n].substring(i+1),r[decodeURIComponent(f)]=decodeURIComponent(e));return r},Ms.Wol.Dogfood.GetIsDogfoodUserPage=function(){var n=document.getElementsByName("MS.IsDFUser");return n==null?null:n.length!=1?null:n[0].content==="true"},Ms.Wol.Dogfood.TryDogfoodRedirect=function(n){var i,t,r,u,f;if(typeof n=="boolean"&&(i=Ms.Wol.Dogfood.GetIsDogfoodUserPage(),!!i!=n)){if(t=null,location.search=="")t="?woldogcb=0";else try{if(r=Ms.Wol.GetQueryParameters(),u=r.woldogcb||"",u=="0")return;t=location.search+"&woldogcb=0"}catch(e){t=null}t!=null&&(f=location.protocol+"//"+location.hostname+location.port+location.pathname+t+location.hash,location.replace(f))}},link_expandAllText=link_expandAllText?link_expandAllText:"",link_collapseAllText=link_collapseAllText?link_collapseAllText:"",function(){function h(n){var t=n.target?n.target:n.srcElement,i;if(t.attributes["class"]&&(i=t.attributes["class"].value,s.hasOwnProperty(i)&&(s[i](t,i,!0),!v(n))))return!1}function w(){var n=jQuery("a.link_expandAll"),f,e,o;jQuery.each(n,function(){u(this)===t.expand&&r(this,"link_expandAll",!1)}),f=jQuery("a.link_collapseAll"),jQuery.each(f,function(){u(this)===t.collapse&&r(this,"link_collapseAll",!1)}),e=jQuery("a.link_expand"),jQuery.each(e,function(){u(this)===t.expand&&i(this,"link_expand",!1)}),o=jQuery("a.link_collapse"),jQuery.each(o,function(){u(this)===t.collapse&&i(this,"link_collapse",!1)})}function b(n,t){if(!n||!t)return-1;if(n===t)return 0;for(var r=1,i=n.parentNode;i&&i!==document;){if(i===t)return r;r++,i=i.parentNode}return-1}function c(n,t,i){var r=b(n,t);return r<0||r>i?!1:!0}function i(t,i,r){if(t){var u=jQuery(t).closest(".link_container").parent().closest("div")[0],f=u.childNodes[1],h=u.parentNode,c=jQuery(t).closest(".link_container"),s=c.find(".link_image_container a img")[0];u&&f&&(i==="link_collapse"?(n(t,"link_expand"),n(f,"expand"),n(s,"link_image_expand"),r&&o(t)):i==="link_expand"&&(n(t,"link_collapse"),n(f,"collapse"),n(s,"link_image_collapse"),r&&e(t)),k(h))}}function l(n,t,r){if(n){var f=jQuery(n).closest(".link_container"),u=f.find("a")[1],e=u.attributes["class"].value;i(u,e,r)}}function r(t,i,r){var l,f,s,p,v,y,w,u,h,b,c,k;if(t)for(l=t.parentNode.childNodes,i==="link_expandAll"&&(n(t,"link_collapseAll"),a(t,link_collapseAllText),r&&e(t)),i==="link_collapseAll"&&(n(t,"link_expandAll"),a(t,link_expandAllText),r&&o(t)),f=0;f<l.length;f++)if((s=jQuery(l[f]).attr("class"),s)&&(s.indexOf("faqEntry")!==-1||s.indexOf("procedure")!==-1||s.indexOf("section")!==-1))for(p=l[f].childNodes,v=0;v<p.length;v++)(y=p[v],w=y.attributes["class"],w)&&(u=w.value,(u==="question"||u==="title_procedure ecTitle"||u==="title_section ecTitle")&&(h=jQuery(y).find(".link_container").children(),h&&h.length===2&&(b=jQuery(h[0]).find("a img")[0],c=jQuery(h[1]).find("a")[0],i==="link_expandAll"?(n(b,"link_image_expand"),n(c,"link_expand"),r&&o(c)):i==="link_collapseAll"&&(n(b,"link_image_collapse"),n(c,"link_collapse"),r&&e(c)))),(u==="collapse"||u==="expand")&&(k=y,i==="link_expandAll"?n(k,"expand"):i==="link_collapseAll"&&n(k,"collapse")))}function n(n,t){n&&t&&(n.attributes["class"].value=t)}function a(n,t){n&&t&&(n.innerHTML=t)}function u(n){var t=n.getAttribute(f);return t?Ms.Wol.Cookies.GetCookie(t):null}function e(n){if(n){var i=jQuery(n).attr(f);i&&Ms.Wol.Cookies.SetCookie(i,t.expand)}}function o(n){if(n){var i=jQuery(n).attr(f);i&&Ms.Wol.Cookies.SetCookie(i,t.collapse)}}function v(n){return n.preventDefault?(n.preventDefault(),!0):!1}function y(){jQuery("span.button>a").keypress(function(n){var t,i;n.which===32&&(t=Boolean(jQuery(this).attr("href")),this.onClick&&(this.onClick()||(t=!1)),t&&(this.click?this.click():(i=document.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(i),window.location.href=jQuery(this).attr("href")),v(n)))})}function k(n){if(n){var r=jQuery(n).children(".link_expandAll"),u=jQuery(n).children(".link_collapseAll"),t=jQuery(n).find("a.link_expand"),i=jQuery(n).find("a.link_collapse");t=t.filter(function(){return c(jQuery(this)[0],n,7)}),i=i.filter(function(){return c(jQuery(this)[0],n,7)}),jQuery(i).length>0?(jQuery(u).attr("class","link_expandAll"),jQuery(u).html(link_expandAllText)):jQuery(t).length>0&&(jQuery(r).attr("class","link_collapseAll"),jQuery(r).html(link_collapseAllText))}}function p(){var n=navigator.appVersion.split(";")[1]===" MSIE 6.0",t=navigator.appName==="Safari"||navigator.userAgent.indexOf("Safari")!==-1,i;(n||t)&&(i=jQuery("div.section_oly-bg-stretch").parent(),i.each(function(){var n=jQuery(this),t=n.children().children("img.embedObject");t.height()<n.height()&&t.height(n.height())}))}var s={link_expand:i,link_collapse:i,link_expandAll:r,link_collapseAll:r,link_image_expand:l,link_image_collapse:l},f="data-id",t={expand:"e",collapse:"c"};(function(){document.attachEvent?document.attachEvent("onclick",h):document.addEventListener&&document.addEventListener("click",h,!1),jQuery(document).ready(w)})(),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(y):jQuery(document).ready(y),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(p):jQuery(document).ready(p)}(),function(n){"use strict";n(function(){var r=n("<div><\/div>").css({"background-color":"#009cc7",width:"0",height:"0"}),u,t,f,e;if(r.appendTo(document.body),u=i(r.css("background-color")),u==="#000000")n("body").addClass("hcDark"),t="data-HCDkAltSrc";else if(u==="#ffffff")n("body").addClass("hcLight"),t="data-HCLtAltSrc";else return;f="img["+t+"]",e=n(f),e.each(function(){this.src=this.getAttribute(t)})});var i=function(n){var t=function(n){return("0"+parseInt(n).toString(16)).slice(-2)};return n.search("rgb")===-1?n:(n=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/),"#"+t(n[1])+t(n[2])+t(n[3]))}}(jQuery),function(n,t){"use strict";var r=[],u={query:"q",allowed:["q","prd","s","osd"]};t(function(){t("div.SearchQuery").each(function(){r.push(new Wol.SearchBox(this))})});var f=function(n){var i=t(n),r,u;if(!i.hasClass("SearchQuery"))throw"Wol.SearchBox: Unable to instantiate due to invalid root element";this.$rootElement=i.first(),this.$inputElement=this.$rootElement.find("input").first(),this.$buttonElement=this.$rootElement.find("button").first(),this.searchPageUrl=this.$rootElement.data("action"),this.canSetSearchTerm=!!this.$rootElement.data("load-search-term"),this.hasTextButton=!this.$buttonElement.is(":has(img)"),r=e.bind(this),u=o.bind(this),this.$inputElement.focus(r),this.$inputElement.blur(u),this.$buttonElement.focus(r),this.$buttonElement.blur(u),this.$inputElement.keypress(s.bind(this)),this.$buttonElement.click(h.bind(this)),this._resizeTextBox()},e=function(){this.$rootElement.addClass("SearchQueryHasFocus"),this.hasTextButton||this.$buttonElement.addClass("accentBackgroundHover")},o=function(){this.$rootElement.removeClass("SearchQueryHasFocus"),this.hasTextButton||this.$buttonElement.removeClass("accentBackgroundHover")},s=function(n){n.which===13&&(this.performSearch(n),n.preventDefault())},h=function(n){this.performSearch(n)},c=function(n){var e=this.$inputElement.val(),o,t,i,r,f;if(e){for(o=Wol.Util.HashParameters.getHash(),t={},i=0;i<u.allowed.length;i++)r=u.allowed[i],o[r]&&(t[r]=o[r]);return t[u.query]=e,f=this.searchPageUrl+"#"+Wol.Util.Tools.toUrlParams(t),Wol.ContentInstrumentation.Logging.FireClickEvent(null,n.currentTarget,f,n.currentTarget.title),location.href!==f?location.href=f:Wol.Search&&Wol.Search.refreshResults(),!0}return this.$inputElement.focus(),!1},l=function(n){this.canSetSearchTerm?this.$inputElement.val(n):this.$inputElement.val("")},a=function(){if(this.hasTextButton){var t=this.$rootElement.width(),i=this.$buttonElement.outerWidth(),n=this.$inputElement.parent(),r=n.outerWidth(!0)-n.width(),u=t-i-r;n.width(u)}},v=function(n){for(var t=0,i=r.length;t<i;t++)r[t].setSearchTerm(n)};n.Namespace.define("Wol",{SearchBox:n.Class.define(f,{performSearch:c,setSearchTerm:l,_resizeTextBox:a},{updateQuery:v})})}(WinJS,jQuery),jQuery(document).ready(processDocumentLoaded),typeof Wol=="undefined"&&(Wol={}),Wol.SocialFeedback=function(n){"use strict";function u(){var n=Math.floor(Math.random()*65536).toString(16),t=n.length;return t==4||(n=t==3?"0"+n:t==2?"00"+n:"000"+n),n}function p(){return u()+u()+"-"+u()+"-"+u()+"-"+u()+"-"+u()+u()+u()}var i={yes:"1",no:"0",somewhat:"0.5"},o,r,s,f,l,a,h,v;n(function(){var t=n(".socRatingButton:disabled");t.removeAttr("disabled"),n("#socRatingYesBtn").click(c.bind(this,i.yes)),n("#socRatingNoBtn").click(c.bind(this,i.no)),n("#socRatingSomewhatBtn").click(c.bind(this,i.somewhat)),n("#socCommentYesBtn").click(y.bind(this,i.yes)),n("#socCommentNoBtn").click(y.bind(this,i.no)),r=n(".socCommentVerboseText"),r.keyup(e),r.change(e),r.focus(e),r.bind("paste",function(){window.setTimeout(e,200)}),s=n("#feedbackRoot"),f=parseInt(n("#socCommentMaxSize").text()),l=parseInt(n("#socCommentMaxEncodedSize").text()),a=n(".socRatingPnl"),h=n(".socCommentPnl"),v=n(".socThankPnl")});var c=function(t){if(!Wol.Logging){Sys.Debug.assert(!1,"Logging library is not available",!0);return}if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}return o=p(),Wol.ContentInstrumentation.Logging.LogCustomBI("Rating",{Rating:t,FeedbackId:o},s[0]),t===i.no?(n("#socCommentTitle").html(n("#socCommentNoPrompt").html()),n("#socCommentYesBtn").html(n("#socCommentNoYesString").html()),n("#socCommentNoBtn").html(n("#socCommentNoNoString").html())):t===i.somewhat&&(n("#socCommentTitle").html(n("#socCommentSomewhatPrompt").html()),n("#socCommentYesBtn").html(n("#socCommentSomewhatYesString").html()),n("#socCommentNoBtn").html(n("#socCommentSomewhatNoString").html())),a.hide(),h.show(),r.focus(),!1},e=function(){var n=r[0],o=5;n.value.length>f&&(n.value=n.value.substr(0,f));var t=escape(n.value),h=t.length,i=l-o;if(h>i){var u=t.substr(0,i),e=t.substr(i,o),s=e.lastIndexOf("%"),c;u+=s==-1?e:e.substr(0,s),n.value=unescape(u)}},y=function(n){if(!Wol.Logging){Sys.Debug.assert(!1,"Logging library is not available",!0);return}if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}var u=r[0];return n===i.yes&&u.value.length>0&&Wol.ContentInstrumentation.Logging.LogCustomBI("Feedback",{Verbatim:u.value,FeedbackId:o},s[0]),h.hide(),v.show(),!1}}(jQuery),window.CanvasHelper||(window.CanvasHelper={}),CanvasHelper.initCanvas=function(n,t,i,r,u){var f=document.getElementById(n),e=document.getElementById(t);CanvasHelper.isCanvasSupported()?(jQuery(f).show(),jQuery(e).hide(),i(r,u)):(jQuery(e).show(),jQuery(f).hide())},CanvasHelper.isCanvasSupported=function(){var n=document.createElement("canvas");return!!(n.getContext&&n.getContext("2d"))},jQuery(document).ready(function(){jQuery("iframe.iframeNoBorder").attr("frameborder","0")}),window.Wol||(window.Wol={}),Wol.Authentication=function(n){"use strict";var t={silentAuth:0,signedOut:1,signedIn:2},f="MS.LiveSignIn",c="SignedState",l="meta[name='MS\\.AuthenticationDisabled']",a="meta[name='MS\\.BIAuthStateLoggingDisabled']",e="LiveId",o="wol.auth.ifrm",r=t.signedOut,v=function(){var n=t.signedOut,u=Ms.Wol.Cookies.GetCookie(e,!0),o,i,s,r,h;if(u)for(o=u.split("&"),i=0;i<o.length;i++)if(s=o[i],r=s.split("="),r.length===2&&(h=r[0],h==f)){n=parseInt(r[1]),(isNaN(n)||n!==t.silentAuth&&n!==t.signedIn&&n!==t.signedOut)&&(n=t.signedOut);break}return n},s=function(t,i,r){var h=n(t)[0],u,e,f,o,c,s;h&&(u=h.href,u)&&(e=r?"%3d":"=",f=-1,r?f=u.indexOf("%3f"+i+e):(o=u.indexOf("?"+i+e),c=u.indexOf("&"+i+e),o^c&&(f=o!=-1?o:c)),f!=-1&&(s=u.indexOf("&",f+1),s!=-1?n(t)[0].href=u.substring(0,s)+encodeURIComponent(encodeURIComponent(window.location.hash))+u.substring(s):n(t)[0].href+=encodeURIComponent(encodeURIComponent(window.location.hash))))},r=v();s("#WOLSignInButton","wreply"),s("#WOLSignOutButton","ru");var h=function(t){var i,r=n(t);return r.length&&(i=r.attr("content")),i},i=function(t){var e=t&&t.authenticated,r=n("#HeaderSignIn"),s=r.height()*1.5,i,u,o,f,c,l;if(n("#WOLLoadingSpan").hide(),e){if(r.css("visibility","hidden"),n("#WOLSignOutButton").show(),i=[],t.displayName&&i.push(t.displayName),t.firstName&&i.push(t.firstName),i.length>0){for(u=n("#WOLUserName"),u.show(),o=!1,f=0,c=i.length;f<c;f++)if(u.text(i[f]),r.height()<=s){o=!0;break}o||u.hide()}r.css("visibility","")}else n("#WOLSignInButton").show();h(a)||y(e),l=t&&t.isWLDogfoodUser,Ms.Wol.Dogfood.TryDogfoodRedirect(l)},u=function(n){Wol.ContentInstrumentation.Logging.LogCustomBI(c,{"Ms.LiveSignIn":n}),Ms.Wol.Cookies.SetCookieField(e,f,n,"",!0)},y=function(n){var i=t.signedOut;n&&(i=document.getElementById(o)!=null?t.silentAuth:t.signedIn),r==t.silentAuth?i==t.signedOut&&u(i):r==t.signedIn?i==t.signedOut&&u(i):r==t.signedOut&&(i==t.signedIn||i==t.silentAuth)&&u(i)},p=function(){n.ajax({type:"POST",url:"/WolAuthenticationHandler.ashx",dataType:"json",success:function(t){if(t&&t.authenticationEnabled){if(t.authenticated){i(t);return}if(!t.silentAuthDisabled){n("<iframe/>",{id:o,src:WolAuthenticationSilentAuthHref,style:"display: none"}).appendTo("body");return}}i()},error:function(){i()}})};return n(window).bind("load",function(){var t,r;h(l)||(t=n("#WolAuthenticationIndicatorImage"),t.show(),r=t[0]&&t[0].complete&&t.width()==t.height()&&t.width()==1,t.hide(),r?p():i())}),{setAuthenticationState:i}}(jQuery),window.Wol||(window.Wol={}),Wol.PictureSwitcher=function(n){"use strict";n(document).ready(function(){i("PictureSwitcher",document).each(function(){r(this)})});var i=function(t,i){return n("."+t,i)},r=function(t){var h=Wol.ContentInstrumentation.Logging,c=Wol.Util.Tools,r,l,a=1e3,f,u,v=!1,e,s,it=function(t){r=n(t),l=i("PSWait",r),f=i("PSPage",r),u=f.filter(".PSActive").index(),o(),i("PSThumbContainer",r).click(rt),i("PSPreviewContainer",r).click(function(n){tt(),d(this),n.preventDefault()}),i("PSPagePrev",r).click(function(){g()&&k(this)}),i("PSPageNext",r).click(function(){nt()&&k(this)}),i("PSPreview",r).bind("load",y),setTimeout(function(){l.show()},a),n(window).bind("load",function(){v=!0,y()})},o=function(){var n="PSDisabled";u>0?i("PSPagePrev",r).removeClass(n):i("PSPagePrev",r).addClass(n),u<f.length-1?i("PSPageNext",r).removeClass(n):i("PSPageNext",r).addClass(n)},y=function(){if(v){var n=b(),t=new Image;t.src=n.data("preview-url")}},p=function(){e&&e.unbind("load"),s&&clearTimeout(s)},w=function(t){var o,u,f;p(),o=i("PSInnerThumbContainer",t).children("img").attr("alt"),u=i("PSPreview",r),e=n("<img/>",{"class":u.attr("class"),src:t.data("preview-url"),alt:o,width:t.data("preview-width"),height:t.data("preview-height"),"data-disabledefaultlogging":!0}),f=function(){p(),u.remove(),e.appendTo(i("PSPreviewContainer",r)),i("PSCaption",r).text(t.data("caption"))},s=setTimeout(f,a),e.bind("load",f)},b=function(){var e=i("PSSelection",r),u=e.closest(".PSThumbContainer"),n=u.next(),o,t;return n.length===0&&(o=u.parent(),t=o.next(),t.length===0&&(t=f.first()),n=i("PSThumbContainer",t).first()),n},k=function(n){var t=r.data("control-id"),u=i("PSPagePrev",r),f=n===u[0]?"prev":"next",e=encodeURI("/PictureSwitcher?"+c.toUrlParams({controlId:t,pagination:f}));h.FireClickEvent(null,n,e)},d=function(n){var u=i("PSSelection",r),t=u.closest(".PSThumbContainer"),f=r.data("control-id"),e=t.data("preview-tfs-id"),o=t.data("preview-revision"),s=encodeURI("/PictureSwitcher?"+c.toUrlParams({controlId:f})),l={"MS.Cid":e,"MS.CVer":o};h.FireClickEvent(l,n,s)},rt=function(t){var u=n(this),f=i("PSSelection",r);f.closest(".PSThumbContainer").removeClass("accentColor").removeClass("PSActive"),f.remove(),u.addClass("accentColor").addClass("PSActive"),i("PSInnerThumbContainer",u).prepend(f),w(u),d(this),t.preventDefault()},g=function(){return u>0?(n(f[u]).removeClass("PSActive"),--u,n(f[u]).addClass("PSActive"),o(),!0):!1},nt=function(){return u<f.length-1?(n(f[u]).removeClass("PSActive"),++u,n(f[u]).addClass("PSActive"),o(),!0):!1},tt=function(){var e=i("PSSelection",r),s=e.closest(".PSThumbContainer"),t=b();n(f[u]).removeClass("PSActive"),u=t.parent().index(),n(f[u]).addClass("PSActive"),o(),s.removeClass("accentColor").removeClass("PSActive"),e.remove(),t.addClass("accentColor").addClass("PSActive"),i("PSInnerThumbContainer",t).prepend(e),w(t)};return it(t),{paginateBack:g,paginateForward:nt,selectNext:tt}}}(jQuery),window.Wol||(window.Wol={}),Wol.MetroTabs=function(n){"use strict";var t={tabControlClassSelector:".metroTab",horizontalControlClassSelector:".metroTabHorizontal",tabLinkSelector:".metroTabLink:not(.metroTabDropdownLink)",tabLinkSelectedClassSelector:".metroTabLinkSelected",dropdownDivClassSelector:".metroTabDropdown",dropdownLinkClassSelector:".metroTabDropdownLink",dropdownTextClassSelector:".metroTabDropdownText",headingContainerClassSelector:".metroTabHeadingContainer",bodyClassSelector:".metroTabBody",linkContainerClassSelector:".metroTabLinkContainer",horizontalLinkContainerClassSelector:".metroTabLinkContainerHorizontal",contentContainerClassSelector:".metroTabContentContainer",contentClassSelector:".metroTabContent",titleClassSelector:".metroTabTitle",dropdownVariantClassSelector:".metroTabHorizontalVariantDropdown",navLinkContainerClassSelector:".metroTabNavigationLinks",previousLinkClassSelector:".metroTabPrevious",nextLinkClassSelector:".metroTabNext",tabControlTopClassSelector:".metroTabAdjustedTop",dropUpVerticalSpacing:9},f=null,e={};n(function(){ht()});var i=function(n,t,i){var r,f,u,e;if(t&&n.tabs[t]){if(t===n.selectedTabId)return}else t=n.defaultTabId;n.selectedTabId&&(r=n.tabs[n.selectedTabId],f=r.link,f.removeClass("metroTabLinkSelected"),o(r)),u=n.tabs[t],e=u.link,e.addClass("metroTabLinkSelected"),l(u),i&&y(n,u),a(n,t),n.isHorizontal&&v(n,u,r),r&&Wol.Util.Visibility.notifyHideListeners(r.content),n.selectedTabId=t,Wol.Util.HashParameters.setHashValue(n.tabControlId,t,!0)},l=function(t){t.content.addClass("metroTabContentVisible"),t.content.find("*").each(function(){var t=n(this),i=t.attr("data-tabIndex");i?t.attr("tabIndex",i):t.removeAttr("tabIndex"),t.removeAttr("data-tabIndex")})},o=function(t){t.content.removeClass("metroTabContentVisible"),t.content.find("*").each(function(){var t=n(this),i=t.attr("tabIndex");i&&t.attr("data-tabIndex",i),t.attr("tabIndex",-1)})},a=function(n,t){if(n.previousLink&&n.nextLink){var i=n.tabs[t].index;i===0?n.previousLink.hide():n.previousLink.show(),i===n.tabList.length-1?n.nextLink.hide():n.nextLink.show()}},v=function(n,t,i){var r,u;n.isDropdownVariant?(h(n.dropdownLink,t.linkAnchor.text()),Wol.Util.BrowserSpecific.isIE7orLower()&&(n.horizontalLinkContainer.css("width","auto"),r=n.dropdownLink.find(".metroTabDropdownImage").outerWidth(!0)+n.dropdownLink.find(".metroTabDropdownText").outerWidth(!0),n.horizontalLinkContainer.width(r))):t.isDropdownItem?n.dropdownLink.addClass("metroTabDropdownLinkSelected"):n.selectedTabId&&(u=n.tabs[n.selectedTabId],u.isDropdownItem&&n.dropdownLink.removeClass("metroTabDropdownLinkSelected")),t.isDropdownItem&&t.link.addClass("accentBackground").addClass("accentForeground"),i&&i.isDropdownItem&&i.link.removeClass("accentBackground").removeClass("accentForeground")},y=function(n,t){var i="/metroTabs?"+Wol.Util.Tools.toUrlParams({controlId:n.tabControlId,tabId:t.tabId}),r=t.linkAnchor.text();Wol.ContentInstrumentation.Logging.FireClickEvent(null,n.tabControl,i,r)},s=function(t,i,r){i.link.removeClass("metroTabLinkHorizontal"),i.link.detach();var u=n("<li />").append(i.link);r.append(u),i.isDropdownItem=!0,i.dropdownItemIndex=t.dropdownItemList.length,t.dropdownItemList.push(i),i.linkAnchor.attr("tabIndex","-1")},h=function(n,i){n.find(t.dropdownTextClassSelector).children("a").text(i)},p=function(t,i,r){var u,f;if(t.dropdownLink.show(),r){f=0,n(t.tabList).each(function(n,i){i.link.width()>f&&(u=i,f=i.link.width()),s(t,i,t.dropdownList)}),h(t.dropdownLink,u.linkAnchor.text());var e=t.horizontalLinkContainer.outerWidth(!0),o=r.outerWidth(!0)-r.width(),c=i.innerWidth()-e-o;r.width(c)}t.dropdownLink.addClass("metroTabDropdownLinkSelected"),t.dropdownLink.addClass("metroTabLinkLastHorizontal")},w=function(n,t,i){var e=parseInt(n.linkContainer.attr("data-numberOfTabsDisplayed")),u=t.innerWidth(),o,a,r,p,h,c,f,l,v;if(i[0]){if(e)var y=i.outerWidth(!0)-i.width(),o=parseInt(i.css("min-width").replace("px","")),a=o+y;else o=i.width(),a=i.outerWidth(!0);u-=a}r=0,n.tabList[0].link.addClass("metroTabLinkLastHorizontal");do h=n.tabList[r].link.outerWidth(!0),u-=h,r++;while(r<n.tabList.length&&u>0&&!(e&&r>=e));if(r<n.tabList.length||u<0){for(n.dropdownLink.show(),p=n.dropdownLink.outerWidth(!0),u-=p;u<0&&r>1;)r--,h=n.tabList[r].link.outerWidth(!0),u+=h;for(r;r<n.tabList.length;r++)s(n,n.tabList[r],n.dropdownList);c=n.dropdownLink}else n.dropdownLink.hide(),c=n.tabList[n.tabList.length-1].link;if(n.tabList[0].link.removeClass("metroTabLinkLastHorizontal"),c.addClass("metroTabLinkLastHorizontal"),i[0]&&i.width(o+u),n.tabList.length==1&&n.tabList[0].linkAnchor.css("cursor","default"),Wol.Util.BrowserSpecific.isIE7orLower()){for(f=0,c===n.dropdownLink&&(f+=n.dropdownLink.find(".metroTabDropdownImage").outerWidth(!0),f+=n.dropdownLink.find(".metroTabDropdownText").outerWidth(!0)),l=0;l<n.tabList.length;l++)v=n.tabList[l],v.isDropdownItem||(f+=v.link.outerWidth(!0));n.horizontalLinkContainer.width(f)}},b=function(n){var i=n.linkContainer.parents(t.headingContainerClassSelector),r=i.find(t.titleClassSelector);n.isDropdownVariant?p(n,i,r):w(n,i,r),n.dropdownListHeight=n.dropdownList.outerHeight(),n.dropdownDivMarginTop=parseInt(n.dropdownDiv.css("margin-top").replace("px","")),n.linkContainer.addClass("metroTabLinkContainerVisible")},c=function(t){var i=t.adjustedTopAnchor.offset(),r=n(window).scrollTop(),u=r+n(window).height();(i.top<r||i.top>u)&&window.scrollTo(0,i.top)},k=function(n){var r=n.tabs[n.selectedTabId].index,t=n.tabList[r-1];t&&(i(n,t.tabId,!0),c(n))},d=function(n){var r=n.tabs[n.selectedTabId].index,t=n.tabList[r+1];t&&(i(n,t.tabId,!0),c(n))},g=function(n){r(n,n.dropdownFocusedIndex+1)},nt=function(n){r(n,n.dropdownFocusedIndex-1)},r=function(n,t){if(t!==undefined&&t!==null&&!(t<0)&&!(t>=n.dropdownItemList.length)){tt(n);var r=n.dropdownItemList[t],i;i=r.tabId===n.selectedTabId?"metroTabDropdownTabLinkFocusedAndSelected":"metroTabDropdownTabLinkFocused",r.link.addClass(i),n.dropdownFocusedIndex=t}},tt=function(n){n.dropdownFocusedIndex!==undefined&&n.dropdownItemList[n.dropdownFocusedIndex].link.removeClass("metroTabDropdownTabLinkFocusedAndSelected").removeClass("metroTabDropdownTabLinkFocused")},it=function(t){var i=t.data.tabControlData,e;if(!i.isDropdownOpen){f&&u(f),e=i.tabs[i.selectedTabId],e.isDropdownItem?r(i,e.dropdownItemIndex):r(i,0),rt(i),i.dropdownDiv.addClass("metroTabDropdownOpen"),t.stopPropagation();n(document).one("click",function(){u(i)});i.isDropdownOpen=!0,f=i}},rt=function(i){var e=i.dropdownLink.offset(),u=e.top-n(window).scrollTop(),o=n(window).height()-(u+i.dropdownDivMarginTop),f=i.dropdownListHeight+t.dropUpVerticalSpacing,r;r=i.dropdownListHeight>o&&f<=u?-(i.dropdownDivMarginTop+f):0,i.dropdownList.css("top",r+"px")},u=function(n){n.isDropdownOpen&&(n.dropdownDiv.removeClass("metroTabDropdownOpen"),n.isDropdownOpen=!1,f=null)},ut=function(n){var t=Wol.Util.HashParameters.getHash(n.tabControlId);t&&(t=t.toLowerCase(),t!==n.selectedTabId&&i(n,t))},ft=function(n){var t=n.data.tabControlData,r=!1;if(t.isDropdownOpen)switch(n.which){case 9:u(t);break;case 13:i(t,t.dropdownItemList[t.dropdownFocusedIndex].tabId),u(t),r=!0;break;case 27:u(t),r=!0;break;case 38:nt(t),r=!0;break;case 40:g(t),r=!0}return!r},et=function(t){n(t.tabList).each(function(){var n=this.tabId;this.linkAnchor.click(function(){i(t,n,!0)})}),n(t.dropdownItemList).each(function(n){var i=this.tabId;this.linkAnchor.hover(function(){r(t,n)})}),t.dropdownLink.find("a").click({tabControlData:t},it),t.previousLink&&t.nextLink&&(t.previousLink.children("a").click(function(){k(t)}),t.nextLink.children("a").click(function(){d(t)})),n(document).keydown({tabControlData:t},ft),Wol.Util.HashParameters.attachToHashChangeEvent(function(){ut(t)})},ot=function(n){var r=Wol.Util.HashParameters.getHash(n.tabControlId),i=n.linkContainer.find(t.tabLinkSelectedClassSelector).attr("data-tabId");return i?(i=i.toLowerCase(),n.defaultTabId=i):n.defaultTabId=n.tabList[0].tabId,r?(r=r.toLowerCase(),i&&i!==r&&(n.selectedTabId=i)):r=i,r},st=function(r){var u=n(r),s=u.attr("data-tabControlId"),h,y,yt;if(e[s])throw"Duplicate tab control id encountered. Multiple tab controls on this page use id '"+s+"'";else e[s]=s;var f=u.find(t.linkContainerClassSelector).first(),it=f.find(t.horizontalLinkContainerClassSelector).first(),rt=u.find(t.bodyClassSelector).first(),a=rt.children(t.contentContainerClassSelector).first(),p=a.children(t.navLinkContainerClassSelector).first(),w=f.find(t.tabLinkSelector),k={},d=[];for(h=0;h<w.length;h++){var v=n(w[h]),c=v.attr("data-tabId"),ut=v.children("a"),ft=a.children(t.contentClassSelector+"[data-tabId='"+c+"']");c=c.toLowerCase(),y={tabId:c,link:v,content:ft,index:h,linkAnchor:ut},k[c]=y,d[h]=y,o(y)}var g=f.find(t.dropdownDivClassSelector),st=g.children("ul"),nt=f.find(t.dropdownLinkClassSelector),ht=nt.find(t.dropdownTextClassSelector).children("a"),ct=p.find(t.previousLinkClassSelector),lt=p.find(t.nextLinkClassSelector),at=u.find(t.tabControlTopClassSelector),tt=u.is(t.horizontalControlClassSelector),vt=f.is(t.dropdownVariantClassSelector),l={tabControl:u,tabControlId:s,tabs:k,tabList:d,linkContainer:f,horizontalLinkContainer:it,contentContainer:a,dropdownDiv:g,dropdownList:st,dropdownLink:nt,dropdownLinkTextAnchor:ht,dropdownItemList:[],previousLink:ct,nextLink:lt,adjustedTopAnchor:at,isHorizontal:tt,isDropdownVariant:vt,selectedTabId:null,defaultTabId:null};tt&&b(l),et(l),yt=ot(l),i(l,yt)},ht=function(){for(var r=n(t.tabControlClassSelector),i=0;i<r.length;i++)st(r[i])};return{}}(jQuery),window.Wol||(window.Wol={}),Wol.Region=function(n){"use strict";var i={outerRegionLinkedSelector:".regionOuterLinked",regionLinkSuffix:"Link"},u,r;return n(function(){u()}),u=function(){n(i.outerRegionLinkedSelector).click(r),n(i.outerRegionLinkedSelector).keypress(function(n){n.which===13&&r(n)})},r=function(t){var u=t.target,r,f,e;if(!Wol.Util.AnchorClick.isClickOnAnchorElement(t)&&(r=n(u),r.hasClass("regionOuterLinked")||(r=r.parents(i.outerRegionLinkedSelector),r.length))){f=r.attr("id"),e="#"+f.replace(/Outer$/,i.regionLinkSuffix),Wol.Util.AnchorClick.clickOnAnchor(e,{ExId:"RegionBackgroundLink"}),t.preventDefault();return}},{}}(jQuery),function(n){"use strict";var ct=Wol.Util.Algorithm,lt=Wol.Util.Tools,si="#bodyContentPane",s="#Header",a="#HeaderChevronContainer",k="#HeaderPrevious",d="#HeaderNext",at="#HeaderPrevImg",vt="#HeaderNextImg",g="#HeaderSecondaryContainer",f="#HeaderNavSecondary",yt=".NavSep",hi=".HeaderDisabled",pt="#truncStr",nt="#HeaderFBTransparent",h="#HeaderFBOpqaue",tt="",wt="_clone",it=250,v=20,y=10,e=366,rt=333,p=50,c=166,ut=4,bt=2,l=366,kt=!1,i,w,r=0,ft={},et={};n(function(){n.easing.fastToSlow=ni,n(g).data("enable-animations")||(it=0,e=0,rt=0,p=0,c=0,l=0),n(s).length>0&&(dt(),w=n(h).width()),n(f).length>0&&setTimeout(function(){ui(),ti(),i.length>1&&ii()},it)});var dt=function(){n(k).click(function(){st(-1)}),n(d).click(function(){st(1)}),n(window).scroll(function(){var i=n(document).scrollLeft(),r=w+Math.abs(i);n(nt).width(r),n(h).width(r),u()?n(s).css("left",i*-1):(n.browser.msie&&parseInt(n.browser.version,10)<10&&(i=i*-1),n(s).css("right",i))}),n(window).resize(function(){var t=n(s);t.css("left")!=="auto"&&(t.css("left",""),n(nt).width("100%"),n(h).width("100%"),w=n(h).width())})},gt=function(n){var t=n.attr("id"),i=t+wt;ft[t]=i,et[i]=t},ni=function(n){var t=-2.9*Math.pow(n,4)+7.1*Math.pow(n,3)-6.6*Math.pow(n,2)+3.34*n;return.9*3*Math.pow(1-t,2)*t+3*(1-t)*Math.pow(t,2)+Math.pow(t,3)},b=function(n,t,i,r){var s="+="+i+"px",u={duration:e,easing:"fastToSlow",queue:!1},f={duration:l,easing:"fastToSlow",queue:!1},o;r&&(o=e>l?u:f,o.queue=!0,o.complete=r),n.animate({left:s},u),n.animate({opacity:t},f)},ti=function(){var t,e,o;i&&(t=i[r],t.appendTo(f),e=u()?1:-1,o=e*v,t.each(function(t,i){i.style.left=o+"px",n(i).fadeTo(0,0)}),b(t,1,-e*v))},ii=function(){var f=n(a),k={duration:l,easing:"fastToSlow",queue:!1},s=u()?"marginRight":"marginLeft",h={},d,t,o,b;if(h[s]="0px",d=function(){f.animate({opacity:1},k),f.animate(h,e,"fastToSlow")},f.fadeTo(0,0),f[0].style[s]=-v+"px",setTimeout(d,p),kt){var y=u()?1:-1,g="-="+y*ut+"px",nt="+="+y*ut+"px",tt=[g,nt],it=[n(at),n(vt)],w=[r>0,r<i.length-1];for(t=0;t<w.length;t++)if(w[t])for(o=it[t],o.delay(p+e+c),b=0;b<bt;b++)o.animate({left:tt[t]},c,"fastToSlow"),o.animate({left:"0px"},c,"fastToSlow")}},ot=function(t){for(var f,u=0;u<i.length;u++)f=i[u],t&&f.stop(!0,!0),u!==r&&f.remove(),f.each(function(t,i){i.style.left="auto";var r=et[n(i).attr("id")];r&&n(i).attr("id",r)});i[r].fadeTo(0,1)},st=function(t){var s,c,e,l,a,h,v,p,w;t=t<0?-1:1,s=r+t,0<=s&&s<i.length&&(ot(!0),c=i[r],r=s,e=i[r],ht(),l=t<0?e.last():e.first(),a=ft[l.attr("id")],a&&l.attr("id",a),e.appendTo(f),e.show(),h=u()?1:-1,v=o(c.first())-o(e.first())+h*t*y,e.each(function(t,i){i.style.left=v+"px",n(i).fadeTo(0,0)}),p=e.length,w=function(){--p==0&&ot()},b(c,0,h*-t*y),e.delay(rt),e.queue(function(i){b(n(this),1,h*-t*y,w),i()}))},ht=function(){n(a).children().removeAttr("disabled").removeClass("HeaderDisabled"),r===0&&n(k).attr("disabled","disabled").addClass("HeaderDisabled"),r===i.length-1&&n(d).attr("disabled","disabled").addClass("HeaderDisabled")},ri=function(n){var t=n.children();n.empty(),n.append(t)},ui=function(){var t=n(f),c,e,u,h,o,s;for(ri(t),tt=jQuery.trim(n(pt).text()),fi()?n(a).show():t.css({width:"auto",maxWidth:"none"}),c=t.width(),i=oi(c),r=0,e=!1,u=i.length-1;!e&&u>=0;u--)for(h=i[u],o=0;!e&&o<h.length;o++)h.eq(o).hasClass("HeaderActTax")&&(r=u,e=!0);for(ht(),t.children().css("visibility","visible"),s=0;s<i.length;s++)i[s].css("visibility","visible")},fi=function(){var i=n(f),t=ei(i.children().last()),r=n(g).width();return t<0||r<t},u=function(){return u=n("body").css("direction")==="ltr"?function(){return!0}:function(){return!1},u()},o=function(n){return u()?n.position().left:n.position().left+n.width()},ei=function(n){return u()?n.position().left+n.width():n.position().left},oi=function(t){for(var l=n(f).children(),v=l.filter(yt).length,i=l.slice(v*2),y=function(n){var r=o(i.eq(n));return 0<r&&r<t},a=[],h,c,w;i.length>0;){var r=Math.max(1,ct.partitionPoint(i,y)),s=i.eq(r-1),p=u()?t-o(s):o(s),e=lt.truncateWithEllipsis(s,tt,p);e||(r=Math.max(1,r-1)),h=i.slice(0,r).clone(),e&&h.last().text(e),a.push(h),c=r,w=e.length>0&&e!==s.text(),h.length>1&&w&&(gt(h.last()),--c),i.slice(0,c).remove(),i=i.slice(c)}return a}}(jQuery),Wol.Aobi=function(n){"use strict";var i={outerAobiSelector:".section_oly",backgroundAobiSelector:".section_oly-bg",clickableAobiSelector:".section_oly-bg-clickable",clickableAobiBgImageSelector:".section_oly-bg .navigationLink"};n(function(){u()});var u=function(){n(i.clickableAobiSelector).click(f),n(i.clickableAobiBgImageSelector).click(r)},f=function(n){if(!Wol.Util.AnchorClick.isClickOnAnchorElement(n))return r(n)},r=function(t){var r=n(t.target).parents(i.outerAobiSelector),u,f;if(r.length)return(u=r.first().children(i.backgroundAobiSelector),!u.length)?void 0:(f=u.first().children("a"),!f.length)?void 0:(Wol.Util.AnchorClick.clickOnAnchor(f[0],{ExId:"AOBIBackgroundLink"}),!1)};return{}}(jQuery),window.Wol||(window.Wol={}),Wol.Dropdown=function(n){"use strict";function p(n,t){var i=t.attr("data-value");i?(n.dropdownButtonAnchor.attr("href",i),n.dropdownButtonAnchor.removeClass("dropdown_button_disabled")):(n.dropdownButtonAnchor.addClass("dropdown_button_disabled"),n.dropdownButtonAnchor.removeAttr("href"))}var i=null,e=function(){typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(f):n(function(){f()})},o=function(t){var f=t.data.dropdownData;if(!f.isDropdownOpen){i&&u(i),w(f),Wol.Util.BrowserSpecific.isIE7orLower()&&f.dropdownControl.css("z-index",1),f.dropdownList.addClass("dropdown_open"),r(f,f.selectedIndex);n(document).one("click",function(){u(f)});return f.dropdownTextAnchor.focus(),f.isDropdownOpen=!0,i=f,!1}return!0},u=function(n){n.isDropdownOpen&&(n.dropdownList.removeClass("dropdown_open"),Wol.Util.BrowserSpecific.isIE7orLower()&&n.dropdownControl.css("z-index",0),n.isDropdownOpen=!1,i=null)},s=function(n){n.selectedIndex<n.listItems.length-1&&t(n,n.selectedIndex+1)},h=function(n){n.selectedIndex>0&&t(n,n.selectedIndex-1)},c=function(n){n.focusedIndex<n.listItems.length-1&&r(n,n.focusedIndex+1)},l=function(n){n.focusedIndex>0&&r(n,n.focusedIndex-1)},a=function(n){n.dropdownLink.addClass("dropdown_link_focused")},v=function(n){n.dropdownLink.removeClass("dropdown_link_focused")},y=function(n){var i=n.data.dropdownData,r=!1;if(i.isDropdownOpen)switch(n.which){case 9:case 13:t(i,i.focusedIndex),i.dropdownTextAnchor.click(),r=!0;break;case 27:u(i),r=!0;break;case 38:l(i),r=!0;break;case 40:c(i),r=!0}else if(document.activeElement===i.dropdownTextAnchor[0])switch(n.which){case 38:h(i),r=!0;break;case 40:s(i),r=!0}return!r},t=function(n,t,i){var u,r;if(i||n.dropdownTextAnchor.focus(),n.selectedIndex!==undefined){if(n.selectedIndex===t)return;u=n.listItems[n.selectedIndex],u.removeClass("accentForeground").removeClass("accentBackground")}r=n.listItems[t],r.addClass("accentForeground").addClass("accentBackground"),n.dropdownTextAnchorSpan.text(r.text()),n.selectedIndex=t,p(n,r)},r=function(n,t){n.focusedIndex!==undefined&&n.listItems[n.focusedIndex].removeClass("dropdown_item_focused_and_selected").removeClass("dropdown_item_focused");var i;i=t===n.selectedIndex?"dropdown_item_focused_and_selected":"dropdown_item_focused",n.listItems[t].addClass(i),n.focusedIndex=t},w=function(t){var o=t.dropdownLink.offset(),u=o.top-n(window).scrollTop(),e=n(window).height()-(u+t.listItemHeight),s=t.selectedIndex*t.listItemHeight,h=(t.listItems.length-t.selectedIndex)*t.listItemHeight,f=(t.listItems.length-1)*t.listItemHeight,r;r=s>u&&f<e?0:h>e&&f<u?f:t.selectedIndex*t.listItemHeight,t.dropdownList.css("top",-r+"px")},b=function(i){i.dropdownLink.click({dropdownData:i},o),i.dropdownTextAnchor.focus(function(){a(i)}),i.dropdownTextAnchor.focusout(function(){v(i)}),n(i.listItems).each(function(n){this.click(function(){t(i,n)}),this.hover(function(){r(i,n)})}),n(document).keydown({dropdownData:i},y)},k=function(t){var i=0,e,r,u,f;n(t.listItems).each(function(){var n=this.outerWidth();n>i&&(i=n)}),e=t.dropdownImage.outerWidth(),r=i+e,t.dropdownLink.width(r),t.dropdownList.width(r),u=t.dropdownLink.outerWidth(!0)+t.dropdownButtonAnchor.parent().outerWidth(!0)+1,f=t.dropdownLink.parent(),f.width()<u&&f.width(u)},d=function(i){var r=i.find(".dropdown_link"),e=r.children(".dropdown_link_text"),o=e.children("a"),h=o.children("span"),c=r.children(".dropdown_link_image"),l=i.find("a.dropdown_button"),s=i.find(".dropdown_list"),a=s.find("li"),u=[],v,f;a.each(function(){u.push(n(this))}),v=u[0].outerHeight(),f={dropdownControl:i,dropdownLink:r,dropdownText:e,dropdownTextAnchor:o,dropdownTextAnchorSpan:h,dropdownImage:c,dropdownButtonAnchor:l,dropdownList:s,listItems:u,listItemHeight:v},k(f),b(f),t(f,0,!0)},f=function(){for(var i=n(".section_section-list-dropdown_script"),t=i.length-1;t>=0;t--)d(n(i[t]))};return e(),{}}(jQuery),window.Wol||(window.Wol={}),Wol.Social=function(n,t){"use strict";var i={},r=function(n,i,r){var u,f,o,e;if(n!==t)return window.location===t?void 0:(u=null,f=null,i!==t&&i!==null&&(o=window.location.href,e={},e[i]=o,u=jQuery.param(e)),r!==t&&r!==null&&(u=u!==null?u+"&"+r:r),f=u!==null?n+"?"+u:n)},u=function(u){var e=n(u),c=e.data("action-endpoint-url"),l=e.data("page-url-parameter-name"),a=e.data("query-string"),h=e.data("window-options"),s=e.data("share-target-id"),o=r(c,l,a),f;return o===t?!1:(f=i[s],f===t||f===null||f.closed?(f=h===t||h===null?window.open(o,s):window.open(o,s,h),i[s]=f):f.location=o,Wol.ContentInstrumentation!==t&&Wol.ContentInstrumentation.Logging!==t&&Wol.ContentInstrumentation.Logging.FireClickEvent(null,u,o),f.focus(),!1)};return{SharePage:u}}(jQuery),function(n){"use strict";var i=0;n(function(){r(),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"&&Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){r()})});var r=function(){n("div.UnresolvedVideoContainer").each(function(){u(this)})},u=function(t){var r=n(t),e=r.data("video-detection"),u,s,o;if(!e)throw"The data-videoDetection attribute does not contain a valid information to resolve the video player";u=f(e),u&&(s=h(u.html),r.append(s),u.reqType||(o=r.closest(".HeroContainer"),o.length&&(o.removeClass("ShowTitleCard").addClass("ErrorOverride"),n(".HeroVideoContainerParent").removeClass("HideHeroVideoContainer")))),r.removeClass("UnresolvedVideoContainer").addClass("VideoContainerInner"),Wol.Video&&Wol.Video.PlayerBase&&Wol.Video.PlayerBase.initialize(r[0]),Wol.Video&&Wol.Video.Hero&&Wol.Video.Hero.initialize(r[0]),i++},f=function(n){for(var t=0,u=n.length;t<u;t++){var i=n[t],r=i.reqType,f=i.reqParam;if(!r||e(r,f))return i}return null},e=function(n,t){switch(n){case"html5player":return o(t==="track");case"silverlightplayer":return s(t,"4.0.50401.0");default:return!1}},o=function(n){try{if(navigator.userAgent&&navigator.userAgent.match(/Windows NT 5\.1/i))return!1;var t=document.createElement("video"),i=t.canPlayType!=null&&t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');return i!=="probably"?!1:n&&!("track"in document.createElement("track"))?!1:!0}catch(r){return!1}},s=function(t,i){try{return n.ajax({url:t,async:!1,cache:!0,dataType:"script"}),Silverlight.isInstalled(i)}catch(r){return!1}},h=function(n){var t=/(data-script-id="|ScriptableName=)(p[0-9a-f]{32})/g;return n.replace(t,"$1$2_"+i)}}(jQuery),function(n,t){"use strict";var r=function(){},u=function(){throw"Not implemented";},f=function(){throw"Not implemented";},e=function(){throw"Not implemented";},o=function(){throw"Not implemented";},s=function(){throw"Not implemented";},h=function(){throw"Not implemented";},c=function(){throw"Not implemented";},l=function(){this.$rootElement.hasClass("autoplay")&&this.$rootElement.isVisible()&&this.play()},a=function(){this.$rootElement.removeClass("autoplay")},v=function(){this.pause()},y=function(n){var t=null,i;return Wol.Video.MetroPlayer.isCompatible(n)?t=new Wol.Video.MetroPlayer(n):Wol.Video.SilverlightPlayer.isCompatible(n)&&(t=new Wol.Video.SilverlightPlayer(n)),t&&(new Wol.Video.BI(t),t.addEventListener("loadedmetadata",l.bind(t),!1),t.addEventListener("play",a.bind(t),!1),Wol.Util.Visibility.initHideListener(n,v.bind(t)),i=t.$rootElement.parent(),i.data("wolVideoPlayer",t),i.addClass("wolVideoPlayer")),t},p=function(n){var i=t(n).find(".wolVideoPlayer").first().data("wolVideoPlayer");return i&&i instanceof Wol.Video.PlayerBase?i:null};n.Namespace.define("Wol.Video",{PlayerBase:n.Class.define(r,{play:u,pause:f,currentTime:e,duration:o,enableTabbing:s,buffered:h,fullScreen:c},{initialize:y,getVideoPlayer:p})}),n.Class.mix(Wol.Video.PlayerBase,n.Utilities.createEventProperties("play","pause","timeupdate","ended","progress","loadedmetadata","fullscreenchange","closedcaptionchange","cuechange")),n.Class.mix(Wol.Video.PlayerBase,n.Utilities.eventMixin)}(WinJS,jQuery),function(n,t,i){"use strict";var e=function(n){var i=t(n);if(i.hasClass("mpContainer"))this.$rootElement=i;else if(this.$rootElement=i.find("div.mpContainer").first(),!this.$rootElement.length)throw"MetroPlayer: Unable to initialize video";this.videoTechnology="HTML5",this.hasError=!1,o.call(this)},u,o=function(){this.isInitialized||(this.videoElementObj=new Wol.Video.MetroPlayer.VideoElement(this),u=Wol.Video.MetroPlayer.Utils.fullScreen.eventName,u&&document.addEventListener(u,f.bind(this)),this.$rootElement.bind("selectstart",function(n){n.preventDefault()}),t(window).resize(l.bind(this)),this.addEventListener("ended",a.bind(this),!1),this.addEventListener("error",v.bind(this),!1),this.components={controlBar:new Wol.Video.MetroPlayer.ControlBar(this),keyboardAccessibility:new Wol.Video.MetroPlayer.KeyboardAccessibility(this),poster:new Wol.Video.MetroPlayer.Poster(this),track:new Wol.Video.MetroPlayer.TextTrack(this),closedCaptionOverlay:new Wol.Video.MetroPlayer.ClosedCaptionOverlay(this)},this.isInitialized=!0)},r=function(n){return function(){var t=Array.prototype.slice.call(arguments,0);return this.videoElementObj[n].apply(this.videoElementObj,t)}},s=function(n){var t=Wol.Video.MetroPlayer.Utils.fullScreen(this.$rootElement.get(0),n);return n===i||u||f.call(this,n),t},h=function(n){var t=this.components.track;return t?t.enable(n):!1},c=function(n){n?this.$rootElement.find("button").removeAttr("tabIndex"):this.$rootElement.find("button").attr("tabIndex","-1").blur()},f=function(n){this.dispatchEvent("fullscreenchange",n),this.dispatchEvent("resize",n)},l=function(n){this.fullScreen()&&this.dispatchEvent("resize",n)},a=function(){this.fullScreen(!1)},v=function(){this.fullScreen(!1)},y=function(n){var i=t(n);return i.hasClass("mpContainer")||!!t(n).find(".mpContainer").length};n.Namespace.define("Wol.Video",{MetroPlayer:n.Class.derive(Wol.Video.PlayerBase,e,{play:r("play"),pause:r("pause"),currentTime:r("currentTime"),duration:r("duration"),buffered:r("buffered"),ended:r("ended"),paused:r("paused"),volume:r("volume"),muted:r("muted"),mediaUrl:r("mediaUrl"),fullScreen:s,closedCaption:h,enableTabbing:c},{isCompatible:y})})}(WinJS,jQuery),function(n){"use strict";var r=function(){},u=function(){},f=function(){};n.Namespace.define("Wol.Video.MetroPlayer",{ControlBase:n.Class.define(r,{show:u,hide:f},{})})}(WinJS,jQuery),function(n,t,i){"use strict";var r,u=function(){var n;return document.exitFullscreen?(n=function(n,t){return t===i?document.fullscreenElement===n:(t?n.requestFullscreen():document.exitFullscreen(),t)},n.eventName="fullscreenchange"):document.webkitCancelFullScreen?(n=function(n,t){return t===i?document.webkitFullscreenElement===n:(t?(n.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),document.webkitCurrentFullScreenElement!==n&&n.webkitRequestFullScreen()):document.webkitCancelFullScreen(),t)},n.eventName="webkitfullscreenchange"):document.msExitFullscreen?(n=function(n,t){return t===i?document.msFullscreenElement===n:(t?n.msRequestFullscreen():document.msExitFullscreen(),t)},n.eventName="MSFullscreenChange"):document.mozCancelFullScreen?(n=function(n,t){return t===i?document.mozFullScreenElement===n:(t?n.mozRequestFullScreen():document.mozCancelFullScreen(),t)},n.eventName="mozfullscreenchange"):(n=function(n,u){var f=t(n);return u===i?f.hasClass("mpFullBrowserMode"):(u?(r=t(window).scrollTop(),f.addClass("mpFullBrowserMode")):(f.removeClass("mpFullBrowserMode"),r&&t(window).scrollTop(r)),u)},n.eventName=null),n}(),f=function(n){return n.offset().left},e=function(n){return n.offset().top};n.Namespace.define("Wol.Video.MetroPlayer.Utils",{fullScreen:u,getTotalOffsetLeft:f,getTotalOffsetTop:e})}(WinJS,jQuery),function(n,t,i){"use strict";var u=function(n){this.playerObj=n,this.videoElement=n.$rootElement.find("video").get(0),this.videoElement.controls=!1,this.videoElement.addEventListener("play",r.bind(this,"play"),!1),this.videoElement.addEventListener("pause",r.bind(this,"pause"),!1),this.videoElement.addEventListener("timeupdate",r.bind(this,"timeupdate"),!1),this.videoElement.addEventListener("ended",r.bind(this,"ended"),!1),this.videoElement.addEventListener("progress",r.bind(this,"progress"),!1),this.videoElement.addEventListener("loadedmetadata",r.bind(this,"loadedmetadata"),!1),this.videoElement.addEventListener("volumechange",r.bind(this,"volumechange"),!1),this.videoElement.addEventListener("error",f.bind(this),!1),this.videoElement.addEventListener("ended",w.bind(this),!1),this.videoElement.addEventListener("mousedown",b.bind(this),!1),this.videoElement.addEventListener("dblclick",k.bind(this),!1),this.videoElement.addEventListener("contextmenu",d.bind(this),!1)},r=function(n,t){this.playerObj.dispatchEvent(n,t)},f=function(n){this.playerObj.hasError=!0,this.playerObj.dispatchEvent("error",n)},e=function(){return this.videoElement.play()},o=function(){this.videoElement.pause()},s=function(n){return n===i?this.videoElement.currentTime:this.videoElement.currentTime=n},h=function(){return this.videoElement.duration},c=function(){return this.videoElement.buffered},l=function(){return!!this.videoElement.ended},a=function(){return!!this.videoElement.paused},v=function(n){return n===i?this.videoElement.volume:this.videoElement.volume=n},y=function(n){return n===i?this.videoElement.muted:this.videoElement.muted=n},p=function(){return this.videoElement.src},w=function(){this.pause(),this.currentTime(0)},b=function(n){(n.button===0||n.button===1)&&(this.videoElement.paused?this.videoElement.play():this.videoElement.pause())},k=function(){this.playerObj.fullScreen()?this.playerObj.fullScreen(!1):this.playerObj.fullScreen(!0)},d=function(n){n.preventDefault()};n.Namespace.define("Wol.Video.MetroPlayer",{VideoElement:n.Class.define(u,{play:e,pause:o,currentTime:s,duration:h,buffered:c,ended:l,paused:a,volume:v,muted:y,mediaUrl:p},{})})}(WinJS,jQuery),function(n,t){"use strict";var u=function(n){this.playerObj=n,this.$rootElement=n.$rootElement.find("div.mpControlBar").first(),this.$controlBarNear=this.$rootElement.find("div.mpControlBarNear").first(),this.$controlBarFill=this.$rootElement.find("div.mpControlBarFill").first(),this.$controlBarFar=this.$rootElement.find("div.mpControlBarFar").first(),this.$controlBarError=this.$rootElement.find("div.mpControlBarError").first(),this.buttons={playPauseButton:new Wol.Video.MetroPlayer.PlayPauseButton(n,this),timeline:new Wol.Video.MetroPlayer.Timeline(n,this),timeBox:new Wol.Video.MetroPlayer.TimeBox(n,this),closedCaptionButton:new Wol.Video.MetroPlayer.ClosedCaptionButton(n,this),volumeButton:new Wol.Video.MetroPlayer.VolumeButton(n,this),fullScreenButton:new Wol.Video.MetroPlayer.FullScreenButton(n,this)},this._resize(),n.addEventListener("loadedmetadata",s.bind(this),!1),n.addEventListener("error",o.bind(this),!1),n.addEventListener("resize",e.bind(this),!1),this._isVisible=!0,this._isMouseDown=!1,t(window).bind("load",h.bind(this)),n.$rootElement.mousemove(c.bind(this)),n.$rootElement.mousedown(l.bind(this)),n.$rootElement.keydown(a.bind(this)),n.$rootElement.keyup(v.bind(this)),this.$rootElement.mousedown(y.bind(this)),t(document).mouseup(p.bind(this))},f=function(){var n=this.$rootElement.width();n>=613?(this.buttons.timeline.show(),this.buttons.timeBox.show()):n>=484?(this.buttons.timeline.show(),this.buttons.timeBox.hide()):(this.buttons.timeline.hide(),this.buttons.timeBox.hide());var t=this.$controlBarNear.outerWidth(!0),i=this.$controlBarFar.outerWidth(!0),r=n-t-i-16;this.$controlBarFill.width(r)},e=function(){this._resize()},o=function(){this.buttons.playPauseButton.enable(!1),this.$controlBarFill.hide(),this.$controlBarFar.hide(),this.$controlBarError.show(),this._showControlBar()},s=function(){this._resize()},h=function(){this._showControlBar()},c=function(n){(n.pageX!==this._lastMousePageX||n.pageY!==this._lastMousePageY)&&(this._lastMousePageX=n.pageX,this._lastMousePageY=n.pageY,setTimeout(r.bind(this),100))},l=function(n){this._isVisible||n.preventDefault(),this._showControlBar()},a=function(){this._showControlBar()},v=function(){this._showControlBar()},y=function(n){n.which===1&&(this._isMouseDown=!0)},p=function(){this._isMouseDown&&(this._isMouseDown=!1,this._showControlBar())},r=function(){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.$rootElement.stop(),this.$rootElement.fadeTo(0,1),this.$rootElement.get(0).style.zIndex="",this._isVisible=!0,this._isMouseDown||this.playerObj.hasError||(this.hideTimer=setTimeout(w.bind(this),2e3))},w=function(){this.$rootElement.fadeTo(1e3,0,b.bind(this))},b=function(){this.$rootElement.get(0).style.zIndex=0,this._isVisible=!1};n.Namespace.define("Wol.Video.MetroPlayer",{ControlBar:n.Class.define(u,{_resize:f,_showControlBar:r},{})})}(WinJS,jQuery),function(n){"use strict";var u=function(n,t){this.playerObj=n,this.controlBarObj=t,this.$playButtonElement=t.$rootElement.find("button.mpBtnPlay").first(),this.$pauseButtonElement=t.$rootElement.find("button.mpBtnPause").first(),n.addEventListener("play",r.bind(this,!1),!1),n.addEventListener("pause",r.bind(this,!0),!1),n.addEventListener("ended",f.bind(this),!1),this.$playButtonElement.click(e.bind(this)),this.$pauseButtonElement.click(o.bind(this))},r=function(n){this._setState(n)},f=function(){this._setState(!0)},e=function(){this.playerObj.ended()&&this.playerObj.currentTime(0),this.playerObj.play()},o=function(){this.playerObj.pause()},s=function(n){this.$playButtonElement[0].disabled=!n,this.$pauseButtonElement[0].disabled=!n,n||this._setState(!0)},h=function(n){var t,i;n?(t=this.$pauseButtonElement.is(":focus"),this.$playButtonElement.show(),this.$pauseButtonElement.hide(),t&&this.$playButtonElement.focus()):(i=this.$playButtonElement.is(":focus"),this.$playButtonElement.hide(),this.$pauseButtonElement.show(),i&&this.$pauseButtonElement.focus())};n.Namespace.define("Wol.Video.MetroPlayer",{PlayPauseButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,u,{enable:s,_setState:h},{})})}(WinJS,jQuery),function(n,t){"use strict";var r=function(n,i){this.playerObj=n,this.controlBarObj=i,this.$timelineButton=i.$rootElement.find("button.mpTimeline").first(),this.$loadedBar=i.$rootElement.find("div.mpTimelineLoaded").first(),this.$watchedBar=i.$rootElement.find("div.mpTimelineWatched").first(),this.$marker=i.$rootElement.find("div.mpTimelineMarker").first(),n.addEventListener("timeupdate",h.bind(this),!1),n.addEventListener("progress",c.bind(this),!1),this.$timelineButton.mousedown(u.bind(this));var r=t(document);r.mouseup(e.bind(this)),this.document_OnMouseMove=f.bind(this)},u=function(n){n.which===1&&(this._mouseLeftButtonDown=!0,this._attachMouseMoveEvent(),this._respondToMouse(n))},f=function(n){this._mouseLeftButtonDown&&this._respondToMouse(n)},e=function(){this._detachMouseMoveEvent(),this._mouseLeftButtonDown=!1},o=Wol.Video.MetroPlayer.Utils.getTotalOffsetLeft,s=function(n){var t=(n.pageX-o(this.$timelineButton)-6)/(this.$timelineButton.width()-13);t<0?t=0:t>1&&(t=1),this._setWatchedPosition(t),this._setCurrentTime(t)},h=function(){var t=this.playerObj.currentTime(),i=this.playerObj.duration(),r=t/i;this._setWatchedPosition(r)},c=function(){var t=this.playerObj.buffered(),i=0,r,u;t.length>0&&(r=this.playerObj.duration(),u=t.end(0),i=u/r),this._setLoadedPosition(i)},l=function(){this.$timelineButton.hide()},a=function(){this.$timelineButton.show()},v=function(n){var t=n*100;this.$watchedBar.width(t+"%"),this.$marker.css("left",t+"%")},y=function(n){var t=Math.ceil(n*100);this.$loadedBar.width(t+"%")},p=function(n){var i=this.playerObj.duration(),t=n*i;t<0&&(t=0),this.playerObj.currentTime(t)},w=function(){t(document).bind("mousemove",this.document_OnMouseMove)},b=function(){t(document).unbind("mousemove",this.document_OnMouseMove)};n.Namespace.define("Wol.Video.MetroPlayer",{Timeline:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,r,{hide:l,show:a,_setWatchedPosition:v,_setLoadedPosition:y,_respondToMouse:s,_setCurrentTime:p,_attachMouseMoveEvent:w,_detachMouseMoveEvent:b},{})})}(WinJS,jQuery),function(n){"use strict";var u=function(n,t){this.playerObj=n,this.controlBarObj=t,this.$timeBoxElement=t.$rootElement.find("div.mpTimeBox").first(),this.$timeElapsedElement=t.$rootElement.find("span.mpTimeElapsed").first(),this.$timeRemainingElement=t.$rootElement.find("span.mpTimeRemaining").first(),n.addEventListener("timeupdate",f.bind(this),!1),n.addEventListener("loadedmetadata",e.bind(this),!1)},f=function(){this._refreshTime()},e=function(){this._refreshTime()},o=function(){this.$timeBoxElement.hide()},s=function(){this.$timeBoxElement.show()},h=function(){var n=Math.round(this.playerObj.currentTime()||0),t,i;n!==this._prevTimeElapsed&&(this._prevTimeElapsed=n,t=Math.round(this.playerObj.duration()||0),i=t-n,this.$timeElapsedElement.text(r(n)),this.$timeRemainingElement.text(r(i)))},r=function(n){var t,i;n<0&&(n=0),t=n%60,n=(n-t)/60,i=n%60,n=(n-i)/60;var r=n,u=i<10?"0"+i:""+i,f=t<10?"0"+t:""+t;return r+":"+u+":"+f};n.Namespace.define("Wol.Video.MetroPlayer",{TimeBox:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,u,{show:s,hide:o,_refreshTime:h},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n,t){if(this.playerObj=n,this.controlBarObj=t,this.$closedCaptionButton=t.$rootElement.find("button.mpBtnCaption").first(),!this.$closedCaptionButton.length)return null;this.$closedCaptionButton.click(u.bind(this))},u=function(){this.playerObj.closedCaption()?this.playerObj.closedCaption(!1):this.playerObj.closedCaption(!0)};n.Namespace.define("Wol.Video.MetroPlayer",{ClosedCaptionButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,r,{},{})})}(WinJS,jQuery),function(n,t){"use strict";var r=function(n,i){if(this.playerObj=n,this.controlBarObj=i,this.$volumeButton=i.$rootElement.find("button.mpBtnVolume").first(),this.$muteButton=i.$rootElement.find("button.mpBtnMute").first(),this.$volumeSliderContainer=i.$rootElement.find("div.mpVolSliderContainer").first(),this.$volumeSliderButton=i.$rootElement.find("button.mpVolSlider").first(),this.$volumeSliderBar=this.$volumeSliderButton.find("div.mpVolFilledBar").first(),this.$volumeSliderMarker=this.$volumeSliderButton.find("div.mpVolMarker").first(),!this._isVolumeControlSupported())return this.$volumeButton.hide(),null;this._isMouseDown=!1,this._isSliderVisible=!1,this._suppressVolumeChangeEvent=!0,this._defaultVolumeTitle=this.$volumeButton.data("default-title"),this._popUpVolumeTitle=this.$volumeButton.data("pop-up-title"),this.$volumeButton.click(u.bind(this)),this.$muteButton.click(f.bind(this)),this.$volumeSliderButton.mousedown(e.bind(this)),t(document).mouseup(s.bind(this)),this._document_OnMouseMove=o.bind(this),this.playerObj.addEventListener("volumechange",c.bind(this),!1),t(window).bind("load",h.bind(this))},u=function(){this._isSliderVisible&&this.playerObj.muted(!0),this._showSlider()},f=function(){this.playerObj.muted(!1),this._showSlider()},e=function(n){n.which===1&&(this._isMouseDown=!0,this._attachMouseMoveEvent(),this.playerObj.muted(!1),this._respondToMouse(n))},o=function(n){this._isMouseDown&&this._respondToMouse(n)},s=function(){this._detachMouseMoveEvent(),this._isMouseDown&&(this._isMouseDown=!1,this._showSlider())},h=function(){setTimeout(a.bind(this),500)},c=function(){this._setMutedButtonState(this.playerObj.muted()),this._suppressVolumeChangeEvent||this._showSlider()},l=function(){var n=this.playerObj.volume();return n===1&&(this.playerObj.volume(.999),this.playerObj.volume()===1)?!1:!0},a=function(){this._suppressVolumeChangeEvent=!1},v=Wol.Video.MetroPlayer.Utils.getTotalOffsetTop,y=function(n){var i=v(this.$volumeSliderButton),t=(i+this.$volumeSliderButton.height()-n.pageY-6)/(this.$volumeSliderButton.height()-13);t<0?t=0:t>1&&(t=1),this._setVolumeButtonState(t),this.playerObj.volume(t)},p=function(n){var t;t=n<0?0:n>1?100:Math.round(n*1e3)/10,t=t+"%",this.$volumeSliderBar.height(t),this.$volumeSliderMarker.css("bottom",t)},w=function(n){var t,i,r;n?(t=this.$volumeButton,i=this.$muteButton,this._setVolumeButtonState(0)):(t=this.$muteButton,i=this.$volumeButton,this._setVolumeButtonState(this.playerObj.volume())),r=t.is(":focus"),t.hide(),i.show(),r&&i.focus()},b=function(){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.$volumeSliderContainer.stop(),this.$volumeSliderContainer.show(),this.$volumeSliderContainer.fadeTo(0,1),this._isSliderVisible=!0,this.$volumeButton.attr("title",this._popUpVolumeTitle),this._isMouseDown||(this.hideTimer=setTimeout(k.bind(this),2e3))},k=function(){this.$volumeSliderContainer.fadeTo(1e3,0,d.bind(this))},d=function(){this.$volumeSliderContainer.css("opacity")==="0"&&(this.$volumeSliderContainer.hide(),this._isSliderVisible=!1,this.$volumeButton.attr("title",this._defaultVolumeTitle))},g=function(){t(document).bind("mousemove",this._document_OnMouseMove)},nt=function(){t(document).unbind("mousemove",this._document_OnMouseMove)};n.Namespace.define("Wol.Video.MetroPlayer",{VolumeButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,r,{_isVolumeControlSupported:l,_setVolumeButtonState:p,_setMutedButtonState:w,_respondToMouse:y,_showSlider:b,_attachMouseMoveEvent:g,_detachMouseMoveEvent:nt},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n,t){this.playerObj=n,this.controlBarObj=t,this.$fullScreenButtonElement=t.$rootElement.find("button.mpBtnFullScreen").first(),this.$restoreButtonElement=t.$rootElement.find("button.mpBtnRestore").first(),n.addEventListener("fullscreenchange",e.bind(this),!1),this.$fullScreenButtonElement.click(u.bind(this)),this.$restoreButtonElement.click(f.bind(this))},u=function(){this.playerObj.fullScreen(!0)},f=function(){this.playerObj.fullScreen(!1)},e=function(){this._setState(this.playerObj.fullScreen())},o=function(n){var t,i;n?(t=this.$fullScreenButtonElement.is(":focus"),this.$fullScreenButtonElement.hide(),this.$restoreButtonElement.show(),t&&this.$restoreButtonElement.focus()):(i=this.$restoreButtonElement.is(":focus"),this.$fullScreenButtonElement.show(),this.$restoreButtonElement.hide(),i&&this.$fullScreenButtonElement.focus())};n.Namespace.define("Wol.Video.MetroPlayer",{FullScreenButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,r,{_setState:o},{})})}(WinJS,jQuery),function(n){"use strict";var r={escape:27,space:32,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40},u=function(n){this.playerObj=n,this.playerObj.$rootElement.get(0).addEventListener("keydown",e.bind(this),!0),this.playerObj.$rootElement.click(f.bind(this))},f=function(n){n.target!==document.activeElement&&n.currentTarget.focus()},e=function(n){if(!this.playerObj.hasError){var t=n.which;switch(t){case r.space:this.playerObj.paused()?this.playerObj.play():this.playerObj.pause(),n.preventDefault();break;case r.leftArrow:this._setCurrentTime(-10),n.preventDefault();break;case r.rightArrow:this._setCurrentTime(10),n.preventDefault();break;case r.upArrow:this._setVolume(.05),n.preventDefault();break;case r.downArrow:this._setVolume(-.05),n.preventDefault();break;case r.escape:this._exitFullScreen(),n.preventDefault()}}},o=function(n){var t=this.playerObj.currentTime(),i=this.playerObj.duration();t+=n,t<0?t=0:t>i&&(t=i),this.playerObj.currentTime(t)},s=function(n){var t=this.playerObj.volume();t===1&&n>0?t=.999999:t===0&&n<0?t=1e-6:(t+=n,t<0?t=0:t>1&&(t=1)),this.playerObj.muted(!1),this.playerObj.volume(t)},h=function(){this.playerObj.fullScreen(!1)};n.Namespace.define("Wol.Video.MetroPlayer",{KeyboardAccessibility:n.Class.define(u,{_setCurrentTime:o,_setVolume:s,_exitFullScreen:h},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n){if(this.playerObj=n,this.$posterElement=n.$rootElement.find("div.mpPoster").first(),!this.$posterElement.length)return null;this.$posterImgElement=this.$posterElement.find("img").first(),this.$posterElement.click(e.bind(this)),this._resizePosterImage(),this.playerObj.addEventListener("play",o.bind(this),!1),this.playerObj.addEventListener("ended",s.bind(this),!1),this.playerObj.addEventListener("resize",u.bind(this),!1),this.$posterImgElement.bind("load",f.bind(this))},u=function(){this._resizePosterImage()},f=function(){this._imageHeight=this.$posterImgElement.height(),this._imageWidth=this.$posterImgElement.width(),this._resizePosterImage()},e=function(){this.playerObj.hasError||this.playerObj.play()},o=function(){this.$posterElement.hide()},s=function(){this.$posterElement.show(),this._resizePosterImage()},h=function(){var i=this.playerObj.$rootElement.width(),r=this.playerObj.$rootElement.height(),n=this._imageHeight,t=this._imageWidth,u,f;this._imageWidth&&this._imageHeight&&(u=n/r,f=t/i,u>f?(n=r,t=t/u,this.$posterImgElement.css("width","auto"),this.$posterImgElement.css("height","100%")):(t=i,n=n/f,this.$posterImgElement.css("width","100%"),this.$posterImgElement.css("height","auto")),this.$posterImgElement.css("top","50%").css("left","50%"),this.$posterImgElement.css("margin-left",-t/2).css("margin-top",-n/2))};n.Namespace.define("Wol.Video.MetroPlayer",{Poster:n.Class.define(r,{_resizePosterImage:h},{})})}(WinJS,jQuery),function(n,t){"use strict";var u=/^((?:(\d{1,}):)?(\d{2}):(\d{2}).(\d{3}))\s+-->\s+((?:(\d{1,}):)?(\d{2}):(\d{2}).(\d{3})).*$/,f=/\r\n|\n|\r/,e=/^$/,o=function(n){var l=[],o=n.split(f),i=0,c=o.length,t;if(o[0].indexOf("WEBVTT")!==0)return null;for(i++;i<c;){do t=u.exec(o[i]),i++;while(!t&&i<c);if(t){for(var a=r(t[2],t[3],t[4],t[5]),v=r(t[7],t[8],t[9],t[10]),h="";i<c&&!e.test(o[i]);)h!==""&&(h+="<br />"),h+=s(o[i]),i++;l.push(new Wol.Video.WebVttParser.TrackCue(a,v,h))}}return l},r=function(n,t,i,r){var u=0;return n&&(u+=parseInt(n,10)*3600),t&&(u+=parseInt(t,10)*60),i&&(u+=parseInt(i,10)),r&&(u+=parseInt(r,10)/1e3),u},s=function(n){return n.replace(/<.*?>/g,"")},h=function(n,i,r){this.startTime=n,this.endTime=i,this.content=r,this.htmlContent=t("<span>"+r+"<\/span>").get(0)},c=function(){return this.htmlContent},l=function(){return this.content};n.Namespace.define("Wol.Video.WebVttParser",{parse:o,TrackCue:n.Class.define(h,{getCueAsHTML:c,getCueAsSource:l},{})})}(WinJS,jQuery),function(n,t,i){"use strict";var r=function(n){if(this.playerObj=n,this.$trackElement=n.$rootElement.find("track").first(),!this.$trackElement.length)return null;this._trackUrl=this.$trackElement.attr("src"),this.enabled=!1,this.hasError=!1,this.activeCuesArray=[],this.loadedCuesArray=null,this._currentCueIndex=-1,this._lastGoodCueIndex=-1,this._player_OnTimeUpdate=u.bind(this)},u=function(){this._refreshCues()},f=function(n){return n!==i&&(n=!!n,this.enabled!==n&&(this.enabled=n,n?(this._currentCueIndex=-1,this._lastGoodCueIndex=-1,this._attachEventListeners(),this.loadedCuesArray||this._loadCues(),this._refreshCues()):this._detachEventListeners(),a.call(this))),this.enabled},e=function(){return this.activeCuesArray},o=function(){var t=this.playerObj.currentTime(),i=this._lastGoodCueIndex,n=this._findCueIndex(t,i);n!==this._currentCueIndex&&(this.activeCuesArray.length=0,n!==-1&&(this.activeCuesArray.push(this.loadedCuesArray[n]),this._lastGoodCueIndex=n),this._currentCueIndex=n,v.call(this))},s=function(n,t){var i,u,r;if(!this.loadedCuesArray)return-1;if(t=t||0,t=Math.max(t,0),i=this.loadedCuesArray[t],u=this.loadedCuesArray.length,n>=i.startTime)for(r=t+1;r<u&&n>=this.loadedCuesArray[r].startTime;)t=r,r++;else while(t>=1&&this.loadedCuesArray[t].startTime>n)t--;return i=this.loadedCuesArray[t],i.startTime<=n&&i.endTime>=n?t:-1},h=function(){this.playerObj.addEventListener("timeupdate",this._player_OnTimeUpdate,!1)},c=function(){this.playerObj.removeEventListener("timeupdate",this._player_OnTimeUpdate,!1)},l=function(){t.ajax({url:this._trackUrl,context:this,dataType:"text"}).done(function(n){this.loadedCuesArray=Wol.Video.WebVttParser.parse(n),this.hasError=!this.loadedCuesArray,!this.hasError&&this.enabled&&this._refreshCues()}).fail(function(){this.hasError=!0})},a=function(){this.playerObj.dispatchEvent("closedcaptionchange",this)},v=function(){this.playerObj.dispatchEvent("cuechange",this)};n.Namespace.define("Wol.Video.MetroPlayer",{TextTrack:n.Class.define(r,{enable:f,activeCues:e,_loadCues:l,_refreshCues:o,_findCueIndex:s,_attachEventListeners:h,_detachEventListeners:c},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n){this.playerObj=n,this.$captionElement=n.$rootElement.find("div.mpCaption"),this.$captionInnerElement=this.$captionElement.find("div.mpCaptionInner"),this.playerObj.addEventListener("play",u.bind(this),!1),this.playerObj.addEventListener("ended",f.bind(this),!1),this.playerObj.addEventListener("cuechange",e.bind(this),!1),this.playerObj.addEventListener("closedcaptionchange",o.bind(this),!1),this.playerObj.addEventListener("resize",s.bind(this),!1)},u=function(){this._enableOverlay(this.playerObj.closedCaption())},f=function(){this._enableOverlay(!1)},e=function(n){var t=n.detail.activeCues();this.$captionInnerElement.children().remove(),t.length!==0?(this.$captionInnerElement.append(t[0].getCueAsHTML()),this.$captionElement.show()):this.$captionElement.hide()},o=function(n){this._enableOverlay(n.detail.enabled)},s=function(){this._resize()},h=function(n){n?this._resize():this.$captionElement.hide()},c=function(){var t=this.playerObj.$rootElement.width(),n=Math.max(t/50,16);this.fontSize=n,this.$captionElement.css("font-size",n+"px")};n.Namespace.define("Wol.Video.MetroPlayer",{ClosedCaptionOverlay:n.Class.define(r,{_enableOverlay:h,_resize:c},{})})}(WinJS,jQuery),function(n,t,i){"use strict";window.onPlayerReady=function(n){var t=n.Name,i=r[t];i&&(i._initialize(n),u[t]=i,delete r[t])},window.onPlayerCaptionsActivated=function(n){var t=u[n];t&&t._raiseClosedCaptionChangeEvent()};var r={},u={},f=function(n){var i=t(n),u,f;if(this.$rootElement=i.find("object.VideoPlayer").first(),!this.$rootElement.length)throw"SilverlightPlayer: Unable to initialize video";this._isPaused=!0,this._isClosedCaptionEnabled=!1,this._isFullScreen=!1,this._isEnded=!1,this.videoTechnology="Silverlight",u=this.$rootElement.children("param[name=InitParams]").attr("value"),this.initParams=ut(u),this.isInitialized=!1,f=this.$rootElement.data("script-id"),r[f]=this},e=function(n){this.isInitialized||(this.playerObj=n,this.playerObj.addEventListener("MediaOpened",o.bind(this)),this.playerObj.addEventListener("MediaEnded",s.bind(this)),this.playerObj.addEventListener("PlayStateChanged",h.bind(this)),this.playerObj.addEventListener("FullScreenChanged",c.bind(this)),this.isInitialized=!0)},o=function(){this.dispatchEvent("loadedmetadata")},s=function(){this._isEnded=!0,this.dispatchEvent("ended")},h=function(n,t){t&&(this._isPaused=t.Result!=="Playing",this._isPaused?this.dispatchEvent("pause"):(this._isEnded=!1,this.dispatchEvent("play")))},c=function(){this._isFullScreen=!this._isFullScreen,this.dispatchEvent("fullscreenchange",this._isFullScreen)},l=function(){this.isInitialized&&this.playerObj.Play()},a=function(){this.isInitialized&&this.playerObj.Pause()},v=function(n){return this.isInitialized?(n!==i&&this.playerObj.SeekToPosition(n),this.playerObj.PlaybackPositionSeconds):null},y=function(){return this.isInitialized?this.playerObj.EndPositionSeconds:null},p=function(){},w=function(){return this._isEnded},b=function(){return this._isPaused},k=function(n){return this.isInitialized?(n!==i&&this.playerObj.SetVolume(n),this.playerObj.GetVolume()):null},d=function(n){return this.isInitialized?(n!==i&&(n?(this._prevVolume=this.playerObj.GetVolume(),this.playerObj.SetVolume(0)):this._prevVolume&&this.playerObj.SetVolume(this._preVolume)),this.playerObj.GetVolume()===0):null},g=function(){return this.initParams.mediaurl},nt=function(){return this._isFullScreen},tt=function(){return this._isClosedCaptionEnabled},it=function(){throw"Not supported";},rt=function(){this._isClosedCaptionEnabled=!0,this.dispatchEvent("closedcaptionchange",{enabled:!0})},ut=function(n){for(var r={},u=n.split(","),i,t=0,f=u.length;t<f;t++)i=/([^=]*)=(.*)/.exec(u[t]),i&&(r[i[1]]=i[2]);return r},ft=function(n){var i=t(n);return!!t(n).find("object.VideoPlayer").length};n.Namespace.define("Wol.Video",{SilverlightPlayer:n.Class.derive(Wol.Video.PlayerBase,f,{play:l,pause:a,currentTime:v,duration:y,buffered:it,ended:w,paused:b,volume:k,muted:d,mediaUrl:g,fullScreen:nt,closedCaption:tt,enableTabbing:p,_initialize:e,_raiseClosedCaptionChangeEvent:rt},{isCompatible:ft})})}(WinJS,jQuery),function(n,t){"use strict";var u=function(n,i){if(this.$heroContainer=t(n),this.$heroContainer.hasClass("HeroContainer")||(this.$heroContainer=this.$heroContainer.find("div.HeroContainer").first()),!this.$heroContainer.length)throw"Wol.Video.Hero: Unable to instantiate due to missing hero container element";if(!i)throw"Wol.Video.Hero: Unable to instantiate due to an invalid player object";this.playerObj=i,this.hasEndCard=!1,t(f.bind(this))},f=function(){var n,f;this.$heroVideoContainer=this.$heroContainer.find("div.HeroVideoContainer").first(),this.$endCardContainer=this.$heroContainer.find("div.EndCardContainer").first(),this.$heroVideoContainerParent=this.$heroContainer.find("div.HeroVideoContainerParent").first(),n=[],this.$heroVideoContainer.length&&(n.push(this.$heroVideoContainer.outerHeight(!0)),this.$heroContainer.closest(".regionOuter").css("overflow","hidden")),this.$endCardContainer.length?(n.push(this.$endCardContainer.outerHeight(!0)),this.hasEndCard=!0,this.$heroContainer.is(".ShowTitleCard")&&this.playerObj.enableTabbing(!1)):this.hasEndCard=!1,n.length&&(f=Math.max.apply(Math,n),this.$heroContainer.height(f));var i=this.$heroVideoContainer.height(),r=this.$heroVideoContainer.width(),u=this.$heroContainer.height()-(this.$heroVideoContainer.outerHeight(!0)-this.$heroVideoContainer.outerHeight(!1));i<u&&this.$heroVideoContainer.css("top",(u-i)/2),t("body").css("direction")==="ltr"?(this.$heroVideoContainer.css("left","50%"),this.$heroVideoContainer.css("margin-left",-r/2)):(this.$heroVideoContainer.css("right","50%"),this.$heroVideoContainer.css("margin-right",-r/2)),this.playerObj.addEventListener("ended",e.bind(this),!1),this.hasEndCard&&this.$endCardContainer.find(".VSContainerSelected").click(o.bind(this))},e=function(){this.showEndCard()},o=function(n){this.replayVideo(),n.preventDefault()},s=function(){if(!this.hasEndCard)return!1;var n=this.playerObj,i=this.$heroVideoContainer;return this.$heroVideoContainerParent.fadeTo(1e3,0,function(){n.pause(),t(this).addClass("HideHeroVideoContainer"),n.enableTabbing(!1)}),this.$endCardContainer.fadeTo(1e3,1,function(){t(this).css("visibility","inherit"),t(this).css("z-index","4"),t(this).css("filter","")}),!0},h=function(){if(this.hasEndCard){var n=this.playerObj;this.$endCardContainer.fadeTo(1e3,0,function(){t(this).css("z-index","-1"),t(this).css("visibility","hidden"),n.enableTabbing(!0)}),this.$heroVideoContainerParent.removeClass("HideHeroVideoContainer").fadeTo(1e3,1,c.bind(this))}else this.playerObj.play()},c=function(){this.playerObj.play()},r="wolVideoHero",l=function(n){var i=t(n).closest("div.HeroContainer"),f,u;return i.length?(f=Wol.Video.PlayerBase.getVideoPlayer(i.get(0)),!f)?null:(u=new Wol.Video.Hero(i,f),u&&i.data(r,u),u):null},a=function(n){var i=t(n).closest("div.HeroContainer"),u;return i.length?(u=i.data(r),u instanceof Wol.Video.Hero)?u:null:null};n.Namespace.define("Wol.Video",{Hero:n.Class.define(u,{showEndCard:s,replayVideo:h},{initialize:l,getParentHero:a})})}(WinJS,jQuery),function(n){"use strict";var r=function(n){this.playerObj=n,this.started=!1,this.fullscreen=!1,this.closedCaptions=!1,this.watchTime=0,this.duration=0,this.mediaUrl=n.mediaUrl()||"",this.videoTech=n.videoTechnology,this.hasLogged=!1,n.addEventListener("loadedmetadata",u.bind(this),!1),n.addEventListener("play",f.bind(this),!1),n.addEventListener("ended",e.bind(this),!1),n.addEventListener("closedcaptionchange",o.bind(this),!1),n.addEventListener("fullscreenchange",s.bind(this),!1),l(h.bind(this))},u=function(){this.duration=this.playerObj.duration()||0},f=function(){this.started=!0},e=function(){this.watchTime=this.duration,this._notify()},o=function(){this.closedCaptions=!0},s=function(){this.playerObj.fullScreen()&&(this.fullscreen=!0)},h=function(){this.watchTime=this.playerObj.currentTime()||0,this._notify()},c=function(n,t){var i=t>0?Math.round(10*(n/t))*10:0;return!i||i<0?i=0:i>100&&(i=100),i},l=function(n){Wol.Util.OnBeforeUnload.attach(n)},a=function(){if(!this.hasLogged){var n={"Video.Tech":this.videoTech,"Video.Url":this.mediaUrl,"Video.Start":this.started?1:0,"Video.FullScreen":this.fullscreen?1:0,"Video.ClosedCaption":this.closedCaptions?1:0,"Video.Length":this.duration,"Video.WatchTime":this.watchTime,"Video.CompletionRate":c(this.watchTime,this.duration)};Wol.ContentInstrumentation.Logging.LogCustomBI("Video",n,this.playerObj.$rootElement[0]),this.hasLogged=!0}};n.Namespace.define("Wol.Video",{BI:n.Class.define(r,{_notify:a},{})})}(WinJS,jQuery);
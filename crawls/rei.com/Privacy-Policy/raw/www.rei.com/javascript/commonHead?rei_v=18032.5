
 

function openWindow(surl,windowName,params) { 
// We have to double-encode some URL strings to account for an IE bug where
// IE un-encodes the URL before passing it to this function. This line
// causes the function to un-encode the URL if the URL was double-encoded
// but was (correctly) passed without decoding by a sane browser.
  if (surl.indexOf('%2520') != -1) {
    surl = unescape(surl);
  }    
  windowHandle = window.open(surl,windowName,params);
    
  if(window.focus) {
    windowHandle.focus();
  }
}

// add a name and value dynamically to the hard-coded URL before calling openWindow().

function modURLOpenWindow(the_name, the_value,surl,windowName,params) {
  if ( (the_value!=null) && (the_name!=null)) {
    if (surl.indexOf('#')>=0) {
      xa = surl.split("#");
      if (xa[0].indexOf('?')>=0) {
        surl = xa[0] + '&' + the_name + '=' + the_value + '#' + xa[1];
      } else {
        surl = xa[0] + '?' + the_name + '=' + the_value + '#' + xa[1];
      }
    } else {
      if (surl.indexOf('?')>=0) {
        surl = surl + '&' + the_name + '=' + the_value ;
      } else {
        surl = surl + '?' + the_name + '=' + the_value ;
      }
    }
  }
  openWindow(surl,windowName,params);
}

function urlencode(str) {
    return escape(str).replace(/\+/g,'%2B').replace(/%20/g, '+').replace(/\*/g, '%2A').replace(/\//g, '%2F').replace(/@/g, '%40');
}

function getCookieVal(offset) {
  var endstr = document.cookie.indexOf(";", offset);
  if (endstr == -1)
    endstr = document.cookie.length;
  return unescape(document.cookie.substring(offset, endstr));
}

function getCookie(name) {
  var arg = name + "=";
  var alen = arg.length;
  var clen = document.cookie.length;
  var i = 0;
  while (i < clen) {
    var j = i + alen;
    if (document.cookie.substring(i, j) == arg)
      return getCookieVal(j);
    i = document.cookie.indexOf(" ", i) + 1;
    if (i == 0) break;
  }
  return null;
}

function getAffiliateID() {
  var PAT = getCookie("PAT");
  var ID = 0;
  if(PAT != null) {
    var i = PAT.indexOf("=", 0) + 1;
    var j = PAT.indexOf(":", i);
    ID = PAT.substring(i, j);
  }
  return ID;
}

function stripSpaces(string) {
  while('' + string.charAt(string.length-1) == ' ')
    string = string.substring(0, string.length-1);
  while('' + string.charAt(0) == ' ')
    string = string.substring(1, string.length);
  return string;
}

function clearCookie(name) {
  document.cookie = name + "=" + "" + ";PATH=/";
}

function emailCheck (emailStr) {

/* The following pattern is used to check if the entered e-mail address
   fits the user@domain format.  It also is used to separate the username
   from the domain. */

var emailPat=/^(.+)@(.+)$/

/* The following string represents the pattern for matching all special
   characters.  We don't want to allow special characters in the address.
   These characters include ( ) < > @ , ; : \ " . [ ]    */

var specialChars="\\(\\)<>@,;:\\\\\\\"\\.\\[\\]"

/* The following string represents the range of characters allowed in a
   username or domainname.  It really states which chars aren't allowed. */

var validChars="\[^\\s" + specialChars + "\]"

/* The following pattern applies if the "user" is a quoted string (in
   which case, there are no rules about which characters are allowed
   and which aren't; anything goes).  E.g. "jiminy cricket"@disney.com
   is a legal e-mail address. */

var quotedUser="(\"[^\"]*\")"

/* The following pattern applies for domains that are IP addresses,
   rather than symbolic names.  E.g. joe@[123.124.233.4] is a legal
   e-mail address. NOTE: The square brackets are required. */

var ipDomainPat=/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/

/* The following string represents an atom (basically a series of
   non-special characters.) */

var atom=validChars + '+'

/* The following string represents one word in the typical username.
   For example, in john.doe@somewhere.com, john and doe are words.
   Basically, a word is either an atom or quoted string. */
   
var word="(" + atom + "|" + quotedUser + ")"

// The following pattern describes the structure of the user

var userPat=new RegExp("^" + word + "(\\." + word + ")*$")

/* The following pattern describes the structure of a normal symbolic
   domain, as opposed to ipDomainPat, shown above. */
   
var domainPat=new RegExp("^" + atom + "(\\." + atom +")*$")

/* Strip leading spaces */

while(''+emailStr.charAt(0)==' ')
  emailStr=emailStr.substring(1,emailStr.length);

/* Strip trailing spaces */

while(''+emailStr.charAt(emailStr.length-1)==' ')
  emailStr=emailStr.substring(0,emailStr.length-1);

/* Finally, let's start trying to figure out if the supplied address is
   valid. */

   if(emailStr.length == 0) {
     var errStr="You must enter a valid email address"
     alert(errStr)
     return false
   }

/* Begin with the coarse pattern to simply break up user@domain into
   different pieces that are easy to analyze. */

var matchArray=emailStr.match(emailPat)
if (matchArray==null) {

  /* Too many/few @'s or something; basically, this address doesn't
     even fit the general mould of a valid e-mail address. */

  alert("The e-mail address must include a @ and a . to be valid. Please try again.")
  return false
}

var user=matchArray[1]
var domain=matchArray[2]

// See if "user" is valid

if (user.match(userPat)==null) {

    // user is not valid

    alert("The e-mail address must include a username without spaces or punctuation.")
    return false
}

/* if the e-mail address is at an IP address (as opposed to a symbolic
   host name) make sure the IP address is valid. */

var IPArray=domain.match(ipDomainPat)

if (IPArray!=null) {

    // this is an IP address

    for (var i=1;i<=4;i++) {
      if (IPArray[i]>255) {
          alert("Destination IP in email address is invalid!")
          return false
      }
    }
    return true
}

// Domain is symbolic name

var domainArray=domain.match(domainPat)
if (domainArray==null) {
  alert("The e-mail address must include an extension: (.com, .org, .ca, etc.)")
  return false
}

/* domain name seems valid, but now make sure that it ends in a
   three-letter word (like com, edu, gov) or a two-letter word,
   representing country (uk, nl), and that there's a hostname preceding
   the domain or country. */

/* Now we need to break up the domain to get a count of how many atoms
   it consists of. */
   
var atomPat=new RegExp(atom,"g")
var domArr=domain.match(atomPat)
var len=domArr.length
if (domArr[domArr.length-1].length<2 ||
    domArr[domArr.length-1].length>6) {
    
   // the address must end in a two letter or three letter word.

   alert("The e-mail address must include an extension: (.com, .org, .ca, etc.)")
   return false
}

// Make sure there's a host name preceding the domain.

if (len<2) {
   var errStr="The e-mail address must include an extension: (.com, .org, .ca, etc.)"
   alert(errStr)
   return false
}

// If we've gotten this far, everything's valid!

return true;
}

function printpage() {
  if (window.print != null) {
    window.print();
  } else {
    alert("Unfortunately, your browser does not support this shortcut.  Please select File and then Print from your browser's menu.");
  }
}

function setCookie(name, value) {
  document.cookie=name+"="+escape(value)+";PATH=/";
}

function DelCookie (name,path,domain) {
  if (getCookie(name)) {
    document.cookie = name + "=" +
      ((path == null) ? "" : "; path=" + path) +
      ((domain == null) ? "" : "; domain=" + domain) +
      "; expires=Thu, 01-Jan-70 00:00:01 GMT";
  }
}

function Set_Cookie( name, value, expires)
{
    // set time, it's in milliseconds
    var today = new Date();
    today.setTime( today.getTime() );
    
    /*
    if the expires variable is set, make the correct expires time, the current script below will set it for x number of days, to make it for hours,
    delete * 24, for minutes, delete * 60 * 24
    */
    if ( expires ){
        expires =  parseInt(expires, 10) * 1000 * 60 * 60 * 24;
    }
    var expires_date = new Date( today.getTime() + (expires) );
    
    document.cookie = name + "=" + escape( value ) + ";path=/" +( ( expires ) ? ";expires=" + expires_date.toGMTString() : "" );
}

// common_header processing (safe every page?)

var affiliateID = getAffiliateID();

if ((affiliateID == "9048" || affiliateID == "11917" || affiliateID == "14028" || affiliateID == "14172") && window.location.protocol == "https:") {
  if (top.location != self.location) {
    top.location = self.location;
  }
}

var numOfItems = getCookie("rei_cart");
var multipleItems = (numOfItems == 1) ? 's':'';
var loggedIn = getCookie("loggedin");

if (!numOfItems) numOfItems = 0;


var cartStatusText = '';

if (document.title != "REI.com: Shopping Basket") {
    if (numOfItems == 1) {
        cartStatusText = '(contains ' + numOfItems + ' item)';
    } else {
        cartStatusText = '(contains ' + numOfItems + ' items)';
    }
}

// PLOONEY ADDITION
// Read the two GR cookies if they exist.

function ReadGRCookie (CookieName) {
    var gr_id = 0;
    var gr_event_type = "";
    var gr_event_date = "";
    var gr_personal_name = "";
    var which_cookie = "";

    var cook_obj = new Object();

    which_cookie = CookieName;
    
    var CookieString = document.cookie;
    var CookieSet = CookieString.split (';');
    var SetSize = CookieSet.length;
    var CookiePieces
    var ReturnValue = "";
    var x = 0;

    for (x = 0; ((x < SetSize) && (ReturnValue == "")); x++) {

        CookiePieces = CookieSet[x].split ('=');

        if (CookiePieces[0].substring (0,1) == ' ') {
            CookiePieces[0] = CookiePieces[0].substring (1, CookiePieces[0].length);
        }

        if (CookiePieces[0] == CookieName) {
            ReturnValue = CookiePieces[1];
        }
    }

    if (ReturnValue != "") {
        CleanRetVal = unescape(ReturnValue);
        RetArray = CleanRetVal.split(":");
        gr_id = RetArray[0];
        gr_event_type = RetArray[1];
        gr_event_date = RetArray[2];
        gr_personal_name = RetArray[3];

        //if (gr_id) alert(gr_id);
        //if (gr_personal_name) alert(gr_personal_name);

        var alertStr = "ID: " + gr_id + "\n" +
        "Name: " + gr_personal_name + "\n" +
        "Type: " + gr_event_type + "\n" +
        "Date: " + gr_event_date;
        
        cook_obj.cook_name = which_cookie;
        cook_obj.id = gr_id;
        cook_obj.event_type = gr_event_type ;
        cook_obj.event_date = gr_event_date ;
        cook_obj.personal_name = gr_personal_name ;

        return cook_obj;
    } 
}

var setup_cook_obj = ReadGRCookie("GiftRegistrySetup");

// END PLOONEY ADDITION

//
// QueryString
//
// this is duplicated from querystring.js

function QueryString(key) {
	var value = null;
	for (var i=0;i<QueryString.keys.length;i++)
	{
		if (QueryString.keys[i]==key)
		{
			value = QueryString.values[i];
			break;
		}
	}
	return value;
}
QueryString.keys = new Array();
QueryString.values = new Array();

function QueryString_Parse() {
	var query = window.location.search.substring(1);
	var pairs = query.split("&");
	
	for (var i=0;i<pairs.length;i++)
	{
		var pos = pairs[i].indexOf('=');
		if (pos >= 0)
		{
			var argname = pairs[i].substring(0,pos);
			var value = pairs[i].substring(pos+1);
			QueryString.keys[QueryString.keys.length] = argname;
			QueryString.values[QueryString.values.length] = value;		
		}
	}

}

QueryString_Parse();
  
// Product page check for MID pages
//remove when all MID/collection pages converted to new format
function checkSKUSelect() {
	var error;
	$('.quantity').each(function(i){
		var j = i+1;
		var quantity = document.getElementsByName('quantity_'+j)[0].value;
		var selection = document.getElementById('sku_'+j).value;
		if(quantity=='' || quantity==0 || selection=='LABEL'){
			$('#selectFlag_'+j).show();
			$('.selectFlagFooter').show();
			error = true;
		}
		else if(quantity!=0 && selection!='LABEL'){
			$('#selectFlag_'+j).hide();
		}
		else{
			$('#selectFlag_'+j).hide();
			$('.selectFlagFooter').hide();
			error = false;
		}
	});
	if(error==true){
		return false;
	}
	else{
		return true;
	}
	
}

//new product validation for collection pages
function collectionsSelectVerifyAndSend(theFormSent) {
	var f = $(theFormSent);
	var returnValue = false;
	
	returnValue=$(theFormSent).validate({
		  rules: {
			  quantity: {
			      required: true,
			      min: 1
			    }
			  }
		}).form();
	
	if (returnValue) { //if evertything is okay, load minicart
		minicart.addToCart("/rest/cart/item?" + $(theFormSent).serialize());
	}
	return false;
}

//Product page validation for Collections pages
/*function checkSKUCollectionsSelect(){
	var error = new Array(), selectedItem = new Array();
	var returnValue = false;
	
	$('.quantity').each(function(i){//loop through each item on page
		var j = i+1;
		var quantity = parseInt(document.getElementsByName('quantity_'+j)[0].value);
		var selection = document.getElementById('dropDown_'+j).value;
		var selected = document.getElementById('selectCollectionCheckBox-'+j).checked;
		if(selected==true){
			if(quantity==0 || selection=='LABEL'){//either input value is invalid
				$('#selectFlag_'+j).show();
				$('.selectFlagFooter').show();
				selectedItem[i] = false;
				error[i] = true;
			}			
			if(quantity>0 && selection!='LABEL'){//valid inputs on both input fields
				$('#selectFlag_'+j).hide();
				$('.selectFlagFooter').hide();
				selectedItem[i] = true;
				error[i] = false;
			}
		}
		else{
			$('#selectFlag_'+j).hide();
                    		selectedItem[i] = false;
			error[i] = false;
		}
	});
	
	var oneSelectedItemPassed = false;
	var errorFound = false;
	for(var i=0; i<error.length; i++){//check productError array for input errors
		if(error[i]==false){//submit document.additem[form] here
		        if(selectedItem[i] == true){
		            oneSelectedItemPassed = true;
		        }
 		}
 		else{//found an error in the array
            $('.selectFlagFooter').show();
            errorFound = true;
            break;
 		}
 	}
	if (errorFound) {
		returnValue = false;
	} else {
		if(oneSelectedItemPassed){//want to remove form fields for unSelected Items here 	
            for(var j = 0; j<error.length; j++){
                if(selectedItem[j] == false){
                	removeUnselectedItemFromForm(j+1);
                }
            }
            returnValue = true;
		} else {
			$('.selectFlagFooter').show();
			returnValue = false;
		}
	}
	if (returnValue) {
		var f = $("#additem");
		$("input[name=URL]",f).val("/minicart?storeId=" + storeId);
		//minicart.addToCart("/REIOrderItemUpdate?" + f.serialize());
		
		if($('#addingToCart').length == 0){
			$('#collections_addToCart').append('<div id="addingToCart" style="margin-top:20px;"><b>adding your selection to cart, please wait...</b></div>');
		}
		$('#addingToCart').show();
		$('#addToCart').hide();
		minicart.addToCart("/REIOrderItemUpdate?" + f.serialize(), function(){
			$('#addingToCart').hide();
			$('#addToCart').show();
		});
		
	}
	
	try{
		restoreUnselectedItems();
	}
	catch(err){}

	return false;

	function removeUnselectedItemFromForm(itemPos){
    	if($('#dropDown_'  + itemPos).parents('.priceQtyWrapper').hasClass('item' + itemPos) == false){
    		$('#dropDown_'  + itemPos).parents('.priceQtyWrapper, .priceQty').addClass('item' + itemPos) ;
    		$('#dropDown_'  + itemPos).parents('.priceQtyWrapper').attr({targetClass : 'item' + itemPos}) ;
    	}
    	if($('#saguli_mu').length == 0){
    		$('#productCollections').append('<div id="saguli_mu"></div>');
    	}
    	$('#saguli_mu').append($('#dropDown_'  + itemPos).parents('.priceQtyWrapper'));
	}
	
	function restoreUnselectedItems(){
    	if($('#saguli_mu').length > 0){
    		$('.priceQtyWrapper', '#saguli_mu').each(function(index){
    			$('.priceQty.' + $(this).attr('targetClass')).append($(this));
    		});
    	}
	}
}*/

function getCheckedItems() {
    var subTotal = 0, returnTotal = 0, elemPos = 0, itemsSelected = 0;
    var cBoxes = document.additem.selectCollectionCheckBox;
    for (ii = 0; ii < cBoxes.length; ii++) {
        subTotal = 0;        

        if (cBoxes[ii].checked) {
            elemPos = cBoxes[ii].id;
                elemPos = elemPos.substring(elemPos.lastIndexOf('-')+1, elemPos.length);
                
            itemsSelected++;
            if (parseInt($("#quantity_" + elemPos).val()) > 0) {
                subTotal = getSubTotal(elemPos, getItemPrice(elemPos));
            }
        }
        returnTotal += subTotal;
    }
    $("#merchSubTotal").html(returnTotal.toFixed(2));
    $("#itemsSelected").html(itemsSelected);

}
function getItemPrice(pricePos){
        var itemPrice = $(".pricePara span#price_" + pricePos).html();
        itemPrice = itemPrice.substring(itemPrice.indexOf('$')+1, itemPrice.length);
        return parseFloat(itemPrice);
}
function getSubTotal(pricePos, itemPrice){
        var qty = $('#quantity_'  + pricePos).val();
        var returnVal = itemPrice * parseInt(qty);
        return returnVal;
}


function escapeHTML (str) {
   var div = document.createElement('div');
   var text = document.createTextNode(str);
   div.appendChild(text);
   return div.innerHTML;
}


//Put onKeyPress="onReturnKeySubmit(this)" in any <form> element that you want to force to submit when the "return" or "enter" keys are pressed.
//NOTE: Textareas in forms should be able to accept "return" values without the form submitting. This function may need to be modified to support textareas.

function onReturnKeySubmit(theForm, theFn, thePar){
	

	if (window.event)
	{
    var node = (event.target) ? event.target : ((event.srcElement) ? event.srcElement : null);

 if (node.type && node.type != "textarea")
 {
 try
 { 
  if(event.keyCode == 13)
  {
  if (!theFn){
   theForm.submit();
  }
  else
  {
  theFn(thePar);
  }
  }
  
 }
 catch(err)
 {
  try
  {
   if(event.which == 13)
   
   if (!theFn){
  
  theForm.submit();
  }
  else
  {
  
  theFn(thePar);
  }
  
  
  }
  catch(err){}
  }
 }
}
}


// this code fixes the IE6 flicker bug 
try {
document.execCommand("BackgroundImageCache", false, true);
} catch(err) {}
// end IE6 flicker bug fix
	
/* create searchId cookie for SC event serialization */
function genSearchId(){        
               var newDate = new Date();
           
                      var myYear = newDate.getUTCFullYear();
                      myYear = myYear.toString();
                      myYear = myYear.substring(myYear.length-2,myYear.length);
                      
                      var myMonth = newDate.getUTCMonth() +1;
                      myMonth = myMonth < 10 ? ('0'+myMonth) : myMonth;
                      
                      var myDay = newDate.getUTCDate();                      
                      myDay = myDay < 10 ? ('0'+myDay) : myDay;                   
                      
                      var myMinutes = newDate.getUTCHours()*60 + newDate.getUTCMinutes();                         
                      var shortDate=myYear+myMonth+myDay;                        
                     
                     var newValue = shortDate+myMinutes+rei.util.randomID(10);
           
               Set_Cookie('searchId', newValue, 1);        	     
}
			
function checkSearchBoxValue(form){
	if(form){
	    var parentForm = form.headerQuery;
	    if (parentForm.value=='') {
	        var url = '/emptysearch';
	        if (storeClass == 'outlet') {
	        	url = '/outlet/emptysearch';
	        }
	        window.location.replace(url);
	        return false;
	    } else {
	        /* create searchId cookie for SC event serialization */
	       genSearchId();
	    }
	}else{
	    return false;
	}
}

function getUserInfoCookie(dIngredient){
	var cookieData = getCookie('rei_user_info');
	
		if(cookieData == null){
			return null;
		}
		else if(cookieData.length > 1){
			cookieData = cookieData.split('~');
		}
		else if(cookieData.length == 1){
			
		}
		else{ return null; }
			
		switch(dIngredient){
			case 'userName':
				if(cookieData.length > 1){
					return cookieData[0].toString();
				}
				else{
					return cookieData.toString();
				}
				break;
				
			case 'memberType':
				if(cookieData.length > 1){
					return cookieData[1].toLowerCase();				
				}
				else{
					return null;
				}
				break;
			
			case 'zipCode':
				break;				
		}
		
}












function ReadGRCookie (CookieName) {

    var gr_id = 0;
    var gr_event_type = "";
    var gr_event_date = "";
    var gr_personal_name = "";
    var which_cookie = "";

    var cook_obj = new Object();

    which_cookie = CookieName;
    
    var CookieString = document.cookie;
    var CookieSet = CookieString.split (';');
    var SetSize = CookieSet.length;
    var CookiePieces
    var ReturnValue = "";
    var x = 0;

    for (x = 0; ((x < SetSize) && (ReturnValue == "")); x++) {

        CookiePieces = CookieSet[x].split ('=');

        if (CookiePieces[0].substring (0,1) == ' ') {
            CookiePieces[0] = CookiePieces[0].substring (1, CookiePieces[0].length);
        }

        if (CookiePieces[0] == CookieName) {
            ReturnValue = CookiePieces[1];
        }
    }

    if (ReturnValue != "") {
        CleanRetVal = unescape(ReturnValue);
        RetArray = CleanRetVal.split(":");
        gr_id = RetArray[0];
        gr_event_type = RetArray[1];
        gr_event_date = RetArray[2];
        gr_personal_name = RetArray[3];

        //if (gr_id) alert(gr_id);
        //if (gr_personal_name) alert(gr_personal_name);

        var alertStr = "ID: " + gr_id + "\n" +
        "Name: " + gr_personal_name + "\n" +
        "Type: " + gr_event_type + "\n" +
        "Date: " + gr_event_date;
        
        cook_obj.cook_name = which_cookie;
        cook_obj.id = gr_id;
        cook_obj.event_type = gr_event_type ;
        cook_obj.event_date = gr_event_date ;
        cook_obj.personal_name = gr_personal_name ;

        return cook_obj;
        
    } 
        

}


/*!
 * jQuery JavaScript Library v1.4.4
 * http://jquery.com/
 *
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2010, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Thu Nov 11 19:04:53 2010 -0500
 */
(function(E,B){function ka(a,b,d){if(d===B&&a.nodeType===1){d=a.getAttribute("data-"+b);if(typeof d==="string"){try{d=d==="true"?true:d==="false"?false:d==="null"?null:!c.isNaN(d)?parseFloat(d):Ja.test(d)?c.parseJSON(d):d}catch(e){}c.data(a,b,d)}else d=B}return d}function U(){return false}function ca(){return true}function la(a,b,d){d[0].type=a;return c.event.handle.apply(b,d)}function Ka(a){var b,d,e,f,h,l,k,o,x,r,A,C=[];f=[];h=c.data(this,this.nodeType?"events":"__events__");if(typeof h==="function")h=
h.events;if(!(a.liveFired===this||!h||!h.live||a.button&&a.type==="click")){if(a.namespace)A=RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)");a.liveFired=this;var J=h.live.slice(0);for(k=0;k<J.length;k++){h=J[k];h.origType.replace(X,"")===a.type?f.push(h.selector):J.splice(k--,1)}f=c(a.target).closest(f,a.currentTarget);o=0;for(x=f.length;o<x;o++){r=f[o];for(k=0;k<J.length;k++){h=J[k];if(r.selector===h.selector&&(!A||A.test(h.namespace))){l=r.elem;e=null;if(h.preType==="mouseenter"||
h.preType==="mouseleave"){a.type=h.preType;e=c(a.relatedTarget).closest(h.selector)[0]}if(!e||e!==l)C.push({elem:l,handleObj:h,level:r.level})}}}o=0;for(x=C.length;o<x;o++){f=C[o];if(d&&f.level>d)break;a.currentTarget=f.elem;a.data=f.handleObj.data;a.handleObj=f.handleObj;A=f.handleObj.origHandler.apply(f.elem,arguments);if(A===false||a.isPropagationStopped()){d=f.level;if(A===false)b=false;if(a.isImmediatePropagationStopped())break}}return b}}function Y(a,b){return(a&&a!=="*"?a+".":"")+b.replace(La,
"`").replace(Ma,"&")}function ma(a,b,d){if(c.isFunction(b))return c.grep(a,function(f,h){return!!b.call(f,h,f)===d});else if(b.nodeType)return c.grep(a,function(f){return f===b===d});else if(typeof b==="string"){var e=c.grep(a,function(f){return f.nodeType===1});if(Na.test(b))return c.filter(b,e,!d);else b=c.filter(b,e)}return c.grep(a,function(f){return c.inArray(f,b)>=0===d})}function na(a,b){var d=0;b.each(function(){if(this.nodeName===(a[d]&&a[d].nodeName)){var e=c.data(a[d++]),f=c.data(this,
e);if(e=e&&e.events){delete f.handle;f.events={};for(var h in e)for(var l in e[h])c.event.add(this,h,e[h][l],e[h][l].data)}}})}function Oa(a,b){b.src?c.ajax({url:b.src,async:false,dataType:"script"}):c.globalEval(b.text||b.textContent||b.innerHTML||"");b.parentNode&&b.parentNode.removeChild(b)}function oa(a,b,d){var e=b==="width"?a.offsetWidth:a.offsetHeight;if(d==="border")return e;c.each(b==="width"?Pa:Qa,function(){d||(e-=parseFloat(c.css(a,"padding"+this))||0);if(d==="margin")e+=parseFloat(c.css(a,
"margin"+this))||0;else e-=parseFloat(c.css(a,"border"+this+"Width"))||0});return e}function da(a,b,d,e){if(c.isArray(b)&&b.length)c.each(b,function(f,h){d||Ra.test(a)?e(a,h):da(a+"["+(typeof h==="object"||c.isArray(h)?f:"")+"]",h,d,e)});else if(!d&&b!=null&&typeof b==="object")c.isEmptyObject(b)?e(a,""):c.each(b,function(f,h){da(a+"["+f+"]",h,d,e)});else e(a,b)}function S(a,b){var d={};c.each(pa.concat.apply([],pa.slice(0,b)),function(){d[this]=a});return d}function qa(a){if(!ea[a]){var b=c("<"+
a+">").appendTo("body"),d=b.css("display");b.remove();if(d==="none"||d==="")d="block";ea[a]=d}return ea[a]}function fa(a){return c.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:false}var t=E.document,c=function(){function a(){if(!b.isReady){try{t.documentElement.doScroll("left")}catch(j){setTimeout(a,1);return}b.ready()}}var b=function(j,s){return new b.fn.init(j,s)},d=E.jQuery,e=E.$,f,h=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]+)$)/,l=/\S/,k=/^\s+/,o=/\s+$/,x=/\W/,r=/\d/,A=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,
C=/^[\],:{}\s]*$/,J=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,w=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,I=/(?:^|:|,)(?:\s*\[)+/g,L=/(webkit)[ \/]([\w.]+)/,g=/(opera)(?:.*version)?[ \/]([\w.]+)/,i=/(msie) ([\w.]+)/,n=/(mozilla)(?:.*? rv:([\w.]+))?/,m=navigator.userAgent,p=false,q=[],u,y=Object.prototype.toString,F=Object.prototype.hasOwnProperty,M=Array.prototype.push,N=Array.prototype.slice,O=String.prototype.trim,D=Array.prototype.indexOf,R={};b.fn=b.prototype={init:function(j,
s){var v,z,H;if(!j)return this;if(j.nodeType){this.context=this[0]=j;this.length=1;return this}if(j==="body"&&!s&&t.body){this.context=t;this[0]=t.body;this.selector="body";this.length=1;return this}if(typeof j==="string")if((v=h.exec(j))&&(v[1]||!s))if(v[1]){H=s?s.ownerDocument||s:t;if(z=A.exec(j))if(b.isPlainObject(s)){j=[t.createElement(z[1])];b.fn.attr.call(j,s,true)}else j=[H.createElement(z[1])];else{z=b.buildFragment([v[1]],[H]);j=(z.cacheable?z.fragment.cloneNode(true):z.fragment).childNodes}return b.merge(this,
j)}else{if((z=t.getElementById(v[2]))&&z.parentNode){if(z.id!==v[2])return f.find(j);this.length=1;this[0]=z}this.context=t;this.selector=j;return this}else if(!s&&!x.test(j)){this.selector=j;this.context=t;j=t.getElementsByTagName(j);return b.merge(this,j)}else return!s||s.jquery?(s||f).find(j):b(s).find(j);else if(b.isFunction(j))return f.ready(j);if(j.selector!==B){this.selector=j.selector;this.context=j.context}return b.makeArray(j,this)},selector:"",jquery:"1.4.4",length:0,size:function(){return this.length},
toArray:function(){return N.call(this,0)},get:function(j){return j==null?this.toArray():j<0?this.slice(j)[0]:this[j]},pushStack:function(j,s,v){var z=b();b.isArray(j)?M.apply(z,j):b.merge(z,j);z.prevObject=this;z.context=this.context;if(s==="find")z.selector=this.selector+(this.selector?" ":"")+v;else if(s)z.selector=this.selector+"."+s+"("+v+")";return z},each:function(j,s){return b.each(this,j,s)},ready:function(j){b.bindReady();if(b.isReady)j.call(t,b);else q&&q.push(j);return this},eq:function(j){return j===
-1?this.slice(j):this.slice(j,+j+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(N.apply(this,arguments),"slice",N.call(arguments).join(","))},map:function(j){return this.pushStack(b.map(this,function(s,v){return j.call(s,v,s)}))},end:function(){return this.prevObject||b(null)},push:M,sort:[].sort,splice:[].splice};b.fn.init.prototype=b.fn;b.extend=b.fn.extend=function(){var j,s,v,z,H,G=arguments[0]||{},K=1,Q=arguments.length,ga=false;
if(typeof G==="boolean"){ga=G;G=arguments[1]||{};K=2}if(typeof G!=="object"&&!b.isFunction(G))G={};if(Q===K){G=this;--K}for(;K<Q;K++)if((j=arguments[K])!=null)for(s in j){v=G[s];z=j[s];if(G!==z)if(ga&&z&&(b.isPlainObject(z)||(H=b.isArray(z)))){if(H){H=false;v=v&&b.isArray(v)?v:[]}else v=v&&b.isPlainObject(v)?v:{};G[s]=b.extend(ga,v,z)}else if(z!==B)G[s]=z}return G};b.extend({noConflict:function(j){E.$=e;if(j)E.jQuery=d;return b},isReady:false,readyWait:1,ready:function(j){j===true&&b.readyWait--;
if(!b.readyWait||j!==true&&!b.isReady){if(!t.body)return setTimeout(b.ready,1);b.isReady=true;if(!(j!==true&&--b.readyWait>0))if(q){var s=0,v=q;for(q=null;j=v[s++];)j.call(t,b);b.fn.trigger&&b(t).trigger("ready").unbind("ready")}}},bindReady:function(){if(!p){p=true;if(t.readyState==="complete")return setTimeout(b.ready,1);if(t.addEventListener){t.addEventListener("DOMContentLoaded",u,false);E.addEventListener("load",b.ready,false)}else if(t.attachEvent){t.attachEvent("onreadystatechange",u);E.attachEvent("onload",
b.ready);var j=false;try{j=E.frameElement==null}catch(s){}t.documentElement.doScroll&&j&&a()}}},isFunction:function(j){return b.type(j)==="function"},isArray:Array.isArray||function(j){return b.type(j)==="array"},isWindow:function(j){return j&&typeof j==="object"&&"setInterval"in j},isNaN:function(j){return j==null||!r.test(j)||isNaN(j)},type:function(j){return j==null?String(j):R[y.call(j)]||"object"},isPlainObject:function(j){if(!j||b.type(j)!=="object"||j.nodeType||b.isWindow(j))return false;if(j.constructor&&
!F.call(j,"constructor")&&!F.call(j.constructor.prototype,"isPrototypeOf"))return false;for(var s in j);return s===B||F.call(j,s)},isEmptyObject:function(j){for(var s in j)return false;return true},error:function(j){throw j;},parseJSON:function(j){if(typeof j!=="string"||!j)return null;j=b.trim(j);if(C.test(j.replace(J,"@").replace(w,"]").replace(I,"")))return E.JSON&&E.JSON.parse?E.JSON.parse(j):(new Function("return "+j))();else b.error("Invalid JSON: "+j)},noop:function(){},globalEval:function(j){if(j&&
l.test(j)){var s=t.getElementsByTagName("head")[0]||t.documentElement,v=t.createElement("script");v.type="text/javascript";if(b.support.scriptEval)v.appendChild(t.createTextNode(j));else v.text=j;s.insertBefore(v,s.firstChild);s.removeChild(v)}},nodeName:function(j,s){return j.nodeName&&j.nodeName.toUpperCase()===s.toUpperCase()},each:function(j,s,v){var z,H=0,G=j.length,K=G===B||b.isFunction(j);if(v)if(K)for(z in j){if(s.apply(j[z],v)===false)break}else for(;H<G;){if(s.apply(j[H++],v)===false)break}else if(K)for(z in j){if(s.call(j[z],
z,j[z])===false)break}else for(v=j[0];H<G&&s.call(v,H,v)!==false;v=j[++H]);return j},trim:O?function(j){return j==null?"":O.call(j)}:function(j){return j==null?"":j.toString().replace(k,"").replace(o,"")},makeArray:function(j,s){var v=s||[];if(j!=null){var z=b.type(j);j.length==null||z==="string"||z==="function"||z==="regexp"||b.isWindow(j)?M.call(v,j):b.merge(v,j)}return v},inArray:function(j,s){if(s.indexOf)return s.indexOf(j);for(var v=0,z=s.length;v<z;v++)if(s[v]===j)return v;return-1},merge:function(j,
s){var v=j.length,z=0;if(typeof s.length==="number")for(var H=s.length;z<H;z++)j[v++]=s[z];else for(;s[z]!==B;)j[v++]=s[z++];j.length=v;return j},grep:function(j,s,v){var z=[],H;v=!!v;for(var G=0,K=j.length;G<K;G++){H=!!s(j[G],G);v!==H&&z.push(j[G])}return z},map:function(j,s,v){for(var z=[],H,G=0,K=j.length;G<K;G++){H=s(j[G],G,v);if(H!=null)z[z.length]=H}return z.concat.apply([],z)},guid:1,proxy:function(j,s,v){if(arguments.length===2)if(typeof s==="string"){v=j;j=v[s];s=B}else if(s&&!b.isFunction(s)){v=
s;s=B}if(!s&&j)s=function(){return j.apply(v||this,arguments)};if(j)s.guid=j.guid=j.guid||s.guid||b.guid++;return s},access:function(j,s,v,z,H,G){var K=j.length;if(typeof s==="object"){for(var Q in s)b.access(j,Q,s[Q],z,H,v);return j}if(v!==B){z=!G&&z&&b.isFunction(v);for(Q=0;Q<K;Q++)H(j[Q],s,z?v.call(j[Q],Q,H(j[Q],s)):v,G);return j}return K?H(j[0],s):B},now:function(){return(new Date).getTime()},uaMatch:function(j){j=j.toLowerCase();j=L.exec(j)||g.exec(j)||i.exec(j)||j.indexOf("compatible")<0&&n.exec(j)||
[];return{browser:j[1]||"",version:j[2]||"0"}},browser:{}});b.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(j,s){R["[object "+s+"]"]=s.toLowerCase()});m=b.uaMatch(m);if(m.browser){b.browser[m.browser]=true;b.browser.version=m.version}if(b.browser.webkit)b.browser.safari=true;if(D)b.inArray=function(j,s){return D.call(s,j)};if(!/\s/.test("\u00a0")){k=/^[\s\xA0]+/;o=/[\s\xA0]+$/}f=b(t);if(t.addEventListener)u=function(){t.removeEventListener("DOMContentLoaded",u,
false);b.ready()};else if(t.attachEvent)u=function(){if(t.readyState==="complete"){t.detachEvent("onreadystatechange",u);b.ready()}};return E.jQuery=E.$=b}();(function(){c.support={};var a=t.documentElement,b=t.createElement("script"),d=t.createElement("div"),e="script"+c.now();d.style.display="none";d.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var f=d.getElementsByTagName("*"),h=d.getElementsByTagName("a")[0],l=t.createElement("select"),
k=l.appendChild(t.createElement("option"));if(!(!f||!f.length||!h)){c.support={leadingWhitespace:d.firstChild.nodeType===3,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/red/.test(h.getAttribute("style")),hrefNormalized:h.getAttribute("href")==="/a",opacity:/^0.55$/.test(h.style.opacity),cssFloat:!!h.style.cssFloat,checkOn:d.getElementsByTagName("input")[0].value==="on",optSelected:k.selected,deleteExpando:true,optDisabled:false,checkClone:false,
scriptEval:false,noCloneEvent:true,boxModel:null,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableHiddenOffsets:true};l.disabled=true;c.support.optDisabled=!k.disabled;b.type="text/javascript";try{b.appendChild(t.createTextNode("window."+e+"=1;"))}catch(o){}a.insertBefore(b,a.firstChild);if(E[e]){c.support.scriptEval=true;delete E[e]}try{delete b.test}catch(x){c.support.deleteExpando=false}a.removeChild(b);if(d.attachEvent&&d.fireEvent){d.attachEvent("onclick",function r(){c.support.noCloneEvent=
false;d.detachEvent("onclick",r)});d.cloneNode(true).fireEvent("onclick")}d=t.createElement("div");d.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";a=t.createDocumentFragment();a.appendChild(d.firstChild);c.support.checkClone=a.cloneNode(true).cloneNode(true).lastChild.checked;c(function(){var r=t.createElement("div");r.style.width=r.style.paddingLeft="1px";t.body.appendChild(r);c.boxModel=c.support.boxModel=r.offsetWidth===2;if("zoom"in r.style){r.style.display="inline";r.style.zoom=
1;c.support.inlineBlockNeedsLayout=r.offsetWidth===2;r.style.display="";r.innerHTML="<div style='width:4px;'></div>";c.support.shrinkWrapBlocks=r.offsetWidth!==2}r.innerHTML="<table><tr><td style='padding:0;display:none'></td><td>t</td></tr></table>";var A=r.getElementsByTagName("td");c.support.reliableHiddenOffsets=A[0].offsetHeight===0;A[0].style.display="";A[1].style.display="none";c.support.reliableHiddenOffsets=c.support.reliableHiddenOffsets&&A[0].offsetHeight===0;r.innerHTML="";t.body.removeChild(r).style.display=
"none"});a=function(r){var A=t.createElement("div");r="on"+r;var C=r in A;if(!C){A.setAttribute(r,"return;");C=typeof A[r]==="function"}return C};c.support.submitBubbles=a("submit");c.support.changeBubbles=a("change");a=b=d=f=h=null}})();var ra={},Ja=/^(?:\{.*\}|\[.*\])$/;c.extend({cache:{},uuid:0,expando:"jQuery"+c.now(),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},data:function(a,b,d){if(c.acceptData(a)){a=a==E?ra:a;var e=a.nodeType,f=e?a[c.expando]:null,h=
c.cache;if(!(e&&!f&&typeof b==="string"&&d===B)){if(e)f||(a[c.expando]=f=++c.uuid);else h=a;if(typeof b==="object")if(e)h[f]=c.extend(h[f],b);else c.extend(h,b);else if(e&&!h[f])h[f]={};a=e?h[f]:h;if(d!==B)a[b]=d;return typeof b==="string"?a[b]:a}}},removeData:function(a,b){if(c.acceptData(a)){a=a==E?ra:a;var d=a.nodeType,e=d?a[c.expando]:a,f=c.cache,h=d?f[e]:e;if(b){if(h){delete h[b];d&&c.isEmptyObject(h)&&c.removeData(a)}}else if(d&&c.support.deleteExpando)delete a[c.expando];else if(a.removeAttribute)a.removeAttribute(c.expando);
else if(d)delete f[e];else for(var l in a)delete a[l]}},acceptData:function(a){if(a.nodeName){var b=c.noData[a.nodeName.toLowerCase()];if(b)return!(b===true||a.getAttribute("classid")!==b)}return true}});c.fn.extend({data:function(a,b){var d=null;if(typeof a==="undefined"){if(this.length){var e=this[0].attributes,f;d=c.data(this[0]);for(var h=0,l=e.length;h<l;h++){f=e[h].name;if(f.indexOf("data-")===0){f=f.substr(5);ka(this[0],f,d[f])}}}return d}else if(typeof a==="object")return this.each(function(){c.data(this,
a)});var k=a.split(".");k[1]=k[1]?"."+k[1]:"";if(b===B){d=this.triggerHandler("getData"+k[1]+"!",[k[0]]);if(d===B&&this.length){d=c.data(this[0],a);d=ka(this[0],a,d)}return d===B&&k[1]?this.data(k[0]):d}else return this.each(function(){var o=c(this),x=[k[0],b];o.triggerHandler("setData"+k[1]+"!",x);c.data(this,a,b);o.triggerHandler("changeData"+k[1]+"!",x)})},removeData:function(a){return this.each(function(){c.removeData(this,a)})}});c.extend({queue:function(a,b,d){if(a){b=(b||"fx")+"queue";var e=
c.data(a,b);if(!d)return e||[];if(!e||c.isArray(d))e=c.data(a,b,c.makeArray(d));else e.push(d);return e}},dequeue:function(a,b){b=b||"fx";var d=c.queue(a,b),e=d.shift();if(e==="inprogress")e=d.shift();if(e){b==="fx"&&d.unshift("inprogress");e.call(a,function(){c.dequeue(a,b)})}}});c.fn.extend({queue:function(a,b){if(typeof a!=="string"){b=a;a="fx"}if(b===B)return c.queue(this[0],a);return this.each(function(){var d=c.queue(this,a,b);a==="fx"&&d[0]!=="inprogress"&&c.dequeue(this,a)})},dequeue:function(a){return this.each(function(){c.dequeue(this,
a)})},delay:function(a,b){a=c.fx?c.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var d=this;setTimeout(function(){c.dequeue(d,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])}});var sa=/[\n\t]/g,ha=/\s+/,Sa=/\r/g,Ta=/^(?:href|src|style)$/,Ua=/^(?:button|input)$/i,Va=/^(?:button|input|object|select|textarea)$/i,Wa=/^a(?:rea)?$/i,ta=/^(?:radio|checkbox)$/i;c.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",
colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};c.fn.extend({attr:function(a,b){return c.access(this,a,b,true,c.attr)},removeAttr:function(a){return this.each(function(){c.attr(this,a,"");this.nodeType===1&&this.removeAttribute(a)})},addClass:function(a){if(c.isFunction(a))return this.each(function(x){var r=c(this);r.addClass(a.call(this,x,r.attr("class")))});if(a&&typeof a==="string")for(var b=(a||"").split(ha),d=0,e=this.length;d<e;d++){var f=this[d];if(f.nodeType===
1)if(f.className){for(var h=" "+f.className+" ",l=f.className,k=0,o=b.length;k<o;k++)if(h.indexOf(" "+b[k]+" ")<0)l+=" "+b[k];f.className=c.trim(l)}else f.className=a}return this},removeClass:function(a){if(c.isFunction(a))return this.each(function(o){var x=c(this);x.removeClass(a.call(this,o,x.attr("class")))});if(a&&typeof a==="string"||a===B)for(var b=(a||"").split(ha),d=0,e=this.length;d<e;d++){var f=this[d];if(f.nodeType===1&&f.className)if(a){for(var h=(" "+f.className+" ").replace(sa," "),
l=0,k=b.length;l<k;l++)h=h.replace(" "+b[l]+" "," ");f.className=c.trim(h)}else f.className=""}return this},toggleClass:function(a,b){var d=typeof a,e=typeof b==="boolean";if(c.isFunction(a))return this.each(function(f){var h=c(this);h.toggleClass(a.call(this,f,h.attr("class"),b),b)});return this.each(function(){if(d==="string")for(var f,h=0,l=c(this),k=b,o=a.split(ha);f=o[h++];){k=e?k:!l.hasClass(f);l[k?"addClass":"removeClass"](f)}else if(d==="undefined"||d==="boolean"){this.className&&c.data(this,
"__className__",this.className);this.className=this.className||a===false?"":c.data(this,"__className__")||""}})},hasClass:function(a){a=" "+a+" ";for(var b=0,d=this.length;b<d;b++)if((" "+this[b].className+" ").replace(sa," ").indexOf(a)>-1)return true;return false},val:function(a){if(!arguments.length){var b=this[0];if(b){if(c.nodeName(b,"option")){var d=b.attributes.value;return!d||d.specified?b.value:b.text}if(c.nodeName(b,"select")){var e=b.selectedIndex;d=[];var f=b.options;b=b.type==="select-one";
if(e<0)return null;var h=b?e:0;for(e=b?e+1:f.length;h<e;h++){var l=f[h];if(l.selected&&(c.support.optDisabled?!l.disabled:l.getAttribute("disabled")===null)&&(!l.parentNode.disabled||!c.nodeName(l.parentNode,"optgroup"))){a=c(l).val();if(b)return a;d.push(a)}}return d}if(ta.test(b.type)&&!c.support.checkOn)return b.getAttribute("value")===null?"on":b.value;return(b.value||"").replace(Sa,"")}return B}var k=c.isFunction(a);return this.each(function(o){var x=c(this),r=a;if(this.nodeType===1){if(k)r=
a.call(this,o,x.val());if(r==null)r="";else if(typeof r==="number")r+="";else if(c.isArray(r))r=c.map(r,function(C){return C==null?"":C+""});if(c.isArray(r)&&ta.test(this.type))this.checked=c.inArray(x.val(),r)>=0;else if(c.nodeName(this,"select")){var A=c.makeArray(r);c("option",this).each(function(){this.selected=c.inArray(c(this).val(),A)>=0});if(!A.length)this.selectedIndex=-1}else this.value=r}})}});c.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},
attr:function(a,b,d,e){if(!a||a.nodeType===3||a.nodeType===8)return B;if(e&&b in c.attrFn)return c(a)[b](d);e=a.nodeType!==1||!c.isXMLDoc(a);var f=d!==B;b=e&&c.props[b]||b;var h=Ta.test(b);if((b in a||a[b]!==B)&&e&&!h){if(f){b==="type"&&Ua.test(a.nodeName)&&a.parentNode&&c.error("type property can't be changed");if(d===null)a.nodeType===1&&a.removeAttribute(b);else a[b]=d}if(c.nodeName(a,"form")&&a.getAttributeNode(b))return a.getAttributeNode(b).nodeValue;if(b==="tabIndex")return(b=a.getAttributeNode("tabIndex"))&&
b.specified?b.value:Va.test(a.nodeName)||Wa.test(a.nodeName)&&a.href?0:B;return a[b]}if(!c.support.style&&e&&b==="style"){if(f)a.style.cssText=""+d;return a.style.cssText}f&&a.setAttribute(b,""+d);if(!a.attributes[b]&&a.hasAttribute&&!a.hasAttribute(b))return B;a=!c.support.hrefNormalized&&e&&h?a.getAttribute(b,2):a.getAttribute(b);return a===null?B:a}});var X=/\.(.*)$/,ia=/^(?:textarea|input|select)$/i,La=/\./g,Ma=/ /g,Xa=/[^\w\s.|`]/g,Ya=function(a){return a.replace(Xa,"\\$&")},ua={focusin:0,focusout:0};
c.event={add:function(a,b,d,e){if(!(a.nodeType===3||a.nodeType===8)){if(c.isWindow(a)&&a!==E&&!a.frameElement)a=E;if(d===false)d=U;else if(!d)return;var f,h;if(d.handler){f=d;d=f.handler}if(!d.guid)d.guid=c.guid++;if(h=c.data(a)){var l=a.nodeType?"events":"__events__",k=h[l],o=h.handle;if(typeof k==="function"){o=k.handle;k=k.events}else if(!k){a.nodeType||(h[l]=h=function(){});h.events=k={}}if(!o)h.handle=o=function(){return typeof c!=="undefined"&&!c.event.triggered?c.event.handle.apply(o.elem,
arguments):B};o.elem=a;b=b.split(" ");for(var x=0,r;l=b[x++];){h=f?c.extend({},f):{handler:d,data:e};if(l.indexOf(".")>-1){r=l.split(".");l=r.shift();h.namespace=r.slice(0).sort().join(".")}else{r=[];h.namespace=""}h.type=l;if(!h.guid)h.guid=d.guid;var A=k[l],C=c.event.special[l]||{};if(!A){A=k[l]=[];if(!C.setup||C.setup.call(a,e,r,o)===false)if(a.addEventListener)a.addEventListener(l,o,false);else a.attachEvent&&a.attachEvent("on"+l,o)}if(C.add){C.add.call(a,h);if(!h.handler.guid)h.handler.guid=
d.guid}A.push(h);c.event.global[l]=true}a=null}}},global:{},remove:function(a,b,d,e){if(!(a.nodeType===3||a.nodeType===8)){if(d===false)d=U;var f,h,l=0,k,o,x,r,A,C,J=a.nodeType?"events":"__events__",w=c.data(a),I=w&&w[J];if(w&&I){if(typeof I==="function"){w=I;I=I.events}if(b&&b.type){d=b.handler;b=b.type}if(!b||typeof b==="string"&&b.charAt(0)==="."){b=b||"";for(f in I)c.event.remove(a,f+b)}else{for(b=b.split(" ");f=b[l++];){r=f;k=f.indexOf(".")<0;o=[];if(!k){o=f.split(".");f=o.shift();x=RegExp("(^|\\.)"+
c.map(o.slice(0).sort(),Ya).join("\\.(?:.*\\.)?")+"(\\.|$)")}if(A=I[f])if(d){r=c.event.special[f]||{};for(h=e||0;h<A.length;h++){C=A[h];if(d.guid===C.guid){if(k||x.test(C.namespace)){e==null&&A.splice(h--,1);r.remove&&r.remove.call(a,C)}if(e!=null)break}}if(A.length===0||e!=null&&A.length===1){if(!r.teardown||r.teardown.call(a,o)===false)c.removeEvent(a,f,w.handle);delete I[f]}}else for(h=0;h<A.length;h++){C=A[h];if(k||x.test(C.namespace)){c.event.remove(a,r,C.handler,h);A.splice(h--,1)}}}if(c.isEmptyObject(I)){if(b=
w.handle)b.elem=null;delete w.events;delete w.handle;if(typeof w==="function")c.removeData(a,J);else c.isEmptyObject(w)&&c.removeData(a)}}}}},trigger:function(a,b,d,e){var f=a.type||a;if(!e){a=typeof a==="object"?a[c.expando]?a:c.extend(c.Event(f),a):c.Event(f);if(f.indexOf("!")>=0){a.type=f=f.slice(0,-1);a.exclusive=true}if(!d){a.stopPropagation();c.event.global[f]&&c.each(c.cache,function(){this.events&&this.events[f]&&c.event.trigger(a,b,this.handle.elem)})}if(!d||d.nodeType===3||d.nodeType===
8)return B;a.result=B;a.target=d;b=c.makeArray(b);b.unshift(a)}a.currentTarget=d;(e=d.nodeType?c.data(d,"handle"):(c.data(d,"__events__")||{}).handle)&&e.apply(d,b);e=d.parentNode||d.ownerDocument;try{if(!(d&&d.nodeName&&c.noData[d.nodeName.toLowerCase()]))if(d["on"+f]&&d["on"+f].apply(d,b)===false){a.result=false;a.preventDefault()}}catch(h){}if(!a.isPropagationStopped()&&e)c.event.trigger(a,b,e,true);else if(!a.isDefaultPrevented()){var l;e=a.target;var k=f.replace(X,""),o=c.nodeName(e,"a")&&k===
"click",x=c.event.special[k]||{};if((!x._default||x._default.call(d,a)===false)&&!o&&!(e&&e.nodeName&&c.noData[e.nodeName.toLowerCase()])){try{if(e[k]){if(l=e["on"+k])e["on"+k]=null;c.event.triggered=true;e[k]()}}catch(r){}if(l)e["on"+k]=l;c.event.triggered=false}}},handle:function(a){var b,d,e,f;d=[];var h=c.makeArray(arguments);a=h[0]=c.event.fix(a||E.event);a.currentTarget=this;b=a.type.indexOf(".")<0&&!a.exclusive;if(!b){e=a.type.split(".");a.type=e.shift();d=e.slice(0).sort();e=RegExp("(^|\\.)"+
d.join("\\.(?:.*\\.)?")+"(\\.|$)")}a.namespace=a.namespace||d.join(".");f=c.data(this,this.nodeType?"events":"__events__");if(typeof f==="function")f=f.events;d=(f||{})[a.type];if(f&&d){d=d.slice(0);f=0;for(var l=d.length;f<l;f++){var k=d[f];if(b||e.test(k.namespace)){a.handler=k.handler;a.data=k.data;a.handleObj=k;k=k.handler.apply(this,h);if(k!==B){a.result=k;if(k===false){a.preventDefault();a.stopPropagation()}}if(a.isImmediatePropagationStopped())break}}}return a.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[c.expando])return a;var b=a;a=c.Event(b);for(var d=this.props.length,e;d;){e=this.props[--d];a[e]=b[e]}if(!a.target)a.target=a.srcElement||t;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){b=t.documentElement;d=t.body;a.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||
d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0)}if(a.which==null&&(a.charCode!=null||a.keyCode!=null))a.which=a.charCode!=null?a.charCode:a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==B)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;return a},guid:1E8,proxy:c.proxy,special:{ready:{setup:c.bindReady,teardown:c.noop},live:{add:function(a){c.event.add(this,Y(a.origType,a.selector),c.extend({},a,{handler:Ka,guid:a.handler.guid}))},remove:function(a){c.event.remove(this,
Y(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,d){if(c.isWindow(this))this.onbeforeunload=d},teardown:function(a,b){if(this.onbeforeunload===b)this.onbeforeunload=null}}}};c.removeEvent=t.removeEventListener?function(a,b,d){a.removeEventListener&&a.removeEventListener(b,d,false)}:function(a,b,d){a.detachEvent&&a.detachEvent("on"+b,d)};c.Event=function(a){if(!this.preventDefault)return new c.Event(a);if(a&&a.type){this.originalEvent=a;this.type=a.type}else this.type=a;this.timeStamp=
c.now();this[c.expando]=true};c.Event.prototype={preventDefault:function(){this.isDefaultPrevented=ca;var a=this.originalEvent;if(a)if(a.preventDefault)a.preventDefault();else a.returnValue=false},stopPropagation:function(){this.isPropagationStopped=ca;var a=this.originalEvent;if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ca;this.stopPropagation()},isDefaultPrevented:U,isPropagationStopped:U,isImmediatePropagationStopped:U};
var va=function(a){var b=a.relatedTarget;try{for(;b&&b!==this;)b=b.parentNode;if(b!==this){a.type=a.data;c.event.handle.apply(this,arguments)}}catch(d){}},wa=function(a){a.type=a.data;c.event.handle.apply(this,arguments)};c.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){c.event.special[a]={setup:function(d){c.event.add(this,b,d&&d.selector?wa:va,a)},teardown:function(d){c.event.remove(this,b,d&&d.selector?wa:va)}}});if(!c.support.submitBubbles)c.event.special.submit={setup:function(){if(this.nodeName.toLowerCase()!==
"form"){c.event.add(this,"click.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="submit"||d==="image")&&c(b).closest("form").length){a.liveFired=B;return la("submit",this,arguments)}});c.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="text"||d==="password")&&c(b).closest("form").length&&a.keyCode===13){a.liveFired=B;return la("submit",this,arguments)}})}else return false},teardown:function(){c.event.remove(this,".specialSubmit")}};if(!c.support.changeBubbles){var V,
xa=function(a){var b=a.type,d=a.value;if(b==="radio"||b==="checkbox")d=a.checked;else if(b==="select-multiple")d=a.selectedIndex>-1?c.map(a.options,function(e){return e.selected}).join("-"):"";else if(a.nodeName.toLowerCase()==="select")d=a.selectedIndex;return d},Z=function(a,b){var d=a.target,e,f;if(!(!ia.test(d.nodeName)||d.readOnly)){e=c.data(d,"_change_data");f=xa(d);if(a.type!=="focusout"||d.type!=="radio")c.data(d,"_change_data",f);if(!(e===B||f===e))if(e!=null||f){a.type="change";a.liveFired=
B;return c.event.trigger(a,b,d)}}};c.event.special.change={filters:{focusout:Z,beforedeactivate:Z,click:function(a){var b=a.target,d=b.type;if(d==="radio"||d==="checkbox"||b.nodeName.toLowerCase()==="select")return Z.call(this,a)},keydown:function(a){var b=a.target,d=b.type;if(a.keyCode===13&&b.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(d==="checkbox"||d==="radio")||d==="select-multiple")return Z.call(this,a)},beforeactivate:function(a){a=a.target;c.data(a,"_change_data",xa(a))}},setup:function(){if(this.type===
"file")return false;for(var a in V)c.event.add(this,a+".specialChange",V[a]);return ia.test(this.nodeName)},teardown:function(){c.event.remove(this,".specialChange");return ia.test(this.nodeName)}};V=c.event.special.change.filters;V.focus=V.beforeactivate}t.addEventListener&&c.each({focus:"focusin",blur:"focusout"},function(a,b){function d(e){e=c.event.fix(e);e.type=b;return c.event.trigger(e,null,e.target)}c.event.special[b]={setup:function(){ua[b]++===0&&t.addEventListener(a,d,true)},teardown:function(){--ua[b]===
0&&t.removeEventListener(a,d,true)}}});c.each(["bind","one"],function(a,b){c.fn[b]=function(d,e,f){if(typeof d==="object"){for(var h in d)this[b](h,e,d[h],f);return this}if(c.isFunction(e)||e===false){f=e;e=B}var l=b==="one"?c.proxy(f,function(o){c(this).unbind(o,l);return f.apply(this,arguments)}):f;if(d==="unload"&&b!=="one")this.one(d,e,f);else{h=0;for(var k=this.length;h<k;h++)c.event.add(this[h],d,l,e)}return this}});c.fn.extend({unbind:function(a,b){if(typeof a==="object"&&!a.preventDefault)for(var d in a)this.unbind(d,
a[d]);else{d=0;for(var e=this.length;d<e;d++)c.event.remove(this[d],a,b)}return this},delegate:function(a,b,d,e){return this.live(b,d,e,a)},undelegate:function(a,b,d){return arguments.length===0?this.unbind("live"):this.die(b,null,d,a)},trigger:function(a,b){return this.each(function(){c.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){var d=c.Event(a);d.preventDefault();d.stopPropagation();c.event.trigger(d,b,this[0]);return d.result}},toggle:function(a){for(var b=arguments,d=
1;d<b.length;)c.proxy(a,b[d++]);return this.click(c.proxy(a,function(e){var f=(c.data(this,"lastToggle"+a.guid)||0)%d;c.data(this,"lastToggle"+a.guid,f+1);e.preventDefault();return b[f].apply(this,arguments)||false}))},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var ya={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};c.each(["live","die"],function(a,b){c.fn[b]=function(d,e,f,h){var l,k=0,o,x,r=h||this.selector;h=h?this:c(this.context);if(typeof d===
"object"&&!d.preventDefault){for(l in d)h[b](l,e,d[l],r);return this}if(c.isFunction(e)){f=e;e=B}for(d=(d||"").split(" ");(l=d[k++])!=null;){o=X.exec(l);x="";if(o){x=o[0];l=l.replace(X,"")}if(l==="hover")d.push("mouseenter"+x,"mouseleave"+x);else{o=l;if(l==="focus"||l==="blur"){d.push(ya[l]+x);l+=x}else l=(ya[l]||l)+x;if(b==="live"){x=0;for(var A=h.length;x<A;x++)c.event.add(h[x],"live."+Y(l,r),{data:e,selector:r,handler:f,origType:l,origHandler:f,preType:o})}else h.unbind("live."+Y(l,r),f)}}return this}});
c.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){c.fn[b]=function(d,e){if(e==null){e=d;d=null}return arguments.length>0?this.bind(b,d,e):this.trigger(b)};if(c.attrFn)c.attrFn[b]=true});E.attachEvent&&!E.addEventListener&&c(E).bind("unload",function(){for(var a in c.cache)if(c.cache[a].handle)try{c.event.remove(c.cache[a].handle.elem)}catch(b){}});
(function(){function a(g,i,n,m,p,q){p=0;for(var u=m.length;p<u;p++){var y=m[p];if(y){var F=false;for(y=y[g];y;){if(y.sizcache===n){F=m[y.sizset];break}if(y.nodeType===1&&!q){y.sizcache=n;y.sizset=p}if(y.nodeName.toLowerCase()===i){F=y;break}y=y[g]}m[p]=F}}}function b(g,i,n,m,p,q){p=0;for(var u=m.length;p<u;p++){var y=m[p];if(y){var F=false;for(y=y[g];y;){if(y.sizcache===n){F=m[y.sizset];break}if(y.nodeType===1){if(!q){y.sizcache=n;y.sizset=p}if(typeof i!=="string"){if(y===i){F=true;break}}else if(k.filter(i,
[y]).length>0){F=y;break}}y=y[g]}m[p]=F}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,f=Object.prototype.toString,h=false,l=true;[0,0].sort(function(){l=false;return 0});var k=function(g,i,n,m){n=n||[];var p=i=i||t;if(i.nodeType!==1&&i.nodeType!==9)return[];if(!g||typeof g!=="string")return n;var q,u,y,F,M,N=true,O=k.isXML(i),D=[],R=g;do{d.exec("");if(q=d.exec(R)){R=q[3];D.push(q[1]);if(q[2]){F=q[3];
break}}}while(q);if(D.length>1&&x.exec(g))if(D.length===2&&o.relative[D[0]])u=L(D[0]+D[1],i);else for(u=o.relative[D[0]]?[i]:k(D.shift(),i);D.length;){g=D.shift();if(o.relative[g])g+=D.shift();u=L(g,u)}else{if(!m&&D.length>1&&i.nodeType===9&&!O&&o.match.ID.test(D[0])&&!o.match.ID.test(D[D.length-1])){q=k.find(D.shift(),i,O);i=q.expr?k.filter(q.expr,q.set)[0]:q.set[0]}if(i){q=m?{expr:D.pop(),set:C(m)}:k.find(D.pop(),D.length===1&&(D[0]==="~"||D[0]==="+")&&i.parentNode?i.parentNode:i,O);u=q.expr?k.filter(q.expr,
q.set):q.set;if(D.length>0)y=C(u);else N=false;for(;D.length;){q=M=D.pop();if(o.relative[M])q=D.pop();else M="";if(q==null)q=i;o.relative[M](y,q,O)}}else y=[]}y||(y=u);y||k.error(M||g);if(f.call(y)==="[object Array]")if(N)if(i&&i.nodeType===1)for(g=0;y[g]!=null;g++){if(y[g]&&(y[g]===true||y[g].nodeType===1&&k.contains(i,y[g])))n.push(u[g])}else for(g=0;y[g]!=null;g++)y[g]&&y[g].nodeType===1&&n.push(u[g]);else n.push.apply(n,y);else C(y,n);if(F){k(F,p,n,m);k.uniqueSort(n)}return n};k.uniqueSort=function(g){if(w){h=
l;g.sort(w);if(h)for(var i=1;i<g.length;i++)g[i]===g[i-1]&&g.splice(i--,1)}return g};k.matches=function(g,i){return k(g,null,null,i)};k.matchesSelector=function(g,i){return k(i,null,null,[g]).length>0};k.find=function(g,i,n){var m;if(!g)return[];for(var p=0,q=o.order.length;p<q;p++){var u,y=o.order[p];if(u=o.leftMatch[y].exec(g)){var F=u[1];u.splice(1,1);if(F.substr(F.length-1)!=="\\"){u[1]=(u[1]||"").replace(/\\/g,"");m=o.find[y](u,i,n);if(m!=null){g=g.replace(o.match[y],"");break}}}}m||(m=i.getElementsByTagName("*"));
return{set:m,expr:g}};k.filter=function(g,i,n,m){for(var p,q,u=g,y=[],F=i,M=i&&i[0]&&k.isXML(i[0]);g&&i.length;){for(var N in o.filter)if((p=o.leftMatch[N].exec(g))!=null&&p[2]){var O,D,R=o.filter[N];D=p[1];q=false;p.splice(1,1);if(D.substr(D.length-1)!=="\\"){if(F===y)y=[];if(o.preFilter[N])if(p=o.preFilter[N](p,F,n,y,m,M)){if(p===true)continue}else q=O=true;if(p)for(var j=0;(D=F[j])!=null;j++)if(D){O=R(D,p,j,F);var s=m^!!O;if(n&&O!=null)if(s)q=true;else F[j]=false;else if(s){y.push(D);q=true}}if(O!==
B){n||(F=y);g=g.replace(o.match[N],"");if(!q)return[];break}}}if(g===u)if(q==null)k.error(g);else break;u=g}return F};k.error=function(g){throw"Syntax error, unrecognized expression: "+g;};var o=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(g){return g.getAttribute("href")}},relative:{"+":function(g,i){var n=typeof i==="string",m=n&&!/\W/.test(i);n=n&&!m;if(m)i=i.toLowerCase();m=0;for(var p=g.length,q;m<p;m++)if(q=g[m]){for(;(q=q.previousSibling)&&q.nodeType!==1;);g[m]=n||q&&q.nodeName.toLowerCase()===
i?q||false:q===i}n&&k.filter(i,g,true)},">":function(g,i){var n,m=typeof i==="string",p=0,q=g.length;if(m&&!/\W/.test(i))for(i=i.toLowerCase();p<q;p++){if(n=g[p]){n=n.parentNode;g[p]=n.nodeName.toLowerCase()===i?n:false}}else{for(;p<q;p++)if(n=g[p])g[p]=m?n.parentNode:n.parentNode===i;m&&k.filter(i,g,true)}},"":function(g,i,n){var m,p=e++,q=b;if(typeof i==="string"&&!/\W/.test(i)){m=i=i.toLowerCase();q=a}q("parentNode",i,p,g,m,n)},"~":function(g,i,n){var m,p=e++,q=b;if(typeof i==="string"&&!/\W/.test(i)){m=
i=i.toLowerCase();q=a}q("previousSibling",i,p,g,m,n)}},find:{ID:function(g,i,n){if(typeof i.getElementById!=="undefined"&&!n)return(g=i.getElementById(g[1]))&&g.parentNode?[g]:[]},NAME:function(g,i){if(typeof i.getElementsByName!=="undefined"){for(var n=[],m=i.getElementsByName(g[1]),p=0,q=m.length;p<q;p++)m[p].getAttribute("name")===g[1]&&n.push(m[p]);return n.length===0?null:n}},TAG:function(g,i){return i.getElementsByTagName(g[1])}},preFilter:{CLASS:function(g,i,n,m,p,q){g=" "+g[1].replace(/\\/g,
"")+" ";if(q)return g;q=0;for(var u;(u=i[q])!=null;q++)if(u)if(p^(u.className&&(" "+u.className+" ").replace(/[\t\n]/g," ").indexOf(g)>=0))n||m.push(u);else if(n)i[q]=false;return false},ID:function(g){return g[1].replace(/\\/g,"")},TAG:function(g){return g[1].toLowerCase()},CHILD:function(g){if(g[1]==="nth"){var i=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(g[2]==="even"&&"2n"||g[2]==="odd"&&"2n+1"||!/\D/.test(g[2])&&"0n+"+g[2]||g[2]);g[2]=i[1]+(i[2]||1)-0;g[3]=i[3]-0}g[0]=e++;return g},ATTR:function(g,i,n,
m,p,q){i=g[1].replace(/\\/g,"");if(!q&&o.attrMap[i])g[1]=o.attrMap[i];if(g[2]==="~=")g[4]=" "+g[4]+" ";return g},PSEUDO:function(g,i,n,m,p){if(g[1]==="not")if((d.exec(g[3])||"").length>1||/^\w/.test(g[3]))g[3]=k(g[3],null,null,i);else{g=k.filter(g[3],i,n,true^p);n||m.push.apply(m,g);return false}else if(o.match.POS.test(g[0])||o.match.CHILD.test(g[0]))return true;return g},POS:function(g){g.unshift(true);return g}},filters:{enabled:function(g){return g.disabled===false&&g.type!=="hidden"},disabled:function(g){return g.disabled===
true},checked:function(g){return g.checked===true},selected:function(g){return g.selected===true},parent:function(g){return!!g.firstChild},empty:function(g){return!g.firstChild},has:function(g,i,n){return!!k(n[3],g).length},header:function(g){return/h\d/i.test(g.nodeName)},text:function(g){return"text"===g.type},radio:function(g){return"radio"===g.type},checkbox:function(g){return"checkbox"===g.type},file:function(g){return"file"===g.type},password:function(g){return"password"===g.type},submit:function(g){return"submit"===
g.type},image:function(g){return"image"===g.type},reset:function(g){return"reset"===g.type},button:function(g){return"button"===g.type||g.nodeName.toLowerCase()==="button"},input:function(g){return/input|select|textarea|button/i.test(g.nodeName)}},setFilters:{first:function(g,i){return i===0},last:function(g,i,n,m){return i===m.length-1},even:function(g,i){return i%2===0},odd:function(g,i){return i%2===1},lt:function(g,i,n){return i<n[3]-0},gt:function(g,i,n){return i>n[3]-0},nth:function(g,i,n){return n[3]-
0===i},eq:function(g,i,n){return n[3]-0===i}},filter:{PSEUDO:function(g,i,n,m){var p=i[1],q=o.filters[p];if(q)return q(g,n,i,m);else if(p==="contains")return(g.textContent||g.innerText||k.getText([g])||"").indexOf(i[3])>=0;else if(p==="not"){i=i[3];n=0;for(m=i.length;n<m;n++)if(i[n]===g)return false;return true}else k.error("Syntax error, unrecognized expression: "+p)},CHILD:function(g,i){var n=i[1],m=g;switch(n){case "only":case "first":for(;m=m.previousSibling;)if(m.nodeType===1)return false;if(n===
"first")return true;m=g;case "last":for(;m=m.nextSibling;)if(m.nodeType===1)return false;return true;case "nth":n=i[2];var p=i[3];if(n===1&&p===0)return true;var q=i[0],u=g.parentNode;if(u&&(u.sizcache!==q||!g.nodeIndex)){var y=0;for(m=u.firstChild;m;m=m.nextSibling)if(m.nodeType===1)m.nodeIndex=++y;u.sizcache=q}m=g.nodeIndex-p;return n===0?m===0:m%n===0&&m/n>=0}},ID:function(g,i){return g.nodeType===1&&g.getAttribute("id")===i},TAG:function(g,i){return i==="*"&&g.nodeType===1||g.nodeName.toLowerCase()===
i},CLASS:function(g,i){return(" "+(g.className||g.getAttribute("class"))+" ").indexOf(i)>-1},ATTR:function(g,i){var n=i[1];n=o.attrHandle[n]?o.attrHandle[n](g):g[n]!=null?g[n]:g.getAttribute(n);var m=n+"",p=i[2],q=i[4];return n==null?p==="!=":p==="="?m===q:p==="*="?m.indexOf(q)>=0:p==="~="?(" "+m+" ").indexOf(q)>=0:!q?m&&n!==false:p==="!="?m!==q:p==="^="?m.indexOf(q)===0:p==="$="?m.substr(m.length-q.length)===q:p==="|="?m===q||m.substr(0,q.length+1)===q+"-":false},POS:function(g,i,n,m){var p=o.setFilters[i[2]];
if(p)return p(g,n,i,m)}}},x=o.match.POS,r=function(g,i){return"\\"+(i-0+1)},A;for(A in o.match){o.match[A]=RegExp(o.match[A].source+/(?![^\[]*\])(?![^\(]*\))/.source);o.leftMatch[A]=RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[A].source.replace(/\\(\d+)/g,r))}var C=function(g,i){g=Array.prototype.slice.call(g,0);if(i){i.push.apply(i,g);return i}return g};try{Array.prototype.slice.call(t.documentElement.childNodes,0)}catch(J){C=function(g,i){var n=0,m=i||[];if(f.call(g)==="[object Array]")Array.prototype.push.apply(m,
g);else if(typeof g.length==="number")for(var p=g.length;n<p;n++)m.push(g[n]);else for(;g[n];n++)m.push(g[n]);return m}}var w,I;if(t.documentElement.compareDocumentPosition)w=function(g,i){if(g===i){h=true;return 0}if(!g.compareDocumentPosition||!i.compareDocumentPosition)return g.compareDocumentPosition?-1:1;return g.compareDocumentPosition(i)&4?-1:1};else{w=function(g,i){var n,m,p=[],q=[];n=g.parentNode;m=i.parentNode;var u=n;if(g===i){h=true;return 0}else if(n===m)return I(g,i);else if(n){if(!m)return 1}else return-1;
for(;u;){p.unshift(u);u=u.parentNode}for(u=m;u;){q.unshift(u);u=u.parentNode}n=p.length;m=q.length;for(u=0;u<n&&u<m;u++)if(p[u]!==q[u])return I(p[u],q[u]);return u===n?I(g,q[u],-1):I(p[u],i,1)};I=function(g,i,n){if(g===i)return n;for(g=g.nextSibling;g;){if(g===i)return-1;g=g.nextSibling}return 1}}k.getText=function(g){for(var i="",n,m=0;g[m];m++){n=g[m];if(n.nodeType===3||n.nodeType===4)i+=n.nodeValue;else if(n.nodeType!==8)i+=k.getText(n.childNodes)}return i};(function(){var g=t.createElement("div"),
i="script"+(new Date).getTime(),n=t.documentElement;g.innerHTML="<a name='"+i+"'/>";n.insertBefore(g,n.firstChild);if(t.getElementById(i)){o.find.ID=function(m,p,q){if(typeof p.getElementById!=="undefined"&&!q)return(p=p.getElementById(m[1]))?p.id===m[1]||typeof p.getAttributeNode!=="undefined"&&p.getAttributeNode("id").nodeValue===m[1]?[p]:B:[]};o.filter.ID=function(m,p){var q=typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id");return m.nodeType===1&&q&&q.nodeValue===p}}n.removeChild(g);
n=g=null})();(function(){var g=t.createElement("div");g.appendChild(t.createComment(""));if(g.getElementsByTagName("*").length>0)o.find.TAG=function(i,n){var m=n.getElementsByTagName(i[1]);if(i[1]==="*"){for(var p=[],q=0;m[q];q++)m[q].nodeType===1&&p.push(m[q]);m=p}return m};g.innerHTML="<a href='#'></a>";if(g.firstChild&&typeof g.firstChild.getAttribute!=="undefined"&&g.firstChild.getAttribute("href")!=="#")o.attrHandle.href=function(i){return i.getAttribute("href",2)};g=null})();t.querySelectorAll&&
function(){var g=k,i=t.createElement("div");i.innerHTML="<p class='TEST'></p>";if(!(i.querySelectorAll&&i.querySelectorAll(".TEST").length===0)){k=function(m,p,q,u){p=p||t;m=m.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!u&&!k.isXML(p))if(p.nodeType===9)try{return C(p.querySelectorAll(m),q)}catch(y){}else if(p.nodeType===1&&p.nodeName.toLowerCase()!=="object"){var F=p.getAttribute("id"),M=F||"__sizzle__";F||p.setAttribute("id",M);try{return C(p.querySelectorAll("#"+M+" "+m),q)}catch(N){}finally{F||
p.removeAttribute("id")}}return g(m,p,q,u)};for(var n in g)k[n]=g[n];i=null}}();(function(){var g=t.documentElement,i=g.matchesSelector||g.mozMatchesSelector||g.webkitMatchesSelector||g.msMatchesSelector,n=false;try{i.call(t.documentElement,"[test!='']:sizzle")}catch(m){n=true}if(i)k.matchesSelector=function(p,q){q=q.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!k.isXML(p))try{if(n||!o.match.PSEUDO.test(q)&&!/!=/.test(q))return i.call(p,q)}catch(u){}return k(q,null,null,[p]).length>0}})();(function(){var g=
t.createElement("div");g.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!g.getElementsByClassName||g.getElementsByClassName("e").length===0)){g.lastChild.className="e";if(g.getElementsByClassName("e").length!==1){o.order.splice(1,0,"CLASS");o.find.CLASS=function(i,n,m){if(typeof n.getElementsByClassName!=="undefined"&&!m)return n.getElementsByClassName(i[1])};g=null}}})();k.contains=t.documentElement.contains?function(g,i){return g!==i&&(g.contains?g.contains(i):true)}:t.documentElement.compareDocumentPosition?
function(g,i){return!!(g.compareDocumentPosition(i)&16)}:function(){return false};k.isXML=function(g){return(g=(g?g.ownerDocument||g:0).documentElement)?g.nodeName!=="HTML":false};var L=function(g,i){for(var n,m=[],p="",q=i.nodeType?[i]:i;n=o.match.PSEUDO.exec(g);){p+=n[0];g=g.replace(o.match.PSEUDO,"")}g=o.relative[g]?g+"*":g;n=0;for(var u=q.length;n<u;n++)k(g,q[n],m);return k.filter(p,m)};c.find=k;c.expr=k.selectors;c.expr[":"]=c.expr.filters;c.unique=k.uniqueSort;c.text=k.getText;c.isXMLDoc=k.isXML;
c.contains=k.contains})();var Za=/Until$/,$a=/^(?:parents|prevUntil|prevAll)/,ab=/,/,Na=/^.[^:#\[\.,]*$/,bb=Array.prototype.slice,cb=c.expr.match.POS;c.fn.extend({find:function(a){for(var b=this.pushStack("","find",a),d=0,e=0,f=this.length;e<f;e++){d=b.length;c.find(a,this[e],b);if(e>0)for(var h=d;h<b.length;h++)for(var l=0;l<d;l++)if(b[l]===b[h]){b.splice(h--,1);break}}return b},has:function(a){var b=c(a);return this.filter(function(){for(var d=0,e=b.length;d<e;d++)if(c.contains(this,b[d]))return true})},
not:function(a){return this.pushStack(ma(this,a,false),"not",a)},filter:function(a){return this.pushStack(ma(this,a,true),"filter",a)},is:function(a){return!!a&&c.filter(a,this).length>0},closest:function(a,b){var d=[],e,f,h=this[0];if(c.isArray(a)){var l,k={},o=1;if(h&&a.length){e=0;for(f=a.length;e<f;e++){l=a[e];k[l]||(k[l]=c.expr.match.POS.test(l)?c(l,b||this.context):l)}for(;h&&h.ownerDocument&&h!==b;){for(l in k){e=k[l];if(e.jquery?e.index(h)>-1:c(h).is(e))d.push({selector:l,elem:h,level:o})}h=
h.parentNode;o++}}return d}l=cb.test(a)?c(a,b||this.context):null;e=0;for(f=this.length;e<f;e++)for(h=this[e];h;)if(l?l.index(h)>-1:c.find.matchesSelector(h,a)){d.push(h);break}else{h=h.parentNode;if(!h||!h.ownerDocument||h===b)break}d=d.length>1?c.unique(d):d;return this.pushStack(d,"closest",a)},index:function(a){if(!a||typeof a==="string")return c.inArray(this[0],a?c(a):this.parent().children());return c.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var d=typeof a==="string"?c(a,b||this.context):
c.makeArray(a),e=c.merge(this.get(),d);return this.pushStack(!d[0]||!d[0].parentNode||d[0].parentNode.nodeType===11||!e[0]||!e[0].parentNode||e[0].parentNode.nodeType===11?e:c.unique(e))},andSelf:function(){return this.add(this.prevObject)}});c.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return c.dir(a,"parentNode")},parentsUntil:function(a,b,d){return c.dir(a,"parentNode",d)},next:function(a){return c.nth(a,2,"nextSibling")},prev:function(a){return c.nth(a,
2,"previousSibling")},nextAll:function(a){return c.dir(a,"nextSibling")},prevAll:function(a){return c.dir(a,"previousSibling")},nextUntil:function(a,b,d){return c.dir(a,"nextSibling",d)},prevUntil:function(a,b,d){return c.dir(a,"previousSibling",d)},siblings:function(a){return c.sibling(a.parentNode.firstChild,a)},children:function(a){return c.sibling(a.firstChild)},contents:function(a){return c.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:c.makeArray(a.childNodes)}},function(a,
b){c.fn[a]=function(d,e){var f=c.map(this,b,d);Za.test(a)||(e=d);if(e&&typeof e==="string")f=c.filter(e,f);f=this.length>1?c.unique(f):f;if((this.length>1||ab.test(e))&&$a.test(a))f=f.reverse();return this.pushStack(f,a,bb.call(arguments).join(","))}});c.extend({filter:function(a,b,d){if(d)a=":not("+a+")";return b.length===1?c.find.matchesSelector(b[0],a)?[b[0]]:[]:c.find.matches(a,b)},dir:function(a,b,d){var e=[];for(a=a[b];a&&a.nodeType!==9&&(d===B||a.nodeType!==1||!c(a).is(d));){a.nodeType===1&&
e.push(a);a=a[b]}return e},nth:function(a,b,d){b=b||1;for(var e=0;a;a=a[d])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){for(var d=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&d.push(a);return d}});var za=/ jQuery\d+="(?:\d+|null)"/g,$=/^\s+/,Aa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Ba=/<([\w:]+)/,db=/<tbody/i,eb=/<|&#?\w+;/,Ca=/<(?:script|object|embed|option|style)/i,Da=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/\=([^="'>\s]+\/)>/g,P={option:[1,
"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};P.optgroup=P.option;P.tbody=P.tfoot=P.colgroup=P.caption=P.thead;P.th=P.td;if(!c.support.htmlSerialize)P._default=[1,"div<div>","</div>"];c.fn.extend({text:function(a){if(c.isFunction(a))return this.each(function(b){var d=
c(this);d.text(a.call(this,b,d.text()))});if(typeof a!=="object"&&a!==B)return this.empty().append((this[0]&&this[0].ownerDocument||t).createTextNode(a));return c.text(this)},wrapAll:function(a){if(c.isFunction(a))return this.each(function(d){c(this).wrapAll(a.call(this,d))});if(this[0]){var b=c(a,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var d=this;d.firstChild&&d.firstChild.nodeType===1;)d=d.firstChild;return d}).append(this)}return this},
wrapInner:function(a){if(c.isFunction(a))return this.each(function(b){c(this).wrapInner(a.call(this,b))});return this.each(function(){var b=c(this),d=b.contents();d.length?d.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){c(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){c.nodeName(this,"body")||c(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.appendChild(a)})},
prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this)});else if(arguments.length){var a=c(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,
this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,c(arguments[0]).toArray());return a}},remove:function(a,b){for(var d=0,e;(e=this[d])!=null;d++)if(!a||c.filter(a,[e]).length){if(!b&&e.nodeType===1){c.cleanData(e.getElementsByTagName("*"));c.cleanData([e])}e.parentNode&&e.parentNode.removeChild(e)}return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&c.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);
return this},clone:function(a){var b=this.map(function(){if(!c.support.noCloneEvent&&!c.isXMLDoc(this)){var d=this.outerHTML,e=this.ownerDocument;if(!d){d=e.createElement("div");d.appendChild(this.cloneNode(true));d=d.innerHTML}return c.clean([d.replace(za,"").replace(fb,'="$1">').replace($,"")],e)[0]}else return this.cloneNode(true)});if(a===true){na(this,b);na(this.find("*"),b.find("*"))}return b},html:function(a){if(a===B)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(za,""):null;
else if(typeof a==="string"&&!Ca.test(a)&&(c.support.leadingWhitespace||!$.test(a))&&!P[(Ba.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Aa,"<$1></$2>");try{for(var b=0,d=this.length;b<d;b++)if(this[b].nodeType===1){c.cleanData(this[b].getElementsByTagName("*"));this[b].innerHTML=a}}catch(e){this.empty().append(a)}}else c.isFunction(a)?this.each(function(f){var h=c(this);h.html(a.call(this,f,h.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(c.isFunction(a))return this.each(function(b){var d=
c(this),e=d.html();d.replaceWith(a.call(this,b,e))});if(typeof a!=="string")a=c(a).detach();return this.each(function(){var b=this.nextSibling,d=this.parentNode;c(this).remove();b?c(b).before(a):c(d).append(a)})}else return this.pushStack(c(c.isFunction(a)?a():a),"replaceWith",a)},detach:function(a){return this.remove(a,true)},domManip:function(a,b,d){var e,f,h,l=a[0],k=[];if(!c.support.checkClone&&arguments.length===3&&typeof l==="string"&&Da.test(l))return this.each(function(){c(this).domManip(a,
b,d,true)});if(c.isFunction(l))return this.each(function(x){var r=c(this);a[0]=l.call(this,x,b?r.html():B);r.domManip(a,b,d)});if(this[0]){e=l&&l.parentNode;e=c.support.parentNode&&e&&e.nodeType===11&&e.childNodes.length===this.length?{fragment:e}:c.buildFragment(a,this,k);h=e.fragment;if(f=h.childNodes.length===1?h=h.firstChild:h.firstChild){b=b&&c.nodeName(f,"tr");f=0;for(var o=this.length;f<o;f++)d.call(b?c.nodeName(this[f],"table")?this[f].getElementsByTagName("tbody")[0]||this[f].appendChild(this[f].ownerDocument.createElement("tbody")):
this[f]:this[f],f>0||e.cacheable||this.length>1?h.cloneNode(true):h)}k.length&&c.each(k,Oa)}return this}});c.buildFragment=function(a,b,d){var e,f,h;b=b&&b[0]?b[0].ownerDocument||b[0]:t;if(a.length===1&&typeof a[0]==="string"&&a[0].length<512&&b===t&&!Ca.test(a[0])&&(c.support.checkClone||!Da.test(a[0]))){f=true;if(h=c.fragments[a[0]])if(h!==1)e=h}if(!e){e=b.createDocumentFragment();c.clean(a,b,e,d)}if(f)c.fragments[a[0]]=h?e:1;return{fragment:e,cacheable:f}};c.fragments={};c.each({appendTo:"append",
prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){c.fn[a]=function(d){var e=[];d=c(d);var f=this.length===1&&this[0].parentNode;if(f&&f.nodeType===11&&f.childNodes.length===1&&d.length===1){d[b](this[0]);return this}else{f=0;for(var h=d.length;f<h;f++){var l=(f>0?this.clone(true):this).get();c(d[f])[b](l);e=e.concat(l)}return this.pushStack(e,a,d.selector)}}});c.extend({clean:function(a,b,d,e){b=b||t;if(typeof b.createElement==="undefined")b=b.ownerDocument||
b[0]&&b[0].ownerDocument||t;for(var f=[],h=0,l;(l=a[h])!=null;h++){if(typeof l==="number")l+="";if(l){if(typeof l==="string"&&!eb.test(l))l=b.createTextNode(l);else if(typeof l==="string"){l=l.replace(Aa,"<$1></$2>");var k=(Ba.exec(l)||["",""])[1].toLowerCase(),o=P[k]||P._default,x=o[0],r=b.createElement("div");for(r.innerHTML=o[1]+l+o[2];x--;)r=r.lastChild;if(!c.support.tbody){x=db.test(l);k=k==="table"&&!x?r.firstChild&&r.firstChild.childNodes:o[1]==="<table>"&&!x?r.childNodes:[];for(o=k.length-
1;o>=0;--o)c.nodeName(k[o],"tbody")&&!k[o].childNodes.length&&k[o].parentNode.removeChild(k[o])}!c.support.leadingWhitespace&&$.test(l)&&r.insertBefore(b.createTextNode($.exec(l)[0]),r.firstChild);l=r.childNodes}if(l.nodeType)f.push(l);else f=c.merge(f,l)}}if(d)for(h=0;f[h];h++)if(e&&c.nodeName(f[h],"script")&&(!f[h].type||f[h].type.toLowerCase()==="text/javascript"))e.push(f[h].parentNode?f[h].parentNode.removeChild(f[h]):f[h]);else{f[h].nodeType===1&&f.splice.apply(f,[h+1,0].concat(c.makeArray(f[h].getElementsByTagName("script"))));
d.appendChild(f[h])}return f},cleanData:function(a){for(var b,d,e=c.cache,f=c.event.special,h=c.support.deleteExpando,l=0,k;(k=a[l])!=null;l++)if(!(k.nodeName&&c.noData[k.nodeName.toLowerCase()]))if(d=k[c.expando]){if((b=e[d])&&b.events)for(var o in b.events)f[o]?c.event.remove(k,o):c.removeEvent(k,o,b.handle);if(h)delete k[c.expando];else k.removeAttribute&&k.removeAttribute(c.expando);delete e[d]}}});var Ea=/alpha\([^)]*\)/i,gb=/opacity=([^)]*)/,hb=/-([a-z])/ig,ib=/([A-Z])/g,Fa=/^-?\d+(?:px)?$/i,
jb=/^-?\d/,kb={position:"absolute",visibility:"hidden",display:"block"},Pa=["Left","Right"],Qa=["Top","Bottom"],W,Ga,aa,lb=function(a,b){return b.toUpperCase()};c.fn.css=function(a,b){if(arguments.length===2&&b===B)return this;return c.access(this,a,b,true,function(d,e,f){return f!==B?c.style(d,e,f):c.css(d,e)})};c.extend({cssHooks:{opacity:{get:function(a,b){if(b){var d=W(a,"opacity","opacity");return d===""?"1":d}else return a.style.opacity}}},cssNumber:{zIndex:true,fontWeight:true,opacity:true,
zoom:true,lineHeight:true},cssProps:{"float":c.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,d,e){if(!(!a||a.nodeType===3||a.nodeType===8||!a.style)){var f,h=c.camelCase(b),l=a.style,k=c.cssHooks[h];b=c.cssProps[h]||h;if(d!==B){if(!(typeof d==="number"&&isNaN(d)||d==null)){if(typeof d==="number"&&!c.cssNumber[h])d+="px";if(!k||!("set"in k)||(d=k.set(a,d))!==B)try{l[b]=d}catch(o){}}}else{if(k&&"get"in k&&(f=k.get(a,false,e))!==B)return f;return l[b]}}},css:function(a,b,d){var e,f=c.camelCase(b),
h=c.cssHooks[f];b=c.cssProps[f]||f;if(h&&"get"in h&&(e=h.get(a,true,d))!==B)return e;else if(W)return W(a,b,f)},swap:function(a,b,d){var e={},f;for(f in b){e[f]=a.style[f];a.style[f]=b[f]}d.call(a);for(f in b)a.style[f]=e[f]},camelCase:function(a){return a.replace(hb,lb)}});c.curCSS=c.css;c.each(["height","width"],function(a,b){c.cssHooks[b]={get:function(d,e,f){var h;if(e){if(d.offsetWidth!==0)h=oa(d,b,f);else c.swap(d,kb,function(){h=oa(d,b,f)});if(h<=0){h=W(d,b,b);if(h==="0px"&&aa)h=aa(d,b,b);
if(h!=null)return h===""||h==="auto"?"0px":h}if(h<0||h==null){h=d.style[b];return h===""||h==="auto"?"0px":h}return typeof h==="string"?h:h+"px"}},set:function(d,e){if(Fa.test(e)){e=parseFloat(e);if(e>=0)return e+"px"}else return e}}});if(!c.support.opacity)c.cssHooks.opacity={get:function(a,b){return gb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var d=a.style;d.zoom=1;var e=c.isNaN(b)?"":"alpha(opacity="+b*100+")",f=
d.filter||"";d.filter=Ea.test(f)?f.replace(Ea,e):d.filter+" "+e}};if(t.defaultView&&t.defaultView.getComputedStyle)Ga=function(a,b,d){var e;d=d.replace(ib,"-$1").toLowerCase();if(!(b=a.ownerDocument.defaultView))return B;if(b=b.getComputedStyle(a,null)){e=b.getPropertyValue(d);if(e===""&&!c.contains(a.ownerDocument.documentElement,a))e=c.style(a,d)}return e};if(t.documentElement.currentStyle)aa=function(a,b){var d,e,f=a.currentStyle&&a.currentStyle[b],h=a.style;if(!Fa.test(f)&&jb.test(f)){d=h.left;
e=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;h.left=b==="fontSize"?"1em":f||0;f=h.pixelLeft+"px";h.left=d;a.runtimeStyle.left=e}return f===""?"auto":f};W=Ga||aa;if(c.expr&&c.expr.filters){c.expr.filters.hidden=function(a){var b=a.offsetHeight;return a.offsetWidth===0&&b===0||!c.support.reliableHiddenOffsets&&(a.style.display||c.css(a,"display"))==="none"};c.expr.filters.visible=function(a){return!c.expr.filters.hidden(a)}}var mb=c.now(),nb=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
ob=/^(?:select|textarea)/i,pb=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,qb=/^(?:GET|HEAD)$/,Ra=/\[\]$/,T=/\=\?(&|$)/,ja=/\?/,rb=/([?&])_=[^&]*/,sb=/^(\w+:)?\/\/([^\/?#]+)/,tb=/%20/g,ub=/#.*$/,Ha=c.fn.load;c.fn.extend({load:function(a,b,d){if(typeof a!=="string"&&Ha)return Ha.apply(this,arguments);else if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var f=a.slice(e,a.length);a=a.slice(0,e)}e="GET";if(b)if(c.isFunction(b)){d=b;b=null}else if(typeof b===
"object"){b=c.param(b,c.ajaxSettings.traditional);e="POST"}var h=this;c.ajax({url:a,type:e,dataType:"html",data:b,complete:function(l,k){if(k==="success"||k==="notmodified")h.html(f?c("<div>").append(l.responseText.replace(nb,"")).find(f):l.responseText);d&&h.each(d,[l.responseText,k,l])}});return this},serialize:function(){return c.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?c.makeArray(this.elements):this}).filter(function(){return this.name&&
!this.disabled&&(this.checked||ob.test(this.nodeName)||pb.test(this.type))}).map(function(a,b){var d=c(this).val();return d==null?null:c.isArray(d)?c.map(d,function(e){return{name:b.name,value:e}}):{name:b.name,value:d}}).get()}});c.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){c.fn[b]=function(d){return this.bind(b,d)}});c.extend({get:function(a,b,d,e){if(c.isFunction(b)){e=e||d;d=b;b=null}return c.ajax({type:"GET",url:a,data:b,success:d,dataType:e})},
getScript:function(a,b){return c.get(a,null,b,"script")},getJSON:function(a,b,d){return c.get(a,b,d,"json")},post:function(a,b,d,e){if(c.isFunction(b)){e=e||d;d=b;b={}}return c.ajax({type:"POST",url:a,data:b,success:d,dataType:e})},ajaxSetup:function(a){c.extend(c.ajaxSettings,a)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:function(){return new E.XMLHttpRequest},accepts:{xml:"application/xml, text/xml",html:"text/html",
script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},ajax:function(a){var b=c.extend(true,{},c.ajaxSettings,a),d,e,f,h=b.type.toUpperCase(),l=qb.test(h);b.url=b.url.replace(ub,"");b.context=a&&a.context!=null?a.context:b;if(b.data&&b.processData&&typeof b.data!=="string")b.data=c.param(b.data,b.traditional);if(b.dataType==="jsonp"){if(h==="GET")T.test(b.url)||(b.url+=(ja.test(b.url)?"&":"?")+(b.jsonp||"callback")+"=?");else if(!b.data||
!T.test(b.data))b.data=(b.data?b.data+"&":"")+(b.jsonp||"callback")+"=?";b.dataType="json"}if(b.dataType==="json"&&(b.data&&T.test(b.data)||T.test(b.url))){d=b.jsonpCallback||"jsonp"+mb++;if(b.data)b.data=(b.data+"").replace(T,"="+d+"$1");b.url=b.url.replace(T,"="+d+"$1");b.dataType="script";var k=E[d];E[d]=function(m){if(c.isFunction(k))k(m);else{E[d]=B;try{delete E[d]}catch(p){}}f=m;c.handleSuccess(b,w,e,f);c.handleComplete(b,w,e,f);r&&r.removeChild(A)}}if(b.dataType==="script"&&b.cache===null)b.cache=
false;if(b.cache===false&&l){var o=c.now(),x=b.url.replace(rb,"$1_="+o);b.url=x+(x===b.url?(ja.test(b.url)?"&":"?")+"_="+o:"")}if(b.data&&l)b.url+=(ja.test(b.url)?"&":"?")+b.data;b.global&&c.active++===0&&c.event.trigger("ajaxStart");o=(o=sb.exec(b.url))&&(o[1]&&o[1].toLowerCase()!==location.protocol||o[2].toLowerCase()!==location.host);if(b.dataType==="script"&&h==="GET"&&o){var r=t.getElementsByTagName("head")[0]||t.documentElement,A=t.createElement("script");if(b.scriptCharset)A.charset=b.scriptCharset;
A.src=b.url;if(!d){var C=false;A.onload=A.onreadystatechange=function(){if(!C&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){C=true;c.handleSuccess(b,w,e,f);c.handleComplete(b,w,e,f);A.onload=A.onreadystatechange=null;r&&A.parentNode&&r.removeChild(A)}}}r.insertBefore(A,r.firstChild);return B}var J=false,w=b.xhr();if(w){b.username?w.open(h,b.url,b.async,b.username,b.password):w.open(h,b.url,b.async);try{if(b.data!=null&&!l||a&&a.contentType)w.setRequestHeader("Content-Type",
b.contentType);if(b.ifModified){c.lastModified[b.url]&&w.setRequestHeader("If-Modified-Since",c.lastModified[b.url]);c.etag[b.url]&&w.setRequestHeader("If-None-Match",c.etag[b.url])}o||w.setRequestHeader("X-Requested-With","XMLHttpRequest");w.setRequestHeader("Accept",b.dataType&&b.accepts[b.dataType]?b.accepts[b.dataType]+", */*; q=0.01":b.accepts._default)}catch(I){}if(b.beforeSend&&b.beforeSend.call(b.context,w,b)===false){b.global&&c.active--===1&&c.event.trigger("ajaxStop");w.abort();return false}b.global&&
c.triggerGlobal(b,"ajaxSend",[w,b]);var L=w.onreadystatechange=function(m){if(!w||w.readyState===0||m==="abort"){J||c.handleComplete(b,w,e,f);J=true;if(w)w.onreadystatechange=c.noop}else if(!J&&w&&(w.readyState===4||m==="timeout")){J=true;w.onreadystatechange=c.noop;e=m==="timeout"?"timeout":!c.httpSuccess(w)?"error":b.ifModified&&c.httpNotModified(w,b.url)?"notmodified":"success";var p;if(e==="success")try{f=c.httpData(w,b.dataType,b)}catch(q){e="parsererror";p=q}if(e==="success"||e==="notmodified")d||
c.handleSuccess(b,w,e,f);else c.handleError(b,w,e,p);d||c.handleComplete(b,w,e,f);m==="timeout"&&w.abort();if(b.async)w=null}};try{var g=w.abort;w.abort=function(){w&&Function.prototype.call.call(g,w);L("abort")}}catch(i){}b.async&&b.timeout>0&&setTimeout(function(){w&&!J&&L("timeout")},b.timeout);try{w.send(l||b.data==null?null:b.data)}catch(n){c.handleError(b,w,null,n);c.handleComplete(b,w,e,f)}b.async||L();return w}},param:function(a,b){var d=[],e=function(h,l){l=c.isFunction(l)?l():l;d[d.length]=
encodeURIComponent(h)+"="+encodeURIComponent(l)};if(b===B)b=c.ajaxSettings.traditional;if(c.isArray(a)||a.jquery)c.each(a,function(){e(this.name,this.value)});else for(var f in a)da(f,a[f],b,e);return d.join("&").replace(tb,"+")}});c.extend({active:0,lastModified:{},etag:{},handleError:function(a,b,d,e){a.error&&a.error.call(a.context,b,d,e);a.global&&c.triggerGlobal(a,"ajaxError",[b,a,e])},handleSuccess:function(a,b,d,e){a.success&&a.success.call(a.context,e,d,b);a.global&&c.triggerGlobal(a,"ajaxSuccess",
[b,a])},handleComplete:function(a,b,d){a.complete&&a.complete.call(a.context,b,d);a.global&&c.triggerGlobal(a,"ajaxComplete",[b,a]);a.global&&c.active--===1&&c.event.trigger("ajaxStop")},triggerGlobal:function(a,b,d){(a.context&&a.context.url==null?c(a.context):c.event).trigger(b,d)},httpSuccess:function(a){try{return!a.status&&location.protocol==="file:"||a.status>=200&&a.status<300||a.status===304||a.status===1223}catch(b){}return false},httpNotModified:function(a,b){var d=a.getResponseHeader("Last-Modified"),
e=a.getResponseHeader("Etag");if(d)c.lastModified[b]=d;if(e)c.etag[b]=e;return a.status===304},httpData:function(a,b,d){var e=a.getResponseHeader("content-type")||"",f=b==="xml"||!b&&e.indexOf("xml")>=0;a=f?a.responseXML:a.responseText;f&&a.documentElement.nodeName==="parsererror"&&c.error("parsererror");if(d&&d.dataFilter)a=d.dataFilter(a,b);if(typeof a==="string")if(b==="json"||!b&&e.indexOf("json")>=0)a=c.parseJSON(a);else if(b==="script"||!b&&e.indexOf("javascript")>=0)c.globalEval(a);return a}});
if(E.ActiveXObject)c.ajaxSettings.xhr=function(){if(E.location.protocol!=="file:")try{return new E.XMLHttpRequest}catch(a){}try{return new E.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}};c.support.ajax=!!c.ajaxSettings.xhr();var ea={},vb=/^(?:toggle|show|hide)$/,wb=/^([+\-]=)?([\d+.\-]+)(.*)$/,ba,pa=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];c.fn.extend({show:function(a,b,d){if(a||a===0)return this.animate(S("show",
3),a,b,d);else{d=0;for(var e=this.length;d<e;d++){a=this[d];b=a.style.display;if(!c.data(a,"olddisplay")&&b==="none")b=a.style.display="";b===""&&c.css(a,"display")==="none"&&c.data(a,"olddisplay",qa(a.nodeName))}for(d=0;d<e;d++){a=this[d];b=a.style.display;if(b===""||b==="none")a.style.display=c.data(a,"olddisplay")||""}return this}},hide:function(a,b,d){if(a||a===0)return this.animate(S("hide",3),a,b,d);else{a=0;for(b=this.length;a<b;a++){d=c.css(this[a],"display");d!=="none"&&c.data(this[a],"olddisplay",
d)}for(a=0;a<b;a++)this[a].style.display="none";return this}},_toggle:c.fn.toggle,toggle:function(a,b,d){var e=typeof a==="boolean";if(c.isFunction(a)&&c.isFunction(b))this._toggle.apply(this,arguments);else a==null||e?this.each(function(){var f=e?a:c(this).is(":hidden");c(this)[f?"show":"hide"]()}):this.animate(S("toggle",3),a,b,d);return this},fadeTo:function(a,b,d,e){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,d,e)},animate:function(a,b,d,e){var f=c.speed(b,
d,e);if(c.isEmptyObject(a))return this.each(f.complete);return this[f.queue===false?"each":"queue"](function(){var h=c.extend({},f),l,k=this.nodeType===1,o=k&&c(this).is(":hidden"),x=this;for(l in a){var r=c.camelCase(l);if(l!==r){a[r]=a[l];delete a[l];l=r}if(a[l]==="hide"&&o||a[l]==="show"&&!o)return h.complete.call(this);if(k&&(l==="height"||l==="width")){h.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(c.css(this,"display")==="inline"&&c.css(this,"float")==="none")if(c.support.inlineBlockNeedsLayout)if(qa(this.nodeName)===
"inline")this.style.display="inline-block";else{this.style.display="inline";this.style.zoom=1}else this.style.display="inline-block"}if(c.isArray(a[l])){(h.specialEasing=h.specialEasing||{})[l]=a[l][1];a[l]=a[l][0]}}if(h.overflow!=null)this.style.overflow="hidden";h.curAnim=c.extend({},a);c.each(a,function(A,C){var J=new c.fx(x,h,A);if(vb.test(C))J[C==="toggle"?o?"show":"hide":C](a);else{var w=wb.exec(C),I=J.cur()||0;if(w){var L=parseFloat(w[2]),g=w[3]||"px";if(g!=="px"){c.style(x,A,(L||1)+g);I=(L||
1)/J.cur()*I;c.style(x,A,I+g)}if(w[1])L=(w[1]==="-="?-1:1)*L+I;J.custom(I,L,g)}else J.custom(I,C,"")}});return true})},stop:function(a,b){var d=c.timers;a&&this.queue([]);this.each(function(){for(var e=d.length-1;e>=0;e--)if(d[e].elem===this){b&&d[e](true);d.splice(e,1)}});b||this.dequeue();return this}});c.each({slideDown:S("show",1),slideUp:S("hide",1),slideToggle:S("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){c.fn[a]=function(d,e,f){return this.animate(b,
d,e,f)}});c.extend({speed:function(a,b,d){var e=a&&typeof a==="object"?c.extend({},a):{complete:d||!d&&b||c.isFunction(a)&&a,duration:a,easing:d&&b||b&&!c.isFunction(b)&&b};e.duration=c.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in c.fx.speeds?c.fx.speeds[e.duration]:c.fx.speeds._default;e.old=e.complete;e.complete=function(){e.queue!==false&&c(this).dequeue();c.isFunction(e.old)&&e.old.call(this)};return e},easing:{linear:function(a,b,d,e){return d+e*a},swing:function(a,b,d,e){return(-Math.cos(a*
Math.PI)/2+0.5)*e+d}},timers:[],fx:function(a,b,d){this.options=b;this.elem=a;this.prop=d;if(!b.orig)b.orig={}}});c.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(c.fx.step[this.prop]||c.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a=parseFloat(c.css(this.elem,this.prop));return a&&a>-1E4?a:0},custom:function(a,b,d){function e(l){return f.step(l)}
var f=this,h=c.fx;this.startTime=c.now();this.start=a;this.end=b;this.unit=d||this.unit||"px";this.now=this.start;this.pos=this.state=0;e.elem=this.elem;if(e()&&c.timers.push(e)&&!ba)ba=setInterval(h.tick,h.interval)},show:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());c(this.elem).show()},hide:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.hide=true;
this.custom(this.cur(),0)},step:function(a){var b=c.now(),d=true;if(a||b>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var e in this.options.curAnim)if(this.options.curAnim[e]!==true)d=false;if(d){if(this.options.overflow!=null&&!c.support.shrinkWrapBlocks){var f=this.elem,h=this.options;c.each(["","X","Y"],function(k,o){f.style["overflow"+o]=h.overflow[k]})}this.options.hide&&c(this.elem).hide();if(this.options.hide||
this.options.show)for(var l in this.options.curAnim)c.style(this.elem,l,this.options.orig[l]);this.options.complete.call(this.elem)}return false}else{a=b-this.startTime;this.state=a/this.options.duration;b=this.options.easing||(c.easing.swing?"swing":"linear");this.pos=c.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||b](this.state,a,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update()}return true}};c.extend(c.fx,{tick:function(){for(var a=
c.timers,b=0;b<a.length;b++)a[b]()||a.splice(b--,1);a.length||c.fx.stop()},interval:13,stop:function(){clearInterval(ba);ba=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){c.style(a.elem,"opacity",a.now)},_default:function(a){if(a.elem.style&&a.elem.style[a.prop]!=null)a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit;else a.elem[a.prop]=a.now}}});if(c.expr&&c.expr.filters)c.expr.filters.animated=function(a){return c.grep(c.timers,function(b){return a===
b.elem}).length};var xb=/^t(?:able|d|h)$/i,Ia=/^(?:body|html)$/i;c.fn.offset="getBoundingClientRect"in t.documentElement?function(a){var b=this[0],d;if(a)return this.each(function(l){c.offset.setOffset(this,a,l)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);try{d=b.getBoundingClientRect()}catch(e){}var f=b.ownerDocument,h=f.documentElement;if(!d||!c.contains(h,b))return d||{top:0,left:0};b=f.body;f=fa(f);return{top:d.top+(f.pageYOffset||c.support.boxModel&&
h.scrollTop||b.scrollTop)-(h.clientTop||b.clientTop||0),left:d.left+(f.pageXOffset||c.support.boxModel&&h.scrollLeft||b.scrollLeft)-(h.clientLeft||b.clientLeft||0)}}:function(a){var b=this[0];if(a)return this.each(function(x){c.offset.setOffset(this,a,x)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);c.offset.initialize();var d,e=b.offsetParent,f=b.ownerDocument,h=f.documentElement,l=f.body;d=(f=f.defaultView)?f.getComputedStyle(b,null):b.currentStyle;
for(var k=b.offsetTop,o=b.offsetLeft;(b=b.parentNode)&&b!==l&&b!==h;){if(c.offset.supportsFixedPosition&&d.position==="fixed")break;d=f?f.getComputedStyle(b,null):b.currentStyle;k-=b.scrollTop;o-=b.scrollLeft;if(b===e){k+=b.offsetTop;o+=b.offsetLeft;if(c.offset.doesNotAddBorder&&!(c.offset.doesAddBorderForTableAndCells&&xb.test(b.nodeName))){k+=parseFloat(d.borderTopWidth)||0;o+=parseFloat(d.borderLeftWidth)||0}e=b.offsetParent}if(c.offset.subtractsBorderForOverflowNotVisible&&d.overflow!=="visible"){k+=
parseFloat(d.borderTopWidth)||0;o+=parseFloat(d.borderLeftWidth)||0}d=d}if(d.position==="relative"||d.position==="static"){k+=l.offsetTop;o+=l.offsetLeft}if(c.offset.supportsFixedPosition&&d.position==="fixed"){k+=Math.max(h.scrollTop,l.scrollTop);o+=Math.max(h.scrollLeft,l.scrollLeft)}return{top:k,left:o}};c.offset={initialize:function(){var a=t.body,b=t.createElement("div"),d,e,f,h=parseFloat(c.css(a,"marginTop"))||0;c.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",
height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(b,a.firstChild);d=b.firstChild;e=d.firstChild;f=d.nextSibling.firstChild.firstChild;this.doesNotAddBorder=e.offsetTop!==5;this.doesAddBorderForTableAndCells=
f.offsetTop===5;e.style.position="fixed";e.style.top="20px";this.supportsFixedPosition=e.offsetTop===20||e.offsetTop===15;e.style.position=e.style.top="";d.style.overflow="hidden";d.style.position="relative";this.subtractsBorderForOverflowNotVisible=e.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==h;a.removeChild(b);c.offset.initialize=c.noop},bodyOffset:function(a){var b=a.offsetTop,d=a.offsetLeft;c.offset.initialize();if(c.offset.doesNotIncludeMarginInBodyOffset){b+=parseFloat(c.css(a,
"marginTop"))||0;d+=parseFloat(c.css(a,"marginLeft"))||0}return{top:b,left:d}},setOffset:function(a,b,d){var e=c.css(a,"position");if(e==="static")a.style.position="relative";var f=c(a),h=f.offset(),l=c.css(a,"top"),k=c.css(a,"left"),o=e==="absolute"&&c.inArray("auto",[l,k])>-1;e={};var x={};if(o)x=f.position();l=o?x.top:parseInt(l,10)||0;k=o?x.left:parseInt(k,10)||0;if(c.isFunction(b))b=b.call(a,d,h);if(b.top!=null)e.top=b.top-h.top+l;if(b.left!=null)e.left=b.left-h.left+k;"using"in b?b.using.call(a,
e):f.css(e)}};c.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),d=this.offset(),e=Ia.test(b[0].nodeName)?{top:0,left:0}:b.offset();d.top-=parseFloat(c.css(a,"marginTop"))||0;d.left-=parseFloat(c.css(a,"marginLeft"))||0;e.top+=parseFloat(c.css(b[0],"borderTopWidth"))||0;e.left+=parseFloat(c.css(b[0],"borderLeftWidth"))||0;return{top:d.top-e.top,left:d.left-e.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||t.body;a&&!Ia.test(a.nodeName)&&
c.css(a,"position")==="static";)a=a.offsetParent;return a})}});c.each(["Left","Top"],function(a,b){var d="scroll"+b;c.fn[d]=function(e){var f=this[0],h;if(!f)return null;if(e!==B)return this.each(function(){if(h=fa(this))h.scrollTo(!a?e:c(h).scrollLeft(),a?e:c(h).scrollTop());else this[d]=e});else return(h=fa(f))?"pageXOffset"in h?h[a?"pageYOffset":"pageXOffset"]:c.support.boxModel&&h.document.documentElement[d]||h.document.body[d]:f[d]}});c.each(["Height","Width"],function(a,b){var d=b.toLowerCase();
c.fn["inner"+b]=function(){return this[0]?parseFloat(c.css(this[0],d,"padding")):null};c.fn["outer"+b]=function(e){return this[0]?parseFloat(c.css(this[0],d,e?"margin":"border")):null};c.fn[d]=function(e){var f=this[0];if(!f)return e==null?null:this;if(c.isFunction(e))return this.each(function(l){var k=c(this);k[d](e.call(this,l,k[d]()))});if(c.isWindow(f))return f.document.compatMode==="CSS1Compat"&&f.document.documentElement["client"+b]||f.document.body["client"+b];else if(f.nodeType===9)return Math.max(f.documentElement["client"+
b],f.body["scroll"+b],f.documentElement["scroll"+b],f.body["offset"+b],f.documentElement["offset"+b]);else if(e===B){f=c.css(f,d);var h=parseFloat(f);return c.isNaN(h)?f:h}else return this.css(d,typeof e==="string"?e:e+"px")}})})(window);


/**
 * Cookie plugin
 *
 * Copyright (c) 2006 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */

/**
 * Create a cookie with the given name and value and other optional parameters.
 *
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Set the value of a cookie.
 * @example $.cookie('the_cookie', 'the_value', { expires: 7, path: '/', domain: 'jquery.com', secure: true });
 * @desc Create a cookie with all available options.
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Create a session cookie.
 * @example $.cookie('the_cookie', null);
 * @desc Delete a cookie by passing null as value. Keep in mind that you have to use the same path and domain
 *       used when the cookie was set.
 *
 * @param String name The name of the cookie.
 * @param String value The value of the cookie.
 * @param Object options An object literal containing key/value pairs to provide optional cookie attributes.
 * @option Number|Date expires Either an integer specifying the expiration date from now on in days or a Date object.
 *                             If a negative value is specified (e.g. a date in the past), the cookie will be deleted.
 *                             If set to null or omitted, the cookie will be a session cookie and will not be retained
 *                             when the the browser exits.
 * @option String path The value of the path atribute of the cookie (default: path of page that created the cookie).
 * @option String domain The value of the domain attribute of the cookie (default: domain of page that created the cookie).
 * @option Boolean secure If true, the secure attribute of the cookie will be set and the cookie transmission will
 *                        require a secure protocol (like HTTPS).
 * @type undefined
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */

/**
 * Get the value of a cookie with the given name.
 *
 * @example $.cookie('the_cookie');
 * @desc Get the value of a cookie.
 *
 * @param String name The name of the cookie.
 * @return The value of the cookie.
 * @type String
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */
jQuery.cookie = function(name, value, options) {
    if (typeof value != 'undefined') { // name and value given, set cookie
        options = options || {};
        if (value === null) {
            value = '';
            options.expires = -1;
        } 
        var expires = '';
        if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
            var date;
            if (typeof options.expires == 'number') {
                date = new Date();
                date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000));
            } else {
                date = options.expires;
            }
            expires = '; expires=' + date.toUTCString(); // use expires attribute, max-age is not supported by IE
        }
        // CAUTION: Needed to parenthesize options.path and options.domain
        // in the following expressions, otherwise they evaluate to undefined
        // in the packed version for some reason...
        var path = options.path ? '; path=' + (options.path) : '';
        var domain = options.domain ? '; domain=' + (options.domain) : '';
        var secure = options.secure ? '; secure' : '';
        document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');
    } else { // only name given, get cookie
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
};

/*!
 * jCarousel version 0.2.7 2010 Oct 28
 * http://github.com/jsor/jcarousel/raw/master/lib/jquery.jcarousel.js
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */

/*global window, jQuery */
(function($) {
    // Default configuration properties.
    var defaults = {
        vertical: false,
        rtl: false,
        start: 1,
        offset: 1,
        size: null,
        scroll: 3,
        visible: null,
        animation: 'normal',
        easing: 'swing',
        auto: 0,
        wrap: null,
        initCallback: null,
        reloadCallback: null,
        itemLoadCallback: null,
        itemFirstInCallback: null,
        itemFirstOutCallback: null,
        itemLastInCallback: null,
        itemLastOutCallback: null,
        itemVisibleInCallback: null,
        itemVisibleOutCallback: null,
        buttonNextHTML: '<div></div>',
        buttonPrevHTML: '<div></div>',
        buttonNextEvent: 'click',
        buttonPrevEvent: 'click',
        buttonNextCallback: null,
        buttonPrevCallback: null,
        itemFallbackDimension: null
    }, windowLoaded = false;

    $(window).bind('load.jcarousel', function() { windowLoaded = true; });

    /**
     * The jCarousel object.
     *
     * @constructor
     * @class jcarousel
     * @param e {HTMLElement} The element to create the carousel for.
     * @param o {Object} A set of key/value pairs to set as configuration properties.
     * @cat Plugins/jCarousel
     */
    $.jcarousel = function(e, o) {
        this.options    = $.extend({}, defaults, o || {});

        this.locked          = false;
        this.autoStopped     = false;

        this.container       = null;
        this.clip            = null;
        this.list            = null;
        this.buttonNext      = null;
        this.buttonPrev      = null;
        this.buttonNextState = null;
        this.buttonPrevState = null;

        // Only set if not explicitly passed as option
        if (!o || o.rtl === undefined) {
            this.options.rtl = ($(e).attr('dir') || $('html').attr('dir') || '').toLowerCase() == 'rtl';
        }

        this.wh = !this.options.vertical ? 'width' : 'height';
        this.lt = !this.options.vertical ? (this.options.rtl ? 'right' : 'left') : 'top';

        // Extract skin class
        var skin = '', split = e.className.split(' ');

        for (var i = 0; i < split.length; i++) {
            if (split[i].indexOf('jcarousel-skin') != -1) {
                $(e).removeClass(split[i]);
                skin = split[i];
                break;
            }
        }

        if (e.nodeName.toUpperCase() == 'UL' || e.nodeName.toUpperCase() == 'OL') {
            this.list = $(e);
            this.container = this.list.parent();

            if (this.container.hasClass('jcarousel-clip')) {
                if (!this.container.parent().hasClass('jcarousel-container')) {
                    this.container = this.container.wrap('<div></div>');
                }

                this.container = this.container.parent();
            } else if (!this.container.hasClass('jcarousel-container')) {
                this.container = this.list.wrap('<div></div>').parent();
            }
        } else {
            this.container = $(e);
            this.list = this.container.find('ul,ol').eq(0);
        }

        if (skin !== '' && this.container.parent()[0].className.indexOf('jcarousel-skin') == -1) {
            this.container.wrap('<div class=" '+ skin + '"></div>');
        }

        this.clip = this.list.parent();

        if (!this.clip.length || !this.clip.hasClass('jcarousel-clip')) {
            this.clip = this.list.wrap('<div></div>').parent();
        }

        this.buttonNext = $('.jcarousel-next', this.container);

        if (this.buttonNext.size() === 0 && this.options.buttonNextHTML !== null) {
            this.buttonNext = this.clip.after(this.options.buttonNextHTML).next();
        }

        this.buttonNext.addClass(this.className('jcarousel-next'));

        this.buttonPrev = $('.jcarousel-prev', this.container);

        if (this.buttonPrev.size() === 0 && this.options.buttonPrevHTML !== null) {
            this.buttonPrev = this.clip.after(this.options.buttonPrevHTML).next();
        }

        this.buttonPrev.addClass(this.className('jcarousel-prev'));

        this.clip.addClass(this.className('jcarousel-clip')).css({
            overflow: 'hidden',
            position: 'relative'
        });

        this.list.addClass(this.className('jcarousel-list')).css({
            overflow: 'hidden',
            position: 'relative',
            top: 0,
            margin: 0,
            padding: 0
        }).css((this.options.rtl ? 'right' : 'left'), 0);

        this.container.addClass(this.className('jcarousel-container')).css({
            position: 'relative'
        });

        if (!this.options.vertical && this.options.rtl) {
            this.container.addClass('jcarousel-direction-rtl').attr('dir', 'rtl');
        }

        var di = this.options.visible !== null ? Math.ceil(this.clipping() / this.options.visible) : null;
        var li = this.list.children('li');

        var self = this;

        if (li.size() > 0) {
            var wh = 0, j = this.options.offset;
            li.each(function() {
                self.format(this, j++);
                wh += self.dimension(this, di);
            });

            this.list.css(this.wh, (wh + 100) + 'px');

            // Only set if not explicitly passed as option
            if (!o || o.size === undefined) {
                this.options.size = li.size();
            }
        }

        // For whatever reason, .show() does not work in Safari...
        this.container.css('display', 'block');
        this.buttonNext.css('display', 'block');
        this.buttonPrev.css('display', 'block');

        this.funcNext   = function() { self.next(); };
        this.funcPrev   = function() { self.prev(); };
        this.funcResize = function() { self.reload(); };

        if (this.options.initCallback !== null) {
            this.options.initCallback(this, 'init');
        }

        if (!windowLoaded && $.browser.safari) {
            this.buttons(false, false);
            $(window).bind('load.jcarousel', function() { self.setup(); });
        } else {
            this.setup();
        }
    };

    // Create shortcut for internal use
    var $jc = $.jcarousel;

    $jc.fn = $jc.prototype = {
        jcarousel: '0.2.7'
    };

    $jc.fn.extend = $jc.extend = $.extend;

    $jc.fn.extend({
        /**
         * Setups the carousel.
         *
         * @method setup
         * @return undefined
         */
        setup: function() {
            this.first     = null;
            this.last      = null;
            this.prevFirst = null;
            this.prevLast  = null;
            this.animating = false;
            this.timer     = null;
            this.tail      = null;
            this.inTail    = false;

            if (this.locked) {
                return;
            }

            this.list.css(this.lt, this.pos(this.options.offset) + 'px');
            var p = this.pos(this.options.start, true);
            this.prevFirst = this.prevLast = null;
            this.animate(p, false);

            $(window).unbind('resize.jcarousel', this.funcResize).bind('resize.jcarousel', this.funcResize);
        },

        /**
         * Clears the list and resets the carousel.
         *
         * @method reset
         * @return undefined
         */
        reset: function() {
            this.list.empty();

            this.list.css(this.lt, '0px');
            this.list.css(this.wh, '10px');

            if (this.options.initCallback !== null) {
                this.options.initCallback(this, 'reset');
            }

            this.setup();
        },

        /**
         * Reloads the carousel and adjusts positions.
         *
         * @method reload
         * @return undefined
         */
        reload: function() {
            if (this.tail !== null && this.inTail) {
                this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) + this.tail);
            }

            this.tail   = null;
            this.inTail = false;

            if (this.options.reloadCallback !== null) {
                this.options.reloadCallback(this);
            }

            if (this.options.visible !== null) {
                var self = this;
                var di = Math.ceil(this.clipping() / this.options.visible), wh = 0, lt = 0;
                this.list.children('li').each(function(i) {
                    wh += self.dimension(this, di);
                    if (i + 1 < self.first) {
                        lt = wh;
                    }
                });

                this.list.css(this.wh, wh + 'px');
                this.list.css(this.lt, -lt + 'px');
            }

            this.scroll(this.first, false);
        },

        /**
         * Locks the carousel.
         *
         * @method lock
         * @return undefined
         */
        lock: function() {
            this.locked = true;
            this.buttons();
        },

        /**
         * Unlocks the carousel.
         *
         * @method unlock
         * @return undefined
         */
        unlock: function() {
            this.locked = false;
            this.buttons();
        },

        /**
         * Sets the size of the carousel.
         *
         * @method size
         * @return undefined
         * @param s {Number} The size of the carousel.
         */
        size: function(s) {
            if (s !== undefined) {
                this.options.size = s;
                if (!this.locked) {
                    this.buttons();
                }
            }

            return this.options.size;
        },

        /**
         * Checks whether a list element exists for the given index (or index range).
         *
         * @method get
         * @return bool
         * @param i {Number} The index of the (first) element.
         * @param i2 {Number} The index of the last element.
         */
        has: function(i, i2) {
            if (i2 === undefined || !i2) {
                i2 = i;
            }

            if (this.options.size !== null && i2 > this.options.size) {
                i2 = this.options.size;
            }

            for (var j = i; j <= i2; j++) {
                var e = this.get(j);
                if (!e.length || e.hasClass('jcarousel-item-placeholder')) {
                    return false;
                }
            }

            return true;
        },

        /**
         * Returns a jQuery object with list element for the given index.
         *
         * @method get
         * @return jQuery
         * @param i {Number} The index of the element.
         */
        get: function(i) {
            return $('.jcarousel-item-' + i, this.list);
        },

        /**
         * Adds an element for the given index to the list.
         * If the element already exists, it updates the inner html.
         * Returns the created element as jQuery object.
         *
         * @method add
         * @return jQuery
         * @param i {Number} The index of the element.
         * @param s {String} The innerHTML of the element.
         */
        add: function(i, s) {
            var e = this.get(i), old = 0, n = $(s);

            if (e.length === 0) {
                var c, j = $jc.intval(i);
                e = this.create(i);
                while (true) {
                    c = this.get(--j);
                    if (j <= 0 || c.length) {
                        if (j <= 0) {
                            this.list.prepend(e);
                        } else {
                            c.after(e);
                        }
                        break;
                    }
                }
            } else {
                old = this.dimension(e);
            }

            if (n.get(0).nodeName.toUpperCase() == 'LI') {
                e.replaceWith(n);
                e = n;
            } else {
                e.empty().append(s);
            }

            this.format(e.removeClass(this.className('jcarousel-item-placeholder')), i);

            var di = this.options.visible !== null ? Math.ceil(this.clipping() / this.options.visible) : null;
            var wh = this.dimension(e, di) - old;

            if (i > 0 && i < this.first) {
                this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) - wh + 'px');
            }

            this.list.css(this.wh, $jc.intval(this.list.css(this.wh)) + wh + 'px');

            return e;
        },

        /**
         * Removes an element for the given index from the list.
         *
         * @method remove
         * @return undefined
         * @param i {Number} The index of the element.
         */
        remove: function(i) {
            var e = this.get(i);

            // Check if item exists and is not currently visible
            if (!e.length || (i >= this.first && i <= this.last)) {
                return;
            }

            var d = this.dimension(e);

            if (i < this.first) {
                this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) + d + 'px');
            }

            e.remove();

            this.list.css(this.wh, $jc.intval(this.list.css(this.wh)) - d + 'px');
        },

        /**
         * Moves the carousel forwards.
         *
         * @method next
         * @return undefined
         */
        next: function() {
            if (this.tail !== null && !this.inTail) {
                this.scrollTail(false);
            } else {
                this.scroll(((this.options.wrap == 'both' || this.options.wrap == 'last') && this.options.size !== null && this.last == this.options.size) ? 1 : this.first + this.options.scroll);
            }
        },

        /**
         * Moves the carousel backwards.
         *
         * @method prev
         * @return undefined
         */
        prev: function() {
            if (this.tail !== null && this.inTail) {
                this.scrollTail(true);
            } else {
                this.scroll(((this.options.wrap == 'both' || this.options.wrap == 'first') && this.options.size !== null && this.first == 1) ? this.options.size : this.first - this.options.scroll);
            }
        },

        /**
         * Scrolls the tail of the carousel.
         *
         * @method scrollTail
         * @return undefined
         * @param b {Boolean} Whether scroll the tail back or forward.
         */
        scrollTail: function(b) {
            if (this.locked || this.animating || !this.tail) {
                return;
            }

            this.pauseAuto();

            var pos  = $jc.intval(this.list.css(this.lt));

            pos = !b ? pos - this.tail : pos + this.tail;
            this.inTail = !b;

            // Save for callbacks
            this.prevFirst = this.first;
            this.prevLast  = this.last;

            this.animate(pos);
        },

        /**
         * Scrolls the carousel to a certain position.
         *
         * @method scroll
         * @return undefined
         * @param i {Number} The index of the element to scoll to.
         * @param a {Boolean} Flag indicating whether to perform animation.
         */
        scroll: function(i, a) {
            if (this.locked || this.animating) {
                return;
            }

            this.pauseAuto();
            this.animate(this.pos(i), a);
        },

        /**
         * Prepares the carousel and return the position for a certian index.
         *
         * @method pos
         * @return {Number}
         * @param i {Number} The index of the element to scoll to.
         * @param fv {Boolean} Whether to force last item to be visible.
         */
        pos: function(i, fv) {
            var pos  = $jc.intval(this.list.css(this.lt));

            if (this.locked || this.animating) {
                return pos;
            }

            if (this.options.wrap != 'circular') {
                i = i < 1 ? 1 : (this.options.size && i > this.options.size ? this.options.size : i);
            }

            var back = this.first > i;

            // Create placeholders, new list width/height
            // and new list position
            var f = this.options.wrap != 'circular' && this.first <= 1 ? 1 : this.first;
            var c = back ? this.get(f) : this.get(this.last);
            var j = back ? f : f - 1;
            var e = null, l = 0, p = false, d = 0, g;

            while (back ? --j >= i : ++j < i) {
                e = this.get(j);
                p = !e.length;
                if (e.length === 0) {
                    e = this.create(j).addClass(this.className('jcarousel-item-placeholder'));
                    c[back ? 'before' : 'after' ](e);

                    if (this.first !== null && this.options.wrap == 'circular' && this.options.size !== null && (j <= 0 || j > this.options.size)) {
                        g = this.get(this.index(j));
                        if (g.length) {
                            e = this.add(j, g.clone(true));
                        }
                    }
                }

                c = e;
                d = this.dimension(e);

                if (p) {
                    l += d;
                }

                if (this.first !== null && (this.options.wrap == 'circular' || (j >= 1 && (this.options.size === null || j <= this.options.size)))) {
                    pos = back ? pos + d : pos - d;
                }
            }

            // Calculate visible items
            var clipping = this.clipping(), cache = [], visible = 0, v = 0;
            c = this.get(i - 1);
            j = i;

            while (++visible) {
                e = this.get(j);
                p = !e.length;
                if (e.length === 0) {
                    e = this.create(j).addClass(this.className('jcarousel-item-placeholder'));
                    // This should only happen on a next scroll
                    if (c.length === 0) {
                        this.list.prepend(e);
                    } else {
                        c[back ? 'before' : 'after' ](e);
                    }

                    if (this.first !== null && this.options.wrap == 'circular' && this.options.size !== null && (j <= 0 || j > this.options.size)) {
                        g = this.get(this.index(j));
                        if (g.length) {
                            e = this.add(j, g.clone(true));
                        }
                    }
                }

                c = e;
                d = this.dimension(e);
                if (d === 0) {
                    throw new Error('jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...');
                }

                if (this.options.wrap != 'circular' && this.options.size !== null && j > this.options.size) {
                    cache.push(e);
                } else if (p) {
                    l += d;
                }

                v += d;

                if (v >= clipping) {
                    break;
                }

                j++;
            }

             // Remove out-of-range placeholders
            for (var x = 0; x < cache.length; x++) {
                cache[x].remove();
            }

            // Resize list
            if (l > 0) {
                this.list.css(this.wh, this.dimension(this.list) + l + 'px');

                if (back) {
                    pos -= l;
                    this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) - l + 'px');
                }
            }

            // Calculate first and last item
            var last = i + visible - 1;
            if (this.options.wrap != 'circular' && this.options.size && last > this.options.size) {
                last = this.options.size;
            }

            if (j > last) {
                visible = 0;
                j = last;
                v = 0;
                while (++visible) {
                    e = this.get(j--);
                    if (!e.length) {
                        break;
                    }
                    v += this.dimension(e);
                    if (v >= clipping) {
                        break;
                    }
                }
            }

            var first = last - visible + 1;
            if (this.options.wrap != 'circular' && first < 1) {
                first = 1;
            }

            if (this.inTail && back) {
                pos += this.tail;
                this.inTail = false;
            }

            this.tail = null;
            if (this.options.wrap != 'circular' && last == this.options.size && (last - visible + 1) >= 1) {
                var m = $jc.margin(this.get(last), !this.options.vertical ? 'marginRight' : 'marginBottom');
                if ((v - m) > clipping) {
                    this.tail = v - clipping - m;
                }
            }

            if (fv && i === this.options.size && this.tail) {
                pos -= this.tail;
                this.inTail = true;
            }

            // Adjust position
            while (i-- > first) {
                pos += this.dimension(this.get(i));
            }

            // Save visible item range
            this.prevFirst = this.first;
            this.prevLast  = this.last;
            this.first     = first;
            this.last      = last;

            return pos;
        },

        /**
         * Animates the carousel to a certain position.
         *
         * @method animate
         * @return undefined
         * @param p {Number} Position to scroll to.
         * @param a {Boolean} Flag indicating whether to perform animation.
         */
        animate: function(p, a) {
            if (this.locked || this.animating) {
                return;
            }

            this.animating = true;

            var self = this;
            var scrolled = function() {
                self.animating = false;

                if (p === 0) {
                    self.list.css(self.lt,  0);
                }

                if (!self.autoStopped && (self.options.wrap == 'circular' || self.options.wrap == 'both' || self.options.wrap == 'last' || self.options.size === null || self.last < self.options.size || (self.last == self.options.size && self.tail !== null && !self.inTail))) {
                    self.startAuto();
                }

                self.buttons();
                self.notify('onAfterAnimation');

                // This function removes items which are appended automatically for circulation.
                // This prevents the list from growing infinitely.
                if (self.options.wrap == 'circular' && self.options.size !== null) {
                    for (var i = self.prevFirst; i <= self.prevLast; i++) {
                        if (i !== null && !(i >= self.first && i <= self.last) && (i < 1 || i > self.options.size)) {
                            self.remove(i);
                        }
                    }
                }
            };

            this.notify('onBeforeAnimation');

            // Animate
            if (!this.options.animation || a === false) {
                this.list.css(this.lt, p + 'px');
                scrolled();
            } else {
                var o = !this.options.vertical ? (this.options.rtl ? {'right': p} : {'left': p}) : {'top': p};
                this.list.animate(o, this.options.animation, this.options.easing, scrolled);
            }
        },

        /**
         * Starts autoscrolling.
         *
         * @method auto
         * @return undefined
         * @param s {Number} Seconds to periodically autoscroll the content.
         */
        startAuto: function(s) {
            if (s !== undefined) {
                this.options.auto = s;
            }

            if (this.options.auto === 0) {
                return this.stopAuto();
            }

            if (this.timer !== null) {
                return;
            }

            this.autoStopped = false;

            var self = this;
            this.timer = window.setTimeout(function() { self.next(); }, this.options.auto * 1000);
        },

        /**
         * Stops autoscrolling.
         *
         * @method stopAuto
         * @return undefined
         */
        stopAuto: function() {
            this.pauseAuto();
            this.autoStopped = true;
        },

        /**
         * Pauses autoscrolling.
         *
         * @method pauseAuto
         * @return undefined
         */
        pauseAuto: function() {
            if (this.timer === null) {
                return;
            }

            window.clearTimeout(this.timer);
            this.timer = null;
        },

        /**
         * Sets the states of the prev/next buttons.
         *
         * @method buttons
         * @return undefined
         */
        buttons: function(n, p) {
            if (n == null) {
                n = !this.locked && this.options.size !== 0 && ((this.options.wrap && this.options.wrap != 'first') || this.options.size === null || this.last < this.options.size);
                if (!this.locked && (!this.options.wrap || this.options.wrap == 'first') && this.options.size !== null && this.last >= this.options.size) {
                    n = this.tail !== null && !this.inTail;
                }
            }

            if (p == null) {
                p = !this.locked && this.options.size !== 0 && ((this.options.wrap && this.options.wrap != 'last') || this.first > 1);
                if (!this.locked && (!this.options.wrap || this.options.wrap == 'last') && this.options.size !== null && this.first == 1) {
                    p = this.tail !== null && this.inTail;
                }
            }

            var self = this;

            if (this.buttonNext.size() > 0) {
                this.buttonNext.unbind(this.options.buttonNextEvent + '.jcarousel', this.funcNext);

                if (n) {
                    this.buttonNext.bind(this.options.buttonNextEvent + '.jcarousel', this.funcNext);
                }

                this.buttonNext[n ? 'removeClass' : 'addClass'](this.className('jcarousel-next-disabled')).attr('disabled', n ? false : true);

                if (this.options.buttonNextCallback !== null && this.buttonNext.data('jcarouselstate') != n) {
                    this.buttonNext.each(function() { self.options.buttonNextCallback(self, this, n); }).data('jcarouselstate', n);
                }
            } else {
                if (this.options.buttonNextCallback !== null && this.buttonNextState != n) {
                    this.options.buttonNextCallback(self, null, n);
                }
            }

            if (this.buttonPrev.size() > 0) {
                this.buttonPrev.unbind(this.options.buttonPrevEvent + '.jcarousel', this.funcPrev);

                if (p) {
                    this.buttonPrev.bind(this.options.buttonPrevEvent + '.jcarousel', this.funcPrev);
                }

                this.buttonPrev[p ? 'removeClass' : 'addClass'](this.className('jcarousel-prev-disabled')).attr('disabled', p ? false : true);

                if (this.options.buttonPrevCallback !== null && this.buttonPrev.data('jcarouselstate') != p) {
                    this.buttonPrev.each(function() { self.options.buttonPrevCallback(self, this, p); }).data('jcarouselstate', p);
                }
            } else {
                if (this.options.buttonPrevCallback !== null && this.buttonPrevState != p) {
                    this.options.buttonPrevCallback(self, null, p);
                }
            }

            this.buttonNextState = n;
            this.buttonPrevState = p;
        },

        /**
         * Notify callback of a specified event.
         *
         * @method notify
         * @return undefined
         * @param evt {String} The event name
         */
        notify: function(evt) {
            var state = this.prevFirst === null ? 'init' : (this.prevFirst < this.first ? 'next' : 'prev');

            // Load items
            this.callback('itemLoadCallback', evt, state);

            if (this.prevFirst !== this.first) {
                this.callback('itemFirstInCallback', evt, state, this.first);
                this.callback('itemFirstOutCallback', evt, state, this.prevFirst);
            }

            if (this.prevLast !== this.last) {
                this.callback('itemLastInCallback', evt, state, this.last);
                this.callback('itemLastOutCallback', evt, state, this.prevLast);
            }

            this.callback('itemVisibleInCallback', evt, state, this.first, this.last, this.prevFirst, this.prevLast);
            this.callback('itemVisibleOutCallback', evt, state, this.prevFirst, this.prevLast, this.first, this.last);
        },

        callback: function(cb, evt, state, i1, i2, i3, i4) {
            if (this.options[cb] == null || (typeof this.options[cb] != 'object' && evt != 'onAfterAnimation')) {
                return;
            }

            var callback = typeof this.options[cb] == 'object' ? this.options[cb][evt] : this.options[cb];

            if (!$.isFunction(callback)) {
                return;
            }

            var self = this;

            if (i1 === undefined) {
                callback(self, state, evt);
            } else if (i2 === undefined) {
                this.get(i1).each(function() { callback(self, this, i1, state, evt); });
            } else {
                var call = function(i) {
                    self.get(i).each(function() { callback(self, this, i, state, evt); });
                };
                for (var i = i1; i <= i2; i++) {
                    if (i !== null && !(i >= i3 && i <= i4)) {
                        call(i);
                    }
                }
            }
        },

        create: function(i) {
            return this.format('<li></li>', i);
        },

        format: function(e, i) {
            e = $(e);
            var split = e.get(0).className.split(' ');
            for (var j = 0; j < split.length; j++) {
                if (split[j].indexOf('jcarousel-') != -1) {
                    e.removeClass(split[j]);
                }
            }
            e.addClass(this.className('jcarousel-item')).addClass(this.className('jcarousel-item-' + i)).css({
                'float': (this.options.rtl ? 'right' : 'left'),
                'list-style': 'none'
            }).attr('jcarouselindex', i);
            return e;
        },

        className: function(c) {
            return c + ' ' + c + (!this.options.vertical ? '-horizontal' : '-vertical');
        },

        dimension: function(e, d) {
            var el = e.jquery !== undefined ? e[0] : e;

            var old = !this.options.vertical ?
                (el.offsetWidth || $jc.intval(this.options.itemFallbackDimension)) + $jc.margin(el, 'marginLeft') + $jc.margin(el, 'marginRight') :
                (el.offsetHeight || $jc.intval(this.options.itemFallbackDimension)) + $jc.margin(el, 'marginTop') + $jc.margin(el, 'marginBottom');

            if (d == null || old == d) {
                return old;
            }

            var w = !this.options.vertical ?
                d - $jc.margin(el, 'marginLeft') - $jc.margin(el, 'marginRight') :
                d - $jc.margin(el, 'marginTop') - $jc.margin(el, 'marginBottom');

            $(el).css(this.wh, w + 'px');

            return this.dimension(el);
        },

        clipping: function() {
            return !this.options.vertical ?
                this.clip[0].offsetWidth - $jc.intval(this.clip.css('borderLeftWidth')) - $jc.intval(this.clip.css('borderRightWidth')) :
                this.clip[0].offsetHeight - $jc.intval(this.clip.css('borderTopWidth')) - $jc.intval(this.clip.css('borderBottomWidth'));
        },

        index: function(i, s) {
            if (s == null) {
                s = this.options.size;
            }

            return Math.round((((i-1) / s) - Math.floor((i-1) / s)) * s) + 1;
        }
    });

    $jc.extend({
        /**
         * Gets/Sets the global default configuration properties.
         *
         * @method defaults
         * @return {Object}
         * @param d {Object} A set of key/value pairs to set as configuration properties.
         */
        defaults: function(d) {
            return $.extend(defaults, d || {});
        },

        margin: function(e, p) {
            if (!e) {
                return 0;
            }

            var el = e.jquery !== undefined ? e[0] : e;

            if (p == 'marginRight' && $.browser.safari) {
                var old = {'display': 'block', 'float': 'none', 'width': 'auto'}, oWidth, oWidth2;

                $.swap(el, old, function() { oWidth = el.offsetWidth; });

                old.marginRight = 0;
                $.swap(el, old, function() { oWidth2 = el.offsetWidth; });

                return oWidth2 - oWidth;
            }

            return $jc.intval($.css(el, p));
        },

        intval: function(v) {
            v = parseInt(v, 10);
            return isNaN(v) ? 0 : v;
        }
    });

    /**
     * Creates a carousel for all matched elements.
     *
     * @example $("#mycarousel").jcarousel();
     * @before <ul id="mycarousel" class="jcarousel-skin-name"><li>First item</li><li>Second item</li></ul>
     * @result
     *
     * <div class="jcarousel-skin-name">
     *   <div class="jcarousel-container">
     *     <div class="jcarousel-clip">
     *       <ul class="jcarousel-list">
     *         <li class="jcarousel-item-1">First item</li>
     *         <li class="jcarousel-item-2">Second item</li>
     *       </ul>
     *     </div>
     *     <div disabled="disabled" class="jcarousel-prev jcarousel-prev-disabled"></div>
     *     <div class="jcarousel-next"></div>
     *   </div>
     * </div>
     *
     * @method jcarousel
     * @return jQuery
     * @param o {Hash|String} A set of key/value pairs to set as configuration properties or a method name to call on a formerly created instance.
     */
    $.fn.jcarousel = function(o) {
        if (typeof o == 'string') {
            var instance = $(this).data('jcarousel'), args = Array.prototype.slice.call(arguments, 1);
            return instance[o].apply(instance, args);
        } else {
            return this.each(function() {
                $(this).data('jcarousel', new $jc(this, o));
            });
        }
    };

})(jQuery);


var mboxCopyright = "Copyright 1996-2011. Adobe Systems Incorporated. All rights reserved.";mboxUrlBuilder = function(a, b) { this.a = a; this.b = b; this.c = new Array(); this.d = function(e) { return e; }; this.f = null;};mboxUrlBuilder.prototype.addParameter = function(g, h) { var i = new RegExp('(\'|")'); if (i.exec(g)) { throw "Parameter '" + g + "' contains invalid characters"; } for (var j = 0; j < this.c.length; j++) { var k = this.c[j]; if (k.name == g) { k.value = h; return this; } } var l = new Object(); l.name = g; l.value = h; this.c[this.c.length] = l; return this;};mboxUrlBuilder.prototype.addParameters = function(c) { if (!c) { return this; } for (var j = 0; j < c.length; j++) { var m = c[j].indexOf('='); if (m == -1 || m == 0) { continue; } this.addParameter(c[j].substring(0, m), c[j].substring(m + 1, c[j].length)); } return this;};mboxUrlBuilder.prototype.setServerType = function(n) { this.o = n;};mboxUrlBuilder.prototype.setBasePath = function(f) { this.f = f;};mboxUrlBuilder.prototype.setUrlProcessAction = function(p) { this.d = p;};mboxUrlBuilder.prototype.buildUrl = function() { var q = this.f ? this.f : '/m2/' + this.b + '/mbox/' + this.o; var r = document.location.protocol == 'file:' ? 'http:' : document.location.protocol; var e = r + "//" + this.a + q; var s = e.indexOf('?') != -1 ? '&' : '?'; for (var j = 0; j < this.c.length; j++) { var k = this.c[j]; e += s + encodeURIComponent(k.name) + '=' + encodeURIComponent(k.value); s = '&'; } return this.t(this.d(e));};mboxUrlBuilder.prototype.getParameters = function() { return this.c;};mboxUrlBuilder.prototype.setParameters = function(c) { this.c = c;};mboxUrlBuilder.prototype.clone = function() { var u = new mboxUrlBuilder(this.a, this.b); u.setServerType(this.o); u.setBasePath(this.f); u.setUrlProcessAction(this.d); for (var j = 0; j < this.c.length; j++) { u.addParameter(this.c[j].name, this.c[j].value); } return u;};mboxUrlBuilder.prototype.t = function(v) { return v.replace(/\"/g, '&quot;').replace(/>/g, '&gt;');};mboxStandardFetcher = function() { };mboxStandardFetcher.prototype.getType = function() { return 'standard';};mboxStandardFetcher.prototype.fetch = function(w) { w.setServerType(this.getType()); document.write('<' + 'scr' + 'ipt src="' + w.buildUrl() + '" language="JavaScript"><' + '\/scr' + 'ipt>');};mboxStandardFetcher.prototype.cancel = function() { };mboxAjaxFetcher = function() { };mboxAjaxFetcher.prototype.getType = function() { return 'ajax';};mboxAjaxFetcher.prototype.fetch = function(w) { w.setServerType(this.getType()); var e = w.buildUrl(); this.x = document.createElement('script'); this.x.src = e; document.body.appendChild(this.x);};mboxAjaxFetcher.prototype.cancel = function() { };mboxMap = function() { this.y = new Object(); this.z = new Array();};mboxMap.prototype.put = function(A, h) { if (!this.y[A]) { this.z[this.z.length] = A; } this.y[A] = h;};mboxMap.prototype.get = function(A) { return this.y[A];};mboxMap.prototype.remove = function(A) { this.y[A] = undefined;};mboxMap.prototype.each = function(p) { for (var j = 0; j < this.z.length; j++ ) { var A = this.z[j]; var h = this.y[A]; if (h) { var B = p(A, h); if (B === false) { break; } } }};mboxFactory = function(C, b, D) { this.E = false; this.C = C; this.D = D; this.F = new mboxList(); mboxFactories.put(D, this); this.G = typeof document.createElement('div').replaceChild != 'undefined' && (function() { return true; })() && typeof document.getElementById != 'undefined' && typeof (window.attachEvent || document.addEventListener || window.addEventListener) != 'undefined' && typeof encodeURIComponent != 'undefined'; this.H = this.G && mboxGetPageParameter('mboxDisable') == null; var I = D == 'default'; this.J = new mboxCookieManager( 'mbox' + (I ? '' : ('-' + D)), (function() { return mboxCookiePageDomain(); })()); this.H = this.H && this.J.isEnabled() && (this.J.getCookie('disable') == null); if (this.isAdmin()) { this.enable(); } this.K(); this.L = mboxGenerateId(); this.M = mboxScreenHeight(); this.N = mboxScreenWidth(); this.O = mboxBrowserWidth(); this.P = mboxBrowserHeight(); this.Q = mboxScreenColorDepth(); this.R = mboxBrowserTimeOffset(); this.S = new mboxSession(this.L, 'mboxSession', 'session', 31 * 60, this.J); this.T = new mboxPC('PC', 1209600, this.J); this.w = new mboxUrlBuilder(C, b); this.U(this.w, I); this.V = new Date().getTime(); this.W = this.V; var X = this; this.addOnLoad(function() { X.W = new Date().getTime(); }); if (this.G) { this.addOnLoad(function() { X.E = true; X.getMboxes().each(function(Y) { Y.setFetcher(new mboxAjaxFetcher()); Y.finalize(); }); }); this.limitTraffic(100, 10368000); if (this.H) { this.Z(); this._ = new mboxSignaler(function(ab, c) { return X.create(ab, c); }, this.J); } }};mboxFactory.prototype.isEnabled = function() { return this.H;};mboxFactory.prototype.getDisableReason = function() { return this.J.getCookie('disable');};mboxFactory.prototype.isSupported = function() { return this.G;};mboxFactory.prototype.disable = function(bb, cb) { if (typeof bb == 'undefined') { bb = 60 * 60; } if (typeof cb == 'undefined') { cb = 'unspecified'; } if (!this.isAdmin()) { this.H = false; this.J.setCookie('disable', cb, bb); }};mboxFactory.prototype.enable = function() { this.H = true; this.J.deleteCookie('disable');};mboxFactory.prototype.isAdmin = function() { return document.location.href.indexOf('mboxEnv') != -1;};mboxFactory.prototype.limitTraffic = function(db, bb) {};mboxFactory.prototype.addOnLoad = function(eb) { if (this.isDomLoaded()) { eb(); } else { var fb = false; var gb = function() { if (fb) { return; } fb = true; eb(); }; this.hb.push(gb); if (this.isDomLoaded() && !fb) { gb(); } }};mboxFactory.prototype.getEllapsedTime = function() { return this.W - this.V;};mboxFactory.prototype.getEllapsedTimeUntil = function(ib) { return ib - this.V;};mboxFactory.prototype.getMboxes = function() { return this.F;};mboxFactory.prototype.get = function(ab, jb) { return this.F.get(ab).getById(jb || 0);};mboxFactory.prototype.update = function(ab, c) { if (!this.isEnabled()) { return; } if (!this.isDomLoaded()) { var X = this; this.addOnLoad(function() { X.update(ab, c); }); return; } if (this.F.get(ab).length() == 0) { throw "Mbox " + ab + " is not defined"; } this.F.get(ab).each(function(Y) { Y.getUrlBuilder() .addParameter('mboxPage', mboxGenerateId()); Y.load(c); });};mboxFactory.prototype.create = function( ab, c, kb) { if (!this.isSupported()) { return null; } var e = this.w.clone(); e.addParameter('mboxCount', this.F.length() + 1); e.addParameters(c); var jb = this.F.get(ab).length(); var lb = this.D + '-' + ab + '-' + jb; var mb; if (kb) { mb = new mboxLocatorNode(kb); } else { if (this.E) { throw 'The page has already been loaded, can\'t write marker'; } mb = new mboxLocatorDefault(lb); } try { var X = this; var nb = 'mboxImported-' + lb; var Y = new mbox(ab, jb, e, mb, nb); if (this.H) { Y.setFetcher( this.E ? new mboxAjaxFetcher() : new mboxStandardFetcher()); } Y.setOnError(function(ob, n) { Y.setMessage(ob); Y.activate(); if (!Y.isActivated()) { X.disable(60 * 60, ob); window.location.reload(false); } }); this.F.add(Y); } catch (pb) { this.disable(); throw 'Failed creating mbox "' + ab + '", the error was: ' + pb; } var qb = new Date(); e.addParameter('mboxTime', qb.getTime() - (qb.getTimezoneOffset() * 60000)); return Y;};mboxFactory.prototype.getCookieManager = function() { return this.J;};mboxFactory.prototype.getPageId = function() { return this.L;};mboxFactory.prototype.getPCId = function() { return this.T;};mboxFactory.prototype.getSessionId = function() { return this.S;};mboxFactory.prototype.getSignaler = function() { return this._;};mboxFactory.prototype.getUrlBuilder = function() { return this.w;};mboxFactory.prototype.U = function(e, I) { e.addParameter('mboxHost', document.location.hostname) .addParameter('mboxSession', this.S.getId()); if (!I) { e.addParameter('mboxFactoryId', this.D); } if (this.T.getId() != null) { e.addParameter('mboxPC', this.T.getId()); } e.addParameter('mboxPage', this.L); e.addParameter('screenHeight', this.M); e.addParameter('screenWidth', this.N); e.addParameter('browserWidth', this.O); e.addParameter('browserHeight', this.P); e.addParameter('browserTimeOffset', this.R); e.addParameter('colorDepth', this.Q); e.setUrlProcessAction(function(e) { e += '&mboxURL=' + encodeURIComponent(document.location); var rb = encodeURIComponent(document.referrer); if (e.length + rb.length < 2000) { e += '&mboxReferrer=' + rb; } e += '&mboxVersion=' + mboxVersion; return e; });};mboxFactory.prototype.sb = function() { return "";};mboxFactory.prototype.Z = function() { document.write('<style>.' + 'mboxDefault' + ' { visibility:hidden; }</style>');};mboxFactory.prototype.isDomLoaded = function() { return this.E;};mboxFactory.prototype.K = function() { if (this.hb != null) { return; } this.hb = new Array(); var X = this; (function() { var tb = document.addEventListener ? "DOMContentLoaded" : "onreadystatechange"; var ub = false; var vb = function() { if (ub) { return; } ub = true; for (var i = 0; i < X.hb.length; ++i) { X.hb[i](); } }; if (document.addEventListener) { document.addEventListener(tb, function() { document.removeEventListener(tb, arguments.callee, false); vb(); }, false); window.addEventListener("load", function(){ document.removeEventListener("load", arguments.callee, false); vb(); }, false); } else if (document.attachEvent) { if (self !== self.top) { document.attachEvent(tb, function() { if (document.readyState === 'complete') { document.detachEvent(tb, arguments.callee); vb(); } }); } else { var wb = function() { try { document.documentElement.doScroll('left'); vb(); } catch (xb) { setTimeout(wb, 13); } }; wb(); } } if (document.readyState === "complete") { vb(); } })();};mboxSignaler = function(yb, J) { this.J = J; var zb = J.getCookieNames('signal-'); for (var j = 0; j < zb.length; j++) { var Ab = zb[j]; var Bb = J.getCookie(Ab).split('&'); var Y = yb(Bb[0], Bb); Y.load(); J.deleteCookie(Ab); }};mboxSignaler.prototype.signal = function(Cb, ab ) { this.J.setCookie('signal-' + Cb, mboxShiftArray(arguments).join('&'), 45 * 60);};mboxList = function() { this.F = new Array();};mboxList.prototype.add = function(Y) { if (Y != null) { this.F[this.F.length] = Y; }};mboxList.prototype.get = function(ab) { var B = new mboxList(); for (var j = 0; j < this.F.length; j++) { var Y = this.F[j]; if (Y.getName() == ab) { B.add(Y); } } return B;};mboxList.prototype.getById = function(Db) { return this.F[Db];};mboxList.prototype.length = function() { return this.F.length;};mboxList.prototype.each = function(p) { if (typeof p != 'function') { throw 'Action must be a function, was: ' + typeof(p); } for (var j = 0; j < this.F.length; j++) { p(this.F[j]); }};mboxLocatorDefault = function(g) { this.g = 'mboxMarker-' + g; document.write('<div id="' + this.g + '" style="visibility:hidden;display:none">&nbsp;</div>');};mboxLocatorDefault.prototype.locate = function() { var Eb = document.getElementById(this.g); while (Eb != null) { if (Eb.nodeType == 1) { if (Eb.className == 'mboxDefault') { return Eb; } } Eb = Eb.previousSibling; } return null;};mboxLocatorDefault.prototype.force = function() { var Fb = document.createElement('div'); Fb.className = 'mboxDefault'; var Gb = document.getElementById(this.g); Gb.parentNode.insertBefore(Fb, Gb); return Fb;};mboxLocatorNode = function(Hb) { this.Eb = Hb;};mboxLocatorNode.prototype.locate = function() { return typeof this.Eb == 'string' ? document.getElementById(this.Eb) : this.Eb;};mboxLocatorNode.prototype.force = function() { return null;};mboxCreate = function(ab ) { var Y = mboxFactoryDefault.create( ab, mboxShiftArray(arguments)); if (Y) { Y.load(); } return Y;};mboxDefine = function(kb, ab ) { var Y = mboxFactoryDefault.create(ab, mboxShiftArray(mboxShiftArray(arguments)), kb); return Y;};mboxUpdate = function(ab ) { mboxFactoryDefault.update(ab, mboxShiftArray(arguments));};mbox = function(g, Ib, w, Jb, nb) { this.Kb = null; this.Lb = 0; this.mb = Jb; this.nb = nb; this.Mb = null; this.Nb = new mboxOfferContent(); this.Fb = null; this.w = w; this.message = ''; this.Ob = new Object(); this.Pb = 0; this.Ib = Ib; this.g = g; this.Qb(); w.addParameter('mbox', g) .addParameter('mboxId', Ib); this.Rb = function() {}; this.Sb = function() {}; this.Tb = null;};mbox.prototype.getId = function() { return this.Ib;};mbox.prototype.Qb = function() { if (this.g.length > 250) { throw "Mbox Name " + this.g + " exceeds max length of " + "250 characters."; } else if (this.g.match(/^\s+|\s+$/g)) { throw "Mbox Name " + this.g + " has leading/trailing whitespace(s)."; }};mbox.prototype.getName = function() { return this.g;};mbox.prototype.getParameters = function() { var c = this.w.getParameters(); var B = new Array(); for (var j = 0; j < c.length; j++) { if (c[j].name.indexOf('mbox') != 0) { B[B.length] = c[j].name + '=' + c[j].value; } } return B;};mbox.prototype.setOnLoad = function(p) { this.Sb = p; return this;};mbox.prototype.setMessage = function(ob) { this.message = ob; return this;};mbox.prototype.setOnError = function(Rb) { this.Rb = Rb; return this;};mbox.prototype.setFetcher = function(Ub) { if (this.Mb) { this.Mb.cancel(); } this.Mb = Ub; return this;};mbox.prototype.getFetcher = function() { return this.Mb;};mbox.prototype.load = function(c) { if (this.Mb == null) { return this; } this.setEventTime("load.start"); this.cancelTimeout(); this.Lb = 0; var w = (c && c.length > 0) ? this.w.clone().addParameters(c) : this.w; this.Mb.fetch(w); var X = this; this.Vb = setTimeout(function() { X.Rb('browser timeout', X.Mb.getType()); }, 15000); this.setEventTime("load.end"); return this;};mbox.prototype.loaded = function() { this.cancelTimeout(); if (!this.activate()) { var X = this; setTimeout(function() { X.loaded(); }, 100); }};mbox.prototype.activate = function() { if (this.Lb) { return this.Lb; } this.setEventTime('activate' + ++this.Pb + '.start'); if (this.show()) { this.cancelTimeout(); this.Lb = 1; } this.setEventTime('activate' + this.Pb + '.end'); return this.Lb;};mbox.prototype.isActivated = function() { return this.Lb;};mbox.prototype.setOffer = function(Nb) { if (Nb && Nb.show && Nb.setOnLoad) { this.Nb = Nb; } else { throw 'Invalid offer'; } return this;};mbox.prototype.getOffer = function() { return this.Nb;};mbox.prototype.show = function() { this.setEventTime('show.start'); var B = this.Nb.show(this); this.setEventTime(B == 1 ? "show.end.ok" : "show.end"); return B;};mbox.prototype.showContent = function(Wb) { if (Wb == null) { return 0; } if (this.Fb == null || !this.Fb.parentNode) { this.Fb = this.getDefaultDiv(); if (this.Fb == null) { return 0; } } if (this.Fb != Wb) { this.Xb(this.Fb); this.Fb.parentNode.replaceChild(Wb, this.Fb); this.Fb = Wb; } this.Yb(Wb); this.Sb(); return 1;};mbox.prototype.hide = function() { this.setEventTime('hide.start'); var B = this.showContent(this.getDefaultDiv()); this.setEventTime(B == 1 ? 'hide.end.ok' : 'hide.end.fail'); return B;};mbox.prototype.finalize = function() { this.setEventTime('finalize.start'); this.cancelTimeout(); if (this.getDefaultDiv() == null) { if (this.mb.force() != null) { this.setMessage('No default content, an empty one has been added'); } else { this.setMessage('Unable to locate mbox'); } } if (!this.activate()) { this.hide(); this.setEventTime('finalize.end.hide'); } this.setEventTime('finalize.end.ok');};mbox.prototype.cancelTimeout = function() { if (this.Vb) { clearTimeout(this.Vb); } if (this.Mb != null) { this.Mb.cancel(); }};mbox.prototype.getDiv = function() { return this.Fb;};mbox.prototype.getDefaultDiv = function() { if (this.Tb == null) { this.Tb = this.mb.locate(); } return this.Tb;};mbox.prototype.setEventTime = function(Zb) { this.Ob[Zb] = (new Date()).getTime();};mbox.prototype.getEventTimes = function() { return this.Ob;};mbox.prototype.getImportName = function() { return this.nb;};mbox.prototype.getURL = function() { return this.w.buildUrl();};mbox.prototype.getUrlBuilder = function() { return this.w;};mbox.prototype._b = function(Fb) { return Fb.style.display != 'none';};mbox.prototype.Yb = function(Fb) { this.ac(Fb, true);};mbox.prototype.Xb = function(Fb) { this.ac(Fb, false);};mbox.prototype.ac = function(Fb, bc) { Fb.style.visibility = bc ? "visible" : "hidden"; Fb.style.display = bc ? "block" : "none";};mboxOfferContent = function() { this.Sb = function() {};};mboxOfferContent.prototype.show = function(Y) { var B = Y.showContent(document.getElementById(Y.getImportName())); if (B == 1) { this.Sb(); } return B;};mboxOfferContent.prototype.setOnLoad = function(Sb) { this.Sb = Sb;};mboxOfferAjax = function(Wb) { this.Wb = Wb; this.Sb = function() {};};mboxOfferAjax.prototype.setOnLoad = function(Sb) { this.Sb = Sb;};mboxOfferAjax.prototype.show = function(Y) { var cc = document.createElement('div'); cc.id = Y.getImportName(); cc.innerHTML = this.Wb; var B = Y.showContent(cc); if (B == 1) { this.Sb(); } return B;};mboxOfferDefault = function() { this.Sb = function() {};};mboxOfferDefault.prototype.setOnLoad = function(Sb) { this.Sb = Sb;};mboxOfferDefault.prototype.show = function(Y) { var B = Y.hide(); if (B == 1) { this.Sb(); } return B;};mboxCookieManager = function mboxCookieManager(g, dc) { this.g = g; this.dc = dc == '' || dc.indexOf('.') == -1 ? '' : '; domain=' + dc; this.ec = new mboxMap(); this.loadCookies();};mboxCookieManager.prototype.isEnabled = function() { this.setCookie('check', 'true', 60); this.loadCookies(); return this.getCookie('check') == 'true';};mboxCookieManager.prototype.setCookie = function(g, h, bb) { if (typeof g != 'undefined' && typeof h != 'undefined' && typeof bb != 'undefined') { var fc = new Object(); fc.name = g; fc.value = escape(h); fc.expireOn = Math.ceil(bb + new Date().getTime() / 1000); this.ec.put(g, fc); this.saveCookies(); }};mboxCookieManager.prototype.getCookie = function(g) { var fc = this.ec.get(g); return fc ? unescape(fc.value) : null;};mboxCookieManager.prototype.deleteCookie = function(g) { this.ec.remove(g); this.saveCookies();};mboxCookieManager.prototype.getCookieNames = function(gc) { var hc = new Array(); this.ec.each(function(g, fc) { if (g.indexOf(gc) == 0) { hc[hc.length] = g; } }); return hc;};mboxCookieManager.prototype.saveCookies = function() { var ic = new Array(); var jc = 0; this.ec.each(function(g, fc) { ic[ic.length] = g + '#' + fc.value + '#' + fc.expireOn; if (jc < fc.expireOn) { jc = fc.expireOn; } }); var kc = new Date(jc * 1000); document.cookie = this.g + '=' + ic.join('|') + '; expires=' + kc.toGMTString() + '; path=/' + this.dc;};mboxCookieManager.prototype.loadCookies = function() { this.ec = new mboxMap(); var lc = document.cookie.indexOf(this.g + '='); if (lc != -1) { var mc = document.cookie.indexOf(';', lc); if (mc == -1) { mc = document.cookie.indexOf(',', lc); if (mc == -1) { mc = document.cookie.length; } } var nc = document.cookie.substring( lc + this.g.length + 1, mc).split('|'); var oc = Math.ceil(new Date().getTime() / 1000); for (var j = 0; j < nc.length; j++) { var fc = nc[j].split('#'); if (oc <= fc[2]) { var pc = new Object(); pc.name = fc[0]; pc.value = fc[1]; pc.expireOn = fc[2]; this.ec.put(pc.name, pc); } } }};mboxSession = function(qc, rc, Ab, sc, J) { this.rc = rc; this.Ab = Ab; this.sc = sc; this.J = J; this.tc = false; this.Ib = typeof mboxForceSessionId != 'undefined' ? mboxForceSessionId : mboxGetPageParameter(this.rc); if (this.Ib == null || this.Ib.length == 0) { this.Ib = J.getCookie(Ab); if (this.Ib == null || this.Ib.length == 0) { this.Ib = qc; this.tc = true; } } J.setCookie(Ab, this.Ib, sc);};mboxSession.prototype.getId = function() { return this.Ib;};mboxSession.prototype.forceId = function(uc) { this.Ib = uc; this.J.setCookie(this.Ab, this.Ib, this.sc);};mboxPC = function(Ab, sc, J) { this.Ab = Ab; this.sc = sc; this.J = J; this.Ib = typeof mboxForcePCId != 'undefined' ? mboxForcePCId : J.getCookie(Ab); if (this.Ib != null) { J.setCookie(Ab, this.Ib, sc); }};mboxPC.prototype.getId = function() { return this.Ib;};mboxPC.prototype.forceId = function(uc) { if (this.Ib != uc) { this.Ib = uc; this.J.setCookie(this.Ab, this.Ib, this.sc); return true; } return false;};mboxGetPageParameter = function(g) { var B = null; var vc = new RegExp(g + "=([^\&]*)"); var wc = vc.exec(document.location); if (wc != null && wc.length >= 2) { B = wc[1]; } return B;};mboxSetCookie = function(g, h, bb) { return mboxFactoryDefault.getCookieManager().setCookie(g, h, bb);};mboxGetCookie = function(g) { return mboxFactoryDefault.getCookieManager().getCookie(g);};mboxCookiePageDomain = function() { var dc = (/([^:]*)(:[0-9]{0,5})?/).exec(document.location.host)[1]; var xc = /[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/; if (!xc.exec(dc)) { var yc = (/([^\.]+\.[^\.]{3}|[^\.]+\.[^\.]+\.[^\.]{2})$/).exec(dc); if (yc) { dc = yc[0]; } } return dc ? dc: "";};mboxShiftArray = function(zc) { var B = new Array(); for (var j = 1; j < zc.length; j++) { B[B.length] = zc[j]; } return B;};mboxGenerateId = function() { return (new Date()).getTime() + "-" + Math.floor(Math.random() * 999999);};mboxScreenHeight = function() { return screen.height;};mboxScreenWidth = function() { return screen.width;};mboxBrowserWidth = function() { return (window.innerWidth) ? window.innerWidth : document.documentElement ? document.documentElement.clientWidth : document.body.clientWidth;};mboxBrowserHeight = function() { return (window.innerHeight) ? window.innerHeight : document.documentElement ? document.documentElement.clientHeight : document.body.clientHeight;};mboxBrowserTimeOffset = function() { return -new Date().getTimezoneOffset();};mboxScreenColorDepth = function() { return screen.pixelDepth;};if (typeof mboxVersion == 'undefined') { var mboxVersion = 40; var mboxFactories = new mboxMap(); var mboxFactoryDefault = new mboxFactory('recreationalequipmen.tt.omtrdc.net', 'recreationalequipmen', 'default');};if (mboxGetPageParameter("mboxDebug") != null || mboxFactoryDefault.getCookieManager() .getCookie("debug") != null) { setTimeout(function() { if (typeof mboxDebugLoaded == 'undefined') { alert('Could not load the remote debug.\nPlease check your connection' + ' to Test&amp;Target servers'); } }, 60*60); document.write('<' + 'scr' + 'ipt language="Javascript1.2" src=' + '"http://admin16.testandtarget.omniture.com/admin/mbox/mbox_debug.jsp?mboxServerHost=recreationalequipmen.tt.omtrdc.net' + '&clientCode=recreationalequipmen"><' + '\/scr' + 'ipt>');};mboxScPluginFetcher = function(b, Ac) { this.b = b; this.Ac = Ac;};mboxScPluginFetcher.prototype.Bc = function(w) { w.setBasePath('/m2/' + this.b + '/sc/standard'); this.Cc(w); var e = w.buildUrl(); e += '&scPluginVersion=1'; return e;};mboxScPluginFetcher.prototype.Cc = function(w) { var Dc = [ "dynamicVariablePrefix","visitorID","vmk","ppu","charSet", "visitorNamespace","cookieDomainPeriods","cookieLifetime","pageName", "currencyCode","variableProvider","channel","server", "pageType","transactionID","purchaseID","campaign","state","zip","events", "products","linkName","linkType","resolution","colorDepth", "javascriptVersion","javaEnabled","cookiesEnabled","browserWidth", "browserHeight","connectionType","homepage","pe","pev1","pev2","pev3", "visitorSampling","visitorSamplingGroup","dynamicAccountSelection", "dynamicAccountList","dynamicAccountMatch","trackDownloadLinks", "trackExternalLinks","trackInlineStats","linkLeaveQueryString", "linkDownloadFileTypes","linkExternalFilters","linkInternalFilters", "linkTrackVars","linkTrackEvents","linkNames","lnk","eo" ]; for (var j = 0; j < Dc.length; j++) { this.Ec(Dc[j], w); } for (var j = 1; j <= 75; j++) { this.Ec('prop' + j, w); this.Ec('eVar' + j, w); this.Ec('hier' + j, w); }};mboxScPluginFetcher.prototype.Ec = function(g, w) { var h = this.Ac[g]; if (typeof(h) === 'undefined' || h === null || h === '') { return; } w.addParameter(g, h);};mboxScPluginFetcher.prototype.cancel = function() { };mboxStandardScPluginFetcher = function(b, Ac) { mboxScPluginFetcher.call(this, b, Ac);};mboxStandardScPluginFetcher.prototype = new mboxScPluginFetcher;mboxStandardScPluginFetcher.prototype.getType = function() { return 'standard';};mboxStandardScPluginFetcher.prototype.fetch = function(w) { w.setServerType(this.getType()); var e = this.Bc(w); document.write('<' + 'scr' + 'ipt src="' + e + '" language="JavaScript"><' + '\/scr' + 'ipt>');};mboxAjaxScPluginFetcher = function(b, Ac) { mboxScPluginFetcher.call(this, b, Ac);};mboxAjaxScPluginFetcher.prototype = new mboxScPluginFetcher;mboxAjaxScPluginFetcher.prototype.fetch = function(w) { w.setServerType(this.getType()); var e = this.Bc(w); this.x = document.createElement('script'); this.x.src = e; document.body.appendChild(this.x);};mboxAjaxScPluginFetcher.prototype.getType = function() { return 'ajax';};function mboxLoadSCPlugin(Ac) { if (!Ac) { return null; } Ac.m_tt = function(Ac) { var Fc = Ac.m_i('tt'); Fc.H = true; Fc.b = 'recreationalequipmen'; Fc['_t'] = function() { if (!this.isEnabled()) { return; } var Y = this.Hc(); if (Y) { var Ub = mboxFactoryDefault.isDomLoaded() ? new mboxAjaxScPluginFetcher(this.b, this.s) : new mboxStandardScPluginFetcher(this.b, this.s); Y.setFetcher(Ub); Y.load(); } }; Fc.isEnabled = function() { return this.H && mboxFactoryDefault.isEnabled(); }; Fc.Hc = function() { var ab = this.Ic(); var Fb = document.createElement('DIV'); return mboxFactoryDefault.create(ab, new Array(), Fb); }; Fc.Ic = function() { var Jc = this.s.events && this.s.events.indexOf('purchase') != -1; return 'SiteCatalyst: ' + (Jc ? 'purchase' : 'event'); }; }; return Ac.loadModule('tt');};

/*!
 * jmontgo 2011 Feb:
 * 
 * custom build with minimum necessary for autocomplete
 *
 * please sync/update these files and any others they mention:
 * jquery-ui.tabs.js
 * jquery-ui.accordion.js
 *
 * jQuery UI 1.8.9
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(c,j){function k(a){return!c(a).parents().andSelf().filter(function(){return c.curCSS(this,"visibility")==="hidden"||c.expr.filters.hidden(this)}).length}c.ui=c.ui||{};if(!c.ui.version){c.extend(c.ui,{version:"1.8.9",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,
NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});c.fn.extend({_focus:c.fn.focus,focus:function(a,b){return typeof a==="number"?this.each(function(){var d=this;setTimeout(function(){c(d).focus();b&&b.call(d)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=c.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(c.curCSS(this,
"position",1))&&/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?c(document):a},zIndex:function(a){if(a!==j)return this.css("zIndex",a);if(this.length){a=c(this[0]);for(var b;a.length&&a[0]!==document;){b=a.css("position");
if(b==="absolute"||b==="relative"||b==="fixed"){b=parseInt(a.css("zIndex"),10);if(!isNaN(b)&&b!==0)return b}a=a.parent()}}return 0},disableSelection:function(){return this.bind((c.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});c.each(["Width","Height"],function(a,b){function d(f,g,l,m){c.each(e,function(){g-=parseFloat(c.curCSS(f,"padding"+this,true))||0;if(l)g-=parseFloat(c.curCSS(f,
"border"+this+"Width",true))||0;if(m)g-=parseFloat(c.curCSS(f,"margin"+this,true))||0});return g}var e=b==="Width"?["Left","Right"]:["Top","Bottom"],h=b.toLowerCase(),i={innerWidth:c.fn.innerWidth,innerHeight:c.fn.innerHeight,outerWidth:c.fn.outerWidth,outerHeight:c.fn.outerHeight};c.fn["inner"+b]=function(f){if(f===j)return i["inner"+b].call(this);return this.each(function(){c(this).css(h,d(this,f)+"px")})};c.fn["outer"+b]=function(f,g){if(typeof f!=="number")return i["outer"+b].call(this,f);return this.each(function(){c(this).css(h,
d(this,f,true,g)+"px")})}});c.extend(c.expr[":"],{data:function(a,b,d){return!!c.data(a,d[3])},focusable:function(a){var b=a.nodeName.toLowerCase(),d=c.attr(a,"tabindex");if("area"===b){b=a.parentNode;d=b.name;if(!a.href||!d||b.nodeName.toLowerCase()!=="map")return false;a=c("img[usemap=#"+d+"]")[0];return!!a&&k(a)}return(/input|select|textarea|button|object/.test(b)?!a.disabled:"a"==b?a.href||!isNaN(d):!isNaN(d))&&k(a)},tabbable:function(a){var b=c.attr(a,"tabindex");return(isNaN(b)||b>=0)&&c(a).is(":focusable")}});
c(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));c.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});c.support.minHeight=b.offsetHeight===100;c.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"});c.extend(c.ui,{plugin:{add:function(a,b,d){a=c.ui[a].prototype;for(var e in d){a.plugins[e]=a.plugins[e]||[];a.plugins[e].push([b,d[e]])}},call:function(a,b,d){if((b=a.plugins[b])&&a.element[0].parentNode)for(var e=0;e<b.length;e++)a.options[b[e][0]]&&
b[e][1].apply(a.element,d)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(a,b){if(c(a).css("overflow")==="hidden")return false;b=b&&b==="left"?"scrollLeft":"scrollTop";var d=false;if(a[b]>0)return true;a[b]=1;d=a[b]>0;a[b]=0;return d},isOverAxis:function(a,b,d){return a>b&&a<b+d},isOver:function(a,b,d,e,h,i){return c.ui.isOverAxis(a,d,h)&&c.ui.isOverAxis(b,e,i)}})}})(jQuery);
;/*!
 * jQuery UI Widget 1.8.9
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b,j){if(b.cleanData){var k=b.cleanData;b.cleanData=function(a){for(var c=0,d;(d=a[c])!=null;c++)b(d).triggerHandler("remove");k(a)}}else{var l=b.fn.remove;b.fn.remove=function(a,c){return this.each(function(){if(!c)if(!a||b.filter(a,[this]).length)b("*",this).add([this]).each(function(){b(this).triggerHandler("remove")});return l.call(b(this),a,c)})}}b.widget=function(a,c,d){var e=a.split(".")[0],f;a=a.split(".")[1];f=e+"-"+a;if(!d){d=c;c=b.Widget}b.expr[":"][f]=function(h){return!!b.data(h,
a)};b[e]=b[e]||{};b[e][a]=function(h,g){arguments.length&&this._createWidget(h,g)};c=new c;c.options=b.extend(true,{},c.options);b[e][a].prototype=b.extend(true,c,{namespace:e,widgetName:a,widgetEventPrefix:b[e][a].prototype.widgetEventPrefix||a,widgetBaseClass:f},d);b.widget.bridge(a,b[e][a])};b.widget.bridge=function(a,c){b.fn[a]=function(d){var e=typeof d==="string",f=Array.prototype.slice.call(arguments,1),h=this;d=!e&&f.length?b.extend.apply(null,[true,d].concat(f)):d;if(e&&d.charAt(0)==="_")return h;
e?this.each(function(){var g=b.data(this,a),i=g&&b.isFunction(g[d])?g[d].apply(g,f):g;if(i!==g&&i!==j){h=i;return false}}):this.each(function(){var g=b.data(this,a);g?g.option(d||{})._init():b.data(this,a,new c(d,this))});return h}};b.Widget=function(a,c){arguments.length&&this._createWidget(a,c)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(a,c){b.data(c,this.widgetName,this);this.element=b(c);this.options=b.extend(true,{},this.options,
this._getCreateOptions(),a);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},
widget:function(){return this.element},option:function(a,c){var d=a;if(arguments.length===0)return b.extend({},this.options);if(typeof a==="string"){if(c===j)return this.options[a];d={};d[a]=c}this._setOptions(d);return this},_setOptions:function(a){var c=this;b.each(a,function(d,e){c._setOption(d,e)});return this},_setOption:function(a,c){this.options[a]=c;if(a==="disabled")this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",c);return this},
enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(a,c,d){var e=this.options[a];c=b.Event(c);c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d=d||{};if(c.originalEvent){a=b.event.props.length;for(var f;a;){f=b.event.props[--a];c[f]=c.originalEvent[f]}}this.element.trigger(c,d);return!(b.isFunction(e)&&e.call(this.element[0],c,d)===false||c.isDefaultPrevented())}}})(jQuery);
;/*
 * jQuery UI Position 1.8.9
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */
(function(c){c.ui=c.ui||{};var n=/left|center|right/,o=/top|center|bottom/,t=c.fn.position,u=c.fn.offset;c.fn.position=function(b){if(!b||!b.of)return t.apply(this,arguments);b=c.extend({},b);var a=c(b.of),d=a[0],g=(b.collision||"flip").split(" "),e=b.offset?b.offset.split(" "):[0,0],h,k,j;if(d.nodeType===9){h=a.width();k=a.height();j={top:0,left:0}}else if(d.setTimeout){h=a.width();k=a.height();j={top:a.scrollTop(),left:a.scrollLeft()}}else if(d.preventDefault){b.at="left top";h=k=0;j={top:b.of.pageY,
left:b.of.pageX}}else{h=a.outerWidth();k=a.outerHeight();j=a.offset()}c.each(["my","at"],function(){var f=(b[this]||"").split(" ");if(f.length===1)f=n.test(f[0])?f.concat(["center"]):o.test(f[0])?["center"].concat(f):["center","center"];f[0]=n.test(f[0])?f[0]:"center";f[1]=o.test(f[1])?f[1]:"center";b[this]=f});if(g.length===1)g[1]=g[0];e[0]=parseInt(e[0],10)||0;if(e.length===1)e[1]=e[0];e[1]=parseInt(e[1],10)||0;if(b.at[0]==="right")j.left+=h;else if(b.at[0]==="center")j.left+=h/2;if(b.at[1]==="bottom")j.top+=
k;else if(b.at[1]==="center")j.top+=k/2;j.left+=e[0];j.top+=e[1];return this.each(function(){var f=c(this),l=f.outerWidth(),m=f.outerHeight(),p=parseInt(c.curCSS(this,"marginLeft",true))||0,q=parseInt(c.curCSS(this,"marginTop",true))||0,v=l+p+(parseInt(c.curCSS(this,"marginRight",true))||0),w=m+q+(parseInt(c.curCSS(this,"marginBottom",true))||0),i=c.extend({},j),r;if(b.my[0]==="right")i.left-=l;else if(b.my[0]==="center")i.left-=l/2;if(b.my[1]==="bottom")i.top-=m;else if(b.my[1]==="center")i.top-=
m/2;i.left=Math.round(i.left);i.top=Math.round(i.top);r={left:i.left-p,top:i.top-q};c.each(["left","top"],function(s,x){c.ui.position[g[s]]&&c.ui.position[g[s]][x](i,{targetWidth:h,targetHeight:k,elemWidth:l,elemHeight:m,collisionPosition:r,collisionWidth:v,collisionHeight:w,offset:e,my:b.my,at:b.at})});c.fn.bgiframe&&f.bgiframe();f.offset(c.extend(i,{using:b.using}))})};c.ui.position={fit:{left:function(b,a){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();b.left=
d>0?b.left-d:Math.max(b.left-a.collisionPosition.left,b.left)},top:function(b,a){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();b.top=d>0?b.top-d:Math.max(b.top-a.collisionPosition.top,b.top)}},flip:{left:function(b,a){if(a.at[0]!=="center"){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();var g=a.my[0]==="left"?-a.elemWidth:a.my[0]==="right"?a.elemWidth:0,e=a.at[0]==="left"?a.targetWidth:-a.targetWidth,h=-2*a.offset[0];b.left+=
a.collisionPosition.left<0?g+e+h:d>0?g+e+h:0}},top:function(b,a){if(a.at[1]!=="center"){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();var g=a.my[1]==="top"?-a.elemHeight:a.my[1]==="bottom"?a.elemHeight:0,e=a.at[1]==="top"?a.targetHeight:-a.targetHeight,h=-2*a.offset[1];b.top+=a.collisionPosition.top<0?g+e+h:d>0?g+e+h:0}}}};if(!c.offset.setOffset){c.offset.setOffset=function(b,a){if(/static/.test(c.curCSS(b,"position")))b.style.position="relative";var d=c(b),
g=d.offset(),e=parseInt(c.curCSS(b,"top",true),10)||0,h=parseInt(c.curCSS(b,"left",true),10)||0;g={top:a.top-g.top+e,left:a.left-g.left+h};"using"in a?a.using.call(b,g):d.css(g)};c.fn.offset=function(b){var a=this[0];if(!a||!a.ownerDocument)return null;if(b)return this.each(function(){c.offset.setOffset(this,b)});return u.call(this)}}})(jQuery);
;/*
 * jQuery UI Autocomplete 1.8.9
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */
(function(d){d.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var a=this,b=this.element[0].ownerDocument,f;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!(a.options.disabled||a.element.attr("readonly"))){f=false;var e=d.ui.keyCode;
switch(c.keyCode){case e.PAGE_UP:a._move("previousPage",c);break;case e.PAGE_DOWN:a._move("nextPage",c);break;case e.UP:a._move("previous",c);c.preventDefault();break;case e.DOWN:a._move("next",c);c.preventDefault();break;case e.ENTER:case e.NUMPAD_ENTER:if(a.menu.active){f=true;c.preventDefault()}case e.TAB:if(!a.menu.active)return;a.menu.select(c);break;case e.ESCAPE:a.element.val(a.term);a.close(c);break;default:clearTimeout(a.searching);a.searching=setTimeout(function(){if(a.term!=a.element.val()){a.selectedItem=
null;a.search(null,c)}},a.options.delay);break}}}).bind("keypress.autocomplete",function(c){if(f){f=false;c.preventDefault()}}).bind("focus.autocomplete",function(){if(!a.options.disabled){a.selectedItem=null;a.previous=a.element.val()}}).bind("blur.autocomplete",function(c){if(!a.options.disabled){clearTimeout(a.searching);a.closing=setTimeout(function(){a.close(c);a._change(c)},150)}});this._initSource();this.response=function(){return a._response.apply(a,arguments)};this.menu=d("<ul></ul>").addClass("ui-autocomplete").appendTo(d(this.options.appendTo||
"body",b)[0]).mousedown(function(c){var e=a.menu.element[0];d(c.target).closest(".ui-menu-item").length||setTimeout(function(){d(document).one("mousedown",function(g){g.target!==a.element[0]&&g.target!==e&&!d.ui.contains(e,g.target)&&a.close()})},1);setTimeout(function(){clearTimeout(a.closing)},13)}).menu({focus:function(c,e){e=e.item.data("item.autocomplete");false!==a._trigger("focus",c,{item:e})&&/^key/.test(c.originalEvent.type)&&a.element.val(e.value)},selected:function(c,e){var g=e.item.data("item.autocomplete"),
h=a.previous;if(a.element[0]!==b.activeElement){a.element.focus();a.previous=h;setTimeout(function(){a.previous=h;a.selectedItem=g},1)}false!==a._trigger("select",c,{item:g})&&a.element.val(g.value);a.term=a.element.val();a.close(c);a.selectedItem=g},blur:function(){a.menu.element.is(":visible")&&a.element.val()!==a.term&&a.element.val(a.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");d.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");
this.menu.element.remove();d.Widget.prototype.destroy.call(this)},_setOption:function(a,b){d.Widget.prototype._setOption.apply(this,arguments);a==="source"&&this._initSource();if(a==="appendTo")this.menu.element.appendTo(d(b||"body",this.element[0].ownerDocument)[0]);a==="disabled"&&b&&this.xhr&&this.xhr.abort()},_initSource:function(){var a=this,b,f;if(d.isArray(this.options.source)){b=this.options.source;this.source=function(c,e){e(d.ui.autocomplete.filter(b,c.term))}}else if(typeof this.options.source===
"string"){f=this.options.source;this.source=function(c,e){a.xhr&&a.xhr.abort();a.xhr=d.ajax({url:f,data:c,dataType:"json",success:function(g,h,i){i===a.xhr&&e(g);a.xhr=null},error:function(g){g===a.xhr&&e([]);a.xhr=null}})}}else this.source=this.options.source},search:function(a,b){a=a!=null?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)!==false)return this._search(a)},_search:function(a){this.pending++;
this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){if(!this.options.disabled&&a&&a.length){a=this._normalize(a);this._suggest(a);this._trigger("open")}else this.close();this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",a)}},_change:function(a){this.previous!==
this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(a){if(a.length&&a[0].label&&a[0].value)return a;return d.map(a,function(b){if(typeof b==="string")return{label:b,value:b};return d.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(a){var b=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(b,a);this.menu.deactivate();this.menu.refresh();b.show();this._resizeMenu();b.position(d.extend({of:this.element},this.options.position))},
_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(a,b){var f=this;d.each(b,function(c,e){f._renderItem(a,e)})},_renderItem:function(a,b){return d("<li></li>").data("item.autocomplete",b).append(d("<a></a>").text(b.label)).appendTo(a)},_move:function(a,b){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term);this.menu.deactivate()}else this.menu[a](b);
else this.search(null,b)},widget:function(){return this.menu.element}});d.extend(d.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(a,b){var f=new RegExp(d.ui.autocomplete.escapeRegex(b),"i");return d.grep(a,function(c){return f.test(c.label||c.value||c)})}})})(jQuery);
(function(d){d.widget("ui.menu",{_create:function(){var a=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(b){if(d(b.target).closest(".ui-menu-item a").length){b.preventDefault();a.select(b)}});this.refresh()},refresh:function(){var a=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(b){a.activate(b,d(this).parent())}).mouseleave(function(){a.deactivate()})},activate:function(a,b){this.deactivate();if(this.hasScroll()){var f=b.offset().top-this.element.offset().top,c=this.element.attr("scrollTop"),e=this.element.height();if(f<0)this.element.attr("scrollTop",c+f);else f>=e&&this.element.attr("scrollTop",c+f-e+b.height())}this.active=b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",a,{item:b})},
deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null}},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,b,f){if(this.active){a=this.active[a+"All"](".ui-menu-item").eq(0);
a.length?this.activate(f,a):this.activate(f,this.element.children(b))}else this.activate(f,this.element.children(b))},nextPage:function(a){if(this.hasScroll())if(!this.active||this.last())this.activate(a,this.element.children(".ui-menu-item:first"));else{var b=this.active.offset().top,f=this.element.height(),c=this.element.children(".ui-menu-item").filter(function(){var e=d(this).offset().top-b-f+d(this).height();return e<10&&e>-10});c.length||(c=this.element.children(".ui-menu-item:last"));this.activate(a,
c)}else this.activate(a,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(a){if(this.hasScroll())if(!this.active||this.first())this.activate(a,this.element.children(".ui-menu-item:last"));else{var b=this.active.offset().top,f=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var c=d(this).offset().top-b+f-d(this).height();return c<10&&c>-10});result.length||(result=this.element.children(".ui-menu-item:first"));
this.activate(a,result)}else this.activate(a,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})})(jQuery);
;


/* All Dual licensed under the MIT and GPL licenses: http://www.opensource.org/licenses/mit-license.php, http://www.gnu.org/licenses/gpl.html */

/*Superfish v1.3.1  - jQuery menu widget Copyright (c) 2007 Joel Birch */
/* Custom settings used for delay and speed. REI  5/28/08  delay: 500, speed: 400*/
/* Patched by REI 6/20/2008 */

(function($){
    $.fn.superfish = function(o){
		var $sf = this,
			defaults = {
			hoverClass	: 'sfHover',
			pathClass	: 'overideThisToUse',
			delay		: 500,
			animation	: {opacity:'show'},    
			speed		: 400    
		},
		over = function(){
				clearTimeout(this.sfTimer);
				clearTimeout($sf[0].sfTimer);
				$(this)
				.showSuperfishUl()
				.siblings()
				.hideSuperfishUl();
			},
		out = function(){
				var $$ = $(this);
				if ( !$$.is('.'+o.bcClass) ) {
					this.sfTimer=setTimeout(function(){
						$$.hideSuperfishUl();
						if (!$('.'+o.hoverClass,$sf).length) { 
							over.call($currents.hideSuperfishUl());
						}
					},o.delay);
				}		
			};
		$.fn.extend({
			hideSuperfishUl : function(){
				return this
					.removeClass(o.hoverClass)
					.find('ul:visible')
						.hide()
					.end();
			},
			showSuperfishUl : function(){
				return this
					.addClass(o.hoverClass)
					.find('>ul:hidden')
						.animate(o.animation,o.speed)
					.end();
			},
			applySuperfishHovers : function(){
				return this[($.fn.hoverIntent) ? 'hoverIntent' : 'hover'](over,out);
			}
		});
		o = $.extend({bcClass:'sfbreadcrumb'},defaults,o || {});
		var $currents = $('li:has(ul)',this).filter('.'+o.pathClass);
		if ($currents.length) {
			$currents.each(function(){
				$(this).removeClass(o.pathClass).addClass(o.hoverClass+' '+o.bcClass);
			});
		}
		var $sfHovAr=$('li:has(ul)',this)
			.applySuperfishHovers(over,out)
/* commented out .find('a').each(superfishFocusBlur) for performance - glowney & tguffee 6/08 */
/*			.find('a')
			.each(superfishFocusBlur)
*/			.end()
			.not('.'+o.bcClass)
				.hideSuperfishUl()
			.end();
		$(window).unload(function(){
			$sfHovAr.unbind('mouseover').unbind('mouseout');
		});
		return this.addClass('superfish').blur(function(){
			out.call(this);
		});
	};

function superfishFocusBlur(){
			var $a = $(this), $li = $a.parents('li');
			$a.focus(superfishOverCall).blur(superfishRemoveClass);
}
function superfishOverCall(){
			over.call($li);
			return false;
}		
function superfishRemoveClass(){
			$li.removeClass(o.hoverClass);
}	

/* Copyright (c) 2006 Brandon Aaron (http://brandonaaron.net)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * @name bgiframe
 * @type jQuery
 * @cat Plugins/bgiframe
 *
 * Version 2.1.1
 * Custom settings used for $.extend. REI  5/28/08 top:'-1px',left:'0px',width:'180px' 
 */
$.fn.bgIframe = $.fn.bgiframe = function (s) {
    if ($.browser.msie6) {
        s = $.extend({
            top: '-1px', left: '0px', width: '180px', height: 'auto', opacity: true, src: 'javascript:false;'
        },
        s || {
        });
        var prop = function (n) {
            return n && n.constructor == Number? n + 'px': n;
        },
        html = '<iframe class="bgiframe"frameborder="0"tabindex="-1"src="' + s.src + '"' + 'style="display:block;position:absolute;z-index:-1;' +(s.opacity !== false? 'filter:Alpha(Opacity=\'0\');': '') + 'top:' +(s.top == 'auto'? 'expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+\'px\')': prop(s.top)) + ';' + 'left:' +(s.left == 'auto'? 'expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+\'px\')': prop(s.left)) + ';' + 'width:' +(s.width == 'auto'? 'expression(this.parentNode.offsetWidth+\'px\')': prop(s.width)) + ';' + 'height:' +(s.height == 'auto'? 'expression(this.parentNode.offsetHeight+\'px\')': prop(s.height)) + ';' + '"/>';
        return this.each(function () {
            if ($('> iframe.bgiframe', this).length == 0) {
            this.insertBefore(document.createElement(html), this.firstChild);
            }
        });
    }
    return this;
};

/**
* hoverIntent r5 // 2007.03.27 // jQuery 1.1.2+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne <brian@cherne.net>
* Custom settings used for sensitivity setting. REI  5/28/08 sensitivity:6 
*/
$.fn.hoverIntent=function(f,g){var cfg={sensitivity:6,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY;};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev]);}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev]);};var handleHover=function(e){var p=(e.type=="mouseover"?e.fromElement:e.toElement)||e.relatedTarget;while(p&&p!=this){try{p=p.parentNode;}catch(e){p=this;}}if(p==this){return false;}var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);}if(e.type=="mouseover"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob);},cfg.timeout);}}};return this.mouseover(handleHover).mouseout(handleHover);};

})(jQuery);

// init dropDown from rei.js



/* OnlineOpinion (S3tS v3.1.1) 
Multiple links on same page - support added 10-16-2009 - jvernon
*/

/* This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. */

var custom_var,
_sp = '%3A\\/\\/',
_rp = '%3A//',
_poE = 0.0,
_poX = 0.0,
_sH = screen.height,
_d = document,
_w = window,
_ht = escape(_w.location.href),
_hr = _d.referrer,
_tm = (new Date()).getTime(),
_kp = 0,
_sW = screen.width;
function _fC(_u) {
    _aT = _sp + ',\\/,\\.,-,_,' + _rp + ',%2F,%2E,%2D,%5F';
    _aA = _aT.split(',');
    for (i = 0; i < 5; i++) {
        eval('_u=_u.replace(/' + _aA[i] + '/g,_aA[i+5])')
    }
    return _u
};
function O_LC(new_domain) {
    _domain = _ht.replace('https%3A//', '').replace('http%3A//', '');
    if (typeof new_domain == 'undefined' || new_domain == '') {
        _sp = '%3A\\/\\/';
        _rp = '%3A//'
    } else {
        _sp = '%3A\\/\\/' + _domain.substr(0, _domain.indexOf('/'));
        _rp = '%3A//' + new_domain
    }
    _w.open('https://secure.opinionlab.com/ccc01/comment_card.asp?time1=' + _tm + '&time2=' + (new Date()).getTime() + '&prev=' + _fC(escape(_hr)) + '&referer=' + _fC(_ht) + '&height=' + _sH + '&width=' + _sW + '&custom_var=' + custom_var, 'comments', 'width=535,height=192,screenX=' + ((_sW - 535) / 2) + ',screenY=' + ((_sH - 192) / 2) + ',top=' + ((_sH - 192) / 2) + ',left=' + ((_sW - 535) / 2) + ',resizable=yes,copyhistory=yes,scrollbars=no')
};
function _fPe() {
    if (Math.random() >= 1.0 - _poE) {
        O_LC();
        _poX = 0.0
    }
};
function _fPx() {
    if (Math.random() >= 1.0 - _poX) O_LC()
};
window.onunload = _fPx;
function O_GoT(_p) {
    _d.write('<a href=\'javascript:O_LC()\'>' + _p + '</a>');
    _fPe()
}

/**
 *  jQuery Plugin highlightFade (jquery.offput.ca/highlightFade)
 *  (c) 2006 Blair Mitchelmore (offput.ca) blair@offput.ca
 */
/**
 * This is version 0.7 of my highlightFade plugin. It follows the yellow fade technique of Web 2.0 fame
 * but expands it to allow any starting colour and allows you to specify the end colour as well.
 *
 * For the moment, I'm done with this plug-in. Unless I come upon a really cool feature it should have
 * this plug-in will only receive updates to ensure future compatibility with jQuery.
 *
 * As of now (Aug. 16, 2006) the plugin has been written with the 1.0.1 release of jQuery (rev 249) which
 * is available from http://jquery.com/src/jquery-1.0.1.js
 *
 * A note regarding rgb() syntax: I noticed that most browsers implement rgb syntax as either an integer 
 * (0-255) or percentage (0-100%) value for each field, that is, rgb(i/p,i/p,i/p); however, the W3C 
 * standard clearly defines it as "either three integer values or three percentage values" [http://www.w3.org/TR/CSS21/syndata.html] 
 * which I choose to follow despite the error redundancy of the typical behaviour browsers employ.
 *
 * Changelog:
 *
 *    0.7:
 *        - Added the awesome custom attribute support written by George Adamson (slightly modified)
 *        - Removed bgColor plugin dependency seeing as attr is customizable now...
 *    0.6:
 *        - Abstracted getBGColor into its own plugin with optional test and data retrieval functions
 *        - Converted all $ references to jQuery references as John's code seems to be shifting away
 *          from that and I don't want to have to update this for a long time.
 *    0.5:
 *        - Added simple argument syntax for only specifying start colour of event
 *        - Removed old style argument syntax
 *        - Added 'interval', 'final, and 'end' properties
 *        - Renamed 'color' property to 'start'
 *        - Added second argument to $.highlightFade.getBGColor to bypass the e.highlighting check
 *    0.4:
 *        - Added rgb(%,%,%) color syntax
 *    0.3:
 *        - Fixed bug when event was called while parent was also running event corrupting the
 *          the background colour of the child
 *    0.2:
 *        - Fixed bug where an unspecified onComplete function made the page throw continuous errors
 *        - Fixed bug where multiple events on the same element would speed each subsequent event
 *    0.1:
 *        - Initial Release
 * 
 * @author          Blair Mitchelmore (blair@offput.ca)
 * @version         0.5
 */
jQuery.fn.highlightFade = function(settings) { 
	var o = (settings && settings.constructor == String) ? {start: settings} : settings || {};
	var d = jQuery.highlightFade.defaults;
	var i = o['interval'] || d['interval'];
	var a = o['attr'] || d['attr'];
	var ts = {
		'linear': function(s,e,t,c) { return parseInt(s+(c/t)*(e-s)); },
		'sinusoidal': function(s,e,t,c) { return parseInt(s+Math.sin(((c/t)*90)*(Math.PI/180))*(e-s)); },
		'exponential': function(s,e,t,c) { return parseInt(s+(Math.pow(c/t,2))*(e-s)); }
	};
	var t = (o['iterator'] && o['iterator'].constructor == Function) ? o['iterator'] : ts[o['iterator']] || ts[d['iterator']] || ts['linear'];
	if (d['iterator'] && d['iterator'].constructor == Function) t = d['iterator'];
	return this.each(function() {
		if (!this.highlighting) this.highlighting = {};
		var e = (this.highlighting[a]) ? this.highlighting[a].end : jQuery.highlightFade.getBaseValue(this,a) || [255,255,255];
		var c = jQuery.highlightFade.getRGB(o['start'] || o['colour'] || o['color'] || d['start'] || [255,255,128]);
		var s = jQuery.speed(o['speed'] || d['speed']);
		var r = o['final'] || (this.highlighting[a] && this.highlighting[a].orig) ? this.highlighting[a].orig : jQuery.curCSS(this,a);
		if (o['end'] || d['end']) r = jQuery.highlightFade.asRGBString(e = jQuery.highlightFade.getRGB(o['end'] || d['end']));
		if (typeof o['final'] != 'undefined') r = o['final'];
		if (this.highlighting[a] && this.highlighting[a].timer) window.clearInterval(this.highlighting[a].timer);
		this.highlighting[a] = { steps: ((s.duration) / i), interval: i, currentStep: 0, start: c, end: e, orig: r, attr: a };
		jQuery.highlightFade(this,a,o['complete'],t);
	});
};

jQuery.highlightFade = function(e,a,o,t) {
	e.highlighting[a].timer = window.setInterval(function() { 
		var newR = t(e.highlighting[a].start[0],e.highlighting[a].end[0],e.highlighting[a].steps,e.highlighting[a].currentStep);
		var newG = t(e.highlighting[a].start[1],e.highlighting[a].end[1],e.highlighting[a].steps,e.highlighting[a].currentStep);
		var newB = t(e.highlighting[a].start[2],e.highlighting[a].end[2],e.highlighting[a].steps,e.highlighting[a].currentStep);
		jQuery(e).css(a,jQuery.highlightFade.asRGBString([newR,newG,newB]));
		if (e.highlighting[a].currentStep++ >= e.highlighting[a].steps) {
			jQuery(e).css(a,e.highlighting[a].orig || '');
			window.clearInterval(e.highlighting[a].timer);
			e.highlighting[a] = null;
			if (o && o.constructor == Function) o.call(e);
		}
	},e.highlighting[a].interval);
};

jQuery.highlightFade.defaults = {
	start: [255,255,128],
	interval: 50,
	speed: 400,
	attr: 'backgroundColor'
};

jQuery.highlightFade.getRGB = function(c,d) {
	var result;
	if (c && c.constructor == Array && c.length == 3) return c;
	if (result = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))
		return [parseInt(result[1]),parseInt(result[2]),parseInt(result[3])];
	else if (result = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))
		return [parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55];
	else if (result = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))
		return [parseInt("0x" + result[1]),parseInt("0x" + result[2]),parseInt("0x" + result[3])];
	else if (result = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))
		return [parseInt("0x"+ result[1] + result[1]),parseInt("0x" + result[2] + result[2]),parseInt("0x" + result[3] + result[3])];
	else
		return jQuery.highlightFade.checkColorName(c) || d || null;
};

jQuery.highlightFade.asRGBString = function(a) {
	return "rgb(" + a.join(",") + ")";
};

jQuery.highlightFade.getBaseValue = function(e,a,b) {
	var s, t;
	b = b || false;
	t = a = a || jQuery.highlightFade.defaults['attr'];
	do {
		s = jQuery(e).css(t || 'backgroundColor');
		if ((s  != '' && s != 'transparent') || (e.tagName.toLowerCase() == "body") || (!b && e.highlighting && e.highlighting[a] && e.highlighting[a].end)) break; 
		t = false;
	} while (e = e.parentNode);
	if (!b && e.highlighting && e.highlighting[a] && e.highlighting[a].end) s = e.highlighting[a].end;
	if (s == undefined || s == '' || s == 'transparent') s = [255,255,255];
	return jQuery.highlightFade.getRGB(s);
};

jQuery.highlightFade.checkColorName = function(c) {
	if (!c) return null;
	switch(c.replace(/^\s*|\s*$/g,'').toLowerCase()) {
		case 'aqua': return [0,255,255];
		case 'black': return [0,0,0];
		case 'blue': return [0,0,255];
		case 'fuchsia': return [255,0,255];
		case 'gray': return [128,128,128];
		case 'green': return [0,128,0];
		case 'lime': return [0,255,0];
		case 'maroon': return [128,0,0];
		case 'navy': return [0,0,128];
		case 'olive': return [128,128,0];
		case 'purple': return [128,0,128];
		case 'red': return [255,0,0];
		case 'silver': return [192,192,192];
		case 'teal': return [0,128,128];
		case 'white': return [255,255,255];
		case 'yellow': return [255,255,0];
	}
};

 
// Requirements: 
//	jQuery
//  jQuery.carousel
//  jQuery.highlightFade.js
//  thickbox
//  12:32

function Minicart() {
// Private Properties and Methods   
	var miniCartAvailableArrow = $(document.getElementById('unvHeader'));
	var itemAddedToCartMsg = 0; 
	var m = 0;  // minicart
	var mc = 0; // Minicart Carousel
	var cartData = 0;
	var itemsInCart = 0;
	var cartSubtotal = 0;
	var isVisible = false;
	var isBusy = true;  // Used to prevent internal actions while busy
	var timeoutHide = 0;
	var carouselItems = 0;
	var state = "";
	var originalAddToCartHtml = 0;
	var whenNoLongerBusyFunction = 0;
	var dontHide = false;
	var mclick = false;
	var publicState = "busy";
	var scrollToTopEnabled = true;
	var beforeSubmitFunction = function(){};
	var onCompleteFunction = function(){};
	var onSuccessFunction = function(){};
	var onErrorFunction = function(){};
	var me = this;
	var wlProdRow = null;
	var wlNoteRow = null;
	var toUrl ;
	var template = { 
			images: ["/pix/minicart/arrow_carousel_left.png",
			         "/pix/minicart/arrow_carousel_right.png",
			         "/pix/minicart/carousel_bkgrnd_left.png",
			         "/pix/minicart/carousel_bkgrnd_right.png",
			         "/pix/minicart/checkmark_green.png",
			         "/pix/common/successChkMark_19x18.gif"],	
			minicart : '\
				<div id="minicartContainer">\
					<div id="minicart" class="minicart">\
						<div id="minicartBusy">\
							<div class="loadingMsg"><img src="/pix/minicart/ajax-loader.gif" alt=""/></div>\
						</div>\
						<div id="minicartError">\
							<div class="errorMsg">We\'re unable to display this view of your cart right now. Don\'t worry. This temporary issue doesn\'t affect your cart contents.</div>\
						</div>\
						<div class="minicartMain" id="minicartMain">\
							<h3 class="lineA" style="display:none;"><span id="itemAddedMsg"><img src="/pix/minicart/checkmark_green.png" alt=""/>This Item Was Added to Your Cart</span></h3>\
							<ul id="minicartCarousel" class="minicartCarouselStyle"></ul>\
							<div id="minicartCarouselPlaceholder"></div>\
							<div class="horizdots"> </div>\
							<p id="lineB">Total Items in Cart:&nbsp;&nbsp;<a href="/ShoppingCart?storeId=' + storeId + '" id="minicartQuantity">0</a></p>\
							<div class="horizdots"> </div>\
							<p id="lineC">Merchandise Subtotal:&nbsp;&nbsp;<span id="minicartSubtotal">$0.00</span></p>\
							<div class="horizdots"> </div>\
							<div id="lineD" class="cf">\
								<a href="/CheckoutLoginView?storeId=' + storeId + '" id="minicartCheckoutBtnLink" class="hdrLink_checkoutBtn button primary" style="float:right">checkout</a>\
								<div id="minicartNonBtn"><a href="#" onclick="javascript:minicart.hideCart(); return false;" id="minicartClose">Continue Shopping</a>|<a href="/ShoppingCart?storeId=' + storeId + '" id="minicartViewCart">View Your Cart</a></div>\
							</div>\
							<div id="lineE">\
							</div>\
						</div>\
					</div>\
				</div>',
			carousel : '<ul id="minicartCarousel" class="minicartCarouselStyle"></ul>'
	}; // end template

	// Common support functions
    function ltrim(s){if(typeof(s)!="string"){s = "";}var l=0;while(l<s.length&&s[l]==' '){l++;}return s.substring(l,s.length);}
    function rtrim(s){if(typeof(s)!="string"){s="";}var r=s.length-1;while(r>0&&s[r]==' '){r-=1;}return s.substring(0,r+1);}
    function trim(s){if(typeof(s)!="string"){s="";}return rtrim(ltrim(s));}
    function isBlankString(testString){if(typeof testString=="string"){return(testString=="");}return true;}
    function formatDollars(num) {
    	num = num.toString().replace(/\$|\,/g,'');
    	if(isNaN(num)) num = "0";
    	sign = (num == (num = Math.abs(num)));
    	num = Math.floor(num*100+0.50000000001);
    	cents = num%100;
    	num = Math.floor(num/100).toString();
    	if(cents<10) cents = "0" + cents;
    	for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
    	num = num.substring(0,num.length-(4*i+3))+','+
    	num.substring(num.length-(4*i+3));
    	return (((sign)?'':'-') + '$' + num + '.' + cents);
    }
    function replaceValuesInQuerystring(url,param,value) {
        var re = new RegExp("([?|&])" + param + "=.*?(&|$)","i");
        if (url && url.match(re))
            return url.replace(re,'$1' + param + "=" + value + '$2');
        else
            return url + '&' + param + "=" + value;
    }
    function getValueInQuerystring(url,param) {
    	if (typeof(url)=='string'&&typeof('param')=='string') {
    		var splitUrl = url.split('?');
    		if (splitUrl.length>1) {
    			var vars = splitUrl[1].split("&");
    			for (var i=0;i<vars.length;i++) {
    				var pair = vars[i].split("=");
    				if (pair.length>=1) {
    					if (pair[0]==param) {
    						if (pair.length>1) {
    							return pair[1];
    						} 
    					}
    			  	}
    		  } 
    	  }
    	} 
    	return null;
    }
    String.prototype.wordWrap = function(m, b, c){
        var i, j, l, s, r;
        if(m < 1)
            return this;
        for(i = -1, l = (r = this.split("\n")).length; ++i < l; r[i] += s)
            for(s = r[i], r[i] = ""; s.length > m; r[i] += s.slice(0, j) + ((s = s.slice(j)).length ? b : ""))
                j = c == 2 || (j = s.slice(0, m + 1).match(/\S*(\s)?$/))[1] ? m : j.input.length - j[0].length
                || c == 1 && m || j.input.length + (j = s.slice(m).match(/^\S*/)).input.length;
        return r.join("\n");
    };
    function loadImages(i) {
    	// Background loding minicart images
    	if (i==undefined) i=0;
    	if (i<template.images.length) {
    		$(new Image())
    			.load(function() {loadImages(i+1);})
    			.error(function() {loadImages(i+1);})
    			.attr('src',template.images[i]);
    	} 
    }
    function hide(delay) {
		cancelHide();
		if (!delay) delay=0;
		if (!dontHide) {
			if ((isNaN(delay)||delay==0)&&!isBusy) {
				if (isVisible) {
					setState("busy");
					$(m.find('div.jcarousel-container')).unbind().empty();
					$("#minicartCheckoutBtn").hide();
					itemAddedToCart.hide();
					m.hide();
					isVisible=false;
					setState("ready");
					
					//undo arrow styling when cart closes
					$("#miniCartAvailableArrow", "#topBar_right").removeClass('menuActive');
					$("#miniCartAvailableArrow img", "#topBar_right").attr("src", "/pix/common/arrow_tiny_help_AE9E8B.png");
					$("#miniCartAvailableArrow", "#unvHeader").unbind("mouseenter mouseleave");
					$("#minicartContainer").trigger("hideCart");
					$("h3.lineA").hide();
				}
			}
			else {
				timeoutHide = setTimeout(function() {
				hide(0);
				},delay);
			}
		}
    }
    function scrollToTop() {
    	if (scrollToTopEnabled) {
    		$('html, body').animate({scrollTop:0}, 0);
    	}
    }
    
    function cssModify(fix) {
    	if (typeof(fix)=="string") {
	    	switch(fix.toLowerCase()) {
	    		case "thickbox":
	    			$("#TB_overlay").css({
	    				"z-index":"9070"
	    			});
	    			var TB_window = $("#TB_window").css({
	    				"z-index":"9070"
	    			});
	    			$("#TB_ajaxContent",TB_window).css({
	    				"padding-left":"20px"
	    			});
	    			$("div.splash",TB_window).css({
	    				"margin":"0 15px 0 11px"
	    			});
	    			$("h, p",TB_window).css({
	    				"font":"#333"
	    			});
	    			$("h2",TB_window).css({
	    				"font-size":"14px"
	    			});
	    			$("h1",TB_window).css({
	    				"line-height":"27px",
	    				"margin-top":"20px"
	    			});
	    			$("#acceptCssButton",TB_window).css({"margin-right":"18px"});
	    			$("table.shoppingCart",TB_window).css({"width":"670px"});
	    			$("th.product,td.product",TB_window).css({"text-align":"left"});
	    			$("tr.tr2",TB_window).css({"background-color":"#E5E5E5"});
	    			$("tr.tr0",TB_window).css({"background-color":"#FFFFFF"});
	    			$("ul.productDesc,ul.quantity",TB_window).css({"list-style":"none outside none"});
	    			$("li",TB_window).css({"line-height":"18px"});
	    			$("li a,p a", TB_window).css({"text-decoration":"underline"});
	    			$("li a:link,li a:visited,p a:link,p a:visited", TB_window).css({"color":"#668800"});
	    			break;
	    		case "minicart" :
	    			var userAgent = navigator.userAgent.toLowerCase();
	    			if (/chrome/.test( userAgent )) {
	    				$(".minicartProductName", m).css({"font-size":"11px"});
	    			}
	    			break;

	    	}
    	}
    	
    }
    
    function whileBusy(busyFunction, noLongerBusyFunction) {
    	busyFunction();
    	if ($.isFunction(noLongerBusyFunction)) {
    		whenNoLongerBusyFunction = noLongerBusyFunction;
    	}
    }
    
    function whenNoLongerBusy() {
    	if ($.isFunction(whenNoLongerBusyFunction)) {
    		whenNoLongerBusyFunction();
    		whenNoLongerBusyFunction = 0;
    	}
    }
	
	function itemLoadCallbackFunction(carousel, state) 	{
	}
	
	function flashItemAddedToCart() {
		itemAddedToCart.show();
		$("h3.lineA").show().highlightFade({color:'#F6F4F2',speed:2000,iterator:'sinusoidal'});
	}
	
	function setState(stateProperties) {
		stateProperties = (""+stateProperties).toLowerCase();
		if  (stateProperties.indexOf("busy")>=0) {
			isBusy = true;
			state = "busy";
			if (stateProperties.indexOf("show")>=0) {
				$("#minicartError").hide();
				$("#minicartBusy").show();
				$("#minicartMain").hide();
			}
		} else if (stateProperties.indexOf("ready")>=0) {
			isBusy = false;
			state = "ready";
			if (stateProperties.indexOf("show")>=0) {
				$("#minicartError").hide();
				$("#minicartBusy").hide();
				$("#minicartMain").show();
			} 	
		} else if (stateProperties.indexOf("error")>=0) {
			isBusy = false;
			state = "error";
			if (stateProperties.indexOf("show")>=0) {
				$("#minicartError").show();
				$("#minicartBusy").hide();
				$("#minicartMain").hide();
			} 	
		}
	}
	
	function getState() {
		return state;
	}
	
	function cancelHide() {
		clearTimeout(timeoutHide);
	}
	
	function appendMinicartToContainer() {
		miniCartAvailableArrow.after(template.minicart);
		m = $(document.getElementById('minicartContainer'));
		m.hide();
		mc = 0;
		mOriginalWidth = m.outerWidth();
		itemAddedToCart = $("#itemAddedMsg",m);
		itemAddedToCart.hide();
		$("#minicartClose",m).click(hide);
	}
	
	function compareOrderItemId(thisItem,thatItem){
		//return thatItem.createDate - thisItem.createDate;
		return thatItem.createDateInMilliSec - thisItem.createDateInMilliSec;
	}
	
	function formatTwoLineDescription(s) {
		s = s.wordWrap(24, "|", 1);
		var lines = s.split("|");
		var returnVal = 0;
		returnVal = {"firstLine":trim(lines[0]),"secondLine":null,"thirdLine":null};
		return returnVal;
	}

	function refreshCart() {
		carouselItems = 0;
		var scratch = $(m.find('div.jcarousel-container'));
		if (scratch.length>0) {
			scratch.replaceWith(template.carousel);
		} else {
			$(m.find('#minicartCarousel')).replaceWith(template.carousel);
			$("#minicartCarouselPlaceholder",m).show();
		}
		mc = 0;
		if (cartData!=null&&cartData!=undefined) {
			setState("ready show");
			var html = "";
			var itemQuantity = 0;
			var cartQuantity = 0;
			var itemPrice = 0;
			var itemSalePrice = 0;
			var itemSavedAmount = 0;
			var itemTotalPrice = 0;
			var cartPrice = 0;
			var scratch = 0;
			// For each Item:
			cartData.order.orderItems.sort(compareOrderItemId);
			$.each(cartData.order.orderItems, function(i,item) {
			    var hiddenFlag = item.hiddenFlag;
			    if (hiddenFlag == 1){
			     return;
			    }
				var scratch = parseInt(item.quantity),
				priceInfo = [];
				itemQuantity = (isNaN(scratch))?0:scratch;
				cartQuantity += itemQuantity;
				
				scratch = parseFloat(item.totalProductPrice);
				cartPrice += (isNaN(scratch))?0:scratch;
				
				scratch = parseFloat(item.price);
				itemPrice = (isNaN(scratch))?0:scratch;
				itemSalePrice = parseFloat(item.compareAtPrice).toFixed(2);
				itemSavedAmount = parseFloat(item.totalSavings).toFixed(2);
				itemTotalPrice = parseFloat(item.totalProductPrice).toFixed(2);
				carouselItems++;

				//Build Price Info
				if((itemSavedAmount == 0) || (isNaN(itemSalePrice)) || (isNaN(itemSavedAmount))) {
					priceInfo.push(["Price: ", formatDollars(itemPrice)]);
				}else if (itemSalePrice == 0) {
					priceInfo.push(["Original price: " + "<span class='priceOriginal'>", formatDollars(itemPrice) + "</span>"]);
					priceInfo.push(["<span class='priceSaved'>" + "You save: ", formatDollars(itemSavedAmount) + "</span>"]);
						if (itemTotalPrice != 0) {
							priceInfo.push(["<strong>" + "Unit price: ", formatDollars(itemTotalPrice / itemQuantity) + "</strong>"]);
						} else {
							priceInfo.push(["<strong>" + "Unit price: ", "FREE" + "</strong>"]);
						}
				}else {
					priceInfo.push(["Original price: " + "<span class='priceOriginal'>", formatDollars(itemSalePrice) + "</span>"]);
					priceInfo.push(["<span class='priceSaved'>" + "You save: ", formatDollars(itemSavedAmount) + "</span>"]);
					priceInfo.push(["<strong>" + "Unit price: ", formatDollars(itemPrice) + "</strong>"]);
				}
							
				var itemLi = document.createElement("LI");
				var itemImg = document.createElement("IMG");
				
					var attr = document.createAttribute("height");
					attr.value = "80";
					itemImg.setAttributeNode(attr);
					
					attr = document.createAttribute("width");
					attr.value = "80";
					itemImg.setAttributeNode(attr);
					
					//attr = document.createAttribute("alt");
					//attr.value = item.skuDescription;
					//itemImg.setAttributeNode(attr);
					
					attr = document.createAttribute("src");
					attr.value = "/skuimage/" + item.sku + "/80";
					itemImg.setAttributeNode(attr);
				
				itemLi.appendChild(itemImg);
				
					var itemDiv = document.createElement("DIV");
					var skuDescription = formatTwoLineDescription(item.skuDescription);
					attr = document.createAttribute("class");
					attr.value = "minicartProductName";
					itemDiv.setAttributeNode(attr);
					
					itemDiv.appendChild(document.createTextNode(skuDescription.firstLine));
					if (skuDescription.secondLine) {
						itemDiv.appendChild(document.createElement("br"));
						itemDiv.appendChild(document.createTextNode(skuDescription.secondLine));
						// Ellipses ?
					}
					
					itemDiv.appendChild(document.createElement("br"));
					
					itemDiv.appendChild(document.createTextNode("Quantity: "));
					var _quantity = document.createElement("strong");
					_quantity.appendChild(document.createTextNode(itemQuantity));
					itemDiv.appendChild(_quantity);				
					itemDiv.appendChild(document.createElement("br"));
	
					//Display Price
					for(var i = 0; i < priceInfo.length; i++){
						$(itemDiv).append(
							priceInfo[i][0] + priceInfo[i][1] + '<br />'
						);
					}
		
						var itemA = document.createElement("A");
						
						attr = document.createAttribute("href");
						attr.value = "/ShoppingCart?storeId=" + storeId;
						itemA.setAttributeNode(attr);
						
						itemA.appendChild(document.createTextNode("Edit"));
						
						itemDiv.appendChild(itemA);
						
					itemLi.appendChild(itemDiv);
					
				$("#minicartCarousel",m).append(itemLi);
				
			});
			if (carouselItems>0) {
				$(m.find('#minicartCarousel')).jcarousel({
					"start": 1,
/* jmontgo Jan2011 for @qc2194, see http://sorgalla.com/projects/jcarousel/
window-resize triggers error */
					itemFallbackDimension:248,
					"scroll": 1
                });
				$("#minicartCarouselPlaceholder",m).hide();
			}
			hdrObj.setCartStatus(cartQuantity);
			$("#minicartQuantity",m).text(cartQuantity);
			$("#minicartSubtotal",m).text(formatDollars(cartPrice));
			$("#minicartCheckoutBtnLink").attr("href",$("#checkoutLink").attr("href"));
			$("#minicartCheckoutBtn").css({
				"background":"url(\"/pix/checkout/checkout_button_bkgrnd_orange.png\") no-repeat center center"
			});
			var lastLine = $("lineD");
			$("#minicartViewCart",lastLine).each(function() {
				$(this).mouseover(function() {
					manual_cm_sp();
				});
			});
			
			//set arrow styling when the cart is open
			$(document.getElementById('miniCartAvailableArrow')).addClass('menuActive');
		}
		$(document.getElementById('minicartCheckoutBtn')).show();
		cssModify("minicart");
		
		setState("ready show");
		m.mouseover(function() {
			cancelHide();
		});
		m.mouseout(function() {
			hide(5000);
		});
		hide(5000);
	}
	
	function parseJSON( data ) {
		if ( typeof data !== "string" || !data ) {
			return null;
		}
		// Make sure the incoming data is actual JSON
		// Logic borrowed from http://json.org/json2.js
		if ( /^[\],:{}\s]*$/.test(data.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@")
			.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]")
			.replace(/(?:^|:|,)(?:\s*\[)+/g, "")) ) {

			// Try to use the native JSON parser first
			return window.JSON && window.JSON.parse ?
				window.JSON.parse( data ) :
				(new Function("return " + data))();
		} else {
			return null;
		}
	}
	
	function goWithTheOldFlow(serviceCallURL) {
		var oldUrl = "&URL=" + escape("/minicart?storeId=" + storeId);
		var newUrl = "&URL=" + escape("/ShoppingCart?storeId=" + storeId);
		serviceCallURL = serviceCallURL.replace(oldUrl,newUrl);
		window.location.href = serviceCallURL;
	}

	
	/**
	 * This function adds item to cart and if added successfully then opens the minicart.
	 *  If serviceCallURL is passed, then AJAX call is made to respective URL or web-service for adding items to cart. 
	 *       Currently supports add to cart workflow URLs, '/AddItemToCart & '/REIOrderItemUpdate'.
	 *       Currently supports view cart web service, /minicart = /minicart
	 *       Currently supports add to cart web-service , '/rest/cart/item'.
	 * @param serviceCallURL - The AJAX URL
	 * @param successCallBack - Function to be run if the AJAX call succeeds
	 * @param errorCallback - Function to be run if the AJAX call fails
	 */
	function refreshCartData(serviceCallURL, successCallBack, errorCallBack) 
	{
		var prod = rei.prod;
		beforeSubmitFunction();
		setState("busy show");
		scrollToTop();
		cartData = null;
		
		if(serviceCallURL != null || serviceCallURL != "") 
		{
			serviceCallURL = replaceValuesInQuerystring(serviceCallURL,"URL",escape("/minicart?storeId=" + storeId));
			
			//If calling new Add to cart web service (currently called from product page only), 
			//then make sure guest user token is generated using web service and set in cookie before calling add to cart web service
			if(serviceCallURL.indexOf('/rest/cart/item') != -1)
			{
				_updateCartUsingWebService(serviceCallURL, successCallBack);
			}
			//Using workflow for add to cart
			else
			{
				_updateCartUsingWorkflow(serviceCallURL, successCallBack);
	
			}
		}
		else
		{
			 setState("error show");
			 window.location.href = "/Error";	
		}
		
		
		/**
		 * Function to enable div for displaying the error in minicart
		 */
		function _showErrorState(){
			onErrorFunction();
			setState("error show");
			$("#minicartContainer")
				.css('visibility','none')
				.show();
		};
		
		function _showError(serviceCallURL)
		{
			if(prod && prod.reenableCart)
			{
				prod.reenableCart();
			}
			//If not minicart then show error page
			if(serviceCallURL.indexOf("/minicart") == -1 && serviceCallURL.indexOf("/rest/cart.json") == -1)
			{
				window.location.href = "/Error";
			}
			//For minicart show error in minicart pop up
			else
			{
				_showErrorState();
			}
		};
		
		/**
		 * 	Private function supports the AJAX call for,
		 * 	1>  workflow for adding item to cart 
		 *  2>  showing minicart 
		 * @param serviceCallURL - The AJAX URL
		 * @param successCallBack - Function to be run if the AJAX call succeeds
		 */

		function _updateCartUsingWorkflow(serviceCallURL, successCallBack)
		{
			//Calling AJAX wrapper method of type GET
			rei.services.Read(serviceCallURL,{},{
						dataType: 'text',
						success: function(data)
						{
							var returnedJson = null;
							try {
								returnedJson = parseJSON(data);
							}
							catch (e) {
								_showError(serviceCallURL);
							}
							//Take user to shopping cart, terms & conditions or back order page
							if (returnedJson==null) {
								//Redirect to Shopping Cart when backend returns the Shopping Cart Page.
								// Because the same request for adding an item to cart is being used for
								// the non-javascript and ajax code.
								if(data && (data.indexOf('<meta name="reiShortcut_requestUri" content="/ShoppingCart">') >= 0 || $(data).find("order").length) > 0)
								{
									var sId = window.storeId || "8000";
									window.location.href = '/ShoppingCart?storeId=' + sId;
									return true;
								}	
								//Show T & C page or Back order page
								goWithTheOldFlow(serviceCallURL);
							} 
							//Open minicart
							else {
								try {
									cartData = $.extend(true, {}, returnedJson);
									setState("ready show");
								}
								catch (e){
									_showError(serviceCallURL);
								}
								//Enable 'Add to cart' button
								if ($.isFunction(successCallBack)){
									successCallBack();
								}
								//Show desired page after item is added to cart and minicart shown
								if(toUrl != null && toUrl != '' )
								{
									toUrl = unescape(toUrl);
									window.location.href = toUrl;
								}
							}
						},
						error: function(){
							_showError(serviceCallURL);	
						}
					}
			);	
		};
		
		
		/**
		 * Sets "REI_SESSION_ID" in cookie with expiry of 14 days
		 * @param token
		 */
		function _setGuestUserCookie(token)
		{
			 // set time, it's in milliseconds
		    var today = new Date();
		    today.setTime( today.getTime() );
		    var expires = parseInt(14) * 1000 * 60 * 60 * 24;
		    var expires_date = new Date( today.getTime() + (expires) );
		    document.cookie = "REI_SESSION_ID=" +  token  + ";path=/" +( ( expires ) ? ";expires=" + expires_date.toGMTString() : "" );
		};
		
		
		/**
		 * Private function making AJAX call to add to cart web service
		 * @param serviceCallURL -- add to cart webservice URL
		 * @param successCallBack - Function to be run if the AJAX call succeeds
		 */
		function _updateCartUsingWebService(serviceCallURL, successCallBack)
		{
			//Commented the below call cause it doesn't work with beforeSend
			//rei.services.Create(serviceCallURL,{},{
			jQuery.ajax({
			    type: "POST",
			    url: serviceCallURL,
			    dataType: "json",
						beforeSend:function(){
							//If user isn't logged in and guest cookie not set,
							//then make sure guest user token is generated using web service and is set in cookie before calling add to cart web service
							var loggedInUser = Get_Cookie("REI_SESSION_ID");
							if (loggedInUser == null)
							{
								rei.services.Create('/rest/user/guest',{},{
					    	  		dataType: "text",
					    	  		async: false,
					    			success: function(token){
					    				//Set_Cookie("REI_SESSION_ID", json); Not using Set_Cookie because it escapes the token value due tp which the
					    				// guest user token returned by server doesn't match the one set in browser cookie
					    				//$.cookie("REI_SESSION_ID",token,{path:'/', expires: 10}); Can't use this cause even this encodes the token
					    				_setGuestUserCookie(token);
				
					    			},
					    			error: function(){
					    				_showError(serviceCallURL);
					    			}
					    		});
							}
						},						
						success:function(json, status, xhr){
							try {
									if(xhr != null)
									{
										if(xhr.status == '201' && status == 'success'){
											setState("ready show");
											//Show the moving to cart message for wishlist 
											var wLForm = $("form[id*=wishlistaddtocartform]");
											if(wLForm && $("#owner"))
		    								{
												if(wlNoteRow)
													wlNoteRow.hide();
												if(wlProdRow)
													wlProdRow.html("<td colspan='6'>" + "<p class='wishListCartAction'>" + "Moving to cart!" + "</p>" + "</td>").fadeOut(2000, function () {});															    									
		    								}	
											toUrl = getValueInQuerystring(serviceCallURL,"toUrl");//_getQueryStringParamVal("toUrl");
											//Open minicart	
											minicart.addToCart("/minicart?storeId="+storeId, successCallBack);		
										}
										else{
											_showError(serviceCallURL);
										}
									}
							}
							catch (e){
								_showError(serviceCallURL);
							}
						},
						error: function(xhr){
							if(xhr != null)
							{
								var status = xhr.status;
								var returnedError = jQuery.parseJSON(xhr.responseText); 
								var errorCode = null;
						    	if(returnedError != null)
						    	{
						    		errorCode = returnedError.error[0].code;
						    	}
								//Show back order page
						    	var backOrderErrors = new Array();
						    	backOrderErrors.push(3504);
						    	backOrderErrors.push(3505);
						    	backOrderErrors.push(3506);
						    	
						    	var termsCondErrors = new Array();
						    	termsCondErrors.push(3502);
						    	
						    	//If it isn't error because of backorder or termsconditions, then show error page.
						    	if(jQuery.inArray(errorCode,backOrderErrors) == -1 && jQuery.inArray(errorCode,termsCondErrors) == -1)
						    	{
						    		_showError(serviceCallURL);
						    		return;
						    	}
					    		//Show Terms and Conditions page
						    	//else if(status == '412' && (jQuery.inArray(errorCode,termsCondErrors) != -1  || xhr.responseText.indexOf('3502') != -1))
						    	else if(status == '412' && jQuery.inArray(errorCode,termsCondErrors) != -1)
					    		{
					    			/*var n = document.additem;
					    			n = n.sku;
					    			n = n[n.selectedIndex].value;						    		
					    		    var sku = n + '.json'; */
						    		var sku = getValueInQuerystring(serviceCallURL,"sku") + '.json';//_getQueryStringParamVal("sku") + '.json';
					    			rei.services.Read("/rest/cart/terms/"+sku,{},{
					    				dataType:'text',
					    				success: function(data) {
					    					var splashJson = null;
											try {
												splashJson = parseJSON(data);
												splashText = splashJson.text;
											}
											catch (e) {
												_showError(serviceCallURL);
											}
											
											var splashContent = '<div id="termsFancy" class="splash" style="">'+
																	'<h1 style="">Terms and Conditions: '+ splashJson.categoryTitle+'</h1>'+ 
																	'<h2 style=""> WARNING: Please read carefully before accepting.</h2>'+	
																	 '<div id="splashContent">'+
																	 	splashJson.text +
																	 '</div>'+
																	 '<div class="horizdots2"></div>'+
																	 '<div style="height:90px;">'+
														 			     '<p class="terms">Click to accept the Terms and Conditions and place item in your shopping cart.</p>'+
														 			     '<div id="buttons">'+
														 			     	'<ul style="width:55px;" id="acceptCssButton" class="button">'+
														 			     		'<a href="#" class="medium primary button">Accept</a>'+
														 			     	 '</ul>'+
														 			     	 '<ul style="padding-top:5px;width:0px;height:10px;">or</ul>'+
														 			     	 '<ul style="padding-top:5px;width:0px;height:10px;" id="cancelLink">'+
														 			     	 	'<a href="#">Cancel</a>'+
														 			     	  '</ul>'+
														 			     '</div>'+
														 			  '</div>'+
													 			 '</div>'; 																							
					    					$.fancybox(					    							
					    							splashContent,
					    							{
					    								 autoDimensions: true,	
						    							 padding: 0,
						    							 margin:0,
						    							 scrolling: 'yes',	
					    							    onClosed: function(){
					    									var prod = rei.prod;
					    									if(prod && prod.reenableCart)
					    									{
					    										prod.reenableCart();
					    									}		  
					    								},
					    								onComplete: function(){
					    									$("#acceptCssButton a").bind("click", function(e){
					    										e.preventDefault();					    										
					    										var acceptedURL = "termsCategoryAgreedTo=true";
					    										if(serviceCallURL.indexOf('?') == -1)
					    										{
					    											acceptedURL = serviceCallURL.concat("?", acceptedURL);
					    										}
					    										else
					    										{
					    											acceptedURL = serviceCallURL.concat("&", acceptedURL);
					    										}
					    										_updateCartUsingWebService(acceptedURL);
					    										$.fancybox.close();
					    									});
					    									$("#cancelLink a").bind("click", function(e){
					    										e.preventDefault();
					    										var prod = rei.prod;
					    										if(prod && prod.reenableCart)
					    										{
					    											prod.reenableCart();
					    										}
							    								$.fancybox.close();			    								
					    									});
					    									
					    								}
					    							}
					    					);
					    				},
					    				error: function()
					    				{
					    					serviceCallURL = serviceCallURL.replace('/rest/cart/item','/AddItemToCartController');
							    			goWithTheOldFlow(serviceCallURL);
					    				}
					    			});
					    		
					    			return;
					    		}
						       // else if(status == '412' && (jQuery.inArray(errorCode,backOrderErrors) != -1 
					    		//		|| (xhr.responseText.indexOf('350') != -1 && xhr.responseText.indexOf('3502') == -1)))
						    	else if(status == '412' && jQuery.inArray(errorCode,backOrderErrors) != -1)
					    		{
									//serviceCallURL = serviceCallURL.replace('/rest/cart/item','/AddItemToCartController');
					    			serviceCallURL = serviceCallURL.replace('/rest/cart/item','/backOrderController');
									goWithTheOldFlow(serviceCallURL);
									return;
					    		}
							}
							//Show error page for any other errors
				    		window.location.href = "/Error";
						}
					});
		};//end of update fn
	}//end of refreshCartData fn
		
	
	function modifyAddToCartBehaviours() {
		var membershipSku = "membership";//"36936";

		function addToMinicart() {
		    var qty;
	        for (var i=0; i < document.additem.yourChoice.length; i++){
	        	if (document.additem.yourChoice[i].checked){
	        		qty = document.additem.yourChoice[i].value;
	        	}
	        }
	        if (qty == "useTextInput"){
	            qty = document.additem.quantityTxt.value;
	        }
	        if (isNaN(qty) || qty <= 0) {
	            alert( "Please enter a valid quantity before adding this item to your shopping cart." );
	            return;
	        }
	        document.additem.quantity.value = qty;	        
	    }

		/**
		 * This function adds membership to cart
		 * @param anchor
		 */
		function becomeAMemberAnchor(anchor) {
			var a = $(anchor);
			
			//if (a.attr("href")=="/buyMembership?tracking=mem_dir_mem_pg")
			//	var href = a.attr("href");
				a.attr("href","#");
				a.click( function () {
					var url = "/rest/cart/item?" + 
						"storeId=" + storeId +
					//	"&URL=" + escape("/minicart?storeId=" + storeId) +
						"&quantity=1" + 
					//	"&from_url=ProductPage" +
					//	"&orig_action=REIOrderItemUpdate" + 
					//	"&product_desc=REI%20Membership" +
					//	"&vendor=REI" +
						"&sku=" + membershipSku ;
					//	"&tracking=mem_dir_mem_pg";	
					show(url);
				});
		}		

		function reiOrderItemUpdateAnchor(anchor) {
			if ($("body#shoppingBasket").length==0) { // Don't change links on shopping cart page
				var a = $(anchor);
				var url = $(anchor).attr("href");
				var re1 = /^\/REIOrderItemUpdate?.+/;
				var re2 = /\?URL=ShoppingBasket/;
				var re3 = /&URL=ShoppingBasket/;
				if (url.match(re1)&&(url.match(re2)||url.match(re3))) {
					url=url.replace(re2,"?URL=" + escape("/minicart?storeId=" + storeId));
					url=url.replace(re3,"&URL=" + escape("/minicart?storeId=" + storeId));
					a.attr("href","#");
					a.click( function () {
						show(url);
						return false;
					});
				} else if (url.match(re1)&&!url.match(re2)&&!url.match(re3)) {
					if (url.indexOf("?") > 0) {
						url = url + "&";
					} else {
						url = url + "?";
					}
					url = url + "URL=" + escape("/minicart?storeId=" + storeId);
				}
			}
		}
	
		/**
		 * This function adds wish list items to cart
		 * @param i
		 * @param wishlistAddToCartForm
		 */
		function modifyWishlistAddToCartForm(i,wishlistAddToCartForm) {
			var targetedForm = $(wishlistAddToCartForm);
			var onsubmit = targetedForm.attr("onsubmit");
			if (onsubmit) {
				onsubmit = onsubmit.replace("return ", "");
			}
			targetedForm.removeAttr("onsubmit"); 
			
			targetedForm.submit(function(event){
				event.preventDefault();
				var oldOnSubmitResult = true;
				try {
					// submittedForm = false;
					oldOnSubmitResult = eval(onsubmit);
				}
				catch(e){
					// alert(e);
				}
				if (oldOnSubmitResult)  {
					//$("input[name=URL]",targetedForm).val("/minicart?storeId=" + storeId);
					// Disable all add to carts while i'm busy updating minicart
					//show(targetedForm.attr("action")+ "?" + targetedForm.serialize());
					show('/rest/cart/item'+ "?" + targetedForm.serialize());
				}
				return false;
			});
			$("button",targetedForm).click(function(e)  {
				e.preventDefault();
				targetedForm.submit();
				wlProdRow = $(this).parents("tr#owner");
				wlNoteRow = $(this).parents("tr#owner").next("tr#noteRow");
				//$(this).parents("tr#owner").next("tr#noteRow").hide();
				//$(this).parents("tr#owner").html("<td colspan='6'>" + "<p class='wishListCartAction'>" + "Moving to cart!" + "</p>" + "</td>").fadeOut(2000, function () {});
			});
		}

		function frmOrderYakimaOrThuleFitGuide() {
			var f = $("form[name=frmOrder]");
			if ($("table.rackOrder",f).length>0) {
				var d = $("div.shop2 div.shopCssButton",f);
				var a = $("a.btnStyle1[name!=cancel]:first",f);
				a.attr("href","#").click(function() {
					$("input[name=URL]",f).val("/minicart?storeId=" + storeId);
					whileBusy(function() {
						$("#cartFormButton").enabled = false;
						submittedForm = true;
					},function() {
						$("#cartFormButton").enabled = true;
						submittedForm = false;
					});
					show("/REIOrderItemUpdate?" + f.serialize());
				});
				var a = $("a.btnStyle1[name=cancel]:first",f);
				a.attr("href","/category/4500010");
			}
		}

		/**
		 * This function adds gift card or e-gift card to cart
		 */
		function prepareGiftCertificateAddToCart() {
			
			var giftCardButton = $("a.btnStyle1[name=giftCard]");
			var giftCardAnotherButton = $("a.btnStyle1[name=giftCardAnother]");
			
			var eGiftCardButton = $("a.btnStyle1[name=eGiftCard]");
			var eGiftcardAnotherButton = $("a.btnStyle1[name=eGiftCardAnother]");
			
			
			if(giftCardButton)
			{
				var g_url= giftCardButton.attr("href");
				giftCardButton.bind('click',function(e) {
					_addCardToCart(g_url, e);
				});
			}
			if(giftCardAnotherButton)
			{
				var g_anoUrl= giftCardAnotherButton.attr("href");
				giftCardAnotherButton.bind('click',function(e){
					_addCardToCart(g_anoUrl, e);
				});
			}
			
			if(eGiftCardButton)
			{
				var e_url= eGiftCardButton.attr("href");
				eGiftCardButton.bind('click',function(e) {
					_addCardToCart(e_url, e);
				});
			}
			
			if(eGiftcardAnotherButton)
			{
				var e_anoUrl= eGiftcardAnotherButton.attr("href");
				eGiftcardAnotherButton.bind('click',function(e){
					_addCardToCart(e_anoUrl, e);
				});
			}
			function _addCardToCart(url,e)
			{
				e.preventDefault();
				url = url.replace("/giftCardController","/rest/cart/item");
				show(url);
			}
		}
		
		/**
		 * This function adds gift registry items to cart
		 */
		function rewriteGiftRegistryEditProducts() {
			if ($("#GiftRegistryEditProductsView").length>0||$("#GiftRegistryDetailsView").length>0) {
				getHrefUrl = function(storeId,catalogId,catEntryId,partNumber,registryEntryId,productDesc,quantity,sku ) {
					show("/rest/cart/item?" + 
							//"?URL=" + escape("/minicart?storeId=" + storeId) +
							"storeId=" + storeId +
							//"&catalogId=" + catalogId +
							//"&catEntryId=" + catEntryId +
							"&sku=" + sku +
							"&giftRegistryEntryId=" + registryEntryId +
							//"&product_desc=" + productDesc +
							"&quantity=" + quantity); 
				};
			}
		}
		
		/**
		 * This function is used for DOTD page only (I think)
		 * @param i
		 * @param form
		 */
		function modifyAddItemToCartForm(i,form) {
			var f = $(form);
			if (($("body.prodPageStyle").length>=1)&&($("#prodInventoryView").length==0)&&($("body#termsSplash").length==0)) {
				if (f.attr("id")!="productSelectForm2") {
					// Product Page Context
					var onsubmit = f.attr("onsubmit");
					var onsubmitText = "return true";
					if (onsubmit) {
						onsubmitText = onsubmit.toString();
						onsubmitText = onsubmitText.replace("return", "");
					}
					f.removeAttr("onsubmit");
					f.submit(function(event){
						var oldOnSubmitResult = true;
						try {
							// submittedForm = false;
							oldOnSubmitResult = eval(onsubmitText);
						}
						catch(e){
							var noop=e;
						}
						if (oldOnSubmitResult)  {
							$("input[name=URL]",f).val("/minicart?storeId=" + storeId);
							whileBusy(function() {
								$("#cartFormButton").enabled = false;
								submittedForm = true;
							},function() {
								$("#cartFormButton").enabled = true;
								submittedForm = false;
							});
							//show(f.attr("action")+ "?" + f.serialize());
							show('/rest/cart/item'+ "?" + f.serialize());
						}
						event.preventDefault();
						return false;
					});
				}
			} else if ($("body#prodInventoryView").length>=1||$("#termsSplash").length>=1) {
				// last minute  work around for #1665
				$("input[name=URL]",f).val("/ShoppingCart");
			} else if (false) { 
				// BackorderPages
				// "Sorry. We don't have the quantity you've asked for in stock" Page
				// There are two versions of this page: one with three radio buttons 
				// and the other just has the "buy what's in stock" option.
				var addToCartButton = $("a.btnStyle1",f);
				if (addToCartButton.length>0) {
					var onclick = addToCartButton.attr("onclick");	
					if (onclick) {
						var addToCartIndex = 0;
						var anchorCollection = document.getElementsByTagName("a");
						var foundItem = false;
						$("input[name=URL]",f).val("/minicart?storeId=" + storeId);
						var submitAction = "";
						try {
							while (!foundItem && addToCartIndex<anchorCollection.length) {
								if (anchorCollection[addToCartIndex].className) {
									foundItem = (anchorCollection[addToCartIndex].className.indexOf("btnStyle1")>=0);
								}
								if (!foundItem) addToCartIndex++;
							}
						}
						catch(e) {}

						var onclickText = "";
						if (foundItem) {
							onclickText = anchorCollection[addToCartIndex].onclick.toString();
						} else {
							onclickText = onclick.toString();
						}
						if ($("input[type=radio][name=yourChoice]").length>=3) {
							submitAction = 
								"var f=$(this).parents(\"form:first\");" +
								"var qty = $(\"input[type=radio][name=yourChoice]:checked\").val();" +
								"if (qty == \"useTextInput\"){" +
							        "qty = $(\"#quantityTxt\").val();" +
							    "}" +
								"if (isNaN(qty) || qty <= 0) {" +
						            "alert( \"Please enter a valid quantity before adding this item to your shopping cart.\");" +
						            "return false;" +
								"}" +
								"$(\"input[name=quantity]\",f).val(qty);" + 
								"minicart.addToCart(f.attr(\"action\")+ \"?\" + f.serialize());" +
								"return false;";
						} else {
							submitAction = 
								"var f = $(this).parents(\"form:first\");" +
								"minicart.addToCart(f.attr(\"action\")+ \"?\" + f.serialize());" +
								"return false;";
						}
						if (onclickText.indexOf("document.additem.submit()")>=0) {
							onclickText = onclickText.replace("document.additem.submit()",submitAction);
						} else {
							onclickText = onclickText.replace("addToCart()",submitAction);
						}
						onclickText = onclickText.replace(new RegExp("\\n", "g" )," ");
						var i = onclickText.indexOf("{")+1;
						var j = onclickText.lastIndexOf("}");
						onclickText = onclickText.substring(i, j-1);

						var addToMinicart = new Function("event", onclickText);
						if (foundItem) {
							anchorCollection[addToCartIndex].onclick = addToMinicart;
						} else {
							addToCartButton.click(addToMinicart);
						}
					}
				}				
			}
		}
		
		
		$.each($("form[name=additem],form[action=/AddItemToCartController]"),modifyAddItemToCartForm);
		
		$.each($("a[href*=buyMembership]"), function (i,anchor){
			becomeAMemberAnchor(anchor);
		});

		$.each($("a[href*=REIOrderItemUpdate]"), function (i,anchor){
			reiOrderItemUpdateAnchor(anchor);
		});
		
		$.each($("form[id*=wishlistaddtocartform]"), modifyWishlistAddToCartForm );
		
		frmOrderYakimaOrThuleFitGuide();
		
		prepareGiftCertificateAddToCart();
		
		rewriteGiftRegistryEditProducts();
	}

	function show(serviceCallUrl, successCallback) {
		hdrObj.closeMenu();
		cancelHide();
		if (!isVisible&&!isBusy) {
			setState("busy show");
			if ((serviceCallUrl) ||(!cartData)) {
				publicState = "busy";
				if (serviceCallUrl) {
					refreshCartData(serviceCallUrl, function() {
						setState("ready");
						m.slideDown("fast",  function() {
							isVisible = true;
							flashItemAddedToCart();
							refreshCart();
							whenNoLongerBusy();
							publicState = "ready";
						});
						if ($.isFunction(successCallback)) {
							successCallback();
						}
					});
				} else {
					refreshCartData("/minicart?storeId="+storeId,function() {
						setState("ready");
						m.slideDown("fast",  function() {
							isVisible = true;
							refreshCart();
							whenNoLongerBusy();
							publicState = "ready";
						});
						if ($.isFunction(successCallback)) {
							successCallback();
						}
					});
				}		
			} else {
				m.slideDown("fast",  function() {
					isVisible = true;
					setState("ready show");
					refreshCart();
					publicState = "ready";
				});
			}
		}
		me.setVisibility(true);
		$("#minicartContainer").trigger("showCart");
	}
	
	function addItemAndForward(serviceCallUrl,forwardUrl) {
		if (typeof(serviceCallUrl)=='string'&&typeof(forwardUrl)=='string') {
			hdrObj.closeMenu();
			cancelHide();
			if (!isVisible&&!isBusy) {
				setState("busy show");
				if ((serviceCallUrl) ||(!cartData)) {
					publicState = "busy";
					refreshCartData(serviceCallUrl, function() {
						setState("ready");
						m.slideDown("fast",  function() {
							isVisible = true;
							flashItemAddedToCart();
							refreshCart();
							whenNoLongerBusy();
							publicState = "ready";
							window.location.href = forwardUrl;
						}, false);  
					});
				}
			}
		}
	}
	
	
// Public Methods
	this.setVisibility = function(isVisible){
		$("#minicartContainer").css({visibility:isVisible ==  false ? "hidden" : "visible"});
	}
	this.showCart = function() {
		show();
	};	
	this.hideCart = function(delay) {
		if (isNaN(delay)) {
			hide();
		} else {
			hide(delay);
		}
	};	
	this.addToCart = function(serviceCallUrl,successCallback) {
		$("h3.lineA").show();
		show(serviceCallUrl,successCallback);
	};
	this.addItemAndForward = function(serviceCallUrl,forwardUrl) {
		addItemAndForward(serviceCallUrl,forwardUrl);
	};
	this.getState = getState;
	
	this.isBusy = function() {
		return (publicState=="busy");
	};
	
	this.onComplete = function(f) {
		if ($.isFunction(f)) {
			onCompleteFunction = f;
		}
	};

	this.beforeSubmit = function(f) {
		if ($.isFunction(f)) {
			beforeSubmitFunction = f;
		}
	};

	this.onSuccess = function(f) {
		if ($.isFunction(f)) {
			onSuccessFunction = f;
		}
	};

	this.onError = function(f) {
		if ($.isFunction(f)) {
			onErrorFunction = f;
		}
	};
	this.enableScrollToTop = function(b) {
		if (typeof b == 'boolean') {
			scrollToTopEnabled = true;
		}
	};
	this.disableScrollToTop = function(b) {
		if (typeof b == 'boolean') {
			scrollToTopEnabled = false;
		}
	};
	
	// Initialization Code
	appendMinicartToContainer();
	modifyAddToCartBehaviours();
	loadImages();
	m.click(function(e) { 
		mclick =true;	
	});
	$(document).click( function(){ 
		if (mclick) {
			mclick = false;
		} else {
			setState("ready"); 
			hide();
		}
	});
	
	setState("ready show");
	publicState = "ready";
	
	$(document).keyup = function(e){ 	
		if (e == null) { // ie keycode = event.keyCode;
		} else { // mozilla
			keycode = e.which;
		}
		if(keycode == 27){ // close
			hide();
		}	
	};
	window.document.onload = null;
	
	//Add Minicart Banner
	try{
		var minicartBanner = $.trim($(document.getElementById("gHMessaging")).html());
		if(minicartBanner.length > 0){
			$("#minicartCarousel").before($('<div id="bannerMinicart" />').html(minicartBanner));
		}
	}catch(e){
		rei.error.push(e);
	}
	
}

var minicart=0;
// minicart is initialized from rei.js

 
var setup_cook_obj = ReadGRCookie("GiftRegistrySetup");

//these vars are for the JSP side of things where we don't have those variables at times.
var storeId = storeId || 0;
var storeClass = storeClass || '';

var hdrObj = {
	isModernBrowser: navigator.appName != 'Microsoft Internet Explorer' || $.browser.version > 8,
	isHelpMenu: false,
	helpMenuOpen: false,
	closeTimeout: '',
	noClick: function(e){
		e.preventDefault();
		e.stopPropagation();
	},
	setCartStatus: function(testItemsAmt){
		var miniCartHover ='miniCartHover';
		var miniCartClick = 'miniCartClick';
		testItemsAmt = parseInt((testItemsAmt||numOfItems), 10);
		if (testItemsAmt > 0) {
			if(document.body.className.indexOf('checkout') < 0){		
				$('#ghCartNew').unbind('mouseover').bind('mouseover',function(e){
					$('#ghCartNew').addClass(miniCartHover);
					e.preventDefault();	
					if(hdrObj.isModernBrowser == true){
						if($("#minicartContainer").css('visibility') == 'hidden'){
							if(window.minicart) minicart.showCart();
						}
					}
					else{
						if(window.minicart) minicart.showCart();
					}
					$('#itemAddedMsg').hide();
				}).unbind('mouseout').bind('mouseout', function(e){
					e.preventDefault();	
					if(window.minicart && hdrObj.isModernBrowser) minicart.setVisibility(false);
					$('#ghCartNew').removeClass(miniCartHover);
				}).bind('click', function(){
					$('#ghCartNew').removeClass(miniCartHover).addClass(miniCartClick);
				}); 
				$('#minicartContainer').bind('mouseover', function(e){
					if(hdrObj.isModernBrowser == true) $(this).css({visibility:'visible'});
				}).bind('mouseout', function(e){
					if(hdrObj.isModernBrowser == true) $(this).css({visibility:'hidden'});
				});
				$('#checkoutLink').unbind('mouseover').bind('mouseover',function(e){
					$('#ghCheckout').addClass(miniCartHover);
					e.preventDefault();
				}).unbind('mouseout').bind('mouseout', function(){
					$('#ghCheckout').removeClass(miniCartHover);
				}).bind('click', function(){
					$('#ghCheckout').removeClass(miniCartHover).addClass(miniCartClick);
				}); 
			}
			//Disable checkout button for checkout
			if(typeof rei.analytics[0] == "object" && rei.analytics[0].site_section == 'checkout'){
				hdrObj.checkoutBtnDisable();
			}else{
				hdrObj.checkoutBtnEnable();
			}
		}else{			
			hdrObj.checkoutBtnDisable();
		}
		$('#cartItemCount').html('<div style="margin-top:-3px;">'.concat((testItemsAmt > 999 ? '999+' : testItemsAmt),'</div>'));
		var cicMarginLeft = 180;
		if(testItemsAmt > 999){
			cicMarginLeft -= 12;
		}
		else if(testItemsAmt > 99){
			cicMarginLeft -= 10;			
		}
		else if(testItemsAmt > 9){
			cicMarginLeft -= 6;						
		}
		else{
			cicMarginLeft -= 1;						
			
		}
		if($.browser.msie && $.browser.version < 8){
			$('#ghCartAndCheckout').css({'margin-left':cicMarginLeft});
		}
		//$('#cartItemCount').css({'margin-left': cicMarginLeft});
	},
	//funcs for liveHelp
// TODO revise so now so many redraws
	liveChatOn: function(){
		$(document.getElementById('hdrLink_liveHelp')).css({display:'block'});
	},
	liveChatOff: function(){
		$(document.getElementById('hdrLink_liveHelp')).css({display:'none'});
	},
	checkoutBtnDisable: function(options){
		$([document.getElementById('cartLink'), document.getElementById('checkoutLink')]).attr({'class':'cartLinkInactive'});
		$(document.getElementById('ghDividerCart')).attr({'class':'dividerCartInactive'});
		$(document.getElementById('ghCartAndCheckoutInner')).removeClass('cartActive').addClass('cartInactive');
		$(document.getElementById('cartLink')).bind('click',hdrObj.noClick);
		return $(document.getElementById('checkoutLink')).css("display","block").bind('click',hdrObj.noClick);
	},
	checkoutBtnEnable: function(){
		$([document.getElementById('cartLink'), document.getElementById('checkoutLink')]).attr({'class':'cartLinkActive'});
		$(document.getElementById('ghDividerCart')).attr({'class':'dividerCartActive'});
		$(document.getElementById('ghCartAndCheckoutInner')).removeClass('cartInactive').addClass('cartActive');
		$(document.getElementById('cartLink')).unbind('click',hdrObj.noClick);
		return $(document.getElementById('checkoutLink')).css("display","block").unbind('click',hdrObj.noClick).addClass(' hdrLink_checkoutBtnOns').attr('href', (
				(loggedIn == 1) ? 
				''.concat(httpsHost, 'CheckCart?storeId=', storeId, '&checkInventory=Y')
				:
				''.concat(httpsHost, 'CheckoutLoginView?storeId=', storeId)
			));
	},
	checkoutBtnHide: function(){
		return $(document.getElementById('hdrLink_checkoutBtn')).css("display","none");
	},
	clearCookie: function(){
		document.cookie = 'rei_user_info' + "=" + "" + ";PATH=/";
		hdrObj.checkForUserName();
	},
	//misc funcs for helpMenu functionality
	closeMenu: function(){	
		$(document.getElementById('helpMenu')).css({top: '-500px', display:'none'});
		$(document.getElementById('helpDDL')).removeClass('menuActive').unbind('mouseenter mouseleave');
		hdrObj.helpMenuOpen = false;
	},
	goToURL: function(strUrl){
		document.location.href = strUrl;
	},
	checkCartOption: function(){
		if(document.body.className.indexOf('checkout') < 0){
			if(window.minicart) minicart.showCart();
		}
	},
	init: function(){
	// init called from rei.js
		//TODO, consider moving to rei.js, makes sense to have this set in the rei namespace
		storeId = (storeId == 0 && rei.location.params != null && rei.location.params.storeId != undefined) ? rei.location.params.storeId : "8000";

		if(storeClass == ''){
			storeClass = document.body.className;
			if(storeClass.indexOf('adv') > -1){
				storeClass = 'adv';
			}
			else if(storeClass.indexOf('outlet') > -1){
				storeClass = 'outlet';
			}
			else{
				storeClass = 'rei';
			}
		}
	// setJSEnabledUX()
	var helpMenu = $(document.getElementById('helpMenu'));
	var helpMenuHotSpot = $(document.getElementById('helpDDL'));
	var firstOldBG = $('.first').css('background-color');
	var firstActiveBG = '#ffffff';
	helpMenuHotSpot.mouseover( function(e){
		helpMenuEvent = e;
		var hoverDelay = 0;
		window.setTimeout('showHelpMenu(helpMenuEvent);',hoverDelay);
	});
	helpMenu.hover( 
		function(){//mouseOver
			hdrObj.isHelpMenu = true;
			$('.first').css({'background-color':firstActiveBG});
			helpMenuHotSpot.mouseover(e);
		},
		function(){//mouseOff
			$('.first').css({'background-color':firstOldBG});
			hdrObj.isHelpMenu = false;
			hdrObj.closeMenu();
		}
	);
	helpMenuHotSpot.mouseout( function(e){
		e.preventDefault();
		e.stopPropagation();
		$('.first').css({'background-color':firstOldBG});
		window.setTimeout("eval('if(hdrObj.isHelpMenu == false)hdrObj.closeMenu();')",0);
	});
	//-- add event listeners --				
		$(document).mousedown( function(event){
			try{
			if(!hdrObj.isHelpMenu && $(document.getElementById('helpMenu')).is(":visible") && hdrObj.helpMenuOpen){
				hdrObj.closeMenu();
			}
			}catch(err){}
		});
		$("a#helpMenuCloseButton").click( function(event){
			try{
				if($(document.getElementById('helpMenu')).is(":visible") && hdrObj.helpMenuOpen){
					hdrObj.closeMenu();
				}
				}catch(err){}
			});

	//now do other JSEnabled actions
	hdrObj.setCartStatus();
	hdrObj.checkForUserName();
	$(document.getElementById('hdrLink_liveHelp')).attr('href', 'javascript:'.concat(
		(storeClass == 'adv' || parseInt(storeId) == 8003) ? 'launchAdventureChatPopup();':'launchContactUsPopup("liveHelp_tab");',
		' hdrObj.closeMenu();'
	));
	if(parseInt(getCookie('events_cart'), 10) > 0){
		$(document.getElementById('hdrLink_events')).attr('href', '/DisplayCart');		
	}	
	if(parseInt(loggedIn) == 1){
		$(document.getElementById('hdrLink_orderStatus')).attr('href', '/OrderHistoryView?storeId=' + storeId);
	}

		//this is a fix for MAC firefox, font size is larger on the mac side so the helpMenu does not display the proper padding
	if(navigator.appVersion.indexOf('Macintosh') > 0 && navigator.appCodeName.toLowerCase() == 'mozilla'){
		helpMenu.css('fontSize', '0.9em');
	}
	$(document.getElementById("logOut")).bind("click",function(){
		setCookie("loggedin", "0");
	});
	
	var isWindows = true;
	try{
		isWindows = navigator.platform.toLowerCase().indexOf('win') == 0;
	}
	catch(e){
		
	}
	if(navigator.appName == 'Microsoft Internet Explorer'){
		if($.browser.version > 7){ 
			$('.searchBtn .btnCTA').css({'margin-top':1});
			$('#gHMessaging').css({'margin-top':6}); 
		}	
		else{
			$('.searchBtn .btnCTA').css({'margin-top':0});
		}
		if(hdrObj.isModernBrowser == false){
			$('.searchBtn').css({width:93}).bind('click', function(e){
				e.preventDefault();
				e.stopPropagation();
				$('#psearch').submit();
			});
		}
		else{
			//ie9 and up
			$('.searchBtn').css({width:93});			
		}
	}
	else{
		if(isWindows == false){
			$('.searchBtn').css({width:95});			
		}
	}
	
	//feedback analytics
	$('#opinionLab a').bind('click', function(){
		rei.analytics.sendSpEvent('rei_footerwrapper:-_-feedback-_-' + $(this).text());		
	});
	//end feedback analytics 

	}, // init();
	checkForUserName: function(){
	var userName = getUserInfoCookie('userName');
	if(!userName || userName == '""' || userName == null || userName == ''){
		$(document.getElementById('welcomeUser')).html('Welcome to REI! |').show();
		$(document.getElementById('loginRegister')).show();
		$(document.getElementById('notUser')).hide();
		$(document.getElementById('separatorB')).hide();
		$(document.getElementById('sepRegister')).hide();
		return false;
	}else{
		userName = userName.replace(/[+]/g, " ").substring(0, 20);
		if (loggedIn == 1) {
			//welcomeUser msg
			$(document.getElementById('helloUserName')).html('Hello ' + userName + '! |').show();
			$(document.getElementById('welcomeUser')).html('<a href="/YourAccountInfoInView?storeId=' + storeId + '&amp;stat=header_account">Your Account</a>').show();
			
			//show
			$(document.getElementById('separatorA')).show();
			$(document.getElementById('logOut')).show();
			
			//hide
			$(document.getElementById('loginRegister')).hide();
			$(document.getElementById('separatorB')).hide();
			$(document.getElementById('notUser')).hide();
		}	
		else {
			//welcomeUser msg
			if(userName.length > 0){
				$(document.getElementById('welcomeUser')).html('Hello ' + userName + '!').show();
				$(document.getElementById('hdrLink_notUser')).html('Not ' + userName).click(hdrObj.clearCookie);
				$(document.getElementById('notUser')).show();
				$(document.getElementById('separatorB')).show();
			}
			else{
				//alert('weird condition hit: userName.length >1 and <= ZERO???');
				$(document.getElementById('welcomeUser')).html('Welcome to REI! |').show();
				$(document.getElementById('notUser')).hide();
				$(document.getElementById('separatorB')).hide();
			}
			
			$(document.getElementById('loginRegister')).show();
			$(document.getElementById('logOut')).hide();
		}
	}
	} // checkForUserName()
}; // hdrObj

function showHelpMenu(e){
	try{
		e.preventDefault();
		e.stopPropagation();
	}
	catch(e){
		//ie browsers may land here
	}
	if(window.minicart){ minicart.hideCart(); }

	var hdr = hdrObj;
	hdr.helpMenuOpen = true;
	//trigger hover state to cancel hdrObj.closeMenu() call from document.click handler
	$(document.getElementById('helpDDL')).addClass('menuActive');
	$('.first').css({'background-color':'#ffffff'});
	$(document.getElementById('helpMenu')).show().css({'top':'38px'}).hover( 
		function(){//mouseOver
			hdrObj.isHelpMenu = true;
		},
		function(){//mouseOff
			hdrObj.isHelpMenu = false;
		}
	);
}



$(document).ready(function(){
	//REI Difference 
	//
	var REIDifferenceURL = $('.REIDifference').attr('href');
	var closeButtonClickBound = false;
	$('.REIDifference').fancybox({
		'href': REIDifferenceURL,
		'height': 595,
		'width': 680,
		'type': 'iframe',
		onComplete: function(){
				if(closeButtonClickBound == false){
					$('#fancybox-close').bind('click', function(){
						var s = s_gi(s_account);
						sp_val = 'cm_sp-_-pagecontent-_-rei difference-_-close window';
						s.eVar38=sp_val;
						s.eVar39=rei.analytics.options.page_name;
						s.events= s.linkTrackEvents='event68';
						s.linkTrackVars="eVar38,eVar39,events,";
						s.tl(true,"o",'RE Event');
					});
					closeButtonClickBound = true;
				}
			}
	});
	
	$('.REIDifference').each(function(index){
		$(this).bind('click', function(e){
			var s = s_gi(s_account);
			var sp_val = '';
			if($(this).hasClass('banner') == true){
				sp_val = 'cm_sp-_-banner_bottom-_-pagecontent-_-the rei difference';
				s.eVar3=sp_val;
			}
			else{
				sp_val = 'cm_sp-_-pagecontent-_-product page-_-REI benefits';
				s.eVar3=null;
			}
			s.eVar38=sp_val;
			s.eVar39=rei.analytics.options.page_name;
			s.events= s.linkTrackEvents='event68';
			s.linkTrackVars="eVar38,eVar39,events,";
			if($(this).hasClass('banner') == true){
				s.linkTrackVars+= ',eVar3';
			}
			s.tl(true,"o",'SP Event');
			s.eVar3=null;
		});  		
	});
	
	if(getQuerystring('gps') == 'true'){
		if(getQuerystring('debug') == 'true'){
			rei.gps.debug = true;
		}
		rei.gps.getUserLocation();
		$(document).bind('click', function(){
			$('#zipChangeForm').hide();
		});
	}		
	try{
	}
	catch(e){
		
	}
	
	function getQuerystring(key, default_)
	{
	  if (default_==null) default_=""; 
	  key = key.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
	  var regex = new RegExp("[\\?&]"+key+"=([^&#]*)");
	  var qs = regex.exec(window.location.href);
	  if(qs == null)
	    return default_;
	  else
	    return qs[1];
	}	
});
 
/*
 * FancyBox - jQuery Plugin
 * Simple and fancy lightbox alternative
 *
 * Examples and documentation at: http://fancybox.net
 * 
 * Copyright (c) 2008 - 2010 Janis Skarnelis
 *
 * Version: 1.3.1 (05/03/2010)
 * Requires: jQuery v1.3+
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */

(function(b){var m,u,x,g,D,i,z,A,B,p=0,e={},q=[],n=0,c={},j=[],E=null,s=new Image,G=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,S=/[^\.]\.(swf)\s*$/i,H,I=1,k,l,h=false,y=b.extend(b("<div/>")[0],{prop:0}),v=0,O=!b.support.opacity&&!window.XMLHttpRequest,J=function(){u.hide();s.onerror=s.onload=null;E&&E.abort();m.empty()},P=function(){b.fancybox('<p id="fancybox_error">The requested content cannot be loaded.<br />Please try again later.</p>',{scrolling:"no",padding:20,transitionIn:"none",transitionOut:"none"})},
K=function(){return[b(window).width(),b(window).height(),b(document).scrollLeft(),b(document).scrollTop()]},T=function(){var a=K(),d={},f=c.margin,o=c.autoScale,t=(20+f)*2,w=(20+f)*2,r=c.padding*2;if(c.width.toString().indexOf("%")>-1){d.width=a[0]*parseFloat(c.width)/100-40;o=false}else d.width=c.width+r;if(c.height.toString().indexOf("%")>-1){d.height=a[1]*parseFloat(c.height)/100-40;o=false}else d.height=c.height+r;if(o&&(d.width>a[0]-t||d.height>a[1]-w))if(e.type=="image"||e.type=="swf"){t+=r;
w+=r;o=Math.min(Math.min(a[0]-t,c.width)/c.width,Math.min(a[1]-w,c.height)/c.height);d.width=Math.round(o*(d.width-r))+r;d.height=Math.round(o*(d.height-r))+r}else{d.width=Math.min(d.width,a[0]-t);d.height=Math.min(d.height,a[1]-w)}d.top=a[3]+(a[1]-(d.height+40))*0.5;d.left=a[2]+(a[0]-(d.width+40))*0.5;if(c.autoScale===false){d.top=Math.max(a[3]+f,d.top);d.left=Math.max(a[2]+f,d.left)}return d},U=function(a){if(a&&a.length)switch(c.titlePosition){case "inside":return a;case "over":return'<span id="fancybox-title-over">'+
a+"</span>";default:return'<span id="fancybox-title-wrap"><span id="fancybox-title-left"></span><span id="fancybox-title-main">'+a+'</span><span id="fancybox-title-right"></span></span>'}return false},V=function(){var a=c.title,d=l.width-c.padding*2,f="fancybox-title-"+c.titlePosition;b("#fancybox-title").remove();v=0;if(c.titleShow!==false){a=b.isFunction(c.titleFormat)?c.titleFormat(a,j,n,c):U(a);if(!(!a||a==="")){b('<div id="fancybox-title" class="'+f+'" />').css({width:d,paddingLeft:c.padding,
paddingRight:c.padding}).html(a).appendTo("body");switch(c.titlePosition){case "inside":v=b("#fancybox-title").outerHeight(true)-c.padding;l.height+=v;break;case "over":b("#fancybox-title").css("bottom",c.padding);break;default:b("#fancybox-title").css("bottom",b("#fancybox-title").outerHeight(true)*-1);break}b("#fancybox-title").appendTo(D).hide()}}},W=function(){b(document).unbind("keydown.fb").bind("keydown.fb",function(a){if(a.keyCode==27&&c.enableEscapeButton){a.preventDefault();b.fancybox.close()}else if(a.keyCode==
37){a.preventDefault();b.fancybox.prev()}else if(a.keyCode==39){a.preventDefault();b.fancybox.next()}});if(b.fn.mousewheel){g.unbind("mousewheel.fb");j.length>1&&g.bind("mousewheel.fb",function(a,d){a.preventDefault();h||d===0||(d>0?b.fancybox.prev():b.fancybox.next())})}if(c.showNavArrows){if(c.cyclic&&j.length>1||n!==0)A.show();if(c.cyclic&&j.length>1||n!=j.length-1)B.show()}},X=function(){var a,d;if(j.length-1>n){a=j[n+1].href;if(typeof a!=="undefined"&&a.match(G)){d=new Image;d.src=a}}if(n>0){a=
j[n-1].href;if(typeof a!=="undefined"&&a.match(G)){d=new Image;d.src=a}}},L=function(){i.css("overflow",c.scrolling=="auto"?c.type=="image"||c.type=="iframe"||c.type=="swf"?"hidden":"auto":c.scrolling=="yes"?"auto":"visible");if(!b.support.opacity){i.get(0).style.removeAttribute("filter");g.get(0).style.removeAttribute("filter")}b("#fancybox-title").show();c.hideOnContentClick&&i.one("click",b.fancybox.close);c.hideOnOverlayClick&&x.one("click",b.fancybox.close);c.showCloseButton&&z.show();W();b(window).bind("resize.fb",
b.fancybox.center);c.centerOnScroll?b(window).bind("scroll.fb",b.fancybox.center):b(window).unbind("scroll.fb");b.isFunction(c.onComplete)&&c.onComplete(j,n,c);h=false;X()},M=function(a){var d=Math.round(k.width+(l.width-k.width)*a),f=Math.round(k.height+(l.height-k.height)*a),o=Math.round(k.top+(l.top-k.top)*a),t=Math.round(k.left+(l.left-k.left)*a);g.css({width:d+"px",height:f+"px",top:o+"px",left:t+"px"});d=Math.max(d-c.padding*2,0);f=Math.max(f-(c.padding*2+v*a),0);i.css({width:d+"px",height:f+
"px"});if(typeof l.opacity!=="undefined")g.css("opacity",a<0.5?0.5:a)},Y=function(a){var d=a.offset();d.top+=parseFloat(a.css("paddingTop"))||0;d.left+=parseFloat(a.css("paddingLeft"))||0;d.top+=parseFloat(a.css("border-top-width"))||0;d.left+=parseFloat(a.css("border-left-width"))||0;d.width=a.width();d.height=a.height();return d},Q=function(){var a=e.orig?b(e.orig):false,d={};if(a&&a.length){a=Y(a);d={width:a.width+c.padding*2,height:a.height+c.padding*2,top:a.top-c.padding-20,left:a.left-c.padding-
20}}else{a=K();d={width:1,height:1,top:a[3]+a[1]*0.5,left:a[2]+a[0]*0.5}}return d},N=function(){u.hide();if(g.is(":visible")&&b.isFunction(c.onCleanup))if(c.onCleanup(j,n,c)===false){b.event.trigger("fancybox-cancel");h=false;return}j=q;n=p;c=e;i.get(0).scrollTop=0;i.get(0).scrollLeft=0;if(c.overlayShow){O&&b("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"});
x.css({"background-color":c.overlayColor,opacity:c.overlayOpacity}).unbind().show()}l=T();V();if(g.is(":visible")){b(z.add(A).add(B)).hide();var a=g.position(),d;k={top:a.top,left:a.left,width:g.width(),height:g.height()};d=k.width==l.width&&k.height==l.height;i.fadeOut(c.changeFade,function(){var f=function(){i.html(m.contents()).fadeIn(c.changeFade,L)};b.event.trigger("fancybox-change");i.empty().css("overflow","hidden");if(d){i.css({top:c.padding,left:c.padding,width:Math.max(l.width-c.padding*
2,1),height:Math.max(l.height-c.padding*2-v,1)});f()}else{i.css({top:c.padding,left:c.padding,width:Math.max(k.width-c.padding*2,1),height:Math.max(k.height-c.padding*2,1)});y.prop=0;b(y).animate({prop:1},{duration:c.changeSpeed,easing:c.easingChange,step:M,complete:f})}})}else{g.css("opacity",1);if(c.transitionIn=="elastic"){k=Q();i.css({top:c.padding,left:c.padding,width:Math.max(k.width-c.padding*2,1),height:Math.max(k.height-c.padding*2,1)}).html(m.contents());g.css(k).show();if(c.opacity)l.opacity=
0;y.prop=0;b(y).animate({prop:1},{duration:c.speedIn,easing:c.easingIn,step:M,complete:L})}else{i.css({top:c.padding,left:c.padding,width:Math.max(l.width-c.padding*2,1),height:Math.max(l.height-c.padding*2-v,1)}).html(m.contents());g.css(l).fadeIn(c.transitionIn=="none"?0:c.speedIn,L)}}},F=function(){m.width(e.width);m.height(e.height);if(e.width=="auto")e.width=m.width();if(e.height=="auto")e.height=m.height();N()},Z=function(){h=true;e.width=s.width;e.height=s.height;b("<img />").attr({id:"fancybox-img",
src:s.src,alt:e.title}).appendTo(m);N()},C=function(){J();var a=q[p],d,f,o,t,w;e=b.extend({},b.fn.fancybox.defaults,typeof b(a).data("fancybox")=="undefined"?e:b(a).data("fancybox"));o=a.title||b(a).title||e.title||"";if(a.nodeName&&!e.orig)e.orig=b(a).children("img:first").length?b(a).children("img:first"):b(a);if(o===""&&e.orig)o=e.orig.attr("alt");d=a.nodeName&&/^(?:javascript|#)/i.test(a.href)?e.href||null:e.href||a.href||null;if(e.type){f=e.type;if(!d)d=e.content}else if(e.content)f="html";else if(d)if(d.match(G))f=
"image";else if(d.match(S))f="swf";else if(b(a).hasClass("iframe"))f="iframe";else if(d.match(/#/)){a=d.substr(d.indexOf("#"));f=b(a).length>0?"inline":"ajax"}else f="ajax";else f="inline";e.type=f;e.href=d;e.title=o;if(e.autoDimensions&&e.type!=="iframe"&&e.type!=="swf"){e.width="auto";e.height="auto"}if(e.modal){e.overlayShow=true;e.hideOnOverlayClick=false;e.hideOnContentClick=false;e.enableEscapeButton=false;e.showCloseButton=false}if(b.isFunction(e.onStart))if(e.onStart(q,p,e)===false){h=false;
return}m.css("padding",20+e.padding+e.margin);b(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){b(this).replaceWith(i.children())});switch(f){case "html":m.html(e.content);F();break;case "inline":b('<div class="fancybox-inline-tmp" />').hide().insertBefore(b(a)).bind("fancybox-cleanup",function(){b(this).replaceWith(i.children())}).bind("fancybox-cancel",function(){b(this).replaceWith(m.children())});b(a).appendTo(m);F();break;case "image":h=false;b.fancybox.showActivity();
s=new Image;s.onerror=function(){P()};s.onload=function(){s.onerror=null;s.onload=null;Z()};s.src=d;break;case "swf":t='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+e.width+'" height="'+e.height+'"><param name="movie" value="'+d+'"></param>';w="";b.each(e.swf,function(r,R){t+='<param name="'+r+'" value="'+R+'"></param>';w+=" "+r+'="'+R+'"'});t+='<embed src="'+d+'" type="application/x-shockwave-flash" width="'+e.width+'" height="'+e.height+'"'+w+"></embed></object>";m.html(t);
F();break;case "ajax":a=d.split("#",2);f=e.ajax.data||{};if(a.length>1){d=a[0];if(typeof f=="string")f+="&selector="+a[1];else f.selector=a[1]}h=false;b.fancybox.showActivity();E=b.ajax(b.extend(e.ajax,{url:d,data:f,error:P,success:function(r){if(E.status==200){m.html(r);F()}}}));break;case "iframe":b('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" scrolling="'+e.scrolling+'" src="'+e.href+'"></iframe>').appendTo(m);N();break}},$=function(){if(u.is(":visible")){b("div",
u).css("top",I*-40+"px");I=(I+1)%12}else clearInterval(H)},aa=function(){if(!b("#fancybox-wrap").length){b("body").append(m=b('<div id="fancybox-tmp"></div>'),u=b('<div id="fancybox-loading"><div></div></div>'),x=b('<div id="fancybox-overlay"></div>'),g=b('<div id="fancybox-wrap"></div>'));if(!b.support.opacity){g.addClass("fancybox-ie");u.addClass("fancybox-ie")}D=b('<div id="fancybox-outer"></div>').append('<div class="fancy-bg" id="fancy-bg-n"></div><div class="fancy-bg" id="fancy-bg-ne"></div><div class="fancy-bg" id="fancy-bg-e"></div><div class="fancy-bg" id="fancy-bg-se"></div><div class="fancy-bg" id="fancy-bg-s"></div><div class="fancy-bg" id="fancy-bg-sw"></div><div class="fancy-bg" id="fancy-bg-w"></div><div class="fancy-bg" id="fancy-bg-nw"></div>').appendTo(g);
D.append(i=b('<div id="fancybox-inner"></div>'),z=b('<a id="fancybox-close"></a>'),A=b('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),B=b('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));z.click(b.fancybox.close);u.click(b.fancybox.cancel);A.click(function(a){a.preventDefault();b.fancybox.prev()});B.click(function(a){a.preventDefault();b.fancybox.next()});if(O){x.get(0).style.setExpression("height",
"document.body.scrollHeight > document.body.offsetHeight ? document.body.scrollHeight : document.body.offsetHeight + 'px'");u.get(0).style.setExpression("top","(-20 + (document.documentElement.clientHeight ? document.documentElement.clientHeight/2 : document.body.clientHeight/2 ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop )) + 'px'");D.prepend('<iframe id="fancybox-hide-sel-frame" src="javascript:\'\';" scrolling="no" frameborder="0" ></iframe>')}}};
b.fn.fancybox=function(a){b(this).data("fancybox",b.extend({},a,b.metadata?b(this).metadata():{})).unbind("click.fb").bind("click.fb",function(d){d.preventDefault();if(!h){h=true;b(this).blur();q=[];p=0;d=b(this).attr("rel")||"";if(!d||d==""||d==="nofollow")q.push(this);else{q=b("a[rel="+d+"], area[rel="+d+"]");p=q.index(this)}C();return false}});return this};b.fancybox=function(a,d){if(!h){h=true;d=typeof d!=="undefined"?d:{};q=[];p=d.index||0;if(b.isArray(a)){for(var f=0,o=a.length;f<o;f++)if(typeof a[f]==
"object")b(a[f]).data("fancybox",b.extend({},d,a[f]));else a[f]=b({}).data("fancybox",b.extend({content:a[f]},d));q=jQuery.merge(q,a)}else{if(typeof a=="object")b(a).data("fancybox",b.extend({},d,a));else a=b({}).data("fancybox",b.extend({content:a},d));q.push(a)}if(p>q.length||p<0)p=0;C()}};b.fancybox.showActivity=function(){clearInterval(H);u.show();H=setInterval($,66)};b.fancybox.hideActivity=function(){u.hide()};b.fancybox.next=function(){return b.fancybox.pos(n+1)};b.fancybox.prev=function(){return b.fancybox.pos(n-
1)};b.fancybox.pos=function(a){if(!h){a=parseInt(a,10);if(a>-1&&j.length>a){p=a;C()}if(c.cyclic&&j.length>1&&a<0){p=j.length-1;C()}if(c.cyclic&&j.length>1&&a>=j.length){p=0;C()}}};b.fancybox.cancel=function(){if(!h){h=true;b.event.trigger("fancybox-cancel");J();e&&b.isFunction(e.onCancel)&&e.onCancel(q,p,e);h=false}};b.fancybox.close=function(){function a(){x.fadeOut("fast");g.hide();b.event.trigger("fancybox-cleanup");i.empty();b.isFunction(c.onClosed)&&c.onClosed(j,n,c);j=e=[];n=p=0;c=e={};h=false}
if(!(h||g.is(":hidden"))){h=true;if(c&&b.isFunction(c.onCleanup))if(c.onCleanup(j,n,c)===false){h=false;return}J();b(z.add(A).add(B)).hide();b("#fancybox-title").remove();g.add(i).add(x).unbind();b(window).unbind("resize.fb scroll.fb");b(document).unbind("keydown.fb");i.css("overflow","hidden");if(c.transitionOut=="elastic"){k=Q();var d=g.position();l={top:d.top,left:d.left,width:g.width(),height:g.height()};if(c.opacity)l.opacity=1;y.prop=1;b(y).animate({prop:0},{duration:c.speedOut,easing:c.easingOut,
step:M,complete:a})}else g.fadeOut(c.transitionOut=="none"?0:c.speedOut,a)}};b.fancybox.resize=function(wi,he){var a;if(!(h||g.is(":hidden"))){h=true;a=i.wrapInner("<div style='overflow:auto'></div>").children();if(he==undefined)he=a.height();if(wi!=undefined){g.css({width:wi+c.padding*2});i.css({width:wi});}g.css({height:he+c.padding*2+v});i.css({height:he});a.replaceWith(a.children());b.fancybox.center()}}; b.fancybox.center=function(){h=true;var a=K(),d=c.margin,f={};f.top=a[3]+(a[1]-(g.height()-v+40))*0.5;f.left=a[2]+(a[0]-(g.width()+40))*0.5;f.top=Math.max(a[3]+d,f.top);f.left=Math.max(a[2]+d,f.left);g.css(f);h=false};b.fn.fancybox.defaults={padding:10,margin:20,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.3,overlayColor:"#666",titleShow:true,titlePosition:"outside",titleFormat:null,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",
easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,onStart:null,onCancel:null,onComplete:null,onCleanup:null,onClosed:null};b(window).load(function(){aa()})})(jQuery);


function launch_chat_form()
{
    var chat_form_url = "/rei/livehelp/memformsecure1.html";
	var firstName = $(document.getElementById("firstName"));
	var chk = document.chk;
	if(!firstName.length && !chk) return;
	window.open(
	((!firstName.length) ? 
	chat_form_url.concat(
		"?bill_safname=", chk.bill_safname.value,
		"&amp;bill_salname=", chk.bill_salname.value,
		"&amp;bill_saaddr1=", chk.bill_saaddr1.value,
		"&amp;bill_sacity=", chk.bill_sacity.value,
		"&amp;bill_sazipc=", chk.bill_sazipc.value,
		"&amp;bill_saphone1=", chk.bill_saphone1.value,
		"&amp;bill_saemail1=", chk.bill_saemail1.value,
		"&amp;cm_sp=checkout*livehelp*general"
	): chat_form_url.concat(
		"?bill_safname=", firstName.val(),
		"&amp;bill_salname=", $(document.getElementById("lastName")).val(),
		"&amp;bill_saphone1=", $(document.getElementById("phone")).val(),
		"&amp;bill_saemail1=", $(document.getElementById("emailAddress")).val()
	)),"chat_form","width=600,height=425,scrollbars=1");
}
var isMemberChat,
isServiceChat,
isMemberLookUpChat,
isGearChat,
isOrderChat,
isAdventureChat;
function launchMemberChatPopup() {
	isMemberChat = 'yes';
	launchChatPopup();
}
function launchServiceChatPopup() {
	isServiceChat = 'yes';
	launchChatPopup();
}

function launchMemberLookupChatPopup(arrCustInfo, fromWhere) {
	isMemberLookUpChat = 'yes';
	//need to get variables from lookup tool
	if(arrCustInfo){ launchChatPopup(arrCustInfo, fromWhere); }
	else{ launchChatPopup(); }
}


function launchGearChatPopup() {

	isGearChat = 'yes';
	launchChatPopup();
}

function launchOrderChatPopup() {

	isOrderChat = 'yes';
	launchChatPopup();
}

function launchAdventureChatPopup() {

	isAdventureChat = 'yes';
	launchChatPopup();
}

function launchChatPopup(custCheckoutInfo, doWhat) {
	var winW;
	var winH;
	var newH;
	var loadPage;
	
	if (isMemberChat == 'yes'){
		loadPage = 'memformsecure1.html?cm_sp=checkout*livehelp*general';
		isMemberChat = '';
	}
	else if (isServiceChat == 'yes'){
		loadPage = 'memformsecure_service.html';
		isServiceChat = '';
	}	
	else if (isMemberLookUpChat == 'yes'){
		loadPage = 'memformsecure1.html';		
		if(custCheckoutInfo){
			if(doWhat == 'checkout' || doWhat == 'adventures'){
				loadPage += "?bill_safname=" + custCheckoutInfo[0] + "&bill_salname=" + custCheckoutInfo[1] + "&bill_saaddr1=" + custCheckoutInfo[2] + "&bill_sacity=" + custCheckoutInfo[3] + "&bill_sastate=" + custCheckoutInfo[4]  + "&bill_sazipc=" + custCheckoutInfo[5] + "&bill_saphone1=" + custCheckoutInfo[6] + "&bill_saemail1=" + custCheckoutInfo[7];
			}
			else if(doWhat == 'support' || doWhat == 'divLookupForm'){
				loadPage += "?bill_safname=" + custCheckoutInfo[0] + "&bill_salname=" + custCheckoutInfo[1] + "&bill_saemail1=" + custCheckoutInfo[2] + "&bill_saphone1=" + custCheckoutInfo[3];
			}
			else{}			
		}
		isMemberLookUpChat = '';
	}		
	else if (isGearChat == 'yes'){
		loadPage = 'genformsecure_gear.html';
		isGearChat = '';
	}
	else if (isOrderChat == 'yes'){
		loadPage = 'genformsecure_order.html';
		isOrderChat = '';
	}
	else if (isAdventureChat == 'yes'){
		loadPage = 'genformsecure_adventure.html';
		isAdventureChat = '';
	}
	else {
		loadPage = 'genformsecure.html?cm_sp=checkout*livehelp*general';
	}
// set a default target height for the window in case we can't calculate one dynamically

	var targetH = 425;

// set default height and width for the screen in case we can't sniff one

	var screenW = 600;
	var screenH = 425;

// get the screen width and height to make sure we don't size things inappropriately



// get window width and height. if we get it, we reset the default target height to
// the current window height.
// first property is IE implementation, second is Moz/Gecko/Saf.
// Moz/Gecko/Saf recognize IE function, but some return bad numbers, so
// calling it second corrects the var values.



// calculate the difference in height between the screen and the window



// we only resize the window if it's too tall to display the popup...

// ...or if it's so short that we think it will need to be resized to cover the popup


// set the new window height

// resize the parent window



// now we get the parent window position and move if absolutely necessary to work well with the popup.
// if we can't get it, we'll move the window to the top left by default

	topP = 1;
	leftP = 1;

// first method Moz/Gecko (Safari?), second method IE. For IE we can only get the position of the display screen,
// so we additionally subtract the height and width of the window frame and toolbars with default installation settings.



// failsafe to correct for unfriendly IE behavior


	
// move parent window and reset it to be resizable, which is sometimes loses in IE



// set top position and tweak width for chat popup window

	var chatTopP = topP + targetH;
	var chatW = winW - 8;
        self.name = "new";
	
//	var chatUrl = httpHost + '/rei/livehelp/genformsecure.html?cm_sp=checkout*livehelp*general'; replaces the line below this for interim.
	var chatUrl = '/rei/livehelp/' + loadPage;
	var newWindow = 'chatPopup';
//	var openParams ='width=800' + chatW +',height=300, top =' + chatTopP + ', left=10' + leftP;

	var openParams ='width=600' + chatW +',height=425, top =' + chatTopP + ', left=10' + leftP + ',resizable=1,scrollbars=1';
	
	chatPopupOpen = window.open(chatUrl, newWindow, openParams);
	if(window.focus){
		chatPopupOpen.focus();
	}
}

function launchContactUsPopup(activeTab) {
	// this opens the contact us popup window from /xsl/help/helpContacts.xsl
	
	var loadPage = '/helpContacts';
	if (activeTab) { loadPage = loadPage + '#' + activeTab; }
	var newWindow = 'chatPopup';
	var openParams = "width=600,height=500,titlebar=no,resizable=1,scrollbars=1";
	
	var chatPopupOpen = window.open(loadPage, newWindow, openParams);
	if(window.focus){
		chatPopupOpen.focus();
	}
}

function ii_AnimObj(){this.moveTimer=null;
this.hideTimer=null;this.prx=0;this.pry=0;this.flx=10;this.fly=10;this.flw=0;this.flh=0;this.flpos=0;this.flopac=0;this.flfade=0;
}function ii_getIEel(){if(document.compatMode&&document.compatMode=="BackCompat"){return(document.body);}else{return((document.documentElement&&typeof document.documentElement.scrollTop!="undefined")?document.documentElement:document.body);
}}function ii_reset(){var A=ii_getIEel();ii_Anim.prx=((ii_Var.MZ)?window.pageXOffset:A.scrollLeft)+ii_Anim.flx;ii_Anim.pry=((ii_Var.MZ)?window.pageYOffset:A.scrollTop)+ii_Anim.fly;
}function ii_mark(){var E=ii_Var;var D=ii_Anim;if(!E.MZ&&!E.IE){return ;}var B=ii_getIEel();var A=(E.MZ)?window.innerWidth:B.offsetWidth;
var C=(E.MZ)?window.innerHeight:B.offsetHeight;if((D.flpos%3)==0){D.flx=A-D.flw-30;}if((D.flpos%3)==1){D.flx=10;}if((D.flpos%3)==2){D.flx=Math.round(((A-20)/2)-(D.flw/2));
}if(D.flpos<4){D.fly=10;}else{if(D.flpos<7){D.fly=Math.round(((C-20)/2)-(D.flh/2));}else{if(D.flpos<10){D.fly=C-40-D.flh;
}}}}function ii_move(){var C=ii_Var;var D=ii_Anim;var A=ii_getIEel();var B=((C.MZ)?window.pageXOffset:A.scrollLeft)+D.flx;
var H=((C.MZ)?window.pageYOffset:A.scrollTop)+D.fly;var J=Math.abs(B-D.prx);var I=Math.abs(H-D.pry);var E=Math.sqrt(J*J+I*I);
var F=Math.round(E/20)+2;if(B>D.prx){D.prx=D.prx+F;}if(B<D.prx){D.prx=D.prx-F;}if(H>D.pry){D.pry=D.pry+F;}if(H<D.pry){D.pry=D.pry-F;
}var G=document.getElementById("invitelayer");(C.MZ)?G.style.left=D.prx+"px":G.style.posLeft=D.prx;(C.MZ)?G.style.top=D.pry+"px":G.style.posTop=D.pry;
if(!ii_Anim.islteIE6){(C.MZ)?G.style.MozOpacity=D.flopac/100:G.style.filter="alpha(opacity="+D.flopac+")";D.flopac+=D.flfade;
if(D.flopac<0){D.flopac=0;}if(D.flopac>100){D.flopac=100;}}}function ii_getDomain(){var B=document.domain;if(ii_matchRegExp(B,"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$")){return(B);
}var A=B.split(".");if(A.length==3){B=A[1]+"."+A[2];}else{if(A.length>3){B=A[A.length-3]+"."+A[A.length-2]+"."+A[A.length-1];
}}return(B);}function ii_callServer(F,E){var D=(ii_callServer.arguments.length==3)?ii_callServer.arguments[2]:window;var C=D.document.getElementsByTagName("head").item(0);
var A=D.document.getElementById(F);if(A){C.removeChild(A);}var B=document.createElement("script");B.src=E;B.type="text/javascript";
B.defer=true;B.id=F;void (C.appendChild(B));}function ii_getProtocol(){return((document.location.href.toLowerCase().indexOf("https")==0)?"https":"http");
}function ii_getCookie(D){var B=D+"=";var G=B.length;var A=document.cookie.length;var E=0;while(E<A){var C=E+G;if(document.cookie.substring(E,C)==B){var F=document.cookie.indexOf(";",C);
if(F==-1){F=document.cookie.length;}return unescape(document.cookie.substring(C,F));}E=document.cookie.indexOf(" ",E)+1;if(E==0){break;
}}return(null);}function ii_setCookie(C,D){var A=ii_setCookie.arguments;var E=ii_setCookie.arguments.length;var B=(E>2)?A[2]:null;
document.cookie=C+"="+escape(D)+((B==null)?"":("; expires="+B.toGMTString()))+"; path=/"+((ii_Var.domain==null||ii_Var.domain=="")?"":("; domain="+ii_Var.domain));
}function ii_upGSV(C,F){var A=false;var B="";var E=ii_getCookie(ii_Var.GSV_COOKIE);E=(E==null)?[]:E.split("_");if(typeof (F)=="string"){F=F.replace(/\-/g,"%2D");
F=F.replace(/\_/g,"%5F");}for(var D=0;D<E.length;D++){if((E[D].split("-"))[0]==C){E[D]=C+"-"+F;A=true;break;}}if(!A){E[E.length]=C+"-"+F;
}for(D=0;D<E.length;D++){B+=E[D];if(D<E.length-1){B+="_";}}ii_setCookie(ii_Var.GSV_COOKIE,B,null);}function ii_getGSV(A){var D=ii_getCookie(ii_Var.GSV_COOKIE);
D=(D==null)?[]:D.split("_");for(var B=0;B<D.length;B++){if((D[B].split("-"))[0]==A){var C=(D[B].split("-"))[1];C=C.replace(/\%2D/g,"-");
C=C.replace(/\%5F/g,"_");return(C);}}return("");}function ii_upHLArr(C,E,B){var A=false;for(var D=0;D<C.length;D++){if(C[D][0]==E){if(B==1||B==2||B==3){if(C[D][B]==""){C[D][B]=1;
}else{C[D][B]=parseInt(C[D][B],10)+1;}}if(B==4){C[D][B]=parseInt(new Date().getTime()/1000);}A=true;break;}}if(!A){C[C.length]=[E,"","","",""];
if(B==1||B==2||B==3){C[C.length-1][B]=1;}if(B==4){C[C.length-1][B]=parseInt(new Date().getTime()/1000);}}}function ii_getHLArr(B,E,A){var D=null;
for(var C=0;C<B.length;C++){if(B[C][0]==E){D=parseInt(B[C][A],10);if(isNaN(D)){D=null;}break;}}return(D);}function ii_wrapHL(){var C=ii_Var;
var B=C.publ+"-"+C.pgvis+"-"+C.randid+"_";for(var A=0;A<C.phl.length;A++){B+=C.phl[A][0]+"-"+C.phl[A][1]+"-"+C.phl[A][2];
if(A<C.phl.length-1){B+="+";}}B+="_";for(var A=0;A<C.ihl.length;A++){B+=C.ihl[A][0]+"-"+C.ihl[A][1]+"-"+C.ihl[A][2]+"-"+C.ihl[A][3]+"-"+C.ihl[A][4];
if(A<C.ihl.length-1){B+="+";}}B+="_";for(var A=0;A<C.cpml.length;A++){B+=C.cpml[A];if(A<C.cpml.length-1){B+="-";}}B+="_";
for(var A=0;A<C.ppml.length;A++){B+=C.ppml[A];if(A<C.ppml.length-1){B+="-";}}ii_setCookie(C.HIST_COOKIE,B,C.HIST_COOKIE_EXP);
}function ii_unwrapHL(){var F=ii_Var;var C=ii_getCookie(F.HIST_COOKIE);C=(C!=null)?C.split("_"):[];if(C.length==0){return ;
}var B=C[0].split("-");F.publ=B[0];F.pgvis=B[1];F.randid=B[2];F.phl=[];if(C[1].length>0){B=C[1].split("+");for(var D=0;D<B.length;
D++){var E=B[D].split("-");F.phl[F.phl.length]=[E[0],E[1],E[2]];}}F.ihl=[];if(C[2].length>0){B=C[2].split("+");for(var D=0;
D<B.length;D++){var A=B[D].split("-");F.ihl[F.ihl.length]=[A[0],A[1],A[2],A[3],A[4]];}}F.cpml=[];if(C[3].length>0){B=C[3].split("-");
for(var D=0;D<B.length;D++){F.cpml[F.cpml.length]=B[D];}}F.ppml=[];if(C[4].length>0){B=C[4].split("-");for(var D=0;D<B.length;
D++){F.ppml[F.ppml.length]=B[D];}}}function ii_resetHistCookie(){ii_setCookie(ii_Var.HIST_COOKIE,"0-0-0____",ii_Var.HIST_COOKIE_EXP);
}function ii_resetGSVCookie(){ii_upGSV("DPL",0);ii_upGSV("TES",parseInt(new Date().getTime()/1000));ii_upGSV("PCT",parseInt(new Date().getTime()/1000));
ii_upGSV("GeoIP","*");ii_upGSV("GeoCo","");ii_upGSV("GeoRg","");ii_upGSV("GeoCt","");ii_upGSV("GeoNs","");ii_upGSV("GeoDm","");
}function ii_initGeoIP(){var A=ii_Var;if(ii_getGSV("GeoIP")!="*"){A.geoinit=1;}if(window.isgeoipapi_ip_addr!=undefined&&A.geoinit==0){A.geoinit=1;
ii_upGSV("GeoIP",window.isgeoipapi_ip_addr);ii_upGSV("GeoCo",(window.isgeoipapi_country_code!=undefined)?window.isgeoipapi_country_code:"");
ii_upGSV("GeoRg",(window.isgeoipapi_region!=undefined)?window.isgeoipapi_region:"");ii_upGSV("GeoCt",(window.isgeoipapi_city!=undefined)?window.isgeoipapi_city:"");
ii_upGSV("GeoNs",(window.isgeoipapi_netspeed!=undefined)?window.isgeoipapi_netspeed:"");ii_upGSV("GeoDm",(window.isgeoipapi_domain!=undefined)?window.isgeoipapi_domain:"");
}if(A.geoip==null&&A.geoinit==1){A.geoip=ii_getGSV("GeoIP");A.geoco=ii_getGSV("GeoCo");A.georg=ii_getGSV("GeoRg");A.geoct=ii_getGSV("GeoCt");
A.geons=ii_getGSV("GeoNs");A.geodm=ii_getGSV("GeoDm");A.tmes=ii_getGSV("TES");}}function ii_getIPRange(C){var B=null;var A=ii_matchRegExp(C,"^([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(\\/([0-1]?[0-9]?|[1-2][0-9]|3[0-2]))?$");
if(A!=null){var D=ii_matchRegExp(A[1],"^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$");if(D[1]!=null&&D[1]<=255&&D[2]<=255&&D[3]<=255&&D[4]<=255){B=[A[1],(A[2]==undefined||A[2]=="")?"32":A[3]];
}}return(B);}function ii_ipCheck(G,E,C){var D=G.split(".");var A=(D[0]*16777216)+(D[1]*65536)+(D[2]*256)+(D[3]*1);var F=E.split(".");
var H=(F[0]*16777216)+(F[1]*65536)+(F[2]*256)+(F[3]*1);var B=((4294967295<<(32-C))&4294967295);return((A&B)==(H&B));}function ii_doAvailCheck(D,F,C){var G=ii_Var;
if(D==1){G.checkDeptID=C;if(C==-2){C="Default";}}else{if(typeof (window[C])!="undefined"){G.checkDeptID=window[C];C=window[C];
if(C=="-2"){C="Default";}}else{ii_noshow();return ;}}G.checkState=F;for(var B=0;B<G.deptavail.length;B++){if(G.deptavail[B][0]==G.checkDeptID){if(G.deptavail[B][1]==G.checkState){availOnLoad(null);
}else{availOnError(null);}return ;}}var E=parseInt(new Date().getTime()/1000);var A=(G.checkState==2?"un":"")+"available.gif";
G.availImg.src=ii_getProtocol()+"://"+G.rsvr+"/resources/smartbutton/"+G.accountid+"/"+C+"/"+A+"?src=ii3&ts="+E;}function availOnLoad(A){var D=ii_Var;
var C=false;for(var B=0;B<D.deptavail.length;B++){if(D.deptavail[B][0]==D.checkDeptID){D.deptavail[B][1]=D.checkState;C=true;
break;}}if(!C){D.deptavail[D.deptavail.length]=[D.checkDeptID,D.checkState];}D.checkDeptID=0;D.checkState=0;ii_show();}function availOnError(A){var D=ii_Var;
var C=false;for(var B=0;B<D.deptavail.length;B++){if(D.deptavail[B][0]==D.checkDeptID){D.deptavail[B][1]=(D.checkState==0?1:0);
C=true;break;}}if(!C){D.deptavail[D.deptavail.length]=[D.checkDeptID,(D.checkState==0?1:0)];}D.checkDeptID=0;D.checkState=0;
ii_noshow();}function ii_noshow(){var B=ii_Var;if(B.trigru>0){var A=ii_getRuleOrInv(ii_Rules,B.trigru);if(A[9]==1){ii_executeRuleTriggeredEvent(A[10],A[11],A[12],A[0],A[4]);
}if(A[3]>=2){if(window.ISVT_onInviteNotOffered&&A[2]!=0){ISVT_onInviteNotOffered(B.trigru,A[2]);}ii_stop();}else{ii_continue(B.evalidx,100);
}}}function ii_show(){var F=ii_Var;if(F.trigru>0){var E=ii_getRuleOrInv(ii_Rules,F.trigru);var A=ii_getRuleOrInv(ii_Inv,E[2]);
if(E[9]==1){ii_executeRuleTriggeredEvent(E[10],E[11],E[12],E[0],E[4]);}if(A!=null){F.invtoshow=A[0];if(A[2]==3){ii_display();
}else{var D=null;var C=null;var B=null;if(navigator.appName.indexOf("Microsoft")!=-1&&navigator.platform.indexOf("Mac")!=-1){D=document.createElement("IMG");
C=document.createElement("IMG");B=document.createElement("IMG");}else{D=new Image();C=new Image();B=new Image();}if(A[15].length>0){C.src=A[15];
}if(A[23].length>0){B.src=A[23];}D.onload=function(G){this.onload=null;ii_display();};D.src=A[10];}}else{if(E[3]==1||E[1]==3){ii_continue(F.evalidx,100);
}else{ii_stop();}}}}function ii_display(){var c="ii_div_hide(\u0027[%0]\u0027,\u0027[%1]\u0027,[%2],[%3],[%4]);";var T="self.close();";
var d="var ii_IE=!!(document.all&&document.getElementById);var ii_MZ=(!ii_IE)?!!(document.getElementById):false;var ii_gpop = true;function ii_callServer(id,scr) {  var win = (ii_callServer.arguments.length==3) ? ii_callServer.arguments[2] : window;var head = win.document.getElementsByTagName(\u0027head\u0027).item(0); var old = win.document.getElementById(id);  if (old) head.removeChild(old);  script = document.createElement(\u0027script\u0027);  script.src = scr;  script.type = \u0027text/javascript\u0027;  script.defer = true;  script.id = id;  void(head.appendChild(script));}\r\n";
var b="function ii_executeInvitationAcceptedEvent(param1,param2,param3){var js=ii_invTokenReplace(ii_custacc,ii_inv[0],ii_inv[1]);eval(js);}\r\n";
var a="function ii_executeInvitationDeclinedEvent(param1,param2,param3){var js=ii_invTokenReplace(ii_custdecl,ii_inv[0],ii_inv[1]);eval(js);}\r\n";
var Y="function ii_invTokenReplace(js,arg3,arg4) { arg4 = arg4.replace(/\\u0027/g,\u0027\\\\\\'\u0027);js=js.replace(/\\[\\%INVITATIONID\\%\\]/g,arg3);js=js.replace(/\\[\\%INVITATIONNAME\\%\\]/g,arg4);return(js);}\r\n";
var X="var ii_inv;var ii_custacc;var ii_custdecl;";var V="ii_executeInvitationAcceptedEvent(\u0027[%0]\u0027,\u0027[%1]\u0027,\u0027[%2]\u0027,\u0027[%3]\u0027,\u0027[%4]\u0027);\r\n";
var R="ii_executeInvitationDeclinedEvent(\u0027[%0]\u0027,\u0027[%1]\u0027,\u0027[%2]\u0027,\u0027[%3]\u0027,\u0027[%4]\u0027);\r\n";
var e="var op=window;if (window.ii_gpop) { if (window.opener&amp;&amp;!window.opener.closed)op=window.opener;else op=null; }";
var N="if (op!=null&amp;&amp;op.ISVT_onInviteAccepted) op.ISVT_onInviteAccepted(\u0027[%0]\u0027,\u0027[%1]\u0027);";var K="if (op!=null&amp;&amp;op.ISVT_onInviteDeclined) op.ISVT_onInviteDeclined(\u0027[%0]\u0027,\u0027[%1]\u0027);";
var M="if (op!=null) {op.ii_upHLArr(op.ii_Var.ihl,op.ii_Var.invtoshow,2); op.ii_wrapHL(); }";var B="if (op!=null) {op.ii_upHLArr(op.ii_Var.ihl,op.ii_Var.invtoshow,3); op.ii_wrapHL(); }";
var g='\u003cimg src=\u0022[%0]\u0022 alt="" style=\u0022position:absolute;left:0px;top:0px;width:[%1]px;height:[%2]px;\u0022/\u003e';
var D="\u003cdiv id=\u0022[%0]\u0022 style=\u0022position:absolute;left:[%1]px;top:[%2]px;\u0022\u003e";var Q='\u003cimg src=\u0022[%0]\u0022 alt="" style=\u0022top:0px;left:0px;\u0022 onclick=\u0022[%1][%2][%3][%4]\u0022 onmouseover=\u0022this.style.cursor=\u0027pointer\u0027\u0022 onmouseout=\u0022this.style.cursor=\u0027\u0027\u0022/\u003e';
var O="\u003cform name=\u0022[%0]\u0022 method=\u0022post\u0022 action=\u0022\u0022\u003e\u003cinput style=\u0022font:normal 11px Arial, Helvetica, sans-serif;text-align:center;background-color:#E4E4E4;color:#000000;\u0022 type=\u0022button\u0022 name=\u0022[%1]\u0022 value=\u0022[%2]\u0022 onclick=\u0022[%3][%4][%5][%6]\u0022/\u003e\u003c/form\u003e";
var J="window.open(\u0027[%0]\u0027,\u0027chatclient\u0027,\u0027width=[%1],height=[%2],scrollbars=0\u0027);";var F="if (op!=null) op.document.location=\u0027[%0]\u0027;";
var G=ii_Var;var U="";var f="";var A=ii_getRuleOrInv(ii_Inv,G.invtoshow);var H=ii_getRuleOrInv(ii_Rules,G.trigru);ii_upHLArr(G.ihl,A[0],1);
ii_upHLArr(G.ihl,A[0],4);ii_wrapHL();ii_executeInvitationOfferedEvent(A[25],A[26],A[27],A[0],A[1]);if(window.ISVT_onInviteOffered){ISVT_onInviteOffered(G.trigru,G.invtoshow);
}G.evalru[ii_getRuleOrInvIdx(ii_Rules,G.trigru)][4]=ii_getRuleOrInvIdx(ii_Inv,G.invtoshow);if(A[2]==1||A[2]==2){U+='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\r\n';
U+='<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\r\n';U+="<head>\r\n<title></title>\r\n";if(A[2]==2){U+=G.scrinc+"\r\n";
U+='<script type="text/javascript">\r\n//<![CDATA[\r\n';U+=d+b+a+Y+X;U+="\r\n//]]>\r\n<\/script>\r\n";}U+='</head>\r\n<body><div id="iibody">\r\n';
U+=ii_rt(g,A,[ii_encodeHTML(A[10]),11,12],1);U+=ii_rt(D,A,["iiacc",13,14],1);var S=ii_rt(V,A,[ii_encodeHTML(A[28]),ii_encodeHTML(A[29]),ii_encodeHTML(A[30]),0,ii_encodeHTML(A[1])],1);
var P=e+ii_rt(N,A,[0,""+H[8]],1);var L="";if(A[2]==1){L=ii_rt(c,A,[4,"aclk",7,(A[9]==1?"-3":"0"),0],1);}else{L=M+T;}var Z=ii_encodeHTML(ii_parsejs(A[17]));
if(A[18]==1){f=ii_rt(J,A,[Z,19,20],1);}else{if(A[18]==2){f=ii_rt(F,A,[Z],1);}}if(A[15].length>0){U+=ii_rt(Q,A,[15,S,P,f,L],0);
}else{if(A[16].length>0){U+=ii_rt(O,A,["iiaccfrm","iiaccbtn",ii_encodeHTML(A[16]),S,P,f,L],0);}}U+="</div>";U+=ii_rt(D,A,["iidecl",21,22],1);
S=ii_rt(R,A,[ii_encodeHTML(A[31]),ii_encodeHTML(A[32]),ii_encodeHTML(A[33]),0,ii_encodeHTML(A[1])],1);P=e+ii_rt(K,A,[0,""+H[8]],1);
var L="";if(A[2]==1){L=ii_rt(c,A,[4,"dclk",8,(A[9]==1?"-3":"0"),0],1);}else{L=B+T;}if(A[23].length>0){U+=ii_rt(Q,A,[23,S,P,L,""],0);
}else{if(A[24].length>0){U+=ii_rt(O,A,["iideclfrm","iideclbtn",ii_encodeHTML(A[24]),S,P,L,""],0);}}U+="</div></div></body></html>";
if(A[2]==1){if(A[4]=="invitelayer"){var W=document.getElementById(A[4]);var C=document.getElementById("invitelayercontent");
var I=document.getElementById("divshim");ii_Anim=new ii_AnimObj();ii_Anim.islteIE6=(I==null?false:true);ii_Anim.flx=10;ii_Anim.fly=10;
ii_Anim.flw=A[11];ii_Anim.flh=A[12];ii_Anim.flpos=A[5];ii_Anim.flopac=(A[9]==1?0:100);ii_Anim.flfade=(A[9]==1?3:0);W.style.width=ii_Anim.flw;
W.style.height=ii_Anim.flh;C.style.display="block";C.innerHTML=U;C.childNodes[0].data="";if(ii_Anim.islteIE6){I.style.display="block";
I.style.width=ii_Anim.flw+"px";I.style.height=ii_Anim.flh+"px";I.style.top="0px";I.style.left="0px";I.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";
I.style.zIndex=C.style.zIndex-1;}else{W.style.filter="alpha(opacity=0);-moz-opacity:0.0;";}ii_mark();window.onresize=ii_mark;
ii_reset();ii_Anim.moveTimer=setInterval("ii_move();",25);setTimeout("document.getElementById('"+A[4]+"').style.visibility='visible'",40);
ii_Anim.flpos=A[6];ii_mark();ii_Anim.hideTimer=setTimeout("ii_div_hide('"+A[4]+"','auto',"+A[8]+","+(A[9]==1?-3:0)+","+A[0]+");",(A[7]*1000));
}else{C=document.getElementById(A[4]);if(C){C.innerHTML=U;C.style.visibility="visible";}}}else{if(A[2]==2){var E=window.open("","InstantInvite","width="+A[11]+",height="+A[12]);
if(E){E.document.close();E.document.write(U);E.document.close();E.ii_inv=A;E.ii_custacc=G.CustomAcceptedJS;E.ii_custdecl=G.CustomDeclinedJS;
E.focus();}}}}if(A[2]==3){if(confirm(A[3])){ii_executeInvitationAcceptedEvent(A[28],A[29],A[30],A[0],A[1]);if(window.ISVT_onInviteAccepted){ISVT_onInviteAccepted(G.invtoshow,H[8]);
}ii_upHLArr(G.ihl,G.invtoshow,2);ii_wrapHL();var Z=ii_parsejs(A[17]);if(A[18]==1){window.open(Z,"InstantInvite","width="+A[19]+",height="+A[20]+"");
}else{if(A[18]==2){document.location=Z;}}}else{ii_executeInvitationDeclinedEvent(A[31],A[32],A[33],A[0],A[1]);if(window.ISVT_onInviteDeclined){ISVT_onInviteDeclined(G.invtoshow,H[8]);
}ii_upHLArr(G.ihl,G.invtoshow,3);ii_wrapHL();}}if(H[3]==1||H[3]==3){ii_continue(G.evalidx,100);}else{ii_stop();}}function ii_rt(D,A,E,B){for(var C=0;
C<E.length;C++){if(typeof (E[C])=="number"){if(B==1){D=D.replace("[%"+C+"]",(""+A[E[C]]).replace(/\u0027/g,"\\'"));}else{D=D.replace("[%"+C+"]",A[E[C]]);
}}else{if(B==1){D=D.replace("[%"+C+"]",E[C].replace(/\u0027/g,"\\'"));}else{D=D.replace("[%"+C+"]",E[C]);}}}return(D);}function ii_parsejs(s){var regexp=/\[\%jsvar\:([a-zA-Z_\.]*)\%\]/;
var match=regexp.exec(s);while(match!=null){result=eval("'"+window.ii_jsvar[match[1]]+"'");s=s.replace(/\[\%jsvar\:([a-zA-Z_\.]*)\%\]/,result);
match=regexp.exec(s);}return(s);}function ii_div_hide(B,C,G,E,A){var F=ii_Var;if(A==F.lastinvhid){return ;}F.lastinvhid=A;
var D=(B=="invitelayer");if(D){clearTimeout(ii_Anim.hideTimer);}if(C=="auto"||C=="aclk"||C=="dclk"){if(C=="aclk"){ii_upHLArr(F.ihl,A,2);
ii_wrapHL();}if(C=="dclk"){ii_upHLArr(F.ihl,A,3);ii_wrapHL();}if(D&&G>0){ii_Anim.flpos=G;ii_Anim.flfade=E;ii_mark();}if(D){setTimeout("ii_div_clear('"+B+"');",(C=="auto")?1000:500);
}}}function ii_div_clear(A){document.getElementById(A).style.visibility="hidden";clearInterval(ii_Anim.moveTimer);}function ii_trap(){ii_Var.abshown=true;
this.onbeforeunload=null;return ii_Var.abmsg;}function ii_delay_abandon(D){window.onbeforeunload=null;var C=setTimeout("window.onbeforeunload=ii_trap;",2000);
var A=null;if(!D){var D=window.event;}if(D.target){A=D.target;}else{if(D.srcElement){A=D.srcElement;}}if(A.nodeType==3){A=A.parentNode;
}if(A!=null){var B=A.tagName;if(B!=null){B=B.toLowerCase();if(B=="a"||B=="area"||B=="img"){clearTimeout(C);}else{if(B=="input"){if(A.getAttribute){var E=A.getAttribute("type");
if(E!=null){E=E.toLowerCase();if(E=="image"||E=="submit"||E=="button"){clearTimeout(C);}}}}}}}return true;}function ii_checkRules(L){var J=ii_Var;
if(L==0){J.runcnt++;}if(J.abshown==true&&J.abflag!=9999){J.trigru=ii_Rules[parseInt(J.abflag,10)][0];J.evalru[parseInt(J.abflag,10)][2]=2;
J.evalru[parseInt(J.abflag,10)][3]=J.trigrucnt++;J.abflag=9999;window.onbeforeunload=null;J.abmsg=null;document.onclick=null;
return ;}var V=0;for(var O=L;O<ii_Rules.length;O++){J.evalidx=O;if(J.evalru[O][2]==0||J.evalru[O][3]>0){V++;continue;}else{J.evalru[O][2]=2;
}var P=true;var U=ii_Rules[O][5];for(var R=0;R<U.length;R++){var N=2;var W=U[R].split("`");switch(W[0]){case"1":if(J.pgvis==1){N=1;
}break;case"2":if(!J.abshown){J.abmsg=W[1];window.onbeforeunload=ii_trap;if(J.IE){document.onclick=ii_delay_abandon;}else{if(J.MZ){window.captureEvents(Event.CLICK);
}}window.onclick=ii_delay_abandon;J.abflag=O;N=3;}break;case"3":if(ii_compOp(J.pgvis,W[1],W[2],W[3],0)){N=1;}break;case"4":if((W[2]==7||W[2]==9)&&J.cpml.contains(W[1])&&!J.stringNoContain.contains(W[1])&&ii_compOp(ii_getHLArr(J.phl,W[1],1),W[4],W[5],W[6],0)){N=1;
}else{if(W[2]==8&&J.cpml.contains(W[1])&&J.stringNoContain.contains(W[1])&&ii_compOp(ii_getHLArr(J.phl,W[1],2),W[4],W[5],W[6],0)){N=1;
}}break;case"5":if(ii_compOp(J.randid,W[1],W[2],W[3],0)&&ii_compOp(J.randid,W[4],W[5],W[6],0)){N=1;}break;case"10":if((W[2]==7||W[2]==9)&&J.ppml.contains(W[1])&&!J.stringNoContain.contains(W[1])){N=1;
}else{if(W[2]==8&&J.ppml.contains(W[1])&&J.stringNoContain.contains(W[1])){N=1;}}break;case"11":if((W[2]==7||W[2]==9)&&!J.stringNoContain.contains(W[1])&&ii_compOp(J.referrer,J.urlStrings[W[1]],W[2],W[3],0)){N=1;
}else{if(W[2]==8&&J.stringNoContain.contains(W[1])&&ii_compOp(J.referrer,J.urlStrings[W[1]],W[2],W[3],0)){N=1;}}break;case"12":if((W[2]==7||W[2]==9)&&!J.stringNoContain.contains(W[1])){for(var Q=0;
Q<J.phl.length;Q++){var S=ii_getHLArr(J.phl,W[1],1);if(S!=null&&S>0){if(!J.cpml.contains(W[1])||S>1){N=1;}break;}}}else{if(W[2]==8&&J.stringNoContain.contains(W[1])){for(var Q=0;
Q<J.phl.length;Q++){var S=ii_getHLArr(J.phl,W[1],2);if(S!=null&&S>0){if(!J.cpml.contains(W[1])||S>1){N=1;}break;}}}}break;
case"30":if(J.geoinit==1){if((W[2]==9&&ii_matchRegExp(J.geoip,W[1]))||((W[2]==7||W[2]==8)&&ii_compOp(J.geoip,W[1],W[2],0,1))){N=1;
}else{if(W[2]==1||W[2]==2){var M=false;var T=ii_extractStrings(W[1]);for(var Q=0;Q<T.length;Q++){var H=ii_getIPRange(T[Q]);
if(H!=null){if(ii_ipCheck(J.geoip,H[0],H[1])){M=true;}}}if(W[2]==1&&M){N=1;}else{if(W[2]==2&&!M){N=1;}}}}}break;case"31":case"32":case"33":case"34":case"35":if(J.geoinit==1){var C="";
if(W[0]=="31"){C=J.geoco;}else{if(W[0]=="32"){C=J.georg;}else{if(W[0]=="33"){C=J.geoct;}else{if(W[0]=="34"){C=J.geons;}else{if(W[0]=="35"){C=J.geodm;
}}}}}if(ii_compOp(C,W[1],W[2],0,1)){N=1;break;}}break;case"50":case"51":var E=parseInt(new Date().getTime()/1000);var K=(W[0]=="50"?J.tmentpg:parseInt(J.tmes,10));
var G=parseInt(W[1],10);if(ii_compOp(E-K,G,W[2],W[3],0)){N=1;}break;case"70":var D=ii_getHLArr(J.ihl,ii_Rules[O][2],3);if(D==null||D==0){N=1;
}break;case"71":var D=0;for(var Q=0;Q<J.ihl.length;Q++){if(!isNaN(parseInt(J.ihl[Q][3],10))){D+=parseInt(J.ihl[Q][3],10);
}}if(D==0){N=1;}break;case"72":var X=ii_getHLArr(J.ihl,ii_Rules[O][2],1);if(X==null){X=0;}if(ii_compOp(X,W[1],W[2],W[3],0)){N=1;
}break;case"73":var X=0;for(var Q=0;Q<J.ihl.length;Q++){if(!isNaN(parseInt(J.ihl[Q][1],10))){X+=parseInt(J.ihl[Q][1],10);
}}if(ii_compOp(X,W[1],W[2],W[3],0)){N=1;}break;case"74":var E=parseInt(new Date().getTime()/1000);var G=parseInt(W[1],10);
var A=ii_getHLArr(J.ihl,ii_Rules[O][2],4);if(A==null||ii_compOp(G,E-A,W[2],W[3],0)){N=1;}break;case"75":var E=parseInt(new Date().getTime()/1000);
var G=parseInt(W[1],10);var N=1;for(var Q=0;Q<J.ihl.length;Q++){var A=J.ihl[Q][4];if(A!=null&&ii_compOp(E-A,G,W[2],W[3],0)){N=2;
break;}}break;case"76":var I=ii_getHLArr(J.ihl,ii_Rules[O][2],2);if(I==null||I==0){N=1;}break;case"77":var I=0;for(var Q=0;
Q<J.ihl.length;Q++){if(!isNaN(parseInt(J.ihl[Q][2],10))){I+=parseInt(J.ihl[Q][2],10);}}if(I==0){N=1;}break;case"80":case"81":case"82":var F=ii_getCookie(W[1]);
if(W[0]=="80"&&(F==null?(W[4]==0?1:0):(W[4]==1?1:0))){N=1;}if(F!=null){if((W[0]=="81"&&ii_compOp(F,W[4],W[5],W[6],1))||(W[0]=="82"&&!isNaN(F)&&ii_compOp(parseFloat(F),W[4],W[5],W[6],1))){N=1;
break;}}break;case"90":case"91":case"92":var B=ii_validateParam(0,W[1]);if(B!=null){if((W[0]=="90"&&typeof (B)=="string")||(W[0]=="91"&&typeof (B)=="number")){if((W[0]=="90"&&typeof (B)=="string"&&ii_compOp(B,W[4],W[5],W[6],1))||(W[0]=="91"&&typeof (B)=="number"&&ii_compOp(B,W[4],W[5],W[6],1))){N=1;
break;}}else{if((W[0]=="92")&&typeof (B)=="boolean"){if(ii_compOp(B,(W[4]==0?false:true),1,W[6])){N=1;}}}}break;case"100":case"101":case"102":case"103":case"104":case"105":case"106":case"107":var B=null;
if(W[0]=="100"||W[0]=="101"||W[0]=="102"||W[0]=="103"){B=ii_validateParam(1,W[1]);}else{B=ii_validateParam(2,W[1]);}if(B!=null){if(((W[0]=="100"||W[0]=="104")&&ii_compOp(B.value,W[4],W[5],W[6],1))||((W[0]=="101"||W[0]=="105")&&!isNaN(B.value)&&ii_compOp(parseFloat(B.value),W[4],W[5],W[6],1))||((W[0]=="102"||W[0]=="106")&&ii_compOp((B.checked==true?1:0),W[4],1,W[6],0))||((W[0]=="103"||W[0]=="107")&&ii_compOp(B.selectedIndex,W[4],W[5],W[6],1))){N=1;
}}break;default:}J.evalru[O][1][R]=N;if(N>1){P=false;break;}}if(P){J.trigru=ii_Rules[O][0];J.evalru[O][3]=++J.trigrucnt;J.abflag=9999;
window.onbeforeunload=null;J.abmsg=null;document.onclick=null;return ;}}if(V==ii_Rules.length){ii_stop();}else{ii_continue(0,2500);
}}function ii_continue(B,A){setTimeout("ii_restart("+B+");",A);}function ii_stop(){ii_Var.run=false;}function ii_getRuleOrInv(A,C){for(var B=0;
B<A.length;B++){if(A[B][0]==C){return(A[B]);}}return(null);}function ii_getRuleOrInvIdx(A,C){for(var B=0;B<A.length;B++){if(A[B][0]==C){return(B);
}}return(-1);}function ii_compOp(I,H,E,F,J){var D=[];var A=false;if(J==1&&E!=9){D=ii_extractStrings(H);}else{D[0]=H;}var G=(typeof I=="string");
var B=(typeof H=="string");for(var C=0;C<D.length;C++){if(E==1&&F==0&&G&&B){if(D[C].toLowerCase()==I.toLowerCase()){A=true;
break;}}else{if(E==1){if(D[C]==I){A=true;break;}}else{if(E==2&&F==0&&G&&B){if(D[C].toLowerCase()!=I.toLowerCase()){A=true;
}else{A=false;break;}}else{if(E==2){if(D[C]!=I){A=true;}else{A=false;break;}}else{if(E==3){if(I>D[C]){A=true;break;}}else{if(E==4){if(I<D[C]){A=true;
break;}}else{if(E==5){if(I<=D[C]){A=true;break;}}else{if(E==6){if(I>=D[C]){A=true;break;}}else{if(E==7&&F==0){if(I.toLowerCase().indexOf(D[C].toLowerCase())!=-1){A=true;
break;}}else{if(E==7&&F==1){if(I.indexOf(D[C])!=-1){A=true;break;}}else{if(E==8&&F==0){if(I.toLowerCase().indexOf(D[C].toLowerCase())==-1){A=true;
}else{A=false;break;}}else{if(E==8&&F==1){if(I.indexOf(D[C])==-1){A=true;}else{A=false;break;}}else{if(E==9){if(ii_matchRegExp(I,D[C])!=null){A=true;
break;}}}}}}}}}}}}}}}return(A);}function ii_validateParam(H,E){if(H==2){return(document.getElementById(E));}var J=(H==0?window:window.document);
var B="";var C=E.split(".");for(var F=0;F<C.length;F++){var D=C[F];var G=ii_matchRegExp(D,"^([^\\]']*)\\['?([^']*)'?\\]$");
if(G!=null){B+=G[1]+"`"+G[2];}else{B+=D;}if(F<C.length-1){B+="`";}}var I=null;var A=B.split("`");for(var F=0;F<A.length;F++){if(F==0){if(typeof (J[A[0]])=="undefined"){I=null;
break;}else{I=J[A[0]];}}else{if(F==1){if(typeof (J[A[0]][A[1]])=="undefined"){I=null;break;}else{I=J[A[0]][A[1]];}}else{if(F==2){if(typeof (J[A[0]][A[1]][A[2]])=="undefined"){I=null;
break;}else{I=J[A[0]][A[1]][A[2]];}}else{if(F==3){if(typeof (J[A[0]][A[1]][A[2]][A[3]])=="undefined"){I=null;break;}else{I=J[A[0]][A[1]][A[2]][A[3]];
}}}}}}return(I);}function ii_matchRegExp(C,A){var B=ii_Var.tokenizedexps[A];if(!B){B=ii_Var.tokenizedexps[A]=new RegExp(A);
}return(B.exec(C));}Array.prototype.contains=function(B){for(var A=0;A<this.length;A++){if(this[A]==B){return true;}}return false;
};String.prototype.reverse=function(){var A="";if(this.length>0){A=this.split("").reverse().join("");}return A;};function ii_findMatches(D){var E=ii_Var;
for(var B=0;B<E.urlStrings.length;B++){if(!E.stringNoContain.contains(B)){var C=(E.stringTypes[B]==2)?[E.urlStrings[B]]:ii_extractStrings(E.urlStrings[B]);
for(var A=0;A<C.length;A++){if((E.stringTypes[B]==0&&D.toLowerCase().indexOf(C[A].toLowerCase())!=-1)||(E.stringTypes[B]==1&&D.indexOf(C[A])!=-1)||(E.stringTypes[B]==2&&new RegExp(C[A]).exec(D)!=null)){E.cpml[E.cpml.length]=B;
ii_upHLArr(E.phl,B,1);break;}}}}}function ii_findNoMatches(E){var F=ii_Var;for(var B=0;B<F.urlStrings.length;B++){if(F.stringNoContain.contains(B)){var C=true;
var D=ii_extractStrings(F.urlStrings[B]);for(var A=0;A<D.length;A++){if((F.stringTypes[B]==0&&E.toLowerCase().indexOf(D[A].toLowerCase())!=-1)||(F.stringTypes[B]==1&&E.indexOf(D[A])!=-1)){C=false;
}}if(C){F.cpml[F.cpml.length]=B;ii_upHLArr(F.phl,B,2);}}}}function ii_extractStrings(A){var C=(A.reverse().split(/[\s]*,(?!\\)[\s]*/).reverse());
for(var B=0;B<C.length;B++){C[B]=C[B].reverse().replace(/\\,/g,",");}return(C);}function ii_decodeHTML(C){var B=/&#([0-9a-fA-F]*);/;
var A=B.exec(C);while(A!=null){C=C.replace(/&#([0-9a-fA-F])*;/,String.fromCharCode(A[1]));var A=B.exec(C);}return(C);}function ii_encodeHTML(C){var A="";
for(var B=0;B<C.length;B++){A+="&#"+C.charCodeAt(B)+";";}return(A);}function ii_invTokenReplace(C,B,A){A=A.replace(/\u0027/g,"\\'");
C=C.replace(/\[\%INVITATIONID\%\]/g,B);C=C.replace(/\[\%INVITATIONNAME\%\]/g,A);return(C);}function ii_ruleTokenReplace(C,B,A){A=A.replace(/\u0027/g,"\\'");
C=C.replace(/\[\%RULEID\%\]/g,B);C=C.replace(/\[\%RULENAME\%\]/g,A);return(C);}function ii_executeInvitationOfferedEvent(param1,param2,param3){var arg=ii_executeInvitationOfferedEvent.arguments;
eval(ii_invTokenReplace(ii_Var.CustomOfferedJS,arg[3],arg[4]));}function ii_executeInvitationAcceptedEvent(param1,param2,param3){var arg=ii_executeInvitationAcceptedEvent.arguments;
eval(ii_invTokenReplace(ii_Var.CustomAcceptedJS,arg[3],arg[4]));}function ii_executeInvitationDeclinedEvent(param1,param2,param3){var arg=ii_executeInvitationDeclinedEvent.arguments;
eval(ii_invTokenReplace(ii_Var.CustomDeclinedJS,arg[3],arg[4]));}function ii_executeRuleTriggeredEvent(param1,param2,param3){var arg=ii_executeRuleTriggeredEvent.arguments;
eval(ii_ruleTokenReplace(ii_Var.CustomTriggeredJS,arg[3],arg[4]));}function ii_loadDiag(){var A=ii_Var;ii_unwrapHL();A.diag=[A.run,A.runcnt,ii_getGSV("TES"),A.tmentpg,A.pgvis,A.randid,A.abflag,A.trigru,A.invtoshow,A.trigrucnt,A.phl,A.ihl,A.cpml,A.ppml,A.deptavail,A.evalru,ii_getGSV("GeoIP"),ii_getGSV("GeoCo"),ii_getGSV("GeoRg"),ii_getGSV("GeoCt"),ii_getGSV("GeoNs"),ii_getGSV("GeoDm"),A.publ,A.deploy,A.domain];
}function ii_getDiag(A){return(ii_Var.diag[A]);}function ii_restart(E){var D=ii_Var;D.trigru=0;ii_initGeoIP();if(E==0){for(var B=0;
B<D.evalru.length;B++){if(D.evalru[B][2]>1){D.evalru[B][2]=1;}for(var A=0;A<D.evalru[B][1].length;A++){D.evalru[B][1][A]=0;
}}}ii_checkRules(E);if(D.trigru>0){var C=ii_getRuleOrInv(ii_Rules,D.trigru);if(C[6]>=1){ii_doAvailCheck(C[6],C[7],C[8]);}else{ii_show();
}}}function ii_init(){var C=ii_Var;C.deploy=(window.ii_deployment?window.ii_deployment:ii_getGSV("DPL"));if(C.deploy>0&&C.jscalled==0){if(C.deploy==1){ii_callServer("II3_TestRules.js",ii_getProtocol()+"://"+C.rsvr+"/resources/smartbutton/"+C.accountid+"/II3_TestRules.js?src=ii3&ts="+C.pct);
}if(C.deploy==2){ii_callServer("II3_Rules.js",ii_getProtocol()+"://"+C.rsvr+"/resources/smartbutton/"+C.accountid+"/II3_Rules.js?src=ii3&ts="+C.pct);
}C.jscalled=1;ii_upGSV("DPL",C.deploy);}if(window.ii_Rules&&window.ii_Rules.length>0){if(C.vtscrloc.length>0){ii_callServer(C.vtscrname,ii_getProtocol()+"://"+C.vtscrloc);
}ii_unwrapHL();if(C.publ!=C.publishversion){ii_resetHistCookie();}C.publ=C.publishversion;C.pgvis=parseInt(C.pgvis,10)+1;
C.ppml=C.cpml;C.cpml=[];if(C.randid==0){C.randid=Math.floor(Math.random()*100+1);}ii_findMatches(document.location.href);
ii_findNoMatches(document.location.href);ii_wrapHL();for(var B=0;B<ii_Rules.length;B++){C.evalru[B]=[ii_Rules[B][0],new Array(ii_Rules[B][5].length),(ii_Rules[B][1]==0?0:1),0,-1];
for(var A=0;A<ii_Rules[B][5].length;A++){C.evalru[B][1][A]=0;}}C.run=true;ii_restart(0);}else{setTimeout("ii_init();",1000);
}}function ii_start(){var B=ii_Var;if(B.IE||B.MZ){if(document.location.host.indexOf(B.domain)!=-1){if(B.ishosted){var A=(parseInt(new Date().getTime()/1000));
B.pct=ii_getGSV("PCT");if((A-B.cachetimeout)>=B.pct){B.pct=A;ii_upGSV("PCT",B.pct);}if(ii_getGSV("DPL")==0){ii_callServer("II3_Servers.js",ii_getProtocol()+"://"+B.rsvr+"/resources/smartbutton/"+B.accountid+"/II3_Servers.js?src=ii3&ts="+A);
}}if(ii_getGSV("GeoIP")=="*"){ii_callServer("geoipAPI.js",ii_getProtocol()+"://"+B.gsvr+"/geoipAPI.js?src=ii3&ts="+A);}ii_init();
}}}function ii_VarObj(){this.IE=!!(document.all&&document.getElementById);this.MZ=(!this.IE)?!!(document.getElementById):false;
this.version=14;this.accountid=5514;this.ishosted=true;this.domain="";this.rsvr="rs.instantservice.com";this.gsvr="gs.instantservice.com";
this.vtscrname="";this.vtscrloc="";this.GSV_COOKIE="IS3_GSV";this.HIST_COOKIE="IS3_History";this.HIST_COOKIE_EXP=new Date();
if(this.HIST_COOKIE_EXP!=null){this.HIST_COOKIE_EXP.setTime(this.HIST_COOKIE_EXP.getTime()+(43200*60*1000));}this.run=true;
this.runcnt=0;this.tmentpg=parseInt(new Date().getTime()/1000);this.trigru=0;this.trigrucnt=0;this.lastinvhid=0;this.invtoshow=0;
this.referrer=document.referrer;this.evalidx=0;this.deptavail=[];this.evalru=[];this.deploy=0;this.jscalled=0;this.cachetimeout=300;
this.geoinit=0;this.geoip=null;this.geoco=null;this.georg=null;this.geoct=null;this.geons=null;this.geodm=null;this.tmes=null;
this.diag=[];this.publ=0;this.pct=0;this.pgvis=0;this.randid=0;this.phl=[];this.ihl=[];this.cpml=[];this.ppml=[];this.tokenizedexps={};
this.abflag=9999;this.abshown=false;this.abmsg=null;this.availImg=null;this.checkDeptID=0;this.checkState=0;if(navigator.appName.indexOf("Microsoft")!=-1&&navigator.platform.indexOf("Mac")!=-1){this.availImg=document.createElement("IMG");
}else{this.availImg=new Image();}this.availImg.onload=availOnLoad;this.availImg.onerror=availOnError;}ii_Var=new ii_VarObj();
ii_Var.domain+=ii_getDomain();if(navigator.cookieEnabled){if(ii_getCookie(ii_Var.HIST_COOKIE)==null){ii_resetHistCookie();
}if(ii_getCookie(ii_Var.GSV_COOKIE)==null){ii_resetGSVCookie();}}document.write('<div id="invitelayer" style="position:absolute;left:10px;top:10px;visibility:hidden;z-index:1000;">');
document.write('<div id="invitelayercontent" style="position:relative;left:0px;top:0px;z-index:100">&nbsp;</div>');document.write('<!--[if lte IE 6]><iframe id="divshim" src="javascript:\'&lt;html&gt;&lt;/html&gt;\'" scrolling="no" frameborder="0" style="position:absolute;top:0px;left:0px;display:none;"></iframe><![endif]--></div>');
if(ii_Var.IE||ii_Var.MZ){ii_start();}

// set a cookie for a particular name
function setCookie(name, value) {
   var docLocation = document.URL;
   var docLocationLen = docLocation.length;
   document.cookie = name + "=" + docLocationLen + "~" + escape(document.location) + escape(value) + ";PATH=/" ;
}
function readCookie (CookieName) {
  var lf = "\n";
  var CookieString = document.cookie;
  var CookieSet = CookieString.split (';');
  var SetSize = CookieSet.length;
  var CookiePieces
  var cookieValue = "";
  var x = 0;
  for (x = 0; ((x < SetSize) && (cookieValue == "")); x++) {
    CookiePieces = CookieSet[x].split ('=');
    if (CookiePieces[0].substring (0,1) == ' ') {
      CookiePieces[0] = CookiePieces[0].substring (1, CookiePieces[0].length);
    }
    if (CookiePieces[0] == CookieName) {
     if(CookiePieces[1])
     {
    	 cookieValue = CookiePieces[1];
     }
    }
  }
  return cookieValue;
}

function Get_Cookie( check_name ) {
	// first we'll split this cookie up into name/value pairs
	// note: document.cookie only returns name=value, not the other components
	var a_all_cookies = document.cookie.split( ';' );
	var a_temp_cookie = '';
	var cookie_name = '';
	var cookie_value = '';
	var b_cookie_found = false; // set boolean t/f default f

	for ( i = 0; i < a_all_cookies.length; i++ )
	{
		// now we'll split apart each name=value pair
		a_temp_cookie = a_all_cookies[i].split( '=' );


		// and trim left/right whitespace while we're at it
		cookie_name = a_temp_cookie[0].replace(/^\s+|\s+$/g, '');

		// if the extracted name matches passed check_name
		if ( cookie_name == check_name )
		{
			b_cookie_found = true;
			// we need to handle case where cookie has no value but exists (no = sign, that is):
			if ( a_temp_cookie.length > 1 )
			{
				cookie_value = unescape( a_temp_cookie[1].replace(/^\s+|\s+$/g, '') );
			}
			// note that in cases where cookie is initialized but no value, null is returned
			return cookie_value;
			break;
		}
		a_temp_cookie = null;
		cookie_name = '';
	}
	if ( !b_cookie_found )
	{
		return null;
	}
}

function Set_Cookie( name, value, expires)
{
    // set time, it's in milliseconds
    var today = new Date();
    today.setTime( today.getTime() );
    
    /*
    if the expires variable is set, make the correct expires time, the current script below will set it for x number of days, to make it for hours,
    delete * 24, for minutes, delete * 60 * 24
    */
    if ( expires ){
        expires = parseInt(expires) * 1000 * 60 * 60 * 24;
    }
    var expires_date = new Date( today.getTime() + (expires) );
    
    document.cookie = name + "=" + escape( value ) + ";path=/" +( ( expires ) ? ";expires=" + expires_date.toGMTString() : "" );
}

// this deletes the cookie when called
function Delete_Cookie( name, path, domain ) {
    if ( Get_Cookie( name ) ) document.cookie = name + "=" +
    ( ( path ) ? ";path=" + path : "") +
    ( ( domain ) ? ";domain=" + domain : "" ) +
    ";expires=Thu, 01-Jan-1970 00:00:01 GMT";
}



/* This code will set the continue shopping link that retains the users last search position for use by Shopping Basket page.*/
/* expires - number of days until cookie should expire. If not specified, session cookie */
function setCSCookie(name, value) { document.cookie=name+"="+value+"; path=/"; }
//function setCSCookie(name, value) { document.cookie=name+"="+value+"; expires="+expires_date.toGMTString()+"; path=/"; }
function setContinueShoppingCookie(url) { setCSCookie("rei_continue", url); }
function setDCSCookie(name, value, expires) {
// set time, it's in milliseconds
var today = new Date();
today.setTime(today.getTime());
/* if the expires variable is set, make the correct expires time, the current script below will set 
it for x number of days, to make it for hours, delete * 24, for minutes, delete * 60 * 24 */
if (expires) { expires = expires * 1000 * 60 * 60 * 24; }
var expires_date = new Date(today.getTime() + (expires)); /*var expdate = "Sun, 27-Sep-1998 11:59:59 GMT"*/
document.cookie=name+"="+value+"; expires="+expires_date.toGMTString()+"; path=/";
}
function setDatedContinueShoppingCookie(url, days) { setDCSCookie("rei_continue", url, days); }

function getPreferredPageSize() {
	// Get page size from URL
	var path = window.location.href;
	var pageSize = 29;
	var pageSizeIndex = path.indexOf("page_size", 0);
	if(pageSizeIndex > -1) {
		var pageSizeEndIndex = path.indexOf("&", pageSizeIndex);
		if(pageSizeEndIndex == -1) {
		    pageSizeEndIndex = path.length;
		}
		pageSize = path.substring(pageSizeIndex+10, pageSizeEndIndex);
	} else {
	// Get page size from cookie
      if (getCookie("searchPreferences") == null) {
      var searchPreferences = 'null';
      }
      else {
      var searchPreferences = getCookie("searchPreferences");
      }
      pageSizeIndex = searchPreferences.indexOf("page_size", 0);
      if(pageSizeIndex > -1) {
      var pageSizeEndIndex = searchPreferences.indexOf("%26", pageSizeIndex);
      if(pageSizeEndIndex == -1) {
      pageSizeEndIndex = searchPreferences.length;
      }
      pageSize = searchPreferences.substring(pageSizeIndex+10, pageSizeEndIndex);
      if (pageSize == 22) {
      pageSize = 29;
      }
      if (pageSize == 50) {
      pageSize = 57;
      }
      if (pageSize == 102) {
      pageSize = 109;
      }
      }
	}
    return pageSize;
}       

/**
 * This function is for updating the Compare bucket with the items in cookie. It
 * is called on load of the search result page ( i.e. when ever search result
 * page refreshes/reloads)
 * 
 * @returns {Boolean}
 */

/*$(document).ready(function(){
    var compareBucketCookie = readCookie("compareBucket");

    if ($('.abTest').css('display') != 'none'){
        if (compareBucketCookie == 'on'){
            $('li.compare ').show();
            $('#compareWrapper').show();
            $('#compareTab').css('border-top', 'none');
            $('#compareTab b').removeClass('compareDownArrow');
            $('#compareTab b').addClass('compareUpArrow');
        } else {
            $('li.compare ').hide();
            $('#compareWrapper').hide();
            $('#compareTab').css('border-top', '1px solid #CCC');
            $('#compareTab b').removeClass('compareUpArrow');
            $('#compareTab b').addClass('compareDownArrow');
        }
    }
    
    $('#compareTab').click(function() {
        $('li.compare').toggle();
        $('#compareWrapper').animate({
            height: 'toggle'
            }, 200);
        if ($('#compareWrapper').css('height') == '1px') {
            Set_Cookie("compareBucket", "on");
            $('#compareTab b').removeClass('compareDownArrow');
            $('#compareTab b').addClass('compareUpArrow');
            $('#compareTab').css('border-top', 'none');
        } else {
            Set_Cookie("compareBucket", "off");
            $('#compareTab b').removeClass('compareUpArrow');
            $('#compareTab b').addClass('compareDownArrow');
            $('#compareTab').css('border-top', '1px solid #CCC');
        }

    });
});*/

function updateCompBucketOnLoad() {
	
	var href= window.location.href;
	Set_Cookie("searchURL",href);
	
	var cookieValue = readCookie("userproduct");
	if (cookieValue != null) {
		var valuePieces = new Array();
		valuePieces = cookieValue.split('%2C');
		if (valuePieces && valuePieces != "" && valuePieces.length > 0) {
			var style;
			// Updating bucket with only the first four items in cookie ( this
			// is for existing users who may have more than 4 items)
			Delete_Cookie('userproduct','/');
			Delete_Cookie('compExtAccess','/');
			Delete_Cookie('removeuserproduct','/');
			for ( var x = 0; x < 4; x++) {
				if (valuePieces[x]) {
					style = valuePieces[x];
					// Adding item to compare bucket and back into the cookie
					toggleCompButton(style, 'add');
				} 
			}
		}
	}
	return false;
}
function isStyleInCompareCookie(cookieName, Style) {
	var isInCompList = false;
	var cookieValue = readCookie(cookieName);
	if (cookieValue != null) {
		var SetSize = cookieValue.length;
		var valuePieces = new Array();
		valuePieces = cookieValue.split('%2C');
		for (var x = 0; ((x < SetSize) && (!isInCompList)); x++) {
			if (valuePieces[x] == Style) {
				isInCompList = true;
			}
		}
	}
	return isInCompList;
}

/*function findParamInQuerySt(name) 
{
	var url = window.location.search.substring(1);
	var keyValues = url.split("&amp;");
	var key;
	for (i=0;i < keyValues.length;i++)
	{
		key = keyValues[i].split("=");
		if (key[0] == name) {
			return key[1];
		}
	}
}

function remove(){
	var mode = findParamInQuerySt('styles');
	var styles ='%20';
	if(mode)
	{
		Set_Cookie("compExtAccess","true");
	}
	if(readCookie("compExtAccess") == 'true' && mode)
	{
		document.userProductUpdate.action = document.userProductUpdate.action + '&styles='+styles ;
		document.userProductUpdate.method = 'post';
	}
	else
	{
		//Delete_Cookie('userproduct','/');
		Set_Cookie('userproduct',"");
		Delete_Cookie('removeuserproduct','/');
	}
	document.userProductUpdate.submit();
}*/

function removeFromCompareCookie(cookieName, style) {
	var cookieValue = readCookie(cookieName);
	if (cookieValue != null) {
		cookieValue = cookieValue.replace('%2C' + style, '');
		cookieValue = cookieValue.replace(style, '');
		if (cookieValue.length == 9) {
			cookieValue = cookieValue.replace('%2C', '');
		}
	}
	cookieValue = unescape(cookieValue);
	Set_Cookie(cookieName,cookieValue,'21');
}

function addToCompareCookie(cookieName, style)
{
	var cookieValue = readCookie(cookieName);
	var cookieLength;
	if (cookieValue != null) {
		cookieLength = cookieValue.length;
	} else {
		cookieLength = 0;
	}

	if (isStyleInCompareCookie(cookieName, style) == false)
	{
		var updatedList="";
		if (cookieLength == 0) {
			 updatedList = style;
		} else if (cookieLength > 0
				&& (cookieValue.substring(cookieLength - 3, cookieLength) == '%2C')) {
			//var updatedList = cookieValue + style;
			 updatedList = style;
		} else if (cookieLength > 0) {
			 updatedList = cookieValue + ',' + style;
		}
		//Cookie expires after 21 days, the items added to bucket will be there for 21 days only
		updatedList = unescape(updatedList);
		Set_Cookie(cookieName,updatedList,'21');
	}	
}

function addStyle(style) {
	addToCompareCookie("userproduct", style);
	removeFromCompareCookie("removeuserproduct",style);
}


function removeStyle(style) {
	if (isStyleInCompareCookie('userproduct',style) == true) {
		removeFromCompareCookie('userproduct',style);
	}
	addToCompareCookie("removeuserproduct", style);
}

function removeStyleFromList(style, styleList) {
	var styleArray = styleList.value.split(",");
	var styleCount = 0;
	styleList.value = "";
	while (styleCount < styleArray.length) {
		if (styleArray[styleCount] != "" && style != styleArray[styleCount]) {
			styleList.value = styleList.value + "," + styleArray[styleCount];
		}
		styleCount++;
	}
}

/**
 * This function is getting the comparison results. It is called on click of
 * Compare button that exists as part of Compare bucket
 */
function compare() {
	document.getElementById('userProductUpdate').submit();
}

/**
 * This function is for toggling Compare button from 'Add' to 'Remove' state and vice-versa.
 * It also updates the Compare bucket accordingly. 
 * @param style - required parameter, it is the sku value.
 * @param inMode - optional parameter and is used to handle the case where items in
 * cookie don't exist on search result page. Ex: User adds 'shoes' to compare
 * bucket and then searches for 'shirt', so the 'shoe' items in cookie would not
 * exist on 'shirt' search result page.
 */
function toggleCompButton(style, inMode) {
	if (style != null && style != '' && style.match(/[0-9]/) != null) {
		var buttonElem = $('#'.concat(style, 'Compare'));
		if (buttonElem && buttonElem.attr('mode')) {
			var mode = buttonElem.attr('mode');
			// Add item to cookie and change add button to remove
			if (mode == 'add') {
				var cookieValue = readCookie("userproduct");
				if (cookieValue != null && cookieValue != "") {
					var cookieArray = new Array();
					cookieArray = cookieValue.split('%2C');
					if (cookieArray[0] == "") {
						cookieArray.splice(0, 1);
					}
					else if (cookieArray[cookieArray.length -1] == "") 
					{
							cookieArray.splice(cookieArray.length -1, 1);
						
					}
					var cookieLength = cookieArray.length;
					if (cookieLength > 3) {
						$
								.fancybox({
									content : '<p></p><p class="compareMsg compareMsgTitle"><b>You can compare up to four items at a time.</b></p><p class="compareMsg">Remove one or more items before adding another item to compare.</p><p class="compareMsg"><a href="javascript:$.fancybox.close();">Close</a></p>',
									autoScale : false,
									autoDimensions : false,
									width : 210,
									height : 145
								});
						return;
					}
				}
				// Add item to cookie
				addStyle(style);
				// Change add button to remove
				buttonElem.unbind('mouseover');
				buttonElem.unbind('mouseout');
				buttonElem.unbind('mousedown');	
				buttonElem.attr('src', '/pix/common/CompareRemove_ON.gif');
				buttonElem.attr('class', 'compareBtnRem');
				buttonElem.attr('mode', 'remove');
				buttonElem.attr('title', 'Remove item from compare list.');
				buttonElem.bind('mouseover',function(event)
						{
								updateCompAddBtn(event);
						}
				);
				buttonElem.bind('mouseout',function(event)
						{
								updateCompAddBtn(event);
						}
				);
				buttonElem.bind('mousedown',function(event)
						{
								updateCompAddBtn(event);
						}
				);
			}
			// Remove item from cookie and change remove button to add
			else if (mode == 'remove') {
				// Remove item from cookie
				removeStyle(style);
				// Change remove button to add
				// Change add button to remove
				buttonElem.unbind('mouseover');
				buttonElem.unbind('mouseout');
				buttonElem.unbind('mousedown');
				buttonElem.attr('src', '/pix/common/Compare_ON.gif');
				buttonElem.attr('class', 'compareBtnAdd');
				buttonElem.attr('mode', 'add');
				buttonElem.attr('title', 'Add item to compare list.');
				buttonElem.bind('mouseover',function(event)
						{
								updateCompRemBtn(event);
						}
				);
				buttonElem.bind('mouseout',function(event)
						{
								updateCompRemBtn(event);
						}
				);
				buttonElem.bind('mousedown',function(event)
						{
								updateCompRemBtn(event);
						}
				);
			
			}
			// Update compare bucket for the item
			updateCompBucket(style, mode);
		} 
		else if (inMode) {
			if (inMode == 'add') {
				// Add item to cookie
				addStyle(style);
				// Update compare bucket for the item
				updateCompBucket(style, 'add', true);
			} else if (inMode == 'remove') {
				// Add item to cookie
				removeStyle(style);
				// Update compare bucket for the item
				updateCompBucket(style, 'remove', true);
			}
		}
		//window.scrollTo(0, 0);
	}

}

/**
 * This function adds/removes items to/from Compare bucket.
 * @param inStyle - required param, it is the sku value.
 * @param inMode -  required param, allowed values are 'add' and 'remove'.
 * @param prodNotOnCurrPage - optional parameter and is used to handle the case where items in
 * cookie don't exist on search result page. Ex: User adds 'shoes' to compare
 * bucket and then searches for 'shirt', so the 'shoe' items in cookie would not
 * exist on 'shirt' search result page.
 */
function updateCompBucket(inStyle, inMode, prodNotOnCurrPage) {
	var cookieValue = readCookie("userproduct");
	
	if (cookieValue != null) {
		var cookieLength = cookieValue.split('%2C').length;
		// Enable compare button if 2 or more items have been added to bucket.
		if (cookieLength > 1) {
			/*$('#compareBucket').attr('src', '/pix/common/compare_items.gif');*/
			$('#compareBucket').attr('disabled', false);
			$('#compareBucket').removeClass('disabled');
		} else {
			/*$('#compareBucket').attr('src',
					'/pix/common/compare_items_disabled.gif');*/
			$('#compareBucket').attr('disabled', true);
			$('#compareBucket').addClass('disabled');
		}
	}
	if (inStyle && inMode && inStyle != '' && inMode != '') {
		// Adding/removing items to/from compare bucket
		// Looping through all the place holders for thumb nails in bucket to,
		// 1> find an empty spot in case of adding item to bucket
		// 2> shift items to left in case of removal of an item from bucket
		for ( var i = 1; i < 5; i++) {
			var parentThumbnail = $('#compareThumbnail_'.concat(i));
			var thumbnail = $('#thumbnail_'.concat(i));
			var closeElem = $('#thumbnail_close_'.concat(i));
			if (inMode == 'add' && thumbnail.attr('available') == 'yes') {
				// Get the image for adding to compare bucket thumb nail
				var img = 'url(/zoom/' + inStyle + '/40)';
				var alt = $('#'.concat(inStyle, 'Image')).attr('alt');
				if (img) {
					parentThumbnail.attr('closeId', inStyle);
					parentThumbnail.bind('click', function(event) {
						removeItemFromBucket(event);
					});
					if (prodNotOnCurrPage) {
						/*closeElem.attr('prodNotOnCurrPage', prodNotOnCurrPage);*/
						parentThumbnail.attr('prodNotOnCurrPage', prodNotOnCurrPage);
					}
					parentThumbnail.attr('hoverId', i);
					parentThumbnail.bind('mouseover',function(event)
							{
									updateHover(event);
							}
					);
					parentThumbnail.bind('mouseout',function(event)
							{
									updateHover(event);
							}
					);
					// Add image to thumb nail
					thumbnail.css('background-image', img);
					thumbnail.attr('title', alt);
					thumbnail.attr('available', 'no');
					thumbnail.attr('removeId', inStyle);
					
					// Show the close image on thumb nail
					closeElem.css('display', 'block');
					closeElem.css('background','url(/pix/common/remove_x.png)');
				}
				break; // out of outer for loop
			} else if (inMode == 'remove'
					&& thumbnail.attr('removeId') == inStyle) {
				var j;
				// Left shift all the items that exist to the right of target(item
				// to be removed)
				for (j = i; j < 5; j++) {
					var k = j + 1;
					var currParElem = $('#compareThumbnail_'.concat(j));
					var nextParElem = $('#compareThumbnail_'.concat(k));
					var currElem = $('#thumbnail_'.concat(j));
					var nextElem = $('#thumbnail_'.concat(k));
					var currCloseElem = $('#thumbnail_close_'.concat(j));
					//var nextCloseElem = $('#thumbnail_close_'.concat(k));
					if (currElem) {
						if (nextElem && nextElem.attr('removeId') != null
								&& nextElem.attr('removeId') != '') {
							currParElem.unbind('click');
							currParElem.unbind('mouseover');
							currParElem.unbind('mouseout');
							currParElem.attr('closeId', nextParElem
									.attr('closeId'));
							currParElem.attr('prodNotOnCurrPage',
									nextParElem.attr('prodNotOnCurrPage'));
							currParElem.bind('click', function(event) {
								removeItemFromBucket(event);
							});
							currParElem.bind('mouseover',function(event)
									{
											updateHover(event);
									}
							);
							currParElem.bind('mouseout',function(event)
									{
											updateHover(event);
									}
							);
							currElem.css('background-image', nextElem
									.css('background-image'));
							currElem.attr('title', nextElem.attr('title'));
							currElem.attr('available', 'no');
							currElem.attr('removeId', nextElem.attr('removeId'));
						} else {
							currParElem.unbind('click');
							currParElem.unbind('mouseover');
							currParElem.unbind('mouseout');
							currParElem.attr('closeId', '');
							currParElem.attr('hoverId', '');
							currParElem.attr('prodNotOnCurrPage', '');
							currElem.css('background-image', 'none');
							currElem.attr('title', '');
							currElem.attr('available', 'yes');
							currElem.attr('removeId', '');
							currCloseElem.css('display', 'none');
							currCloseElem.css('background','')
							break;// out of "j" for loop
						}
					}
				}
				break; // out of outer for loop
			}
		}
	}
}

/**
 * This function handles the click of 'x' present on thumbnail
 * @param event
 */
function removeItemFromBucket(event) {
	var id="";
	if (event.srcElment)
		id = event.srcElement.id;
	else if (event.currentTarget) // For firefox
		id = event.currentTarget.id;

	var closeElemId = $('#'.concat(id)).attr('closeId');
	var prodNotExists = $('#'.concat(id)).attr('prodNotOnCurrPage');
	if (prodNotExists) {
		toggleCompButton(closeElemId, 'remove');
	} else {
		toggleCompButton(closeElemId);
	}
}
/**
 * This function is for updating the Add state of Compare button present on Search result page.
 * @param event
 */
function updateCompAddBtn(event)
{
	var id="";
	if (event.srcElment)
		id = event.srcElement.id;
	else if (event.target) // For firefox
		id = event.target.id;
	if(event.type == 'mouseover')
	{
		$('#'.concat(id)).attr('src','/pix/common/CompareRemove_OVER.gif');
	}
	else if(event.type == 'mouseout')
	{
		$('#'.concat(id)).attr('src','/pix/common/CompareRemove_ON.gif');
	}
	else if(event.type == 'mousedown')
	{
		$('#'.concat(id)).attr('src','/pix/common/CompareRemove_OnCLICK.gif');
	}
}
/**
 * This function is for updating the Remove state of Compare button present on Search result page.
 * @param event
 */
function updateCompRemBtn(event)
{
	var id="";
	if (event.srcElment)
		id = event.srcElement.id;
	else if (event.target) // For firefox
		id = event.target.id;
	if(event.type == 'mouseover')
	{
		$('#'.concat(id)).attr('src','/pix/common/CompareOVER.gif');
	}
	else if(event.type == 'mouseout')
	{
		$('#'.concat(id)).attr('src','/pix/common/Compare_ON.gif');
	}
	else if(event.type == 'mousedown')
	{
		$('#'.concat(id)).attr('src','/pix/common/Compare_OnCLICK.gif');
	}
}

/**
 * This function is for changing the state of x button in compare bucket on hovering over the image
 * @param event
 */

function updateHover(event)
{
	var id="";
	if (event.srcElment)
		id = event.srcElement.id;
	else if (event.currentTarget) // For firefox
		id = event.currentTarget.id;
	
	id = $('#'.concat(id)).attr('hoverId');
	var closeElemId = $('#thumbnail_close_'.concat(id));  
	
	if(event.type == "mouseover")
	{
		closeElemId.css('background','url(/pix/common/remove_x.png) no-repeat 0 -28px');
	}
	
	if(event.type == "mouseout")
	{
		closeElemId.css('background','url(/pix/common/remove_x.png)');
	}	
}


(function($) {
/* sidebar_toggle adapted from menu_toggle_adder */
$.fn.menu_toggle = function(options){
var defaults = {	
animate_toggle: 'yes',
highlight_selected_link: 'no',
toggle: '/pix/common/arrows_small_right.gif',
toggled: '/pix/common/arrows_small_down.gif',
toggle_selected: '/pix/common/arrows_small_right.gif',
toggled_selected: '/pix/common/arrows_small_down.gif'	
};
 // $('#sidebarWrapper li ul.sbSubCat').css('display','none');
 // $('#sidebarWrapper li img.toggler').css('display','inline');
var opts = $.extend(defaults, options);
var sidebarItems = document.getElementById('sidebarWrapper');
if(!sidebarItems) return;
	/*-- if a h3 has no a tag, add empty a tag for accessibility. --*/	
sidebarItems = $(sidebarItems.getElementsByTagName('li'));
	sidebarItems.find("h3").parent('li:has(ul)').each(function(){
		var $this = $(this);	
		 $this.children("h3:not(:has('a'))").eq("0").children("span:not(:has('a'))").wrapInner('<a href="#" class="linkStyle2"></a>');                          
                             /* if no span tag use this:    $this.children("h3:not(:has('a'))").eq("0").wrapInner('<a href="#" class="linkStyle2"></a>'); */
	});
	/*-- Find the selected link with the image 'toggle.gif' and change it to 'toggled.gif' --*/	
	sidebarItems.find("a:has('img.toggler')").each(function(){
	              var $this = $(this);
	              var $section;
	              var toggler_parent = $this.parent('div').attr('class');
	              if (toggler_parent == 'titleStyle'){
	              $section = $this.parent('div.titleStyle');
	              defaults.toggle= '/pix/common/arrow_big_right.png';
                             defaults.toggled= '/pix/common/arrow_big_down.png';
                             defaults.toggle_selected= '/pix/common/arrow_big_right.png';
                             defaults.toggled_selected= '/pix/common/arrow_big_down.png';	
	              } else {
	               $section = $this;
	              }
		var toggler_src = $this.children("img.toggler").eq("0").attr("src");
		if (toggler_src == defaults.toggled_selected && defaults.animate_toggle == "yes") {
			$this.toggle(function(){
				$section.nextAll("ul").slideUp("fast");
				$section.nextAll("a.facetReset").slideUp("fast");
				$this.children("img.toggler").eq("0").attr("src", defaults.toggle_selected);
				return false;
			}, function(){
				$section.nextAll("ul").slideDown("fast");
				$section.nextAll("a.facetReset").slideDown("fast");
				$this.children("img.toggler").eq("0").attr("src", defaults.toggled_selected);
				return false;
			});
		}
		else if (toggler_src == defaults.toggle && defaults.animate_toggle == "yes") {
				$this.toggle(function(){
					$section.nextAll("ul").slideDown("fast");	
					$section.nextAll("a.facetReset").slideDown("fast");
					$this.children("img.toggler").eq("0").attr("src", defaults.toggled);
					return false;
				}, function(){
					$section.nextAll("ul").slideUp("fast");
					$section.nextAll("a.facetReset").slideUp("fast");
					$this.children("img.toggler").eq("0").attr("src", defaults.toggle);
					return false;
				});
			}
		/*--- if toggle_selected = no --*/		
	else if (toggler_src == defaults.toggled_selected && defaults.animate_toggle == "no") {
			$this.toggle(function(){
				$section.nextAll("ul").hide();
				$section.nextAll("a.facetReset").hide();
				$this.children("img.toggler").eq("0").attr("src", defaults.toggle_selected);
				return false;
			}, function(){
				$section.nextAll("ul").show();
				$section.nextAll("a.facetReset").show();
				$this.children("img.toggler").eq("0").attr("src", defaults.toggled_selected);
				return false;
			});
		}
		
		else if (toggler_src == defaults.toggle && defaults.animate_toggle == "no") {
				$this.toggle(function(){
					$section.nextAll("ul").show();
					$section.nextAll("a.facetReset").show();
					$this.children("img.toggler").eq("0").attr("src", defaults.toggled);
					return false;
				}, function(){
					$section.nextAll("ul").hide();
					$section.nextAll("a.facetReset").hide();
					$this.children("img.toggler").eq("0").attr("src", defaults.toggle);
					return false;
				});	
			}
	});
	sidebarItems.find("h3:has('a.linkStyle2'), h3:has('span:has('a.linkStyle2')')").each(function(){   
		var $this = $(this);						
		var toggler_src = $this.prev("a").children("img").attr("src");				
		if (toggler_src == defaults.toggled_selected && defaults.animate_toggle == "yes") {		
			$this.toggle(function(){
				$this.nextAll("ul").slideUp("fast");
				$this.prev("a").children("img").attr("src", defaults.toggle_selected);
				return false;
			}, function(){
				$this.nextAll("ul").slideDown("fast");
				$this.prev("a").children("img").attr("src", defaults.toggled_selected);
				return false;
			});
		}		
		else if (toggler_src == defaults.toggle && defaults.animate_toggle == "yes") {			
				$this.toggle(function(){
					$this.nextAll("ul").slideDown("fast");
					$this.prev("a").children("img").attr("src", defaults.toggled);
					return false;
				}, function(){
					$this.nextAll("ul").slideUp("fast");
					$this.prev("a").children("img").attr("src", defaults.toggle);
					return false;
				});
			}			
		/*--- if toggle_selected = no --*/			
		else if (toggler_src == defaults.toggled_selected && defaults.animate_toggle == "no") {		
			$this.toggle(function(){
				$this.nextAll("ul").hide();
				$this.prev("img").attr("src", defaults.toggle_selected);
				return false;
			}, function(){
				$this.nextAll("ul").show();
				$this.prev("a").children("img").attr("src", defaults.toggled_selected);
				return false;
			});
		}		
		else if (toggler_src == defaults.toggle && defaults.animate_toggle == "no") {			
				$this.toggle(function(){
					$this.nextAll("ul").show();
					$this.prev("a").children("img").attr("src", defaults.toggled);
					return false;
				}, function(){
					$this.nextAll("ul").hide();
					$this.prev("a").children("img").attr("src", defaults.toggle);
					return false;
				});	
			}
	});
	/*-- Add selected class to selected parent li's --*/	           
                sidebarItems.filter(":has(h3.menu_selected)").addClass('menu_selected_holder');
                sidebarItems.find("ul li:has(h3.menu_selected)").removeClass('menu_selected_holder');
}
})(jQuery);


/*! Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.4
 * 
 * Requires: 1.2.2+
 */
(function($) {

var types = ['DOMMouseScroll', 'mousewheel'];

$.event.special.mousewheel = {
    setup: function() {
        if ( this.addEventListener ) {
            for ( var i=types.length; i; ) {
                this.addEventListener( types[--i], handler, false );
            }
        } else {
            this.onmousewheel = handler;
        }
    },    
    teardown: function() {
        if ( this.removeEventListener ) {
            for ( var i=types.length; i; ) {
                this.removeEventListener( types[--i], handler, false );
            }
        } else {
            this.onmousewheel = null;
        }
    }
};
$.fn.extend({
    mousewheel: function(fn) {
        return fn ? this.bind("mousewheel", fn) : this.trigger("mousewheel");
    },    
    unmousewheel: function(fn) {
        return this.unbind("mousewheel", fn);
    }
});

function handler(event) {
    var orgEvent = event || window.event, args = [].slice.call( arguments, 1 ), delta = 0, returnValue = true, deltaX = 0, deltaY = 0;
    event = $.event.fix(orgEvent);
    event.type = "mousewheel";
    
    // Old school scrollwheel delta
    if ( event.wheelDelta ) { delta = event.wheelDelta/120; }
    if ( event.detail     ) { delta = -event.detail/3; }
    
    // New school multidimensional scroll (touchpads) deltas
    deltaY = delta;
    
    // Gecko
    if ( orgEvent.axis !== undefined && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {
        deltaY = 0;
        deltaX = -1*delta;
    }
    
    // Webkit
    if ( orgEvent.wheelDeltaY !== undefined ) { deltaY = orgEvent.wheelDeltaY/120; }
    if ( orgEvent.wheelDeltaX !== undefined ) { deltaX = -1*orgEvent.wheelDeltaX/120; }
    
    // Add event and delta to the front of the arguments
    args.unshift(event, delta, deltaX, deltaY);
    
    return $.event.handle.apply(this, args);
}
})(jQuery);

/*
 * jScrollPane - v2.0.0beta9 - 2011-02-04
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(D,N){var ay,P=this,X,aj,w,al,S,Y,z,r,az,aE,au,j,I,i,k,Z,T,ap,W,u,B,aq,ae,am,G,m,at,ax,y,av,aH,g,K,ai=true,O=true,aG=false,l=false,ao=D.clone(false,false).empty(),ab=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";aH=D.css("paddingTop")+" "+D.css("paddingRight")+" "+D.css("paddingBottom")+" "+D.css("paddingLeft");g=(parseInt(D.css("paddingLeft"),10)||0)+(parseInt(D.css("paddingRight"),10)||0);function ar(aQ){var aO,aP,aK,aM,aL,aJ,aI,aN;ay=aQ;if(X===c){aI=D.scrollTop();aN=D.scrollLeft();D.css({overflow:"hidden",padding:0});aj=D.innerWidth()+g;w=D.innerHeight();D.width(aj);X=b('<div class="jspPane" />').css("padding",aH).append(D.children());al=b('<div class="jspContainer" />').css({width:aj+"px",height:w+"px"}).append(X).appendTo(D)}else{D.css("width","");aJ=D.innerWidth()+g!=aj||D.outerHeight()!=w;if(aJ){aj=D.innerWidth()+g;w=D.innerHeight();al.css({width:aj+"px",height:w+"px"})}if(!aJ&&K==S&&X.outerHeight()==Y){D.width(aj);return}K=S;X.css("width","");D.width(aj);al.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}aO=X.clone(false,false).css("position","absolute");aP=b('<div style="width:1px; position: relative;" />').append(aO);b("body").append(aP);S=Math.max(X.outerWidth(),aO.outerWidth());aP.remove();Y=X.outerHeight();z=S/aj;r=Y/w;az=r>1;aE=z>1;if(!(aE||az)){D.removeClass("jspScrollable");X.css({top:0,width:al.width()-g});o();E();Q();x();ah()}else{D.addClass("jspScrollable");aK=ay.maintainPosition&&(I||Z);if(aK){aM=aC();aL=aA()}aF();A();F();if(aK){M(aM,false);L(aL,false)}J();af();an();if(ay.enableKeyboardNavigation){R()}if(ay.clickOnTrack){q()}C();if(ay.hijackInternalLinks){n()}}if(ay.autoReinitialise&&!av){av=setInterval(function(){ar(ay)},ay.autoReinitialiseDelay)}else{if(!ay.autoReinitialise&&av){clearInterval(av)}}aI&&D.scrollTop(0)&&L(aI,false);aN&&D.scrollLeft(0)&&M(aN,false);D.trigger("jsp-initialised",[aE||az])}function aF(){if(az){al.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));T=al.find(">.jspVerticalBar");ap=T.find(">.jspTrack");au=ap.find(">.jspDrag");if(ay.showArrows){aq=b('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",aD(0,-1)).bind("click.jsp",aB);ae=b('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",aD(0,1)).bind("click.jsp",aB);if(ay.arrowScrollOnHover){aq.bind("mouseover.jsp",aD(0,-1,aq));ae.bind("mouseover.jsp",aD(0,1,ae))}ak(ap,ay.verticalArrowPositions,aq,ae)}u=w;al.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){u-=b(this).outerHeight()});au.hover(function(){au.addClass("jspHover")},function(){au.removeClass("jspHover")}).bind("mousedown.jsp",function(aI){b("html").bind("dragstart.jsp selectstart.jsp",aB);au.addClass("jspActive");var s=aI.pageY-au.position().top;b("html").bind("mousemove.jsp",function(aJ){U(aJ.pageY-s,false)}).bind("mouseup.jsp mouseleave.jsp",aw);return false});p()}}function p(){ap.height(u+"px");I=0;W=ay.verticalGutter+ap.outerWidth();X.width(aj-W-g);if(T.position().left===0){X.css("margin-left",W+"px")}}function A(){if(aE){al.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));am=al.find(">.jspHorizontalBar");G=am.find(">.jspTrack");i=G.find(">.jspDrag");if(ay.showArrows){ax=b('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",aD(-1,0)).bind("click.jsp",aB);y=b('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",aD(1,0)).bind("click.jsp",aB);
if(ay.arrowScrollOnHover){ax.bind("mouseover.jsp",aD(-1,0,ax));y.bind("mouseover.jsp",aD(1,0,y))}ak(G,ay.horizontalArrowPositions,ax,y)}i.hover(function(){i.addClass("jspHover")},function(){i.removeClass("jspHover")}).bind("mousedown.jsp",function(aI){b("html").bind("dragstart.jsp selectstart.jsp",aB);i.addClass("jspActive");var s=aI.pageX-i.position().left;b("html").bind("mousemove.jsp",function(aJ){V(aJ.pageX-s,false)}).bind("mouseup.jsp mouseleave.jsp",aw);return false});m=al.innerWidth();ag()}}function ag(){al.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){m-=b(this).outerWidth()});G.width(m+"px");Z=0}function F(){if(aE&&az){var aI=G.outerHeight(),s=ap.outerWidth();u-=aI;b(am).find(">.jspCap:visible,>.jspArrow").each(function(){m+=b(this).outerWidth()});m-=s;w-=s;aj-=aI;G.parent().append(b('<div class="jspCorner" />').css("width",aI+"px"));p();ag()}if(aE){X.width((al.outerWidth()-g)+"px")}Y=X.outerHeight();r=Y/w;if(aE){at=Math.ceil(1/z*m);if(at>ay.horizontalDragMaxWidth){at=ay.horizontalDragMaxWidth}else{if(at<ay.horizontalDragMinWidth){at=ay.horizontalDragMinWidth}}i.width(at+"px");k=m-at;ad(Z)}if(az){B=Math.ceil(1/r*u);if(B>ay.verticalDragMaxHeight){B=ay.verticalDragMaxHeight}else{if(B<ay.verticalDragMinHeight){B=ay.verticalDragMinHeight}}au.height(B+"px");j=u-B;ac(I)}}function ak(aJ,aL,aI,s){var aN="before",aK="after",aM;if(aL=="os"){aL=/Mac/.test(navigator.platform)?"after":"split"}if(aL==aN){aK=aL}else{if(aL==aK){aN=aL;aM=aI;aI=s;s=aM}}aJ[aN](aI)[aK](s)}function aD(aI,s,aJ){return function(){H(aI,s,this,aJ);this.blur();return false}}function H(aL,aK,aO,aN){aO=b(aO).addClass("jspActive");var aM,aJ,aI=true,s=function(){if(aL!==0){P.scrollByX(aL*ay.arrowButtonSpeed)}if(aK!==0){P.scrollByY(aK*ay.arrowButtonSpeed)}aJ=setTimeout(s,aI?ay.initialDelay:ay.arrowRepeatFreq);aI=false};s();aM=aN?"mouseout.jsp":"mouseup.jsp";aN=aN||b("html");aN.bind(aM,function(){aO.removeClass("jspActive");aJ&&clearTimeout(aJ);aJ=null;aN.unbind(aM)})}function q(){x();if(az){ap.bind("mousedown.jsp",function(aN){if(aN.originalTarget===c||aN.originalTarget==aN.currentTarget){var aL=b(this),aO=aL.offset(),aM=aN.pageY-aO.top-I,aJ,aI=true,s=function(){var aR=aL.offset(),aS=aN.pageY-aR.top-B/2,aP=w*ay.scrollPagePercent,aQ=j*aP/(Y-w);if(aM<0){if(I-aQ>aS){P.scrollByY(-aP)}else{U(aS)}}else{if(aM>0){if(I+aQ<aS){P.scrollByY(aP)}else{U(aS)}}else{aK();return}}aJ=setTimeout(s,aI?ay.initialDelay:ay.trackClickRepeatFreq);aI=false},aK=function(){aJ&&clearTimeout(aJ);aJ=null;b(document).unbind("mouseup.jsp",aK)};s();b(document).bind("mouseup.jsp",aK);return false}})}if(aE){G.bind("mousedown.jsp",function(aN){if(aN.originalTarget===c||aN.originalTarget==aN.currentTarget){var aL=b(this),aO=aL.offset(),aM=aN.pageX-aO.left-Z,aJ,aI=true,s=function(){var aR=aL.offset(),aS=aN.pageX-aR.left-at/2,aP=aj*ay.scrollPagePercent,aQ=k*aP/(S-aj);if(aM<0){if(Z-aQ>aS){P.scrollByX(-aP)}else{V(aS)}}else{if(aM>0){if(Z+aQ<aS){P.scrollByX(aP)}else{V(aS)}}else{aK();return}}aJ=setTimeout(s,aI?ay.initialDelay:ay.trackClickRepeatFreq);aI=false},aK=function(){aJ&&clearTimeout(aJ);aJ=null;b(document).unbind("mouseup.jsp",aK)};s();b(document).bind("mouseup.jsp",aK);return false}})}}function x(){if(G){G.unbind("mousedown.jsp")}if(ap){ap.unbind("mousedown.jsp")}}function aw(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(au){au.removeClass("jspActive")}if(i){i.removeClass("jspActive")}}function U(s,aI){if(!az){return}if(s<0){s=0}else{if(s>j){s=j}}if(aI===c){aI=ay.animateScroll}if(aI){P.animate(au,"top",s,ac)}else{au.css("top",s);ac(s)}}function ac(aI){if(aI===c){aI=au.position().top}al.scrollTop(0);I=aI;var aL=I===0,aJ=I==j,aK=aI/j,s=-aK*(Y-w);if(ai!=aL||aG!=aJ){ai=aL;aG=aJ;D.trigger("jsp-arrow-change",[ai,aG,O,l])}v(aL,aJ);X.css("top",s);D.trigger("jsp-scroll-y",[-s,aL,aJ]).trigger("scroll")}function V(aI,s){if(!aE){return}if(aI<0){aI=0}else{if(aI>k){aI=k}}if(s===c){s=ay.animateScroll}if(s){P.animate(i,"left",aI,ad)
}else{i.css("left",aI);ad(aI)}}function ad(aI){if(aI===c){aI=i.position().left}al.scrollTop(0);Z=aI;var aL=Z===0,aK=Z==k,aJ=aI/k,s=-aJ*(S-aj);if(O!=aL||l!=aK){O=aL;l=aK;D.trigger("jsp-arrow-change",[ai,aG,O,l])}t(aL,aK);X.css("left",s);D.trigger("jsp-scroll-x",[-s,aL,aK]).trigger("scroll")}function v(aI,s){if(ay.showArrows){aq[aI?"addClass":"removeClass"]("jspDisabled");ae[s?"addClass":"removeClass"]("jspDisabled")}}function t(aI,s){if(ay.showArrows){ax[aI?"addClass":"removeClass"]("jspDisabled");y[s?"addClass":"removeClass"]("jspDisabled")}}function L(s,aI){var aJ=s/(Y-w);U(aJ*j,aI)}function M(aI,s){var aJ=aI/(S-aj);V(aJ*k,s)}function aa(aU,aP,aJ){var aN,aK,aL,s=0,aT=0,aI,aO,aR,aQ,aS;try{aN=b(aU)}catch(aM){return}aK=aN.outerHeight();aL=aN.outerWidth();al.scrollTop(0);al.scrollLeft(0);while(!aN.is(".jspPane")){s+=aN.position().top;aT+=aN.position().left;aN=aN.offsetParent();if(/^body|html$/i.test(aN[0].nodeName)){return}}aI=aA();aO=aI+w;if(s<aI||aP){aQ=s-ay.verticalGutter}else{if(s+aK>aO){aQ=s-w+aK+ay.verticalGutter}}if(aQ){L(aQ,aJ)}viewportLeft=aC();aR=viewportLeft+aj;if(aT<viewportLeft||aP){aS=aT-ay.horizontalGutter}else{if(aT+aL>aR){aS=aT-aj+aL+ay.horizontalGutter}}if(aS){M(aS,aJ)}}function aC(){return -X.position().left}function aA(){return -X.position().top}function af(){al.unbind(ab).bind(ab,function(aL,aM,aK,aI){var aJ=Z,s=I;P.scrollBy(aK*ay.mouseWheelSpeed,-aI*ay.mouseWheelSpeed,false);return aJ==Z&&s==I})}function o(){al.unbind(ab)}function aB(){return false}function J(){X.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(s){aa(s.target,false)})}function E(){X.find(":input,a").unbind("focus.jsp")}function R(){var s,aI;X.focus(function(){D.focus()});D.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(aM){if(aM.target!==this){return}var aL=Z,aK=I;switch(aM.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:s=aM.keyCode;aJ();break;case 35:L(Y-w);s=null;break;case 36:L(0);s=null;break}aI=aM.keyCode==s&&aL!=Z||aK!=I;return !aI}).bind("keypress.jsp",function(aK){if(aK.keyCode==s){aJ()}return !aI});if(ay.hideFocus){D.css("outline","none");if("hideFocus" in al[0]){D.attr("hideFocus",true)}}else{D.css("outline","");if("hideFocus" in al[0]){D.attr("hideFocus",false)}}function aJ(){var aL=Z,aK=I;switch(s){case 40:P.scrollByY(ay.keyboardSpeed,false);break;case 38:P.scrollByY(-ay.keyboardSpeed,false);break;case 34:case 32:P.scrollByY(w*ay.scrollPagePercent,false);break;case 33:P.scrollByY(-w*ay.scrollPagePercent,false);break;case 39:P.scrollByX(ay.keyboardSpeed,false);break;case 37:P.scrollByX(-ay.keyboardSpeed,false);break}aI=aL!=Z||aK!=I;return aI}}function Q(){D.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function C(){if(location.hash&&location.hash.length>1){var aJ,aI;try{aJ=b(location.hash)}catch(s){return}if(aJ.length&&X.find(location.hash)){if(al.scrollTop()===0){aI=setInterval(function(){if(al.scrollTop()>0){aa(location.hash,true);b(document).scrollTop(al.position().top);clearInterval(aI)}},50)}else{aa(location.hash,true);b(document).scrollTop(al.position().top)}}}}function ah(){b("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function n(){ah();b("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var s=this.href.split("#"),aI;if(s.length>1){aI=s[1];if(aI.length>0&&X.find("#"+aI).length>0){aa("#"+aI,true);return false}}})}function an(){var aJ,aI,aL,aK,aM,s=false;al.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(aN){var aO=aN.originalEvent.touches[0];aJ=aC();aI=aA();aL=aO.pageX;aK=aO.pageY;aM=false;s=true}).bind("touchmove.jsp",function(aQ){if(!s){return}var aP=aQ.originalEvent.touches[0],aO=Z,aN=I;P.scrollTo(aJ+aL-aP.pageX,aI+aK-aP.pageY);aM=aM||Math.abs(aL-aP.pageX)>5||Math.abs(aK-aP.pageY)>5;return aO==Z&&aN==I}).bind("touchend.jsp",function(aN){s=false}).bind("click.jsp-touchclick",function(aN){if(aM){aM=false;return false}})}function h(){var s=aA(),aI=aC();
D.removeClass("jspScrollable").unbind(".jsp");D.replaceWith(ao.append(X.children()));ao.scrollTop(s);ao.scrollLeft(aI)}b.extend(P,{reinitialise:function(aI){aI=b.extend({},ay,aI);ar(aI)},scrollToElement:function(aJ,aI,s){aa(aJ,aI,s)},scrollTo:function(aJ,s,aI){M(aJ,aI);L(s,aI)},scrollToX:function(aI,s){M(aI,s)},scrollToY:function(s,aI){L(s,aI)},scrollToPercentX:function(aI,s){M(aI*(S-aj),s)},scrollToPercentY:function(aI,s){L(aI*(Y-w),s)},scrollBy:function(aI,s,aJ){P.scrollByX(aI,aJ);P.scrollByY(s,aJ)},scrollByX:function(s,aJ){var aI=aC()+s,aK=aI/(S-aj);V(aK*k,aJ)},scrollByY:function(s,aJ){var aI=aA()+s,aK=aI/(Y-w);U(aK*j,aJ)},positionDragX:function(s,aI){V(s,aI)},positionDragY:function(aI,s){V(aI,s)},animate:function(aI,aL,s,aK){var aJ={};aJ[aL]=s;aI.animate(aJ,{duration:ay.animateDuration,ease:ay.animateEase,queue:false,step:aK})},getContentPositionX:function(){return aC()},getContentPositionY:function(){return aA()},getContentWidth:function(){return S()},getContentHeight:function(){return Y()},getPercentScrolledX:function(){return aC()/(S-aj)},getPercentScrolledY:function(){return aA()/(Y-w)},getIsScrollableH:function(){return aE},getIsScrollableV:function(){return az},getContentPane:function(){return X},scrollToBottom:function(s){U(j,s)},hijackInternalLinks:function(){n()},destroy:function(){h()}});ar(N)}f=b.extend({},b.fn.jScrollPane.defaults,f);b.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){f[this]=f[this]||f.speed});var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);



/*
 * jQuery validation plug-in 1.5.5
 *
 * http://bassistance.de/jquery-plugins/jquery-plugin-validation/
 * http://docs.jquery.com/Plugins/Validation
 *
 * Copyright (c) 2006 - 2008 Jrn Zaefferer
 *
 * $Id: jquery.validate.js 6403 2009-06-17 14:27:16Z joern.zaefferer $
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */

(function($) {

$.extend($.fn, {
	// http://docs.jquery.com/Plugins/Validation/validate
	validate: function( options ) {

		// if nothing is selected, return nothing; can't chain anyway
		if (!this.length) {
			options && options.debug && window.console && console.warn( "nothing selected, can't validate, returning nothing" );
			return;
		}

		// check if a validator for this form was already created
		var validator = $.data(this[0], 'validator');
		if ( validator ) {
			return validator;
		}
		
		validator = new $.validator( options, this[0] );
		$.data(this[0], 'validator', validator); 
		
		if ( validator.settings.onsubmit ) {
		
			// allow suppresing validation by adding a cancel class to the submit button
			this.find("input, button").filter(".cancel").click(function() {
				validator.cancelSubmit = true;
			});
			
			// when a submitHandler is used, capture the submitting button
			if (validator.settings.submitHandler) {
				this.find("input, button").filter(":submit").click(function() {
					validator.submitButton = this;
				});
			}
		
			// validate the form on submit
			this.submit( function( event ) {
				if ( validator.settings.debug )
					// prevent form submit to be able to see console output
					event.preventDefault();
					
				function handle() {
					if ( validator.settings.submitHandler ) {
						if (validator.submitButton) {
							// insert a hidden input as a replacement for the missing submit button
							var hidden = $("<input type='hidden'/>").attr("name", validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);
						}
						validator.settings.submitHandler.call( validator, validator.currentForm );
						if (validator.submitButton) {
							// and clean up afterwards; thanks to no-block-scope, hidden can be referenced
							hidden.remove();
						}
						return false;
					}
					return true;
				}
					
				// prevent submit for invalid forms or custom submit handlers
				if ( validator.cancelSubmit ) {
					validator.cancelSubmit = false;
					return handle();
				}
				if ( validator.form() ) {
					if ( validator.pendingRequest ) {
						validator.formSubmitted = true;
						return false;
					}
					return handle();
				} else {
					validator.focusInvalid();
					return false;
				}
			});
		}
		
		return validator;
	},
	// http://docs.jquery.com/Plugins/Validation/valid
	valid: function() {
        if ( $(this[0]).is('form')) {
            return this.validate().form();
        } else {
            var valid = true;
            var validator = $(this[0].form).validate();
            this.each(function() {
				valid &= validator.element(this);
            });
            return valid;
        }
    },
	// attributes: space seperated list of attributes to retrieve and remove
	removeAttrs: function(attributes) {
		var result = {},
			$element = this;
		$.each(attributes.split(/\s/), function(index, value) {
			result[value] = $element.attr(value);
			$element.removeAttr(value);
		});
		return result;
	},
	// http://docs.jquery.com/Plugins/Validation/rules
	rules: function(command, argument) {
		var element = this[0];
		
		if (command) {
			var settings = $.data(element.form, 'validator').settings;
			var staticRules = settings.rules;
			var existingRules = $.validator.staticRules(element);
			switch(command) {
			case "add":
				$.extend(existingRules, $.validator.normalizeRule(argument));
				staticRules[element.name] = existingRules;
				if (argument.messages)
					settings.messages[element.name] = $.extend( settings.messages[element.name], argument.messages );
				break;
			case "remove":
				if (!argument) {
					delete staticRules[element.name];
					return existingRules;
				}
				var filtered = {};
				$.each(argument.split(/\s/), function(index, method) {
					filtered[method] = existingRules[method];
					delete existingRules[method];
				});
				return filtered;
			}
		}
		
		var data = $.validator.normalizeRules(
		$.extend(
			{},
			$.validator.metadataRules(element),
			$.validator.classRules(element),
			$.validator.attributeRules(element),
			$.validator.staticRules(element)
		), element);
		
		// make sure required is at front
		if (data.required) {
			var param = data.required;
			delete data.required;
			data = $.extend({required: param}, data);
		}
		
		return data;
	}
});

// Custom selectors
$.extend($.expr[":"], {
	// http://docs.jquery.com/Plugins/Validation/blank
	blank: function(a) {return !$.trim(a.value);},
	// http://docs.jquery.com/Plugins/Validation/filled
	filled: function(a) {return !!$.trim(a.value);},
	// http://docs.jquery.com/Plugins/Validation/unchecked
	unchecked: function(a) {return !a.checked;}
});

// constructor for validator
$.validator = function( options, form ) {
	this.settings = $.extend( {}, $.validator.defaults, options );
	this.currentForm = form;
	this.init();
};

$.validator.format = function(source, params) {
	if ( arguments.length == 1 ) 
		return function() {
			var args = $.makeArray(arguments);
			args.unshift(source);
			return $.validator.format.apply( this, args );
		};
	if ( arguments.length > 2 && params.constructor != Array  ) {
		params = $.makeArray(arguments).slice(1);
	}
	if ( params.constructor != Array ) {
		params = [ params ];
	}
	$.each(params, function(i, n) {
		source = source.replace(new RegExp("\\{" + i + "\\}", "g"), n);
	});
	return source;
};

$.extend($.validator, {
	
	defaults: {
		messages: {},
		groups: {},
		rules: {},
		errorClass: "error",
		validClass: "valid",
		errorElement: "label",
		focusInvalid: true,
		errorContainer: $( [] ),
		errorLabelContainer: $( [] ),
		onsubmit: true,
		ignore: [],
		ignoreTitle: false,
		onfocusin: function(element) {
			this.lastActive = element;
				
			// hide error label and remove error class on focus if enabled
			if ( this.settings.focusCleanup && !this.blockFocusCleanup ) {
				this.settings.unhighlight && this.settings.unhighlight.call( this, element, this.settings.errorClass, this.settings.validClass );
				this.errorsFor(element).hide();
			}
		},
		onfocusout: function(element) {
			if ( !this.checkable(element) && (element.name in this.submitted || !this.optional(element)) ) {
				this.element(element);
			}
		},
		onkeyup: function(element) {
			if ( element.name in this.submitted || element == this.lastElement ) {
				this.element(element);
			}
		},
		onclick: function(element) {
			if ( element.name in this.submitted )
				this.element(element);
		},
		highlight: function( element, errorClass, validClass ) {
			$(element).addClass(errorClass).removeClass(validClass);
		},
		unhighlight: function( element, errorClass, validClass ) {
			$(element).removeClass(errorClass).addClass(validClass);
		}
	},

	// http://docs.jquery.com/Plugins/Validation/Validator/setDefaults
	setDefaults: function(settings) {
		$.extend( $.validator.defaults, settings );
	},

	messages: {
		required: "This field is required.",
		remote: "Please fix this field.",
		email: "Please enter a valid email address.",
		url: "Please enter a valid URL.",
		date: "Please enter a valid date.",
		dateISO: "Please enter a valid date (ISO).",
		dateDE: "Bitte geben Sie ein gltiges Datum ein.",
		number: "Please enter a valid number.",
		numberDE: "Bitte geben Sie eine Nummer ein.",
		digits: "Please enter only digits",
		creditcard: "Please enter a valid credit card number.",
		equalTo: "Please enter the same value again.",
		accept: "Please enter a value with a valid extension.",
		maxlength: $.validator.format("Please enter no more than {0} characters."),
		minlength: $.validator.format("Please enter at least {0} characters."),
		rangelength: $.validator.format("Please enter a value between {0} and {1} characters long."),
		range: $.validator.format("Please enter a value between {0} and {1}."),
		max: $.validator.format("Please enter a value less than or equal to {0}."),
		min: $.validator.format("Please enter a value greater than or equal to {0}.")
	},
	
	autoCreateRanges: false,
	
	prototype: {
		
		init: function() {
			this.labelContainer = $(this.settings.errorLabelContainer);
			this.errorContext = this.labelContainer.length && this.labelContainer || $(this.currentForm);
			this.containers = $(this.settings.errorContainer).add( this.settings.errorLabelContainer );
			this.submitted = {};
			this.valueCache = {};
			this.pendingRequest = 0;
			this.pending = {};
			this.invalid = {};
			this.reset();
			
			var groups = (this.groups = {});
			$.each(this.settings.groups, function(key, value) {
				$.each(value.split(/\s/), function(index, name) {
					groups[name] = key;
				});
			});
			var rules = this.settings.rules;
			$.each(rules, function(key, value) {
				rules[key] = $.validator.normalizeRule(value);
			});
			
			function delegate(event) {
				var validator = $.data(this[0].form, "validator");
				validator.settings["on" + event.type] && validator.settings["on" + event.type].call(validator, this[0] );
			}
			$(this.currentForm)
				.delegate("focusin focusout keyup", ":text, :password, :file, select, textarea", delegate)
				.delegate("click", ":radio, :checkbox", delegate);

			if (this.settings.invalidHandler)
				$(this.currentForm).bind("invalid-form.validate", this.settings.invalidHandler);
		},

		// http://docs.jquery.com/Plugins/Validation/Validator/form
		form: function() {
			this.checkForm();
			$.extend(this.submitted, this.errorMap);
			this.invalid = $.extend({}, this.errorMap);
			if (!this.valid())
				$(this.currentForm).triggerHandler("invalid-form", [this]);
			this.showErrors();
			return this.valid();
		},
		
		checkForm: function() {
			this.prepareForm();
			for ( var i = 0, elements = (this.currentElements = this.elements()); elements[i]; i++ ) {
				this.check( elements[i] );
			}
			return this.valid(); 
		},
		
		// http://docs.jquery.com/Plugins/Validation/Validator/element
		element: function( element ) {
			element = this.clean( element );
			this.lastElement = element;
			this.prepareElement( element );
			this.currentElements = $(element);
			var result = this.check( element );
			if ( result ) {
				delete this.invalid[element.name];
			} else {
				this.invalid[element.name] = true;
			}
			if ( !this.numberOfInvalids() ) {
				// Hide error containers on last error
				this.toHide = this.toHide.add( this.containers );
			}
			this.showErrors();
			return result;
		},

		// http://docs.jquery.com/Plugins/Validation/Validator/showErrors
		showErrors: function(errors) {
			if(errors) {
				// add items to error list and map
				$.extend( this.errorMap, errors );
				this.errorList = [];
				for ( var name in errors ) {
					this.errorList.push({
						message: errors[name],
						element: this.findByName(name)[0]
					});
				}
				// remove items from success list
				this.successList = $.grep( this.successList, function(element) {
					return !(element.name in errors);
				});
			}
			this.settings.showErrors
				? this.settings.showErrors.call( this, this.errorMap, this.errorList )
				: this.defaultShowErrors();
		},
		
		// http://docs.jquery.com/Plugins/Validation/Validator/resetForm
		resetForm: function() {
			if ( $.fn.resetForm )
				$( this.currentForm ).resetForm();
			this.submitted = {};
			this.prepareForm();
			this.hideErrors();
			this.elements().removeClass( this.settings.errorClass );
		},
		
		numberOfInvalids: function() {
			return this.objectLength(this.invalid);
		},
		
		objectLength: function( obj ) {
			var count = 0;
			for ( var i in obj )
				count++;
			return count;
		},
		
		hideErrors: function() {
			this.addWrapper( this.toHide ).hide();
		},
		
		valid: function() {
			return this.size() == 0;
		},
		
		size: function() {
			return this.errorList.length;
		},
		
		focusInvalid: function() {
			if( this.settings.focusInvalid ) {
				try {
					$(this.findLastActive() || this.errorList.length && this.errorList[0].element || []).filter(":visible").focus();
				} catch(e) {
					// ignore IE throwing errors when focusing hidden elements
				}
			}
		},
		
		findLastActive: function() {
			var lastActive = this.lastActive;
			return lastActive && $.grep(this.errorList, function(n) {
				return n.element.name == lastActive.name;
			}).length == 1 && lastActive;
		},
		
		elements: function() {
			var validator = this,
				rulesCache = {};
			
			// select all valid inputs inside the form (no submit or reset buttons)
			// workaround $Query([]).add until http://dev.jquery.com/ticket/2114 is solved
			return $([]).add(this.currentForm.elements)
			.filter(":input")
			.not(":submit, :reset, :image, [disabled]")
			.not( this.settings.ignore )
			.filter(function() {
				!this.name && validator.settings.debug && window.console && console.error( "%o has no name assigned", this);
			
				// select only the first element for each name, and only those with rules specified
				if ( this.name in rulesCache || !validator.objectLength($(this).rules()) )
					return false;
				
				rulesCache[this.name] = true;
				return true;
			});
		},
		
		clean: function( selector ) {
			return $( selector )[0];
		},
		
		errors: function() {
			return $( this.settings.errorElement + "." + this.settings.errorClass, this.errorContext );
		},
		
		reset: function() {
			this.successList = [];
			this.errorList = [];
			this.errorMap = {};
			this.toShow = $([]);
			this.toHide = $([]);
			this.formSubmitted = false;
			this.currentElements = $([]);
		},
		
		prepareForm: function() {
			this.reset();
			this.toHide = this.errors().add( this.containers );
		},
		
		prepareElement: function( element ) {
			this.reset();
			this.toHide = this.errorsFor(element);
		},
	
		check: function( element ) {
			element = this.clean( element );
			
			// if radio/checkbox, validate first element in group instead
			if (this.checkable(element)) {
				element = this.findByName( element.name )[0];
			}
			
			var rules = $(element).rules();
			var dependencyMismatch = false;
			for( method in rules ) {
				var rule = { method: method, parameters: rules[method] };
				try {
					var result = $.validator.methods[method].call( this, element.value.replace(/\r/g, ""), element, rule.parameters );
					
					// if a method indicates that the field is optional and therefore valid,
					// don't mark it as valid when there are no other rules
					if ( result == "dependency-mismatch" ) {
						dependencyMismatch = true;
						continue;
					}
					dependencyMismatch = false;
					
					if ( result == "pending" ) {
						this.toHide = this.toHide.not( this.errorsFor(element) );
						return;
					}
					
					if( !result ) {
						this.formatAndAdd( element, rule );
						return false;
					}
				} catch(e) {
					this.settings.debug && window.console && console.log("exception occured when checking element " + element.id
						 + ", check the '" + rule.method + "' method");
					throw e;
				}
			}
			if (dependencyMismatch)
				return;
			if ( this.objectLength(rules) )
				this.successList.push(element);
			return true;
		},
		
		// return the custom message for the given element and validation method
		// specified in the element's "messages" metadata
		customMetaMessage: function(element, method) {
			if (!$.metadata)
				return;
			
			var meta = this.settings.meta
				? $(element).metadata()[this.settings.meta]
				: $(element).metadata();
			
			return meta && meta.messages && meta.messages[method];
		},
		
		// return the custom message for the given element name and validation method
		customMessage: function( name, method ) {
			var m = this.settings.messages[name];
			return m && (m.constructor == String
				? m
				: m[method]);
		},
		
		// return the first defined argument, allowing empty strings
		findDefined: function() {
			for(var i = 0; i < arguments.length; i++) {
				if (arguments[i] !== undefined)
					return arguments[i];
			}
			return undefined;
		},
		
		defaultMessage: function( element, method) {
			return this.findDefined(
				this.customMessage( element.name, method ),
				this.customMetaMessage( element, method ),
				// title is never undefined, so handle empty string as undefined
				!this.settings.ignoreTitle && element.title || undefined,
				$.validator.messages[method],
				"<strong>Warning: No message defined for " + element.name + "</strong>"
			);
		},
		
		formatAndAdd: function( element, rule ) {
			var message = this.defaultMessage( element, rule.method );
			if ( typeof message == "function" ) 
				message = message.call(this, rule.parameters, element);
			this.errorList.push({
				message: message,
				element: element
			});
			this.errorMap[element.name] = message;
			this.submitted[element.name] = message;
		},
		
		addWrapper: function(toToggle) {
			if ( this.settings.wrapper )
				toToggle = toToggle.add( toToggle.parent( this.settings.wrapper ) );
			return toToggle;
		},
		
		defaultShowErrors: function() {
			for ( var i = 0; this.errorList[i]; i++ ) {
				var error = this.errorList[i];
				this.settings.highlight && this.settings.highlight.call( this, error.element, this.settings.errorClass, this.settings.validClass );
				this.showLabel( error.element, error.message );
			}
			if( this.errorList.length ) {
				this.toShow = this.toShow.add( this.containers );
			}
			if (this.settings.success) {
				for ( var i = 0; this.successList[i]; i++ ) {
					this.showLabel( this.successList[i] );
				}
			}
			if (this.settings.unhighlight) {
				for ( var i = 0, elements = this.validElements(); elements[i]; i++ ) {
					this.settings.unhighlight.call( this, elements[i], this.settings.errorClass, this.settings.validClass );
				}
			}
			this.toHide = this.toHide.not( this.toShow );
			this.hideErrors();
			this.addWrapper( this.toShow ).show();
		},
		
		validElements: function() {
			return this.currentElements.not(this.invalidElements());
		},
		
		invalidElements: function() {
			return $(this.errorList).map(function() {
				return this.element;
			});
		},
		
		showLabel: function(element, message) {
			var label = this.errorsFor( element );
			if ( label.length ) {
				// refresh error/success class
				label.removeClass().addClass( this.settings.errorClass );
			
				// check if we have a generated label, replace the message then
				label.attr("generated") && label.html(message);
			} else {
				// create label
				label = $("<" + this.settings.errorElement + "/>")
					.attr({"for":  this.idOrName(element), generated: true})
					.addClass(this.settings.errorClass)
					.html(message || "");
				if ( this.settings.wrapper ) {
					// make sure the element is visible, even in IE
					// actually showing the wrapped element is handled elsewhere
					label = label.hide().show().wrap("<" + this.settings.wrapper + "/>").parent();
				}
				if ( !this.labelContainer.append(label).length )
					this.settings.errorPlacement
						? this.settings.errorPlacement(label, $(element) )
						: label.insertAfter(element);
			}
			if ( !message && this.settings.success ) {
				label.text("");
				typeof this.settings.success == "string"
					? label.addClass( this.settings.success )
					: this.settings.success( label );
			}
			this.toShow = this.toShow.add(label);
		},
		
		errorsFor: function(element) {
			return this.errors().filter("[for='" + this.idOrName(element) + "']");
		},
		
		idOrName: function(element) {
			return this.groups[element.name] || (this.checkable(element) ? element.name : element.id || element.name);
		},

		checkable: function( element ) {
			return /radio|checkbox/i.test(element.type);
		},
		
		findByName: function( name ) {
			// select by name and filter by form for performance over form.find("[name=...]")
			var form = this.currentForm;
			return $(document.getElementsByName(name)).map(function(index, element) {
				return element.form == form && element.name == name && element  || null;
			});
		},
		
		getLength: function(value, element) {
			switch( element.nodeName.toLowerCase() ) {
			case 'select':
				return $("option:selected", element).length;
			case 'input':
				if( this.checkable( element) )
					return this.findByName(element.name).filter(':checked').length;
			}
			return value.length;
		},
	
		depend: function(param, element) {
			return this.dependTypes[typeof param]
				? this.dependTypes[typeof param](param, element)
				: true;
		},
	
		dependTypes: {
			"boolean": function(param, element) {
				return param;
			},
			"string": function(param, element) {
				return !!$(param, element.form).length;
			},
			"function": function(param, element) {
				return param(element);
			}
		},
		
		optional: function(element) {
			return !$.validator.methods.required.call(this, $.trim(element.value), element) && "dependency-mismatch";
		},
		
		startRequest: function(element) {
			if (!this.pending[element.name]) {
				this.pendingRequest++;
				this.pending[element.name] = true;
			}
		},
		
		stopRequest: function(element, valid) {
			this.pendingRequest--;
			// sometimes synchronization fails, make sure pendingRequest is never < 0
			if (this.pendingRequest < 0)
				this.pendingRequest = 0;
			delete this.pending[element.name];
			if ( valid && this.pendingRequest == 0 && this.formSubmitted && this.form() ) {
				$(this.currentForm).submit();
			} else if (!valid && this.pendingRequest == 0 && this.formSubmitted) {
				$(this.currentForm).triggerHandler("invalid-form", [this]);
			}
		},
		
		previousValue: function(element) {
			return $.data(element, "previousValue") || $.data(element, "previousValue", previous = {
				old: null,
				valid: true,
				message: this.defaultMessage( element, "remote" )
			});
		}
		
	},
	
	classRuleSettings: {
		required: {required: true},
		email: {email: true},
		url: {url: true},
		date: {date: true},
		dateISO: {dateISO: true},
		dateDE: {dateDE: true},
		number: {number: true},
		numberDE: {numberDE: true},
		digits: {digits: true},
		creditcard: {creditcard: true}
	},
	
	addClassRules: function(className, rules) {
		className.constructor == String ?
			this.classRuleSettings[className] = rules :
			$.extend(this.classRuleSettings, className);
	},
	
	classRules: function(element) {
		var rules = {};
		var classes = $(element).attr('class');
		classes && $.each(classes.split(' '), function() {
			if (this in $.validator.classRuleSettings) {
				$.extend(rules, $.validator.classRuleSettings[this]);
			}
		});
		return rules;
	},
	
	attributeRules: function(element) {
		var rules = {};
		var $element = $(element);
		
		for (method in $.validator.methods) {
			var value = $element.attr(method);
			if (value) {
				rules[method] = value;
			}
		}
		
		// maxlength may be returned as -1, 2147483647 (IE) and 524288 (safari) for text inputs
		if (rules.maxlength && /-1|2147483647|524288/.test(rules.maxlength)) {
			delete rules.maxlength;
		}
		
		return rules;
	},
	
	metadataRules: function(element) {
		if (!$.metadata) return {};
		
		var meta = $.data(element.form, 'validator').settings.meta;
		return meta ?
			$(element).metadata()[meta] :
			$(element).metadata();
	},
	
	staticRules: function(element) {
		var rules = {};
		var validator = $.data(element.form, 'validator');
		if (validator.settings.rules) {
			rules = $.validator.normalizeRule(validator.settings.rules[element.name]) || {};
		}
		return rules;
	},
	
	normalizeRules: function(rules, element) {
		// handle dependency check
		$.each(rules, function(prop, val) {
			// ignore rule when param is explicitly false, eg. required:false
			if (val === false) {
				delete rules[prop];
				return;
			}
			if (val.param || val.depends) {
				var keepRule = true;
				switch (typeof val.depends) {
					case "string":
						keepRule = !!$(val.depends, element.form).length;
						break;
					case "function":
						keepRule = val.depends.call(element, element);
						break;
				}
				if (keepRule) {
					rules[prop] = val.param !== undefined ? val.param : true;
				} else {
					delete rules[prop];
				}
			}
		});
		
		// evaluate parameters
		$.each(rules, function(rule, parameter) {
			rules[rule] = $.isFunction(parameter) ? parameter(element) : parameter;
		});
		
		// clean number parameters
		$.each(['minlength', 'maxlength', 'min', 'max'], function() {
			if (rules[this]) {
				rules[this] = Number(rules[this]);
			}
		});
		$.each(['rangelength', 'range'], function() {
			if (rules[this]) {
				rules[this] = [Number(rules[this][0]), Number(rules[this][1])];
			}
		});
		
		if ($.validator.autoCreateRanges) {
			// auto-create ranges
			if (rules.min && rules.max) {
				rules.range = [rules.min, rules.max];
				delete rules.min;
				delete rules.max;
			}
			if (rules.minlength && rules.maxlength) {
				rules.rangelength = [rules.minlength, rules.maxlength];
				delete rules.minlength;
				delete rules.maxlength;
			}
		}
		
		// To support custom messages in metadata ignore rule methods titled "messages"
		if (rules.messages) {
			delete rules.messages
		}
		
		return rules;
	},
	
	// Converts a simple string to a {string: true} rule, e.g., "required" to {required:true}
	normalizeRule: function(data) {
		if( typeof data == "string" ) {
			var transformed = {};
			$.each(data.split(/\s/), function() {
				transformed[this] = true;
			});
			data = transformed;
		}
		return data;
	},
	
	// http://docs.jquery.com/Plugins/Validation/Validator/addMethod
	addMethod: function(name, method, message) {
		$.validator.methods[name] = method;
		$.validator.messages[name] = message || $.validator.messages[name];
		if (method.length < 3) {
			$.validator.addClassRules(name, $.validator.normalizeRule(name));
		}
	},

	methods: {

		// http://docs.jquery.com/Plugins/Validation/Methods/required
		required: function(value, element, param) {
			// check if dependency is met
			if ( !this.depend(param, element) )
				return "dependency-mismatch";
			switch( element.nodeName.toLowerCase() ) {
			case 'select':
				var options = $("option:selected", element);
				return options.length > 0 && ( element.type == "select-multiple" || ($.browser.msie && !(options[0].attributes['value'].specified) ? options[0].text : options[0].value).length > 0);
			case 'input':
				if ( this.checkable(element) )
					return this.getLength(value, element) > 0;
			default:
				return $.trim(value).length > 0;
			}
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/remote
		remote: function(value, element, param) {
			if ( this.optional(element) )
				return "dependency-mismatch";
			
			var previous = this.previousValue(element);
			
			if (!this.settings.messages[element.name] )
				this.settings.messages[element.name] = {};
			this.settings.messages[element.name].remote = typeof previous.message == "function" ? previous.message(value) : previous.message;
			
			param = typeof param == "string" && {url:param} || param; 
			
			if ( previous.old !== value ) {
				previous.old = value;
				var validator = this;
				this.startRequest(element);
				var data = {};
				data[element.name] = value;
				$.ajax($.extend(true, {
					url: param,
					mode: "abort",
					port: "validate" + element.name,
					dataType: "json",
					data: data,
					success: function(response) {
						var valid = response === true;
						if ( valid ) {
							var submitted = validator.formSubmitted;
							validator.prepareElement(element);
							validator.formSubmitted = submitted;
							validator.successList.push(element);
							validator.showErrors();
						} else {
							var errors = {};
							errors[element.name] = previous.message = response || validator.defaultMessage( element, "remote" );
							validator.showErrors(errors);
						}
						previous.valid = valid;
						validator.stopRequest(element, valid);
					}
				}, param));
				return "pending";
			} else if( this.pending[element.name] ) {
				return "pending";
			}
			return previous.valid;
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/minlength
		minlength: function(value, element, param) {
			return this.optional(element) || this.getLength($.trim(value), element) >= param;
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/maxlength
		maxlength: function(value, element, param) {
			return this.optional(element) || this.getLength($.trim(value), element) <= param;
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/rangelength
		rangelength: function(value, element, param) {
			var length = this.getLength($.trim(value), element);
			return this.optional(element) || ( length >= param[0] && length <= param[1] );
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/min
		min: function( value, element, param ) {
			return this.optional(element) || value >= param;
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/max
		max: function( value, element, param ) {
			return this.optional(element) || value <= param;
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/range
		range: function( value, element, param ) {
			return this.optional(element) || ( value >= param[0] && value <= param[1] );
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/email
		email: function(value, element) {
			// contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
			return this.optional(element) || /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(value);
		},
	
		// http://docs.jquery.com/Plugins/Validation/Methods/url
		url: function(value, element) {
			// contributed by Scott Gonzalez: http://projects.scottsplayground.com/iri/
			return this.optional(element) || /^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value);
		},
        
		// http://docs.jquery.com/Plugins/Validation/Methods/date
		date: function(value, element) {
			return this.optional(element) || !/Invalid|NaN/.test(new Date(value));
		},
	
		// http://docs.jquery.com/Plugins/Validation/Methods/dateISO
		dateISO: function(value, element) {
			return this.optional(element) || /^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value);
		},
	
		// http://docs.jquery.com/Plugins/Validation/Methods/dateDE
		dateDE: function(value, element) {
			return this.optional(element) || /^\d\d?\.\d\d?\.\d\d\d?\d?$/.test(value);
		},
	
		// http://docs.jquery.com/Plugins/Validation/Methods/number
		number: function(value, element) {
			return this.optional(element) || /^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value);
		},
	
		// http://docs.jquery.com/Plugins/Validation/Methods/numberDE
		numberDE: function(value, element) {
			return this.optional(element) || /^-?(?:\d+|\d{1,3}(?:\.\d{3})+)(?:,\d+)?$/.test(value);
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/digits
		digits: function(value, element) {
			return this.optional(element) || /^\d+$/.test(value);
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/creditcard
		// based on http://en.wikipedia.org/wiki/Luhn
		creditcard: function(value, element) {
			if ( this.optional(element) )
				return "dependency-mismatch";
			// accept only digits and dashes
			if (/[^0-9-]+/.test(value))
				return false;
			var nCheck = 0,
				nDigit = 0,
				bEven = false;

			value = value.replace(/\D/g, "");

			for (n = value.length - 1; n >= 0; n--) {
				var cDigit = value.charAt(n);
				var nDigit = parseInt(cDigit, 10);
				if (bEven) {
					if ((nDigit *= 2) > 9)
						nDigit -= 9;
				}
				nCheck += nDigit;
				bEven = !bEven;
			}

			return (nCheck % 10) == 0;
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/accept
		accept: function(value, element, param) {
			param = typeof param == "string" ? param.replace(/,/g, '|') : "png|jpe?g|gif";
			return this.optional(element) || value.match(new RegExp(".(" + param + ")$", "i")); 
		},
		
		// http://docs.jquery.com/Plugins/Validation/Methods/equalTo
		equalTo: function(value, element, param) {
			return value == $(param).val();
		}
		
	}
	
});

// deprecated, use $.validator.format instead
$.format = $.validator.format;

})(jQuery);

// ajax mode: abort
// usage: $.ajax({ mode: "abort"[, port: "uniqueport"]});
// if mode:"abort" is used, the previous request on that port (port can be undefined) is aborted via XMLHttpRequest.abort() 
;(function($) {
	var ajax = $.ajax;
	var pendingRequests = {};
	$.ajax = function(settings) {
		// create settings for compatibility with ajaxSetup
		settings = $.extend(settings, $.extend({}, $.ajaxSettings, settings));
		var port = settings.port;
		if (settings.mode == "abort") {
			if ( pendingRequests[port] ) {
				pendingRequests[port].abort();
			}
			return (pendingRequests[port] = ajax.apply(this, arguments));
		}
		return ajax.apply(this, arguments);
	};
})(jQuery);

// provides cross-browser focusin and focusout events
// IE has native support, in other browsers, use event caputuring (neither bubbles)

// provides delegate(type: String, delegate: Selector, handler: Callback) plugin for easier event delegation
// handler is only called when $(event.target).is(delegate), in the scope of the jquery-object for event.target 

// provides triggerEvent(type: String, target: Element) to trigger delegated events
;(function($) {
	$.each({
		focus: 'focusin',
		blur: 'focusout'	
	}, function( original, fix ){
		$.event.special[fix] = {
			setup:function() {
				if ( $.browser.msie ) return false;
				this.addEventListener( original, $.event.special[fix].handler, true );
			},
			teardown:function() {
				if ( $.browser.msie ) return false;
				this.removeEventListener( original,
				$.event.special[fix].handler, true );
			},
			handler: function(e) {
				arguments[0] = $.event.fix(e);
				arguments[0].type = fix;
				return $.event.handle.apply(this, arguments);
			}
		};
	});
	$.extend($.fn, {
		delegate: function(type, delegate, handler) {
			return this.bind(type, function(event) {
				var target = $(event.target);
				if (target.is(delegate)) {
					return handler.apply(target, arguments);
				}
			});
		},
		triggerEvent: function(type, target) {
			return this.triggerHandler(type, [$.event.fix({ type: type, target: target })]);
		}
	})
})(jQuery);

/*######    BEGIN: CUSTOM FUNCTIONS FOR BAD WORD FILTERING    #################*/
				
	function filterFormFields(frmName, frmAction, doSubmit){
		$.ajax({
			type: "GET",
			url: "/content/badwords",
			dataType: "xml",
			success: function(xml) {
				$(xml).find('badword').each(function(){        //-- parseXML nodes here                                                                
					var theBadWord = $(this).text();
					
					$('input[type="text"]:not([class*=number][class*=email])').each(function(){
						$(this).val( cleanInput($(this).val(), theBadWord) );									
					});								
				});
				frmName.action = frmAction;
				if(doSubmit){
					frmName.submit();
				}
			}
		});//end ajax call
	}


            function cleanInput(theFld, badWord){
                       var hasBadWord = false;
                        var newFldVal = '';                        
                       var badWordExp = new RegExp(badWord, "gi");
                       
                       theFld = theFld.replace(/[^a-zA-Z0-9*@.\s]/g, "");
                    
                       var splitString = theFld.split(" ");
                       if(splitString.length > 1){
                               for(var ii = 0; ii < splitString.length; ii++){
                                       tempWord = splitString[ii];
                                       if(tempWord.toLowerCase() == badWord && tempWord.length == badWord.length){
                                               tempWord = tempWord.replace(badWordExp, "*****");
                                               hasBadWord = true;
                                       }
                       
                                       newFldVal += (tempWord + " ");                   
                               }
                       }
                       else{
                               if(theFld.toLowerCase() == badWord && theFld.length == badWord.length){
                                       hasBadWord = true;
                                       newFldVal = theFld.replace(badWordExp, "*****");
                               }                   
                       }
                    
                        if(hasBadWord){
                            return trim(newFldVal);
                        }
                        else{
                            return theFld;
                        }
        }                
                
        function trim(str, chars) {
            return ltrim(rtrim(str, chars), chars);
        }
         
        function ltrim(str, chars) {
            chars = chars || "\\s";
            return str.replace(new RegExp("^[" + chars + "]+", "g"), "");
        }
         
        function rtrim(str, chars) {
            chars = chars || "\\s";
            return str.replace(new RegExp("[" + chars + "]+$", "g"), "");
        }

/*######    END: CUSTOM FUNCTIONS FOR BAD WORD FILTERING    #################*/





// old deprecated code
function init() { }								
(function($){
/* rei namespace
 * setup, jmontgo Dec 2010
*/
if(window.rei) return;

var rei;
window.rei = rei = {
	error:[],
	analytics:[],
	re: { // RegExp cache
		cleanUrlChars: /[;'<>=()]/gm
	},
	perf: {start: window.perf_start || (new Date()).getTime(), ready: 0, load: 0},
	
	util: {
		randomID: function(size) {
			var chars = "0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
			var str = '', i=0;
			while(i++<size){
				// get random character in range
				str += chars.substr( Math.floor(Math.random() * 62), 1 );
			}
			return str;
		},
		autocomplete: function(_src){
		// jmontgo 2011 Feb, jquery-ui autocomplete
			var leftSpace = /^\s+/, rightSpace = /\s+$/, manySpaces = /\s\s+/g;
			$("#headerQuery").autocomplete({
				appendTo: $("#autocomplete"),
				select: function(event, ui) { 
			        $("#headerQuery").val(ui.item.label);
			        $("#psearch").submit(); },
				source: function source(query,result) {
					// autocomplete terms are all lowercase
					var r = [], a = [], n, item, i=0,
						q = query.term.toLowerCase().replace(leftSpace, '').replace(rightSpace, '').replace(manySpaces, ' ');
					while(item=_src[i++]){
						n = item.indexOf(q);
						switch(n){
						case -1:
						break;
						// match starts with query (result desired)
						case 0: r.push(item);
						break;
						// match contains query (alternate match)
						default: a.push(item);
						};
					}
					// 10 is the maxlength
					result(r.concat(a).slice(0,10));
				}
			});
			$("#bottomSearchText").autocomplete({
				appendTo: $("#autocomplete"),
				select: function(event, ui) { 
			        $("#bottomSearchText").val(ui.item.label);
			        $("#psearch2").submit(); },
				source: function source(query,result) {
					// autocomplete terms are all lowercase
					var r = [], a = [], n, item, i=0,
						q = query.term.toLowerCase().replace(leftSpace, '').replace(rightSpace, '').replace(manySpaces, ' ');
					while(item=_src[i++]){
						n = item.indexOf(q);
						switch(n){
						case -1:
						break;
						// match starts with query (result desired)
						case 0: r.push(item);
						break;
						// match contains query (alternate match)
						default: a.push(item);
						};
					}
					// 10 is the maxlength
					result(r.concat(a).slice(0,10));
				}
			});
		},
		//bind a click event that will in turn add the addthis listner after the user mouseover of the share button
		//this is to make sure the addthis object exists before that listner is added
		bindaddthisonclick: function bindaddthisonclick(){
			//register an event for the addthis
			if (!rei.shareButtonPreviousClick) {
				// Listen for the share event
				addthis.addEventListener('addthis.menu.share', rei.util.shareEventHandler);
			}

			rei.shareButtonPreviousClick=true;
			
		},
		// throw event33 when the user shares somewhere, include product sku if available
		shareEventHandler: function shareEventHandler(e) { 
		    if (e.type == 'addthis.menu.share') { 
		    	if (rei.analytics.options.products==undefined) {
		    		rei.analytics.sendToFriend("");
		    	} else {
		    		rei.analytics.sendToFriend(rei.analytics.options.products);
		    	}
		    }
		},
		mboxSetup: function mboxSetup(){
			var div = document.createElement('div'), mbox = document.createElement('mbox'), isSetup = /\bmbox_setup\b/,
				gid = function gid(){ return _PREFIX.concat(_j++); },
				_PREFIX = 'mbox_'+(new Date()).getTime(), i=0, _j = 0, TYPE = /*@cc_on 'propertychange';@*/'DOMNodeInserted';

			$(document.getElementsByTagName('mbox')).each(function(){
				if(isSetup.test(this.className)) return;
				var $mb, mb = mbox.cloneNode(true), d = div.cloneNode(true),
					j=0, _a, attr = this.attributes, v,
					complete = false, k,
					evt, hdlr, handlers, events = $(this).data("events");
				$mb = $(mb)
				d.id = gid();
				v = [d.id,this.getAttribute('name')];
				mb.appendChild(d);
				while(_a=attr[j++]){
					if(_a.name.indexOf('jQuery') == 0) continue;
					mb.setAttribute(_a.name, _a.value);
					if(_a.name == 'mbox'){
						var ready = _a.value;
						$mb.bind('mbox',function(e){
							(new Function(ready)).call(this, e);
						});
					}
					// entity.someName="value" attributes are mbox options
					else if(_a.name.indexOf('entity.') == 0) v.push(_a.name+'='+_a.value);
				};
				mb.className += ' mbox_setup';
				for(evt in events){
					handlers = events[evt];
					k=0;
					while(hdlr=handlers[k++]){
						$mb.bind(evt, hdlr.handler);
					}
				};

				$(TYPE == 'propertychange'? d:mb).bind(TYPE, function(e){
					setTimeout(function(){
						// our div is replaced with a new element, so access it via firstChild
						if(complete || !mb.firstChild.childNodes.length) return;
						complete = true;
						$mb.trigger('mbox');
					}, 0);
				});
				this.parentNode.replaceChild(mb, this);
				// mboxDefine(dom_id, mbox_name, options...);
				mboxDefine.apply(window,v);
				// mboxUpdate(mbox_name, options...);
				mboxUpdate.apply(window,v.slice(1)); // without dom_id
			}); // each()
		} // mboxSetup()
	},
	ready: function(){
		rei.perf.ready = (new Date()).getTime();

		// storeId setup in unvHeader
		if(storeId == 8000 && storeClass.toLowerCase() == 'outlet'){ storeId = 8001; }
		if(document.getElementById('unvHeader')){ hdrObj.init(); }

		// overwrite any thickbox instances
		if(window.tb_bootstrap){
				tb_bootstrap = function(){};
				tb_bootstrap.override = true;
		};
	}, // ready()
	load: function(){
		var perf = rei.perf;
		perf.load = (new Date()).getTime();
		// rei.util.mboxSetup(); - removing until mboxUpdate issue resolved

	// init site-search autocomplete
	var js = document.createElement('script');
	js.type = 'text/javascript', js.async = true, js.src = (location.protocol == "https:" ? "https:" : "http:").concat(
		"//content.atomz.com/autocomplete/sp10/04/6f/84", ((document.getElementById("sp_staged") && document.getElementById("sp_staged").value) ? "-stage/" : "/"),
		'?callback=rei.util.autocomplete'
	);
	document.body.appendChild(js);

	setTimeout(function(){
	// priority items

		// was findAStore.js
		// TODO find and test this zip feature
		function checkZip(){
			var zipCodeWithZero = $(document.getElementById('findAStoreZip')).val();
			var zip = parseInt($(document.getElementById('findAStoreZip')).val()||'',10);
			if (isNaN(zip) || (zip < 1)) { alert("Please enter a valid ZIP code."); return false; };
			for(var i=0;i<zipCodeWithZero.length;i++){
				if(zipCodeWithZero.substring(i,i+1)=="0"){
				zip="0"+zip;
				}else{
				break;
				 }
				}
			window.location = "/map/store#"+zip;
		};
		$(document.getElementById('findAStoreZip')).focus(function(){ $(this).val(""); }).keydown(function(event){
			if (event.keyCode == "13") checkZip();
		})
		$(document.getElementById('findAStoreClick')).click(checkZip);

		// drowDown init
		var hunt3 = $(document.getElementById('hunt3'));
		hunt3.superfish({
			animation : { opacity:"show",height:"show" }
		});
		if ($.browser.msie) {
			var li_with = hunt3.children("li:has(ul)");
			li_with.mouseover(function(){
					$("ul", this).bgIframe({opacity:false});
			}).find("a").focus(function(){
				li_with.find("ul").bgIframe({opacity:false});
			});
		}
		// dropDown()

		//from mbox.js
		$('.recommendations6').jcarousel({scroll: 6});
		$('.recommendations5').jcarousel({ scroll: 5 });
		$('.recommendations4').jcarousel({ scroll: 4 });
		$(document.getElementById('recommendationsVertical')).jcarousel({ vertical: true });

		// setup (replace) thickbox with fancybox
		if(!window.tb_bootstrap || (window.tb_bootstrap && tb_bootstrap.override)){
		TB_remove = $.fancybox.close;
		var url, w, h, wRE = /width=([0-9]+)/, hRE = /height=([0-9]+)/, cRE = /(inlineId=)((?:[a-z][a-z0-9_]*))/i, l, item, items = document.querySelectorAll ? document.querySelectorAll('.thickbox'):$('.thickbox'), fbOptions = {};
		l=items.length;
		while(l&&(item=items[--l])){
			url = item.href || item.alt;
			w = url.match(wRE),
			h = url.match(hRE);						
			w = (w && w.length > 0) ? (w[1]*1):1,
				h = (h && h.length > 0) ? (h[1]*1):1;
			w = w < 560 ? 560:w,
				h = h < 340 ? 340:h;
			//check if thickbox content is inline 
			if(url.indexOf('#TB_inline') >= 0){
				var contentId = url.match(cRE);
				contentId = (contentId && contentId.length > 0) ? contentId[2] : null;
				fbOptions = (contentId !== null && document.getElementById(contentId) !== null ) ? {content:document.getElementById(contentId).innerHTML,titleShow:false,autoDimensions:true} : null;
			}else{
				fbOptions = {type:'iframe',width:w,height:h};
			}
			if(fbOptions !== null){
				$(item).fancybox(fbOptions);
			}
		}
		};

		minicart = new Minicart();
	}, 0);
	setTimeout(function(){
	// deferred items
		var versionId = window.VERSION_ID || 0;
		
		
		// if this is coming from safari preview page don't load analytics
		if (navigator.loadPurpose != "preview" || document.webkitVisibilityState != "prerender"){
			// load analytics
			var js = document.createElement('script');
			js.type = 'text/javascript';
			js.async = true;
			js.id = 'analyticsjs';
			js.src = '/javascript/analytics.js?rei_v=' + versionId;
			document.getElementsByTagName('script')[0].parentNode.appendChild(js);
		}
		
		/* TODO does this work with the smart-buttons?
		 * esp on: /help/index.html
		 * */
		$(document.getElementById('unvHeader')).append('<img src="'.concat(
			location.protocol, '//admin.instantservice.com/resources/smartbutton/5514/15502/available.gif?',
			Math.floor(Math.random()*10001), '" style="width:0px;height:0px;visibility:hidden;position:absolute;" width="0" height="0" onLoad="hdrObj.liveChatOn();" onError="hdrObj.liveChatOff();"/>'
		) );
		var img = new Image();
		img.src = '/pix/common/pixel.gif?perf:r'.concat( (perf.ready - perf.start).toString(),',l',(perf.load - perf.start).toString(),',',(window.perf_start ? 'y,':'n,'),location.href);
		document.body.appendChild(img);
		// END:: load analytics
		
				
		//load addthis_widget.js for share button functionality if there is a .share on the page
		if($(".share").length > 0){
			try{
				var addthisjs = document.createElement('script');
				addthisjs.src= "http://s7.addthis.com/js/250/addthis_widget.js?domready=1";
				addthisjs.async = true;
				addthisjs.id = 'addthisscriptloadtest';
				document.body.appendChild(addthisjs);
				addthisjs=0;

				rei.shareButtonPreviousClick = false;
				var l = $('a.share');
				$(l).bind('mouseover',rei.util.bindaddthisonclick);
				
			}catch(e){}
		}
		
	}, 100);
	
	} // load()
};

$(rei.ready);
$(window).load(rei.load);

/* COREMETRICS deprecated content;
 * most used: cmSpFromCmRE, cmCreateManualLinkClickTag, cmCreatePageviewTag
 */
var item, fn = function(){
	if(!document.body) return;
	var img = new Image();
	img.src = '/pix/common/pixel.gif?cm_='.concat(location.href);
	document.body.appendChild(img);
}, cm_ = 'initToken,cmSpFromCmRE,makeOneCmSp,makeCmRe,getABString,cmCreateConversionEventTag,cmCreatePageElementTag,cmCreateProductElementTag,cmCreateManualLinkClickTag,cmCreateManualImpressionTag,cmCreateManualPageviewTag,cmErrorTag,cmCreateTechPropsTag,cmCreateDefaultPageviewTag,cmCreateProductviewTag,cmAddShop,cmCreateShopAction5Tag,cmCreateShopAction9Tag,cmDisplayShop5s,cmDisplayShop9s,cmCalcSKUString,cmCreateOrderTag,cmCreateRegistrationTag,cmCreateErrorTag,cmReportLoadTime,cmGetDefaultPageID,cmCreateApplicationStepTag,cmIndexOfParameter,cmExtractParameter,cmRemoveParameter,cmCheckCMEM,cmSafeZero,myNormalizeURL,cmSendFormFieldTag,cmCreatePageviewTag,cmMultipleOnChange,cmCheckForOnChange,cmSetupFormFieldTags,cmMakeTag,cmCreateFormFieldTag'.split(',');
while(item=cm_.shift()){
	window[item] = fn;
};


/*
window.onerror = function(err,url,line){
	var o = {'error':err,'url':url,'line':line};
	rei.error.push(o);
	if(window.console && console.log) console.log('error!',o);
	if(!document.body) return true;
	var img = new Image();
	img.src = '/pix/common/pixel.gif?err='.concat(location.href,'&line=',line,'&url=',encodeURIComponent(url),'&err=',encodeURIComponent(err));
	document.body.appendChild(img);
	return true;
};
*/

/**
 *	REI Location Object
 *	@namespace rei
 *	@desc			Builds the rei.location object, this function allows the user to navigate Ajax pages with ether the hash tag or a query string
 *	@version		0.01
 *	@requires		jQuery
 *	@returns		{Object}
 */
rei.location = (function () {
	var e,
		a = /\+/g,  // Regex for replacing addition symbol with a space
		r = /([^&=]+)=?([^&]*)/g,
		d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
		q = window.location.search.substring(1),
		h = window.location.hash.substring(1),
		hp = {},
		p = {},
		count = 0;
	
	//Build get param object
	while (e = r.exec(q)){
	   p[d(e[1])] = d(e[2]);
	   count++;
	}	
	if(count===0){p = null;}
	
	/**
	 * Build hash param object
	 * @private
	 */
	function _buildHashParams(evt){
		var hashChangeEvent = (evt && evt.type === 'hashchange');
		count = 0;
		if(hashChangeEvent){
			h = window.location.hash.substring(1);
			rei.location.hash = h;
			hp = {};
		}
		while (e = r.exec(h)){
		   hp[d(e[1])] = d(e[2]);
		   count++;
		}	
		if(count===0){
			hp = null;
		}else if(hashChangeEvent){
			rei.location.getHash = _searchObjPropsScaffold(hp);
		}
	}
	
	/**
	 * Search Object Scaffolding
	 * @private
	 * @param		{Object} haystack, name-value pairs
	 * @returns		{Function}
	 */
	function _searchObjPropsScaffold(haystack){
		return function(needle){
			var rtn = false;
			if(typeof haystack != "undefined" || haystack != null){
				for (var name in haystack){
					if(name == needle){
						return haystack[name];
						break;
					}
				}
			}
		};
	}

	_buildHashParams();
	$(window).bind("hashchange", _buildHashParams);
	
	return {
		/**
		 * Get Request Param Value by Name
		 * @function
		 * @public
		 * @param		{String} needle
		 * @returns		{String}
		 */
		getParam : _searchObjPropsScaffold(p),
		/**
		 * Get Hash Value by Name
		 * @function
		 * @public
		 * @param		{String} needle
		 * @returns		{String}
		 */
		getHash : _searchObjPropsScaffold(hp),
		href : window.location.href,
		hash : h,
		params : p
	}
		
})();

/**
 *	REI User Object
 *	@namespace rei
 *	@desc			Builds the rei.user object
 *	@version		0.01
 *	@requires		jQuery, jQuery.cookie
 *	@returns		{Object}
 */
rei.user = (function(){
	var firstName = '', memberType = '', userCookie = [], isLoggedIn = false;

	/** @private */
	function _readUserCookie(s){
		userCookie = s;
		userCookie = (typeof userCookie !== "undefined" && userCookie !== null) ? userCookie.split("~") : false;
		if(userCookie){
			firstName = userCookie[0];
			memberType = (userCookie.length > 0 && (typeof userCookie[1] !== 'undefined' || userCookie[1] != null)) ? userCookie[1] : false;
		}else{
			firstName = null;
			memberType = null;
		}
		return userCookie;
	}
	
	/** @private */
	function _testString(s){
		return (typeof s == 'undefined' && typeof s != 'string') ? null : s ;
	}
	
	//Contructor
	isLoggedIn = Boolean(Number($.cookie('loggedin')));
	if(isLoggedIn){
		_readUserCookie($.cookie('rei_user_info'));
	}else{
		_readUserCookie(null);
	}
	
	return {
		/**
		 * Set first name of current REI user.
		 * @function
		 * @public
		 * @param		{String} s
		 * @returns		{String}
		 */
		setFirstName : function(s){return firstName = _testString(s);},
		/**
		 * Get first name of current REI user.
		 * @function
		 * @public
		 * @returns		{String}
		 */
		getFirstName : function(){return firstName;},
		/**
		 * Set member type of current REI user.
		 * @function
		 * @public
		 * @param		{String} s
		 * @returns		{String}
		 */
		setMemberType : function(s){return memberType = _testString(s);},
		/**
		 * Get member type of current REI user.
		 * @function
		 * @public
		 * @returns		{String}
		 */
		getMemberType : function(){return memberType;},
		/**
		 * Get user's login status
		 * @function
		 * @public
		 * @returns		{Boolean}
		 */
		isLoggedIn : function(){return isLoggedIn;},
		/**
		 * Make a request to the backend for this users's member type
		 * @function
		 * @public
		 * @returns		{String} user's member type
		 */
		requestMemberType : function(){
			if(isLoggedIn && memberType == false){
				$.ajax({
					type: 'GET',
					url: '/rest/user/memberType',
					async: false,
					dataType: 'text',
					timeout: 10000,
					success: function(data){memberType = data;},
					error: function(jqXHR, textStatus, errorThrown){memberType = false;}
				});
			}else if(isLoggedIn == false){
				memberType = null;
			}
			return memberType;
		}
	};
	
})();

/**
 *	REI User Location Object
 *	@namespace rei
 *	@desc			Builds the rei.user.location object.  The location data is based upon the user's IP address
 *	@version		0.01
 *	@requires		jQuery, jQuery.cookie
 *	@returns		{Object} 
 */
rei.user.location = (function(){
	var _this = {};

	if($.cookie("IS3_GSV") != null){
		$.each($.cookie("IS3_GSV").split("_"),function(index,value){
			_this[value.split("-")[0]] = value.split("-")[1]; 
		});
	}

	return {
		/**
		 * Get User's city
		 * @function
		 * @public
		 * @returns		{String}
		 */
		getCity : function(){
			return _this["GeoCt"];
		},
		/**
		 * Get User's country
		 * @function
		 * @public
		 * @returns		{String}
		 */
		getCountry : function(){
			return _this["GeoCo"];
		},
		/**
		 * Get User's region
		 * @function
		 * @public
		 * @returns		{String}
		 */
		getRegion : function(){
			return _this["GeoRg"];
		},
		_l : _this
	}

})();

// TODO review with team, need feedback on how we want to deal with REST within javascript 
rei.services = (function($){
	var defaultOptions = {
		async: true,
		cache: true,
		dataType: "json",
		timeout: 5000,
		error: function(jqXHR, textStatus, errorThrown){
			rei.errors.push(errorThrown);
		}
	};

	if(typeof $ !== "function" && !$().jquery) return;

	function _rest(url, data, options){
		var restOptions = {};
		data = data || {};
		options = options || {};
		options.data = data;
		options.url = url;
		restOptions = $.extend({}, defaultOptions, options);
		return $.ajax(restOptions);
	}

	return {
		Read: function(url, data, options){
			options.type = "GET";
			return _rest(url, data, options);
		},
		Create: function(url, data, options){
			options.type = "POST";
			return _rest(url, data, options);
		},
		Get: function(url, data, options){
			options.type = "GET";
			return _rest(url, data, options);
		},
		Post: function(url, data, options){
			options.type = "POST";
			return _rest(url, data, options);
		},
		Put: function(url, data, options){
			options.type = "PUT";
			return _rest(url, data, options);
		},		
		Delete: function(url, data, options){
			options.type = "DELETE";
			return _rest(url, data, options);
		}
	};
}(jQuery));

rei.gps = new gps();
function gps(){
	me = this;
	this.locationReadyCallback = null;
	this.callLocationReadyCallback = function(){
		try{
			me.locationReadyCallback();
		}
		catch(err){
			
		}
	};
	this.debug = false;
	this.coordinate =  {city:null, state: null, zip: null, lat:null, lng:null, autoDetect:false};
	this.errorMessages = {
		invalidZipCode: 'Sorry, we don\'t recognize that ZIP code. Please enter a valid 5-digit ZIP code.',
		invalidCityAndState: 'Sorry, we don\'t recognize that city and/or state.  Please re-enter your city and state.',
		missingCityOrState:'You must specify both a city and a state, or enter your ZIP code.',
		missingZipCodeCityAndState:'Please provide a valid 5-digit ZIP code or city and state.'
	};
	this.saveToCookie = function(){
		$.cookie('gps', '');
		$.cookie('gps', null);
	    $.cookie('gps', me.coordinate.city.concat('|', me.coordinate.state, '|', me.coordinate.zip, '|', me.coordinate.lat, '|', me.coordinate.lng, '|', me.coordinate.autoDetect), {path: '/', expires:10});
	};	
	this.getUserLocation = function(){
		var gpsCookie = $.cookie('gps');
		if(gpsCookie != null && gpsCookie != ''){
			var gpsCoordinate = $.cookie('gps').split('|');
			if(gpsCoordinate.length == 6){
			    me.coordinate.city = gpsCoordinate[0];
			    me.coordinate.state = gpsCoordinate[1];
			    me.coordinate.zip = gpsCoordinate[2];
			    me.coordinate.lat = gpsCoordinate[3];
			    me.coordinate.lng = gpsCoordinate[4];
			    me.coordinate.autoDetect = gpsCoordinate[5];
			    me.callLocationReadyCallback();
			    if(me.debug == true) me.showUserLocation();
			}
		}
		if(me.coordinate.city == null){
			if(window.google === undefined || google.loader == null){
				initLoader();
			}
			else{
				loadMaps();
			}
		}
		function initLoader() {
			var script = document.createElement("script");
			script.src = "https://www.google.com/jsapi?callback=loadMaps";
			script.type = "text/javascript";
			document.getElementsByTagName("head")[0].appendChild(script);
		}
	};
	this.autoLocate = function(){
		$.cookie('gps', '');
		$.cookie('gps', null);
		me.coordinate =  {city:null, state: null, zip: null, lat:null, lng:null, autoDetect:false};
		me.getUserLocation();
	};
	this.showUserLocation = function(){
		if($('#locationInfo').length == 0){
			$('body').append('<div id="locationInfo" style="position:fixed; bottom: 8px; left:2px;"><span></span> - <a id="changeLocationLink" href="javascript:void(0);"> change location</a>  <a href="javascript:void(0);" onclick="rei.gps.autoLocate();"><img style="margin-bottom:-10px;" src="/img/autolocation.png" /></a>', '</div>');
			$('#changeLocationLink').bind('click', function(e){
				try{
					e.preventDefault();
					e.stopPropagation();
				}
				catch(err){
					//ie browsers may land here
				}
				me.editLocation($('body'));				
			});
		}
		var zip = me.coordinate.zip == null || me.coordinate.zip == 'null' ? '' : me.coordinate.zip;
		$('#locationInfo span').html(me.coordinate.city.concat(', ', me.coordinate.state, ' ', zip));
	};
	this.hideLocationForm = function(){
		$('#zipChangeForm').hide();	
	};
	this.updateLocation= function(){
		var zipCode = $('#cfZipCode').val();
		var city =  $('#cfCity').val();
		var state =  $('#cfState').val();
		if(zipCode == '' && (city == '' && state == '')){
			alert(me.errorMessages.missingZipCodeCityAndState);
			return;
		}
		else if(zipCode != ''){
			me.changeLocationByZipCode(zipCode, function(found){
				if(found == false){
					if((city != '' && state != '')){
						me.changeLocationByCityAndState(city, state, function(found){
							if(found == false){
								alert('Zip code not found, city and state did not return a valid location. Please enter a valid zip code, or a valid city and state.');					
							}
						});
					}
					else{
						alert(me.errorMessages.invalidZipCode);	
					}
				}
				else{
					me.hideLocationForm();
					if(me.debug == true) me.showUserLocation();			
				}
			});
		}
		if(city != '' && state != ''){
			me.changeLocationByCityAndState(city, state, function(found){
				if(found == false){
					alert(me.errorMessages.invalidCityAndState);					
				}
				else{
					me.hideLocationForm();
					if(me.debug == true) me.showUserLocation();			
				}
			});
		}
		else{
			alert(me.errorMessages.missingCityOrState);
			return;
		}
	};
	this.changeLocationByUrl = function(restUrl, callback){
		$.ajax({
			type: "GET",
			url: restUrl,
			dataType: "json",
			// does not fire for 500 or 400 errors:
			success: function(json){
				if(json != null && json.length){
					json = json[0];
					if(json.zipcode){
						json = json.zipcode;
					}
				}
				if(json != null && json.latitude != null && json.longitude != null){
					var lat = json.latitude;
					var lng = json.longitude;
					me.coordinate.city = json.city;
					me.coordinate.state = json.stateAbbr;
					me.coordinate.zip = json.zip;
					me.coordinate.lat = json.latitude;
					me.coordinate.lng = json.longitude;				
					me.coordinate.autoDetect = false;
					me.saveToCookie();
					try{					
						callback(true);
					}
					catch(err){					
					}
					try{
						clientUpdateCallback();
					}
					catch(err){
						
					}
				}
				else{
					try{					
						callback(false);
					}
					catch(err){					
					}
				}
			},
			// fires for non-500 responses (including 400's):
			complete: function(){
				
			},
			// fires for 500 errors:
			error: function(){
			}
		}); // ajax()
	}
	this.changeLocationByZipCode= function(zipCode, callback){
		me.changeLocationByUrl('/rest/geo/' + zipCode, callback);
	};
	this.changeLocationByCityAndState= function(city, state, callback){
		me.changeLocationByUrl('/rest/geo/'.concat(city, '/', state), callback);
	};

	this.editLocation = function($parent){
		if($('#zipChangeForm').length == 0){
			var html = '' +
			'<div id="zipChangeForm" style="display: block;"><div style="position:relative;">' + 
			'<div id="zipChangeFormCB" onclick="rei.gps.hideLocationForm(); try{closeClientCallBack();}catch(err){}"></div>' + 
			'<div class="chat-bubble">' + 
			'	<form action="javascript:this.updateLocation();">' + 
			'		<div id="changeYourLocation" class="cf">Change Your Location</div>' + 
			'		<div id="zipBlock">' + 
			'			Zip Code<br>' + 
			'			<input type="text" id="cfZipCode">' + 
			'		</div>' + 
			'		<div id="orBlock">' + 
			'			<br>' + 
			'			<div id="or">- or -</div>' + 
			'		</div>' + 
			'		<div id="cityBlock">' + 
			'			City<br>' + 
			'			<input type="text" id="cfCity">' + 
			'		</div>' + 
			'		<div id="stateBlock">' + 
			'			State<br>' + 
			'			<select id="cfState"><option value=""></option>' + 
			'				<option value="AL" title="Alabama">AL</option>' + 
			'				<option value="AK" title="Alaska">AK</option>' + 
			'				<option value="AZ" title="Arizona">AZ</option>' + 
			'				<option value="AR" title="Arkansas">AR</option>' + 
			'				<option value="CA" title="California">CA</option>' + 
			'				<option value="CO" title="Colorado">CO</option>' + 
			'				<option value="CT" title="Connecticut">CT</option>' + 
			'				<option value="DE" title="Delaware">DE</option>' + 
			'				<option value="DC" title="District of Columbia">DC</option>' + 
			'				<option value="FL" title="Florida">FL</option>' + 
			'				<option value="GA" title="Georgia">GA</option>' + 
			'				<option value="HI" title="Hawaii">HI</option>' + 
			'				<option value="ID" title="Idaho">ID</option>' + 
			'				<option value="IL" title="Illinois">IL</option>' + 
			'				<option value="IN" title="Indiana">IN</option>' + 
			'				<option value="IA" title="Iowa">IA</option>' + 
			'				<option value="KS" title="Kansas">KS</option>' + 
			'				<option value="KY" title="Kentucky">KY</option>' + 
			'				<option value="LA" title="Louisiana">LA</option>' + 
			'				<option value="ME" title="Maine">ME</option>' + 
			'				<option value="MD" title="Maryland">MD</option>' + 
			'				<option value="MA" title="Massachusetts">MA</option>' + 
			'				<option value="MI" title="Michigan">MI</option>' + 
			'				<option value="MN" title="Minnesota">MN</option>' + 
			'				<option value="MS" title="Missippi">MS</option>' + 
			'				<option value="MO" title="Missouri">MO</option>' + 
			'				<option value="MT" title="Montana">MT</option>' + 
			'				<option value="NE" title="Nebraska">NE</option>' + 
			'				<option value="NV" title="Nevada">NV</option>' + 
			'				<option value="NH" title="New Hampshire">NH</option>' + 
			'				<option value="NJ" title="New Jersey">NJ</option>' + 
			'				<option value="NM" title="New Mexico">NM</option>' + 
			'				<option value="NY" title="New York">NY</option>' + 
			'				<option value="NC" title="North Carolina">NC</option>' + 
			'				<option value="ND" title="North Dakota">ND</option>' + 
			'				<option value="OH" title="Ohio">OH</option>' + 
			'				<option value="OK" title="Oklahoma">OK</option>' + 
			'				<option value="OR" title="Oregon">OR</option>' + 
			'				<option value="PA" title="Pennsylvania">PA</option>' + 
			'				<option value="RI" title="Rhode Island">RI</option>' + 
			'				<option value="SC" title="South Carolina">SC</option>' + 
			'				<option value="SD" title="South Dakota">SD</option>' + 
			'				<option value="TN" title="Tennessee">TN</option>' + 
			'				<option value="TX" title="Texas">TX</option>' + 
			'				<option value="UT" title="Utah">UT</option>' + 
			'				<option value="VT" title="Vermont">VT</option>' + 
			'				<option value="WA" title="Washington">WA</option>' + 
			'				<option value="WV" title="West Virginia">WV</option>' + 
			'				<option value="WI" title="Wisconsin">WI</option>' + 
			'				<option value="WY" title="Wyoming">WY</option>' + 
			'			</select>' + 
			'		</div>' + 
			'		<div id="goBlock">' + 
			'			<br>' + 
			'			<button class="fancyBox white medium button" id="cfGo" onclick="rei.gps.updateLocation();">GO</button>' + 
			'		</div>' + 
			'	</form>' + 
			'	<div class="cf"></div>' + 
			'	<div class="chat-bubble-arrow-border"></div>' + 
			'	<div class="chat-bubble-arrow"></div>' + 
			'</div>' + 
			'</div></div>';
			$parent.append(html);
			$('#zipChangeForm').bind('click', function(e){
				e.preventDefault();
				e.stopPropagation();
			});
			var css = '<style>' +
			'#zipChangeForm .chat-bubble-arrow {border-color: white transparent transparent; border-style: solid; border-width: 10px; bottom: -19px; height: 0; left: 20px; position: absolute; width: 0;}' +
			'#zipChangeForm .chat-bubble-arrow-border {border-color: #666666  transparent transparent transparent; border-style: solid; border-width: 10px; height: 0;width: 0; position: absolute; bottom: -22px; left: 20px;}' +
			'#zipChangeForm .chat-bubble {font-family:Verdana; font-size:10px; color: #696A6C; background-color: white; border:2px solid #666666; margin:10px auto; padding:10px; position:relative; -moz-border-radiuss:10px; -webkit-border-radiuss:10px; -moz-box-shadow:3px 3px 3px #888888; -webkit-box-shadow:3px 3px 3px #888888; min-width:200px;}' +
			'#zipChangeForm{position: absolute;font-weight: bold; color: black;width:370px; z-index:9999999999;}' +
			'#zipChangeForm{' +
			'position: fixed;' +
			'bottom:20px;' +
			'}' +
			'#zipChangeForm  #zipChangeFormCB{' +
			'	position:absolute;' +
			'width: 30px;' +
			'height: 30px;' +
			'background-image: url(\'/pix/common/modal/fancybox.png\');' +
			'background-position: -40px 0px;' +
			'cursor: pointer;' +
			'z-index: 1103;' +
			'}' +
			'#zipChangeFormCB{' +
			'top: -12px;' +
			'right: -13px;' +
			'}' +
			'#zipChangeForm .chat-bubble-arrow, #zipChangeForm .chat-bubble-arrow-border {left: 205px;}' +
			'#zipChangeForm #zipBlock,#zipChangeForm  #orBlock,#zipChangeForm  #cityBlock,#zipChangeForm #stateBlock,#zipChangeForm  #goBlock{float: left; margin-right:5px;}' +
			'#or{margin-top:5px;}' +
			'#cfZipCode{width:60px;}' +
			'#cfCity{width:120px;}' +
			'#cfState{margin-top:2px; width:50px;}' +
			'#cfGo{margin-top:2px;}' +
			'</style>';
			$('head').append(css);
		}
		$('#zipChangeForm').show();
		$('#cfCity').val('');
		$('#cfState').val('');
		$('#cfZipCode').val('').focus();
	};
}

})(jQuery);



function loadMaps() {
	//set default location to seattle
	var city='Seattle';
	var state = 'WA';
	var lat = 47.543348;
	var lng = -122.27496;	
    if (google.loader.ClientLocation) {
    	var clientLocation = google.loader.ClientLocation;
    	city=clientLocation.address.city;
    	state = clientLocation.address.region;
    	lat = clientLocation.latitude;
    	lng = clientLocation.longitude;	
        rei.gps.coordinate.city = city;
        rei.gps.coordinate.state = state;
        rei.gps.coordinate.lat = lat;
        rei.gps.coordinate.lng = lng;
        rei.gps.changeLocationByCityAndState(city, state, function(found){    	
            rei.gps.coordinate.autoDetect = true;
        	rei.gps.saveToCookie();
        	rei.gps.callLocationReadyCallback();
        	if(rei.gps.debug == true)rei.gps.showUserLocation();
        });
    } 	  
    else{
    	rei.gps.callLocationReadyCallback();    	
    }
}

/**
 * This function logs out the current user session and redirects the user to login page.
 */
function sessionLogout()
{
	$.cookie("REI_SSL_SESSION_ID", null);
	$.cookie("REI_SESSION_ID", null);
	window.location.href = '/YourAccountLoginView';
}




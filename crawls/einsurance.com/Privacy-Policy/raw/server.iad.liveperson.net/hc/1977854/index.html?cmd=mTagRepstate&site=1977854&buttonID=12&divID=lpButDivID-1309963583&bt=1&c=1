function staticButton(objName,divID,buttonName,buttonId,config,state,butHtmlTemplate,server,site,protocol,servlet,windowWidth,windowHeight,windowPrefix,LEAppID,embedded,showPopOutOption){this.CHAT=1;this.VOICE=2;this.BUTTON=1;this.CHATBOX=2;this.TEXTLINK=3;this.OFFLINE=1;this.ONLINE=2;this.OCCUPIED=3;this.AWAY=4;this.TOP_LEFT=2;this.TOP_RIGHT=3;this.BOTTOM_LEFT=4;this.BOTTOM_RIGHT=5;this.stateImage=[];this.stateImage[this.OFFLINE]='repoffline.gif';this.stateImage[this.ONLINE]='reponline.gif';this.stateImage[this.OCCUPIED]='repoccupied.gif';this.stateImage[this.AWAY]='repoffline.gif';this.config=config;if(this.config.buttonType==this.CHATBOX&&this.config.buttonContent==1){this.config.cb_height=100;this.config.cb_width=150;this.config.cb_borderWidth=0;this.config.cb_borderColor=''}this.objName=objName;this.divID=divID;this.buttonName=buttonName;this.buttonId=buttonId;this.state=state;this.butHtmlTemplate=butHtmlTemplate;this.server=server;this.site=site;this.protocol=protocol;this.servlet=servlet;this.windowWidth=windowWidth;this.windowHeight=windowHeight;this.LEAppID=LEAppID;this.LEAppPrefix='staticB:';this.embedded=embedded;this.showPopOut=showPopOutOption;this.targetPrefix=this.config.chanel==this.CHAT?'chat':'call';this.randomNum=Math.round(Math.random()*9999999999);this.connErrorCnt=0;this.maxErrorRequests=3;this.ErrorRequestDelay=5;this.imgID='lpChatBtnImgID'+this.randomNum;this.chatBoxSubmitImgID='LPsubmit'+this.randomNum;this.chatBoxTextAreaID='lp_msgfield'+this.randomNum;this.hrefID='lpChatBtnHref'+this.randomNum;this.tableID='lpChatBtnTbl'+this.randomNum;this.poweredbyDivID='lpPoweredByID'+this.randomNum;this.txtLinkSpan='lpTextLinkSpan'+this.randomNum;if(this.config.chanel==this.VOICE){for(var name in this.stateImage){this.stateImage[name]='voice_'+this.stateImage[name]}}if(!this.EventHandler('init')){return true}if(this.embedded){if(typeof(window.lpMTagStatic.frameAPI)!='undefined'&&typeof(window.lpMTagStatic.frameAPI.openFrame)=='function'){var options={server:this.server,protocol:this.protocol,showPopOut:this.showPopOut};window.lpMTagStatic.frameAPI.init(options)}else{this.log("frameAPI is undefined - unable to init iFrame","ERROR")}}this.Start()}staticButton.prototype.Start=function(){if(!this.EventHandler('start')){return true}var that=this,div=this.GetObj(this.divID);if(div!=null){var content=this.GetHTML(),htmlContainerElement=this.config.buttonType==this.TEXTLINK?'span':'div',tmpDiv=document.createElement(htmlContainerElement);tmpDiv.innerHTML=content.html;div.appendChild(tmpDiv);this.addStyleSheet(content.css);var href=this.GetObj(this.hrefID);if(href!=null){href.onclick=function(){that.Clicked();return false}}if(this.config.buttonType==this.CHATBOX){this.attachEventsToChatBox()}this.addToolTip()}if(typeof(lpMTagStatic.stateChangeCallbacks)=='undefined'){lpMTagStatic.stateChangeCallbacks=[]}lpMTagStatic.stateChangeCallbacks[lpMTagStatic.stateChangeCallbacks.length]=function(){that.StateChangeCallback()};this.Display()};staticButton.prototype.attachEventsToChatBox=function(){var that=this,txtArea=this.GetObj(this.chatBoxTextAreaID);if(txtArea!=null){txtArea.onblur=function(){if(txtArea.value==''){txtArea.value=that.config.chatBoxText}};txtArea.onfocus=function(){if(txtArea.value==that.config.chatBoxText){txtArea.value=''}};txtArea.value=this.config.chatBoxText}};staticButton.prototype.StateChangeCallback=function(){this.makeCall()};staticButton.prototype.makeCall=function(){var that=this;if(!this.EventHandler('makeCall')){return true}if(typeof(lpConnLib)!='undefined'){var url=this.protocol+'://'+this.server+'/'+this.servlet+this.site+'/',params=new hcArrayStorage();params.add('site',this.site);params.add('cmd','mTagRepstate');params.add('c',this.config.chanel);params.add('bt',this.config.buttonType);params.add('buttonID',this.config.id);params.add('subCmd','getState');params.add('monitor',1);if(lpMTag.mtagAddToQueue){lpMTag.mtagAddToQueue(url,params,function(dataObj,request){that.callResponseHandler(dataObj,request)},false)}else{lpConnLib.addToQueue(url,params,function(dataObj,request){that.callResponseHandler(dataObj,request)},false)}}};staticButton.prototype.callResponseHandler=function(dataObj){var that=this;if(typeof(dataObj.ResultSet.lpCallError)!='undefined'){this.connErrorCnt++;if(this.connErrorCnt<this.maxErrorRequests){this.loopTimer=setTimeout(function(){that.makeCall()},this.connErrorCnt*this.ErrorRequestDelay*1000)}return}var result=dataObj.ResultSet.lpData[0].result;this.processResult(result)};staticButton.prototype.processResult=function(result){if(this.state==result){return}this.state=result;if(!this.EventHandler('state')){return true}var img=this.GetObj(this.imgID);if(img!=null){var imgSrc=img.src;imgSrc=imgSrc.substr(0,imgSrc.lastIndexOf('/')+1);imgSrc=imgSrc+this.stateImage[result];img.src=imgSrc}if(this.config.buttonType==this.CHATBOX){var sbmtImg=this.GetObj(this.chatBoxSubmitImgID);if(sbmtImg!=null){var imgSrc=sbmtImg.src;imgSrc=imgSrc.substr(0,imgSrc.lastIndexOf('/')+1);imgSrc=imgSrc+this.stateImage[result];sbmtImg.src=imgSrc}}if(this.config.buttonType==this.TEXTLINK){var span=this.GetObj(this.txtLinkSpan);if(span!=null){span.innerHTML=this.getTextLinkText(this.state)}}this.addToolTip()};staticButton.prototype.getTextLinkText=function(state){if(state==this.ONLINE){return this.config.displayTextOnline}else if(state==this.OCCUPIED){return this.config.displayTextOccupied}else{return this.config.displayTextOffline}};staticButton.prototype.addToolTip=function(){var tooltip='';if(this.state==this.ONLINE){tooltip=this.config.mouseoverOnline}else if(this.state==this.OFFLINE||this.state==this.AWAY){tooltip=this.config.mouseoverOffline}else if(this.state==this.OCCUPIED){tooltip=this.config.mouseoverOccupied}var href=this.GetObj(this.hrefID);if(href!=null){href.alt=tooltip;href.title=tooltip}var img=this.GetObj(this.imgID);if(img!=null){img.alt=tooltip;img.title=tooltip}};staticButton.prototype.GetClickString=function(){var clickStr='';for(var i=0;i<this.config.ude.length;i++){var u=this.config.ude[i];if(u.scope=='CLICK'){if(this.isDynamicUDE(this.config.ude[i])){var r=this.expandDynamicUDE(this.config.ude[i]);if(r!=null){clickStr+='&'+escape(r.name)+'='+escape(r.value)}}else{clickStr+='&'+escape(this.config.ude[i].name)+'='+escape(this.config.ude[i].value)}}}return clickStr};staticButton.prototype.GetClickhtmlString=function(){var clickStr='';for(var i=0;i<this.config.ude.length;i++){var u=this.config.ude[i];if(u.scope=='CLICK'){if(this.isDynamicUDE(this.config.ude[i])){var r=this.expandDynamicUDE(this.config.ude[i]);if(r!=null){clickStr+='<input type="hidden" value="'+escape(r.value)+'" name="'+escape(r.name)+'"/>'}}else{clickStr+='<input type="hidden" value="'+escape(this.config.ude[i].value)+'" name="'+escape(this.config.ude[i].name)+'"/>'}}}return clickStr};staticButton.prototype.GetUDEString=function(){var udeStr='';for(var i=0;i<this.config.ude.length;i++){var u=this.config.ude[i];if(u.scope!='CLICK'){if(this.isDynamicUDE(this.config.ude[i])){var r=this.expandDynamicUDE(this.config.ude[i]);if(r!=null){udeStr+='&'+r.scope+'!'+escape(r.name)+'='+escape(r.value)}}else{udeStr+='&'+this.config.ude[i].scope+'!'+escape(this.config.ude[i].name)+'='+escape(this.config.ude[i].value)}}}return udeStr};staticButton.prototype.GetUDEhtmlString=function(){var udeStr='';for(var i=0;i<this.config.ude.length;i++){var u=this.config.ude[i];if(u.scope!='CLICK'){if(this.isDynamicUDE(this.config.ude[i])){var r=this.expandDynamicUDE(this.config.ude[i]);if(r!=null){udeStr+='<input type="hidden" value="'+escape(r.value)+'" name="'+r.scope+'!'+escape(r.name)+'"/>'}}else{udeStr+='<input type="hidden" value="'+escape(this.config.ude[i].value)+'" name="'+this.config.ude[i].scope+'!'+escape(this.config.ude[i].name)+'"/>'}}}return udeStr};staticButton.prototype.isDynamicUDE=function(u){return(u.name.indexOf('{')==0||u.value.indexOf('{')==0)};staticButton.prototype.expandDynamicUDE=function(u){var name='',value='';try{if(u.name.indexOf('{')==0){this.log('Found dynamic ude name: '+u.name);name=this.getDynamicProp(u.name);this.log('Expanded dynamic ude name: '+name)}else{name=u.name}if(u.value.indexOf('{')==0){this.log('Found dynamic ude value: '+u.value);value=this.getDynamicProp(u.value);this.log('Expanded dynamic ude value: '+value)}else{value=u.value}}catch(e){this.log('exception in expandDynamicUDE: '+e,'WARN');return null}return{'name':name,'value':value,'scope':u.scope}};staticButton.prototype.getDynamicProp=function(prop){prop=prop.substr(1);prop=prop.substr(0,prop.length-1);return eval(prop)};staticButton.prototype.GetHTML=function(){var css=[],html=this.butHtmlTemplate;html=html.replace(/\{IMAGENAME\}/g,this.stateImage[this.state]);html=html.replace(/\{ON_CLICK_HANDLER\}/g,'');html=html.replace(/\{RANDOMNUM\}/g,this.randomNum);html=html.replace(/\{EXTRACSSFORAA\}/g,'');if(this.config.buttonType==this.CHATBOX){html=html.replace(/\{customWantToChatNONJSParams\}/g,this.GetClickhtmlString()+this.GetUDEhtmlString());css=this.getChatBoxCss()}else{html=html.replace(/\{customWantToChatNONJSParams\}/g,this.GetClickString()+this.GetUDEString())}html=html.replace(/\{targetPrefix\}/g,this.targetPrefix);html=html.replace(/\{textLinkValue\}/g,this.getTextLinkText(this.state));html=html.replace(/\{chatBoxText\}/g,'');return{'html':html,'css':css};};staticButton.prototype.getChatBoxCss=function(){var css=[];css[css.length]={'name':'#lp_msgfield'+this.randomNum,'css':'padding-left: 3px;font-family:Arial, Helvetica, sans-serif;font-size: 11px;background-color:#ffffff;width:'+this.config.cb_width+'px;height:'+this.config.cb_height+'px;border:'+this.config.cb_borderWidth+'px solid '+this.config.cb_borderColor+';'};css[css.length]={'name':'#LPChatBoxSubmitTDid'+this.randomNum,'css':'background-repeat:no-repeat;padding-left: 3px;padding-right: 0px;padding-top: 0px;padding-bottom: 0px;vertical-align: top;height: 29px;'};css[css.length]={'name':'#LPChatBoxTxtTDid'+this.randomNum,'css':'padding-left:5px;padding-right: 0px;padding-top: 0px;padding-bottom: 0px;'};css[css.length]={'name':'#lpChatBtnHref'+this.randomNum,'css':'margin-top: 2px;'};css[css.length]={'name':'#lpChatBtnImgID'+this.randomNum,'css':'display: block;'};return css};staticButton.prototype.Display=function(){if(!this.EventHandler('beforeDisplay')){return true}if(this.config.buttonType!=this.TEXTLINK){var tbl=this.GetObj(this.tableID);if(tbl!=null){tbl.style.display=''}else{this.log('staticButton '+this.buttonName+'  objName='+this.objName+' Can not find tableID:'+this.tableID,'ERROR')}}if(!this.voice){this.reportImpression()}this.makeItSticky();if(!this.EventHandler('afterDisplay')){return true}};staticButton.prototype.reportImpression=function(msg,level){var that=this;if(typeof(lpMTagStatic.onInitMonitor)=='undefined'){lpMTagStatic.onInitMonitor=[]}lpMTagStatic.onInitMonitor.push(function(){that.log('Delaying impression sending','DEBUG');if(typeof(lpMTagConfig.ifVisitorCode)=='undefined'){lpMTagConfig.ifVisitorCode=[]}lpMTagConfig.ifVisitorCode.push(function(){that.sendImpression()})})};staticButton.prototype.sendImpression=function(){if(typeof(lpMTagConfig.LEeventsAPI)!='undefined'&&lpMTagConfig.LEeventsAPI){this.initLEeventsAPI();if(typeof(lpMTagConfig.liveEngage)!='undefined'){lpMTagConfig.liveEngage.sendImpression(this.LEAppID,this.LEAppPrefix+this.buttonId)}}else{this.log('lpMTagConfig.LEeventsAPI is false','DEBUG')}};staticButton.prototype.initLEeventsAPI=function(){if(typeof(lpMTagConfig)!='undefined'&&typeof(lpMTagConfig.liveEngage)=='undefined'){lpMTagConfig.liveEngage={type:{impression:"impression",engage:"engage"},rdrDefault:{url:"",name:"_self",specs:""},_sendEvent:function(appId,type,strData,redirectData){if(typeof(appId)=='undefined'){this._log("appId was not defined","ERROR");return false}if(typeof(lpMTagConfig.LEeventsAPI)=='undefined'||!lpMTagConfig.LEeventsAPI){this._log("Older app server version unified reports not supported (lpMTagConfig.LEeventsAPI != true)","ERROR");return false}this._log("Sending"+type+" event for application: "+appId);var params=new hcArrayStorage();params.add('site',lpMTagConfig.lpNumber);params.add('cmd','leVisitorEvent');params.add('type',type);params.add('appKey',appId);params.add('data',strData);var url=lpMTagConfig.lpProtocol+'://'+lpMTagConfig.lpServer+'/hc/'+lpMTagConfig.lpNumber+'/';if(typeof(redirectData)=='undefined'||redirectData==null){if(typeof(lpConnLib)!='undefined'&&typeof(lpConnLib.addToQueue)!='undefined'){lpConnLib.addToQueue(url,params,null,true,3,true,true,5);return true}else{this._log("lpConnLib or lpConnLib.addToQueue are not defined","ERROR");return false}}else{var rdrObj={};this._objectClone(this.rdrDefault,rdrObj);if(typeof(redirectData)=='string'){rdrObj.url=redirectData}else{this._objectClone(redirectData,rdrObj)}return this._sendEventRedirect(url,params,rdrObj)}},_sendEventRedirect:function(url,params,rdrObj){if(typeof(rdrObj.url)=='undefined'||rdrObj.url==null||rdrObj.url==""){this._log("redirect url was not defined or empty");return false}params.add('redirect',rdrObj.url);return window.open(this._getRedirectUrl(url,params),rdrObj.name,rdrObj.specs)},_getRedirectUrl:function(url,params){var request=new lpRequest(lpConnLib.protocolVer,url,params,null,false,null,lpConnLib.prunIdentify,5,"UTF-8",lpConnLib.browser,false,null,undefined,0,0,true,false,undefined,undefined,undefined,undefined);request.BuildCallUrl('get',lpConnLib.maxurlgetlength,true);return request.fullUrl},_objectClone:function(source,target){var key;for(key in source){target[key]=source[key]}},_log:function(msg,type){type=(type?type:'DEBUG');if(typeof(lpMTagDebug)!='undefined'&&typeof(lpMTagDebug.Display)=='function'){lpMTagDebug.Display(msg,type,'LiveEngage.Report')}},sendImpression:function(appId,strData){return this._sendEvent(appId,this.type.impression,strData)},sendEngagement:function(appId,strData,redirectData){return this._sendEvent(appId,this.type.engage,strData,redirectData)}}}};staticButton.prototype.log=function(msg,level){if(typeof(lpMTagDebug)!='undefined'&&lpMTagDebug.Display){lpMTagDebug.Display(msg,level,'STATIC_BUTTON')}};staticButton.prototype.Clicked=function(){if(!this.EventHandler('click')){return true}var fileCmd=(this.config.chanel==this.CHAT)?'visitorWantsToChat':'visitorWantsToTalk';this.winURL=this.protocol+'://'+this.server+'/'+this.servlet+this.site+'/?cmd=file&file='+fileCmd+'&site='+this.site;if(this.config.routingSkill>0){this.winURL+='&SV!skill='+encodeURIComponent(this.config.routingSkillName)}if(this.config.routingAgent>0){this.winURL+='&SV!opid='+this.config.routingAgent}this.winURL=(typeof(lpAppendVisitorCookies)!='undefined'?lpAppendVisitorCookies(this.winURL):this.winURL);this.winURL=((typeof(lpMTag)!='undefined'&&typeof(lpMTag.addFirstPartyCookies)!='undefined')?lpMTag.addFirstPartyCookies(this.winURL):this.winURL);this.winURL+=this.GetClickString();this.winURL+=this.GetUDEString();if(this.config.chanel==this.CHAT){this.winURL+="&LEAppKey="+this.LEAppID}if(this.config.buttonType==this.CHATBOX){var el=document.getElementById('lp_msgfield'+this.randomNum);if(el!=null){if(typeof(this.config.blockCCPattern)!='undefined'){el.value=el.value.replace(this.config.blockCCPattern,"****************")}this.winURL+='&SV!message='+el.value}this.winURL+='&SV!survey_pre-chat_enable=Off';this.winURL+='&SV!source=chatbox'}this.winURL+='&referrer='+escape(document.location);this.winURL+='&bId='+this.buttonId;if(this.winURL.length>2000){this.winURL=this.winURL.substr(0,2000)}if(!this.EventHandler('windowOpen')){return true}if(this.embedded&&window.addEventListener&&this.config.chanel==this.CHAT){if(typeof(window.lpMTagStatic.frameAPI)!='undefined'&&typeof(window.lpMTagStatic.frameAPI.openFrame)=='function'){var options={src:this.winURL,width:this.windowWidth,height:this.windowHeight,title:"Chat"};window.lpMTagStatic.frameAPI.openFrame(options);return false}else{this.log("frameAPI is undefined - unable to embed chat","ERROR")}}window.open(this.winURL,this.targetPrefix+this.site,'width='+this.windowWidth+',height='+this.windowHeight+',resizable=yes');return false};staticButton.prototype.EventHandler=function(ev){this.log('staticButton '+this.buttonName+'  objName='+this.objName+' EVENT: '+ev+' STATE:'+this.state,'DEBUG');var that=this;if(ev=='start'){this.mTagEvent('LP_STATBUTTON_START')}else if(ev=='beforeDisplay'){this.mTagEvent('LP_STATBUTTON_SHOWN')}else if(ev=='click'){this.mTagEvent('LP_STATBUTTON_CLICKED')}else if(ev=='state'){this.mTagEvent('LP_STATBUTTON_STATE')}if(typeof(lpMTagStatic.chatButtonEventHandler)=='function'){return lpMTagStatic.chatButtonEventHandler(ev,that,this.buttonName,this.buttonId)}return true};staticButton.prototype.GetObj=function(id){if(document.getElementById){return document.getElementById(id)}else{if(document.all){return document.all(id)}}};staticButton.prototype.makeItSticky=function(){if(this.config.stickyType!=this.TOP_LEFT&&this.config.stickyType!=this.TOP_RIGHT&&this.config.stickyType!=this.BOTTOM_LEFT&&this.config.stickyType!=this.BOTTOM_RIGHT){return}var div=this.GetObj(this.divID);if(div!=null){div.style.position='fixed';if(this.config.stickyType==this.TOP_LEFT){div.style.top=0;div.style.left=0}else if(this.config.stickyType==this.TOP_RIGHT){div.style.top=0;div.style.right=0}else if(this.config.stickyType==this.BOTTOM_LEFT){div.style.bottom=0;div.style.left=0}else if(this.config.stickyType==this.BOTTOM_RIGHT){div.style.bottom=0;div.style.right=0}}};staticButton.prototype.getStateStr=function(state){if(state==this.ONLINE){return 'online'}else if(state==this.OFFLINE){return 'offline'}else if(state==this.OCCUPIED){return 'busy'}else if(state==this.AWAY){return 'away'}};staticButton.prototype.mTagEvent=function(evName){if(typeof(lpMTag)!='undefined'&&typeof(lpMTag.events)!='undefined'&&typeof(lpMTag.events.publish)=='function'){var stateStr=this.getStateStr(this.state),evData={id:this.buttonId,name:this.buttonName,channel:(this.config.chanel==this.VOICE?'voice':'chat'),buttonState:stateStr};lpMTag.events.publish(evName,evData)}};staticButton.prototype.addStyleSheet=function(css){for(var i=0;i<css.length;i++){var selector=css[i].name,els=[];if(selector.indexOf('#')==0){els[0]=this.GetObj(selector.substr(1));if(els[0]==null){els=[]}}else{els=document.getElementsByClassName(selector.substr(1))}if(els==null){this.log('NO ELEMENTS FOUND FOR SELECTOR:'+selector,'DEBUG');return}this.log('SELECTOR:'+selector+' found:'+els.length+' css='+css[i].css,'DEBUG');for(var cnt=0;cnt<els.length;cnt++){var cssRules=this.getCss(css[i].css);this.applyCssToEl(els[cnt],cssRules)}}};staticButton.prototype.applyCssToEl=function(el,cssRules){var st=el.style;if(st){for(var i=0;i<cssRules.length;i++){st[cssRules[i].name]=cssRules[i].value}}};staticButton.prototype.getCss=function(rules){var r=rules.split(';'),css=[];for(var i=0;i<r.length;i++){if(r[i]!=''){var pos=r[i].indexOf(':'),cName=r[i].substr(0,pos),cValue=r[i].substr(pos+1);cName=this.trim(cName);cName=this.fixCssNames(cName);css[i]={"name":cName,"value":this.trim(cValue)};}}return css};staticButton.prototype.fixCssNames=function(cssName){cssName=cssName.replace(/z-index/g,'zIndex');cssName=cssName.replace(/margin-bottom/g,'marginBottom');cssName=cssName.replace(/margin-left/g,'marginLeft');cssName=cssName.replace(/margin-right/g,'marginRight');cssName=cssName.replace(/margin-top/g,'marginTop');cssName=cssName.replace(/margin-bottom/g,'marginBottom');cssName=cssName.replace(/background-color/g,'backgroundColor');cssName=cssName.replace(/list-style/g,'listStyle');cssName=cssName.replace(/font-family/g,'fontFamily');cssName=cssName.replace(/font-style/g,'fontStyle');cssName=cssName.replace(/font-variant/g,'fontVariant');cssName=cssName.replace(/font-weight/g,'fontWeight');cssName=cssName.replace(/font-size/g,'fontSize');cssName=cssName.replace(/line-height/g,'lineHeight');cssName=cssName.replace(/text-align/g,'textAlign');cssName=cssName.replace(/text-decoration/g,'textDecoration');cssName=cssName.replace(/text-indent/g,'textIndent');cssName=cssName.replace(/text-transform/g,'textTransform');cssName=cssName.replace(/vertical-align/g,'verticalAlign');cssName=cssName.replace(/padding-left/g,'paddingLeft');cssName=cssName.replace(/padding-right/g,'paddingRight');cssName=cssName.replace(/padding-top/g,'paddingTop');cssName=cssName.replace(/padding-bottom/g,'paddingBottom');cssName=cssName.replace(/background-repeat/g,'backgroundRepeat');return cssName};staticButton.prototype.trim=function(str){return str.replace(/^\s\s*/,'').replace(/\s\s*$/,'')};if(!window.lpMTagConfig){window.lpMTagConfig={}}if(!window.lpMTagStatic){window.lpMTagStatic={}}if(typeof(window.lpMTagConfig.frameAPI)=='undefined'){window.lpMTagConfig.frameAPI=window.lpMTagStatic.frameAPI=(function(){var overlayWrapper,imgPath,standByWrapper,template,timer,frame=null,frameTitle,resizeBtn,closeBtn,minMaxBtn,popBtn,isDragging=false,isResizing=false,callbacks,overlayAttr={pending:false,styleLoaded:false,isMinimize:false,top:10,left:10,offsetX:0,offsetY:0,src:null,title:"LP Chat",barLocation:"BR",dimensions:{width:400,minWidth:200,minHeight:200,height:300,titleHeight:30}};function init(options){loadStyle(options.skin);imgPath=options.imagesPath;var display='display: none;';if(options.showPopOut){display=''}template="<div class='LP_UNSELECTABLE_TXT' style='' id='LP_FRAME_TITLE'><span class='titleText'></span><span class='closeBtn' style='background: url(\""+imgPath+"/sprite.png\") no-repeat 0 0;'></span><span class='minBtn' style='background: url(\""+imgPath+"/sprite.png\") no-repeat 0 0;'></span><span class='popBtn' style='background: url(\""+imgPath+"/sprite.png\") no-repeat 0 0; "+display+"'></span></div><div><div class='resizeMsk'></div><span style='background: url(\""+imgPath+"/sprite.png\") no-repeat 0 -120px;' class='resizeBtn'></span><iframe scrolling='auto'></iframe></div>";callbacks={"closeFrame":closeFrame};}function renderOverlay(){overlayAttr.pending=false;overlayWrapper=document.createElement("DIV");overlayWrapper.id="LP_CHAT_DIALOG";overlayWrapper.innerHTML=template;overlayWrapper.style.top=overlayAttr.top+"px";overlayWrapper.style.left=overlayAttr.left+"px";overlayWrapper.style.zIndex=getMaxZIndex();overlayWrapper.className="LP_CHAT_DIALOG LP_UNSELECTABLE_TXT";frame=overlayWrapper.getElementsByTagName("IFRAME")[0];frame.src=overlayAttr.src;frame.name=overlayAttr.hostOrigin;setDimensions();setDialogUI();addUIListeners();if(standByWrapper!=null){standByWrapper.parentNode.removeChild(standByWrapper);standByWrapper=null}document.body.appendChild(overlayWrapper)}function renderStandBy(){var vp=getViewPortSize();standByWrapper=document.createElement("DIV");standByWrapper.innerHTML="Loading ...";standByWrapper.style.borderRadius="5px";standByWrapper.style.display="block";standByWrapper.style.border="1px solid #CCC";standByWrapper.style.position="fixed";standByWrapper.style.width=overlayAttr.dimensions.width+"px";standByWrapper.style.height=overlayAttr.dimensions.height+"px";standByWrapper.style.top=overlayAttr.top+"px";standByWrapper.style.left=overlayAttr.left+"px";standByWrapper.style.boxShadow="0 1px 5px 0 rgba(0, 0, 0, 0.3)";standByWrapper.style.fontFamily="arial";standByWrapper.style.textAlign="center";standByWrapper.style.paddingTop="30px";standByWrapper.style.backgroundColor="white";document.body.appendChild(standByWrapper)}function setDimensions(){if(!overlayAttr.isMinimize){var dimensions=overlayAttr.dimensions;overlayWrapper.style.width=dimensions.width+"px";overlayWrapper.style.height=dimensions.height+"px";frame.style.width=(dimensions.width)+"px";frame.style.height=(dimensions.height-dimensions.titleHeight-1)+"px"}}function setDialogUI(){frameTitle=overlayWrapper.querySelector("#LP_FRAME_TITLE");closeBtn=frameTitle.querySelector(".closeBtn");minMaxBtn=frameTitle.querySelector(".minBtn");popBtn=frameTitle.querySelector(".popBtn");resizeBtn=overlayWrapper.querySelector(".resizeBtn");frameTitle.style.height=overlayAttr.dimensions.titleHeight+"px";overlayWrapper.querySelector("#LP_FRAME_TITLE .titleText").innerHTML=overlayAttr.title}function initOrigin(){sendMsg(getMsgJSON("setOrigin"))}function receiveMsg(e){try{if(e.origin==overlayAttr.origin){var msg=JSON.parse(e.data);switch(msg.action){case "resizeTo":resize(msg.data.width,parseInt(msg.data.height,10)+overlayAttr.dimensions.titleHeight);break;case "resizeBy":resize(overlayAttr.dimensions.width+msg.data.width,overlayAttr.dimensions.height+msg.data.height+overlayAttr.dimensions.titleHeight);break;case "endChat":callbacks[msg.callback]();break;case "setFrameLocation":overlayAttr.src=msg.data.location;break;case "getFrameProperty":callbacks[msg.callback](msg.data.propValue);break}}}catch(e){console.log(e)}}function sendMsg(msgStr){try{if(overlayAttr.src){frame.contentWindow.postMessage(msgStr,overlayAttr.src)}}catch(e){console.log(e)}}function getMsgJSON(action,data,callback){try{return JSON.stringify({action:action,data:data||null,callback:callback||null})}catch(e){console.log(e);return null}}function addUIListeners(){try{closeBtn.addEventListener("click",requestChatEnd);minMaxBtn.addEventListener("click",minimize);popBtn.addEventListener("click",popOut);window.addEventListener("scroll",onScroll,false);window.addEventListener("resize",onWinResize,false);addDragListeners();resizeBtn.addEventListener("mousedown",startResize);window.addEventListener("mouseup",stopResize,false);window.addEventListener("mousemove",onResize,true);window.addEventListener("message",receiveMsg,false);frame.addEventListener("load",initOrigin);overlayWrapper.addEventListener("selectstart",preventSelection)}catch(e){console.log(e)}}function removeUIListeners(){try{closeBtn.removeEventListener("click",requestChatEnd);minMaxBtn.removeEventListener("click",minimize);popBtn.removeEventListener("click",popOut);window.removeEventListener("scroll",onScroll,false);window.removeEventListener("resize",onWinResize,false);removeDragListeners();resizeBtn.removeEventListener("mousedown",startResize);window.removeEventListener("mouseup",stopResize,false);window.removeEventListener("mousemove",onResize,true);window.removeEventListener("message",receiveMsg,false);frame.removeEventListener("load",initOrigin);overlayWrapper.removeEventListener("selectstart",preventSelection)}catch(e){console.log(e)}}function addDragListeners(){try{frameTitle.addEventListener("mousedown",startDrag,false);window.addEventListener("mouseup",stopDrag,false);window.addEventListener("mousemove",drag,true)}catch(e){console.log(e)}}function removeDragListeners(){try{frameTitle.removeEventListener("mousedown",startDrag,false);window.removeEventListener("mouseup",stopDrag,false);window.removeEventListener("mousemove",drag,true)}catch(e){console.log(e)}}function onWinResize(e){setMaxDimensions();if(overlayAttr.isMinimize){var vp=getViewPortSize();overlayWrapper.style.top=(vp.height-45)+"px";overlayWrapper.style.left=(vp.width-220)+"px"}}function preventSelection(e){e.preventDefault();return false}function onScroll(e){if(timer){clearInterval(timer);timer=null}timer=setTimeout(makeFrameOpaque,200);overlayWrapper.style.opacity=0.7}function makeFrameOpaque(){var prop={duration:500,element:overlayWrapper,prop:{opacity:1}};animateTo(prop)}function animateTo(opt,callback){try{var from={};for(var i in opt.prop){if(opt.prop.hasOwnProperty(i)){var suffix=opt.element.style[i].match(/\D{2}/);suffix=(suffix)?suffix[0]:0;from[i]={val:parseFloat(opt.element.style[i]),suffix:suffix}}}animate({callback:callback,duration:opt.duration||1000,delta:makeEaseOut(circ),step:function(delta){for(var i in opt.prop){if(opt.prop.hasOwnProperty(i)){var dir=(from[i].val>opt.prop[i])?-1:1;opt.element.style[i]=parseFloat(from[i].val+(dir*Math.abs((from[i].val-opt.prop[i])*delta)))+from[i].suffix}}}})}catch(e){console.log(e)}}function makeEaseOut(delta){return function(progress){return 1-delta(1-progress)};}function circ(progress){return 1-Math.sin(Math.acos(progress))}function animate(opts){var start=new Date(),id=setInterval(function(){var timePassed=new Date()-start,progress=timePassed/opts.duration;if(progress>1)progress=1;var delta=opts.delta(progress);opts.step(delta);if(progress==1){clearInterval(id);if(opts.callback){opts.callback()}}},10)}function resize(width,height){width=(width>overlayAttr.dimensions.minWidth)?width:overlayAttr.dimensions.minWidth;height=(height>overlayAttr.dimensions.minHeight)?height:overlayAttr.dimensions.minHeight;width=(width<overlayAttr.dimensions.maxWidth)?width:overlayAttr.dimensions.maxWidth;height=(height<overlayAttr.dimensions.maxHeight)?height:overlayAttr.dimensions.maxHeight;overlayAttr.dimensions.width=parseFloat(width);overlayAttr.dimensions.height=parseFloat(height);setDimensions()}function requestChatEnd(){sendMsg(getMsgJSON("endChat",null,"closeFrame"));overlayWrapper.style.display="none";setTimeout(function(){if(frame){closeFrame()}},500)}function closeFrame(){var img=new Image(),src=overlayAttr.src;src=src.replace("cmd=file","cmd=windowUnloaded");img.src=src;removeUIListeners();overlayWrapper.parentNode.removeChild(overlayWrapper);frame=null}function minimize(){var vp=getViewPortSize();setDialogMode("min");switch(overlayAttr.barLocation){case "BR":var prop={duration:300,element:overlayWrapper,prop:{top:vp.height-45,left:vp.width-220,height:30,width:200}};animateTo(prop,hideFrame);break}}function hideFrame(){frame.style.display="none"}function maximize(){frame.style.display="block";setDialogMode("max");var prop={duration:300,element:overlayWrapper,prop:{top:parseFloat(overlayAttr.top),left:parseFloat(overlayAttr.left),height:overlayAttr.dimensions.height,width:overlayAttr.dimensions.width}};animateTo(prop,setDimensions)}function setDialogMode(mod){switch(mod){case "min":overlayAttr.isMinimize=true;resizeBtn.style.display="none";minMaxBtn.className="maxBtn";minMaxBtn.removeEventListener("click",minimize);minMaxBtn.addEventListener("click",maximize);window.removeEventListener("scroll",onScroll,false);removeDragListeners();break;case "max":overlayAttr.isMinimize=false;resizeBtn.style.display="block";minMaxBtn.className="minBtn";minMaxBtn.addEventListener("click",minimize);minMaxBtn.removeEventListener("click",maximize);window.addEventListener("scroll",onScroll,false);addDragListeners();break}}function getViewPortSize(){var e=window,a='inner';if(!('innerWidth' in window)){a='client';e=document.documentElement||document.body}return{width:e[a+'Width'],height:e[a+'Height']};}function popOut(){try{var suffix=(overlayAttr.src.indexOf("?")==-1)?"?pop_out=true":"&pop_out=true";closeFrame();overlayAttr.win=window.open(overlayAttr.src+suffix,"chatWin","height="+overlayAttr.dimensions.height+",width="+overlayAttr.dimensions.width+",modal=yes,alwaysRaised=yes")}catch(e){console.log(e)}}function getMaxZIndex(){try{return 2147483647}catch(e){console.log(e);return 1000}}function startResize(e){isResizing=true;overlayWrapper.querySelector(".resizeMsk").style.display="block";document.addEventListener("selectstart",preventSelection)}function stopResize(e){if(isResizing){isResizing=false;overlayWrapper.querySelector(".resizeMsk").style.display="none";document.removeEventListener("selectstart",preventSelection)}}function onResize(e){if(isResizing){var top=parseInt(overlayWrapper.style.top,10),left=parseInt(overlayWrapper.style.left,10);resize(e.clientX-left+5,e.clientY-top+5)}}function startDrag(e){if(e.srcElement.parentNode.id!="LP_FRAME_TITLE"){overlayWrapper.querySelector(".resizeMsk").style.display="block";overlayAttr.viewPort=getViewPortSize();overlayAttr.offsetX=e.offsetX;overlayAttr.offsetY=e.offsetY;isDragging=true;overlayWrapper.className="LP_DRAGGED_BOX_SHADOW";document.addEventListener("selectstart",preventSelection);overlayWrapper.style.top=(e.clientY-overlayAttr.offsetY-1)+"px";overlayWrapper.style.left=(e.clientX-overlayAttr.offsetX-1)+"px"}}function stopDrag(e){if(isDragging){var top=(e.clientY-overlayAttr.offsetY-1),left=(e.clientX-overlayAttr.offsetX-1);overlayWrapper.querySelector(".resizeMsk").style.display="none";isDragging=false;overlayWrapper.className="LP_UNSELECTABLE_TXT";document.removeEventListener("selectstart",preventSelection);if(overlayAttr.viewPort.height>top+overlayAttr.dimensions.height&&top>0){overlayWrapper.style.top=top+"px"}if(overlayAttr.viewPort.width>left+overlayAttr.dimensions.width&&left>0){overlayWrapper.style.left=left+"px"}overlayAttr.top=parseFloat(overlayWrapper.style.top);overlayAttr.left=parseFloat(overlayWrapper.style.left)}}function drag(e){if(isDragging){var top=(e.clientY-overlayAttr.offsetY),left=(e.clientX-overlayAttr.offsetX);if((overlayAttr.viewPort.height>top+overlayAttr.dimensions.height&&top>0)||(top<overlayAttr.top&&top>0)){overlayWrapper.style.top=top+"px"}if((overlayAttr.viewPort.width>left+overlayAttr.dimensions.width&&left>0)||(left<overlayAttr.left&&left>0)){overlayWrapper.style.left=left+"px"}}}function loadStyle(path){try{var link=document.createElement("LINK");link.href=path;link.type="text/css";link.rel="stylesheet";link.addEventListener("load",function(){overlayAttr.styleLoaded=true;if(overlayAttr.pending){renderOverlay()}});document.getElementsByTagName("head")[0].appendChild(link)}catch(e){console.log(e)}}function setMaxDimensions(){var v=getViewPortSize(),padding=(overlayAttr.dimensions.titleHeight*2);overlayAttr.dimensions.maxHeight=v.height-padding-overlayAttr.top;overlayAttr.dimensions.maxWidth=v.width-overlayAttr.left-padding}function isFrameOpen(){if(window.top!=window.self&&parent.document.getElementById("LP_CHAT_DIALOG")){return true}else{return false}}return{init:function(options){if(!isFrameOpen()){var finalOptions={};finalOptions.server=options.server;finalOptions.protocol=options.protocol||'http';finalOptions.cssLocation=options.cssLocation||'/hcp/chatWindowSkins/frameChat/css/style.css';finalOptions.skin=options.cssFullLink||finalOptions.protocol+"://"+finalOptions.server+finalOptions.cssLocation;finalOptions.imageLocation=options.imageLocation||'/hcp/chatWindowSkins/frameChat/images';finalOptions.imagesPath=options.imagesPath||finalOptions.protocol+'://'+finalOptions.server+finalOptions.imageLocation;finalOptions.showPopOut=options.showPopOut;init(finalOptions)}},openFrame:function(options){if(!isFrameOpen()){if(!frame){var hostDomain=document.location.toString().match(/^https?:\/\/[^/]{1,}/);if(!hostDomain){console.log("Host origin not found for "+document.location.toString());return}overlayAttr.top=parseFloat(options.top||overlayAttr.top);overlayAttr.left=parseFloat(options.left||overlayAttr.left);options.height=parseFloat(options.height);options.width=parseFloat(options.width);setMaxDimensions();options.height=(options.height<overlayAttr.dimensions.maxHeight)?options.height:overlayAttr.dimensions.maxHeight;options.width=(options.width<overlayAttr.dimensions.maxWidth)?options.width:overlayAttr.dimensions.maxWidth;overlayAttr.src=options.src;overlayAttr.dimensions.width=parseFloat(options.width);overlayAttr.dimensions.height=parseFloat(options.height)+overlayAttr.dimensions.titleHeight;overlayAttr.title=options.title||overlayAttr.title;overlayAttr.origin=overlayAttr.src.match(/^https?:\/\/[^/]{1,}/)[0];overlayAttr.hostOrigin=hostDomain[0];if(overlayAttr.styleLoaded){renderOverlay()}else{overlayAttr.pending=true;renderStandBy()}}}},closeFrame:function(){closeFrame()},resizeFrame:function(width,height){resize(width,height)},setTitle:function(title){overlayAttr.title=title;setDialogUI()},setStyle:function(cssObj){}}})()}if (typeof(lpMTagStatic)=='undefined') {var lpMTagStatic={};} lpMTagStatic.lpStaticBut13523833965204649651418791004692 = new staticButton('lpMTagStatic.lpStaticBut13523833965204649651418791004692','lpButDivID-1309963583','Activa/LivePerson Button',12,{'id':12,'name':"Activa/LivePerson Button",chanel:1,enabled:true,buttonType:1,voiceType:-1,stickyType:1,description:"Static Button",buttonContent:2,addTextToButton:false,addTextToButtonText:"Our <strong>live chat</strong> representatives are<br />available to assist you<br /><strong>Mon-Fri 9am-5pm EST.</strong><br /><br /><em>Click to chat wherever<br />you see this chat button!</em>",addTextToButtonPosition:1,routingSkill:-1,routingSkillName:'',routingAgent:-1,mouseoverOnline:"Click here to chat live with an online representative",mouseoverOccupied:"All our live chat representatives are currently occupied. Please try again later or click here to leave us a message.",mouseoverOffline:"Our live chat service is currently offline.  Please try again during business hours or click here to leave us a message.",defaultButton:false,imageFolder:"https://s3.amazonaws.com/static.einsurance.com/images/liveperson",chatBoxTemplate:"",chatBoxText:"",displayTextOnline:"<html />",displayTextOccupied:"<html />",displayTextOffline:"<html />",ude: [],cb_width:0,cb_height:0,cb_borderWidth:0,cb_borderColor:"",smartType:2,time_in_queue:10},1, "<table border='0' cellspacing='0' cellpadding='0' class='lpStaticButton' id='lpChatBtnTbl{RANDOMNUM}' style='display: none;'>\n    \n    <tr class='lpStaticButtonTR' id='lpStaticButtonTR{RANDOMNUM}'>\n        \n        <td align='center'>\n            <a id='lpChatBtnHref{RANDOMNUM}'\n               href='#'\n               target='{targetPrefix}1977854'>\n               <img id='lpChatBtnImgID{RANDOMNUM}' src='https://s3.amazonaws.com/static.einsurance.com/images/liveperson/{IMAGENAME}'\n                    name='hcIconEMT' border=0 />\n            </a>\n        </td>\n        \n    </tr>\n    <tr id='lpPoweredByTR{RANDOMNUM}' class='lpPoweredBy'>\n        \n        <td align='center'>\n            <div class='lpPoweredByDiv' id='lpPoweredByID{RANDOMNUM}'><span style='font-size:10px; font-family:Arial, Helvetica, sans-serif;'>\n    <a href='http://solutions.liveperson.com/live-chat?cameFrom=chatByLink' style='text-decoration:none; color:#000' target='_blank'>\n        <b>Live Chat</b>\n    </a>\n    <span style=\"color:#000\"> by </span>\n    <a href='http://www.liveperson.com?cameFrom=chatByLink' style='text-decoration:none; color:#FF9900' target='_blank'>\n        LivePerson\n    </a>\n</span></div>\n        </td>\n        \n    </tr>\n    <tr id='emtStarRatingTR{RANDOMNUM}' class='lpEmtStarRating'>\n\n    <td align='center'>\n        <a href='http://solutions.liveperson.com/customer-service/?site=1977854&domain=server.iad.liveperson.net&origin=chatbutton' target='_blank'\n           onClick=\"javascript:window.open('http://solutions.liveperson.com/customer-service/?site=1977854&domain=server.iad.liveperson.net&origin=chatbutton&referrer='+escape(document.location));return false;\">\n            <img src='https://server.iad.liveperson.net/hc/1977854/?cmd=rating&site=1977854&type=indicator' name='hcRating' alt='Customer Service Rating by LivePerson' border=0 />\n        </a>\n    </td>\n\n</tr>\n    \n</table>\n",'server.iad.liveperson.net','1977854','https','hc/','475','400','chat','f907f2d9acd64b7f8c00b83bed3c2822',false,true)
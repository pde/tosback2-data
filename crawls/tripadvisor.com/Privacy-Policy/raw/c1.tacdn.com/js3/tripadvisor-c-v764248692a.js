(function(){this.MooTools={version:"1.3.1dev",build:"%build%"};var p=this.typeOf=function(t){if(t==null){return"null"}if(t.$family){return t.$family()}if(t.nodeName){if(t.nodeType==1){return"element"}if(t.nodeType==3){return(/\S/).test(t.nodeValue)?"textnode":"whitespace"}}else{if(typeof t.length=="number"){if(t.callee){return"arguments"}if("item" in t){return"collection"}}}return typeof t};var j=this.instanceOf=function(v,t){if(v==null){return false}var u=v.$constructor||v.constructor;while(u){if(u===t){return true}u=u.parent}return v instanceof t};var g=this.Function;var q=true;for(var k in {toString:1}){q=null}if(q){q=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]}g.prototype.overloadSetter=function(u){var t=this;return function(w,v){if(w==null){return this}if(u||typeof w!="string"){for(var y in w){t.call(this,y,w[y])}if(q){for(var z=q.length;z--;){y=q[z];if(w.hasOwnProperty(y)){t.call(this,y,w[y])}}}}else{t.call(this,w,v)}return this}};g.prototype.overloadGetter=function(u){var t=this;return function(w){var y,v;if(u||typeof w!="string"){y=w}else{if(arguments.length>1){y=arguments}}if(y){v={};for(var z=0;z<y.length;z++){v[y[z]]=t.call(this,y[z])}}else{v=t.call(this,w)}return v}};g.prototype.extend=function(t,u){this[t]=u}.overloadSetter();g.prototype.implement=function(t,u){this.prototype[t]=u}.overloadSetter();var o=Array.prototype.slice;g.from=function(t){return(p(t)=="function")?t:function(){return t}};Array.from=function(t){if(t==null){return[]}return(a.isEnumerable(t)&&typeof t!="string")?(p(t)=="array")?t:o.call(t):[t]};Number.from=function(u){var t=parseFloat(u);return isFinite(t)?t:null};String.from=function(t){return t+""};g.implement({hide:function(){this.$hidden=true;return this},protect:function(){this.$protected=true;return this}});var a=this.Type=function(w,v){if(w){var u=w.toLowerCase();var t=function(y){return(p(y)==u)};a["is"+w]=t;if(v!=null){v.prototype.$family=(function(){return u}).hide()}}if(v==null){return null}v.extend(this);v.$constructor=a;v.prototype.$constructor=v;return v};var f=Object.prototype.toString;a.isEnumerable=function(t){return(t!=null&&typeof t.length=="number"&&f.call(t)!="[object Function]")};var r={};var s=function(t){var u=p(t.prototype);return r[u]||(r[u]=[])};var b=function(u,z){if(z&&z.$hidden){return this}var t=s(this);for(var v=0;v<t.length;v++){var y=t[v];if(p(y)=="type"){b.call(y,u,z)}else{y.call(this,u,z)}}var w=this.prototype[u];if(w==null||!w.$protected){this.prototype[u]=z}if(this[u]==null&&p(z)=="function"){m.call(this,u,function(A){return z.apply(A,o.call(arguments,1))})}return this};var m=function(t,v){if(v&&v.$hidden){return this}var u=this[t];if(u==null||!u.$protected){this[t]=v}return this};a.implement({implement:b.overloadSetter(),extend:m.overloadSetter(),alias:function(t,u){b.call(this,t,this.prototype[u])}.overloadSetter(),mirror:function(t){s(this).push(t);return this}});new a("Type",a);var d=function(t,y,v){var u=(y!=Object),C=y.prototype;if(u){y=new a(t,y)}for(var z=0,w=v.length;z<w;z++){var D=v[z],B=y[D],A=C[D];if(B){B.protect()}if(u&&A){delete C[D];C[D]=A.protect()}}if(u){y.implement(C)}return d};d("String",String,["charAt","charCodeAt","concat","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",g,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]);Object.extend=m.overloadSetter();Date.extend("now",function(){return +(new Date)});new a("Boolean",Boolean);Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide();Number.extend("random",function(u,t){return Math.floor(Math.random()*(t-u+1)+u)});Object.extend("forEach",function(t,v,w){for(var u in t){if(t.hasOwnProperty(u)){v.call(w,t[u],u,t)}}});Object.each=Object.forEach;Array.implement({forEach:function(v,w){for(var u=0,t=this.length;u<t;u++){if(u in this){v.call(w,this[u],u,this)}}},each:function(t,u){Array.forEach(this,t,u);return this}});var l=function(t){switch(p(t)){case"array":return t.clone();case"object":return Object.clone(t);default:return t}};Array.implement("clone",function(){var t=this.length,u=new Array(t);while(t--){u[t]=l(this[t])}return u});var h=function(u,t,v){switch(p(v)){case"object":if(p(u[t])=="object"){Object.merge(u[t],v)}else{u[t]=Object.clone(v)}break;case"array":u[t]=v.clone();break;default:u[t]=v}return u};Object.extend({merge:function(B,w,u){if(p(w)=="string"){return h(B,w,u)}for(var A=1,t=arguments.length;A<t;A++){var y=arguments[A];for(var z in y){h(B,z,y[z])}}return B},clone:function(t){var v={};for(var u in t){v[u]=l(t[u])}return v},append:function(y){for(var w=1,u=arguments.length;w<u;w++){var t=arguments[w]||{};for(var v in t){y[v]=t[v]}}return y}});["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(t){new a(t)});var c=Date.now();String.extend("uniqueID",function(){return(c++).toString(36)})})();Array.implement({invoke:function(a){var b=Array.slice(arguments,1);return this.map(function(c){return c[a].apply(c,b)})},every:function(c,d){for(var b=0,a=this.length;b<a;b++){if((b in this)&&!c.call(d,this[b],b,this)){return false}}return true},filter:function(d,f){var c=[];for(var b=0,a=this.length;b<a;b++){if((b in this)&&d.call(f,this[b],b,this)){c.push(this[b])}}return c},clean:function(){return this.filter(function(a){return a!=null})},indexOf:function(c,d){var a=this.length;for(var b=(d<0)?Math.max(0,a+d):d||0;b<a;b++){if(this[b]===c){return b}}return -1},map:function(d,f){var c=[];for(var b=0,a=this.length;b<a;b++){if(b in this){c[b]=d.call(f,this[b],b,this)}}return c},some:function(c,d){for(var b=0,a=this.length;b<a;b++){if((b in this)&&c.call(d,this[b],b,this)){return true}}return false},associate:function(c){var d={},b=Math.min(this.length,c.length);for(var a=0;a<b;a++){d[c[a]]=this[a]}return d},link:function(c){var a={};for(var f=0,b=this.length;f<b;f++){for(var d in c){if(c[d](this[f])){a[d]=this[f];delete c[d];break}}}return a},contains:function(a,b){return this.indexOf(a,b)!=-1},append:function(a){this.push.apply(this,a);return this},getLast:function(){return(this.length)?this[this.length-1]:null},getRandom:function(){return(this.length)?this[Number.random(0,this.length-1)]:null},include:function(a){if(!this.contains(a)){this.push(a)}return this},combine:function(c){for(var b=0,a=c.length;b<a;b++){this.include(c[b])}return this},erase:function(b){for(var a=this.length;a--;){if(this[a]===b){this.splice(a,1)}}return this},empty:function(){this.length=0;return this},flatten:function(){var d=[];for(var b=0,a=this.length;b<a;b++){var c=typeOf(this[b]);if(c=="null"){continue}d=d.concat((c=="array"||c=="collection"||c=="arguments"||instanceOf(this[b],Array))?Array.flatten(this[b]):this[b])}return d},pick:function(){for(var b=0,a=this.length;b<a;b++){if(this[b]!=null){return this[b]}}return null},hexToRgb:function(b){if(this.length!=3){return null}var a=this.map(function(c){if(c.length==1){c+=c}return c.toInt(16)});return(b)?a:"rgb("+a+")"},rgbToHex:function(d){if(this.length<3){return null}if(this.length==4&&this[3]==0&&!d){return"transparent"}var b=[];for(var a=0;a<3;a++){var c=(this[a]-0).toString(16);b.push((c.length==1)?"0"+c:c)}return(d)?b:"#"+b.join("")}});var Event=new Type("Event",function(a,k){if(!k){k=window}var r=k.document;a=a||k.event;if(a.$extended){return a}this.$extended=true;var q=a.type,m=a.target||a.srcElement,p={},c={};while(m&&m.nodeType==3){m=m.parentNode}if(q.indexOf("key")!=-1){var b=a.which||a.keyCode;var t=Object.keyOf(Event.Keys,b);if(q=="keydown"){var d=b-111;if(d>0&&d<13){t="f"+d}}if(!t){t=String.fromCharCode(b).toLowerCase()}}else{if((/click|mouse|menu/i).test(q)){r=(!r.compatMode||r.compatMode=="CSS1Compat")?r.html:r.body;p={x:(a.pageX!=null)?a.pageX:a.clientX+r.scrollLeft,y:(a.pageY!=null)?a.pageY:a.clientY+r.scrollTop};c={x:(a.pageX!=null)?a.pageX-k.pageXOffset:a.clientX,y:(a.pageY!=null)?a.pageY-k.pageYOffset:a.clientY};if((/DOMMouseScroll|mousewheel/).test(q)){var o=(a.wheelDelta)?a.wheelDelta/120:-(a.detail||0)/3}var j=(a.which==3)||(a.button==2),s=null;if((/over|out/).test(q)){s=a.relatedTarget||a[(q=="mouseover"?"from":"to")+"Element"];var l=function(){while(s&&s.nodeType==3){s=s.parentNode}return true};var h=(Browser.firefox2)?l.attempt():l();s=(h)?s:null}}else{if((/gesture|touch/i).test(q)){this.rotation=a.rotation;this.scale=a.scale;this.targetTouches=a.targetTouches;this.changedTouches=a.changedTouches;var g=this.touches=a.touches;if(g&&g[0]){var f=g[0];p={x:f.pageX,y:f.pageY};c={x:f.clientX,y:f.clientY}}}else{if((/drag(enter|leave|over)|drop/i).test(q)){this.dataTransfer=a.dataTransfer}}}}return Object.append(this,{event:a,type:q,page:p,client:c,rightClick:j,wheel:o,relatedTarget:document.id(s),target:document.id(m),code:b,key:t,shift:a.shiftKey,control:a.ctrlKey,alt:a.altKey,meta:a.metaKey})});Event.Keys={enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46};Event.implement({stop:function(){return this.stopPropagation().preventDefault()},stopPropagation:function(){if(this.event.stopPropagation){this.event.stopPropagation()}else{this.event.cancelBubble=true}return this},preventDefault:function(){if(this.event.preventDefault){this.event.preventDefault()}else{this.event.returnValue=false}return this}});Function.extend({attempt:function(){for(var b=0,a=arguments.length;b<a;b++){try{return arguments[b]()}catch(c){}}return null}});Function.implement({attempt:function(a,c){try{return this.apply(c,Array.from(a))}catch(b){}return null},bind:function(c){var a=this,b=(arguments.length>1)?Array.slice(arguments,1):null;return function(){if(!b&&!arguments.length){return a.call(c)}if(b&&arguments.length){return a.apply(c,b.concat(Array.from(arguments)))}return a.apply(c,b||arguments)}},pass:function(b,c){var a=this;if(b!=null){b=Array.from(b)}return function(){return a.apply(c,b||arguments)}},delay:function(b,c,a){return setTimeout(this.pass((a==null?[]:a),c),b)},periodical:function(c,b,a){return setInterval(this.pass((a==null?[]:a),b),c)}});Number.implement({limit:function(b,a){return Math.min(a,Math.max(b,this))},round:function(a){a=Math.pow(10,a||0).toFixed(a<0?-a:0);return Math.round(this*a)/a},times:function(b,c){for(var a=0;a<this;a++){b.call(c,a,this)}},toFloat:function(){return parseFloat(this)},toInt:function(a){return parseInt(this,a||10)}});Number.alias("each","times");(function(b){var a={};b.each(function(c){if(!Number[c]){a[c]=function(){return Math[c].apply(null,[this].concat(Array.from(arguments)))}}});Number.implement(a)})(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]);Object.extend({subset:function(c,g){var f={};for(var d=0,a=g.length;d<a;d++){var b=g[d];f[b]=c[b]}return f},map:function(a,d,f){var c={};for(var b in a){if(a.hasOwnProperty(b)){c[b]=d.call(f,a[b],b,a)}}return c},filter:function(a,c,d){var b={};Object.each(a,function(g,f){if(c.call(d,g,f,a)){b[f]=g}});return b},every:function(a,c,d){for(var b in a){if(a.hasOwnProperty(b)&&!c.call(d,a[b],b)){return false}}return true},some:function(a,c,d){for(var b in a){if(a.hasOwnProperty(b)&&c.call(d,a[b],b)){return true}}return false},keys:function(a){var c=[];for(var b in a){if(a.hasOwnProperty(b)){c.push(b)}}return c},values:function(b){var a=[];for(var c in b){if(b.hasOwnProperty(c)){a.push(b[c])}}return a},getLength:function(a){return Object.keys(a).length},keyOf:function(a,c){for(var b in a){if(a.hasOwnProperty(b)&&a[b]===c){return b}}return null},contains:function(a,b){return Object.keyOf(a,b)!=null},toQueryString:function(a,b){var c=[];Object.each(a,function(h,g){if(b){g=b+"["+g+"]"}var f;switch(typeOf(h)){case"object":f=Object.toQueryString(h,g);break;case"array":var d={};h.each(function(k,j){d[j]=k});f=Object.toQueryString(d,g);break;default:f=g+"="+encodeURIComponent(h)}if(h!=null){c.push(f)}});return c.join("&")}});String.implement({test:function(a,b){return((typeOf(a)=="regexp")?a:new RegExp(""+a,b)).test(this)},contains:function(a,b){return(b)?(b+this+b).indexOf(b+a+b)>-1:this.indexOf(a)>-1},trim:function(){return this.replace(/^\s+|\s+$/g,"")},clean:function(){return this.replace(/\s+/g," ").trim()},camelCase:function(){return this.replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()})},hyphenate:function(){return this.replace(/[A-Z]/g,function(a){return("-"+a.charAt(0).toLowerCase())})},capitalize:function(){return this.replace(/\b[a-z]/g,function(a){return a.toUpperCase()})},escapeRegExp:function(){return this.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(b){var a=this.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return(a)?a.slice(1).hexToRgb(b):null},rgbToHex:function(b){var a=this.match(/\d{1,3}/g);return(a)?a.rgbToHex(b):null},substitute:function(a,b){return this.replace(b||(/\\?\{([^{}]+)\}/g),function(d,c){if(d.charAt(0)=="\\"){return d.slice(1)}return(a[c]!=null)?a[c]:""})}});(function(){var m,q,o,h,a={},c={},p=/\\/g;var f=function(t,s){if(t==null){return null}if(t.Slick===true){return t}t=(""+t).replace(/^\s+|\s+$/g,"");h=!!s;var r=(h)?c:a;if(r[t]){return r[t]}m={Slick:true,expressions:[],raw:t,reverse:function(){return f(this.raw,true)}};q=-1;while(t!=(t=t.replace(l,b))){}m.length=m.expressions.length;return r[t]=(h)?j(m):m};var k=function(r){if(r==="!"){return" "}else{if(r===" "){return"!"}else{if((/^!/).test(r)){return r.replace(/^!/,"")}else{return"!"+r}}}};var j=function(y){var u=y.expressions;for(var s=0;s<u.length;s++){var w=u[s];var t={parts:[],tag:"*",combinator:k(w[0].combinator)};for(var r=0;r<w.length;r++){var v=w[r];if(!v.reverseCombinator){v.reverseCombinator=" "}v.combinator=v.reverseCombinator;delete v.reverseCombinator}w.reverse().push(t)}return y};var g=function(r){return r.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,"\\$&")};var l=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|:+(<unicode>+)(?:\\((?:(?:([\"'])([^\\12]*)\\12)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+g(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function b(B,v,H,D,u,G,t,F,E,C,y,J,z,s,A){if(v||q===-1){m.expressions[++q]=[];o=-1;if(v){return""}}if(H||D||o===-1){H=H||" ";var w=m.expressions[q];if(h&&w[o]){w[o].reverseCombinator=k(H)}w[++o]={combinator:H,tag:"*"}}var r=m.expressions[q][o];if(u){r.tag=u.replace(p,"")}else{if(G){r.id=G.replace(p,"")}else{if(t){t=t.replace(p,"");if(!r.classList){r.classList=[]}if(!r.classes){r.classes=[]}r.classList.push(t);r.classes.push({value:t,regexp:new RegExp("(^|\\s)"+g(t)+"(\\s|$)")})}else{if(J){A=A||s;A=A?A.replace(p,""):null;if(!r.pseudos){r.pseudos=[]}r.pseudos.push({key:J.replace(p,""),value:A})}else{if(F){F=F.replace(p,"");y=(y||"").replace(p,"");var I,K;switch(E){case"^=":K=new RegExp("^"+g(y));break;case"$=":K=new RegExp(g(y)+"$");break;case"~=":K=new RegExp("(^|\\s)"+g(y)+"(\\s|$)");break;case"|=":K=new RegExp("^"+g(y)+"(-|$)");break;case"=":I=function(L){return y==L};break;case"*=":I=function(L){return L&&L.indexOf(y)>-1};break;case"!=":I=function(L){return y!=L};break;default:I=function(L){return !!L}}if(y==""&&(/^[*$^]=$/).test(E)){I=function(){return false}}if(!I){I=function(L){return L&&K.test(L)}}if(!r.attributes){r.attributes=[]}r.attributes.push({key:F,operator:E,value:y,test:I})}}}}}return""}var d=(this.Slick||{});d.parse=function(r){return f(r)};d.escapeRegExp=g;if(!this.Slick){this.Slick=d}}).apply(this);(function(){var b={};b.isNativeCode=function(c){return(/\{\s*\[native code\]\s*\}/).test(""+c)};b.isXML=function(c){return(!!c.xmlVersion)||(!!c.xml)||(Object.prototype.toString.call(c)==="[object XMLDocument]")||(c.nodeType===9&&c.documentElement.nodeName!=="HTML")};b.setDocument=function(q){if(q.nodeType===9){}else{if(q.ownerDocument){q=q.ownerDocument}else{if(q.navigator){q=q.document}else{return}}}if(this.document===q){return}this.document=q;var r=this.root=q.documentElement;this.isXMLDocument=this.isXML(q);this.brokenStarGEBTN=this.starSelectsClosedQSA=this.idGetsName=this.brokenMixedCaseQSA=this.brokenGEBCN=this.brokenCheckedQSA=this.brokenEmptyAttributeQSA=this.isHTMLDocument=false;var k,l,s,m;var o,c;var t=q.createElement("div");r.appendChild(t);try{c="slick_getbyid_test";t.innerHTML='<a id="'+c+'"></a>';this.isHTMLDocument=!!q.getElementById(c)}catch(p){}if(this.isHTMLDocument){t.style.display="none";t.appendChild(q.createComment(""));l=(t.getElementsByTagName("*").length>0);try{t.innerHTML="foo</foo>";o=t.getElementsByTagName("*");k=(o&&o.length&&o[0].nodeName.charAt(0)=="/")}catch(p){}this.brokenStarGEBTN=l||k;if(t.querySelectorAll){try{t.innerHTML="foo</foo>";o=t.querySelectorAll("*");this.starSelectsClosedQSA=(o&&o.length&&o[0].nodeName.charAt(0)=="/")}catch(p){}}try{c="slick_id_gets_name";t.innerHTML='<a name="'+c+'"></a><b id="'+c+'"></b>';this.idGetsName=q.getElementById(c)===t.firstChild}catch(p){}try{t.innerHTML='<a class="MiXedCaSe"></a>';this.brokenMixedCaseQSA=!t.querySelectorAll(".MiXedCaSe").length}catch(p){}try{t.innerHTML='<a class="f"></a><a class="b"></a>';t.getElementsByClassName("b").length;t.firstChild.className="b";m=(t.getElementsByClassName("b").length!=2)}catch(p){}try{t.innerHTML='<a class="a"></a><a class="f b a"></a>';s=(t.getElementsByClassName("a").length!=2)}catch(p){}this.brokenGEBCN=m||s;try{t.innerHTML='<select><option selected="selected">a</option></select>';this.brokenCheckedQSA=(t.querySelectorAll(":checked").length==0)}catch(p){}try{t.innerHTML='<a class=""></a>';this.brokenEmptyAttributeQSA=(t.querySelectorAll('[class*=""]').length!=0)}catch(p){}}r.removeChild(t);t=null;this.hasAttribute=(r&&this.isNativeCode(r.hasAttribute))?function(v,u){return v.hasAttribute(u)}:function(v,u){v=v.getAttributeNode(u);return !!(v&&(v.specified||v.nodeValue))};this.contains=(r&&this.isNativeCode(r.contains))?function(u,v){return u.contains(v)}:(r&&r.compareDocumentPosition)?function(u,v){return u===v||!!(u.compareDocumentPosition(v)&16)}:function(u,v){if(v){do{if(v===u){return true}}while((v=v.parentNode))}return false};this.documentSorter=(r.compareDocumentPosition)?function(v,u){if(!v.compareDocumentPosition||!u.compareDocumentPosition){return 0}return v.compareDocumentPosition(u)&4?-1:v===u?0:1}:("sourceIndex" in r)?function(v,u){if(!v.sourceIndex||!u.sourceIndex){return 0}return v.sourceIndex-u.sourceIndex}:(q.createRange)?function(y,v){if(!y.ownerDocument||!v.ownerDocument){return 0}var w=y.ownerDocument.createRange(),u=v.ownerDocument.createRange();w.setStart(y,0);w.setEnd(y,0);u.setStart(v,0);u.setEnd(v,0);return w.compareBoundaryPoints(Range.START_TO_END,u)}:null;this.getUID=(this.isHTMLDocument)?this.getUIDHTML:this.getUIDXML};b.search=function(k,y,G,q){var w=this.found=(q)?null:(G||[]);if(!k){return w}if(k.navigator){k=k.document}else{if(!k.nodeType){return w}}var t,F;var o=this.uniques={};if(this.document!==(k.ownerDocument||k)){this.setDocument(k)}var z=!!(G&&G.length);if(z){for(F=w.length;F--;){this.uniques[this.getUID(w[F])]=true}}if(typeof y=="string"){for(F=this.overrides.length;F--;){var u=this.overrides[F];if(u.regexp.test(y)){var v=u.method.call(k,y,w,q);if(v===false){continue}if(v===true){return w}return v}}t=this.Slick.parse(y);if(!t.length){return w}}else{if(y==null){return w}else{if(y.Slick){t=y}else{if(this.contains(k.documentElement||k,y)){(w)?w.push(y):w=y;return w}else{return w}}}}this.posNTH={};this.posNTHLast={};this.posNTHType={};this.posNTHTypeLast={};this.push=(!z&&(q||(t.length==1&&t.expressions[0].length==1)))?this.pushArray:this.pushUID;if(w==null){w=[]}var E,C,B;var D,L,A,K,H,s,p;var r,l,c,I,J=t.expressions;search:for(F=0;(l=J[F]);F++){for(E=0;(c=l[E]);E++){D="combinator:"+c.combinator;if(!this[D]){continue search}L=(this.isXMLDocument)?c.tag:c.tag.toUpperCase();A=c.id;K=c.classList;H=c.classes;s=c.attributes;p=c.pseudos;I=(E===(l.length-1));this.bitUniques={};if(I){this.uniques=o;this.found=w}else{this.uniques={};this.found=[]}if(E===0){this[D](k,L,A,H,s,p,K);if(q&&I&&w.length){break search}}else{if(q&&I){for(C=0,B=r.length;C<B;C++){this[D](r[C],L,A,H,s,p,K);if(w.length){break search}}}else{for(C=0,B=r.length;C<B;C++){this[D](r[C],L,A,H,s,p,K)}}}r=this.found}}if(z||(t.expressions.length>1)){this.sort(w)}return(q)?(w[0]||null):w};b.uidx=1;b.uidk="slick:uniqueid";b.getUIDXML=function(k){var c=k.getAttribute(this.uidk);if(!c){c=this.uidx++;k.setAttribute(this.uidk,c)}return c};b.getUIDHTML=function(c){return c.uniqueNumber||(c.uniqueNumber=this.uidx++)};b.sort=function(c){if(!this.documentSorter){return c}c.sort(this.documentSorter);return c};b.cacheNTH={};b.matchNTH=/^([+-]?\d*)?([a-z]+)?([+-]\d+)?$/;b.parseNTHArgument=function(o){var l=o.match(this.matchNTH);if(!l){return false}var m=l[2]||false;var k=l[1]||1;if(k=="-"){k=-1}var c=+l[3]||0;l=(m=="n")?{a:k,b:c}:(m=="odd")?{a:2,b:1}:(m=="even")?{a:2,b:0}:{a:0,b:k};return(this.cacheNTH[o]=l)};b.createNTHPseudo=function(m,k,c,l){return function(q,o){var s=this.getUID(q);if(!this[c][s]){var z=q.parentNode;if(!z){return false}var p=z[m],r=1;if(l){var y=q.nodeName;do{if(p.nodeName!==y){continue}this[c][this.getUID(p)]=r++}while((p=p[k]))}else{do{if(p.nodeType!==1){continue}this[c][this.getUID(p)]=r++}while((p=p[k]))}}o=o||"n";var t=this.cacheNTH[o]||this.parseNTHArgument(o);if(!t){return false}var w=t.a,v=t.b,u=this[c][s];if(w==0){return v==u}if(w>0){if(u<v){return false}}else{if(v<u){return false}}return((u-v)%w)==0}};b.pushArray=function(m,c,p,l,k,o){if(this.matchSelector(m,c,p,l,k,o)){this.found.push(m)}};b.pushUID=function(o,c,q,m,k,p){var l=this.getUID(o);if(!this.uniques[l]&&this.matchSelector(o,c,q,m,k,p)){this.uniques[l]=true;this.found.push(o)}};b.matchNode=function(p,c){var l=this.Slick.parse(c);if(!l){return true}if(l.length==1&&l.expressions[0].length==1){var q=l.expressions[0][0];return this.matchSelector(p,(this.isXMLDocument)?q.tag:q.tag.toUpperCase(),q.id,q.classes,q.attributes,q.pseudos)}var k=this.search(this.document,l);for(var m=0,o;o=k[m++];){if(o===p){return true}}return false};b.matchPseudo=function(o,c,m){var k="pseudo:"+c;if(this[k]){return this[k](o,m)}var l=this.getAttribute(o,c);return(m)?m==l:!!l};b.matchSelector=function(l,s,c,m,o,q){if(s){if(s=="*"){if(l.nodeName<"@"){return false}}else{if(l.nodeName!=s){return false}}}if(c&&l.getAttribute("id")!=c){return false}var p,k,r;if(m){for(p=m.length;p--;){r=("className" in l)?l.className:l.getAttribute("class");if(!(r&&m[p].regexp.test(r))){return false}}}if(o){for(p=o.length;p--;){k=o[p];if(k.operator?!k.test(this.getAttribute(l,k.key)):!this.hasAttribute(l,k.key)){return false}}}if(q){for(p=q.length;p--;){k=q[p];if(!this.matchPseudo(l,k.key,k.value)){return false}}}return true};var a={" ":function(m,t,c,o,p,r,l){var q,s,k;if(this.isHTMLDocument){getById:if(c){s=this.document.getElementById(c);if((!s&&m.all)||(this.idGetsName&&s&&s.getAttributeNode("id").nodeValue!=c)){k=m.all[c];if(!k){return}if(!k[0]){k=[k]}for(q=0;s=k[q++];){if(s.getAttributeNode("id").nodeValue==c){this.push(s,t,null,o,p,r);break}}return}if(!s){if(this.contains(this.document.documentElement,m)){return}else{break getById}}else{if(this.document!==m&&!this.contains(m,s)){return}}this.push(s,t,null,o,p,r);return}getByClass:if(o&&m.getElementsByClassName&&!this.brokenGEBCN){k=m.getElementsByClassName(l.join(" "));if(!(k&&k.length)){break getByClass}for(q=0;s=k[q++];){this.push(s,t,c,null,p,r)}return}}getByTag:{k=m.getElementsByTagName(t);if(!(k&&k.length)){break getByTag}if(!this.brokenStarGEBTN){t=null}for(q=0;s=k[q++];){this.push(s,t,c,o,p,r)}}},">":function(m,c,p,l,k,o){if((m=m.firstChild)){do{if(m.nodeType===1){this.push(m,c,p,l,k,o)}}while((m=m.nextSibling))}},"+":function(m,c,p,l,k,o){while((m=m.nextSibling)){if(m.nodeType===1){this.push(m,c,p,l,k,o);break}}},"^":function(m,c,p,l,k,o){m=m.firstChild;if(m){if(m.nodeType===1){this.push(m,c,p,l,k,o)}else{this["combinator:+"](m,c,p,l,k,o)}}},"~":function(o,c,q,m,k,p){while((o=o.nextSibling)){if(o.nodeType!==1){continue}var l=this.getUID(o);if(this.bitUniques[l]){break}this.bitUniques[l]=true;this.push(o,c,q,m,k,p)}},"++":function(m,c,p,l,k,o){this["combinator:+"](m,c,p,l,k,o);this["combinator:!+"](m,c,p,l,k,o)},"~~":function(m,c,p,l,k,o){this["combinator:~"](m,c,p,l,k,o);this["combinator:!~"](m,c,p,l,k,o)},"!":function(m,c,p,l,k,o){while((m=m.parentNode)){if(m!==this.document){this.push(m,c,p,l,k,o)}}},"!>":function(m,c,p,l,k,o){m=m.parentNode;if(m!==this.document){this.push(m,c,p,l,k,o)}},"!+":function(m,c,p,l,k,o){while((m=m.previousSibling)){if(m.nodeType===1){this.push(m,c,p,l,k,o);break}}},"!^":function(m,c,p,l,k,o){m=m.lastChild;if(m){if(m.nodeType===1){this.push(m,c,p,l,k,o)}else{this["combinator:!+"](m,c,p,l,k,o)}}},"!~":function(o,c,q,m,k,p){while((o=o.previousSibling)){if(o.nodeType!==1){continue}var l=this.getUID(o);if(this.bitUniques[l]){break}this.bitUniques[l]=true;this.push(o,c,q,m,k,p)}}};for(var j in a){b["combinator:"+j]=a[j]}var h={empty:function(c){var k=c.firstChild;return !(k&&k.nodeType==1)&&!(c.innerText||c.textContent||"").length},not:function(c,k){return !this.matchNode(c,k)},contains:function(c,k){return(c.innerText||c.textContent||"").indexOf(k)>-1},"first-child":function(c){while((c=c.previousSibling)){if(c.nodeType===1){return false}}return true},"last-child":function(c){while((c=c.nextSibling)){if(c.nodeType===1){return false}}return true},"only-child":function(l){var k=l;while((k=k.previousSibling)){if(k.nodeType===1){return false}}var c=l;while((c=c.nextSibling)){if(c.nodeType===1){return false}}return true},"nth-child":b.createNTHPseudo("firstChild","nextSibling","posNTH"),"nth-last-child":b.createNTHPseudo("lastChild","previousSibling","posNTHLast"),"nth-of-type":b.createNTHPseudo("firstChild","nextSibling","posNTHType",true),"nth-last-of-type":b.createNTHPseudo("lastChild","previousSibling","posNTHTypeLast",true),index:function(k,c){return this["pseudo:nth-child"](k,""+c+1)},even:function(k,c){return this["pseudo:nth-child"](k,"2n")},odd:function(k,c){return this["pseudo:nth-child"](k,"2n+1")},"first-of-type":function(c){var k=c.nodeName;while((c=c.previousSibling)){if(c.nodeName===k){return false}}return true},"last-of-type":function(c){var k=c.nodeName;while((c=c.nextSibling)){if(c.nodeName===k){return false}}return true},"only-of-type":function(l){var k=l,m=l.nodeName;while((k=k.previousSibling)){if(k.nodeName===m){return false}}var c=l;while((c=c.nextSibling)){if(c.nodeName===m){return false}}return true},enabled:function(c){return(c.disabled===false)},disabled:function(c){return(c.disabled===true)},checked:function(c){return c.checked||c.selected},focus:function(c){return this.isHTMLDocument&&this.document.activeElement===c&&(c.href||c.type||this.hasAttribute(c,"tabindex"))},root:function(c){return(c===this.root)},selected:function(c){return c.selected}};for(var d in h){b["pseudo:"+d]=h[d]}b.attributeGetters={"class":function(){return("className" in this)?this.className:this.getAttribute("class")},"for":function(){return("htmlFor" in this)?this.htmlFor:this.getAttribute("for")},href:function(){return("href" in this)?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return(this.style)?this.style.cssText:this.getAttribute("style")}};b.getAttribute=function(l,c){var m=this.attributeGetters[c];if(m){return m.call(l)}var k=l.getAttributeNode(c);return k?k.nodeValue:null};b.overrides=[];b.override=function(c,k){this.overrides.push({regexp:c,method:k})};var g=/\[.*[*$^]=(?:["']{2})?\]/;b.override(/./,function(r,p,q){if(!this.querySelectorAll||this.nodeType!=9||!b.isHTMLDocument||b.brokenMixedCaseQSA||(b.brokenCheckedQSA&&r.indexOf(":checked")>-1)||(b.brokenEmptyAttributeQSA&&g.test(r))||f.disableQSA){return false}var k,o;try{if(q){return this.querySelector(r)||null}else{k=this.querySelectorAll(r)}}catch(l){return false}var m,c=!!(p.length);if(b.starSelectsClosedQSA){for(m=0;o=k[m++];){if(o.nodeName>"@"&&(!c||!b.uniques[b.getUIDHTML(o)])){p.push(o)}}}else{for(m=0;o=k[m++];){if(!c||!b.uniques[b.getUIDHTML(o)]){p.push(o)}}}if(c){b.sort(p)}return true});b.override(/^[\w-]+$|^\*$/,function(r,p,q){var k=r;if(k=="*"&&b.brokenStarGEBTN){return false}var l=this.getElementsByTagName(k);if(q){return l[0]||null}var m,o,c=!!(p.length);for(m=0;o=l[m++];){if(!c||!b.uniques[b.getUID(o)]){p.push(o)}}if(c){b.sort(p)}return true});b.override(/^\.[\w-]+$/,function(q,s,o){if(!b.isHTMLDocument||(!this.getElementsByClassName&&this.querySelectorAll)){return false}var c,l,m,k=!!(s&&s.length),r=q.substring(1);if(this.getElementsByClassName&&!b.brokenGEBCN){c=this.getElementsByClassName(r);if(o){return c[0]||null}for(m=0;l=c[m++];){if(!k||!b.uniques[b.getUIDHTML(l)]){s.push(l)}}}else{var p=new RegExp("(^|\\s)"+f.escapeRegExp(r)+"(\\s|$)");c=this.getElementsByTagName("*");for(m=0;l=c[m++];){r=l.className;if(!r||!p.test(r)){continue}if(o){return l}if(!k||!b.uniques[b.getUIDHTML(l)]){s.push(l)}}}if(k){b.sort(s)}return(o)?null:true});b.override(/^#[\w-]+$/,function(o,l,m){if(!b.isHTMLDocument||this.nodeType!=9){return false}var p=o.substring(1),k=this.getElementById(p);if(!k){return l}if(b.idGetsName&&k.getAttributeNode("id").nodeValue!=p){return false}if(m){return k||null}var c=!!(l.length);if(!c||!b.uniques[b.getUIDHTML(k)]){l.push(k)}if(c){b.sort(l)}return true});if(typeof document!="undefined"){b.setDocument(document)}var f=b.Slick=(this.Slick||{});f.version="0.9dev";f.search=function(k,l,c){return b.search(k,l,c)};f.find=function(c,k){return b.search(c,k,null,true)};f.contains=function(c,k){b.setDocument(c);return b.contains(c,k)};f.getAttribute=function(k,c){return b.getAttribute(k,c)};f.match=function(k,c){if(!(k&&c)){return false}if(!c||c===k){return true}if(typeof c!="string"){return false}b.setDocument(k);return b.matchNode(k,c)};f.defineAttributeGetter=function(c,k){b.attributeGetters[c]=k;return this};f.lookupAttributeGetter=function(c){return b.attributeGetters[c]};f.definePseudo=function(c,k){b["pseudo:"+c]=function(m,l){return k.call(m,l)};return this};f.lookupPseudo=function(c){var k=b["pseudo:"+c];if(k){return function(l){return k.call(this,l)}}return null};f.override=function(k,c){b.override(k,c);return this};f.isXML=b.isXML;f.uidOf=function(c){return b.getUIDHTML(c)};if(!this.Slick){this.Slick=f}}).apply(this);(function(){var document=this.document;var window=document.window=this;var UID=1;this.$uid=(window.ActiveXObject)?function(item){return(item.uid||(item.uid=[UID++]))[0]}:function(item){return item.uid||(item.uid=UID++)};$uid(window);$uid(document);var ua=navigator.userAgent.toLowerCase(),platform=navigator.platform.toLowerCase(),UA=ua.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],mode=UA[1]=="ie"&&document.documentMode;var Browser=this.Browser={extend:Function.prototype.extend,name:(UA[1]=="version")?UA[3]:UA[1],version:mode||parseFloat((UA[1]=="opera"&&UA[4])?UA[4]:UA[2]),Platform:{name:ua.match(/ip(?:ad|od|hone)/)?"ios":(ua.match(/(?:webos|android)/)||platform.match(/mac|win|linux/)||["other"])[0]},Features:{xpath:!!(document.evaluate),air:!!(window.runtime),query:!!(document.querySelector),json:!!(window.JSON)},Plugins:{}};Browser[Browser.name]=true;Browser[Browser.name+parseInt(Browser.version,10)]=true;Browser.Platform[Browser.Platform.name]=true;Browser.Request=(function(){var XMLHTTP=function(){return new XMLHttpRequest()};var MSXML2=function(){return new ActiveXObject("MSXML2.XMLHTTP")};var MSXML=function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Function.attempt(function(){XMLHTTP();return XMLHTTP},function(){MSXML2();return MSXML2},function(){MSXML();return MSXML})})();Browser.Features.xhr=!!(Browser.Request);var version=(Function.attempt(function(){return navigator.plugins["Shockwave Flash"].description},function(){return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")})||"0 r0").match(/\d+/g);Browser.Plugins.Flash={version:Number(version[0]||"0."+version[1])||0,build:Number(version[2])||0};Browser.exec=function(text,force){if(!text){return text}if(window.execScript){window.execScript(text)}else{if(Browser.firefox&&force){window.eval(text)}else{var script=document.createElement("script");script.setAttribute("type","text/javascript");script.text=text;document.head.appendChild(script);document.head.removeChild(script)}}return text};String.implement("stripScripts",function(exec,force){var scripts="";var text=this.replace(/<script([^>]*)>([\s\S]*?)<\/script>/gi,function(all,attribs,code){if(/type=['"]text\/html['"]/.test(attribs)&&exec===true){var script=document.createElement("script");script.setAttribute("type","text/html");if(/id=['"]([^'"]+)['"]/.test(attribs)){script.setAttribute("id",RegExp.$1)}script.text=code;document.head.appendChild(script);return""}scripts+=code+"\n";return""});if(exec===true){Browser.exec(scripts,force)}else{if(typeOf(exec)=="function"){exec(scripts,text)}}return text});Browser.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event});this.Window=this.$constructor=new Type("Window",function(){});this.$family=Function.from("window").hide();Window.mirror(function(name,method){window[name]=method});this.Document=document.$constructor=new Type("Document",function(){});document.$family=Function.from("document").hide();Document.mirror(function(name,method){document[name]=method});document.html=document.documentElement;document.head=document.getElementsByTagName("head")[0];if(document.execCommand){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}if(this.attachEvent&&!this.addEventListener){var unloadEvent=function(){this.detachEvent("onunload",unloadEvent);document.head=document.html=document.window=null};this.attachEvent("onunload",unloadEvent)}var arrayFrom=Array.from;try{arrayFrom(document.html.childNodes)}catch(e){Array.from=function(item){if(typeof item!="string"&&Type.isEnumerable(item)&&typeOf(item)!="array"){var i=item.length,array=new Array(i);while(i--){array[i]=item[i]}return array}return arrayFrom(item)};var prototype=Array.prototype,slice=prototype.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each(function(name){var method=prototype[name];Array[name]=function(item){return method.apply(Array.from(item),slice.call(arguments,1))}})}})();(function(){var a=this.Class=new Type("Class",function(j){if(instanceOf(j,Function)){j={initialize:j}}var h=function(){f(this);if(h.$prototyping){return this}this.$caller=null;var k=(this.initialize)?this.initialize.apply(this,arguments):this;this.$caller=this.caller=null;return k}.extend(this).implement(j);h.$constructor=a;h.prototype.$constructor=h;h.prototype.parent=c;return h});var c=function(){if(!this.$caller){throw new Error('The method "parent" cannot be called.')}var h=this.$caller.$name,j=this.$caller.$owner.parent,k=(j)?j.prototype[h]:null;if(!k){throw new Error('The method "'+h+'" has no parent.')}return k.apply(this,arguments)};var f=function(h){for(var j in h){var l=h[j];switch(typeOf(l)){case"object":var k=function(){};k.prototype=l;h[j]=f(new k);break;case"array":h[j]=l.clone();break}}return h};var b=function(h,j,l){if(l.$origin){l=l.$origin}var k=function(){if(l.$protected&&this.$caller==null){throw new Error('The method "'+j+'" cannot be called.')}var o=this.caller,p=this.$caller;this.caller=p;this.$caller=k;var m=l.apply(this,arguments);this.$caller=p;this.caller=o;return m}.extend({$owner:h,$origin:l,$name:j});return k};var g=function(j,k,h){if(a.Mutators.hasOwnProperty(j)){k=a.Mutators[j].call(this,k);if(k==null){return this}}if(typeOf(k)=="function"){if(k.$hidden){return this}this.prototype[j]=(h)?k:b(this,j,k)}else{Object.merge(this.prototype,j,k)}return this};var d=function(h){h.$prototyping=true;var j=new h;delete h.$prototyping;return j};a.implement("implement",g.overloadSetter());a.Mutators={Extends:function(h){this.parent=h;this.prototype=d(h)},Implements:function(h){Array.from(h).each(function(l){var j=new l;for(var k in j){g.call(this,k,j[k],true)}},this)}}})();(function(){this.Chain=new Class({$chain:[],chain:function(){this.$chain.append(Array.flatten(arguments));return this},callChain:function(){return(this.$chain.length)?this.$chain.shift().apply(this,arguments):false},clearChain:function(){this.$chain.empty();return this}});var a=function(b){return b.replace(/^on([A-Z])/,function(c,d){return d.toLowerCase()})};this.Events=new Class({$events:{},addEvent:function(d,c,b){d=a(d);this.$events[d]=(this.$events[d]||[]).include(c);if(b){c.internal=true}return this},addEvents:function(b){for(var c in b){this.addEvent(c,b[c])}return this},fireEvent:function(f,c,b){f=a(f);var d=this.$events[f];if(!d){return this}c=Array.from(c);d.each(function(g){if(b){g.delay(b,this,c)}else{g.apply(this,c)}},this);return this},removeEvent:function(f,d){f=a(f);var c=this.$events[f];if(c&&!d.internal){var b=c.indexOf(d);if(b!=-1){delete c[b]}}return this},removeEvents:function(d){var f;if(typeOf(d)=="object"){for(f in d){this.removeEvent(f,d[f])}return this}if(d){d=a(d)}for(f in this.$events){if(d&&d!=f){continue}var c=this.$events[f];for(var b=c.length;b--;){if(b in c){this.removeEvent(f,c[b])}}}return this}});this.Options=new Class({setOptions:function(){var b=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent){for(var c in b){if(typeOf(b[c])!="function"||!(/^on[A-Z]/).test(c)){continue}this.addEvent(c,b[c]);delete b[c]}}return this}})})();var Element=function(b,h){var j=Element.Constructors[b];if(j){return j(h)}if(typeof b!="string"){return document.id(b).set(h)}if(!h){h={}}if(!(/^[\w-]+$/).test(b)){var f=Slick.parse(b).expressions[0][0];b=(f.tag=="*")?"div":f.tag;if(f.id&&h.id==null){h.id=f.id}var d=f.attributes;if(d){for(var g=0,c=d.length;g<c;g++){var a=d[g];if(a.value!=null&&a.operator=="="&&h[a.key]==null){h[a.key]=a.value}}}if(f.classList&&h["class"]==null){h["class"]=f.classList.join(" ")}}return document.newElement(b,h)};if(Browser.Element){Element.prototype=Browser.Element.prototype}new Type("Element",Element).mirror(function(a){if(Array.prototype[a]){return}var b={};b[a]=function(){var j=[],f=arguments,k=true;for(var h=0,d=this.length;h<d;h++){var g=this[h],c=j[h]=g[a].apply(g,f);k=(k&&typeOf(c)=="element")}return(k)?new Elements(j):j};Elements.implement(b)});if(!Browser.Element){Element.parent=Object;Element.Prototype={"$family":Function.from("element").hide()};Element.mirror(function(a,b){Element.Prototype[a]=b})}Element.Constructors={};var IFrame=new Type("IFrame",function(){var f=Array.link(arguments,{properties:Type.isObject,iframe:function(g){return(g!=null)}});var c=f.properties||{},b;if(f.iframe){b=document.id(f.iframe)}var d=c.onload||function(){};delete c.onload;c.id=c.name=[c.id,c.name,b?(b.id||b.name):"IFrame_"+String.uniqueID()].pick();b=new Element(b||"iframe",c);var a=function(){d.call(b.contentWindow)};if(window.frames[c.id]){a()}else{b.addListener("load",a)}return b});var Elements=this.Elements=function(a){if(a&&a.length){var f={},d;for(var c=0;d=a[c++];){var b=Slick.uidOf(d);if(!f[b]){f[b]=true;this.push(d)}}}};Elements.prototype={length:0};Elements.parent=Array;new Type("Elements",Elements).implement({filter:function(a,b){if(!a){return this}return new Elements(Array.filter(this,(typeOf(a)=="string")?function(c){return c.match(a)}:a,b))}.protect(),push:function(){var d=this.length;for(var b=0,a=arguments.length;b<a;b++){var c=document.id(arguments[b]);if(c){this[d++]=c}}return(this.length=d)}.protect(),unshift:function(){var b=[];for(var c=0,a=arguments.length;c<a;c++){var d=document.id(arguments[c]);if(d){b.push(d)}}return Array.prototype.unshift.apply(this,b)}.protect(),concat:function(){var b=new Elements(this);for(var c=0,a=arguments.length;c<a;c++){var d=arguments[c];if(Type.isEnumerable(d)){b.append(d)}else{b.push(d)}}return b}.protect(),append:function(c){for(var b=0,a=c.length;b<a;b++){this.push(c[b])}return this}.protect(),empty:function(){while(this.length){delete this[--this.length]}return this}.protect()});(function(){var g=Array.prototype.splice,b={"0":0,"1":1,length:2};g.call(b,1,1);if(b[1]==1){Elements.implement("splice",function(){var h=this.length;g.apply(this,arguments);while(h>=this.length){delete this[h--]}return this}.protect())}Elements.implement(Array.prototype);Array.mirror(Elements);var f;try{var a=document.createElement("<input name=x>");f=(a.name=="x")}catch(c){}var d=function(h){return(""+h).replace(/&/g,"&amp;").replace(/"/g,"&quot;")};Document.implement({newElement:function(h,j){if(j&&j.checked!=null){j.defaultChecked=j.checked}if(f&&j){h="<"+h;if(j.name){h+=' name="'+d(j.name)+'"'}if(j.type){h+=' type="'+d(j.type)+'"'}h+=">";delete j.name;delete j.type}return this.id(this.createElement(h)).set(j)}})})();Document.implement({newTextNode:function(a){return this.createTextNode(a)},getDocument:function(){return this},getWindow:function(){return this.window},id:(function(){var a={string:function(d,c,b){d=Slick.find(b,"#"+d.replace(/(\W)/g,"\\$1"));return(d)?a.element(d,c):null},element:function(b,c){$uid(b);if(!c&&!b.$family&&!(/^(?:object|embed)$/i).test(b.tagName)){Object.append(b,Element.Prototype)}return b},object:function(c,d,b){if(c.toElement){return a.element(c.toElement(b),d)}return null}};a.textnode=a.whitespace=a.window=a.document=function(b){return b};return function(c,f,d){if(c&&c.$family&&c.uid){return c}var b=typeOf(c);return(a[b])?a[b](c,f,d||document):null}})()});if(window.$==null){Window.implement("$",function(a,b){return document.id(a,b,this.document)})}Window.implement({getDocument:function(){return this.document},getWindow:function(){return this}});[Document,Element].invoke("implement",{getElements:function(a){return Slick.search(this,a,new Elements)},getElement:function(a){return document.id(Slick.find(this,a))}});if(window.$$==null){Window.implement("$$",function(a){if(arguments.length==1){if(typeof a=="string"){return Slick.search(this.document,a,new Elements)}else{if(Type.isEnumerable(a)){return new Elements(a)}}}return new Elements(arguments)})}(function(){var m={},k={};var q={input:"checked",option:"selected",textarea:"value"};var f=function(s){return(k[s]||(k[s]={}))};var l=function(t){if(t.removeEvents){t.removeEvents()}if(t.clearAttributes){t.clearAttributes()}var s=t.uid;if(s!=null){delete m[s];delete k[s]}return t};var r=["defaultValue","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","maxLength","readOnly","rowSpan","tabIndex","useMap"];var d=["compact","nowrap","ismap","declare","noshade","checked","disabled","readOnly","multiple","selected","noresize","defer","defaultChecked"];var h={html:"innerHTML","class":"className","for":"htmlFor",text:(function(){var s=document.createElement("div");return(s.innerText==null)?"textContent":"innerText"})()};var p=["type"];var j=["value","defaultValue"];var o=/^(?:href|src|usemap)$/i;d=d.associate(d);r=r.associate(r.map(String.toLowerCase));p=p.associate(p);Object.append(h,j.associate(j));var c={before:function(t,s){var u=s.parentNode;if(u){u.insertBefore(t,s)}},after:function(t,s){var u=s.parentNode;if(u){u.insertBefore(t,s.nextSibling)}},bottom:function(t,s){s.appendChild(t)},top:function(t,s){s.insertBefore(t,s.firstChild)}};c.inside=c.bottom;var b=function(v,u){if(!v){return u}v=Slick.parse(v);var t=v.expressions;for(var s=t.length;s--;){t[s][0].combinator=u}return v};Element.implement({set:function(u,t){var s=Element.Properties[u];(s&&s.set)?s.set.call(this,t):this.setProperty(u,t)}.overloadSetter(),get:function(t){var s=Element.Properties[t];return(s&&s.get)?s.get.apply(this):this.getProperty(t)}.overloadGetter(),erase:function(t){var s=Element.Properties[t];(s&&s.erase)?s.erase.apply(this):this.removeProperty(t);return this},setProperty:function(t,u){t=r[t]||t;if(u==null){return this.removeProperty(t)}var s=h[t];(s)?this[s]=u:(d[t])?this[t]=!!u:this.setAttribute(t,""+u);return this},setProperties:function(s){for(var t in s){this.setProperty(t,s[t])}return this},getProperty:function(t){t=r[t]||t;var s=h[t]||p[t];return(s)?this[s]:(d[t])?!!this[t]:(o.test(t)?this.getAttribute(t,2):(s=this.getAttributeNode(t))?s.nodeValue:null)||null},getProperties:function(){var s=Array.from(arguments);return s.map(this.getProperty,this).associate(s)},removeProperty:function(t){t=r[t]||t;var s=h[t];(s)?this[s]="":(d[t])?this[t]=false:this.removeAttribute(t);return this},removeProperties:function(){Array.each(arguments,this.removeProperty,this);return this},hasClass:function(s){return this.className.clean().contains(s," ")},addClass:function(s){if(!this.hasClass(s)){this.className=(this.className+" "+s).clean()}return this},removeClass:function(s){this.className=this.className.replace(new RegExp("(^|\\s)"+s+"(?:\\s|$)"),"$1");return this},toggleClass:function(s,t){if(t==null){t=!this.hasClass(s)}return(t)?this.addClass(s):this.removeClass(s)},adopt:function(){var v=this,s,y=Array.flatten(arguments),w=y.length;if(w>1){v=s=document.createDocumentFragment()}for(var u=0;u<w;u++){var t=document.id(y[u],true);if(t){v.appendChild(t)}}if(s){this.appendChild(s)}return this},appendText:function(t,s){return this.grab(this.getDocument().newTextNode(t),s)},grab:function(t,s){c[s||"bottom"](document.id(t,true),this);return this},inject:function(t,s){c[s||"bottom"](this,document.id(t,true));return this},replaces:function(s){s=document.id(s,true);s.parentNode.replaceChild(this,s);return this},wraps:function(t,s){t=document.id(t,true);return this.replaces(t).grab(t,s)},getPrevious:function(s){return document.id(Slick.find(this,b(s,"!~")))},getAllPrevious:function(s){return Slick.search(this,b(s,"!~"),new Elements)},getNext:function(s){return document.id(Slick.find(this,b(s,"~")))},getAllNext:function(s){return Slick.search(this,b(s,"~"),new Elements)},getFirst:function(s){return document.id(Slick.search(this,b(s,">"))[0])},getLast:function(s){return document.id(Slick.search(this,b(s,">")).getLast())},getParent:function(s){return document.id(Slick.find(this,b(s,"!")))},getParents:function(s){return Slick.search(this,b(s,"!"),new Elements)},getSiblings:function(s){return Slick.search(this,b(s,"~~"),new Elements)},getChildren:function(s){return Slick.search(this,b(s,">"),new Elements)},getWindow:function(){return this.ownerDocument.window},getDocument:function(){return this.ownerDocument},getElementById:function(s){return document.id(Slick.find(this,"#"+(""+s).replace(/(\W)/g,"\\$1")))},getSelected:function(){this.selectedIndex;return new Elements(Array.from(this.options).filter(function(s){return s.selected}))},toQueryString:function(){var s=[];this.getElements("input, select, textarea").each(function(u){var t=u.type;if(!u.name||u.disabled||t=="submit"||t=="reset"||t=="file"||t=="image"){return}var v=(u.get("tag")=="select")?u.getSelected().map(function(w){return document.id(w).get("value")}):((t=="radio"||t=="checkbox")&&!u.checked)?null:u.get("value");Array.from(v).each(function(w){if(typeof w!="undefined"){s.push(encodeURIComponent(u.name)+"="+encodeURIComponent(w))}})});return s.join("&")},destroy:function(){var s=l(this).getElementsByTagName("*");Array.each(s,l);Element.dispose(this);return null},empty:function(){Array.from(this.childNodes).each(Element.dispose);return this},dispose:function(){return(this.parentNode)?this.parentNode.removeChild(this):this},match:function(s){return !s||Slick.match(this,s)}});var a=function(w,v,t){if(!t){w.removeAttribute("id")}if(Browser.ie){w.clearAttributes();w.mergeAttributes(v);w.removeAttribute("uid");if(w.options){var y=w.options,s=v.options;for(var u=y.length;u--;){y[u].selected=s[u].selected}}}var z=q[v.tagName.toLowerCase()];if(z&&v[z]){w[z]=v[z]}};Element.implement("clone",function(u,s){u=u!==false;var A=this.cloneNode(u);if(u){var v=A.getElementsByTagName("*"),y=this.getElementsByTagName("*");for(var t=v.length;t--;){a(v[t],y[t],s)}}a(A,this,s);if(Browser.ie){var w=A.getElementsByTagName("object"),z=this.getElementsByTagName("object");for(var t=w.length;t--;){w[t].outerHTML=z[t].outerHTML}}return document.id(A)});var g={contains:function(s){return Slick.contains(this,s)}};if(!document.contains){Document.implement(g)}if(!document.createElement("div").contains){Element.implement(g)}[Element,Window,Document].invoke("implement",{addListener:function(v,u){if(v=="unload"){var s=u,t=this;u=function(){t.removeListener("unload",u);s()}}else{m[$uid(this)]=this}if(this.addEventListener){this.addEventListener(v,u,!!arguments[2])}else{this.attachEvent("on"+v,u)}return this},removeListener:function(t,s){if(this.removeEventListener){this.removeEventListener(t,s,!!arguments[2])}else{this.detachEvent("on"+t,s)}return this},retrieve:function(t,s){var v=f($uid(this)),u=v[t];if(s!=null&&u==null){u=v[t]=s}return u!=null?u:null},store:function(t,s){var u=f($uid(this));u[t]=s;return this},eliminate:function(s){var t=f($uid(this));delete t[s];return this}});if(window.attachEvent&&!window.addEventListener){window.addListener("unload",function(){Object.each(m,l);if(window.CollectGarbage){CollectGarbage()}})}})();Element.Properties={};Element.Properties.style={set:function(a){this.style.cssText=a},get:function(){return this.style.cssText},erase:function(){this.style.cssText=""}};Element.Properties.tag={get:function(){return this.tagName.toLowerCase()}};(function(a){if(a!=null){Element.Properties.maxlength=Element.Properties.maxLength={get:function(){var b=this.getAttribute("maxLength");return b==a?null:b}}}})(document.createElement("input").getAttribute("maxLength"));Element.Properties.html=(function(){var c=Function.attempt(function(){var f=document.createElement("table");f.innerHTML="<tr><td></td></tr>"});var d=document.createElement("div");var a={table:[1,"<table>","</table>"],select:[1,"<select>","</select>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"]};a.thead=a.tfoot=a.tbody;var b={set:function(){var g=Array.flatten(arguments).join("");var h=(!c&&a[this.get("tag")]);if(h){var j=d;j.innerHTML=h[1]+g+h[2];for(var f=h[0];f--;){j=j.firstChild}this.empty().adopt(j.childNodes)}else{this.innerHTML=g}}};b.erase=b.set;return b})();(function(){var c=document.html;Element.Properties.styles={set:function(g){this.setStyles(g)}};var f=(c.style.opacity!=null);var d=/alpha\(opacity=([\d.]+)\)/i;var b=function(h,g){if(!h.currentStyle||!h.currentStyle.hasLayout){h.style.zoom=1}if(f){h.style.opacity=g}else{g=(g==1)?"":"alpha(opacity="+g*100+")";var j=h.style.filter||h.getComputedStyle("filter")||"";h.style.filter=d.test(j)?j.replace(d,g):j+g}};Element.Properties.opacity={set:function(h){var g=this.style.visibility;if(h==0&&g!="hidden"){this.style.visibility="hidden"}else{if(h!=0&&g!="visible"){this.style.visibility="visible"}}b(this,h)},get:(f)?function(){var g=this.style.opacity||this.getComputedStyle("opacity");return(g=="")?1:g}:function(){var g,h=(this.style.filter||this.getComputedStyle("filter"));if(h){g=h.match(d)}return(g==null||h==null)?1:(g[1]/100)}};var a=(c.style.cssFloat==null)?"styleFloat":"cssFloat";Element.implement({getComputedStyle:function(j){if(this.currentStyle){return this.currentStyle[j.camelCase()]}var h=Element.getDocument(this).defaultView,g=h?h.getComputedStyle(this,null):null;return(g)?g.getPropertyValue((j==a)?"float":j.hyphenate()):null},setOpacity:function(g){b(this,g);return this},getOpacity:function(){return this.get("opacity")},setStyle:function(h,g){switch(h){case"opacity":return this.set("opacity",parseFloat(g));case"float":h=a}h=h.camelCase();if(typeOf(g)!="string"){var j=(Element.Styles[h]||"@").split(" ");g=Array.from(g).map(function(l,k){if(!j[k]){return""}return(typeOf(l)=="number")?j[k].replace("@",Math.round(l)):l}).join(" ")}else{if(g==String(Number(g))){g=Math.round(g)}}this.style[h]=g;return this},getStyle:function(o){switch(o){case"opacity":return this.get("opacity");case"float":o=a}o=o.camelCase();var g=this.style[o];if(!g||o=="zIndex"){g=[];for(var m in Element.ShortStyles){if(o!=m){continue}for(var l in Element.ShortStyles[m]){g.push(this.getStyle(l))}return g.join(" ")}g=this.getComputedStyle(o)}if(g){g=String(g);var j=g.match(/rgba?\([\d\s,]+\)/);if(j){g=g.replace(j[0],j[0].rgbToHex())}}if(Browser.opera||(Browser.ie&&isNaN(parseFloat(g)))){if((/^(height|width)$/).test(o)){var h=(o=="width")?["left","right"]:["top","bottom"],k=0;h.each(function(p){k+=this.getStyle("border-"+p+"-width").toInt()+this.getStyle("padding-"+p).toInt()},this);return this["offset"+o.capitalize()]-k+"px"}if(Browser.opera&&String(g).indexOf("px")!=-1){return g}if((/^border(.+)Width|margin|padding/).test(o)){return"0px"}}return g},setStyles:function(h){for(var g in h){this.setStyle(g,h[g])}return this},getStyles:function(){var g={};Array.flatten(arguments).each(function(h){g[h]=this.getStyle(h)},this);return g}});Element.Styles={left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@"};Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}};["Top","Right","Bottom","Left"].each(function(o){var m=Element.ShortStyles;var h=Element.Styles;["margin","padding"].each(function(p){var q=p+o;m[p][q]=h[q]="@px"});var l="border"+o;m.border[l]=h[l]="@px @ rgb(@, @, @)";var k=l+"Width",g=l+"Style",j=l+"Color";m[l]={};m.borderWidth[k]=m[l][k]=h[k]="@px";m.borderStyle[g]=m[l][g]=h[g]="@";m.borderColor[j]=m[l][j]=h[j]="rgb(@, @, @)"})})();(function(){var j=document.createElement("div"),f=document.createElement("div");j.style.height="0";j.appendChild(f);var d=(f.offsetParent===j);j=f=null;var o=function(p){return m(p,"position")!="static"||a(p)};var k=function(p){return o(p)||(/^(?:table|td|th)$/i).test(p.tagName)};Element.implement({scrollTo:function(p,q){if(a(this)){this.getWindow().scrollTo(p,q)}else{this.scrollLeft=p;this.scrollTop=q}return this},getSize:function(){if(a(this)){return this.getWindow().getSize()}return{x:this.offsetWidth,y:this.offsetHeight}},getScrollSize:function(){if(a(this)){return this.getWindow().getScrollSize()}return{x:this.scrollWidth,y:this.scrollHeight}},getScroll:function(){if(a(this)){return this.getWindow().getScroll()}return{x:this.scrollLeft,y:this.scrollTop}},getScrolls:function(){var q=this.parentNode,p={x:0,y:0};while(q&&!a(q)){p.x+=q.scrollLeft;p.y+=q.scrollTop;q=q.parentNode}return p},getOffsetParent:d?function(){var p=this;if(a(p)||m(p,"position")=="fixed"){return null}var q=(m(p,"position")=="static")?k:o;while((p=p.parentNode)){if(q(p)){return p}}return null}:function(){var p=this;if(a(p)||m(p,"position")=="fixed"){return null}try{return p.offsetParent}catch(q){}return null},getOffsets:function(){if(this.getBoundingClientRect&&!Browser.Platform.ios){var u=this.getBoundingClientRect(),r=document.id(this.getDocument().documentElement),t=r.getScroll(),w=this.getScrolls(),v=(m(this,"position")=="fixed");return{x:u.left.toInt()+w.x+((v)?0:t.x)-r.clientLeft,y:u.top.toInt()+w.y+((v)?0:t.y)-r.clientTop}}var q=this,p={x:0,y:0};if(a(this)){return p}while(q&&!a(q)){p.x+=q.offsetLeft;p.y+=q.offsetTop;if(Browser.firefox){if(!c(q)){p.x+=b(q);p.y+=h(q)}var s=q.parentNode;if(s&&m(s,"overflow")!="visible"){p.x+=b(s);p.y+=h(s)}}else{if(q!=this&&Browser.safari){p.x+=b(q);p.y+=h(q)}}q=q.offsetParent}if(Browser.firefox&&!c(this)){p.x-=b(this);p.y-=h(this)}return p},getPosition:function(s){if(a(this)){return{x:0,y:0}}var t=this.getOffsets(),q=this.getScrolls();var p={x:t.x-q.x,y:t.y-q.y};if(s&&(s=document.id(s))){var r=s.getPosition();return{x:p.x-r.x-b(s),y:p.y-r.y-h(s)}}return p},getCoordinates:function(r){if(a(this)){return this.getWindow().getCoordinates()}var p=this.getPosition(r),q=this.getSize();var s={left:p.x,top:p.y,width:q.x,height:q.y};s.right=s.left+s.width;s.bottom=s.top+s.height;return s},computePosition:function(p){return{left:p.x-l(this,"margin-left"),top:p.y-l(this,"margin-top")}},setPosition:function(p){return this.setStyles(this.computePosition(p))}});[Document,Window].invoke("implement",{getSize:function(){var p=g(this);return{x:p.clientWidth,y:p.clientHeight}},getScroll:function(){var q=this.getWindow(),p=g(this);return{x:q.pageXOffset||p.scrollLeft,y:q.pageYOffset||p.scrollTop}},getScrollSize:function(){var r=g(this),q=this.getSize(),p=this.getDocument().body;return{x:Math.max(r.scrollWidth,p.scrollWidth,q.x),y:Math.max(r.scrollHeight,p.scrollHeight,q.y)}},getPosition:function(){return{x:0,y:0}},getCoordinates:function(){var p=this.getSize();return{top:0,left:0,bottom:p.y,right:p.x,height:p.y,width:p.x}}});var m=Element.getComputedStyle;function l(p,q){return m(p,q).toInt()||0}function c(p){return m(p,"-moz-box-sizing")=="border-box"}function h(p){return l(p,"border-top-width")}function b(p){return l(p,"border-left-width")}function a(p){return(/^(?:body|html)$/i).test(p.tagName)}function g(p){var q=p.getDocument();return(!q.compatMode||q.compatMode=="CSS1Compat")?q.html:q.body}})();Element.alias({position:"setPosition"});[Window,Document,Element].invoke("implement",{getHeight:function(){return this.getSize().y},getWidth:function(){return this.getSize().x},getScrollTop:function(){return this.getScroll().y},getScrollLeft:function(){return this.getScroll().x},getScrollHeight:function(){return this.getScrollSize().y},getScrollWidth:function(){return this.getScrollSize().x},getTop:function(){return this.getPosition().y},getLeft:function(){return this.getPosition().x}});(function(){Element.Properties.events={set:function(c){this.addEvents(c)}};[Element,Window,Document].invoke("implement",{addEvent:function(h,k){var l=this.retrieve("events",{});if(!l[h]){l[h]={keys:[],values:[]}}if(l[h].keys.contains(k)){return this}l[h].keys.push(k);var j=h,c=Element.Events[h],f=k,m=this;if(c){if(c.onAdd){c.onAdd.call(this,k)}if(c.condition){f=function(o){if(c.condition.call(this,o)){return k.call(this,o)}return true}}j=c.base||j}var g=function(){return k.call(m)};var d=Element.NativeEvents[j];if(d){if(d==2){g=function(o){o=new Event(o,m.getWindow());if(f.call(m,o)===false){o.stop()}}}this.addListener(j,g,arguments[2])}l[h].values.push(g);return this},removeEvent:function(g,f){var d=this.retrieve("events");if(!d||!d[g]){return this}var k=d[g];var c=k.keys.indexOf(f);if(c==-1){return this}var j=k.values[c];delete k.keys[c];delete k.values[c];var h=Element.Events[g];if(h){if(h.onRemove){h.onRemove.call(this,f)}g=h.base||g}return(Element.NativeEvents[g])?this.removeListener(g,j,arguments[2]):this},addEvents:function(c){for(var d in c){this.addEvent(d,c[d])}return this},removeEvents:function(c){var f;if(typeOf(c)=="object"){for(f in c){this.removeEvent(f,c[f])}return this}var d=this.retrieve("events");if(!d){return this}if(!c){for(f in d){this.removeEvents(f)}this.eliminate("events")}else{if(d[c]){d[c].keys.each(function(g){this.removeEvent(c,g)},this);delete d[c]}}return this},fireEvent:function(g,d,c){var f=this.retrieve("events");if(!f||!f[g]){return this}d=Array.from(d);f[g].keys.each(function(h){if(c){h.delay(c,this,d)}else{h.apply(this,d)}},this);return this},cloneEvents:function(g,f){g=document.id(g);var d=g.retrieve("events");if(!d){return this}if(!f){for(var c in d){this.cloneEvents(g,c)}}else{if(d[f]){d[f].keys.each(function(h){this.addEvent(f,h)},this)}}return this}});try{if(typeof HTMLElement!="undefined"){HTMLElement.prototype.fireEvent=Element.prototype.fireEvent}}catch(b){}Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,orientationchange:2,touchstart:2,touchmove:2,touchend:2,touchcancel:2,gesturestart:2,gesturechange:2,gestureend:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,load:2,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1};var a=function(c){var d=c.relatedTarget;if(d==null){return true}if(!d){return false}return(d!=this&&d.prefix!="xul"&&typeOf(this)!="document"&&!this.contains(d))};Element.Events={mouseenter:{base:"mouseover",condition:a},mouseleave:{base:"mouseout",condition:a},mousewheel:{base:(Browser.firefox)?"DOMMouseScroll":"mousewheel"}}})();(function(){var g=this.Fx=new Class({Implements:[Chain,Events,Options],options:{fps:60,unit:false,duration:500,frames:null,frameSkip:true,link:"ignore"},initialize:function(h){this.subject=this.subject||this;this.setOptions(h)},getTransition:function(){return function(h){return -(Math.cos(Math.PI*h)-1)/2}},step:function(h){if(this.options.frameSkip){var j=(this.time!=null)?(h-this.time):0,k=j/this.frameInterval;this.time=h;this.frame+=k}else{this.frame++}if(this.frame<this.frames){var l=this.transition(this.frame/this.frames);this.set(this.compute(this.from,this.to,l))}else{this.frame=this.frames;this.set(this.compute(this.from,this.to,1));this.stop()}},set:function(h){return h},compute:function(k,j,h){return g.compute(k,j,h)},check:function(){if(!this.isRunning()){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},start:function(m,l){if(!this.check(m,l)){return this}this.from=m;this.to=l;this.frame=(this.options.frameSkip)?0:-1;this.time=null;this.transition=this.getTransition();var k=this.options.frames,j=this.options.fps,h=this.options.duration;this.duration=g.Durations[h]||h.toInt();this.frameInterval=1000/j;this.frames=k||Math.round(this.duration/this.frameInterval);this.fireEvent("start",this.subject);b.call(this,j);return this},stop:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps);if(this.frames==this.frame){this.fireEvent("complete",this.subject);if(!this.callChain()){this.fireEvent("chainComplete",this.subject)}}else{this.fireEvent("stop",this.subject)}}return this},cancel:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps);this.frame=this.frames;this.fireEvent("cancel",this.subject).clearChain()}return this},pause:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps)}return this},resume:function(){if((this.frame<this.frames)&&!this.isRunning()){b.call(this,this.options.fps)}return this},isRunning:function(){var h=f[this.options.fps];return h&&h.contains(this)}});g.compute=function(k,j,h){return(j-k)*h+k};g.Durations={"short":250,normal:500,"long":1000};var f={},c={};var a=function(){var j=Date.now();for(var k=this.length;k--;){var h=this[k];if(h){h.step(j)}}};var b=function(j){var h=f[j]||(f[j]=[]);h.push(this);if(!c[j]){c[j]=a.periodical(Math.round(1000/j),h)}};var d=function(j){var h=f[j];if(h){h.erase(this);if(!h.length&&c[j]){delete f[j];c[j]=clearInterval(c[j])}}}})();Fx.CSS=new Class({Extends:Fx,prepare:function(c,d,b){b=Array.from(b);if(b[1]==null){b[1]=b[0];b[0]=c.getStyle(d)}var a=b.map(this.parse);return{from:a[0],to:a[1]}},parse:function(a){a=Function.from(a)();a=(typeof a=="string")?a.split(" "):Array.from(a);return a.map(function(c){c=String(c);var b=false;Object.each(Fx.CSS.Parsers,function(g,f){if(b){return}var d=g.parse(c);if(d||d===0){b={value:d,parser:g}}});b=b||{value:c,parser:Fx.CSS.Parsers.String};return b})},compute:function(d,c,b){var a=[];(Math.min(d.length,c.length)).times(function(f){a.push({value:d[f].parser.compute(d[f].value,c[f].value,b),parser:d[f].parser})});a.$family=Function.from("fx:css:value");return a},serve:function(c,b){if(typeOf(c)!="fx:css:value"){c=this.parse(c)}var a=[];c.each(function(d){a=a.concat(d.parser.serve(d.value,b))});return a},render:function(a,d,c,b){a.setStyle(d,this.serve(c,b))},search:function(a){if(Fx.CSS.Cache[a]){return Fx.CSS.Cache[a]}var c={},b=new RegExp("^"+a.escapeRegExp()+"$");Array.each(document.styleSheets,function(g,f){var d=g.href;if(d&&d.contains("://")&&!d.contains(document.domain)){return}var h=g.rules||g.cssRules;Array.each(h,function(l,j){if(!l.style){return}var k=(l.selectorText)?l.selectorText.replace(/^\w+/,function(o){return o.toLowerCase()}):null;if(!k||!b.test(k)){return}Object.each(Element.Styles,function(o,m){if(!l.style[m]||Element.ShortStyles[m]){return}o=String(l.style[m]);c[m]=((/^rgb/).test(o))?o.rgbToHex():o})})});return Fx.CSS.Cache[a]=c}});Fx.CSS.Cache={};Fx.CSS.Parsers={Color:{parse:function(a){if(a.match(/^#[0-9a-f]{3,6}$/i)){return a.hexToRgb(true)}return((a=a.match(/(\d+),\s*(\d+),\s*(\d+)/)))?[a[1],a[2],a[3]]:false},compute:function(c,b,a){return c.map(function(f,d){return Math.round(Fx.compute(c[d],b[d],a))})},serve:function(a){return a.map(Number)}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(b,a){return(a)?b+a:b}},String:{parse:Function.from(false),compute:function(b,a){return a},serve:function(a){return a}}};Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(b,a){this.element=this.subject=document.id(b);this.parent(a)},set:function(a){if(typeof a=="string"){a=this.search(a)}for(var b in a){this.render(this.element,b,a[b],this.options.unit)}return this},compute:function(f,d,c){var a={};for(var b in f){a[b]=this.parent(f[b],d[b],c)}return a},start:function(b){if(!this.check(b)){return this}if(typeof b=="string"){b=this.search(b)}var f={},d={};for(var c in b){var a=this.prepare(this.element,c,b[c]);f[c]=a.from;d[c]=a.to}return this.parent(f,d)}});Element.Properties.morph={set:function(a){this.get("morph").cancel().setOptions(a);return this},get:function(){var a=this.retrieve("morph");if(!a){a=new Fx.Morph(this,{link:"cancel"});this.store("morph",a)}return a}};Element.implement({morph:function(a){this.get("morph").start(a);return this}});Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(b,a){this.element=this.subject=document.id(b);this.parent(a)},set:function(b,a){if(arguments.length==1){a=b;b=this.property||this.options.property}this.render(this.element,b,a,this.options.unit);return this},start:function(c,f,d){if(!this.check(c,f,d)){return this}var b=Array.flatten(arguments);this.property=this.options.property||b.shift();var a=this.prepare(this.element,this.property,b);return this.parent(a.from,a.to)}});Element.Properties.tween={set:function(a){this.get("tween").cancel().setOptions(a);return this},get:function(){var a=this.retrieve("tween");if(!a){a=new Fx.Tween(this,{link:"cancel"});this.store("tween",a)}return a}};Element.implement({tween:function(a,c,b){this.get("tween").start(arguments);return this},fade:function(c){var f=this.get("tween"),d="opacity",a;c=[c,"toggle"].pick();switch(c){case"in":f.start(d,1);break;case"out":f.start(d,0);break;case"show":f.set(d,1);break;case"hide":f.set(d,0);break;case"toggle":var b=this.retrieve("fade:flag",this.get("opacity")==1);f.start(d,(b)?0:1);this.store("fade:flag",!b);a=true;break;default:f.start(d,arguments)}if(!a){this.eliminate("fade:flag")}return this},highlight:function(c,a){if(!a){a=this.retrieve("highlight:original",this.getStyle("background-color"));a=(a=="transparent")?"#fff":a}var b=this.get("tween");b.start("background-color",c||"#ffff88",a).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original"));b.callChain()}.bind(this));return this}});(function(){var a=("onprogress" in new Browser.Request);var c=this.Request=new Class({Implements:[Chain,Events,Options],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:true,format:false,method:"post",link:"ignore",isSuccess:null,emulation:true,urlEncoded:true,encoding:"utf-8",evalScripts:false,evalResponse:false,timeout:0,noCache:false},initialize:function(d){this.xhr=new Browser.Request();this.setOptions(d);this.headers=this.options.headers},onStateChange:function(){var d=this.xhr;if(d.readyState!=4||!this.running){return}this.running=false;this.status=0;Function.attempt(function(){var f=d.status;this.status=(f==1223)?204:f}.bind(this));d.onreadystatechange=function(){};clearTimeout(this.timer);this.response={text:this.xhr.responseText||"",xml:this.xhr.responseXML};if(this.options.isSuccess.call(this,this.status)){this.success(this.response.text,this.response.xml)}else{this.failure()}},isSuccess:function(){var d=this.status;return(d>=200&&d<300)},isRunning:function(){return !!this.running},processScripts:function(d){if(this.options.evalResponse||(/(ecma|java)script/).test(this.getHeader("Content-type"))){return Browser.exec(d)}return d.stripScripts(this.options.evalScripts,true)},success:function(f,d){this.onSuccess(this.processScripts(f),d)},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain()},failure:function(){this.onFailure()},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr)},loadstart:function(d){this.fireEvent("loadstart",[d,this.xhr])},progress:function(d){this.fireEvent("progress",[d,this.xhr])},timeout:function(){this.fireEvent("timeout",this.xhr)},setHeader:function(d,f){this.headers[d]=f;return this},getHeader:function(d){return Function.attempt(function(){return this.xhr.getResponseHeader(d)}.bind(this))},check:function(){if(!this.running){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},send:function(q){if(!this.check(q)){return this}this.options.isSuccess=this.options.isSuccess||this.isSuccess;this.running=true;var m=typeOf(q);if(m=="string"||m=="element"){q={data:q}}var h=this.options;q=Object.append({data:h.data,url:h.url,method:h.method},q);var k=q.data,f=String(q.url),d=q.method.toLowerCase();switch(typeOf(k)){case"element":k=document.id(k).toQueryString();break;case"object":case"hash":k=Object.toQueryString(k)}if(this.options.format){var o="format="+this.options.format;k=(k)?o+"&"+k:o}if(this.options.emulation&&!["get","post"].contains(d)){var l="_method="+d;k=(k)?l+"&"+k:l;d="post"}if(this.options.urlEncoded&&["post","put"].contains(d)){var g=(this.options.encoding)?"; charset="+this.options.encoding:"";this.headers["Content-type"]="application/x-www-form-urlencoded"+g}if(!f){f=document.location.pathname}var j=f.lastIndexOf("/");if(j>-1&&(j=f.indexOf("#"))>-1){f=f.substr(0,j)}if(this.options.noCache){f+=(f.contains("?")?"&":"?")+String.uniqueID()}if(k&&d=="get"){f+=(f.contains("?")?"&":"?")+k;k=null}var p=this.xhr;if(a){p.onloadstart=this.loadstart.bind(this);p.onprogress=this.progress.bind(this)}p.open(d.toUpperCase(),f,this.options.async,this.options.user,this.options.password);if(this.options.user&&"withCredentials" in p){p.withCredentials=true}p.onreadystatechange=this.onStateChange.bind(this);Object.each(this.headers,function(s,r){try{p.setRequestHeader(r,s)}catch(t){this.fireEvent("exception",[r,s])}},this);this.fireEvent("request");p.send(k);if(!this.options.async){this.onStateChange()}if(this.options.timeout){this.timer=this.timeout.delay(this.options.timeout,this)}return this},cancel:function(){if(!this.running){return this}this.running=false;var d=this.xhr;d.abort();clearTimeout(this.timer);d.onreadystatechange=d.onprogress=d.onloadstart=function(){};this.xhr=new Browser.Request();this.fireEvent("cancel");return this}});var b={};["get","post","put","delete","GET","POST","PUT","DELETE"].each(function(d){b[d]=function(g){var f={method:d};if(g!=null){f.data=g}return this.send(f)}});c.implement(b);Element.Properties.send={set:function(d){var f=this.get("send").cancel();f.setOptions(d);return this},get:function(){var d=this.retrieve("send");if(!d){d=new c({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")});this.store("send",d)}return d}};Element.implement({send:function(d){var f=this.get("send");f.send({data:this,url:d||f.options.url});return this}})})();Request.HTML=new Class({Extends:Request,options:{update:false,append:false,evalScripts:true,filter:false,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(f){var d=this.options,b=this.response;b.html=f.stripScripts(function(g){b.javascript=g});var c=b.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);if(c){b.html=c[1]}var a=new Element("div").set("html",b.html);b.tree=a.childNodes;b.elements=a.getElements("*");if(d.filter){b.tree=b.elements.filter(d.filter)}if(d.update){document.id(d.update).empty().set("html",b.html)}else{if(d.append){document.id(d.append).adopt(a.getChildren())}}if(d.evalScripts){Browser.exec(b.javascript)}this.onSuccess(b.tree,b.elements,b.html,b.javascript)}});Element.Properties.load={set:function(a){var b=this.get("load").cancel();b.setOptions(a);return this},get:function(){var a=this.retrieve("load");if(!a){a=new Request.HTML({data:this,link:"cancel",update:this,method:"get"});this.store("load",a)}return a}};Element.implement({load:function(){this.get("load").send(Array.link(arguments,{data:Type.isObject,url:Type.isString}));return this}});Request.JSON=new Class({Extends:Request,options:{secure:true},initialize:function(a){this.parent(a);Object.append(this.headers,{Accept:"application/json","X-Request":"JSON"})},success:function(c){var b=this.options.secure;var a=this.response.json=Function.attempt(function(){return JSON.decode(c,b)});if(a==null){this.onFailure()}else{this.onSuccess(a,c)}}});var Cookie=new Class({Implements:Options,options:{path:"/",domain:false,duration:false,secure:false,document:document,encode:true},initialize:function(b,a){this.key=b;this.setOptions(a)},write:function(b){if(this.options.encode){b=encodeURIComponent(b)}if(this.options.domain){b+="; domain="+this.options.domain}if(this.options.path){b+="; path="+this.options.path}if(this.options.duration){var a=new Date();a.setTime(a.getTime()+this.options.duration*24*60*60*1000);b+="; expires="+a.toGMTString()}if(this.options.secure){b+="; secure"}this.options.document.cookie=this.key+"="+b;return this},read:function(){var a=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return(a)?decodeURIComponent(a[1]):null},dispose:function(){new Cookie(this.key,Object.merge({},this.options,{duration:-1})).write("");return this}});Cookie.write=function(b,c,a){return new Cookie(b,a).write(c)};Cookie.read=function(a){return new Cookie(a).read()};Cookie.dispose=function(b,a){return new Cookie(b,a).dispose()};(function(k,m){var o,g,f=[],c,b,p=true;try{p=k.frameElement!=null}catch(j){}var h=function(){clearTimeout(b);if(o){return}Browser.loaded=o=true;m.removeListener("DOMContentLoaded",h).removeListener("readystatechange",a);m.fireEvent("domready");k.fireEvent("domready")};var a=function(){for(var q=f.length;q--;){if(f[q]()){h();return true}}return false};var l=function(){clearTimeout(b);if(!a()){b=setTimeout(l,10)}};m.addListener("DOMContentLoaded",h);var d=m.createElement("div");if(d.doScroll&&!p){f.push(function(){try{d.doScroll();return true}catch(q){}return false});c=true}if(m.readyState){f.push(function(){var q=m.readyState;return(q=="loaded"||q=="complete")})}if("onreadystatechange" in m){m.addListener("readystatechange",a)}else{c=true}if(c){l()}Element.Events.domready={onAdd:function(q){if(o){q.call(this)}}};Element.Events.load={base:"load",onAdd:function(q){if(g&&this==k){q.call(this)}},condition:function(){if(this==k){h();delete Element.Events.load}return true}};k.addEvent("load",function(){g=true})})(window,document);if(typeof JSON=="undefined"){this.JSON={}}Object.append(JSON,{$specialChars:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},$replaceChars:function(a){return JSON.$specialChars[a]||"\\u00"+Math.floor(a.charCodeAt()/16).toString(16)+(a.charCodeAt()%16).toString(16)},encode:function(b){switch(typeOf(b)){case"string":return'"'+b.replace(/[\x00-\x1f\\"]/g,JSON.$replaceChars)+'"';case"array":return"["+String(b.map(JSON.encode).clean())+"]";case"object":case"hash":var a=[];Object.each(b,function(f,d){var c=JSON.encode(f);if(c){a.push(JSON.encode(d)+":"+c)}});return"{"+a+"}";case"number":case"boolean":return String(b);case"null":return"null"}return null},decode:function(string,secure){if(typeOf(string)!="string"||!string.length){return null}if(secure&&!(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(string.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))){return null}return eval("("+string+")")}});Class.Mutators.Binds=function(a){if(!this.prototype.initialize){this.implement("initialize",function(){})}return a};Class.Mutators.initialize=function(a){return function(){Array.from(this.Binds).each(function(b){var c=this[b];if(c){this[b]=c.bind(this)}},this);return a.apply(this,arguments)}};Class.Occlude=new Class({occlude:function(c,b){b=document.id(b||this.element);var a=b.retrieve(c||this.property);if(a&&this.occluded!=null){return this.occluded=a}this.occluded=false;b.store(c||this.property,this);return this.occluded}});Class.refactor=function(b,a){Object.each(a,function(f,d){var c=b.prototype[d];if(c&&c.$origin){c=c.$origin}if(typeof f=="function"){b.implement(d,function(){var g=this.previous;this.previous=c||function(){};var h=f.apply(this,arguments);this.previous=g;return h})}else{b.implement(d,f)}});return b};(function(){var a=function(b){return b!=null};Object.extend({getFromPath:function(f,d){var g=d.split(".");for(var c=0,b=g.length;c<b;c++){if(f.hasOwnProperty(g[c])){f=f[g[c]]}else{return null}}return f},cleanValues:function(b,c){c=c||a;for(key in b){if(!c(b[key])){delete b[key]}}return b},erase:function(b,c){if(b.hasOwnProperty(c)){delete b[c]}return b},run:function(c){var b=Array.slice(arguments,1);for(key in c){if(c[key].apply){c[key].apply(c,b)}}return c}})})();Element.implement({isDisplayed:function(){return this.getStyle("display")!="none"},isVisible:function(){var a=this.offsetWidth,b=this.offsetHeight;return(a==0&&b==0)?false:(a>0&&b>0)?true:this.style.display!="none"},toggle:function(){return this[this.isDisplayed()?"hide":"show"]()},hide:function(){var b;try{b=this.getStyle("display")}catch(a){}if(b=="none"){return this}return this.store("element:_originalDisplay",b||"").setStyle("display","none")},show:function(a){if(!a&&this.isDisplayed()){return this}a=a||this.retrieve("element:_originalDisplay")||"block";return this.setStyle("display",(a=="none")?"block":a)},swapClass:function(a,b){return this.removeClass(a).addClass(b)}});Document.implement({clearSelection:function(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var a=window.getSelection();if(a&&a.removeAllRanges){a.removeAllRanges()}}}}});Fx.Elements=new Class({Extends:Fx.CSS,initialize:function(b,a){this.elements=this.subject=$$(b);this.parent(a)},compute:function(h,j,k){var c={};for(var d in h){var a=h[d],f=j[d],g=c[d]={};for(var b in a){g[b]=this.parent(a[b],f[b],k)}}return c},set:function(b){for(var c in b){if(!this.elements[c]){continue}var a=b[c];for(var d in a){this.render(this.elements[c],d,a[d],this.options.unit)}}return this},start:function(c){if(!this.check(c)){return this}var j={},k={};for(var d in c){if(!this.elements[d]){continue}var g=c[d],a=j[d]={},h=k[d]={};for(var b in g){var f=this.prepare(this.elements[d],b,g[b]);a[b]=f.from;h[b]=f.to}}return this.parent(j,k)}});(function(){var b=null,a={},d={};var c=function(g){if(instanceOf(g,f.Set)){return g}else{return a[g]}};var f=this.Locale={define:function(g,l,j,k){var h;if(instanceOf(g,f.Set)){h=g.name;if(h){a[h]=g}}else{h=g;if(!a[h]){a[h]=new f.Set(h)}g=a[h]}if(l){g.define(l,j,k)}if(!b){b=g}return g},use:function(g){g=c(g);if(g){b=g;this.fireEvent("change",g)}return this},getCurrent:function(){return b},get:function(h,g){return(b)?b.get(h,g):""},inherit:function(g,h,j){g=c(g);if(g){g.inherit(h,j)}return this},list:function(){return Object.keys(a)}};Object.append(f,new Events);f.Set=new Class({sets:{},inherits:{locales:[],sets:{}},initialize:function(g){this.name=g||""},define:function(k,h,j){var g=this.sets[k];if(!g){g={}}if(h){if(typeOf(h)=="object"){g=Object.merge(g,h)}else{g[h]=j}}this.sets[k]=g;return this},get:function(t,k,s){var r=Object.getFromPath(this.sets,t);if(r!=null){var o=typeOf(r);if(o=="function"){r=r.apply(null,Array.from(k))}else{if(o=="object"){r=Object.clone(r)}}return r}var j=t.indexOf("."),q=j<0?t:t.substr(0,j),m=(this.inherits.sets[q]||[]).combine(this.inherits.locales).include("en-US");if(!s){s=[]}for(var h=0,g=m.length;h<g;h++){if(s.contains(m[h])){continue}s.include(m[h]);var p=a[m[h]];if(!p){continue}r=p.get(t,k,s);if(r!=null){return r}}return""},inherit:function(h,j){h=Array.from(h);if(j&&!this.inherits.sets[j]){this.inherits.sets[j]=[]}var g=h.length;while(g--){(j?this.inherits.sets[j]:this.inherits.locales).unshift(h[g])}return this}})})();Locale.define("en-US","Date",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_abbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],days_abbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateOrder:["month","date","year"],shortDate:"%m/%d/%Y",shortTime:"%I:%M%p",AM:"AM",PM:"PM",ordinal:function(a){return(a>3&&a<21)?"th":["th","st","nd","rd","th"][Math.min(a%10,4)]},lessThanMinuteAgo:"less than a minute ago",minuteAgo:"about a minute ago",minutesAgo:"{delta} minutes ago",hourAgo:"about an hour ago",hoursAgo:"about {delta} hours ago",dayAgo:"1 day ago",daysAgo:"{delta} days ago",weekAgo:"1 week ago",weeksAgo:"{delta} weeks ago",monthAgo:"1 month ago",monthsAgo:"{delta} months ago",yearAgo:"1 year ago",yearsAgo:"{delta} years ago",lessThanMinuteUntil:"less than a minute from now",minuteUntil:"about a minute from now",minutesUntil:"{delta} minutes from now",hourUntil:"about an hour from now",hoursUntil:"about {delta} hours from now",dayUntil:"1 day from now",daysUntil:"{delta} days from now",weekUntil:"1 week from now",weeksUntil:"{delta} weeks from now",monthUntil:"1 month from now",monthsUntil:"{delta} months from now",yearUntil:"1 year from now",yearsUntil:"{delta} years from now"});(function(){var a=this.Date;a.Methods={ms:"Milliseconds",year:"FullYear",min:"Minutes",mo:"Month",sec:"Seconds",hr:"Hours"};["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds","Time","TimezoneOffset","Week","Timezone","GMTOffset","DayOfYear","LastMonth","LastDayOfMonth","UTCDate","UTCDay","UTCFullYear","AMPM","Ordinal","UTCHours","UTCMilliseconds","UTCMinutes","UTCMonth","UTCSeconds","UTCMilliseconds"].each(function(v){a.Methods[v.toLowerCase()]=v});var r=function(y,w,v){if(!v){v="0"}return new Array(w-String(y).length+1).join(v)+y};a.implement({set:function(y,w){y=y.toLowerCase();var v=a.Methods;if(v[y]){this["set"+v[y]](w)}return this}.overloadSetter(),get:function(w){w=w.toLowerCase();var v=a.Methods;if(v[w]){return this["get"+v[w]]()}return null},clone:function(){return new a(this.get("time"))},increment:function(v,y){v=v||"day";y=y!=null?y:1;switch(v){case"year":return this.increment("month",y*12);case"month":var w=this.get("date");this.set("date",1).set("mo",this.get("mo")+y);return this.set("date",w.min(this.get("lastdayofmonth")));case"week":return this.increment("day",y*7);case"day":return this.set("date",this.get("date")+y)}if(!a.units[v]){throw new Error(v+" is not a supported interval")}return this.set("time",this.get("time")+y*a.units[v]())},decrement:function(v,w){return this.increment(v,-1*(w!=null?w:1))},isLeapYear:function(){return a.isLeapYear(this.get("year"))},clearTime:function(){return this.set({hr:0,min:0,sec:0,ms:0})},diff:function(w,v){if(typeOf(w)=="string"){w=a.parse(w)}return((w-this)/a.units[v||"day"](3,3)).round()},getLastDayOfMonth:function(){return a.daysInMonth(this.get("mo"),this.get("year"))},getDayOfYear:function(){return(a.UTC(this.get("year"),this.get("mo"),this.get("date")+1)-a.UTC(this.get("year"),0,1))/a.units.day()},getWeek:function(){return(this.get("dayofyear")/7).ceil()},getOrdinal:function(v){return a.getMsg("ordinal",v||this.get("date"))},getTimezone:function(){return this.toString().replace(/^.*? ([A-Z]{3}).[0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},getGMTOffset:function(){var v=this.get("timezoneOffset");return((v>0)?"-":"+")+r((v.abs()/60).floor(),2)+r(v%60,2)},setAMPM:function(v){v=v.toUpperCase();var w=this.get("hr");if(w>11&&v=="AM"){return this.decrement("hour",12)}else{if(w<12&&v=="PM"){return this.increment("hour",12)}}return this},getAMPM:function(){return(this.get("hr")<12)?"AM":"PM"},parse:function(v){this.set("time",a.parse(v));return this},isValid:function(v){return !isNaN((v||this).valueOf())},format:function(w){if(!this.isValid()){return"invalid date"}if(!w){w="%x %X"}var v=w.toLowerCase();if(u[v]){return u[v](this)}w=g[v]||w;var y=this;return w.replace(/%([a-z%])/gi,function(A,z){switch(z){case"a":return a.getMsg("days_abbr")[y.get("day")];case"A":return a.getMsg("days")[y.get("day")];case"b":return a.getMsg("months_abbr")[y.get("month")];case"B":return a.getMsg("months")[y.get("month")];case"c":return y.format("%a %b %d %H:%M:%S %Y");case"d":return r(y.get("date"),2);case"e":return r(y.get("date"),2," ");case"H":return r(y.get("hr"),2);case"I":return r((y.get("hr")%12)||12,2);case"j":return r(y.get("dayofyear"),3);case"k":return r(y.get("hr"),2," ");case"l":return r((y.get("hr")%12)||12,2," ");case"L":return r(y.get("ms"),3);case"m":return r((y.get("mo")+1),2);case"M":return r(y.get("min"),2);case"o":return y.get("ordinal");case"p":return a.getMsg(y.get("ampm"));case"s":return Math.round(y/1000);case"S":return r(y.get("seconds"),2);case"U":return r(y.get("week"),2);case"w":return y.get("day");case"x":return y.format(a.getMsg("shortDate"));case"X":return y.format(a.getMsg("shortTime"));case"y":return y.get("year").toString().substr(2);case"Y":return y.get("year");case"T":return y.format("%H:%M:%S");case"z":return y.get("GMTOffset");case"Z":return y.get("Timezone")}return z})},toISOString:function(){return this.format("iso8601")}});a.alias("toJSON","toISOString");a.alias("compare","diff");a.alias("strftime","format");var g={db:"%Y-%m-%d %H:%M:%S",compact:"%Y%m%dT%H%M%S",iso8601:"%Y-%m-%dT%H:%M:%S%z","short":"%d %b %H:%M","long":"%B %d, %Y %H:%M"};var l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var u={rfc822:function(v){return l[v.get("day")]+v.format(", %d ")+h[v.get("month")]+v.format(" %Y %H:%M:%S %Z")},rfc2822:function(v){return l[v.get("day")]+v.format(", %d ")+h[v.get("month")]+v.format(" %Y %H:%M:%S %z")}};var c=[];var p=a.parse;var t=function(z,B,y){var w=-1;var A=a.getMsg(z+"s");switch(typeOf(B)){case"object":w=A[B.get(z)];break;case"number":w=A[B];if(!w){throw new Error("Invalid "+z+" index: "+B)}break;case"string":var v=A.filter(function(C){return this.test(C)},new RegExp("^"+B,"i"));if(!v.length){throw new Error("Invalid "+z+" string")}if(v.length>1){throw new Error("Ambiguous "+z)}w=v[0]}return(y)?A.indexOf(w):w};a.extend({getMsg:function(w,v){return Locale.get("Date."+w,v)},units:{ms:Function.from(1),second:Function.from(1000),minute:Function.from(60000),hour:Function.from(3600000),day:Function.from(86400000),week:Function.from(608400000),month:function(w,v){var y=new a;return a.daysInMonth(w!=null?w:y.get("mo"),v!=null?v:y.get("year"))*86400000},year:function(v){v=v||new a().get("year");return a.isLeapYear(v)?31622400000:31536000000}},daysInMonth:function(w,v){return[31,a.isLeapYear(v)?29:28,31,30,31,30,31,31,30,31,30,31][w]},isLeapYear:function(v){return((v%4===0)&&(v%100!==0))||(v%400===0)},parse:function(y){var w=typeOf(y);if(w=="number"){return new a(y)}if(w!="string"){return y}y=y.clean();if(!y.length){return null}var v;c.some(function(A){var z=A.re.exec(y);return(z)?(v=A.handler(z)):false});if(!(v&&v.isValid())){v=new a(p(y));if(!(v&&v.isValid())){v=new a(y.toInt())}}return v},parseDay:function(v,w){return t("day",v,w)},parseMonth:function(w,v){return t("month",w,v)},parseUTC:function(w){var v=new a(w);var y=a.UTC(v.get("year"),v.get("mo"),v.get("date"),v.get("hr"),v.get("min"),v.get("sec"),v.get("ms"));return new a(y)},orderIndex:function(v){return a.getMsg("dateOrder").indexOf(v)+1},defineFormat:function(v,w){g[v]=w},defineFormats:function(v){for(var w in v){a.defineFormat(w,v[w])}},defineParser:function(v){c.push((v.re&&v.handler)?v:m(v))},defineParsers:function(){Array.flatten(arguments).each(a.defineParser)},define2DigitYearStart:function(v){q=v%100;j=v-q}});var j=1900;var q=70;var d=function(v){return new RegExp("(?:"+a.getMsg(v).map(function(w){return w.substr(0,3)}).join("|")+")[a-z]*")};var o=function(v){switch(v){case"T":return"%H:%M:%S";case"x":return((a.orderIndex("month")==1)?"%m[-./]%d":"%d[-./]%m")+"([-./]%y)?";case"X":return"%H([.:]%M)?([.:]%S([.:]%s)?)? ?%p? ?%z?"}return null};var k={d:/[0-2]?[0-9]|3[01]/,H:/[01]?[0-9]|2[0-3]/,I:/0?[1-9]|1[0-2]/,M:/[0-5]?\d/,s:/\d+/,o:/[a-z]*/,p:/[ap]\.?m\.?/,y:/\d{2}|\d{4}/,Y:/\d{4}/,z:/Z|[+-]\d{2}(?::?\d{2})?/};k.m=k.I;k.S=k.M;var f;var b=function(v){f=v;k.a=k.A=d("days");k.b=k.B=d("months");c.each(function(y,w){if(y.format){c[w]=m(y.format)}})};var m=function(y){if(!f){return{format:y}}var v=[];var w=(y.source||y).replace(/%([a-z])/gi,function(A,z){return o(z)||A}).replace(/\((?!\?)/g,"(?:").replace(/ (?!\?|\*)/g,",? ").replace(/%([a-z%])/gi,function(A,z){var B=k[z];if(!B){return z}v.push(z);return"("+B.source+")"}).replace(/\[a-z\]/gi,"[a-z\\u00c0-\\uffff;&]");return{format:y,re:new RegExp("^"+w+"$","i"),handler:function(C){C=C.slice(1).associate(v);var z=new a().clearTime(),B=C.y||C.Y;if(B!=null){s.call(z,"y",B)}if("d" in C){s.call(z,"d",1)}if("m" in C||C.b||C.B){s.call(z,"m",1)}for(var A in C){s.call(z,A,C[A])}return z}}};var s=function(v,w){if(!w){return this}switch(v){case"a":case"A":return this.set("day",a.parseDay(w,true));case"b":case"B":return this.set("mo",a.parseMonth(w,true));case"d":return this.set("date",w);case"H":case"I":return this.set("hr",w);case"m":return this.set("mo",w-1);case"M":return this.set("min",w);case"p":return this.set("ampm",w.replace(/\./g,""));case"S":return this.set("sec",w);case"s":return this.set("ms",("0."+w)*1000);case"w":return this.set("day",w);case"Y":return this.set("year",w);case"y":w=+w;if(w<100){w+=j+(w<q?100:0)}return this.set("year",w);case"z":if(w=="Z"){w="+00"}var y=w.match(/([+-])(\d{2}):?(\d{2})?/);y=(y[1]+"1")*(y[2]*60+(+y[3]||0))+this.getTimezoneOffset();return this.set("time",this-y*60000)}return this};a.defineParsers("%Y([-./]%m([-./]%d((T| )%X)?)?)?","%Y%m%d(T%H(%M%S?)?)?","%x( %X)?","%d%o( %b( %Y)?)?( %X)?","%b( %d%o)?( %Y)?( %X)?","%Y %b( %d%o( %X)?)?","%o %b %d %X %z %Y","%T","%H:%M( ?%p)?");Locale.addEvent("change",function(v){if(Locale.get("Date")){b(v)}}).fireEvent("change",Locale.getCurrent())})();(function(){var a=function(b,c){b=b||"";var d=c?"<"+b+"(?!\\w)[^>]*>([\\s\\S]*?)</"+b+"(?!\\w)>":"</?"+b+"([^>]+)?>";reg=new RegExp(d,"gi");return reg};String.implement({getTags:function(b,c){return this.match(a(b,c))||[]},stripTags:function(b,c){return this.replace(a(b,c),"")}})})();var Asset={javascript:function(g,c){if(!c){c={}}var a=new Element("script",{src:g,type:"text/javascript"}),h=c.document||document,b=0,d=c.onload||c.onLoad;var f=d?function(){if(++b==1){d.call(this)}}:function(){};delete c.onload;delete c.onLoad;delete c.document;return a.addEvents({load:f,readystatechange:function(){if(["loaded","complete"].contains(this.readyState)){f.call(this)}}}).set(c).inject(h.head)},css:function(d,a){if(!a){a={}}var b=new Element("link",{rel:"stylesheet",media:"screen",type:"text/css",href:d});var c=a.onload||a.onLoad,f=a.document||document;delete a.onload;delete a.onLoad;delete a.document;if(c){b.addEvent("load",c)}return b.set(a).inject(f.head)},image:function(c,b){b=Object.merge({onload:function(){},onabort:function(){},onerror:function(){}},b);var d=new Image();var a=document.id(d)||new Element("img");["load","abort","error"].each(function(f){var h="on"+f;var g=f.capitalize();if(b["on"+g]){b[h]=b["on"+g];delete b["on"+g]}var j=b[h];delete b[h];d[h]=function(){if(!d){return}if(!a.parentNode){a.width=d.width;a.height=d.height}d=d.onload=d.onabort=d.onerror=null;j.delay(1,a,a);a.fireEvent(f,a,1)}});d.src=a.src=c;if(d&&d.complete){d.onload.delay(1)}return a.set(b)},images:function(c,b){b=Object.merge({onComplete:function(){},onProgress:function(){},onError:function(){},properties:{}},b);c=Array.from(c);var a=0;return new Elements(c.map(function(f,d){return Asset.image(f,Object.append(b.properties,{onload:function(){a++;b.onProgress.call(this,a,d,f);if(a==c.length){b.onComplete()}},onerror:function(){a++;b.onError.call(this,a,d,f);if(a==c.length){b.onComplete()}}}))}))}};var IframeShim=new Class({Implements:[Options,Events,Class.Occlude],options:{className:"iframeShim",src:'javascript:false;document.write("");',display:false,zIndex:null,margin:0,offset:{x:0,y:0},browsers:(Browser.ie6||(Browser.firefox&&Browser.version<3&&Browser.Platform.mac))},property:"IframeShim",initialize:function(b,a){this.element=document.id(b);if(this.occlude()){return this.occluded}this.setOptions(a);this.makeShim();return this},makeShim:function(){if(this.options.browsers){var c=this.element.getStyle("zIndex").toInt();if(!c){c=1;var b=this.element.getStyle("position");if(b=="static"||!b){this.element.setStyle("position","relative")}this.element.setStyle("zIndex",c)}c=((this.options.zIndex!=null||this.options.zIndex===0)&&c>this.options.zIndex)?this.options.zIndex:c-1;if(c<0){c=1}this.shim=new Element("iframe",{src:this.options.src,scrolling:"no",frameborder:0,styles:{zIndex:c,position:"absolute",border:"none",filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"},"class":this.options.className}).store("IframeShim",this);var a=(function(){this.shim.inject(this.element,"after");this[this.options.display?"show":"hide"]();this.fireEvent("inject")}).bind(this);if(!IframeShim.ready){window.addEvent("load",a)}else{a()}}else{this.position=this.hide=this.show=this.dispose=Function.from(this)}},position:function(){if(!IframeShim.ready||!this.shim){return this}var a=this.element.measure(function(){return this.getSize()});if(this.options.margin!=undefined){a.x=a.x-(this.options.margin*2);a.y=a.y-(this.options.margin*2);this.options.offset.x+=this.options.margin;this.options.offset.y+=this.options.margin}this.shim.set({width:a.x,height:a.y}).position({relativeTo:this.element,offset:this.options.offset});return this},hide:function(){if(this.shim){this.shim.setStyle("display","none")}return this},show:function(){if(this.shim){this.shim.setStyle("display","block")}return this.position()},dispose:function(){if(this.shim){this.shim.dispose()}return this},destroy:function(){if(this.shim){this.shim.destroy()}return this}});window.addEvent("load",function(){IframeShim.ready=true});Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(a){if(this.options.log&&window.console&&console.log){console.log("JSONP retrieving script with url:"+a)}},onError:function(a){if(this.options.log&&window.console&&console.warn){console.warn("JSONP "+a+" will fail in Internet Explorer, which enforces a 2083 bytes length limit on URIs")}},url:"",callbackKey:"callback",injectScript:document.head,data:"",link:"ignore",timeout:0,log:false},initialize:function(a){this.setOptions(a)},send:function(c){if(!Request.prototype.check.call(this,c)){return this}this.running=true;var d=typeOf(c);if(d=="string"||d=="element"){c={data:c}}c=Object.merge(this.options,c||{});var f=c.data;switch(typeOf(f)){case"element":f=document.id(f).toQueryString();break;case"object":case"hash":f=Object.toQueryString(f)}var b=this.index=Request.JSONP.counter++;var g=c.url+(c.url.test("\\?")?"&":"?")+(c.callbackKey)+"=Request.JSONP.request_map.request_"+b+(f?"&"+f:"");if(g.length>2083){this.fireEvent("error",g)}Request.JSONP.request_map["request_"+b]=function(){this.success(arguments,b)}.bind(this);var a=this.getScript(g).inject(c.injectScript);this.fireEvent("request",[a.get("src"),a]);if(c.timeout){this.timeout.delay(c.timeout,this)}return this},getScript:function(a){if(!this.script){this.script=new Element("script[type=text/javascript]",{async:true,src:a})}return this.script},success:function(b,a){if(!this.running){return false}this.clear().fireEvent("complete",b).fireEvent("success",b).callChain()},cancel:function(){if(this.running){this.clear().fireEvent("cancel")}return this},isRunning:function(){return !!this.running},clear:function(){this.running=false;if(this.script){this.script.destroy();this.script=null}return this},timeout:function(){if(this.running){this.running=false;this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel()}return this}});Request.JSONP.counter=0;Request.JSONP.request_map={};
/*
Copyright (c) 2009 Arieh Glazer

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE
*/
(function(a){function b(){}a.instantiate=function(d,h){b.prototype=d.prototype;var g=new b(),c=d.apply(g,h);return c||g};a.implement({instantiate:function(c){return a.instantiate(this,c)}})})(Function);IdleTimer=new Class({Implements:[Events,Options],options:{timeout:60000,events:["mousemove","keydown","mousewheel","mousedown"]},initialize:function(b,a){this.setOptions(a);this.element=$(b);this.activeBound=this.active.bind(this);this.isIdle=false;this.started=false},stop:function(){clearTimeout(this.timer);for(var a in this.options.events){this.element.removeEvent(this.options.events[a],this.activeBound)}this.bound=false;this.started=false;this.fireEvent("stop");return this},active:function(){clearTimeout(this.timer);if(this.isIdle){this.fireEvent("active")}this.isIdle=false;this.start()},idle:function(){if(this.timer){clearTimeout(this.timer)}this.isIdle=true;this.fireEvent("idle")},start:function(){this.timer=this.idle.delay(this.options.timeout,this);this.lastActive=new Date().getTime();if(!this.bound){this.bind()}this.started=true;return this},bind:function(){for(var a in this.options.events){this.element.addEvent(this.options.events[a],this.activeBound)}this.bound=true;this.fireEvent("start")},getIdleTime:function(a){return a?Math.round((Date.now()-this.lastActive)/1000):Date.now()-this.lastActive},setTimeout:function(c,d){var b=this.options.timeout;this.options.timeout=c;if(d){return this}clearTimeout(this.timer);this.fireEvent("timeoutChanged",c);var a=this.getIdleTime();if(a<c&&this.isIdle){this.fireEvent("active");this.isIdle=false}else{if(a>=c){this.idle();return this}}this.timer=this.idle.delay(c-a,this);return this}});Element.Properties.idle={set:function(a){var b=this.retrieve("idle");if(b){b.stop()}return this.eliminate("idle").store("idle:options",a)},get:function(a){if(a||!this.retrieve("idle")){if(a||!this.retrieve("idle:options")){this.set("idle",a)}this.store("idle",new IdleTimer(this,this.retrieve("idle:options")))}return this.retrieve("idle")}};Element.Events.idle={onAdd:function(a){var b=this.get?false:true;var c=b?window.idleTimer:this.get("idle");if(b&&!c){c=window.idleTimer=new IdleTimer(this)}if(!c.started){c.start()}c.addEvent("idle",a)}};Element.Events.active={onAdd:function(a){(this.get?this.get("idle"):window.idleTimer).addEvent("active",a)}};Array.implement({getRandomIndex:function(){return Number.random(0,this.length-1)},copy:function(){return this.splice(0,this.length)},toQueryString:function(){var a=this.map(function(c,b){switch(typeOf(c)){case"element":return ta.id(c).toQueryString();break;case"object":return Object.toQueryString(c)}});return a.join("&")}});Cookie=Class.refactor(Cookie,{write:function(b){if(this.options.encode){b=encodeURIComponent(b)}if(this.options.domain){b+="; domain="+this.options.domain}if(this.options.path){b+="; path="+this.options.path}if(this.options.duration){var a=new Date();a.setTime(a.getTime()+this.options.duration*24*60*60*1000);b+="; expires="+a.toGMTString()}if(this.options.time){var a=new Date();a.setTime(a.getTime()+this.options.time*1000);b+="; expires="+a.toGMTString()}if(this.options.expires){var a=new Date(this.options.expires);b+="; expires="+a.toGMTString()}if(this.options.secure){b+="; secure"}this.options.document.cookie=this.key+"="+b;return this},readRaw:function(a){var b=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return b?b[1]:false}});Cookie.exist=function(a){return document.cookie.match("(?:^|;)\\s*"+a.escapeRegExp()+"=([^;]*)")!=null};Cookie.readSession=function(c,a){if(a==null){a={}}var b=new Cookie("TASession",{encode:false}).readRaw();var d=a.pattern?a.pattern:"[^\\*]+";var f=new RegExp("(\\*|^)"+c+"\\.("+d+")");if(f.test(b)){return{cookie:b,pattern:f,start:RegExp.$1,value:RegExp.$2}}return{cookie:b,pattern:f}};Cookie.writeSession=function(d,f,c){var a=this.readSession(d,c);if(!a.cookie){return false}var b;if(a.value){b=a.cookie.replace(a.pattern,a.start+d+"."+f)}else{b=a.cookie+"*"+d+"."+f}new Cookie("TASession",{domain:cookieDomain,encode:false}).write(b);return true};Cookie.readRaw=function(a){return new Cookie(a).readRaw()};Element.implement({getParentBySelector:function(a){try{if(!a){return $(this.parentNode)}return this.getParents(a)[0]||null}catch(b){ta.util.error.record(b,"Element.extend - getParentBySelector",null,{selector:a})}},findParentByClass:function(b){if(!this.parentNode){return null}var a=$(this.parentNode);if(a==document){return null}if(a.hasClass(b)){return a}return a.findParentByClass(b)},getLastElement:function(a){return $(this.getElements(a,true).reverse()[0]||false)},centerOnScreen:function(){var a=this.getCoordinates();this.style.left=Math.round((Window.getWidth()-a.width)/2)+Window.getScrollLeft()+"px";this.style.top=Math.round((Window.getHeight()-a.height)/2)+Window.getScrollTop()+"px"},positionOnScreen:function(b,a){this.style.left=Window.getScrollLeft()+b+"px";this.style.top=Window.getScrollTop()+a+"px"},containsEvent:function(b){if(!b||!b.page){return false}b=new Event(b);var a=this.getCoordinates();return(b.page.y>=a.top&&b.page.y<=a.bottom&&b.page.x>=a.left&&b.page.x<=a.right)},overlaps:function(b){var h=this.getCoordinates();var g=b.getCoordinates();var a=(g.left>h.left&&g.left<h.right)||(g.right>h.left&&g.right<h.right);var f=g.top>h.top&&g.top<h.bottom;var d=g.bottom>h.top&&g.bottom<h.bottom;return(f&&a)||(d&&a)},linkify:function(){var b=new Element("a",{"class":this.className,href:"javascript:;"}).set("html",this.innerHTML).replaces(this);_processLink(b);return b},setContent:function(a){if(a instanceof Array||typeOf(a)=="elements"){a.each(function(b){this.adopt($(b))},this)}else{if(typeOf(a)=="string"){this.set("html",a)}else{this.adopt($(a))}}return this},isHidden:function(){return this.getStyle("display")=="none"},inDocument:function(){return this.parentNode!=null&&this.parentNode.nodeType!=11},removePropertyEvent:function(d,b){if(d.substr(0,2)!=="on"){d="on"+d}var j="ta.call(",h=this.getProperty(d),a=h&&h.indexOf(b),g=h&&h.indexOf(")",a),f;if(!h||a<0){return}if(h.charAt(g+1)==";"){g++}if(h.charAt(a+b.length)=="("){f=h.slice(0,a)+h.slice(g+1)}else{if(a>=j.length+1&&h.substr(a-j.length-1,j.length)==j){a-=j.length+1;f=h.slice(0,a)+h.slice(g+1)}}this.setProperty(d,f&&f.trim())}});Function.implement({invokeLater:function(b,c,a){return setTimeout(this.pass(a,c),b)},executeContinuations:function(b,d){var c=Array.prototype.slice.apply(arguments);if(c.length>2){d=c[2]}if(b.length>0){var a=b[0];var f=Function.executeContinuations.partial(b.slice(1),null,d);a(f,d)}else{}},inContinuationPassingForm:function(a){return function(c,b){if(a()){if(c){c()}}else{if(b){b()}}}}});Function.implement({_:{},partial:function(){var d=this;var b=Function._;var a=Array.prototype.slice.call(arguments);var g=[],f;for(var c=0;c<arguments.length;c++){arguments[c]==b&&g.push(c)}return function(){var j=a.concat(Array.prototype.slice.call(arguments,g.length));for(var h=0;h<Math.min(g.length,arguments.length);h++){j[g[h]]=arguments[h]}for(var h=0;h<j.length;h++){if(j[h]==b){return d.partial.apply(d,j)}}return d.apply(this,j)}}});Request=Class.refactor(Request,{initialize:function(b){if(b.url){var a=String(b.url);if(!/^http/.test(a)){b.url=window.location.protocol+"//"+window.location.host+a}else{if(/^(\w+):\/\/([\w.\-]+)\/(.*)/.test(a)&&RegExp.$2!=window.location.host){b.url=RegExp.$1+"://"+window.location.host+"/"+RegExp.$3}}}if(b&&b.data&&b.data.constructor&&(b.data instanceof Array)){b.data=b.data.toQueryString()}try{if(b.trackEvent&&ta&&ta.analytics){var d=ta.analytics._toEvtParams(b.trackEvent);if(b.data){if(typeof b.data=="string"){b.data=b.data+"&"+Object.toQueryString(d)}else{if(typeof b.data=="object"){b.data=Object.merge(b.data,d)}}}else{b.data=d}}}catch(c){if(ta&&ta.util&&ta.util.error&&ta.util.error.record){ta.util.error.record(c,"Request.Absolute.initialize.trackEvent")}}return this.previous(b)},processScripts:function(c){if(this.options.keepScripts){return c}var a=c;try{a=this.previous(c)}catch(b){ta.util.error.record(b,"Request.processScripts",null,{"request url":this.options.url})}return a},send:function(a){var c=this.previous(a);if(ta&&ta.util&&ta.util.cookie){ta.util.cookie.removePIDCookie()}try{if(this.options&&this.options.trackEvent&&ta&&ta.analytics){ta.analytics._trackEventAfterAjax(this.options.trackEvent)}}catch(b){if(ta&&ta.util&&ta.util.error&&ta.util.error.record){ta.util.error.record(b,"Request.Absolute.send.trackEventAfterAjax")}}return c}});(function(){var A=this;var v=A._;var d={};var p=Array.prototype,G=Object.prototype,I=Function.prototype;var o=p.push,y=p.slice,C=p.unshift,B=G.toString,t=G.hasOwnProperty;var s=p.forEach,m=p.map,E=p.reduce,h=p.reduceRight,r=p.filter,b=p.every,D=p.some,z=p.indexOf,j=p.lastIndexOf,f=Array.isArray,F=Object.keys,q=I.bind;var H=function(K){return new l(K)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=H}exports._=H}else{A._=H}H.VERSION="1.3.3";var g=H.each=H.forEach=function(P,O,N){if(P==null){return}if(s&&P.forEach===s){P.forEach(O,N)}else{if(P.length===+P.length){for(var M=0,K=P.length;M<K;M++){if(O.call(N,P[M],M,P)===d){return}}}else{for(var L in P){if(H.has(P,L)){if(O.call(N,P[L],L,P)===d){return}}}}}};H.defaults=function(K){g(y.call(arguments,1),function(L){for(var M in L){if(K[M]==null){K[M]=L[M]}}});return K};H.escape=function(K){return(""+K).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};H.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var w=/.^/;var a={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var J in a){a[a[J]]=J}var c=/\\|'|\r|\n|\t|\u2028|\u2029/g;var k=/\\(\\|'|r|n|t|u2028|u2029)/g;var u=function(K){return K.replace(k,function(L,M){return a[M]})};H.template=function(P,O,M){M=H.defaults(M||{},H.templateSettings);var N="__p+='"+P.replace(c,function(Q){return"\\"+a[Q]}).replace(M.escape||w,function(Q,R){return"'+\n((__t=("+u(R)+"))==null?'':_.escape(__t))+\n'"}).replace(M.interpolate||w,function(Q,R){return"'+\n((__t=("+u(R)+"))==null?'':__t)+\n'"}).replace(M.evaluate||w,function(Q,R){return"';\n"+u(R)+"\n__p+='"})+"';\n";if(!M.variable){N="with(obj||{}){\n"+N+"}\n"}N="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'')};\n"+N+"return __p;\n";var L=new Function(M.variable||"obj","_",N);if(O){return L(O,H)}var K=function(Q){return L.call(this,Q,H)};K.source="function("+(M.variable||"obj")+"){\n"+N+"}";return K};var l=function(K){this._wrapped=K}}).call(this);if(window.IS_DEBUG==null){var IS_DEBUG=false}if(window.VERSION_MAP==null){var VERSION_MAP={}}if(window.CDNHOST==null){var CDNHOST=""}ta={overlays:{},maps:{},bmaps:{},common:{},phac:{},servlet:{},support:{},util:{},widgets:{},commerce:{},mobfull:{},photos:{},media:{},hac:{filters:{}},t4b:{},api:{maps:{}},p13n:{}};ta.id=function(a){try{return document.id(a)}catch(b){if(ta.util.error){ta.util.error.record(b,"ta.id - trouble wrapping",null,{elmtArg:ta.util.error.describe(a)})}}};ta.select=function(){if(arguments.length>1){var b=arguments[0];var a=arguments[1]}else{var b=document;var a=arguments[0]}return Slick.search(b,a,new Elements)};ta.invoke=function(a,b){a.each(function(c){c[b]()})};ta.selectInvoke=function(a,b){ta.invoke($$(a),b)};(function(a){var b={};a.store=function(c,d){b[c]=d;return d};a.retrieve=function(c){return b[c]};a.has=function(c){return typeof(b[c])!="undefined"};a.remove=function(c){var d=b[c];delete b[c];return d};a.keep=function(f,g){var d=[];var c=a.retrieve(f);if(c){if(c instanceof Array){d=c}else{d.push(c)}}if(g instanceof Array){d=d.combine(g)}else{d.push(g)}a.store(f,d)};a.merge=function(c,f){var d=a.retrieve(c)||{};a.store(c,Object.merge(d,f))};a.asInt=function(d,c){var f=parseInt(a.retrieve(d));return isNaN(f)?(c||0):f};a.asFloat=function(d,c){var g=parseFloat(a.retrieve(d));return isNaN(g)?(c||0):g}})(ta);ta.load=function(b,g){var f=false;var c=ta.findFileKey(b);if(c){f=VERSION_MAP[c]}if(f){var a=c+"_callback";if(ta.has(a)){var d=ta.retrieve(a);d.push(g);ta.store(a,d)}else{ta.store(a,[function(){delete VERSION_MAP[c];if(g){g()}}]);Asset.javascript(f,{onLoad:function(){var h=ta.remove(a);h.each(function(j){j()})}})}}return f};ta.findFileKey=function(g){if(typeof g!="string"||!VERSION_MAP){return}var d=false;var c=false;if(VERSION_MAP[g]){c=g}else{if(VERSION_MAP[g+".js"]){c=g+".js"}else{var a=g.split(".");var b=0;while(a&&a.length>1&&b<10){a=a.slice(0,-1);var f=a.join("-")+".js";if(f&&VERSION_MAP[f]){c=f;break}b++}}}return c};ta.findFile=function(c){var a=ta.findFileKey(c);var b=false;if(a){b=VERSION_MAP[a];delete VERSION_MAP[a]}return b};(function(ta){ta.call=function(funcName,evnt,elmt){if(evnt==null){if(IS_DEBUG){alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);")}return false}if(!/^ta\.[\w\d\.]+$/.test(funcName)){if(IS_DEBUG){alert("Invalid function name. Must be of the form: ta.namespace.Class.function")}return false}var e=new Event(evnt||window.event);if(!elmt){elmt=e.target}elmt=ta.id(elmt);if(!elmt){ta.util.error.record(null,"ta.call re-wrap fail (non-DOM element) - "+funcName,evnt,{elmtArg:ta.util.error.describe(orgElem||{none:"none"}),funcName:funcName});elmt=orgElem}else{if(!elmt.$family){ta.util.error.record(null,"ta.call re-wrap fail - "+funcName,evnt,{elmtArg:ta.util.error.describe(elmt),funcName:funcName})}}var argSet=arguments;var args=Array.from(argSet).slice(3);args.splice(0,0,e,elmt);try{args.unshift({callback:_ta_call_defer,evt:e});args.unshift(funcName);return ta.run.apply(null,args)}catch(_ex){ta.util.error.record(_ex,"ta.call - "+funcName,evnt)}return false};var _ta_call_defer=function(func,options){if(options){delete (options.evt)}ta.run.apply(null,arguments)};ta.run=function(func,options){var argSet=arguments,args=Array.from(argSet).slice(2);try{var fn=ta.fn(func);if(fn&&typeOf(fn)==="function"){var retVal=fn.apply(window,Array.from(args));if(options&&options.onComplete){var completeFun=ta.fn(options.onComplete);if(completeFun){completeFun(retVal)}}return retVal}else{if(options&&options.evt){new Event(options.evt).preventDefault()}}var callback=options&&options.callback;ta.load(func,(callback||ta.run).pass(arguments))}catch(_ex){ta.util.error.record(_ex,"ta.run - "+func)}return false};var EVENT_PASSED=function(args){this.args=args};ta.on=function(name,f){var v=ta.retrieve(name);if(v instanceof EVENT_PASSED){setTimeout(function(){f.attempt(v.args)},0)}else{ta.keep(name,f)}};ta.fireNonRecurringEvent=function(name){var listeners=ta.retrieve(name);var args=Array.from(arguments);args.shift();ta.store(name,new EVENT_PASSED(args));if(listeners instanceof Array){listeners.each(function(x){x.attempt(args)})}};ta.fireEvent=function(){var args=Array.from(arguments);var event=args.shift();var listeners=ta.retrieve(event);if(listeners){listeners.each(function(callback){callback.attempt(args)})}};ta.fireEventAndUnregister=function(){var args=Array.from(arguments),event=args.shift(),listeners=ta.remove(event);listeners&&listeners.each(function(callback){callback.attempt(args)})};var OneTimeFunctionQueue=function(evtName){var _queue=[];var _runNow=false;var _execFn=function(fn,name){try{fn()}catch(_ex){try{ta.util.error.record(_ex,"OneTimeFunctionQueue "+evtName+(name?"-"+name:""))}catch(ignore){}}};var _runQueuedFunctions=function(){_queue.sort(function(a,b){return a.priority-b.priority});for(var i=0;i<_queue.length;++i){_execFn(_queue[i].func,_queue[i].name)}_queue=[]};if(evtName!=null){window.addEvent(evtName,function(){_runNow=true;_runQueuedFunctions()})}this.addToQueue=function(fn,priority,name){if(!fn){ta.util.error.record(null,"addToQueue for "+evtName+" queue - no function");return}if(typeof priority==="string"){name=priority;priority=false}if(_runNow){_execFn(fn,name)}else{priority=priority||(100+_queue.length);_queue.push({func:fn,priority:priority,name:name})}};this.executeQueue=function(){_runQueuedFunctions()}};var _readyQ=new OneTimeFunctionQueue("domready");var _loadQ=new OneTimeFunctionQueue("load");var _lazyImgQ=new OneTimeFunctionQueue(null);ta.queueForReady=function(fn,priority,name){_readyQ.addToQueue(fn,priority,name)};ta.queueForLoad=function(fn,priority,name){_loadQ.addToQueue(fn,priority,name)};ta.queueLazyImg=function(element){var priority;try{priority=element.priority||1000}catch(ignore){return}var _fn=function(){try{if(element.oSRC!=""){element.src=element.oSRC;element.oSRC="";element.priority=""}}catch(e){ta.util.error.record(e,"lazy img",null,{src:element.src,oSRC:element.oSRC})}};_lazyImgQ.addToQueue(_fn,priority)};ta.processLazyImages=function(){_lazyImgQ.executeQueue()};ta.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=false;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null}}(ta));(function(d){if(!d){d={}}if(!d.analytics){d.analytics={}}var f=function(){if(d&&d.util&&d.util.error&&d.util.error.record){d.util.error.record.apply(this,arguments)}};var c=function(l){if(l===undefined||l===null){return""}if(typeof l!="string"){l=l.toString()}l=l.replace(/!/g,"!!");l=l.replace(/\./g,"!.");l=l.replace(/\*/g,"!*");return l};var k=function(p){var l=[];for(var m in p){var o=p[m];l.push(c(m)+"."+c(o))}return l.join("*")};var a=function(l){var m=/(http:\/\/[^/]+)?\/([^-.?]*)/;var o=m.exec(l);var p={};if(o){if(typeof o[2]!="undefined"){return(o[2])?o[2]:"Home"}}return null};var b=function(o,l,p){var m=new RegExp("(-"+l+"([0-9]+))|([?&]"+p+"=([0-9]+))");var q=m.exec(o);if(q){if(typeof q[2]!="undefined"){return q[2]}if(typeof q[4]!="undefined"){return q[4]}}return null};var j=function(l){var m=b(l,"d","detail");if(m){return m}var o=b(l,"g","geo");return o};var h=function(o,m){var l={gac:o[1],gaa:o[2],gal:o[3],gav:o[4],gani:o[5]};l.gass=a(document.location.href);l.gasl=j(document.location.href);l.gads=a(m);l.gadl=j(m);if(!l.gass){throw new Error("Src servlet undefined")}if(!l.gads){throw new Error("Dst servlet undefined")}Cookie.write("EVT",k(l),{domain:cookieDomain,time:300})};var g=function(l){return new Request({url:"/GARecord",data:{gac:l[1],gaa:l[2],gal:l[3],gav:l[4],gani:l[5],gass:a(document.location.href),gasl:j(document.location.href)}})};d.analytics._JSON_parse=function(l){if(JSON.parse){return JSON.parse(l)}if(JSON.decode){return JSON.decode(l)}throw new Error("No JSON.parse or JSON.decode")};d.analytics._insertGAScriptElement=function(){try{var o=document.createElement("script");o.type="text/javascript";o.async=true;o.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(o,l)}catch(m){if(d&&d.util&&d.util.error&&d.util.error.record){d.util.error.record(m,"loading ga.js problem")}}};d.analytics._validatedTrackEventArray=function(o,q,l,p,m){if(!p){p=0}else{if(typeof p!="number"){p=new Number(p).valueOf();if(isNaN(p)){p=0}}}if(typeof m!="boolean"){m=m==true}return["_trackEvent",o,q,l,p,m]};d.analytics._toEvtParams=function(o){try{if(typeof _gaq!="undefined"&&typeof _gaq.push!="undefined"){var l={gac:o.module,gaa:o.action,gal:o.context,gav:o.value,gani:o.noninteraction};l.gass=a(document.location.href);l.gasl=j(document.location.href);return l}else{return{}}}catch(m){f(m,"ta.analytics._toEvtParams",null,o)}};d.analytics._trackEventAfterAjax=function(o){try{if(typeof _gaq!="undefined"&&typeof _gaq.push!="undefined"){var l=d.analytics._validatedTrackEventArray(o.module,o.action,o.context,o.value,o.noninteraction);_gaq.push(l)}}catch(m){f(m,"ta.analytics._trackEventAfterAjax",null,[module,action,context,value,noninteraction])}};d.trackPhysicalCommerce=function(m,l,q){try{if(typeof _gaq!="undefined"&&typeof _gaq.push!="undefined"){var o=d.analytics._validatedTrackEventArray(m,"Commerce-Physical",l,q,false);_gaq.push(o);g(o).get()}}catch(p){f(p,"ta.trackPhysicalCommerce",null,[m,l,q])}};d.trackAttemptedCommerce=function(m,l,p,q){try{if(typeof _gaq!="undefined"&&typeof _gaq.push!="undefined"){_gaq.push(["_setCustomVar",15,"Provider",p],d.analytics._validatedTrackEventArray(m,"Commerce-Attempted",l,q,false),["_deleteCustomVar",15])}}catch(o){f(o,"ta.trackAttemptedCommerce",null,[m,l,p,q])}};d.trackEventOnPage=function(m,r,l,q,p){try{if(typeof _gaq!="undefined"&&typeof _gaq.push!="undefined"){var o=d.analytics._validatedTrackEventArray(m,r,l,q,p);_gaq.push(o);g(o).get()}}catch(s){f(s,"ta.trackEventOnPage",null,[m,r,l,q,p])}};d.setEvtCookie=function(o,r,m,q,l){try{if(typeof _gaq!="undefined"&&typeof _gaq.push!="undefined"){var p=d.analytics._validatedTrackEventArray(o,r,m,q,false);h(p,l)}}catch(s){f(s,"ta.setEvtCookie",[o,r,m,q,l])}}})(ta);(function(a){Object.append(a,{isHotelsRedesign2011:function(){if(ta.has("hac.isHotelsRedesign2011")){return ta.retrieve("hac.isHotelsRedesign2011")}var c=ta.id("HAC_SMRY");var b=c&&c.hasClass("hotels_re_2011");ta.store("hac.isHotelsRedesign2011",b);return b},isSmartDealsFilters:function(){if(ta.has("smartdeals.isSmartDealsFilters")){return ta.retrieve("smartdeals.isSmartDealsFilters")}var b=ta.id("DEALS");var c=b&&b.hasClass("sdfilters");ta.store("smartdeals.isSmartDealsFilters",c);return c},isDHTMLCRRedesign2012:function(){if(ta.has("overlays.isDHTMLCRRedesignBasic")){return ta.retrieve("overlays.isDHTMLCRRedesignBasic")}var b=$$(".overlay");var c=b&&b.hasClass("rgba_flyout");ta.store("overlays.isDHTMLCRRedesignBasic",c);return c},isRestaurantsRedesign2012:function(){if(ta.has("eateries.isRestaurants")){return ta.retrieve("eateries.isRestaurants")}var c=ta.id("EATERIES_2012");var b=c&&c.hasClass("gridA");ta.store("eateries.isRestaurants",b);return b},isAttractionsRedesign2012:function(){if(ta.has("attractions.isAttractions")){return ta.retrieve("attractions.isAttractions")}var b=ta.id("ATTRACTIONS_2012");var c=b&&b.hasClass("gridA");ta.store("attractions.isAttractions",c);return c}})})(ta);ta.browser={isIE9orHigher:function(){if(Browser.ie&&Browser.version>=9){return true}return false}};ta.util.cookie={expireTimeForPID:5,expireTimeForPID_remove:0,cookiePIDName:"NPID",setPIDCookie:function(a){try{Cookie.write(ta.util.cookie.cookiePIDName,a,{domain:cookieDomain,time:ta.util.cookie.expireTimeForPID})}catch(b){var c="";if(typeof cookieDomain!="undefined"){c=cookieDomain}ta.util.error.record(b,"set pid cookie",null,{pid:a,cookieDomain:c})}},removePIDCookie:function(){try{Cookie.write(ta.util.cookie.cookiePIDName,"",{domain:cookieDomain,time:ta.util.cookie.expireTimeForPID_remove})}catch(a){}},setPID:function(b,a){if(ta.id(a).get("tag")!="a"){a=a.getParent("a")}if(pid=a.className.match(/pid(\d+)/)){ta.util.cookie.setPIDCookie(pid[1])}},setPIDNoA:function(a){pid=a.className.match(/pid(\d+)/);if(pid){ta.util.cookie.setPIDCookie(pid[1])}}};setPID=ta.util.cookie.setPIDCookie;ta.util.ASDF={asdf:function(b,a){if(a){ta.util.cookie.setPIDCookie(a)}window.location=asdf(b)},asdfPxlAndPid:function(d,b,a){var f="http://ad.doubleclick.net/ad/";var c=";sz=1x1";if(a){ta.util.cookie.setPIDCookie(a)}if(b){new Element("img",{src:f+b+c})}window.location=asdf(d)},asdfPopup:function(b,a){if(a){ta.util.cookie.setPIDCookie(a)}ta.servlet.Popup.open(asdf(b))},asdfPopupEmail:function(a){ta.servlet.Popup.open(asdf(a),"email",580,460,30,25)},asdfPopupGuide:function(a){ta.servlet.Popup.open(asdf(a),"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2)},asdfPopupTerms:function(a){ta.servlet.Popup.open(asdf(a),"terms",300,300,30,25)},asdfPopupDir:function(a){new Request({url:"/ActionRecord?action=getDirectionsListings"}).send();ta.servlet.Popup.open(asdf(a),null,800,600)},asdfDcd:function(a){return asdf(a)}};function getOffset(a){if(a>=97&&a<=122){return a-61}if(a>=65&&a<=90){return a-55}if(a>=48&&a<=71){return a-48}return -1}function asdf(d){var h={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],q:[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],x:[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],z:[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]};var b="";for(var a=0;a<d.length;a++){var j=d.charAt(a);var f=j;if(h[j]&&a+1<d.length){a++;f+=d.charAt(a)}else{j=""}var g=getOffset(d.charCodeAt(a));if(g<0||typeof h[j][g]=="String"){b+=f}else{b+=h[j][g]}}return b}ta.util.Doer={doit:function(f,d){var c="/"+f;var b=0;for(var a in d){if(b===0){c+="?"}else{c+="&"}c+=a+"="+d[a];b++}return c},aimdoit:function(k,c,a,l){var b=ta.util.Doer.doit(k,c);new Event(a).preventDefault();var j=475;var d=390;var g=210;var f=5;if(l){j=980;d=800;g=240}else{if(screen.width>=1024&&screen.height>=768&&c&&(c.area=="Text_Photos"||c.area=="Thumbnail")){j=900;d=768;g=240}else{if(screen.width>1024){j=800;d=600;g=240}else{if(screen.width>800){j=620;d=500;g=240}}}}ta.store("commerce.AIMWindow",ta.servlet.Popup.open(b,null,j,d,g,f,false,true));if(ta.retrieve("checkrates.isCRLB")){ta.run("ta.overlays.Factory.loadCheckRatesLBOverlay",{},a,null,c)}},tadoit:function(d,b,c,a){window.location=ta.util.Doer.tadoless(d,b,c,a)},tadoless:function(h,c,g,k,b){var a="/"+h;for(var j in c){a+="-"+j+c[j]}var f=g.length;for(var d=0;d<f;d++){a+="-"+g[d]}if(!b){a+=".html"}if(k.length>0){a+=k}return a}};ta.util.pending={};ta.util.pending.waitForMore=function(f,c,a,b,d){if(ta.has("pending."+f)){ta.util.pending.cancel(f)}ta.store("pending."+f,{timer:c.delay(a,d,b),fn:c,t:"m",n:a})};ta.util.pending.waitForFn=function(id,fn){try{var tmp=eval(fn),data;if(tmp){if(typeOf(tmp)==="function"){if(ta.has("pending.callback."+id)){ta.retrieve("pending.callback."+id)()}else{if(ta.has("pending."+id)){data=ta.retrieve("pending."+id);if(data.evnt){tmp.attempt([data.evnt,data.elmt])}else{tmp.attempt()}}else{tmp.attempt()}}}else{if(IS_DEBUG){alert("fn is not a function: "+typeOf(tmp))}}}else{ta.util.pending.waitForFnAgain(id,fn)}}catch(e){ta.util.pending.waitForFnAgain(id,fn)}};ta.util.pending.WAIT_DELAY=100;ta.util.pending.WAIT_TIMEOUT=50;ta.util.pending.waitForFnAgain=function(c,a){var b=ta.has("pending."+c)?ta.retrieve("pending."+c):{t:"f",fn:a,count:1};if(b.count<ta.util.pending.WAIT_TIMEOUT){b.count++;b.timer=ta.util.pending.waitForFn.invokeLater(ta.util.pending.WAIT_DELAY,null,[c,a]);ta.store("pending."+c,b)}else{if(IS_DEBUG&&!ta.has("pending.ignore."+c)){alert("timed out ("+(ta.util.pending.WAIT_TIMEOUT*ta.util.pending.WAIT_DELAY)+"ms) waiting for function: "+a)}}};ta.util.pending.waitForFile=function(c,a,b){if(ta.load(a)){ta.util.pending.waitForFn(c,b)}};ta.util.pending.waitForHandler=function(d,b,c,a){ta.store("pending."+d,{count:0,t:"f",fn:b,evnt:c,elmt:a});ta.util.pending.waitForFn(d,b)};ta.util.pending.cancel=function(b){var a=ta.remove("pending."+b);if(a&&a.timer){clearTimeout(a.timer)}};ta.util.pending.lock=function(d,b,c,a){if(ta.has("pending."+d)){return[a,false].pick()}ta.store("pending."+d,true);if(c){ta.util.pending.unlock.delay(c,null,d)}return b()};ta.util.pending.unlock=function(b){var a=ta.remove("pending."+b);if(a&&typeof a==="object"){a.count--;if(a.count===0){a.fn()}else{ta.store("pending."+b,a)}}};ta.util.pending.multilock=function(c,a,b){ta.store("pending."+c,{count:b,fn:a})};ta.util.pending.multilockUpdate=function(d,c){var b="pending."+d,a=ta.retrieve(b);if(a){a.count+=c}};ta.util.pending.wait=function(f,c,b,d,a){ta.store("pending."+f,{timer:c.delay(b,d,a)})};ta.util.pending.waitForElement=function(d,a,c){if(ta.has("pending."+d)){return}var b=$(a);if(b){ta.util.pending.cancel("pending."+d);c(b)}else{ta.store("pending."+d,{timer:ta.util.pending.waitForElement.delay(2,null,[d,a,c])})}};ta.util.pending.waitFor=function(a,c,b){if(a()){return c()}setTimeout(function(){ta.util.pending.waitFor(a,c,b)},b);return false};ta.util.load={loadedMap:false,loadingMap:false,callbacks:[]};ta.util.load.GMaps=function loadGMaps(a){return ta.util.load.maps(a)};ta.util.load.maps=function(a){if(ta.util.load.loadedMap){a&&a()}else{if(ta.util.load.loadingMap){ta.util.load.callbacks.push(a)}else{ta.util.load.loadingMap=true;return ta.maps.load.library(function(){ta.util.load.loadedMap=true;ta.util.load.loadingMap=false;a&&a();ta.util.load.callbacks.each(function(b){b&&b()})})}}};ta.util.load.mapsLazy=function(a){return ta.run("ta.maps.load.library",{},a)};ta.util.load.GoogleLoader=function(a){if(ta.has("googleloader.state")){if(ta.retrieve("googleloader.state")=="loaded"){return a()}else{return ta.util.load.GoogleLoader.delay(500,this,a)}}else{ta.store("googleloader.state","loading");ta.store("googleloader.callback",a);new Asset.javascript("http://www.google.com/jsapi?callback=ta.util.load.GoogleLoaderCallback")}};ta.util.load.GoogleLoaderCallback=function(){ta.store("googleloader.state","loaded");var a=ta.remove("googleloader.callback");a()};ta.util.load.LocalSearch=function(a){ta.util.load.GoogleLoader(function(){google.load("search","1",{callback:function(){}})})};ta.util.date={};ta.util.date.MS_IN_DAY=1000*60*60*24;ta.util.date.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ta.util.date.inDateSet=function(c,b){if((c==null)||(b==null)){return false}var f=b.length;for(var d=0;d<f;d++){var g=b[d];if(g.length){var h=g[0].getTime();var a=g[1].getTime();if((h<=c.getTime())&&(a>=c.getTime())){return true}}else{if(c.getTime()==g.getTime()){return true}}}return false};ta.util.date.rangesIntersect=function(a,b){return Math.max(a[0].getTime(),b[0].getTime())<=Math.min(a[1].getTime(),b[1].getTime())};ta.util.date.getDaysInRange=function(b,a){return Math.round((a.getTime()-b.getTime())/ta.util.date.MS_IN_DAY)+1};ta.util.date.inSameMonth=function(b,a){return(b!=null)&&(a!=null)&&(b.getMonth()==a.getMonth())&&(b.getYear()==a.getYear())};ta.util.currency={};ta.util.currency.formatCurrency=function(c,a){var f=a?a:"USD";var b=currencySymbol[f];var d=ta.util.currency.formatThousands(Math.round(c));if(!b[1]){return b[0]+d}else{return d+b[0]}};ta.util.currency.formatThousands=function(b){if(typeof groupingSize=="undefined"||typeof groupingSeparator=="undefined"||groupingSize<1){return b}var a="";var d=""+b;for(var c=1;c<=d.length;c++){a=d.charAt(d.length-c)+a;if(c%groupingSize==0&&c<d.length){a=groupingSeparator+a}}return a};ta.util.Toggle={};ta.util.Toggle.siblings=function(c,b){c.preventDefault();var a=true;if(b.hasClass("closed")){a=false}b.toggleClass("closed sprite-arrow_toggle_blu_lft");b.getParent().getChildren().each(function(d){if(d!=b){d.setStyle("display",a?"none":"block")}})};ta.util.Toggle.parentClass=function(c,a){c.preventDefault();var b=a.getParent(".toggle");b.toggleClass("off")};ta.util.Toggle.toggleTarget=function(d,b,c){d.preventDefault();var a=true;if($(b).hasClass("closed")){a=false}$(b).toggleClass("closed");$(b).toggleClass("open");$(c).setStyle("display",a?"none":"block")};ta.util.Toggle.toggleForm=function(b,d,c){var a=$(b).getParent(".formToggle");if(/sel_(\w+)/.test(a.className)){var f=RegExp.$1;a.removeClass("sel_"+f);a.getElement(".form_"+f).hide();var g=a.getElement(".header_"+f);if(g){g.hide()}}a.addClass("sel_"+d);var g=a.getElement(".header_"+d);if(g){g.show()}a.getElement(".form_"+d).show();return false};ta.util.Toggle.toggleLI=function(f,d,a){var c=f.getNext();for(var b=0;b<1000&&c&&c.id!=d.id;b++){if(a){c.show()}else{c.hide()}c=c.getNext()}if(a){f.hide()}else{f.show()}if(a){d.show()}else{d.hide()}};ta.util.URL={parse:function(c){if(/^(\w+):(.*)/.test(c)){c=RegExp.$2;switch(RegExp.$1){case"DOM":elmt=document.getElement(c);c=(elmt&&elmt.href)?elmt.href:"#";break;case"GMapsLC":if(c.length==0){break}tmp=c.split(",");ops={from:pageServlet,Action:tmp.shift()};tmp.each(function(d){if(/^g(\d+)$/.test(d)){ops.g=RegExp.$1}else{if("ext"==d){ops.ext="y"}else{if(/^(.*)=(.*)$/.test(d)){ops[RegExp.$1]=RegExp.$2}else{ops[d]=""}}}});c="/GMapsLocationController?"+Object.toQueryString(ops);break;case"ABS":var a=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+c;break;case"ABSPAGE":var a=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+c;if(c.indexOf(".html")==-1){c+=".html"}break;case"REL":var b=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"));if(/\/$/.test(window.location.pathname)){b=window.location.pathname}var a=window.location.port=="80"?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+b+c;break;default:c=RegExp.$1+":"+c;break}}return c}};ta.util.i18n={};ta.util.i18n.isRtl=function(){return ta.id(document.body).hasClass("rtl")};ta.util.element={};ta.util.element.replaceContent=function(g,f,c){var d=g;var b=f;if(!b.getElement(".progresstab")){var a=c+(c.indexOf("?")==-1?"?":"&")+"xhr=true";var h=new Element("div",{"class":"progresstab"});h.inject(b);new Request({url:a,onSuccess:function(j,k){b.empty();b.innerHTML=j;if(window.behavior){window.behavior.apply(b)}b.fireEvent("onContentReplaced",[d,b])},evalScripts:true}).get()}};ta.util.element.spinner=function(b,a){$(a).getParent(".spinnerReplaceable").getChildren().each(function(c){if(c.hasClass("spinner")){c.show()}else{c.hide()}})};ta.util.element.clearDefault=function(b,a){if(a.value==a.defaultValue){a.value=""}};ta.util.element.limitLength=function(b,a,c){if(a.value.length>=c){a.value=a.value.substr(0,c);return false}};ta.util.link={ajaxSubmit:function(a,c,b){if(a){new Event(a).preventDefault()}if(b){ta.util.cookie.setPIDCookie(b)}if(!c.className.match(/\bform_(\w+)\b/)){return}var g=$(RegExp.$1);var f={url:c.href,data:g,onFailure:function(j){if(g){g.removeClass("ajaxInFlight")}ta.util.error.ajaxFailure("link - ajaxSubmit",j)}};var h=window["callback"+g.id];if(c.className.match(/method_(\w+)\b/)){f.method=RegExp["$1"]}if(c.className.match(/\btgt_(\w+)\b/)){f.update=RegExp["$1"]}else{f.onSuccess=function(j){if(g){g.removeClass("ajaxInFlight")}ta.overlays.showInLightbox(j);if(h&&typeOf(h)=="function"){h()}}}var d=window["validate"+g.id];if(d&&typeOf(d)=="function"&&d.apply(g)==false){return}g.addClass("ajaxInFlight");if(c.className.match(/\bevalScripts\b/)){f.evalScripts=true}(f.update?new Request.HTML(f):new Request(f)).send()},ajaxCall:function(a,b){if(a){new Event(a).preventDefault()}if(!(tgt=b.className.match(/\btgt_(\w+)\b/))){return}tgt=$(tgt[1]);new Request.HTML({url:b.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("link - ajaxCall")}).send()},popResWidth:function(b,f,d){try{var a=475,g=390,k=210;if(screen.width>1024){a=800;g=600;k=240}else{if(screen.width>800){a=620;g=500;k=240}}var j=Object.merge({width:a,height:g,xOffset:k,yOffset:5},d);ta.util.link.popup(b,f,j)}catch(c){ta.util.error.record(c,"ta.util.link - popCustom",b,j)}},popPhoto:function(a,d,c){try{Cookie.write("PhotoPop","1",{domain:cookieDomain});var f=Object.merge({name:"media",width:782,height:820},c);ta.util.link.popup(a,d,f)}catch(b){ta.util.error.record(b,"ta.util.link - popPhoto",a,f)}},popup:function(o,a,k){try{var g=Object.merge({name:false,width:950,height:610,xOffset:false,yOffset:false,noScroll:0,aHref:false,fullOptions:true,ensureReferrer:false,isAsdf:false},k);new Event(o).preventDefault();var f=false,b="",m=false;var c=1;if(ta.has("ta.popups.popupIndex")&&typeof ta.retrieve("ta.popups.popupIndex")!="undefined"){c=ta.retrieve("ta.popups.popupIndex")}if(!g.aHref){g.aHref=a.href}if(g.isAsdf&&g.aHref){if(ta.util.ASDF.asdfDcd){g.aHref=ta.util.ASDF.asdfDcd(g.aHref).replace(/&amp;/g,"&")}}if(g.aHref&&g.aHref.indexOf("p=HotelsCom")>-1){g.width=Math.max(g.width,960);try{g.height=Math.max(g.height,window.getHeight(),600)}catch(h){g.height=Math.max(g.height,600)}}if(g.width){b+=",width="+g.width}if(g.height){b+=",height="+g.height}if(g.xOffset){b+=",screenX="+g.xOffset+",left="+g.xOffset}if(g.yOffset){b+=",screenY="+g.yOffset+",top="+g.yOffset}if(!Browser.chrome){g.noScroll=1}if(g.fullOptions){var j=1;if(ta.browser.isIE9orHigher()){j=0}b="toolbar=1,resizable=1,menubar="+j+",location=1,status=1,scrollbars="+g.noScroll+b}else{b="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+g.noScroll+b}if(!g.name){g.name="p"+(c++)}ta.store("ta.popups.popupIndex",c);if(g.ensureReferrer&&Browser&&Browser.ie){try{m=new Element("a",{target:g.name,href:g.aHref});m.inject(ta.id(document.body),"bottom");f=window.open("",g.name,b);m.click();m.destroy()}catch(d){ta.util.error.record(d,"ta.util.link - pop ensure referrer",o,g)}}else{try{f=window.open(g.aHref,g.name,b)}catch(h){ta.util.error.record(h,"ta.util.link - popping window",o,{href:g.aHref,name:g.name,args:b})}}if(typeof f!="undefined"&&f!==null){try{f.opener=self;f.focus()}catch(d){}}}catch(l){ta.util.error.record(l,"ta.util.link - popup",o,g)}},directionsPop:function(a,c,b,d){if(d){new Request({url:"/ActionRecord?action="+d}).send()}if(ta.trackEventOnPage){ta.trackEventOnPage("map_pin_overlay","directions_click")}ta.util.link.popup(a,c,b)},remTAPD:function(a,b){Cookie.dispose("TAPD",{domain:cookieDomain})},phacRadio:function(a,c,b){if(!ta.has("phacRadioClicked")){ta.store("phacRadioClicked",true);new Request({url:"/ActionRecord?action=HotelReviewSearchTypeChangedTo"+c.value}).send()}showHidePhac(b)}};(function(a){a.util.localstorage={};a.util.localstorage.canUseLocalStore=function(){try{if(window.localStorage){var c="taLsTest";localStorage.setItem(c,"1");var b=localStorage.getItem(c);return(b=="1")}}catch(d){return false}}}(ta));(function(c){c.util||(c.util={});var a=["success","failure","always","progress"];var g={resolved:["success","always"],rejected:["failure","always"]};var j=function(){};for(var f=0;f<a.length;f++){(function(k){j.prototype[k]=function(m,l){return b(this,k,l?m.bind(l):m)}}(a[f]))}c.util.Deferred=function(){var k="pending";var m=new j();m.queue=[];m.args=null;m.status=function(){return k};var l={notify:function(){if(d(k)){throw new Error("Promise has already been fulfilled.")}var p=Array.prototype.slice.call(arguments);var r,q,o;for(q=0,o=m.queue.length;q<o;q++){r=m.queue[q];if(r.hook=="progress"){r.callback.apply(null,p)}}return m},resolve:function(){if(d(k)){throw new Error("Promise has already been fulfilled.")}k="resolved";m.args=Array.prototype.slice.call(arguments);return h(m)},reject:function(){if(d(k)){throw new Error("Promise has already been fulfilled.")}k="rejected";m.args=Array.prototype.slice.call(arguments);return h(m)},promise:function(){return m}};return l};var d=function(k){return k=="resolved"||k=="rejected"};var b=function(l,k,m){l.queue.push({hook:k,callback:m});return h(l)};var h=function(m){var l,k;while(d(m.status())&&(l=m.queue.shift())){if(~g[m.status()].indexOf(l.hook)){k=l.callback.apply(null,m.args);if(k instanceof j){k.queue=k.queue.concat(m.queue);m=k}}}return m}}(ta));ta.util.decoder={base64Decoder:function(h){h=h.replace(/\-/g,"+").replace(/\_/g,"/");if(h.length%4!==0){var j=4-h.length%4;for(var g=0;g<j;g++){h=h+"="}}var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="",s,q,o="",r,p,l,k="";for(var f=0;f<h.length;f+=4){r=d.indexOf(h.charAt(f));p=d.indexOf(h.charAt(f+1));l=d.indexOf(h.charAt(f+2));k=d.indexOf(h.charAt(f+3));if(r==-1||p==-1||l==-1&&k==-1){ta.util.error.record(null,"Facebook signed request contains invalid base64 letter",null,{code:h});return}s=(r<<2)|(p>>4);q=((p&15)<<4)|(l>>2);o=((l&3)<<6)|k;a=a+String.fromCharCode(s);if(l!=64){a=a+String.fromCharCode(q)}if(k!=64){a=a+String.fromCharCode(o)}s=q=o="";r=p=l=k=""}return unescape(a)}};ta.util.fileUpload=function(c,f,h){function b(l,j){var m;try{m=document.createElement("<"+l+' name="'+j+'">')}catch(k){m=document.createElement(l);m.setAttribute("name",j)}return m}var g="upload_iframe_"+(Math.random()+"").split(".")[1];var d=b("iframe",g);d.setAttribute("id",g);d.setAttribute("src","about:blank");d.setAttribute("width","0");d.setAttribute("height","0");d.setAttribute("border","0");d.setAttribute("style","width:0; height:0; border:none; display:none; ");document.body.appendChild(d);c.target=g;function a(){ta.id(d).removeEvent("load",a);var j=d.contentWindow.document;h(j);setTimeout(function(){d.parentNode.removeChild(d)},250)}ta.id(d).addEvent("load",a);c.submit()};ta.common.search={langSelect:function(b,a){if(a.form.elements.q.value.length>0){a.form.submit()}},clearOnFocus:function(b,a){if(a.value==a.defaultValue){a.value="";a.removeClass("focusClear")}},defaultOnBlur:function(b,a){if(a.value==""){a.addClass("focusClear");a.value=a.defaultValue}},validate:function(b,a){if(a.q.value==""||$(a.q).hasClass("focusClear")){return false}setOneTimeCookie("SRCHACT","NEW");return true},selectLang:function(b,d){try{var p=function(r){var q=r.match(/([\d.]+)px/);if(q){return parseFloat(q)}return 0};var g=ta.id("SEARCH_LANG_SELECT_POPUP");if(!g){return false}if(!g.hasClass("hidden")){var f=ta.id("SEARCH_LANG_SELECT_INPUT");var j=ta.id("SEARCH_LANG_SELECTED");if(f){var h=d.id.match(/lang_(.+)/);if(h){var c=h[1];if("all"==c){f.value=""}else{f.value=c}}if(j){j.set("html",ta.id(d).get("html"))}}g.addClass("hidden");if(j&&!ta.common.search.widthfixed){var k=ta.common.search.width;var o=p(j.getStyle("width"));var a=Math.max(k,o);console.log("check width old "+k+" new "+o);if(k!=o){j.setStyle("width",a+"px");ta.common.search.widthfixed=true}}}else{g.removeClass("hidden");var j=ta.id("SEARCH_LANG_SELECTED");if(j&&!ta.common.search.widthfixed){ta.common.search.width=p(j.getStyle("width"))}}}catch(l){ta.util.error.record(l,"select search lang")}},reviews:function(c,b){new Request({url:"/ActionRecord?action=SearchReviews"}).send();if(b&&b.getElement){var a=b.getElement(".searchTestText");if(a){alert(a.innerHTML)}}else{alert("Coming Soon!")}return false}};ta.common.flyout={intlPopup:function(d,b){d.stop();b.onclick=null;if(flagsUrl==null||flagsUrl==""){flagsUrl=document.location.pathname}var c="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(document.location.search!=""){c+=encodeURIComponent(document.location.search)}if(document.location.hash!=""){c+=encodeURIComponent(document.location.hash)}if(window.modelGeoId){c+="&geo="+modelGeoId}if(window.flagsSettings){for(var a=0;a<flagsSettings.length;a++){c+="&"+flagsSettings[a]+"=true"}}if(window.pageFeature){c+="&pageFeature="+pageFeature}new Asset.css(flagsFlyoutCSS);new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:c},b);return false},showRecentLocationSaveOverlay:function(){setPID(3832);new Request({url:"/RecentlyViewedAjax",onSuccess:function(a){if(!a.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(a,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"save_overlay"},evalScripts:true,method:"get"}).send()},submitRecentLocationEmail:function(){var a=ta.retrieve("overlays.current");if($("rvEmailSend")){$("rvEmailSend").hide()}if($("rvEmailProgress")){$("rvEmailProgress").show()}setPID(4470);new Request({url:"/RecentlyViewedAjax",onSuccess:function(b){a.hide();if(!b.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(b,{style:"dg s4 RecentlyViewedOverlay"})}},data:$("rvEmailForm"),evalScripts:true}).send()},submitRecentLocationSave:function(){var a=ta.retrieve("overlays.current");if($("rvEmailSend")){$("rvEmailSend").hide()}if($("rvEmailProgress")){$("rvEmailProgress").show()}setPID(4469);new Request({url:"/RecentlyViewedAjax",onSuccess:function(b){a.hide();if(!b.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(b,{style:"dg s4 RecentlyViewedOverlay"})}},data:$("rvEmailForm"),evalScripts:true}).send()},showEmailHotelOverlay:function(a){new Request({url:"/ActionRecord?excludeFromVS=false&action=BusinessListingsEmail&d="+a}).send();new Asset.css(emailHotelCSS);new Request({url:"/EmailHotel",onSuccess:function(b){ta.run("ta.overlays.showInLightbox",{},b,{style:"dg s4"});if(ta.has("emailOwnerShowCaptcha")){ta.t4b.emailhotel.showRecaptcha()}},data:{detail:a},evalScripts:true,method:"get"}).send()},rvInquiryPrivacy:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,content:$("rvPrivacyBox").innerHTML},a)},rvClearDefault:function(c,a){var b=$(c);if(b&&b.value==a){b.value="";b.removeClass("rvDefault")}},BLSpecialOffersUrl:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,content:$("blLinkMsg").innerHTML},a)},destinationsPopup:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:"/vpages/destinationsFly.html?lt=evt"},a)},funStuffPopup:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:"/vpages/funStuffFly.html?lt=evt"},a)},bestValue:function(b,a){b.stop();a.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,remoteContent:"/vpages/bestValueFly.html?log=false"},a);return false},starAttribution:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},a);return false},amenities:function(d,b,a,c){if(d){d.stop()}b.onclick=null;if(typeof(amenityOverlayCss)!="undefined"&&!ta.retrieve("ta.amenityOverlayCss")){ta.store("ta.amenityOverlayCss",Asset.css(amenityOverlayCss))}if(a&&a>0){setPID(a);new Request({url:"/ActionRecord?excludeFromVS=false&action=HRAmenitiesFlyout"}).send()}if(c){ta.store("amenities.suppressLinks",true)}ta.run("ta.overlays.Factory.createAmenitiesLightbox",{},b);return false}};ta.common.sendmessage={getMessageCode:function(){var f=new Date().getTime();var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ123456";var g=[];for(var a=0;a<32;a++){g[a]=((f&(1<<a))!=0)?1:0}var c=[[],[],[],[],[],[]];for(var a=0;a<30;a++){c[a%(c.length)].push(g[g.length-1-a])}var d="";for(var a=0;a<c.length;a++){d+=b.substr(parseInt(c[a].reverse().join(""),2),1)}return d},communityLightbox:function(f,d){if(!communityEnabled){window.callback_communityLightboxEnable=function(){communityEnabled=true;var h=ta.retrieve("overlays.sendmessage");if(h){h.hide()}ta.common.sendmessage.communityLightbox(f,d)};var a=new StringBuffer();a.append('<p id="inviteStatusField" style="display: none; color: red;"></p>');a.append("<p>"+JS_mem_travelnet_friends_disabledM2M+".</p>");a.append('<p><a href="javascript:void(0)" onclick="ta.common.sendmessage.enableCommunity(window[\'callback_communityLightboxEnable\'], true); return false;">'+JS_common_Clickhere+"</a> "+JS_mem_travelnet_friends_turnOn+".</p>");var g=ta.overlays.showInLightbox(a.toString(),{backdrop:ta.overlays.BACKDROP_NEVER,onHide:ta.common.sendmessage.cancel.bind(this)});g.container.setStyle("z-index","9998");ta.store("overlays.sendmessage",g);return}if(d){var b=function(h){var j=ta.overlays.showInLightbox(h,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this)});j.container.setStyle("z-index","9998");ta.store("overlays.sendmessage",j);var k=window[d];if(k&&typeOf(k)=="function"){k()}}}else{var b=function(h){var j=ta.overlays.showInLightbox(h,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this)});j.container.setStyle("z-index","9998");ta.store("overlays.sendmessage",j)}}var c={url:f,onSuccess:b,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:communityLightbox")};new Request(c).send()},enableCommunity:function(c,a){var b=c;if(!a){b=function(d){ta.common.sendmessage.enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:enableCommunity")}).send()},enableCommunityResponse:function(res,callback){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){document.getElementById("inviteStatusField").innerHTML=data.ERROR;document.getElementById("inviteStatusField").style.display="block"}}else{document.getElementById("inviteStatusField").innerHTML=JS_community_on;document.getElementById("inviteStatusField").style.display="block"}},submitSendMessage:function(j,b){j.stop();b.onclick=null;var a=b.className.match(/LSO_(\w+)/)[1];$("LsoId").value=footprintGetWithSet(a);$("screenWidth").value=screen.width;$("screenHeight").value=screen.height;if(!b.className.match(/\bform_(\w+)\b/)){return}var f=$(RegExp.$1);var d={url:b.href,data:f,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:submitSendMessage")};var h=window["callback"+f.id];if(b.className.match(/method_(\w+)\b/)){d.method=RegExp["$1"]}if(b.className.match(/\btgt_(\w+)\b/)){d.update=RegExp["$1"]}else{d.onComplete=function(m,k){var l=ta.overlays.showInLightbox(m,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this)});ta.store("overlays.sendmessage",l);if(h&&typeOf(h)=="function"){h()}}}var c=window["validate"+f.id];if(c&&typeOf(c)=="function"&&c.apply(f)==false){return}if(b.className.match(/\bevalScripts\b/)){d.evalScripts=true}var g=ta.retrieve("overlays.sendmessage");if(g&&g.options&&g.options.permanent){g.options.permanent=false}new Request(d).send()},cancel:function(a){if(a){return}var b=ta.retrieve("overlays.sendmessage");if(b){ta.remove("overlays.sendmessage")}if(ta.has("community.needsReload")){window.location.reload()}},closeSendMessage:function(c,a){if(c&&c.stop){c.stop()}if(a){a.onclick=null}var b=ta.retrieve("overlays.sendmessage");if(b){b.hide(c)}}};ta.servlet.Inspiration={sortPopularity:function(b,a){sort("popularity")},sortAlphabetical:function(b,a){sort("alphabetical")}};ta.keep("facebook.onAvail",function(){FB.Event.subscribe("edge.create",function(d,g){try{var h=false;if(g&&g.dom){h=$(g.dom)}var a="";var c="";if(h){c=h.getAttribute("href");if(h.className){var b=false;if(b=h.className.match(/track_(\w+)/)){a=b[1]}if(h.hasClass("expanded")){a+="_expanded"}}}new Request({url:"/ActionRecordPlus?action=LIKE&from="+a+"&url="+c}).send()}catch(f){ta.util.error.record(f,"FB like review tracking error")}})});ta.servlet.Reviews={expandCount:0,extraAdAdded:false,PAGING_HEIGHT:1000,expandReview:function(q,d,c){var a=0;if(ta.retrieve("expand_"+c)){return}ta.store("expand_"+c,true);a++;var b=ta.id(c);var p=new Event(q);try{a++;if(!b){ta.util.error.record(null,"expandReview - no container",p,{revId:c});return}var k,m,h=false;if(b.getElement){k=b.getElement(".dyn_full_review");m=b.getElement(".basic_review");h=b.getElement(".revBotContent")}if(!m||!m.hasClass){ta.util.error.record(null,"expandReview - no basic_rev",p,{revId:c});return}a++;var j=m.hasClass("first");if(h&&h.getElement){var g=h.getElement(".fb_like_button")}var l=m.getElement(".helpful");a++;if(k){k.setStyle("display","block");if(g){ta.servlet.Reviews.injectFBLikeIntoFull(g,k)}if(ta.servlet.Reviews.translationRatings.contains(expandedReviewId)){ta.servlet.Reviews.injectTranslationRating(m,k)}m.setStyle("display","none");ta.remove("expand_"+c)}else{a++;ta.servlet.Reviews.expandCount++;var o=m.getElement(".partnerRvw span.linkItem");a++;if(o){o.getElement("img.textArrow_more").setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(o)}a++;new Request({url:"/SingleUserReview-g"+modelGeoId+"-d"+modelLocId+"?review="+c+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount,onSuccess:function(u,v){try{var t=0;k=new Element("div");k.addClass("dyn_full_review");k.set("html",u);k.inject(m,"after");t++;var w=k.getElement(".collapse");if(w){w.addEvent("click",function(){ta.servlet.Reviews.collapseReview(b)})}t++;if(j){k.getElement(".basic_review").addClass("first")}t++;setupTranslationRatingSlider(k);t++;if(typeof processLinks!=="undefined"){processLinks(k)}t++;ta.servlet.Reviews.fixMTHelpfulUrl(k,c);if(m){var A=m.getElement("img.anim_loop");A.dispose()}t++;if(o){var s=o.getElement("img.textArrow_more");if(typeof(s)!="undefined"&&s!=null){s.setStyle("display","inline")}}t++;injectAdsTargeted(k);t++;ta.servlet.Reviews.refreshSidebarAds();t++;var y=ta.retrieve("facebook.data.handlers.FRIEND_NAMES");var r=ta.retrieve("facebook.data.handlers.HIGHLIGHT_FRIENDS");if(y&&typeof(y)=="function"){y()}if(r&&typeof(y)=="function"){r({expanded:true})}if(g){ta.servlet.Reviews.injectFBLikeIntoFull(g,k)}if(l){helpfulVotingKey=l.id.match(/(helpful\w+)_\w+/);if(helpfulVotingKey){helpfulVotingKey=helpfulVotingKey[1];if(ta.retrieve(helpfulVotingKey)){var C=k.getElement(".helpful");if(C){C.innerHTML=l.innerHTML}}}}t++}catch(z){ta.util.error.record(z,"expandReview - post AJAX",null,{postProg:t})}if(m&&m.setStyle){m.setStyle("display","none")}if(h&&h.setStyle){h.setStyle("display","none")}ta.remove("expand_"+c);var B=ta.retrieve("ta.servlet.Reviews.callback");if(B!=null){B()}},evalScripts:true}).send()}}catch(f){ta.util.error.record(f,"expandReview",p,{revId:c,prog:a});ta.remove("expand_"+c)}},expandReviews:function(j,m,k,u,s){if(ta.retrieve("expand_"+k)){return}ta.store("expand_"+k,true);var p=ta.id(k);var r=new Event(j);try{if(!p){ta.util.error.record(null,"expandReviews - no container",r,{revId:k});return}var l,v,C=false;if(p.getElement){l=p.getElement(".dyn_full_review");v=p.getElement(".basic_review");C=p.getElement(".revBotContent")}if(!v||!v.hasClass){ta.util.error.record(null,"expandReviews - no basic_rev",r,{revId:k});return}if(l){ta.servlet.Reviews.showExpandedReview(k,true);ta.remove("expand_"+k)}else{ta.servlet.Reviews.expandCount++;var w=v.getElement(".partnerRvw span.moreLink");if(w){var d=w.getParent().getElement("img.textArrow_more");if(d){d.setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(w,"after")}}var B=$$("#REVIEWS .reviewSelector");var a;for(var y=0;y<B.length;y++){if(B[y].id==k){a=B.slice(y)}}var o=[];if(a&&a.length>0){for(var y=0;y<a.length;y++){var t=a[y].id;if(t&&t.indexOf("review_")===0){var z=a[y].getElement(".dyn_full_review");if(!z){var h=a[y].getElement(".basic_review");if(h){o[o.length]=t.split("_")[1]}else{ta.util.error.record(null,"expandReviews - basic_review content missing",null,{revId:t},"WARN")}}}}}if(o.length>0){var q=o[0];var c=0;if(u){c=u}var g=o.join(",");var b="";var A="";if(ta.servlet.Reviews.expandCount==1&&o.length>2){A=o[2];b="&extraadtarget="+A;ta.servlet.Reviews.extraAdAdded=true}new Request({url:"/ExpandedUserReviews-g"+modelGeoId+"-d"+modelLocId+"?target="+q+"&context="+c+"&reviews="+g+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount+"&extraad="+ta.servlet.Reviews.extraAdAdded+b,trackEvent:{module:"Reviews",action:"expand"},onSuccess:function(K,G){try{var L=[];var D=new Element("div");D.set("html",K);var S=D.getChildren();var J=[];for(var R=0;R<S.length;R++){var H=S[R];var N=H.id.split("_")[2];var U=ta.id("review_"+N);if(U&&U.getElement){J.push(U.getProperty("id"));var Q=U.getElement(".basic_review");if(Q){L.push(N);H.erase("id").addClass(Q.className.replace("basic_review","dyn_full_review")).inject(Q,"after").hide();var W=H.getChildren()[0];if(W){W.removeClass("review")}var M=H.getElement(".collapse");if(M){M.addEvent("click",ta.servlet.Reviews.getCollapseCallback(U))}setupTranslationRatingSlider(H);if(typeof processLinks!=="undefined"){processLinks(H)}if(ta.servlet.Reviews.translationRatings.contains(N)){ta.servlet.Reviews.injectTranslationRating(Q,H)}ta.servlet.Reviews.fixMTHelpfulUrl(H,"review_"+N);if(N===q){var E=Q.getElement("img.anim_loop");if(E){E.dispose()}ta.servlet.Reviews.refreshSidebarAds();injectAdsTargeted(H);var P=Q.getElement(".partnerRvw span.moreLink");if(P){var F=P.getParent().getElement("img.textArrow_more");if(typeof(F)!="undefined"&&F!=null){F.setStyle("display","inline")}}}if(ta.servlet.Reviews.expandCount==1&&(N===A)){injectAdsTargeted(H)}}}}var I=true;for(var R=0;R<L.length;R++){if(R==1){I=false}var O="review_"+L[R];ta.servlet.Reviews.showExpandedReview(O,I)}if(lazyImgs!=null){window.setupLazyLoad()}}catch(X){ta.util.error.record(X,"expandReviews - post AJAX",null,{});var E=v.getElement("img.anim_loop");if(E){E.dispose()}var P=v.getElement(".partnerRvw span.moreLink");if(P){var F=P.getParent().getElement("img.textArrow_more");if(typeof(F)!="undefined"&&F!=null){F.setStyle("display","inline")}}}if(Browser.ie&&Browser.version<8){var T=function(){for(var Y=0;Y<J.length;++Y){var Z=ta.id(J[Y]);if(Z!==null){Z.addClass("dummy")}}};setTimeout(T,0)}ta.remove("expand_"+k);if(ta.retrieve("isDaoDao")&&ta.retrieve("member_info_redesign")){var V=ta.retrieve("memberTravelMapInstance");if(V){V.getExtendGeos()}}},onFailure:function(D,E){ta.util.error.record(null,"ExpandedUserReviews ajax call failed",null,{reviewIds:g},"WARN");var G=v.getElement("img.anim_loop");if(G){G.dispose()}var H=v.getElement(".partnerRvw span.moreLink");if(H){var F=H.getParent().getElement("img.textArrow_more");if(typeof(F)!="undefined"&&F!=null){F.setStyle("display","inline")}}},evalScripts:true}).send()}}}catch(f){ta.util.error.record(f,"expandReviews",r,{revId:k});ta.remove("expand_"+k)}},getCollapseCallback:function(a){return function(){ta.servlet.Reviews.collapseReview(a)}},showExpandedReview:function(a,b){try{if(typeof(a)==="undefined"){ta.util.error.record(null,"showExpandedReview - reviewId is undefined");return}var f=ta.id(a);if(f){var j,l,g=false;if(f.getElement){j=f.getElement(".dyn_full_review");l=f.getElement(".basic_review");g=f.getElement(".revBotContent")}else{ta.util.error.record(null,"showExpandedReview - recContainer missing getElement attribute",null,{revId:a});return}if(!l){ta.util.error.record(null,"showExpandedReview - basic_rev is null",null,{revId:a});return}if(!l.hasClass){ta.util.error.record(null,"showExpandedReview - basic_rev missing hasClass attribute",null,{revId:a});return}if(g&&g.getElement){var d=g.getElement(".fb_like_button")}var k=l.getElement(".helpful");if(!j){ta.util.error.record(null,"showExpandedReview - no full");return}if(k){var h=k.id.match(/(helpful\w+)_\w+/);if(h){h=h[1];if(ta.retrieve(h)){var m=j.getElement(".helpful");if(m){m.innerHTML=k.innerHTML}}}}if(d){ta.servlet.Reviews.injectFBLikeIntoFull(d,j)}j.show();l.hide()}else{ta.util.error.record(null,"showExpandedReview - revContainer is null",null,{revId:a});return}}catch(c){ta.util.error.record(c,"showExpandedReview")}},fixMTHelpfulUrl:function(c,a){var d=c.getElement("input[name=returnTo]");if(d){var b=document.location.href;if(b.indexOf("#")>=0){b=b.substring(0,b.indexOf("#"))}d.value=b+"#mtreview_"+a}},injectFBLikeIntoFull:function(c,a){try{if(c){var f=c.getFirst();if(f){f.addClass("expanded")}var b=a.getElement(".helpful");if(b){c.inject(b,"after")}}}catch(d){ta.util.error.record(d,"expandReview - like button")}},injectTranslationRating:function(c,b){if(c&&b){var a=c.getElement(".translation"),d=b.getElement(".translation");if(a&&d){d.set("html",a.get("html"))}}},translationRatings:[],refreshSidebarAds:function(){if(ta.retrieve("did_ad_refresh")){return}ta.store("did_ad_refresh",true);var a=Math.floor(Math.random()*99999999);document.getElements("div.sidebar div.adServer iframe").each(function(b){if(b&&b.cloneNode){var c=b.cloneNode(false);c.src=b.src.replace(/ord=\d+/,"ord="+a)+";refresh=true";b.parentNode.replaceChild(c,b)}else{if(b){ta.util.error.record(null,"refreshSidebarAds",null,{revId:reviewId,msg:"iframe var is not a dom elemnt"})}else{ta.util.error.record(null,"refreshSidebarAds",null,{revId:reviewId,msg:"iframe var was null"})}}})},collapseReview:function(a){try{a=ta.id(a);var f=a.getElement(".dyn_full_review");var c=a.getElement(".basic_review");var d=a.getElement(".revBotContent");var b=f.getElement(".fb_like_button");if(c&&c.setStyle){c.setStyle("display","block")}if(d&&d.setStyle){d.setStyle("display","block")}if(b){var j=b.getFirst();if(j){j.addClass("expanded")}if(d){b.inject(d,"inside")}}var h=a.id.replace("review_","");if(ta.servlet.Reviews.translationRatings.contains(h)){ta.servlet.Reviews.injectTranslationRating(f,c)}f.setStyle("display","none")}catch(g){ta.util.error.record(g,"collapseReview")}},findLink:function(b,a){if(/\bt(r[\d]+)\b/.test(a.className)){window.location=$(RegExp.$1).href}},mtSubmitOnClick:function(b,a){if(a.value==="true"){ta.util.cookie.setPIDCookie(25173)}else{if(a.value==="false"){ta.util.cookie.setPIDCookie(25172)}}a.form.submit()},rateMTReview:function(a,d){var c=ta.id(d.form);var j=c.getElement("input[name=translateRating]:checked");if(j){var f=j.value;var g=c.elements.userId.value;var b=c.elements.reviewId.value;ta.servlet.Reviews.translationRatings.push(b);var h=c.action+"?at=true&rateValue="+b+","+g+","+f;new Request({url:h}).send();var k=c.getElement(".thanks").innerHTML;c.getElement(".translationRatingForm").innerHTML=k}},popSocialShare:function(b,a){if(b&&b.href){var c="toolbar=1,location=1,directories=1,status=1,menubar=1,resizable=1,copyhistory=1,scrollbars=1,width=800,height=400,left=40,top=40,screenx=40,screeny=40";window.open(b.href,"SocialShare",c)}new Request({url:"/ActionRecord?action=shareOn"+a}).send();return false},helpfulVoteHandler:function(b,a){new Event(b).preventDefault();var c=a.className.match(/\btgt_(\w+)\b/);if(!c){return}c=c[1];new Request({url:a.href,onSuccess:function(d,g){var h=ta.id(c+"_expanded");var f=ta.id(c+"_collapsed");if(h){h.innerHTML=d}if(f){f.innerHTML=d;ta.store(c,true)}}}).send()},helpfulVoteHandlerOb:function(b,a,c){new Event(b).preventDefault();var d=a.className.match(/\btgt_(\w+)\b/);if(!d){return}d=d[1];c=ta.util.ASDF.asdfDcd(c);new Request({url:c,onSuccess:function(f,h){var j=ta.id(d+"_expanded");var g=ta.id(d+"_collapsed");if(j){j.innerHTML=f}if(g){g.innerHTML=f;ta.store(d,true)}}}).send()},recordUnattached:function(b,a){new Request({url:"/ActionRecord?action=START_UNATTACHED_RVW_SEARCH"}).send();a.removePropertyEvent("keyup","ta.servlet.Reviews.recordUnattached")},changeSearchType:function(f,b){if(window.searchType){$$("span."+window.searchType.id).hide()}window.searchType=b;$$("span."+b.id).setStyle("display","inline");if(b.id!="type_rental"){switch(b.id){case"type_hotel":ta.store("tpAhdType","hotel");break;case"type_attraction":ta.store("tpAhdType","attr");break;case"type_restaurant":ta.store("tpAhdType","eat");break;case"type_location":ta.store("tpAhdType","geo");break}if($("SRCH_BOX_VR")){$("SRCH_BOX_VR").hide()}if($("SRCH_RSLT_VR")){$("SRCH_RSLT_VR").hide()}if($("MAIN_COL")){$("MAIN_COL").hide()}if($("POST_PHOTOS_FORM")){$("POST_PHOTOS_FORM").hide()}$("SRCH_BOX").show();$("UR_SELECT").show();var c=ta.id("query");var a=c.retrieve("typeAhead");if(a){a.changeUrl("/TypeAheadJson?action=SINGLELOCTYPE&types="+ta.retrieve("tpAhdType")+"&global=true");a.query();a.updateChoices()}if(c.value.length>0){searchByType()}c.focus();c.select()}else{$("SRCH_BOX_VR").show();$("SRCH_BOX").hide();$("UR_SELECT").hide();var d=$("reviewGeo");d.focus();d.select()}},unattachedSearchOnFocus:function(c,a){var b=ta.retrieve("tpAhdType");ta.run("ta.widgets.typeahead.factory.global_mutable",{},c,a,"SINGLELOCTYPE","ta.widgets.typeahead.events.onSelectUnattached",{xargs:"&types="+b});a.removePropertyEvent("focus","ta.servlet.Reviews.unattachedSearchOnFocus")},ratingFlyoutScroll:function(b){try{var c=b.getScroll().y,a=b.getScrollSize().y;if(b.retrieve("canFetchMore",true)&&c>a-ta.servlet.Reviews.PAGING_HEIGHT){b.store("canFetchMore",false);ta.servlet.Reviews.fetchRatingPage(b)}}catch(d){ta.util.error.record(d,"ratingFlyoutScroll")}},fetchRatingPage:function(b){var a=b.getElement(".ratingVal").innerHTML,c=b.getElement(".locId").innerHTML,f=b.getElement(".revId"),d=f.innerHTML;if(d!=0){new Request({url:"/RatingPagingAjax",data:{locId:c,ratingVal:a,revId:d},method:"get",onSuccess:function(g,h){f.destroy();b.innerHTML+=g;b.store("canFetchMore",true)}}).send()}}};ta.servlet.Location={distanceUnitsCookieName:"TAdistanceCookie",showMi:function(){$$("#NEARBY .milesOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .distanceMiles").show();$$("#NEARBY .distanceKm").hide();Cookie.write(this.distanceUnitsCookieName,0)},showKm:function(){$$("#NEARBY .kmOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .distanceMiles").hide();$$("#NEARBY .distanceKm").show();Cookie.write(this.distanceUnitsCookieName,1)},reportClosedVote:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?action=geocodeclosed&id="+c,onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})}}).send()}},reportGeoCode:function(d,c,f,b,a){if(f&&f>0){f=encodeURIComponent(f);new Request({method:"get",url:"/ReportIAP?action=geocodebad&id="+f,onSuccess:function(g){ta.overlays.showInLightbox(g,{style:"mg s4",delayedPosition:true})}}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,f)}},reportCorrectAddr:function(c,g,m,q,d,k,o,r){if(m&&m>0){m=encodeURIComponent(m);var j=document.getElementById("street").value;var l=document.getElementById("city").value;var b=document.getElementById("state").value;var f=document.getElementById("zip").value;var h=document.getElementById("country").value;var p=document.getElementById("phone").value;var a=document.getElementById("website").value;if(q==j&&d==l&&k==f&&o==p&&r==a){new Request({method:"post",url:"/ReportIAP?action=geocodecorrect&updated=false&id="+m,onSuccess:function(s){ta.overlays.showInLightbox(s,{style:"mg s4",delayedPosition:true})}}).send()}else{j=encodeURIComponent(j);l=encodeURIComponent(l);b=encodeURIComponent(b);f=encodeURIComponent(f);h=encodeURIComponent(h);p=encodeURIComponent(p);a=encodeURIComponent(a);new Request({method:"post",url:"/ReportIAP?action=geocodecorrect&updated=true&id="+m+"&street="+j+"&city="+l+"&state="+b+"&zip="+f+"&country="+h+"&phoneNumber="+p+"&webSite="+a,onSuccess:function(s){ta.overlays.showInLightbox(s,{style:"mg s4",delayedPosition:true})}}).send()}}},reportGeoCodeDialog:function(d,c,f,b,a){if(typeof(incorrectLocation)!="undefined"&&!this.incorrectLocationLink){this.incorrectLocationLink=Asset.css(incorrectLocation)}if(f&&f>0){f=encodeURIComponent(f);new Request({method:"get",url:"/ReportIAP?id="+f+"&action=geocodedialog",onSuccess:function(g){ta.overlays.showInLightbox(g,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,f)}},showReportForm:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?id="+c+"&action=geocodeform",onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}},setTrackPID:function(c,b,a){if(a==10022){ta.util.cookie.setPIDCookie(17138)}else{if(a==10021){ta.util.cookie.setPIDCookie(17137)}}},closeLightbox:function(){var a=ta.retrieve("overlays.current");if(a){a.hide()}},activateReportButton:function(){var a=ta.id("REPORT_LOCATION").getElements(".button")[0];a.removeClass("inactive");a.removeProperty("disabled")}};ta.servlet.Popup={index:0,open:function(a,b,c,r,m,l,g,q){try{if(isNaN(parseInt(c))){c=600}else{c=parseInt(c)}if(isNaN(parseInt(r))){r=400}else{r=parseInt(r)}if(isNaN(parseInt(m))){m=0}else{m=parseInt(m)}if(isNaN(parseInt(l))){l=0}else{l=parseInt(l)}if(a.indexOf("p=HotelsCom")>-1){c=Math.max(c,960);r=Math.max(r,window.getHeight(),600)}if(Browser.chrome){g=true}var f=1;if(g){f=0}var k=1;if(ta.browser.isIE9orHigher()){var k=0}var j=false;if(b&&typeof b=="string"){j=b}if(!j){var s=ta.servlet.Popup.index++;j="TripPop"+s}var d="";if(q){d="toolbar=1,resizable=1,location=1,status=1"}else{k=0;d="toolbar=0,resizable=1,location=0,status=0"}d+=",menubar="+k;d+=",scrollbars="+f;d+=",width="+c;d+=",height="+r;d+=",screenX="+m+",left="+m;d+=",screenY="+l+",top="+l;var o=window.open(a,j,d);if(o!=null){try{o.focus();o.opener=self}catch(p){}return o}}catch(h){ta.util.error.record(h,"Popup.open",null,{name:b,width:c,height:r,x:m,y:l,noScroll:g,allOptions:q})}},openSizedPopup:function(d,b){new Event(d).preventDefault();var c=600;var a=400;if(sz=b.className.match(/sz(\d+)x(\d+)/)){c=sz[1];a=sz[2]}ta.servlet.Popup.open(b.href,"photoTPW",c,a,false,false,true,true)},checkrates:function(b,a){b.preventDefault();if(a.get("tag")!="a"){a=a.getParent("a")}ta.servlet.Popup.open(a.href,"cr",245,610,5,5);if(ta.trackEventOnPage){ta.trackEventOnPage("map_pin_overlay","check_rates_click")}},sponsorCheckRates:function(d,b){d.preventDefault();if(b.get("tag")!="span"){b=b.getParent("span")}var a=b.className.match(/id_(\d+)/)[1];var c="/HotelDateSearch?d="+a+"&fromPop=false&sponsid="+ta.retrieve("sponsor.id")+"&area=QC_Button_Map&from=HACSearchButton&returnTo=__2F__GMapsLocationController&sponsdet=mapsHacBottom";ta.servlet.Popup.open(c,"cr",245,610,5,5)},termsPopup:function(b,a){popup.apply(a,[b,"terms",300,300,30,25]);return false},openInParent:function(f,d,c){var a=false;if(window.top&&window.top.opener){a=window.top}else{if(window.opener){a=window}}if(!a){return true}var b="";if(d.get("tag")=="form"){b=d.action+"?"+d.toQueryString()}else{if(d.get("tag")=="a"){b=d.href}else{d=d.getParent("a");b=d.href}}if(b!=""){if(f){f.preventDefault()}a.opener.location=b;if(!(typeof c!="undefined"&&c)){a.close()}else{window.blur()}}},openInParentOrSelf:function(d,c){var a=false;if(window.top&&window.top.opener){a=window.top}else{if(window.opener){a=window}}var b="";if(c.get("tag")=="form"){b=c.action+"?"+c.toQueryString()}else{if(c.get("tag")=="a"){b=c.href}else{c=c.getParent("a");b=c.href}}if(b!=""){if(d){d.preventDefault()}if(!a||(typeof a.opener=="undefined")||!a.opener||(typeof a.opener.closed=="undefined")||a.opener.closed){window.location=b}else{a.opener.location=b;a.close()}}},photoGallery:function(a,d){try{if(!d){return false}if(!d.get||!d.getParentBySelector){d=$(d)}if(!d.get||!d.getParentBySelector){ta.util.error.record(j,"photoGallery - elmt not wrapped");return false}if(d.get("tag")!="a"){d=d.getParentBySelector("a")}}catch(j){ta.util.error.record(j,"photoGallery - get anchor elmt");return false}var b="";var c="1";if(d.className){b=d.className.match(/u_([^ ]*)/)[1];c=d.className.match(/#([0-9]+)/)[1]}try{if(typeof cookieDomain=="undefined"){var g=window.location.hostname.split("."),f=0,l;while(g[f]&&g[f]!="tripadvisor"){f++}l=g.slice(f).join(".");if(l){cookieDomain="."+l}}Cookie.write("PhotoPop",c,{domain:cookieDomain})}catch(j){ta.util.error.record(j,"photoGallery - cookie set")}try{var k="";if(b){k=ta.servlet.Popup.open(b,"media",780,800)}else{}try{if(k&&k.showImage){k.showImage(c)}}catch(j){}}catch(j){ta.util.error.record(j,"photoGallery - pop window")}return false},openAIMLink:function(d,c){new Event(d).preventDefault();var b;if(c.get("tag")=="span"&&c.hasClass("fkASDF")){b=c.className.match(/u_([^ ]*)/)[1]}else{if(c.getParent("div.fkASDF")){b=c.getParent("div.fkASDF").className.match(/u_([^ ]*)/)[1]}else{if(c.get("tag")=="a"){b=c.href}else{if(c.getParent().get("tag")=="a"){b=c.getParent().href}else{return}}}}var a=c.className.match(/win(.+)/);if(a&&a.length>1){a=a[1]}else{a=null}ta.store("commerce.AIMWindow",ta.servlet.Popup.open(b,a,980,800,240,5,false,true));try{if(ta.has("checkrates.lpl_check_rates")&&c.href&&c.href.match(/LocationPhotosLightbox/)){ta.id("MEDIA_GALLERY").hide()}}catch(f){ta.util.error.record(f,"LPL photoGallery - could not hide photo gallery")}},openProviderWindow:function(b,a){new Event(b).preventDefault();ta.servlet.Popup.open(a.href,"photoTPW",1260,922,false,false,true,true)}};ta.servlet.Hotel={detailsTabClicked:function(b,a){showTab(locationId,"tabDetails")},photosTabClicked:function(b,a){showTab(locationId,"tabPhotos")},mapTabClicked:function(b,a){showTab(locationId,"tabMap")},ratingsTabClicked:function(b,a){showTab(locationId,"tabRatings")},setPid:function(a){ta.util.cookie.setPIDCookie(a)},setConceptCookie:function(){if(ta.has("topconcepts.lastconcept")){var a=ta.retrieve("topconcepts.lastconcept");Cookie.write("CONCEPT",a,{domain:cookieDomain,time:5})}return true},voteRecorded:false,recordVote:function(b,h,f,c,a){if(a.checked&&!ta.servlet.Hotel.voteRecorded){ta.servlet.Hotel.voteRecorded=true;new Request({url:"/ActionRecord-g"+b+"-d"+h+"?action=TopConceptsHelpful_"+f}).send();var d=$("preVote");var g=$("postVote");if(d&&g){d.style.display="none";g.style.display="inline"}else{ta.util.error.record(null,"recordVote - cannot find voting spans")}}return true},isHotelsServlet:function(a){if(ta.has("is_hotels_serv")){return ta.retrieve("is_hotels_serv")}var b=ta.id("PAGE");if(b&&typeof b!="undefined"){if(b.hasClass("hotels_like")){ta.store("is_hotels_serv",true);return true}else{if(b.hasClass("non_hotels_like")){ta.store("is_hotels_serv",false);return false}}}if(typeof a!="undefined"){return a}return false}};ta.widgets.Calendar=new Class({Implements:[Options,Events],options:{selectedDate:null,firstDate:null,lastDate:null,dualCalendar:true,invalidDates:null,useLinks:true,dayNames:false,formatter:null,offsetOther:0,choiceLink:null,prevAction:null,nextAction:null,monthHeadingFormat:"",monthspan:11,indicateTurnoverDays:false},initialize:function(b){this.setOptions(b);if(!this.options.firstDate){this.options.firstDate=new Date()}if(!this.options.lastDate){this.setLastDate(this.options.monthspan)}this.today=new Date();this.selectedDate=this.options.selectedDate;this.today.setHours(0,0,0,0);if(this.options.firstDate){this.options.firstDate.setHours(0,0,0,0)}if(this.options.lastDate){this.options.lastDate.setHours(0,0,0,0)}if(this.selectedDate){this.selectedDate.setHours(0,0,0,0)}var a=[];if(this.options.prevAction&&this.options.nextAction){a.push('<div class="navCal">');a.push('<span class="prev"><a style="display: block;" onclick="');a.push(this.options.prevAction);a.push('(event, this);">Previous Month</a></span>');a.push('<span class="next"><a style="display: block;" onclick="');a.push(this.options.nextAction);a.push('(event, this);">Next Month</a></span>');a.push("</div>")}this.container=new Element("div",{"class":"calendar"});this.container.set("html",a.join(""));if(this.options.monthHeadingFormat==""&&DATE_FORMAT_MMM_YYYY){this.options.monthHeadingFormat=DATE_FORMAT_MMM_YYYY}},setLastDate:function(b){if(b==null||b<1){b=11}var f=new Date();f.setDate(1);var a=f.getMonth();var c=a+b;f.setFullYear(f.getFullYear()+c/12);f.setMonth(c%12);this.options.lastDate=f},update:function(){if(this.currentMonth){this.removeTable(null,this.currentMonth)}if(this.nextMonth){this.removeTable(null,this.nextMonth)}var c=this.selectedDate||this.today;if(this.options.firstDate&&c<this.options.firstDate){c=this.options.firstDate}if(this.options.dualCalendar){var g=new Date(c);g.setDate(ta.util.date.DAYS_IN_MONTH[g.getMonth()]);g.setHours(0,0,0,0);if(g>=this.options.lastDate){c=new Date(c);if(c.getMonth()==0){c.setFullYear(c.getFullYear()-1,11,1)}else{c.setMonth(c.getMonth()-1,1)}}}this.currentMonth=this.createMonth(c);if(this.options.dualCalendar){var f=new Date(this.currentMonth.date);var a=f.getDate();var b=f.getMonth()+1;if(a>ta.util.date.DAYS_IN_MONTH[b]){a=ta.util.date.DAYS_IN_MONTH[b]}f.setMonth(b,a);this.nextMonth=this.createMonth(f);if(!ta.util.i18n.isRtl()){this.container.appendChild(this.currentMonth.elmt);this.container.appendChild(this.nextMonth.elmt)}else{this.container.appendChild(this.nextMonth.elmt);this.container.appendChild(this.currentMonth.elmt)}}else{this.container.appendChild(this.currentMonth.elmt)}this.updatePrevNext();return this},reposition:function(){this.currentMonth.elmt.setStyle("left","0px");if(this.options.dualCalendar){if(!ta.util.i18n.isRtl()){this.nextMonth.elmt.setStyle("left",this.currentMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}else{this.nextMonth.elmt.setStyle("left","0px");this.currentMonth.elmt.setStyle("left",this.nextMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}}return this},updatePrevNext:function(){var b=this.currentMonth.date;var a=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date;var d=ta.util.date.inSameMonth(b,this.options.firstDate);var c=ta.util.date.inSameMonth(a,this.options.lastDate);getChildByClass(this.container,"prev").style.display=(d?"none":"block");getChildByClass(this.container,"next").style.display=(c?"none":"block")},createMonth:function(z){var A={date:z};var m=new Date(z);m.setDate(1);m.setHours(0,0,0,0);var p=(m.getDay()-jsGlobalDayOffset+7)%7;if(this.options.indicateTurnoverDays){var w=new Date(z);w.setDate(0);var g=(this.isInvalidDate(w)?0:1);if(w<this.options.firstDate||w>this.options.lastDate){g=-1}}var b=[];var q=z.getFullYear();var r=z.getMonth();var j=new Date();var y=ta.util.date.inSameMonth(j,z)?j.getDate():-1;var o=-1;if(this.selectedDate&&this.selectedDate.getMonth()==r){o=this.selectedDate.getDate()}b.push('<table cellspacing="0" cellpadding="0" border="0"><thead><tr><th class="caption" colspan="7">');b.push(this.options.monthHeadingFormat.replace(/MMM/,jsGlobalMonths[r]).replace(/YYYY/,q));b.push("</th></tr><tr>");for(var u=0;u<jsGlobalDaysShort.length;u++){b.push("<th>");b.push(this.options.dayNames?jsGlobalDaysAbbrev[u]:jsGlobalDaysShort[u]);b.push("</th>")}b.push("</tr></thead><tbody><tr>");for(var u=0;u<p;u++){b.push('<td class="other">&nbsp;</td>')}p--;var t=0;var c=ta.util.date.DAYS_IN_MONTH[A.date.getMonth()];if(A.date.getMonth()==1&&A.date.getYear()%4==0){c+=1}var k=c;while(t<c){p=(p+1)%7;t++;m.setDate(t);var v=t;var f=null;var a=!(m<this.options.firstDate||m>this.options.lastDate);var s=!this.isInvalidDate(m);var l=this.options.choiceLink;if(this.options.formatter){var h=this.options.formatter(m,a,s,p,this.options);f=h.cname;v=h.contents;l=h.link||l}else{if(!s){f="invalid"}else{if(t==y){if(t==o){f="today selected"}else{if(!a){f="today disabled"}else{f="today"}}}else{if(t==o){f="selected"}}}}if(this.options.indicateTurnoverDays){if(s){if(g==0){if(f){f+=" depart"}else{f="depart"}}g=1}else{if(g==1){if(f){f+=" arrive"}else{f="arrive"}}g=0}if(!a){g=-1}}if(p==0){b.push("</tr><tr>")}if(!a){b.push('<td class="');b.push(f||"disabled");b.push('">');b.push(v||t);b.push("</td>")}else{if(f){b.push('<td class="');b.push(f);b.push('">')}else{b.push("<td>")}if(this.options.useLinks&&l){b.push('<a href="javascript:void(0);" onclick="');b.push(l);b.push("(event,");b.push(q);b.push(",");b.push(r);b.push(",");b.push(t);b.push(',this)">');b.push(v);b.push("</a>")}else{b.push(v)}b.push("</td>")}}while(++p<7){b.push("<td class='other'>&nbsp;</td>")}b.push("</tr></tbody></table>");A.elmt=new Element("div",{"class":"month"}).set("html",b.join(""));return A},isInvalidDate:function(a){return ta.util.date.inDateSet(a,this.options.invalidDates)},isValid:function(){if(!this.selectedDate){return true}return this.selectedDate.getTime()>=this.options.firstDate.getTime()&&this.selectedDate.getTime()<=this.options.lastDate.getTime()},prev:function(){if(this.animating){return}var o=this.options.dualCalendar;this.animating=true;var j=new Date(this.currentMonth.date);var h=j.getMonth()-1;if(h<0){h=h+12;j.setFullYear(j.getFullYear()-1)}var k=j.getDate();if(k>ta.util.date.DAYS_IN_MONTH[h]){k=ta.util.date.DAYS_IN_MONTH[h]}j.setMonth(h,k);var l=this.currentMonth.elmt.getCoordinates().width;var g=l+(o?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(j);if(!ta.util.i18n.isRtl()){b.elmt.style.left="-"+l+"px";b.elmt.inject(this.container.getElement(".navCal"),"after")}else{b.elmt.style.left=g+"px";b.elmt.inject(this.container)}var f=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[-l,0]},"1":{left:[0,l+this.options.offsetOther]}};if(o){a["2"]={left:[l+this.options.offsetOther,l*2+this.options.offsetOther]}}}else{a={"0":{left:[0,-l]},"1":{left:[l+this.options.offsetOther,0]}};if(o){a["2"]={left:[l*2+this.options.offsetOther,l+this.options.offsetOther]}}}var c=new Fx.Elements(f,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.nextMonth||this.currentMonth)});if(o){this.nextMonth=this.currentMonth}this.currentMonth=b;this.updatePrevNext();c.start(a)},next:function(){if(this.animating){return}var o=this.options.dualCalendar;this.animating=true;var j=new Date(this.currentMonth.date);var h=j.getMonth()+(o?2:1);if(h>11){h=h-12;j.setFullYear(j.getFullYear()+1)}var k=j.getDate();if(k>ta.util.date.DAYS_IN_MONTH[h]){k=ta.util.date.DAYS_IN_MONTH[h]}j.setMonth(h,k);var l=this.currentMonth.elmt.getCoordinates().width;var g=l+(o?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(j);if(!ta.util.i18n.isRtl()){b.elmt.style.left=g+"px";b.elmt.inject(this.container)}else{b.elmt.style.left="-"+l+"px";b.elmt.inject(this.container.getElement(".navCal"),"after")}var f=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[0,-l]},"1":{left:[l+this.options.offsetOther,0]}};if(o){a["2"]={left:[l*2+this.options.offsetOther,l+this.options.offsetOther]}}}else{a={"0":{left:[-l,0]},"1":{left:[0,l+this.options.offsetOther]}};if(o){a["2"]={left:[l+this.options.offsetOther,l*2+this.options.offsetOther]}}}var c=new Fx.Elements(f,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.currentMonth)});if(o){this.currentMonth=this.nextMonth;this.nextMonth=b}else{this.currentMonth=b}this.updatePrevNext();c.start(a)},removeTable:function(b,a){a.elmt.dispose()},doneAnimating:function(b,a){this.removeTable(b,a);this.animating=false},select:function(a,b){this.selectedDate=b;this.fireEvent("onSelect",[this,a])},nearbyMonth:function(b,a){var c=b+a;if(c>11){c-=12}else{if(c<0){c+=12}}return c}});ta.widgets.tabContainer=function(d,j){var a=d.getElements(".current");if(a.length!=1){throw new Error("You must have exactly one tab with a class of 'current'.")}else{a=a[0]}var g=a.className.match(/tab(\d+)/);if(g!=null&&g.length>=2){var b=Number(g[1])}else{return}if($("HOMEPAGE")&&window.location.hash){var h=window.location.hash.match(/t(\d)/);if(h&&h.length>0){b=parseInt(h[1]);a.removeClass("current");d.getElements(".tab")[b].addClass("current")}}var c=d.getElements(".tabContainerHead .tab");if(c.length==0){return}var f=d.getElements(".tabContainerBody .tabContent");return new TabSet(c,f,{show:b,onActive:function(o,p,l){var q=p.hasClass("xhr");if(q&&!p.hasClass("xhrComplete")){var k=p.getElement("a").href;if(k){var m=p;l.addEvent("onContentReplaced",function(){m.addClass("xhrComplete")});ta.util.element.replaceContent(o,l,k)}}if(p.hasClass("recordAction")){new Request({url:"/ActionRecord?action="+p.id}).send()}p.addClass("current");if(q&&o){o.stop()}},onBackground:function(l,m,k){m.removeClass("current")}})};ta.widgets.Carousel=new Class({Implements:Options,Binds:["shiftLeft","shiftRight"],options:{width:50,height:50,padding:5,num:7,offset:0,horizontal:true},initialize:function(a,b){this.setOptions(b);this.container=a;this.viewport=this.container.getElement(".viewport");this.leftKnob=this.container.getElement(".shiftLeft");this.rightKnob=this.container.getElement(".shiftRight");this.images=this.viewport.getElements("img");this.offset=this.options.offset;if(this.options.horizontal){this.viewport.setStyles({width:this.options.width*this.options.num+this.options.padding*(this.options.num-1),height:this.options.height})}else{this.viewport.setStyles({width:this.options.width+this.options.padding*2,height:this.options.height*this.options.num+this.options.padding*(this.options.num-1)})}this.leftKnob.addEvent("click",this.shiftLeft);this.rightKnob.addEvent("click",this.shiftRight);this.render()},render:function(){var a=this.offset+this.options.num;for(var b=this.images.length-1;b>=0;b--){if(b<this.offset||b>=a){this.images[b].setStyle("left",-999)}else{if(this.options.horizontal){this.images[b].setStyle("left",(this.options.width+this.options.padding)*(b-this.offset))}else{this.images[b].setStyles({top:(this.options.height+this.options.padding)*(b-this.offset),left:0})}}}if(this.offset==0){this.leftKnob.addClass("disabled")}else{this.leftKnob.removeClass("disabled")}if(this.offset==this.images.length-this.options.num){this.rightKnob.addClass("disabled")}else{this.rightKnob.removeClass("disabled")}},shiftLeft:function(){var a=this.offset;this.offset=Math.max(0,this.offset-this.options.num);if(this.offset!=a){this.render()}},shiftRight:function(){var a=this.offset;this.offset=Math.min(this.offset+this.options.num,this.images.length-this.options.num);if(this.offset!=a){this.render()}}});(function(b){b.util.action={record:function a(f,d){new Request(Object.merge({url:"/ActionRecord",data:{action:f}},d)).get()},recordPlus:function c(f,d){new Request(Object.merge({url:"/ActionRecordPlus",data:{action:f}},d)).get()}}}(ta));(function(){var f=[];function a(l,o){var g=f.length;f.push({name:l,properties:[]});for(var m in o){var h=true;if(g>0){for(var j=0;h&&j<g;j++){if(f[j].properties.indexOf(m)!=-1){h=false}}}if(h){f[g].properties.push(m)}}}a("node",document.createTextNode(""));a("Element",Element.prototype);f[1].properties.push("uid");a("element",document.createElement("div"));a("input",document.createElement("input"));f[3].properties.push("autocomplete");var d={element:"E",number:"N","function":"F",string:"S","boolean":"B",object:"O",collection:"C",whitespace:"W"};function c(h){var g=typeOf(h);return null==h?"_":(d[g]?d[g]:(g=="null"?"!":g))}ta.util.error={types:f,override:false,record:function(y,h,t,v,p){var r=false;try{r=document.getElement("body").hasClass("js_logging")}catch(B){}if(!r){return}var o={};var C=false;try{if(t||window.event){t=new Event(t||window.event);C=ta.id(t.target);o.eTarg=this.getSelectorString(C)}}catch(s){}if(typeof(debugCacheKey)!="undefined"){o.key=debugCacheKey}var g=window.pageServlet;if(!g){g="unknown"}o.servlet=g;if(!p||typeof p!="string"){p="ERROR"}o.eLogLevel=p;var E={extraInfoError:"Problem storing extra info"};var D="";var m={};try{var k="";try{k=window.navigator.userAgent}catch(u){}var l="";var j="";if(C){l=C.id;j=C.className}var w=false;try{w=doCookieCheck()}catch(B){}var z="";if(typeof serverPool!="undefined"&&serverPool){z=serverPool}m={TARGET_ID:l,TARGET_CLASS:j,USER_AGENT:k,EXTERNAL_JS:ta.util.error.getScriptSrcs(),CLIENT_POOL:z,COOKIES_ENABLED:w}}catch(A){v=E}o.xInfo=ta.util.error._getExtraInfoString(m,v);try{o.eUrl=encodeURIComponent(window.location)}catch(s){}var q="No Error";try{if(y){q=y.name+"-"+y.message;q=q.replace(/[\r\n]/g,"")}}catch(s){}o.eMsg=q;try{o.eBlk=ta.util.error.getErrorBlock(h).substring(0,70)}catch(s){}try{o.eStak=y?ta.util.error.getErrorStack(y):""}catch(s){}try{new Request({url:"/JSErrorRecord",data:o}).send()}catch(B){o={eBlk:"JSErrorRecord Error",servlet:g,eLogLevel:"ERROR",eMsg:"no error retrieved"};new Request({url:"/JSErrorRecord",data:o}).send()}if(IS_DEBUG){(window.ERRORS||(window.ERRORS=[])).push(o)}if(ta.util.error.override){if(ta.util.error.override=~/alert/){ta.util.error.alert(o)}if(ta.util.error.override=~/console/&&console){ta.util.error.console(o)}}},_getExtraInfoString:function(r,g){var m="_extraInfoError_:Problem storing extra info.";var p={};var s="";try{var q=typeOf(g);var j={};if(q==="array"||q==="arguments"){for(var l=0;l<g.length;l++){var h=g[l];var o=typeof h;if(o==="string"||o==="number"||o==="boolean"){j[l]=h}else{j[l]=typeof h}}g=j}p=Object.merge(r,g);s=JSON.encode(p);if(s&&s.length<10000){return s.replace(/[\r\n]/g,"")}}catch(k){}try{p=Object.merge(r,m);s=JSON.encode(p);if(s&&s.length<10000){return s.replace(/[\r\n]/g,"")}}catch(k){}return m},getErrorBlock:function(g){if(typeof g!="undefined"&&g!==null){return g.toString().replace(/[\r\n]/g,"")}return"null or undefined"},getErrorStack:function(o){var l=o.stack;if(l){var p=l.split("\n");p=p.map(function(t){var s=t.lastIndexOf("/");if(s>0){t=t.substr(s+1)}return t});return p.join()}else{if(arguments&&arguments.callee){var q=[];var h=arguments.callee.caller;h=h.caller;var m=0;while(h&&m++<100){var j=h.toString();var g=j.length;var k=g>75?75:g;var r=j.substring(0,k);r=r.replace(/[\s\'\"]/g,"");r+="::";q.push(r);h=h.caller}return q.join(" ")}}return"none"},getSelectorString:function(h){if(!h){return""}var g=[h];while(typeof h!="undefined"&&h&&typeof h.parentNode!="undefined"){g.push(h=h.parentNode)}g=g.map(function(k){if(k&&k.tagName){var j=k.tagName;if(k.id){j+="#"+k.id}if(k.className){j+="."+k.className}return j}return""});g=g.reverse().join(">");g=g.replace(/\s+/g,".");return g},ajaxFailure:function(j,h,g){ta.util.error.record(null,j,null,Object.merge({status:h.status},g))},alert:function(g){var h="";Object.each(g,function(l,j){h=h+j+": "+l+"\n"});window.alert(h)},console:function(g){if(console){console.error(g)}},getScriptSrcs:function(){var g="";Array.each(document.getElementsByTagName("script"),function(k,h){if(k&&k.src){var j="";if(g!=""){j=","}g=g+j+k.src}});return g},describe:function(h){if(null==h){return"_N"}var k=c(h),j=[],m,o;for(var l in h){m=false;for(var g=0;!m&&g<f.length;g++){if(f[g].properties.indexOf(l)!=-1){m=true;if(j.indexOf(f[g].name)==-1){j.push(f[g].name)}}}if(!m){k+=","+l+":"+c(h[l])}}if(j.length>0){k+=","+j.join(",")}return k}};var b=Cookie.read("JS_ERROR_HANDLING");if(b){ta.util.error.override=b}})();ta.util.partials={requestTimeout:1000,maxDataRequests:12,dataRequestCount:0,incompleteDataRegex:/<\!-- incomplete\: ([\w, ]*) -->/,failedDataRegex:/<\!-- failed\: ([\w, ]*) -->/,partialsErrorRegex:/<\!-- error -->/,noOauthTokenRegex:/<\!-- no Oauth Token -->/,requestPartials:function(h,d,g,k){if(ta.util.partials.dataRequestCount>ta.util.partials.maxDataRequests||h.length==0){return}ta.util.partials.dataRequestCount++;var f=h;var b=g;var c=k;if(ta.has("fb.partial.extraJS")){ta.retrieve("fb.partial.extraJS").each(function(l){new Asset.javascript(l)})}if(ta.has("fb.partial.extraCSS")){ta.retrieve("fb.partial.extraCSS").each(function(l){new Asset.css(l)})}var a=ta.remove("facebook.authcode.param");var j=Object.merge({parts:h.join(","),requestUrl:ta.retrieve("page.urlSafe")},d);if(a!=null){j=Object.merge(j,{FBAuthCode:a})}new Request({url:"/MultiPartAjax",method:"post",data:j,keepScripts:true,onRequest:function(){Cookie.dispose("FacebookAuthCode")},onSuccess:function(l){ta.util.partials.dataAvailable(d,f,b,c,null,null,l)}}).send()},handlePartialPaging:function(j,f,g){var h=g||{};ta.util.partials.dataRequestCount=0;if(!f||f.href==null){ta.util.error.record(null,"handlePartialPaging elmt.href null:"+f,null,null);return false}/parts=([\w,]+)/.test(f.href);var d=RegExp.$1.split(",");ta.store("partial.event.element",f);ta.store("partial.event.params",g);var c=ta.remove("facebook.authcode.param");var a=Object.merge({requestUrl:ta.retrieve("page.urlSafe")},h);var b=Object.clone(a);if(c!=null){a=Object.merge(a,{FBAuthCode:c})}new Request({url:f.href,method:"post",data:a,keepScripts:true,onSuccess:function(k){ta.store("fb.partial.isHandlePartialPaging",true);ta.util.partials.dataAvailable(b,d,"facebook",false,j,f,k)}}).send();return false},dataAvailable:function(d,k,j,p,r,c,g){if(p){var f=ta.util.partials.dataAvailable.pass([d,k,j,false,r,c,g]);p(f,g,k,d,j,p);return}if(g.match(ta.util.partials.noOauthTokenRegex)){if(ta.remove("fb.partial.isHandlePartialPaging")){ta.support.Facebook.pageDataAvailable(r,c,d,g)}return}if(g.match(ta.util.partials.partialsErrorRegex)){if(ta.has(j+".onPartialsError")){ta.remove(j+".onPartialsError").each(function(s){s()})}return}var o=[];var h=[];if(g.match(ta.util.partials.incompleteDataRegex)){o=RegExp.$1.split(",")}if(g.match(ta.util.partials.failedDataRegex)){h=RegExp.$1.split(",")}var q=[];var b=null;var m=/<style[^>]*>([\s\S]*?)<\/style>/gi;while((b=m.exec(g))){q.push(b[1])}if(q.length>0){q=q.join("\n");var l=document.createElement("style");l.type="text/css";document.getElementsByTagName("head")[0].appendChild(l);if(Browser.ie){l.styleSheet.cssText=q}else{l.appendChild(document.createTextNode(q))}}g=g.stripScripts(true);g=g.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi,"");var a=ta.id("PARTIAL_DATA")||new Element("div",{id:"PARTIAL_DATA",styles:{display:"none"}}).inject(document.body);a.innerHTML+=g;setTimeout(function(){ta.util.partials.notifyListeners(k,j,o,h,a,d)},0)},notifyListeners:function(d,f,c,b,a,g){d.each(function(l){var q=f+".data.onAvail."+l;var o=c.contains(l);var k=b.contains(l);var r=ta.remove(q);if(r){for(var p=0,m=r.length;p<m;p++){if(r[p](a,o,k)===false){r[p]=null}}r=r.erase(null);if(o){if(r.length>0){ta.store(q,r)}else{c.erase(l)}}}});var j="partials.data.onPage";var h=ta.remove(j);if(h){h.each(function(k){k()})}if(c.length>0){ta.util.partials.requestPartials.invokeLater(ta.util.partials.requestTimeout,null,[c,g,f])}}};ta.util.partials.handleLightbox=ta.util.partials.handlePartialPaging;ta.support.Facebook={ready:false,queue:[],enqueueForFBReady:function(a){if(ta.support.Facebook.ready){a()}else{ta.support.Facebook.queue.push(a)}},dequeueForFBReady:function(){try{ta.support.Facebook.queue.each(function(b){b()})}catch(a){ta.util.error.record(a,"Error calling dequeueForFBReady")}ta.support.Facebook.queue=[]},ipRevoke:function(a){setTimeout(function(){ta.util.pending.lock("fb.revoke.lb",function(){ta.util.pending.unlock("fb.revoke")})},a)},enqueueForFBAvailable:function(a){if(ta.retrieve("facebook.session.available")){a()}else{ta.keep("facebook.onSessionAvail",a)}},init:function(){if(ta.has("facebook.available")){return}ta.util.pending.multilock("facebook.data.canDisplay",ta.support.Facebook.showData,2);var b=ta.support.Facebook.timing=new ta.support.IPTiming();if(!ta.retrieve("facebook.invalidFBCreds")){ta.support.Facebook.initData(true)}ta.support.Facebook.markAvailable();var a=window.documentDomainChanged?"/fb/channel_mod.html":"/fb/channel.html";var c=ta.retrieve("facebook.appId");var d=true;FB.init({appId:c,status:true,cookie:true,xfbml:true,channelUrl:window.location.protocol+"//"+window.location.hostname+a,frictionlessRequests:true,oauth:d});ta.support.Facebook.ready=true;ta.support.Facebook.dequeueForFBReady();if(!ta.retrieve("facebook.disableLogin")){if(ta.retrieve("facebook.skip.session.check")=="true"){ta.support.Facebook.sessionAvailable()}else{FB.getLoginStatus(ta.support.Facebook.onLoginStatus)}}else{if(!ta.has("facebookuserid")){ta.support.Facebook.sessionUnavailable()}}},transformToAuthResponse:function(c){var a=ta.retrieve("facebook.authFailed");var d=ta.retrieve("facebook.authSuccess");var b=c.authResponse;if(!b){if(a){a()}return null}if(c.status=="connected"){b.uid=ta.store("fb.auth.userId",b.userID);b.token=ta.store("fb.auth.token",b.accessToken);if(d){d()}return b}if(a){a()}return null},onLoginStatus:function(b){var a=ta.support.Facebook.transformToAuthResponse(b);if(a){if(ta.has("cached.facebookuid")&&ta.retrieve("cached.facebookuid")!=a.uid){ta.store("facebook.preFailed",true);ta.store("facebook.AuthCode.onAvail.needsReload",function(){window.location.reload()});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}if(ta.retrieve("facebook.invalidFBCreds")&&!ta.retrieve("facebook.signout.process")){ta.store("facebook.AuthCode.onAvail",ta.support.Facebook.sessionAvailable);ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}else{ta.support.Facebook.sessionAvailable()}}else{if(!ta.retrieve("facebook.invalidFBCreds")){ta.store("facebook.preFailed",true);setOneTimeCookie("FacebookAuthCode","NoFBSessionAvailable");new Request({url:"/ActionRecord?action=fb_cached_token_no_session"}).send()}ta.support.Facebook.sessionUnavailable()}},initData:function(a){if(ta.remove("facebook.data.initialRequest.failed")){ta.support.Facebook.loadData({pre:a})}else{ta.util.pending.lock("facebook.data.initialRequest",ta.support.Facebook.loadData.partial({pre:a}))}},loadData:function(b){if(!ta.has("facebook.data.request")){return}ta.support.Facebook.timing.setBeginPartials();var a=ta.retrieve("facebook.data.request");if(!ta.has("facebook.connectBar-counted")&&ta.retrieve("facebook.showWelcomeBar")){if(!b.pre){ta.store("facebook.connectBar-counted",true);FB.api({method:"connect.shouldShowConnectBar"},function(c){if(c==2){a.erase("IP_BAR");a.include("USER_PROFILE_ACTION");ta.merge("facebook.data.params",{bar:"off"})}ta.util.partials.requestPartials(a,Object.merge({},b,ta.retrieve("facebook.data.params")),"facebook",ta.support.Facebook.dataAvailable)})}else{ta.store("facebook.data.initialRequest.failed",true)}}else{ta.util.partials.requestPartials(a,Object.merge({},b,ta.retrieve("facebook.data.params")),"facebook",ta.support.Facebook.dataAvailable)}},receiveCode:function(d){var a=ta.retrieve("facebook.AuthCode.onAvail");if(a!=null){ta.store("facebook.authcode.param",d);setOneTimeCookie("FacebookAuthCode",d);a()}var c=ta.retrieve("facebook.AuthCode.onAvail.needsReload");if(c!=null){setOneTimeCookie("FacebookAuthCode","ConflictedFBAccount");c()}var b=ta.retrieve("facebook.AuthCode.onAvail.paging");if(b!=null){ta.store("facebook.authcode.param",d);setOneTimeCookie("FacebookAuthCode",d);b()}},getCodeFromOAuthResponse:function(b){var d=ta.support.Facebook.parseFBSignedRequest(b.signedRequest).code;var c=ta.remove("facebook.taServerTime");var a=c-3600;var f=null;if(d&&!isNaN(a)){f=d.split(".")}if(f!=null&&f.length>3&&!isNaN(f[3])&&f[3]<a){ta.util.error.record(null,"Facebook sending up expired Code: ",null,{code:d,serverTime:c})}return d},parseFBSignedRequest:function(c){if(!c){return null}var a=c.split(".",2);var d=a[1];if(d){var b=ta.util.decoder.base64Decoder(d);try{return JSON.decode(b)}catch(f){ta.util.error.record(null,"couldn't parse Facebook SignedRequest to JSON object after decode ",null,{signedRequest:c,decoded:b})}}else{ta.util.error.record(null,"Facebook SignedRequest TA received doesn't contain data",null,{signedRequest:c})}},preemptiveRegex:/<\!-- PREEMPTIVE RESPONSE -->/,noOauthTokenRegex:/<\!-- no Oauth Token -->/,limitOfTry:4,dataAvailable:function(c,a,b,f,d,h){if(a.match(ta.support.Facebook.preemptiveRegex)&&ta.remove("facebook.preFailed")){return}if(a.match(ta.support.Facebook.noOauthTokenRegex)){delete f.pre;var g=ta.util.partials.requestPartials.partial(b,f,d,h);ta.store("facebook.AuthCode.onAvail",g);ta.support.Facebook.tryRegetOauthToken()}ta.store("facebook.data.handler",c);ta.util.pending.unlock("facebook.data.canDisplay")},tryRegetOauthToken:function(){var a=ta.retrieve("fb.noOauthToken.counter");if(a==null){a=0}if(a<ta.support.Facebook.limitOfTry){ta.store("fb.noOauthToken.counter",a+1);FB.getLoginStatus(ta.support.Facebook.checkStatusAndGetCode)}},checkStatusAndGetCode:function(b){var a=ta.support.Facebook.transformToAuthResponse(b);if(a){ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}},pageDataAvailable:function(f,b,d,a){var c=ta.util.partials.handlePartialPaging.partial(f,b,d);ta.store("facebook.AuthCode.onAvail.paging",c);ta.support.Facebook.tryRegetOauthToken()},showData:function(){ta.remove("facebook.data.handler")();ta.support.Facebook.timing.recordEndTimes()},markAvailable:function(){ta.store("facebook.available",true);if(ta.has("facebook.onAvail")){ta.remove("facebook.onAvail").each(function(a){a()})}},sessionAvailable:function(){var a=ta.retrieve("facebook.session.available");ta.store("facebook.session.available",true);ta.support.Facebook.timing.recordLoadTime();if(ta.has("facebook.onSessionAvail")){ta.remove("facebook.onSessionAvail").each(function(b){b()})}if(!a){ta.util.pending.unlock("facebook.data.canDisplay")}ta.support.Facebook.initData(false)},sessionUnavailable:function(){ta.store("facebook.session.available",false);ta.support.Facebook.timing.recordLoadTime();if(ta.has("facebook.onSessionUnavail")){ta.remove("facebook.onSessionUnavail").each(function(a){a()})}$$("#HEAD .FB_login_button").forEach(function(a){a.addEvent("click",function(){new Request({url:"/ActionRecord?action=FBC_Masthead"}).send()})});$$("#WoF_SigninLander .fbcBtnsmall").forEach(function(a){a.addEvent("click",function(){new Request({url:"/ActionRecord?action=WoF_SigninLander"}).send()})})},havePermission:function(b,d,c){var a=ta.retrieve("facebook.permissions");if(a){if(a.indexOf(b)==-1){return c?c():null}return d?d():null}else{FB.api({method:"users.hasAppPermission",ext_perm:b},function(f){if(f!=0){if(d){d()}}else{if(c){c()}}})}},requirePermission:function(a,c,b){ta.support.Facebook.login([a],c,b)},ifLoggedIn:function(b,a){if(ta.retrieve("facebook.session.available")&&b){b()}else{if(a){a()}}},loginButton:function(b,a){ta.support.Facebook.login()},login:function(f,h,a,g,c){f=Array.from(f||[]);if(c!=null&&c.length>0){ta.store("facebook.flow",c)}else{ta.store("facebook.flow","FBC")}if(!userLoggedIn||!userFbConnected||g){ta.support.Facebook._doLogin(f,h,a,g);return}var j=[];for(var d=0;d<f.length;d++){j.push(ta.support.Facebook.havePermission.partial(f[d]))}function b(){if(h){h()}}Function.executeContinuations([ta.support.Facebook.ifLoggedIn].concat(j).concat([b]),ta.support.Facebook._doLogin.partial(f,h,a))},_doLogin:function(b,g,a,d){var f=["email","user_education_history","friends_education_history","user_events","friends_events","user_hometown","friends_hometown","user_likes","friends_likes","user_location","friends_location","user_work_history","friends_work_history","user_checkins","friends_checkins","friends_photos","publish_actions"];var c=d;FB.login(function(j){var h=ta.support.Facebook.transformToAuthResponse(j);if(h){if(h.token){ta.support.Facebook.havePermission("email",function(){ta.support.Facebook.setResultPID();ta.store("facebook.AuthCode.onAvail",function(){ta.support.Facebook.fbcRegistration(c,g)});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(h))},function(){ta.util.error.record(null,"user did not grant email permission, user fbid is:"+h.uid,null,{},"WARN")})}else{if(a){a()}}}},{scope:f.join(",")})},setResultPID:function(){var a=ta.retrieve("facebook.trackingpid");if(a){ta.util.cookie.setPIDCookie(a)}},fbcRegistration:function(a,c){var b=!ta.retrieve("facebook.session.available")||!userLoggedIn||!userFbConnected;if(a!=null){b=b||a}if(b){ta.store("facebook.session.available",true);ta.store("registration.action","FB_CONNECT");ta.run("ta.overlays.registration.logAndPost",{},{flow:ta.retrieve("facebook.flow")},"FBC-start",{action:"FB_CONNECT"})}if(c){c()}},loginWithFlow:function(a,b){ta.store("facebook.flow",a);ta.support.Facebook.login(null,null,null,b)},logout:function(){FB.logout(function(){window.location.reload()})},restart:function(){FB.logout(function(){ta.overlays.registration.post({action:"FB_LOGIN"})})},revoke:function(){FB.api({method:"Auth.revokeAuthorization"})},postWall:function(j,g,l,f,c,p,h,d,m,a,k,o,b){FB.ui({method:"feed",message:j,picture:p,link:g,name:l,to:m,caption:f,description:c,display:a,properties:k,actions:[{name:h,link:d}]},function(q){if(q&&q.post_id){if(o){o(q)}}else{if(q&&!q.post_id){ta.util.error.record(null,"Facebook postWall error response from facebook",null,null)}else{if(b){b(q)}}}})},publishStream:function(f,a,h,j,c,g,b,d){FB.login(function(l){var k=ta.support.Facebook.transformToAuthResponse(l);if(k){if(k.token){new Request({url:"/ActionRecord?action=POSTTOWALL_GRANTED"}).send();ta.support.Facebook.postWall(f,a,h,j,c,g,b,d)}}},{scope:"publish_stream"})},loginRequestSpecificPermission:function(b,c,a){FB.login(function(f){var d=ta.support.Facebook.transformToAuthResponse(f);if(d){if(d.token){ta.store("facebook.AuthCode.onAvail",function(){ta.support.Facebook.fbcRegistration(null,c)});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(d))}else{if(a){a()}}}},{scope:b})},loginWithFlowAndRequest:function(b,c,d,a){ta.store("facebook.flow",b);ta.support.Facebook.loginRequestSpecificPermission(c,d,a)}};ta.support.IPTiming=new Class({initialize:function(){this.active=ta.has("facebook.iptiming");if(this.active){this.timers=ta.retrieve("facebook.iptiming")}else{}},recordLoadTime:function(){if(this.active){this.sendActionRecord("LoadPage",this.timers.loaded-this.timers.started)}},setBeginPartials:function(){if(this.active&&!this.timers.partials){this.timers.partials=new Date().getTime()}},recordEndTimes:function(){if(this.active){var a=new Date().getTime();this.sendActionRecord("GetPartials",a-this.timers.partials);this.sendActionRecord("LoadAll",a-this.timers.started)}},sent:{},sendActionRecord:function(c,a){if(this.sent[c]){return}this.sent[c]=true;a=Math.round(a/1000);var b;if(a<=10){b=a.toString()}else{if(a>10&&a<=15){b="11-15"}else{if(a>15&&a<=20){b="16-20"}else{b="21+"}}}c+="_";c+=ta.retrieve("facebook.session.available")?"IP_":"NonIP_";c+=b+"_"+this.timers.servletName;if(this.timers.firstPage){c+="_FirstPage"}ta.util.action.record(c)}});(function(a){a.util||(a.util={});var b=function(c){this.constructor=c};a.util.extend=function(h){var d={};var j,k,g,f,c;for(f=1,c=arguments.length;f<c;f++){k=arguments[f];for(g in k){if(k.hasOwnProperty(g)){d[g]=k[g]}}if(k.hasOwnProperty("constructor")){d.constructor=k.constructor}}j=d.hasOwnProperty("constructor")?d.constructor:function(){return h.apply(this,arguments)};b.prototype=h.prototype;j.prototype=new b(j);j.prototype.__super__=h.prototype;for(g in d){j.prototype[g]=d[g]}return j}}(ta));(function(c){c.fb||(c.fb={});var b=new RegExp(["User is already associated","Permissions error"].join("|"));var a=new RegExp(["Timeline is not activated","Requires extended permission","An unexpected error has occurred","An unknown error has occurred","load-error: unknown","Error validating access token","Object at URL.*requires an object of og:type","Could not retrieve data from URL","^unknown error"].join("|"));c.fb.graph={api:function(j,l,k,g){var f=Array.prototype.slice.call(arguments);var d=c.util.Deferred();l||(l="get");k||(k={});g||(g={});g.recordErrors=(g.recordErrors!==false);(function h(m){FB.api(j,l,k,function(p){if(p&&!p.error){d.resolve(p)}else{var q={name:"None",message:"No FB.api response"};var o="ERROR";if(p&&p.error){q.name=p.error.type;q.message=(typeof p.error==="string")?p.error:p.error.message}if(m&&q.message.match("has og:type of '(?:tripadvisortravelmap|civ)")){k.scrape=true;h(false);return}if(a.test(q.message)){o="WARN"}if(g.recordErrors&&!b.test(q.message)){this.recordError(q,{FB_API_ARGS:f,FB_API_RESPONSE:p,FB_AUTH_RESPONSE:FB.getAuthResponse()},o)}d.reject(q)}}.bind(this))}.call(this,true));return d.promise()},remove:function(f,d){d||(d={});d.method="delete";return this.api("/"+f,"delete",d)},recordError:function(f,g,d){if(c.util.error){c.util.error.record(f,"ta.fb.graph.api",null,g,d)}return this}}}(ta));(function(a){a.fb.graph.Base=a.util.extend(Object,{constructor:function b(d,c){this.set(d);this.options=c||{}},set:function(d){for(var c in d){d.hasOwnProperty(c)&&(this[c]=d[c])}return this},api:function(c,g,f){if(!(this.id&&this.accessToken)){var d={name:"Missing auth credentials",message:"Facebook Graph object API calls require an id and access token"};a.fb.graph.recordError(d,{FB_ID:this.id,FB_ACCESS_TOKEN:this.accessToken,FB_API_ARGS:arguments},"WARN");return a.util.Deferred().reject(d)}c||(c="");if(/^\//.test(c)){c=c.slice(1)}f||(f={});f.access_token=this.accessToken;return a.fb.graph.api("/"+this.id+"/"+c,g,f)}})}(ta));(function(a){a.fb.graph.mixin||(a.fb.graph.mixin={});var c=true;var b=new RegExp(["Timeline is not activated","Requires extended permission"].join("|"));a.fb.graph.mixin.OpenGraph={recordOpenGraph:function(f){var d=this.options.MapAction;if(d){Math.random()>0.2||d.record(f)}return this},getActions:function(d){return this.api(this.options.appName+":"+d)},publishAction:function(k,h,g,f){if(!c){return a.util.Deferred().reject("Publishing open graph actions is disabled.")}var d=this.options.appName;var j=this.options.ref;f||(f={});f[h]="http://"+this.options.hostname+g;if(j){f.ref=j}delete f.place;var l=this.api(d+":"+k,"POST",f).success(function(){this.recordOpenGraph("OpenGraph_"+k)},this).failure(function(m){if(b.test(m.message)){c=false}});return l},publishLocatedAction:function(h,g,f,d){d||(d={});d.place="http://"+this.options.hostname+f;return this.publishAction(h,g,f,d)},scrape:function(d){return a.fb.graph.api("/","post",{id:d,scrape:true})}}}(ta));(function(a){a.fb.graph.User=a.util.extend(a.fb.graph.Base,a.fb.graph.mixin.OpenGraph)}(ta));(function(a){var b=10000;a.fb.graph.TAUser=a.util.extend(a.fb.graph.User,{pin:function(c,g,h){var m=a.util.Deferred();var f=false;var d,j,k,o;if(c){d=/^g(?:eo)?/.test(c.type)?"city":/^a(?:ttraction)?/.test(c.type)?"attraction":/^e(?:atery)?/.test(c.type)?"restaurant":/^h(?:otel)?|^lodging/.test(c.type)?"hotel":null;j=c.url}if(!(d&&c.url&&g&&g.length)){return m.reject()}k=!!(this.location&&this.location.latitude&&this.location.longitude);o=!!(this.hometown&&this.hometown.latitude&&this.hometown.longitude);var l=Array.prototype.each?"each":"forEach";g[l](function(q,r){var t=q=="been"?"pin":q;var s={};if(t=="pin"){var p={};var u;if(k){p.lat=this.location.latitude;p.lng=this.location.longitude}else{if(o){p.lat=this.hometown.latitude;p.lng=this.hometown.latitude}}u=a.travelmap.util.getDistance(c,p,this.locale);if(u){s.distance=u.value;s.distance_unit=u.unit;s.cur_loc_used=k}}else{if(t=="going"){s.end_time="5000-01-01"}}if(h||(t=="pin"&&g.length>1)){s.no_feed_story=1}this.publishLocatedAction(t,d,j,s).failure(function(){f=true}).success(function(v){if(r==g.length-1){m[f?"reject":"resolve"]()}})},this);return m.promise()},rate:function(c){var g="rate";var f="attraction";var d=c.url;return this.publishLocatedAction(g,f,d)},earnBadge:function(c){var g="earn";var f="badge";var d="/MemberTravelMap?ns=badge&badgeId="+c;return this.publishAction(g,f,d)},updateMap:function(){this._needToScrapeMap=true;if(this._intervalID){return a.util.Deferred().resolve()}this._intervalID=window.setInterval(this.scrapeMap.bind(this),b);return this.options.MapAction.getTravelMapMetaData().always(function(c){var h="publish";var g="map";var f="/MemberTravelMap?ns=map&uid="+this.options.guid;var d;if(c&&c.tmTotalDistance){d={total_distance:Math.round(c.tmTotalDistance),distance_unit:c.tmDistanceUnit}}return this.publishAction(h,g,f,d)},this)},scrapeMap:function(c){if(this._needToScrapeMap||c){this._needToScrapeMap=false;return this.scrape("http://"+this.options.hostname+"/MemberTravelMap?ns=map&uid="+this.options.guid)}return a.util.Deferred().resolve()}})}(ta));ta.common.wisdomoffriends={reloadASAP:function(){window.location.reload()},showWelcome:function(){ta.store("wof.showWelcome",true)}};if(!ta.popups){ta.popups={}}ta.popups.PopUtil={windowType:{CHECK_RATE:0,PROV_WIN:1,HOLDING:2,COMMERCE:3,VFM:4},taPopunderSlots:null,taPopupSlots:null,taHoldingWindowCap:2,taPopWindowSet:[],taWindowCount:0,getAndUpWindowCount:function(){return this.taWindowCount++},tryHoldingWindows:function(b,a){try{var g=true;for(var c=0;c<a;c++){var f=this.launchHoldingWindow(b);if(!f.windowObject){g=false}}if(g){return true}}catch(d){ta.util.error.record(d,"try two hw",b)}return false},getPopunderSlots:function(){if(this.taPopunderSlots===null){this.taPopunderSlots=new ta.popups.PopunderSlotSet()}return this.taPopunderSlots},getPopupSlots:function(){if(this.taPopupSlots===null){this.taPopupSlots=new ta.popups.PopupSlotSet()}return this.taPopupSlots},createCheckRatesWindow:function(a){return this.buildNewWindow(this.windowType.CHECK_RATE,a)},createHoldingWindow:function(a){return this.buildNewWindow(this.windowType.HOLDING,a)},createVFMWindow:function(a){return this.buildNewWindow(this.windowType.VFM,a)},buildNewWindow:function(b,c){var a=new ta.popups.TAPopWindow(b,c);if(!a){return false}if(!a.errorOpening&&!a.errorMoving&&a.windowObject){this.taPopWindowSet[this.taPopWindowSet.length]=a;return a}return false},getHoldingWindowSet:function(){var d=[];for(var b in this.taPopWindowSet){var a=this.taPopWindowSet[b];if(a&&a.type==this.windowType.HOLDING){var c=a.windowObject;if(c&&"closed" in c&&!c.closed){d[d.length]=a}}}return d},attemptHoldingWindowWNumChecked:function(f,b,a,d){var g=new ta.commerce.CheckRatesData({type:d,evnt:f},b,a,true);var c=g.getVendorSet().getCheckedInfo("count");if(this.getHoldingWindowSet().length<(c-1)){this.launchHoldingWindow(b)}},attemptHoldingWindow:function(a){if(this.taHoldingWindowCap>this.getHoldingWindowSet().length){this.launchHoldingWindow(a)}},launchHoldingWindow:function(b){if(b.className.match(/popEnabled/)||b.id.match(/CHECK_RATE/)){var a=b.id.match(/check\w+_(\d+)/);if(!a){a=b.className.match(/id_(\d+)/)}if(a&&a[1]){a=a[1]}else{return false}var c=ta.retrieve("checkrates.holdingWindowURI");if(c){var d={url:c};return this.createHoldingWindow(d)}}return false},popunderReminder:function(b){var a={windowHook:b};this.createHoldingWindow(a)},getProviderWindowDims:function(a,d){var b=null;var g=null;var f=null;var c=null;if(a=="hotels.com"){b=975}if(screen.width>=1280){b=1000;g=897;if(!d){f=0;c=0;if(Browser.chrome){g-=50}else{if(Browser.firefox){g-=87}else{if(Browser.ie){b-=12;g-=179}}}}}return{customWidth:b,customHeight:g,widthOffset:f,heightOffset:c}}};ta.popups.TAPopWindow=new Class({Implements:Options,options:{name:"TAWin",url:"",windowHook:false,customWidth:false,customHeight:false,toolbar:1,location:1,directories:1,status:1,menubar:ta.browser.isIE9orHigher()?0:1,resizable:1,copyhistory:1,scrollbars:1,alwaysRaised:false,alwaysLowered:false,widthOffset:8,heightOffset:164,delayLoad:false},initialize:function(c,b){this.setOptions(b);this.type=c;this.assignSlot();if(this.options.customWidth){this.width=this.options.customWidth}if(this.options.customHeight){this.height=this.options.customHeight}if(this.options.widthOffset!=null){this.widthOffset=this.options.widthOffset}if(this.options.heightOffset!=null){this.heightOffset=this.options.heightOffset}if(this.options.delayLoad){this.delayLoad=this.options.delayLoad}if(this.options.windowHook){this.windowObject=this.options.windowHook;this.windowObject.refresh();return true}if(ta.has("checkrates.chrome_dates_entry_holding")){this.options.scrollbars=0}this.url=this.options.url;this.assignWinArgs();try{if(this.type==ta.popups.PopUtil.windowType.HOLDING){ta.util.cookie.setPIDCookie(28962)}this.windowObject=window.open("","_blank",this.winArgs);var a=this.windowObject;if(a&&this.isTAWindow()){if(!this.delayLoad){a.location=this.url}}}catch(d){this.errorOpening=d;ta.util.error.record(this.errorOpening,"pop window opening failure",null,{type:this.type,url:this.url})}try{var a=this.windowObject;if(a&&this.isTAWindow()){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.moveBehindMain(a)}}}catch(d){this.errorMoving=d;ta.util.error.record(this.errorMoving,"popunder window moving",null,{type:this.type,url:this.url})}},repurpose:function(d,b,f){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.type=ta.popups.PopUtil.windowType.CHECK_RATE;this.slot.occupied=false;this.assignSlot();this.url=d;if(b){this.width=b;this.options.widthOffset=0}if(f){this.height=f;this.options.heightOffset=0}var a=this.windowObject;if(a&&this.isTAWindow()){try{a.resizeTo(this.width+this.options.widthOffset,this.height+this.options.heightOffset);a.moveTo(this.x,this.y);if(!this.delayLoad){a.focus()}if(!this.delayLoad){a.location=this.url}}catch(c){ta.util.error.record(this.errorMoving,"repurpose popunder fail",null,{type:this.type,url:this.url})}}return this}return false},assignWinArgs:function(){this.winArgs="toolbar="+this.options.toolbar;this.winArgs+=",location="+this.options.location;this.winArgs+=",directories="+this.options.directories;this.winArgs+=",status="+this.options.status;this.winArgs+=",menubar="+this.options.menubar;this.winArgs+=",resizable="+this.options.resizable;this.winArgs+=",copyhistory="+this.options.copyhistory;this.winArgs+=",scrollbars="+this.options.scrollbars;this.winArgs+=",width="+this.width;this.winArgs+=",height="+this.height;this.winArgs+=",left="+this.x;this.winArgs+=",top="+this.y;this.winArgs+=",screenx="+this.x;this.winArgs+=",screeny="+this.y;if(this.options.alwaysRaised){this.winArgs+=",alwaysRaised"}if(this.options.alwaysLowered){this.winArgs+=",alwaysLowered"}},assignSlot:function(){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.slot=ta.popups.PopUtil.getPopunderSlots().getOpenSlot();this.width=this.slot.tw;this.height=this.slot.th;this.x=this.slot.tx;this.y=this.slot.ty}else{this.slot=ta.popups.PopUtil.getPopupSlots().getOpenSlot();this.width=this.slot.w+this.options.widthOffset;this.height=this.slot.h+this.options.heightOffset;this.x=this.slot.x;this.y=this.slot.y}this.slot.occupied=this},moveBehindMain:function(c){if(ta.has("checkrates.chrome_dates_entry_holding")){try{var a=window.open("about:blank");if(a){a.focus();a.close()}}catch(b){ta.util.error.record(b,"holdingWindow - Chrome blur failed")}}c.blur();c.opener=self;c.moveTo(this.slot.x,this.slot.y);c.resizeTo(this.slot.w,this.slot.h);if(!this.delayLoad){c.location=this.url}window.focus()},isTAWindow:function(){var c=true;try{var a=this.windowObject.location;this.windowObject.status="";if(a==null||a==""){c=false}}catch(b){c=false}return c}});ta.popups.Slot=new Class({initialize:function(c,b,d,a){this.x=c;this.y=b;this.w=d;this.h=a;this.occupied=null}});ta.popups.SlotSet=new Class({initialize:function(){this.nW=525;this.nH=460;this.nXI=24;this.nYI=24;this.totalSlots=20;this.slots=[];try{if(screen.width>1024){this.nW=800;this.nH=600;this.nXI=80;this.nYI=40}else{if(screen.width>800){this.nW=620;this.nH=500;this.nXI=60;this.nYI=30}}}catch(a){this.error=a;ta.util.error.record(this.error,"slot set",null,{"slot set":"general"})}},getUsedCount:function(){var b=0;if(this.slots){for(var a=0;a<this.slots.length;a++){if(this.slots[a].occupied&&!this.slots[a].occupied.closed){b++}}}return b},getOpenSlot:function(f){if(!f||f<0||f>this.totalSlots){f=0}var d=function(m){try{var h=false;var k=false;try{k=this.slots[m].occupied}catch(l){}if(!k){h=true}else{try{var g=k.windowObject;if(!g||g.closed){h=true}}catch(l){h=true}}}catch(l){ta.util.error.record(l,"get open slot - get pop slot",null,{totalSlots:this.totalSlots,slotNumber:m})}if(h){this.slots[m].occupied=null;var j=this.slots[m];j.slotPos=m;return j}return false}.bind(this);try{for(var a=f-1;a>=0;a-=1){var c=d(a);if(c){return c}}for(var a=f;a<this.slots.length;a++){var c=d(a);if(c){return c}}}catch(b){ta.util.error.record(b,"get open slot",null,{totalSlots:this.totalSlots})}return false}});ta.popups.PopunderSlot=new Class({Extends:ta.popups.Slot,initialize:function(b,k,d,g,c,a,f,j){this.parent(b,k,d,g);this.tx=c;this.ty=a;this.tw=f;this.th=j}});ta.popups.PopupSlotSet=new Class({Extends:ta.popups.SlotSet,initialize:function(){this.parent();this.nX=500;try{if(screen.width<=1024){this.nX=(!isNaN(window.screenLeft)?window.screenLeft:!isNaN(window.screenX)?window.screenX:0)+472}this.nY=!isNaN(window.screenTop)?window.screenTop:!isNaN(window.screenY)?window.screenY:0}catch(b){this.error=b;this.nY=0;ta.util.error.record(this.error,"slot set",null,{"slot set":"popup"})}for(var a=0;a<this.totalSlots;a++){this.slots[a]=new ta.popups.Slot(this.nX,this.nY,this.nW,this.nH);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}});ta.popups.PopunderSlotSet=new Class({Extends:ta.popups.PopupSlotSet,initialize:function(){this.parent();try{this.nX=(window.screenLeft||window.screenX);this.nY=(window.screenTop||window.screenY)}catch(b){this.error=b;this.nX=200;this.nY=200}this.w=1;this.h=1;this.x=5000;this.y=5000;this.totalSlots=4;try{if(Browser.ie7){this.w=250;this.h=100}if(Browser.safari||Browser.chrome){this.w=85;this.h=100}if(typeof(this.nX)=="undefined"){this.nX=0;this.nY=0;this.x=this.nX+window.screen.availWidth-this.w;this.y=this.nY+window.screen.availHeight-this.h}else{this.x=this.nX+window.getWidth()-this.w;this.y=this.nY+window.getHeight()-this.h}if(Browser.ie7){this.y=this.y-95;this.x=this.x+13}else{if(Browser.safari||Browser.chrome){this.y=this.y-16}}}catch(b){this.error=b}if(this.error){ta.util.error.record(this.error,"slot set",null,{"slot set":"popunder"})}for(var a=0;a<this.totalSlots;a++){this.slots[a]=new ta.popups.PopunderSlot(this.nX,this.nY,this.nW,this.nH,this.x,this.y,this.w,this.h);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}});window.setupLazyLoad=function(){var a=new LazyLoad({range:200},lazyImgs,lazyHtml);return a};var LazyLoad=new Class({Implements:[Options,Events],options:{range:200,fireScroll:true,mode:"vertical"},initialize:function(p,m,q){this.setOptions(p);this.container=window;var b=(this.options.mode=="vertical"?"y":"x");this.containerDimension=this.container.getSize()[b];this.start=0;var l=this.containerDimension+this.options.range;var k=ta.retrieve("ta.commerce.obf");if(k){try{var h=k.given.split("");var f=k.replace.split("");var d=k.token}catch(j){ta.util.error.record(j,"obfuscation object corrupted")}}var o=0;this.htmlBlocks=q.filter(function(t){var s=ta.id(t.id);if(s&&(s.getPosition()[b]>l&&t.scroll)){o++;return true}else{if(s){try{var w=t.data.indexOf(d);if(k&&w==0){var u=t.data.substr(d.length).split("");for(var r=u.length;r--;){var v=u[r];var w=f.indexOf(v);if(w!=-1){u[r]=h[w]}}s.innerHTML=u.join("")}else{s.innerHTML=t.data}}catch(y){ta.util.error.record(y,"lazy html",null,{id:t.id})}return false}else{return false}}},this);var c=0;this.images=m.filter(function(s){var r=ta.id(s.id);if(r){r.oSRC=s.src||s.data;r.priority=s.priority||1000;if((!r.isVisible()||r.getPosition()[b]>l)&&s.scroll){c++;return true}else{ta.queueLazyImg(r);return false}}else{return false}},this);ta.processLazyImages();var a=function(){var r=this.getScroll();if(r>this.start){this.load();this.start=r}this.fireEvent("scroll");if(!this.images.length){this.container.removeEvent("scroll",a);this.fireEvent("complete")}}.bind(this);this.load=function(){this.htmlBlocks=this.htmlBlocks.filter(function(s){try{var r=ta.id(s.id);if((r&&r.getPosition&&((this.getScroll()+this.options.range+this.containerDimension)>=r.getPosition()[b]))||(r&&!r.getPosition)){r.innerHTML=s.data;return false}}catch(t){ta.util.error.record(t,"lazy",null,{id:s.id})}return true},this);this.images=this.images.filter(function(s){try{var r=ta.id(s.id);if((r&&r.getPosition&&((this.getScroll()+this.options.range+this.containerDimension)>=r.getPosition()[b]))||(r&&!r.getPosition)){ta.queueLazyImg(r);return false}}catch(t){ta.util.error.record(t,"lazy",null,{src:s.src})}return true},this);ta.processLazyImages()}.bind(this);var g=function(){var r=this.container.getSize()[b];if(r>this.containerDimension){this.containerDimension=r;this.load()}}.bind(this);this.container.addEvent("scroll",a);this.container.addEvent("resize",g);if(this.options.fireScroll){this.container.fireEvent("scroll")}},getScroll:function(){if(this.container&&this.container.getScroll){return this.container.getScroll()[this.options.mode=="vertical"?"y":"x"]}else{return 9000}}});var sTAMGFooterCookieName="hideTAMGFooter";var sFooterDivId="TM_FTR";var hmOngoingHover={};var savedDomain="tripadvisor.com";if(typeof cookieDomain!="undefined"){savedDomain=cookieDomain.substring(1,cookieDomain.length)}function _closeOverlay(){var a=ta.retrieve("overlays.current");if(a){a.hide()}}function setTAMGFooterCookie(c){var b=new Date();b.setTime(b.getTime());var d=1000*60*60*24*7;var a=new Date(b.getTime()+(d));document.cookie=sTAMGFooterCookieName+"="+escape(c)+";expires="+a.toGMTString()+";path=/"+((savedDomain)?";domain="+savedDomain:"");hideFooter()}function openUrl(b){var a=window.open(b);a.opener=null}function getTAMGFooterCookie(){var f=document.cookie.split(";");var a="";var c="";var d="";var b=false;for(i=0;i<f.length;i++){a=f[i].split("=");c=a[0].replace(/^\s+|\s+$/g,"");if(c==sTAMGFooterCookieName){b=true;if(a.length>1){d=unescape(a[1].replace(/^\s+|\s+$/g,""))}return d;break}a=null;c=""}if(!b){return null}}function hideFooter(){var a=document.getElementById(sFooterDivId);if(a){a.style.display="none"}}function tamgShowFly(c,d,b,a){hmOngoingHover[d]=true;setTimeout(function(){if(hmOngoingHover[d]){tamgCreateFly(c,b,a)}},250)}function tamgHideFly(a,c,b){var d=b.toElement||b.relatedTarget;while(d&&d!=a){d=d.parentNode}if(d!=a){hmOngoingHover[c]=false;setTimeout(function(){if(hmOngoingHover[c]==false){$$("."+c)[0].hide()}},250)}}function tamgCreateFly(h,k,f){var g=$(h).getElements(".ftrFly")[0];if($(g).getElements("img")[0]){g.show()}else{var l=CDNHOST+"/img2/x.gif";var j="ftrFlyLogo "+k;var d=new Element("img",{"class":j,src:l}).inject(g,"top");d.setProperty("height","25");d.setProperty("width",f);var c=new Element("div",{"class":"triWrap"});var b=new Element("span",{"class":"cssTri"});var a=new Element("span",{"class":"cssTri"});b.inject(a);a.inject(c);c.inject(g,"bottom");g.show()}}function getTAMGFooterViaAjax(d,c,a,b){new Request({url:"/TAMGFooterAjax",onSuccess:function(f){ta.id("TAMGFooterHolder").innerHTML=f},data:{a:"SHOW_FOOTER",dis:d,loc:c,"new":a,serv:b},evalScripts:true,method:"get"}).send()}ta.servlet.Member={memberBenefitsSubscribe:function(a){ta.servlet.Member.processMOSubscribeRequest(a);return false},memberGuideRequest:function(a){processGuideRequest(a)},memberTOGForm:function(a){processTOGForm(a)},processMOSubscribeRequest:function(a){if(!loggedIn){new Event(a).preventDefault();return false}var d=$("MEMONLY_SUBS_FORM");d.elements.action.value="subscribe";var c={url:"/TravelGuides",data:d,onFailure:function(f){alert(f.status+"\n"+f.responseText)}};c.onSuccess=ta.servlet.Member.subscribeRequestResFunc;var b=window["validate"+d.id];new Event(a).preventDefault();new Request(c).send()},subscribeRequestResFunc:function(a){if(a!=""){for(subtype in subtypes){if(subtyperes[subtype].test(a)){if(subtype=="tw"&&ta.retrieve("tcd.refresh")){window.location.reload()}var h=document.getElementById(subtype+"Optin");h.setAttribute("checked","true");h.setAttribute("disabled","true");var c=document.getElementById(subtype+"OptinLbl");c.innerHTML="<b>"+headings[subtype]+"</b> "+tamg_thanks;var g=document.getElementById("OPTINTEXT");g.style.display="none"}}var l={};for(subtype in subtypes){var d=document.getElementById(formids[subtype]);l[subtype]=d.checked}var j=true;var k=true;for(subtype in l){if(subtyperes[subtype].test(a)){j=false}if(!l[subtype]){k=false}}if(k){var f=document.getElementById("NLSUBMITDIV");f.style.display="none"}if(j){var b=document.getElementById("OPTINTEXT");b.innerHTML='<div class="alert">'+no_selection_error+"</div>";b.style.display="block"}}},addTripWatchLocation:function(event,elmt,updateTxt){var mElmt=new Element(elmt);new Event(event).stop();new Request({url:elmt.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocation"),onSuccess:function(txt,xml){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){ta.overlays.showInLightbox(data.ERROR);return}else{if(data.ALERT){ta.overlays.showInLightbox(data.ALERT);return}}}var spanElt=new Element("span");spanElt.set("html",updateTxt);mElmt.hide();spanElt.inject(mElmt,"after")}}).send()},addTripWatchLocationReload:function(a){new Request({url:a.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocationReload"),onSuccess:function(b,c){window.location.reload()}}).send()}};ta.servlet.Tourism={bbOfferClicked:function(b,a){b.preventDefault();a=$(a);if(a.get("tag")!="tr"||!a.hasClass("offerRow")){a=a.getParent("tr.offerRow")}offerLink=a.getElement("a");popCommFN=linkMap.js_popComm;popCommFN(offerLink,b)},showGeoDescription:function(b,a){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 dg descriptionLB",content:"<p>"+ta.id("DESCRIPTION_TEXT").get("text")+"</p>"})},styleButtonOver:function(a){if(ta.id(a.target).hasClass("sprite-hotelStyleBack")){ta.id(a.target).removeClass("sprite-hotelStyleBack");ta.id(a.target).addClass("sprite-hotelStyleBackHover")}},styleButtonOut:function(a){if(ta.id(a.target).hasClass("sprite-hotelStyleBackHover")){ta.id(a.target).removeClass("sprite-hotelStyleBackHover");ta.id(a.target).addClass("sprite-hotelStyleBack")}},parseHashParams:function(c){var b={};try{var a=c.indexOf("#");if(a>-1){var g=c.substr(a+1).split("&");for(var f=0;f<g.length;f++){var j=g[f].split("=");var d=j[0];if(d!=null&&d!=""){b[d]=j[1]}}}}catch(h){ta.util.error.record(h,"Error parsing hash params in ta.servlet.Tourism.parseHashParams.")}return b}};ta.widgets.slider={handleSeparation:10,isRtl:function(){return ta.util.i18n.isRtl()},getValue:function(c,b){var a="";if(this.isRtl()){if(c.style.right&&c.style.right.trim()!=""){a=c.style.right}else{a=b.style.left}}else{a=c.style.left}if(a!=""){return a.toFloat()}return 0},resetHooks:function(f){var d=f.hasClass("slider_redesign")?f:f.getElement(".slider_redesign");var c=d.className;var b=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));var a=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));return this.setHooks(f,b,a)},setHooks:function(t,f,h,d,g){var p=t.hasClass("slider_redesign")?t:t.getElement(".slider_redesign");var j=p.className;var r=parseInt(j.match(/steps_(\d+)/)[1]);var m=parseFloat((j.match(/min_(\d+)/)[1]).replace("_","."));if(d&&m!=d){p.removeClass("min_"+m);p.addClass("min_"+d);m=d}var q=parseFloat((j.match(/max_(\d+)/)[1]).replace("_","."));if(g&&q!=g){p.removeClass("max_"+q);p.addClass("max_"+g);q=g}if(f<m){f=m}if(h>q){h=q}var k=parseInt(j.match(/width_(\d+)/)[1])-this.handleSeparation;var c=p.hasClass("maxAllInclusive");var s=k/(r-1);var a=(q-m)/(r-1);var o=(f-m)/a;var u=(h-m)/a;this.updateEnd(p.getElement(".handle-left"),this.isRtl()?u:o,s,true);this.updateEnd(p.getElement(".handle-right"),this.isRtl()?o:u,s,false);this.updateBar(p.getElement(".slider-range"),o,u,s,"set");var b=c&&(h>=q);if(p.id=="priceSelect"){this.priceUpdate(t,f,h,b)}else{if(p.id=="ratingSelect"){this.ratingUpdate(t,f,h,b)}else{if(p.id=="bedroomsSelect"){this.bedroomsUpdate(t,f,h,b)}else{this.simpleUpdate(t,f,h,b)}}}var w=t.getElement(".minMax");var v=w.value;var l=this.updateMinMax(w,o,u,a,r,m);return v!=l},updateMinMax:function(g,h,b,a,c,f){var d=(h<=0?0:h*a+f)+","+(b>=(c-1)?999999:b*a+f);g.value=d;return d},updateEnd:function(d,c,f,b){var a=c*f+(this.isRtl()^b?0:this.handleSeparation);if(this.isRtl()){d.setStyle("right",a+"px");d.setStyle("left","")}else{d.setStyle("left",a+"px");d.setStyle("right","")}return a},updateBar:function(b,h,d,g){if((h>d)){h^=d;d^=h;h^=d}var a=h*g;var c=(d*g+this.handleSeparation)-a;if(c<0){c*=-1}var f=this.isRtl()?"right":"left";if(this.isRtl()){b.setStyle("right",a)}else{b.setStyle("left",a)}b.setStyle("width",c)},initSliderInfo:function(f){var d={};var c=f.className;d.width=parseInt(c.match(/width_(\d+)/)[1])-this.handleSeparation;d.steps=parseInt(c.match(/steps_(\d+)/)[1]);d.min=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));d.max=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));d.stepSize=(d.max-d.min)/(d.steps-1);d.maxAllInclusive=f.hasClass("maxAllInclusive");d.snapDistance=d.width/(d.steps-1);d.rangeBar=f.getElement(".slider-range");d.minMax=f.getElement(".minMax");d.startMinMax=d.minMax.value;d.singleValue=f.hasClass("singleValue");var g=f.getParent().getElement(".handle-left");var b=f.getParent().getElement(".handle-right");var h=this.getValue(g,b);var a=this.getValue(b,g);if(this.isRtl()){h-=this.handleSeparation}else{a-=this.handleSeparation}d.leftStep=this.getClosestStep(h,d);d.rightStep=this.getClosestStep(a,d);return d},setSliderTarget:function(b,a){if(b.hasClass("handle-left")){a.target=b.getParent().getElement(".handle-left");if(this.isRtl()){a.limits=[a.rightStep+(a.singleValue?0:1),a.steps-1]}else{a.limits=[0,a.rightStep-(a.singleValue?0:1)]}a.isLeftHook=true}else{a.target=b.getParent().getElement(".handle-right");if(this.isRtl()){a.limits=[0,a.leftStep-(a.singleValue?0:1)]}else{a.limits=[a.leftStep+(a.singleValue?0:1),a.steps-1]}a.isLeftHook=false}return a},handleMouseDown:function(f,a){var d=new Event(f);if(d){d.stop();var c=ta.id(d.target);if(c){var b=this.initSliderInfo(c.getParent());b=this.setSliderTarget(c,b);b.snapCallBack=a.bind(this);b.dragHandle=this.handleMouseMove.bind(this);b.upHandle=this.handleMouseUp.bind(this);document.addListener("mousemove",b.dragHandle);document.addListener("mouseup",b.upHandle);document.addListener("touchmove",touchHandler);document.addListener("touchend",touchHandler);b.offset=c.getParent().getCoordinates().left+10+(b.isLeftHook?0:this.handleSeparation);ta.store("slider_info",b)}}},getClosestStep:function(a,b){return Math.round(a/b.snapDistance)},handleMouseMove:function(d){d=new Event(d);var b=ta.retrieve("slider_info");if(b&&b.target){var c=d.page.x-b.offset;var a=this.getClosestStep(c,b);if(this.isRtl()){a=b.steps-a-1}if(a<b.limits[0]){a=b.limits[0]}else{if(b.limits[1]<a){a=b.limits[1]}}this.sliderDrag(d,a,b,c)}d.stop()},sliderDrag:function(d,g,k,j){if(d){d.stop();var a=k.isLeftHook?g:k.leftStep;var h=k.isLeftHook?k.rightStep:g;this.updateEnd(k.target,g,k.snapDistance,k.isLeftHook);this.updateBar(k.rangeBar,a,h,k.snapDistance);this.updateMinMax(k.minMax,a,h,k.stepSize,k.steps,k.min);ta.store("slider_info",k);if(k.snapCallBack){var b=(this.isRtl()?h:a)*k.stepSize+k.min;var f=(this.isRtl()?a:h)*k.stepSize+k.min;var c=k.maxAllInclusive&&(f==(k.steps-1)*k.stepSize+k.min);k.snapCallBack(k.target,b,f,c)}}},handleMouseUp:function(b){b=new Event(b);if(b){b.stop()}var a=ta.remove("slider_info");if(a){document.removeListener("mousemove",a.dragHandle);document.removeListener("mouseup",a.upHandle);document.removeListener("touchmove",touchHandler);document.removeListener("touchend",touchHandler);a.dragHandle=null;a.upHandle=null;if(a.minMax.value!=a.startMinMax){sliderMoved()}}},currencyUpdate:function(){var b=ta.id("l1currency");if(!b){return}var g=ta.retrieve("ta.currencyHash");if(!g){return}var j=g[parseInt(b.value)];var m=ta.id("pricePeriod_w");if((m!=null)&&m.checked){var l=ta.retrieve("ta.weekCurrencyHash");if(l){j=l[parseInt(b.value)]}}var k=ta.id("priceSelect").getParent();var a=k.getElement(".slider_redesign");var h=a.className;var d=currencyCodes[parseInt(k.getElement("select").value)];var c=ta.has("hacform.slider.price.min")?ta.remove("hacform.slider.price.min"):j.selMin;var f=ta.has("hacform.slider.price.max")?ta.remove("hacform.slider.price.max"):j.selMax;a.className=h.replace(/steps_\d+/,"steps_"+j.steps);ta.widgets.slider.setHooks(k,c,f,j.min,j.max)},priceUpdate:function(g,d,b,a){if(!g.hasClass("prcRng")){g=g.getParent(".prcRng")}var h=ta.id("l1currency");var f=currencyCodes[parseInt(h.value)];g.getElement(".s_min").innerHTML=ta.util.currency.formatCurrency(d,f);var c=ta.util.currency.formatCurrency(b,f);if(a){c+="+"}g.getElement(".s_max").innerHTML=c},ratingUpdate:function(h,f,c,b){if(!h.hasClass("tvrRtg")){h=h.getParent(".tvrRtg")}var a=f.toPrecision(2);var j=c.toPrecision(2);h.getElement(".s_min").innerHTML=a;h.getElement(".s_max").innerHTML=j;var d=h.getElement(".sLeft .lmtImg").src;h.getElement(".sLeft .lmtImg").src=d.replace(/\d.\d/,a);var g=h.getElement(".sRight .lmtImg").src;h.getElement(".sRight .lmtImg").src=g.replace(/\d.\d/,j)},bedroomsUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=(c==0?js_filter_studio:c);d.getElement(".s_max").innerHTML=(b==0?js_filter_studio:(b+(a?"+":"")))},simpleUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=c;d.getElement(".s_max").innerHTML=b+(a?"+":"")}};function touchHandler(c){var d=c.changedTouches,f=d[0],a="";switch(c.type){case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var b=document.createEvent("MouseEvent");b.initMouseEvent(a,true,true,window,1,f.screenX,f.screenY,f.clientX,f.clientY,false,false,false,false,0,null);f.target.dispatchEvent(b);c.preventDefault()}ta.overlays.BACKDROP_NEVER=0;ta.overlays.BACKDROP_ALWAYS=1;ta.overlays.Overlay=new Class({Implements:[Options,Events],Binds:["_hide","show","hide","destroy"],options:{requestData:null,showCloseButton:false,closeButtonClass:"close",closeLink:"",showArrow:false,arrowClassLeft:null,arrowClassRight:null,arrowClass:"ttarrow",style:"typeO",innerDivClass:"inner",backdrop:ta.overlays.BACKDROP_NEVER,permanent:false,isChild:false,remoteContent:null,keepElementInDocument:false,requestMethod:"get",zIndex:1001,positionType:"absolute",draggable:false,draggingClass:"dragging",title:null,onscroll:null,backdropClickClose:false,offsetRight:0,offsetLeft:0,offsetTop:0,closeOnDocumentClick:false},initialize:function(a,b){this.setOptions(a);this.source=ta.id(b);this.visible=false;this.backdropOn=false;this.container=new Element("div",{styles:{position:this.options.positionType,left:"-999em",top:"-999em",fontSize:this.options.fontSize||".75em",zIndex:this.options.zIndex},"class":this.options.style+" overlay"});this.container.store("overlay",this);this.container.overlay=this;this._useIframeShim=Browser.ie6;if(this.options.title){this.header=new Element("h1",{"class":"title",html:this.options.title}).inject(this.container);if(this.options.draggable){var g=this.options.draggingClass;var f=function(){};if(this._useIframeShim){f=this.positionShim.bind(this)}this.drag=new Drag(this.container,{handle:this.header,preventDefault:true,stopPropagation:true,onSnap:function(h){h.addClass(g)},onDrag:f,onComplete:function(h){h.removeClass(g)}})}}this.inner=new Element("div",{"class":this.options.innerDivClass}).inject(this.container);var d=this;if(d.options.onscroll){d.inner.addEvent("scroll",function(){d.options.onscroll(d.inner)})}if(this._useIframeShim){this.shim=new IframeShim(this.container,{browsers:true})}var c;if(this.options.content){this.inner.setContent(this.options.content)}else{if(this.options.remoteContent){this.loadRemoteContent(this.options.remoteContent)}else{if(this.source&&(c=this.source.getElement(".overlayContents"))){if(c){this.inner.set("html",c.innerHTML);c.dispose();this.runBehaviorOnFirstShow=true}}}}if(this.options.showCloseButton){this.closeBtn=new Element("div",{styles:{position:"absolute",fontSize:"92.5%",cursor:"pointer"},html:this.options.closeLink,"class":this.options.closeButtonClass,events:{click:(function(){this.fireEvent("onClose",this)}).bind(this)}}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}}if(this.options.showArrow){this.arrow=new Element("div",{styles:{position:"absolute"},"class":this.options.arrowClass}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}}this.container.addEvent("trash",this.destroy)},destroy:function(){this.container.overlay=null;if(this.shim){this.shim.destroy();this.shim=null}},position:function(){if(this.shim){(function(){this.positionShim()}).delay(10,this)}},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top})},show:function(a){if(typeof(overlayCss)!="undefined"&&!ta.retrieve("ta.overlayCssAsset")){ta.store("ta.overlayCssAsset",Asset.css(overlayCss));this._show(a)}else{this._show(a)}},_show:function(d){if(this.visible){return}if(d){new Event(d).preventDefault()}var a=ta.util.URL.parse(this.options.remoteContent);if(typeof crPageServlet!=="undefined"&&a&&a.test(/\/{1}(\w*)$/)){ta.store("crPageServlet_orig",crPageServlet);crPageServlet=RegExp.$1}$$(".overlay").each(function(c){if(c.overlay){if(c.overlay==this){return}if(this.parentOverlay&&c.overlay==this.parentOverlay){return}if(c.overlay.options.permanent){return}c.overlay.hide(d)}},this);ta.id(document.body).adopt(this.container);if(this.shim&&this.shim.shim){ta.id(document.body).adopt(this.shim.shim);var b=this.container.getCoordinates();if(b){this.shim.shim.setStyles({display:"block",width:b.width,height:b.height})}}this.position();if(this.options.closeOnDocumentClick){document.addEvent("click",this._hide)}if(this.options.backdrop==ta.overlays.BACKDROP_ALWAYS){this.enableBackdrop()}this.visible=true;this.fireEvent("onShow",this);if(ta.has("overlay.onShow")){ta.remove("overlay.onShow").each(function(c){c.call(this)},this)}return this},_hide:function(a){if(!a||this.container.containsEvent(a)){return}document.removeEvent("click",this._hide);this.hide(a)},hide:function(a){if(window.flyout){window.flyout.hide()}if(this.backdropOn){this.disableBackdrop()}if((this.options.keepElementInDocument&&this.container.style.left=="-999em")||(!this.options.keepElementInDocument&&!this.container.inDocument())){return this}if(this.shim){this.shim.hide().dispose()}this.container.setStyles({left:"-999em",top:"-999em"});if(!this.options.keepElementInDocument){this.container.dispose()}this.visible=false;this.fireEvent("onHide",!a);if(ta.has("crPageServlet_orig")){ta.run("ta.commerce.checkrates.restoreCRPageServlet")}return this},configureBackdrop:function(){this.backdrop=new Element("div",{"class":"overlayBG"});this.backdrop.setStyles({position:"absolute",left:0,top:0,width:"100%",height:window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight),backgroundColor:"#000",zIndex:this.options.isChild?"10000":"9997",opacity:0.6});if(this.options.backdropClickClose){this.backdrop.addEvent("click",this.hide)}},updateBackdrop:function(){this.backdrop.setStyles({width:"100%",height:(document.height!==undefined)?document.height:document.body.offsetHeight})},enableBackdrop:function(){try{if(this.backdropOn){return}if(!this.backdrop){this.configureBackdrop()}if(Browser.ie6){var a=this.container;$$("select").each(function(c){if(!a.contains(c)){c.setStyle("visibility","hidden")}else{c.setStyle("visibility","visible")}})}ta.store("overlays.current",this);this.updateBackdrop();if(this.container.inDocument()){this.backdrop.inject(this.container,"before")}else{this.backdrop.inject(document.body)}this.backdropOn=true;this.container.setStyle("z-index",this.options.isChild?"10002":"9998");if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #424242")}else{this.container.setStyle("border","5px solid rgba(64,64,64,0.8)")}}}catch(b){ta.util.error.record(b,"Error setting the border property - enableBackdrop")}},disableBackdrop:function(){try{if(!this.backdropOn){return}this.backdrop.dispose();if(ta.retrieve("overlays.current")==this){ta.remove("overlays.current");if(Browser.ie6){$$("select").setStyle("visibility","visible")}}else{if(Browser.ie6&&ta.retrieve("overlays.current")&&!ta.retrieve("overlays.current").backdropOn){$$("select").setStyle("visibility","visible")}}this.backdropOn=false;this.container.setStyle("z-index","1001");if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #b2b2b2")}else{this.container.setStyle("border","5px solid rgba(128,128,128,0.6)")}}}catch(a){ta.util.error.record(a,"Error unsetting the border property - disableBackdrop")}},loadRemoteContent:function(b,a){if(!a){new Asset.image(CDNHOST+"/img2/generic/site/loop.gif",{onload:this.position.bind(this),"class":"anim_loop"}).inject(this.inner)}new Request({url:ta.util.URL.parse(b),method:this.options.requestMethod,data:this.options.requestData,onSuccess:this.loadRemoteSuccess.bind(this),onFailure:this.loadRemoteFailure.bind(this),evalScripts:true}).send();return this},loadRemoteSuccess:function(a){this.cachedWidth=null;this.inner.setContent(a);this.position();if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}this.fireEvent("onLoad",this);this.cachedWidth=this.container.getSize().x;return this},loadRemoteFailure:function(){this.inner.addClass("ajax_failed");this.inner.setStyle("width","383px");this.inner.setStyle("padding","14px 24px 14px 14px");this.inner.set("text",JS_Ajax_failed)}});ta.overlays.getCurrent=function(){var a=$$(".overlay").shift();return a&&a.retrieve("overlay")};ta.overlays.safeCloseCurrent=function(){var a=ta.overlays.getCurrent();return a&&a.hide()};ta.overlays.AbsoluteOverlay=new Class({Extends:ta.overlays.Overlay,options:{xOffset:0,yOffset:0,toWindow:true,repositionOnScroll:false,autoShow:true,stayOpen:false},initialize:function(a,b){a=a||{};a.showCloseButton=[a.showCloseButton,true].pick();this.parent(a,b);if(this.options.showCloseButton&&!this.options.stayOpen){this.closeBtn.addEvent("click",this.hide)}if(this.options.autoShow){this.show()}},show:function(a){this.parent(a);if(this.options.repositionOnScroll){window.addEvent("scroll",this.delayedScroll.bind(this))}},hide:function(a){this.parent(a);if(this.options.repositionOnScroll){window.removeEvent("scroll",this.delayedScroll.bind(this))}},delayedScroll:function(){this.position.delay(500,this)},position:function(){this.container.setStyles({left:this.options.xOffset,top:this.options.yOffset+(this.options.toWindow?window.getScrollTop():0)});this.parent()}});ta.overlays.CenteredOverlay=new Class({Extends:ta.overlays.Overlay,options:{delayedPosition:false,autoShow:true,attachCloseEvent:true,xOffset:-1,yOffset:-1,fixed:false},initialize:function(a,b){a=a||{};a.showCloseButton=[a.showCloseButton,true].pick();a.fixed&&(this.options.positionType="fixed");this.parent(a,b);if(this.options.showCloseButton&&this.options.attachCloseEvent){this.closeBtn.addEvent("click",this.hide)}this.options.autoShow&&this.show()},position:function(d){var b=ta.retrieve("ta.overlays.CenteredOverlay.position.iters");if(!b){b=0}var g=this.container.getCoordinates();if(g.height<=14&&b<10){ta.store("ta.overlays.CenteredOverlay.position.iters",b+1);this.position.delay(100,this,true);return}var a=this.options.xOffset;var f=this.options.yOffset;if(a===-1){a=Math.max(5,window.getWidth()-g.width)/2;!this.options.fixed&&(a+=window.getScrollLeft())}else{a-=g.width/2}if(f===-1){f=Math.max(20,window.getHeight()-g.height)/2;!this.options.fixed&&(f+=window.getScrollTop())}else{f-=g.height/2}this.container.setStyles({left:a,top:f});this.parent()},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})}});ta.overlays.showInLightbox=function(a,b){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},b)).loadRemoteSuccess(a)};ta.overlays.loadInLightbox=function(b,a){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},a)).loadRemoteContent(b)};var lightbox={deactivate:function(){var a=ta.retrieve("overlays.current");a&&a.hide()}};ta.overlays.ACTIVATE_NEVER=0;ta.overlays.ACTIVATE_CLICK=1;ta.overlays.ACTIVATE_HOVER=2;ta.overlays.ACTIVATE_FOCUS=3;ta.overlays.ACTIVATE_HOVER_DELAY=4;ta.overlays.ACTIVATE_BOTH=5;ta.overlays.PINNABLE_NEVER=0;ta.overlays.PINNABLE_ALWAYS=1;ta.overlays.PINNABLE_CLICK=2;ta.overlays.BACKDROP_PINNED=2;ta.overlays.RelativeOverlay=new Class({Extends:ta.overlays.Overlay,Binds:["_hide","show","hide","destroy","hideNow","showWithDelay","hideWithDelay","_pin"],options:{activate:ta.overlays.ACTIVATE_NEVER,pinnable:ta.overlays.PINNABLE_NEVER,autoShow:true},initialize:function(b,c){this.parent(b,c);this.container.addClass("relative");var a=this.source.getParentBySelector(".overlay");if(a){this.container.setStyle("z-index",a.getStyle("z-index")+1);this.parentOverlay=a.overlay}if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hideNow)}switch(this.options.activate){case ta.overlays.ACTIVATE_CLICK:this.source.addEvent("click",this.show);break;case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_FOCUS:this.source.addEvent("focus",this.show);break}switch(this.options.pinnable){case ta.overlays.PINNABLE_CLICK:this.source.addEvent("click",this._pin);break}var f=this.source.getElement(".overlaySrc");if(f){if(f.get("tag")=="a"){this.loadRemoteContent(f.href)}else{this.loadRemoteContent(f.get("text"));f.dispose()}}else{if(!this.options.content&&this.source.get("tag")=="a"){this.loadRemoteContent(this.source.href)}}var d=ta.id(this.source.id+"_CONTENTS");if(d){this.inner.set("html",d.innerHTML);d.dispose();this.runBehaviorOnFirstShow=true}if(this.options.autoShow){this.show()}else{if(this.options.delayShow){this.showWithDelay()}}},show:function(b){b=b||window.event;if(b){new Event(b).stop()}var a=this.visible;this.parent(b);clearTimeout(this.showTimeout);if((this.options.activate==ta.overlays.ACTIVATE_HOVER||this.options.activate==ta.overlays.ACTIVATE_HOVER_DELAY)&&this.hideTimer){clearTimeout(this.hideTimer);this.hideTimer=null}if(a){return}if(this.runBehaviorOnFirstShow){this.runBehaviorOnFirstShow=false;if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}}this.cachedWidth=this.container.getSize().x;switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_FOCUS:if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.addEvent("click",this.hide)}break}return this},hide:function(b){b=b||window.event;if(!this.visible){return}if(window.flyout){window.flyout.hide()}if(b){var a=new Event(b);if(a.target&&a.target.tagName=="option"){return}if(Browser.ie&&a.target&&a.target.tagName=="select"&&this.container.getElements("select").contains(a.target)){return}}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:if(!this.hideTimer){this.hideTimer=this.hide.delay(250,this);return}else{clearTimeout(this.hideTimer);this.hideTimer=null}break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_FOCUS:if(b&&this.container.containsEvent(b)){return}if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.removeEvent("click",this.hide)}break}return this.hideNow()},hideNow:function(a){if(!this.visible){return this}if(this.backdropOn){this.disableBackdrop()}if(this.shim){this.shim.hide().dispose()}this.container.setStyles({left:"-999em",top:"-999em"}).dispose();this.visible=false;if(this.options.pinnable==ta.overlays.PINNABLE_CLICK){this.unpin()}this.fireEvent("onHide");return this},_pin:function(a){this.pin();this.toggleBackdrop(true)},pin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.removeEvent("mouseenter",this.show);this.source.removeEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.removeEvent("mouseenter",this.showWithDelay);this.source.removeEvent("mouseleave",this.hideWithDelay);break}this.container.removeEvent("mouseenter",this.show);this.container.removeEvent("mouseleave",this.hide);this.pinned=true;return this},toggleBackdrop:function(a){if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.enableBackdrop()}},unpin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);break}this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.disableBackdrop()}this.pinned=false;return this},showWithDelay:function(a){a=a||window.event;clearTimeout(this.showTimeout);if(this.visible){return this.show(a)}else{this.showTimeout=this.show.delay(300,this)}},hideWithDelay:function(a){a=a||window.event;if(!this.visible){clearTimeout(this.showTimeout)}else{return this.hide(a)}}});ta.overlays.RelativeOverlayHorizontal=new Class({Extends:ta.overlays.RelativeOverlay,initialize:function(a,b){if(a.onRight==null){if(IS_DEBUG){alert("ERROR: Attempting to create Horizontal Overlay without specifying direction.")}return}this.parent(a,b)},position:function(){if(this.options.onRight){this.positionRight()}else{this.positionLeft()}this.parent()},adjustTop:function(f,j){try{this.source=ta.id(this.source);var l=f+this.options.offsetTop;var g=window.getScrollTop()+window.getHeight();var k=document.getElementById("tamgFooter");if(k){if(k.offsetHeight){g=g-k.offsetHeight}else{if(k.clientHeight){g=g-k.clientHeight}}}if(l+j.height>=g){l=g-j.height-1;if((this.crDHTML_BASIC||this.crDHTML_PNG24)&&this.options.showArrow){var b=this.container.getElement(".check_availability");var d=this.container.getElement(".username");if(b||d){var a=b?b:d;var c=a.getCoordinates().height}l=g-j.height+c-9}}return l}catch(h){ta.util.error.record(h,"adjustTop: RelativeOverlayHorizontal")}},positionLeft:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var a=ta.id("PAGE").getCoordinates();var h=this.container.getCoordinates();if(!this.flipped&&d.left-a.left-(this.cachedWidth||h.width)<0){this.flipped=true;this.options.onRight=true;if(this.arrow){this.arrow.className=this.options.arrowClassLeft}this.positionRight();return}if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){this.positionLeftOrRight(d,b,a,h,"left")}else{var f=this.adjustTop(d.top,h);d.left=d.left-this.options.offsetLeft;this.container.setStyles({left:null,right:window.getWidth()-d.left,top:f-b})}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},positionRight:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var a=ta.id("PAGE").getCoordinates();var h=this.container.getCoordinates();if(!this.flipped&&a.right-d.right-(this.cachedWidth||h.width)<0){this.flipped=true;this.options.onRight=false;if(this.arrow){this.arrow.className=this.options.arrowClassRight}this.positionLeft();return}if(ta.isDHTMLCRRedesign2012()&&(this.container.getElement(".check_availability")||this.container.getElement(".username"))){this.positionLeftOrRight(d,b,a,h,"right")}else{var f=this.adjustTop(d.top,h);d.right=d.right-this.options.offsetRight;this.container.setStyles({right:null,left:d.right,top:f-b})}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},positionLeftOrRight:function(p,k,y,w,q){try{var d=this.container.getElement(".check_availability");var f=this.container.getElement(".username");var g=this.adjustTop(p.top,w);var u=d?d:f;var r=u.getCoordinates().height;var l=16;var h=g-r+l/2;var o=d?h:h+5;if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)}if(this.crDHTML_BASIC){var b=d?(p.right+13):(p.right-45);if(q=="left"){b=p.left+13}var a=-16}if(this.crDHTML_PNG24){var b=d?(p.right+20):(p.right-45);if(q=="left"){var b=window.getWidth()-p.left+20}var a=d?-21:-24}if(q=="left"){this.container.setStyles({right:b,left:null,top:o})}else{this.container.setStyles({right:null,left:b,top:o})}this.arrow.setStyle("display","block");var j=d?16:0;this.arrow.setStyle("top",r-j);if(q=="left"){this.arrow.setStyle("left",(w.width-13))}else{this.arrow.setStyle("left",a)}try{p=this.source.getCoordinates();w=this.container.getCoordinates();var t=window.getScrollTop()+window.getHeight();var m=p.top-w.top-l/2;var j=d?0:20;if(g+w.height>=t&&m>0){this.arrow.setStyle("top",m+j);if(p.bottom+l/2>=w.bottom){this.container.setStyle("top",o+l*2);this.arrow.setStyle("top",m-l*2+j)}}else{if(m<=0){this.container.setStyle("top",o-r+l)}}}catch(v){ta.util.error.record(v,"bottomEdge - Reposition arrow and container: RelativeOverlayHorizontal")}}catch(v){ta.util.error.record(v,"positionLeftOrRight: RelativeOverlayHorizontal")}}});ta.overlays.RelativeOverlayRight=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:true},a),b)}});ta.overlays.RelativeOverlayLeft=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:false},a),b)}});ta.overlays.RelativeOverlayVertical=new Class({Extends:ta.overlays.RelativeOverlay,options:{flipPadding:0},initialize:function(a,b){if(a.below==null){if(IS_DEBUG){alert("ERROR: Attempting to create Vertical Overlay without specifying direction.")}return}this.parent(a,b)},position:function(){if(this.options.below){this.positionBelow()}else{this.positionAbove()}this.parent()},positionBelow:function(){var b=this.source.getCoordinates();var g=this.container.getCoordinates();var f=this.container.getStyle("margin-left").toInt();var a=window.getHeight()+window.getScrollTop();var d=b.bottom;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}if(!this.flipped&&a-g.height-d<0&&b.top-g.height>0){this.options.below=false;this.flipped=true;d=b.top-g.height-this.options.flipPadding;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}}this.container.setStyles({left:this.adjustEdge(b.left-f,g.width),top:d})},positionAbove:function(){var b=this.source.getCoordinates();var g=this.container.getCoordinates();var f=this.container.getStyle("margin-left").toInt();var a=window.getScrollTop();var d=b.top-g.height-this.options.flipPadding;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}if(!this.flipped&&d-a<0){this.options.below=true;this.flipped=true;d=b.bottom;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}}this.container.setStyles({left:this.adjustEdge(b.left-f,g.width),top:d})},adjustEdge:function(d,c){var a=ta.id("PAGE").getCoordinates();if(d+c>=a.right){var b=this.container.getStyle("margin-right").toInt();d=a.right-c-b-1}return d},hideNow:function(a){this.parent(a);this.flipped=false}});ta.overlays.RelativeOverlayBelow=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:true},a),b)}});ta.overlays.RelativeOverlayAbove=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:false},a),b)}});ta.overlays.RelativeCalloutHorizontal=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,options:{arrowUp:false,arrowDown:false,shadow:true,offset:null},initialize:function(a,b){if(a.onRight==null){if(IS_DEBUG){alert("ERROR: Attempting to create Horizontal Callout without specifying direction.")}return}if($$("body div.overlay").some(function(c){return c!=b})){return}a.style+=" overlayCallout ";this.parent(a,b);if(this.options.arrowDown){this.container.addClass("calloutDown")}else{if(this.options.arrowUp){this.container.addClass("calloutUp")}else{this.container.addClass(this._isRight(this.options)?" calloutRight":" calloutLeft")}}this._setupShadow(this.options,b);this._setupArrow(this.options,b);this._adjustPosition(this.options,b)},adjustTop:function(b,a){return b},show:function(b){this.parent(b);if(this.source&&this.container){this.source.adopt(this.container)}if(Browser.ie6){var a=this.container;$$("select").each(function(c){if(!a.contains(c)){c.setStyle("visibility","hidden")}else{c.setStyle("visibility","visible")}})}this.addEvent("onHide",this._hide)},_hide:function(a){if(Browser.ie6){$$("select").setStyle("visibility","visible")}},_isRight:function(b){var a=this.flipped||false;if(b.onRight===true){return !a}else{return a}},_setupArrow:function(a,b){var c="arrow ";if(this._isRight(a)){if(a.arrowDown){c+="arrowTL"}else{if(a.arrowUp){c+="arrowBL"}else{c+="arrowL"}}}else{if(a.arrowDown){c+="arrowTR"}else{if(a.arrowUp){c+="arrowBR"}else{c+="arrowR"}}}this.arrow=new Element("div",{"class":c}).inject(this.container)},_setupShadow:function(a,b){if(a.shadow===true){this.shadow=new Element("div",{"class":"shadow"}).adopt(this.inner.getChildren()).inject(this.inner)}},_adjustPosition:function(a,b){if(!a.offset.length||a.offset.length<2){a.offset=[0,0]}var c=this.source.getStyles("height","width");this.container.setStyles({left:parseInt((a.onRight?c.width:"0px").replace("px",""))+parseInt(a.offset[0]),top:parseInt(a.offset[1],0)+(a.arrowDown?45:0)})}});(function(){function c(f){if(!f){return null}if(f.get("tag")=="a"){return f.href}var d=f.getElement("a");if(d){return d.href}d=f.getElement(".overlaySrc");if(d){return d.get("text")}return null}var b={left:ta.overlays.RelativeOverlayLeft,right:ta.overlays.RelativeOverlayRight,above:ta.overlays.RelativeOverlayAbove,below:ta.overlays.RelativeOverlayBelow};function a(m,q,h,r){if(q||window.event){new Event(q||window.event).preventDefault()}var p=m.hyphenate().split("-"),k=p.indexOf("h")>=0,g=p.indexOf("lb")>=0,d=p.indexOf("remote")>=0,o=p.indexOf("click")>=0,f=Object.merge({showCloseButton:true},r),l=null,j;switch(p.shift()){case"rel":l=b[p.shift().toLowerCase()];if(g){f.pinnable=ta.overlays.PINNABLE_ALWAYS}break;case"center":l=ta.overlays.CenteredOverlay;break}if(l===null){return null}if(k){f.activate=ta.overlays.ACTIVATE_HOVER}else{if(o){f.activate=ta.overlays.ACTIVATE_CLICK}}if(g){f.backdrop=ta.overlays.BACKDROP_ALWAYS}if(d){f.remoteContent=c(h)}j=new l(f,h);if(h){h.store("overlay",j)}return j}ta.overlays.Factory={_magic:a,relRightRemoteHLB:function(d,g){g=ta.id(g);if(g.get("tag")!="div"){g=g.getParent()}var h=c(g);if(h==null){return}var f=new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay",showCloseButton:true},g)},relRightRemoteHLB_Commerce:function(g,d){if(g||window.event){new Event(g||window.event).preventDefault()}d=ta.id(d);var f=c(d);if(f==null){return}d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay",showCloseButton:true},d)},relRightRemoteHLB_CommCopy:function(g,d){if(g||window.event){new Event(g||window.event).preventDefault()}d=ta.id(d);var f=c(d);if(f==null){return}d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay",showCloseButton:true,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")}},d)},relBelowRemoteHLB_Commerce:function(g,d){d=ta.id(d);if(g||window.event){new Event(g||window.event).preventDefault()}var f=c(d);if(f==null){return}d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay",showCloseButton:true},d)},relBelowRemoteHLB_CommCopy:function(g,d){d=ta.id(d);if(g||window.event){new Event(g||window.event).preventDefault()}var f=c(d);if(f==null){return}d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay",showCloseButton:true,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")}},d)},relBelowS4Dg:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,style:"s4 dg",activate:ta.overlays.ACTIVATE_CLICK},d)},relBelow:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relAbove:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relRight:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayRight({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relLeft:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayLeft({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relBelowH_Media:function(f,d){if(f){f.stop()}d.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},d)},relAboveH_Media:function(f,d){if(f){f.stop()}d.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},d)},relAboveH:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER},d)},relAboveTAMGFooter:function(g,d){d.onmouseover=null;var f=ta.id("PAGE");if(f){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 vdg ovrFooter "+d.className},d)}},relRightH:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER},d)},relLeftH:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayLeft({activate:ta.overlays.ACTIVATE_HOVER},d)},imageLightbox:function(h,d){d.onclick=null;var f="<div><img src="+d.getAttribute("href")+"></div>";var g=new ta.overlays.CenteredOverlay({showCloseButton:true,backdrop:ta.overlays.BACKDROP_ALWAYS}).loadRemoteSuccess(f);d.addEvent("click",g.show)},relRightRemoteHLB_optionalDelay:function(d,k){k=ta.id(k);if(k.get("tag")!="div"){k=k.getParent()}var l=c(k);if(l==null){return}if(typeof(checkRatesCSS)!="undefined"&&!ta.retrieve("ta.checkRatesCSS")){ta.store("ta.checkRatesCSS",Asset.css(checkRatesCSS))}var h=k.className.match(/noDelayFirst/);var j=k.className.match(/delayOpen/);var g=ta.retrieve("delayedFirst");var m=!j||(h&&!g);var f=new ta.overlays.RelativeOverlayRight({activate:(j?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER),pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay",showCloseButton:true,autoShow:m,delayShow:!m,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")},onShow:function(){ta.commerce.checkrates.updateCRForm("_pop");ta.overlays.Factory.checkCRLimitsHelper(f)}},k);ta.store("delayedFirst",true)},relRightRemoteHLB_optionalDelay_showArrow:function(r,g){try{g=ta.id(g);if(g.get("tag")!="div"){g=g.getParent()}var h=c(g);if(h==null){return}var k=g.className.match(/noDelayFirst/);var q=g.className.match(/delayOpen/);var l=ta.retrieve("delayedFirst");var f=!q||(k&&!l);var p="rgba_flyout";var d=true;var m="rgba_arrow";if(ta.has("checkrates.dhtml_cr_redesign_png24_orange")){p+=" orange"}if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)}if(this.crDHTML_PNG24){if(ta.has("checkrates.dhtml_cr_redesign_png24_orange")){m=m+" rgba_arrow_png24_orange"}else{cr_arrowClass_right=m+" rgba_arrow_png24_right";m=m+" rgba_arrow_png24"}}var j=new ta.overlays.RelativeOverlayRight({activate:(q?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER),pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:p,showArrow:d,arrowClass:m,arrowClassLeft:m,arrowClassRight:cr_arrowClass_right,showCloseButton:true,autoShow:f,delayShow:!f,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")},onShow:function(){ta.commerce.checkrates.updateCRForm("_pop");ta.overlays.Factory.checkCRLimitsHelper(j)}},g);ta.store("delayedFirst",true)}catch(o){ta.util.error.record(o,"relRightRemoteHLB_optionalDelay_showArrow: Factory")}},checkCRLimitsHelper:function(f){try{var d=f.container.getElement("#CHECK_RATE_FLYOUT");if(d&&/id_(\d+)/.test(d.className)){ta.commerce.checkrates.checkCRLimits(RegExp.$1)}}catch(g){ta.util.error.record(g,"crLimits check on show overlay")}},fbFriendOverlay:function(d){d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,style:"s2 mg"},d)},photosLB:function(d,h){try{if(d||window.event){new Event(d||window.event).preventDefault()}h=ta.id(h);if(h.get("tag")!="a"){if((h.get("tag")=="span"&&h.hasClass("fkASDF"))||(h.get("tag")=="div"&&h.hasClass("fkASDF"))){h=ta.id(h)}else{h=h.getParent("a")}}var g="";if(h.className){g=h.className.match(/u_([^ ]*)/)[1]}else{if(h.href.match(/\/?LocationPhoto.*/)){g=h.href}}ta.overlays.Factory._mediaLBLoadAssets();if(ta.has("photo.viewer.jsAssetsLoaded")){g=g.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");g=g.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");g=g.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(g.match(/\?/)){g=g+"&small=true"}else{g=g+"?small=true"}}var f=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.photoLBHelper,h);f.loadRemoteContent(g);ta.store("photo.viewer.lightbox",f)}else{ta.util.error.record(null,"photo gallery - no assets to load");ta.overlays.Factory.viewerFallback.delay(2000,this,[null,h])}}catch(j){ta.util.error.record(j,"photo gallery overlay",null,{photoUrl:g})}return false},viewerFallback:function(f){var d=ta.remove("photo.viewer.lightbox");if(d){d.hide()}if(f&&f.href&&f.href.match(/LocationPhotos/)){window.location=f.href}else{return ta.servlet.Popup.photoGallery(null,f)}},photoLBCounter:1,photoLBHelper:function(f){var d=ta.retrieve("photo.viewer.initData");if(ta.overlays.Factory.photoLBCounter>16){ta.overlays.Factory.photoLBCounter=1;try{ta.overlays.Factory.viewerFallback.delay(2000,this,f)}catch(g){}return}if(!d||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.photoLBHelper.delay(500)}else{ta.overlays.Factory.photoLBCounter=1;ta.photos.viewer.photoViewerInit(d)}},mediaLBAutoOpen:function(f){try{ta.overlays.Factory._mediaLBLoadAssets();if(!ta.has("photo.viewer.jsAssetsLoaded")){ta.util.error.record(null,"auto-open media lightbox - no assets to load")}else{f=f.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");f=f.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");f=f.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(f.match(/\?/)){f=f+"&small=true"}else{f=f+"?small=true"}}var d=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.mediaLBAutoOpenHelper,f);d.loadRemoteContent(f);ta.store("photo.viewer.lightbox",d)}}catch(g){ta.util.error.record(g,"ta.overlays.factory.autoOpenMediaLB failed",null,{photoUrl:f})}return false},mediaLBAutoOpenHelper:function(g){var d=ta.retrieve("photo.viewer.initData");var f=16;if(ta.overlays.Factory.photoLBCounter>f){ta.overlays.Factory.photoLBCounter=1;ta.util.error.record(null,"ta.overlays.factory.autoOpenMediaLBHelper is giving up after "+f+" attempts.",null,{photoUrl:g});return}if(!d||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.mediaLBAutoOpenHelper.delay(500,this,g)}else{ta.overlays.Factory.photoLBCounter=1;ta.photos.viewer.photoViewerInit(d)}},_mediaLBLoadAssets:function(){if(!ta.has("photo.viewer.jsAssetsLoaded")&&typeof cssPhotoViewerAsset!="undefined"&&typeof jsPhotoViewerAsset!="undefined"){ta.store("photo.viewer.jsAssetsLoaded",true);Asset.css(cssPhotoViewerAsset,{media:"screen, print"});if(!ta.photos.viewer){Asset.javascript(jsPhotoViewerAsset)}if(typeof TALSO=="undefined"){Asset.javascript(jsPhotoViewerTALSOAsset)}if(typeof jsPhotosAsset!="undefined"&&!ta.servlet.Photos){Asset.javascript(jsPhotosAsset)}if(!ta.media.jwplayerHelper){Asset.javascript(jsJWPlayerHelperAsset)}}},_mediaLBCreateOverlay:function(f,g){var d=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",backdropClickClose:true,onLoad:function(){this.position();if(ta.commerce&&ta.commerce.checkrates){ta.commerce.checkrates.updateCRForm("_pto");ta.commerce.checkrates.removePCR()}f(g)},onHide:function(){var h=ta.remove("photo.viewer.lightbox");if(h){h.hide()}ta.run("ta.commerce.checkrates.restoreCRPageServlet");document.removeEvent("keydown",ta.remove("photo.viewer.keydownListener"));if(ta.retrieve("photo.viewer.refreshOnClose")){window.location=window.location}if(ta.has("translationOverlay")){ta.retrieve("translationOverlay").hide()}},permanent:true});return d},AccDetail:function(o,f,k,d){if(o){o.stop()}f=f.getParent();var j="http://"+document.domain;var m=location.pathname;if(m.length>0){if(m.charAt(0)=="/"){m=m.substring(1)}var l=m.indexOf("-");if(l>=0){m=m.substring(0,l)}}var h=k;var g=function(p){var q=ta.id("overlay_description").get("text");if(q.length>1000){ta.id("overlay_description").setStyle("height",210)}};new Asset.css(memoverlayCSS);new ta.overlays.CoverOverlay({yOff:35,onLoad:g,style:"s3 dg rgba_gry",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showCloseButton:true,delayShow:true,requestData:{d:h,tab:"descript",from:m},remoteContent:j+"/LocationTab"},f);return false},memberOverlay:function(t,h,r){if(t){t.stop()}h.onmouseover=null;var q="";var d="";var m="";var o=false;var g=false;var f=true;var p="rgba_arrow_png24";if(h.id&&h.id!=""){var k=h.id.split("-");for(var l=0;l<k.length;l++){var j=k[l];if(j.match(/\bUID_([0-9A-F]+)\b/)){q=RegExp.$1}else{if(j.match(/\bSRC_(\d+)\b/)){d=RegExp.$1}else{if(j.match(/\bCATID_(\d+)\b/)){m=RegExp.$1}else{if(j.match("FUS")){o=true}else{if(j.match("PATT")){g=true}}}}}}}else{ta.util.error.record(err,"memberOverlay - elmt.id check",null,{passedElement:ta.util.error.getSelectorString(h)})}var s="";if(typeof(footprintGet)!="undefined"){s=footprintGet()}new Asset.css(memoverlayCSS);new ta.overlays.RelativeOverlayRight({style:r||"typeO",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:f,arrowClass:p,showCloseButton:true,autoShow:false,delayShow:true,remoteContent:"/MemberOverlay?uid="+q+"&c="+m+"&src="+d+"&fus="+o+"&partner="+g+"&LsoId="+s},h);return false},createPairedCalendar:function(g,f,d){if(!d){d={validate:true}}if(g){new Event(g).preventDefault()}return new ta.overlays.PairedCalendar(f,d)},createPairedCalendarGeo:function(g,f,d){if(g){new Event(g).preventDefault()}new ta.overlays.PairedCalendar(f,{validate:true,onUpdate:ta.commerce.checkrates.showProviders.bind(ta.commerce.checkrates)});ta.commerce.checkrates.geoId=d},_injectAd:function(d){var f=ta.id(d);try{if(f){injectAdsTargeted(f)}}catch(g){ta.util.error.record(g,"AlsoViewedLB: error injecting ad into elemId="+d)}},createDatedPairedCalendar:function(g,d){if(g){new Event(g).preventDefault()}d=ta.id(d);var f=d.getParent("form");new ta.overlays.PairedCalendar(d,{validate:true,overlayOptions:{onShow:function(){ta.overlays.toggleOffSearchAll(f)}}});ta.overlays.toggleOffSearchAll(f)},recordVRCrossSell:function(){try{var f=ta.id("VR_CROSS_SELL");if(f){var d=f.innerHTML.indexOf("setPID");var h=f.innerHTML.substr(d+7,5);new Request({url:"/ActionRecord?action=VR_CROSS_SELL_"+h}).send()}}catch(g){ta.util.error.record(g,"VR Cross Sell - ActionRecord failed")}},launchAVLBCompleteFn:function(f){ta.overlays.Factory._loadAVCSS();var d=function(){ta.overlays.Factory._injectAd("ALSO_VIEWED_AD")};var g=function(k){var h="alsoViewedTest avStandalone";if(ta.has("ta.av_cr_leavebehind")){h="av_cr_leavebehind"}if(ta.has("checkrates.p13n_test22_six_recos")){h=h+" v6_green"}else{if(ta.has("ta.avlb_hero_photos")){h="avlb_hero_photos";if(ta.has("checkrates.hero_photos_r2xc3")){h=h+" r2xc3"}}}var j;if(ta.has("checkrates.left_overlay")){j=new ta.overlays.AbsoluteOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:h,onShow:d.delay(100),onLoad:ta.overlays.Factory.recordVRCrossSell},null).loadRemoteSuccess(k)}else{j=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:h,onShow:d.delay(100),onLoad:ta.overlays.Factory.recordVRCrossSell}).loadRemoteSuccess(k)}var m=false;if(j.inner){var l=ta.id("emptyAlsoViewed");if(l){m=true}else{ta.store("alsoViewedLB",true)}}else{m=true}if(m){j.hide();ta.store("commerce.pwrOverlay",j)}ta.commerce.checkrates.removePCR();ta.commerce.checkrates.loadPackages(true)};new Request({url:f,onSuccess:g,evalScripts:true}).send()},_loadAVCSS:function(){if(typeof(avlbCss)!="undefined"&&!ta.retrieve("ta.avlbCss")){ta.store("ta.avlbCss",Asset.css(avlbCss))}if(typeof(avlbTestCss)!="undefined"&&!ta.retrieve("ta.avlbTestCss")){ta.store("ta.avlbTestCss",Asset.css(avlbTestCss))}if(typeof(VRCrossSellCss)!="undefined"&&!ta.retrieve("ta.VRCrossSellCss")){ta.store("ta.VRCrossSellCss",Asset.css(VRCrossSellCss))}if(typeof(av_cr_leavebehind)!="undefined"&&!ta.retrieve("ta.av_cr_leavebehind")){ta.store("ta.av_cr_leavebehind",Asset.css(av_cr_leavebehind))}if(typeof(avlb_hero_photos)!="undefined"&&!ta.retrieve("ta.avlb_hero_photos")){ta.store("ta.avlb_hero_photos",Asset.css(avlb_hero_photos))}},_loadChkMoreCSS:function(){ta.overlays.Factory._loadAVCSS();if(typeof(chkMoreCss)!="undefined"&&!ta.retrieve("ta.chkMoreCss")){ta.store("ta.chkMoreCss",Asset.css(chkMoreCss))}if(typeof(chkMoreSpritesCss)!="undefined"&&!ta.retrieve("ta.chkMoreSpriteCss")){ta.store("ta.chkMoreSpriteCss",Asset.css(chkMoreSpritesCss))}},loadCheckMoreOverlay:function(g,d){var p=(g.getVendorSet().getCheckedInfo("count")<7);if(ta.has("checkrates.p13n_test22_six_recos")){p=false}var r="";var l=0;var h=0;var o=ta.has("checkrates.check_more_re");var k=ta.has("checkrates.check_more_hero_photos");var q=ta.has("checkrates.doNotAnimateCheckMore");var f=ta.has("checkrates.check_more_re_center_large_hero_photos");var m=ta.has("checkrates.check_more_center_v6");var s=ta.has("checkrates.hero_photos_r2xc3");if(!f&&!s){r="alsoViewedTest check_more_sites"}if(o||k){if(!m){r+=" avlb_hero_photos"}l=5;h=5;if(m){r+=" check_more_center_v6"}else{if(o){r+=" check_more_re"}else{if(k){r+=" check_more_hero_photos"}}}if(s){r+=" r2xc3"}}if(ta.has("checkrates.center_overlay")){var j=new ta.overlays.CenteredOverlay({style:r,backdrop:ta.overlays.BACKDROP_ALWAYS,onLoad:function(){ta.commerce.checkrates.removePCR();if(o||k||q){try{ta.commerce.checkrates.loadPackages(false)}catch(t){ta.util.error.record(t,"hotel packages - loadPackages")}}},onHide:ta.commerce.checkrates.restoreCRPageServlet},g.trigger)}else{var j=new ta.overlays.AbsoluteOverlay({style:r,backdrop:ta.overlays.BACKDROP_ALWAYS,repositionOnScroll:p,xOffset:l,yOffset:h,onLoad:function(){ta.commerce.checkrates.removePCR();if(o||k||q){try{ta.commerce.checkrates.loadPackages(false)}catch(t){ta.util.error.record(t,"hotel packages - loadPackages")}}},onHide:ta.commerce.checkrates.restoreCRPageServlet},g.trigger)}ta.overlays.Factory._loadChkMoreCSS();if(g.type=="checkdeals"){j.loadRemoteSuccess=function(t){this.inner.set("html",t);ta.commerce.smartdeals.popBlockerOverlay(j,g);this.position()}}if(g.isCheckMore){j.addEvent("onClose",ta.commerce.checkrates.recordClose.bind(ta.commerce.checkrates));if(!q&&!o&&!k){j.addEvent("load",ta.commerce.checkrates.showRemainingCheckMore.bind(ta.commerce.checkrates))}}j.loadRemoteContent(d,false)},loadCheckRatesLBOverlay:function(j,f,h){try{var d=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg cr_lb_overlay",requestData:{d:h.detail,s:crPageServlet,a:h.area},remoteContent:"http://"+document.domain+"/CheckRatesLB",showCloseButton:true,closeLink:'<div class="close_text">'+overlayCloseTxt+"</div>",onLoad:function(){ta.commerce.checkrates.removePCR;ta.commerce.checkrates.updateCRForm("_cro")},onHide:ta.commerce.checkrates.restoreCRPageServlet},f);if(typeof(checkRatesLBCss)!="undefined"&&!ta.retrieve("ta.checkRatesLBCss")){ta.store("ta.checkRatesLBCss",Asset.css(checkRatesLBCss))}}catch(g){ta.util.error.record(g,"check rates leave behind")}},loadPCROverlay:function(){try{var f=ta.id("CHECK_RATE");var l=ta.id("PERSISTENT_CHECK_RATES_CONTENT");var d=window.getScroll();if(!l){return}var j=l.hasClass("closeTest");if(!f||!d){l.dispose();return}ta.store("pcr.scrollPoint",f.getPosition().y);if(!d){return}ta.store("pcr.initialYPos",window.getScroll().y);var k=l.get("html");l.dispose();var h="persistentCR";var g=new ta.overlays.AbsoluteOverlay({toWindow:false,autoShow:false,positionType:"fixed",permanent:true,zIndex:"9996",style:h,content:k,closeButtonClass:"sprite-greenX",closeLink:"<div>"+ta.commerce.checkrates.pcrCloseTxt+"</div>",onClose:function(){try{ta.store("pcr.keepHidden",true);Cookie.writeSession("CPCR",1);new Request({url:"/ActionRecord?action=persistent_cr_close"}).send()}catch(o){ta.util.error.record(o,"pcr - onClose")}}});ta.store("pcr.overlay",g);window.removeEvent("scroll",ta.overlays.Factory.loadPCROverlay);window.addEvent("scroll",ta.commerce.checkrates.positionCheckRates)}catch(m){window.removeEvent("scroll",ta.overlays.Factory.loadPCROverlay);ta.util.error.record(m,"pcr - scroll init");return false}},tamgShowLightbox:function(g,f,h){var d="tripadvisor.com";if(typeof cookieDomain!="undefined"){d=cookieDomain.substring(1,cookieDomain.length)}new Asset.css(h);new Request({url:"/TAMGFooterAjax",onSuccess:function(j){ta.overlays.showInLightbox(j,{style:"s0 TAMG_All"})},data:{a:"SHOW_GROUP_OVERLAY",dom:d},evalScripts:true,method:"get"}).send()},intlPopup:function(h,f){if(h){h.stop()}f.onclick=null;if(flagsUrl==null||flagsUrl==""){flagsUrl=document.location.pathname}var g="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(document.location.search!=""){g+=encodeURIComponent(document.location.search)}if(document.location.hash!=""){g+=encodeURIComponent(document.location.hash)}if(window.modelGeoId){g+="&geo="+modelGeoId}if(window.flagsSettings){for(var d=0;d<flagsSettings.length;d++){g+="&"+flagsSettings[d]+"=true"}}if(window.pageFeature){g+="&pageFeature="+pageFeature}new Asset.css(flagsFlyoutCSS);new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:g},f);return false},showRecentLocationEmailOverlay:function(){setPID(3833);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}new Request({url:"/RecentlyViewedAjax",onSuccess:function(d){if(!d.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(d,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"share_overlay"},evalScripts:true,method:"get"}).send()},expandRecentlyViewed:function(g,f){for(var d=4;d<7;d++){var j=ta.id("recently_viewed_"+d);if(j&&j.hasClass("hidden")){j.removeClass("hidden")}}var h=ta.id("RECENTLY_VIEWED_MORE");if(h){h.addClass("hidden")}},showRecentlyViewedCompareOverLay:function(){ta.util.cookie.setPIDCookie(4898);var f=window.location.protocol+"//"+window.location.hostname+"/CompareHotels?detail=";var d=0;for(d=0;d<7;d++){var g=ta.id("recently_viewed_"+d);if(g){f=f+g.get("locid");d+=1;break}}for(;d<7;d++){var g=ta.id("recently_viewed_"+d);if(g){f=f+"&compareHotelId="+g.get("locid")}}if(typeof(compareHotelCSS)!="undefined"&&!ta.retrieve("ta.compareHotelCssAsset")){ta.store("ta.compareHotelCssAsset",Asset.css(compareHotelCSS))}new Request({url:f,onSuccess:function(h){new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"compareHotel",content:h})}}).send()},clearRecentLocations:function(){var f=ta.id("RECENTLY_VIEWED_LIST");if(f){var d=f.getNext(".bxDivider");f.dispose();if(d){d.dispose()}}new Request({url:"/RecentlyViewedAjax?a=clear"}).send()},removeParticularLocation:function(d,f,q){var h=ta.id("recently_viewed_"+q);if(h){var p=h.get("locid");h.dispose();new Request({url:"/RecentlyViewedAjax?a=remove&locID="+p}).send();for(;q<7;++q){h=ta.id("recently_viewed_"+q);if(h&&h.hasClass("hidden")){h.removeClass("hidden");break}}for(;q<7;++q){h=ta.id("recently_viewed_"+q);if(h&&h.hasClass("hidden")){return}}var j=ta.id("RECENTLY_VIEWED_MORE");if(j&&!j.hasClass("hidden")){j.addClass("hidden")}var o=$$("li.rv_item");var m=0;var g=false;if(o){m=o.length;for(var k=0;k<m;k++){if(!o[k].hasClass("geoItem")){g=true}}}if(!g){var l=ta.id("RV_SAVE");if(l){l.dispose()}}if(m===0){var h=ta.id("RECENTLY_VIEWED_LIST");if(h){h.dispose()}}else{if(m===1){var h=ta.id("COMPARE_HOTELS");if(h){h.getParent().addClass("hidden")}}}}},showSendMessage:function(s,f){if(s){s.stop()}if(ta.has("overlays.sendmessage.loading")){return}else{ta.store("overlays.sendmessage.loading",true);ta.remove.delay(500,null,"overlays.sendmessage.loading")}if(typeof(privateMsgCSS)!="undefined"&&!ta.retrieve("ta.privateMsgCssAsset")){ta.store("ta.privateMsgCssAsset",Asset.css(privateMsgCSS))}var j=ta.retrieve("overlays.sendmessage");var g="";if(f.get("tag")=="span"&&f.hasClass("fkASDF")){g=f.className.match(/u_([^ ]*)/)[1]}else{g=f.href}if(j&&g.match(/notyou=1/)){window.location="/NewsletterSignOut-e__2F__MemberSignIn"}else{if(j){return}}var q=f.className.match(/\b(callback_ShowRecaptcha)\b/);var l;if(q){new Asset.javascript("http://api.recaptcha.net/js/recaptcha_ajax.js");l="callback_ShowRecaptcha"}var d=f.className.match(/\bpm(\d)([A-F0-9]+)\b/);if(!d){return}var o=parseInt(d[1])==1?"cc":"cm";if(!userLoggedIn||migrationMember){var m=o=="cm"?"m2m_singin_greeting_d99":"";var p=d[2];ta.store("community.needsReload",true);window.loginSuccess=function(){if(!reg_overhaul){hideIFrame()}ta.common.sendmessage.communityLightbox(g,l)};if(reg_overhaul){var k=o=="cm"?"PRIVATE_MESSAGE":"COMPLIMENT_USER";ta.overlays.registration.connect({flow:k})}else{var h=!userLoggedIn?login:migrate;h(["tt",o,"greeting",m,"returnTo",getRelativeURL()])}return}var r=o=="cm"&&typeof(footprintGet)!="undefined"?footprintGet():null;if(r){g+="&LsoId="+r}ta.common.sendmessage.communityLightbox(g,l)},showConnectOverlay:function(g,d,f,j,h){ta.overlays.registration.connect(f,j,h)},showLoginOverlay:function(g,f,h,j,d){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCssAsset")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}ta.overlays.registration.request(h,j,d)},showRoomTipsOverlay:function(h,g,l){try{ta.util.cookie.setPIDCookie(4840);var f="http://"+window.location.hostname+"/AccommodationTips?d="+modelLocId;if(l){f=f+"&filterLang="+l}var j=false;var d=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_NEVER,style:"s3 dg nopadding",permanent:true,zIndex:"9997",showCloseButton:true,remoteContent:f,onLoad:function(){if(d.inner){var m=ta.id("emptyTips");if(m){j=true}}else{j=true}if(j){d.hide()}}},g)}catch(k){ta.util.error.record(k,"showRoomTipsOverlay")}},_loadSummaryCss:function(){if(typeof(conceptsCss)!="undefined"&&!ta.retrieve("ta.conceptsCssAsset")){ta.store("ta.conceptsCssAsset",Asset.css(conceptsCss))}},showReviewSummary:function(o,j,h,d){if(h&&d){ta.overlays.Factory.showSummaryTranslation(o,j,h);return}var k=null;var l=null;var f=null;var m=0;var g=0;if(o){o.stop()}if(j.id&&j.id!=""){k=j.id.replace("concept_","").replace(/_/g," ");ta.store("topconcepts.lastconcept",k);f="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+k;if(h){f+="&autotrans=true"}}else{ta.util.error.record(null,"showReviewSummary - elmt.id check");return}ta.overlays.Factory._loadSummaryCss();l=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding",autoShow:false,permanent:true,showCloseButton:true,remoteContent:f,onLoad:function(p){ta.store("topconcepts.overlay."+k,this);this.show()}},j);j.onclick=l.show;return false},showSummaryTranslation:function(m,h,l){ta.util.cookie.setPIDCookie(16007);if(m){m.stop()}var f="s3 dg nopadding";ta.overlays.Factory._loadSummaryCss();var k="/MachineTranslation?";if(h.id&&h.id!=""){var j;if(h.id.indexOf("trans_")!=-1){j=h.id.replace("trans_","").replace(/_/g," ")}else{j=h.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",j);k+="page=summary&";k+="d="+modelLocId+"&";k+="concept="+j;k+="&sl=en&tl="+l}var d="topconcepts.overlay."+j;var g=ta.retrieve(d);if(g){g.hide()}g=new ta.overlays.CenteredOverlay({style:f,showCloseButton:true,remoteContent:k,onLoad:function(o){ta.store(d,this);this.show()}},h)},toggleConceptSnippetTranslation:function(m,g){var l=null;var j=null;var k=null;var h=null;var d=null;if(m){m.stop()}if(g){ta.util.cookie.setPIDCookie(4111);k=g.id.replace(/[^_]*_(.*)/,"$1");l=ta.id("SUMMARYOVERLAY_"+k);if(l){j=l.getElements(".snippetText");for(var f=0;f<j.length;f++){if(j[f].isDisplayed()){j[f].hide()}else{j[f].show("inline")}}}h=ta.id("trans_"+k);d=ta.id("en_"+k);if(h.hasClass("activeButton")){h.removeClass("activeButton");h.addClass("inactiveButton")}else{h.removeClass("inactiveButton");h.addClass("activeButton")}if(d.hasClass("activeButton")){d.removeClass("activeButton");d.addClass("inactiveButton")}else{d.removeClass("inactiveButton");d.addClass("activeButton")}if(ta.overlays.Factory.storeReviewSummaryContent){ta.overlays.Factory.storeReviewSummaryContent(k.replace(/_/g," "),l.getParent().get("html"))}}},reviewTranslate:function(k,h,f){ta.util.cookie.setPIDCookie(16009);ta.overlays.Factory._loadSummaryCss();var g=ta.has("photo.viewer.lightbox");var j=1001;if(g){j=10001}var d=new ta.overlays.CenteredOverlay({style:"s4 dg",zIndex:j,showCloseButton:true,remoteContent:f,onLoad:function(l){this.show()}});ta.store("translationOverlay",d)},showRefreshedRecentLocationSaveOverlay:function(){setPID(3832);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}var f="";for(var d=1;d<7;d++){var g=ta.id("recently_viewed_"+d);if(g){if(f==""){f+=g.get("locid")}else{f+="-"+g.get("locid")}}}new Request({url:"/RecentlyViewedAjax",onSuccess:function(h){if(!h.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(h,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"subset_save_overlay",locNums:f},evalScripts:true,method:"get"}).send()},showRecentLocationSaveOverlay:function(){setPID(3832);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}new Request({url:"/RecentlyViewedAjax",onSuccess:function(d){if(!d.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(d,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"save_overlay"},evalScripts:true,method:"get"}).send()},createIPPinOverlay:function(f,g){var d;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 mg",onShow:function(){if(typeof(friendStripMouseoverPageAction)=="undefined"||!friendStripMouseoverPageAction){return}d=setTimeout(function(){new Request({url:"/ActionRecord?action="+friendStripMouseoverPageAction}).send();friendStripMouseoverPageAction=null},400)},onHide:function(){clearTimeout(d)},content:g},f)},createFriendActivityOverlay:function(f,g,h){var d;return new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 mg",onShow:function(){h&&ta.util.pending.lock("friendActivityOverlay.pageAction",function(){d=setTimeout(function(){new Request({url:"/ActionRecord?action="+h}).send()},400)})},onHide:function(){clearTimeout(d)},content:g},f)},createFriendActivityLightbox:function(d){return new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 mg friendActivity",content:d})},createCouponAnnouncementOverlayRedirect:function(l,j,k,h,d,g,f){ta.overlays.Factory.createCouponAnnouncementOverlay(null,null,l,j,k,h,d,g,f)},createCouponAnnouncementOverlay:function(f,h,j,o,g,p,m,l,k){ta.util.cookie.setPIDCookie(l);Asset.css(m);var d=new Object();d.act=j;if(k!=null){d.act+="-"+k}else{if(window.pageServlet!=null){d.act+="-"+pageServlet}}new Request({url:"/CouponAjax?"+(o?"couponId="+o+"&":"")+(g?"announcementId="+g+"&":"")+"locationId="+p+"&listing=true",data:d,onSuccess:function(r){var q=ta.overlays.showInLightbox(r,{style:"typeB4 og",delayedPosition:true});q.closeBtn.addEvent("click",ta.servlet.blcoupons.closeHandler)},evalScripts:true}).send()},postVideoLogin:function(f,d,g){if(g){ta.util.cookie.setPIDCookie(g)}ta.overlays.registration.connect({flow:"POST_VIDEO"},"SIGNIN")},fbLogin:function(f,d){ta.support.Facebook.login()},createAmenitiesLightbox:function(f){var k=location.pathname;if(k.length>0){if(k.charAt(0)=="/"){k=k.substring(1)}var j=k.indexOf("-");if(j>=0){k=k.substring(0,j)}}var d=f.id;if(d.indexOf("amenity_")==0){locationId=d.substring(8)}var g="http://"+document.domain;var h=false;if(ta.remove("amenities.suppressLinks")){h=true}new ta.overlays.RelativeOverlayBelow({autoShow:true,style:"s3 dg",showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,requestData:{d:locationId,tab:"amenities",from:k,suppressLinks:h},remoteContent:g+"/LocationTab"},f)},createAmenitiesLightboxFull:function(k,h,d){if(k){k.stop()}if(typeof(amenityLightboxCss)!="undefined"&&!ta.retrieve("ta.amenityLightboxCss")){ta.store("ta.amenityLightboxCss",Asset.css(amenityLightboxCss))}if(d&&d>0){setPID(d)}var g=h.id;if(g.indexOf("amenity_")==0){locationId=g.substring(8)}var j="http://"+document.domain;var f=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",onLoad:function(){this.position();ta.commerce.checkrates.updateCRForm("_amo");injectAdsTargeted(document.getElement("#AMENITY_LIGHTBOX"));this.position()},showCloseButton:true,permanent:true,requestData:{d:locationId,tab:"amenities_lightbox",from:pageServlet},remoteContent:j+"/LocationTab"},h);f.show();h.onclick=function(){f.show();ta.commerce.checkrates.updateCRForm("_amo")};return false},openSavesRegflow:function(){ta.widgets.Saves.openSavesRegflow()},openSavesHoverRegflow:function(){ta.widgets.Saves.openSavesHoverRegflow()},createGuideOverlay:function(){ta.overlays.registration.connect({flow:"DESTINATION_GUIDE"},"SIGNUP")},createPostPhotosOverlay:function(){ta.overlays.registration.connect({flow:"POST_PHOTOS"},"SIGNUP")},relBelowOverlaySolidGreenBorder:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 dg"},d)},createDropDown:function(j,f,h){f=ta.id(f);f.onmouseover=null;try{var d=new ta.overlays.RelativeOverlayBelow({content:h,style:"dropMenu",fontSize:"12px",zIndex:202,activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,onShow:function(k){f.addClass("tabLinkShown");f.addClass("arwLinkShown");f.getParent().addClass("tabItemShown");f.getElement("img").addClass("sprite-arrow_dropdown_wht_show")},onHide:function(k){f.removeClass("tabLinkShown");f.removeClass("arwLinkShown");f.getParent().removeClass("tabItemShown");f.getElement("img").removeClass("sprite-arrow_dropdown_wht_show");var l=h.getElements(".text");Array.each(l,function(m){var o=m.retrieve("typeAhead");if(o){o.hideChoices()}})}},f)}catch(g){return}d.pinAndSetUnpin=function(k){d.pin();document.addEvent("click",d.unpinAndSetPin)};d.unpinAndSetPin=function(k){k=new Event(k);if(!d.container.containsEvent(k)&&!k.target.hasClass("dropSelect")){d.hide();d.unpin();document.removeEvent("click",d.unpinAndSetPin);d.container.addEvent("click",d.pinAndSetUnpin)}};d.container.addEvent("click",function(k){d.pinAndSetUnpin(k)})},popConditionsOverlay:function(){var d=ta.id("CONDITIONS");if(d){ta.overlays.showInLightbox(d.innerHTML)}},showCompareOverLay:function(d,j,f){var k=window.location.protocol+"//"+window.location.hostname;var h=k+"/CompareHotels?detail="+f;for(var g=0;g<3;g++){var l=ta.id("compare_hotels_"+g);if(l&&l.checked==true){h=h+"&compareHotelId="+l.value}}new Asset.css(compareHotelCSS);new Request({url:h,onSuccess:function(m){new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"compareHotel",content:m})}}).send()},createNeighborhoodOverlay:function(k,h,d){if(ta.has("nbhdOverlay")){if(h){h.onclick=null}ta.retrieve("nbhdOverlay").show();return}var f=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,permanent:true,zIndex:"997",style:"nbhdOverlay typeO",activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,onShow:function(){if(d){ta.servlet.HACSearch.filter.update()}},onHide:function(){if(d){ta.servlet.HACSearch.filter.update()}}},"NEIGHBORHOOD_OVERLAY");var g=f.inner;var j=ta.id("NEIGHBORHOOD_FORM");if(g&&j){j.inject(g,"top");j.removeClass("hidden");ta.store("neighborhoodOverlayForm",j)}ta.store("nbhdOverlay",f)},createHACProgressOverlay:function(){try{if(ta.has("ta.hac.progress.overlay")){return ta.retrieve("ta.hac.progress.overlay")}var h=ta.id("HAC_PROGRESS_CONTAINER").dispose();var d=h.get("html");var g=new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",showCloseButton:false,content:d});ta.store("ta.hac.progress.overlay",g);return g}catch(f){ta.util.error.record(f,"createHACProgressOverlay")}},getFilterWaitOverlay:function(){var f=ta.retrieve("filters.waitDialog");if(!f){var d="mg s1 fatNotice";if(ta.isHotelsRedesign2011()){d=d+" fatNotice_2011"}f=new ta.overlays.CenteredOverlay({style:d,showCloseButton:false,autoShow:false,delayedPosition:true});f.inner.set("html","<b>"+JS_UpdatingYourResults+"</b>");ta.store("filters.waitDialog",f)}return f},showFilterWaitOverlay:function(f){var d=ta.overlays.Factory.getFilterWaitOverlay();if(d){if(f){d.show();d.position(false)}else{d.hide()}}},showUpdatingMessage:function(){var f=ta.overlays.Factory.getFilterWaitOverlay();f.show();if(ta.remove("filter.map")){f.container.setStyles({left:-9999,top:-9999});var g=ta.id(ta.retrieve("maps.container")).getCoordinates();var d=f.container.getCoordinates();f.container.setStyles({left:g.left+(g.width-d.width)/2,top:g.top+(g.height-d.height)/2})}if(ta.remove("filter.lockout")){f.enableBackdrop()}hideBCPromo()},createPhotoUploaderOverlay:function(d){var f=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:false,style:"s2 dg",innerDivClass:"noPadMarg",attachCloseEvent:true,permanent:true,onLoad:ta.media.uploader.onLoadOverlayHandler,onClose:function(){if(ta.has("tipsOverlay")&&ta.retrieve("tipsOverlay").hide){ta.retrieve("tipsOverlay").hide();ta.remove("tipsOverlay")}}});f.loadRemoteContent(d,true);ta.store("ta.media.uploader.photoUploaderOverlay",f)},createIpDeauthOverlay:function(f,d){new Request({url:"/ActionRecordPlus?action=DEAUTH_IP&id="+f,onSuccess:function(g){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:false}).loadRemoteSuccess(g);if(d){ta.support.Facebook.ipRevoke(10000)}},onFailure:ta.util.error.ajaxFailure.partial("partials:ip_disable")}).send()},kinderOverlay:function(j,g){try{g.onclick=null;var h={style:"s4 dg kinder",showCloseButton:true,isChild:true,activate:ta.overlays.ACTIVATE_CLICK};var d=document.getElement(".overlay");if(d){h.onShow=function(){var l=d.overlay;if(!l.pinned){l.unpinOnHide=true;l.pin()}},h.onHide=function(){var l=d.overlay;if(l.unpinOnHide){l.unpinOnHide=false;l.unpin()}}}var f=new ta.overlays.RelativeOverlayBelow(h,g)}catch(k){ta.util.error.record(k,"Error: kinderOverlay")}},loadBLSlideshowOverlay:function(h,g,f,d){new Request({url:"/BusinessListingsAjax",onSuccess:function(j){ta.overlays.showInLightbox(j,{backdrop:ta.overlays.BACKDROP_ALWAYS,style:"g s10px np"})},data:{act:"slideshow",detail:f,pid:d,flash:(Browser.Plugins.Flash.version>=10)},evalScripts:true,method:"get"}).send()},accountMenuFlyout:function(h,d){d.onmouseover=null;try{var g=new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"dropMenu accountMenuFlyout",onShow:function(){this.container.setStyle("margin-left","19px")},onHide:function(){this.container.setStyle("margin-left","0")}},d);ta.store("accountMenuFlyout",g)}catch(f){ta.util.error.record(f,"Error: ta.overlays.Factory.accountMenuFlyout")}},ratingMenuFlyout:function(h,d){d.onmouseover=null;try{var g=new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"dropMenu ja_ratingMenuFlyout"},d);ta.store("ratingMenuFlyout",g)}catch(f){ta.util.error.record(f,"Error: ta.overlays.Factory.ratingMenuFlyout")}},bizListingsMenuFlyout:function(j,d){d.onmouseover=null;try{var g=d.getNext("div"),f=ta.retrieve("accountMenuFlyout");if(g){g=g.get("html")}new ta.overlays.RelativeOverlayRight({content:g,zIndex:2000,style:"dropMenu bizListingsMenuFlyout",activate:ta.overlays.ACTIVATE_HOVER,onShow:function(){if(f){f.pin().show();this.container.addEvent("mouseleave",function(k){if(!f.container.containsEvent(k)){f.hide()}})}},onHide:function(){if(f){f.unpin()}}},d)}catch(h){ta.util.error.record(h,"Error: ta.overlays.Factory.bizListingsMenuFlyout")}},createDrop:function(h,d){d.onmouseover=null;try{var f=d.getNext().getElement(".subNav");ta.run("ta.overlays.Factory.createDropDown",{},h,d,f)}catch(g){ta.util.error.record(g,"Error: ta.overlays.Factory.createDrop")}},createFriendOfFriendOverlay:function(d,f){d.onclick=null;if(f){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_CLICK,style:"s2 mg",showCloseButton:true,content:f},d)}if(lazyImgs!=null){window.setupLazyLoad()}},CLOSE_BTN_RIGHT_OFFSET:15,ratingsFlyout:function(p,d,g,k){if(p){p.stop()}try{var j=d.get("class").match("rating(\\d)")[1];var l=ta.id("ratingsFlyout"+j).get("html");var o=null;var f="";if(g){o=ta.servlet.Reviews.ratingFlyoutScroll}var h="ratingOverlay dg s3 rgba_gry";if(k){f=" fixedHeight";h=h+" overlayWithScroll"}new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,content:l,innerDivClass:"ratingFlyout inner"+f,style:h,onscroll:o},d);new Request({url:"/ActionRecord?action=ratingsFlyout&pid=4304"}).send()}catch(m){ta.util.error.record(m,"showRatingsFlyout")}},sameGeoActivityOverlay:function(g,d,f){if(!ta.has("sameGeoActivityCSS")){ta.store("sameGeoActivityCSS",new Asset.css(sameGeoActivityCSS))}new ta.overlays.RelativeOverlayBelow({style:"s3 dg rgba_gry sameGeoActivityOverlay",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,onLoad:function(){this.show()},remoteContent:"/SameGeoActivity",requestData:f},d)},openTourismDescription:function(d){ta.servlet.Tourism.showGeoDescription(d)},memberPassportStampOverlay:function(g,d,f){if(!ta.has("passportStampsCSS")){ta.store("passportStampsCSS",new Asset.css(passportStampsCSS))}f.geos=f.geos.join(",");new ta.overlays.RelativeOverlayRight({style:"s3 dg rgba_gry memberPassportStamps",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,onLoad:function(){this.show()},remoteContent:"/MemberPassportStamps",requestData:f},d);new Request({url:"/ActionRecord?action="+f.actionRecord}).send()},relRightLocalContent:function(g,d,f){d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 og",content:ta.id(f).innerHTML},d)}}})();(function(a){Object.append(a,{injectReviewSummaryContentFromConcept:function(c){try{var b=ta.retrieve("topconcepts.rsContent")[c];if(!b){ta.util.error.record(null,"injectReviewSummaryContentFromConcept - no content")}ta.overlays.Factory.injectReviewSummaryContent(b)}catch(d){ta.util.error.record(d,"injectReviewSummaryContentFromConcept")}},injectReviewSummaryContent:function(c){try{var b=ta.retrieve("reviewSummaryOverlay");if(b){b.inner.setContent(c);b.show()}else{ta.util.error.record(null,"injectReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"injectReviewSummaryContent")}},storeReviewSummaryContent:function(d,c){var b=ta.retrieve("topconcepts.rsContent");if(!b){b={}}b[d]=c;ta.store("topconcepts.rsContent",b)},addSummaryBoxContentAndShow:function(g,d){try{var b=ta.retrieve("reviewSummaryOverlay");ta.overlays.Factory.injectReviewSummaryContent(d);var j=ta.id("SUMMARYBOX").clone(true,false);var c=b.inner;c.getElement(".title").adopt(j);var k="concept_"+g.replace(/ /g,"_");var f=document.getElement(".overlay .rd_concepts ."+k);if(f){f.removeClass("taLnk").removeClass("hvrIE6").addClass("conceptSelected").onClick=""}Array.each(c.getElements(".rd_concepts .snippetText"),function(l){var o=ta.id(l);o.removeClass("snippetText");var m=o.getElement(".taLnk");if(m){m.setProperty("onclick","ta.util.cookie.setPIDCookie(25223);ta.call('ta.overlays.Factory.showReviewSummaryV2',event, this);")}});ta.overlays.Factory.storeReviewSummaryContent(g,c.get("html"));ta.overlays.Factory.injectReviewSummaryContentFromConcept(g)}catch(h){ta.util.error.record(h,"updateReviewSummaryContent - request.onSuccess")}},updateReviewSummaryContent:function(c,b){try{if(ta.has("reviewSummaryOverlay")&&ta.has("topconcepts.rsContent")&&ta.retrieve("topconcepts.rsContent")[c]){ta.overlays.Factory.injectReviewSummaryContentFromConcept(c);return}if(ta.has("reviewSummaryOverlay")){new Request({url:b,onSuccess:function(f){ta.overlays.Factory.addSummaryBoxContentAndShow(c,f)},evalScripts:true,method:"get"}).send();return}else{ta.util.error.record(null,"updateReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"updateReviewSummaryContent")}},getReviewSummaryUrl:function(g,f,k,c){ta.store("topconcepts.lastconcept",g);if(typeof modelLocId=="undefined"||typeof modelGeoId=="undefined"){var j=(typeof modelLocId=="undefined")?"undefined":modelLocId;var d=(typeof modelGeoId=="undefined")?"undefined":modelGeoId;ta.util.error.record(null,"getReviewSummaryUrl",null,{locId:j,geoId:d})}if(k&&c){ta.util.cookie.setPIDCookie(16007);var h="/MachineTranslation?";if(f.id){var g;if(f.id.indexOf("trans_")!=-1){g=f.id.replace("trans_","").replace(/_/g," ")}else{g=f.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",g);h+="page=summary&";h+="d="+modelLocId+"&";h+="concept="+g;h+="&sl=en&tl="+k}return h}var b="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+g;if(k){b+="&autotrans=true"}return b},getReviewSummaryConcept:function(b){try{var c=b.id?b.id:b.className.match("(concept_[a-zA-Z0-9-_]+)")[1];return c.replace("concept_","").replace(/_/g," ")}catch(d){ta.util.error.record(d,"getReviewSummaryConcept",null,{id:b.id,"class":b.className})}return""},showReviewSummaryV2:function(j,f,h,c){if(j){j.stop()}var g=ta.overlays.Factory.getReviewSummaryConcept(f);var b=ta.overlays.Factory.getReviewSummaryUrl(g,f,h,c);if(ta.has("reviewSummaryOverlay")){ta.overlays.Factory.updateReviewSummaryContent(g,b);return}ta.overlays.Factory._loadSummaryCss();var d=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding rgba_gry",autoShow:false,permanent:true,showCloseButton:true,remoteContent:b,onLoad:function(k){try{ta.store("topconcepts.overlay."+g,this);ta.overlays.Factory.addSummaryBoxContentAndShow(g,this.inner.innerHTML);this.show()}catch(l){ta.util.error.record(l,"showReviewSummary - overlay onload")}}},f);ta.store("reviewSummaryOverlay",d)}})})(ta.overlays.Factory);ta.overlays.CalendarOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{showCloseButton:true,activate:ta.overlays.ACTIVATE_FOCUS,style:"typeO ocal",autoShow:false,autoShowCal:false,calendarOptions:null,flipPadding:25},initialize:function(a,b){this.input=a.getElement("input[type=text]");this.parent(b,this.input);this.input.overlay=this;this.dayField=a.getElement("input.day");this.monthField=a.getElement("input.month");this.source.addEvent("click",this.show);this.icn=a.getElement("span.icn");if(this.icn){this.icn.onclick="";this.icn.addEvent("click",this.show)}this.calendar=new ta.widgets.Calendar(Object.merge({dualCalendar:true,choiceLink:"ta.overlays.calendarSelect",prevAction:"ta.overlays.calendarPrev",nextAction:"ta.overlays.calendarNext",onSelect:this.select.bind(this)},this.options.calendarOptions));this.inner.adopt(this.calendar.container);this.parentOverlay=a.getParent(".overlay");if(this.parentOverlay){this.parentOverlay=this.parentOverlay.overlay;this.options.isChild=true}if(this.options.autoShowCal){this.show()}},destroy:function(){this.parent();this.input.overlay=null},show:function(b){var a=this.visible;this.parent(b);if(a){return}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.loadFields();this.calendar.update();this.calendar.reposition();return this},hide:function(a){if(!this.visible){return}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},hideNow:function(a){if(!this.visible){return this}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},select:function(o,g){if(g){new Event(g).preventDefault()}this.updateFields();this.hide();this.fireEvent("onSelect",this);if(ta.has("isDaoDaoCRRedesign")){try{this.dateSelected=true;var p=this.theOtherCal;if(p.dateSelected){this.dateSelected=false;p.dateSelected=false;var m=$$(".crrAvailability");if(m!=null){m.each(function(y){y.innerHTML="";y.removeClass("available");y.removeClass("partiallyAvailable")})}["hac_result_debug","hac_result_debug_lightbox"].each(function(z){var y=ta.id(z);if(y!=null){y.innerHTML=""}});if(ta.retrieve("doQueryCRData")==true){var w=parseInt(this.dayField.value.replace(/^0/,""));var l=this.monthField.value.split(/\//);if(l.length!=2){return}var d=parseInt(l[1]);var b=parseInt(l[0].replace(/^0/,""));var t=b+"/"+w+"/"+d;var v=parseInt(p.dayField.value.replace(/^0/,""));var k=p.monthField.value.split(/\//);if(k.length!=2){return}var c=parseInt(k[1]);var a=parseInt(k[0].replace(/^0/,""));var r=a+"/"+v+"/"+c;var q={};var u=ta.overlays.Factory.getFilterWaitOverlay();u.container.setStyle("zIndex",10000);if(ta.retrieve("showDateUpdateSpinOverlay")==true){u.show();var j=ta.id("CHECK_RATES_CONT").getCoordinates();var h=u.container.getCoordinates();u.container.setStyles({left:j.left+(j.width-h.width)/2,top:j.top+(j.height-h.height)/2})}var s="/DaoDaoCheckRatesAjax?action=getCRData&hotelId="+modelLocId+"&date1="+t+"&date2="+r;if(ta.has("hacGroupNames")){s=s+"&hacGroupNames="+ta.retrieve("hacGroupNames")}if(this.qcArea!=null){s=s+"&qcCustomArea="+this.qcArea}new Request({url:s,method:"get",data:q,onSuccess:function(B){var y=JSON.decode(B.toString().trim());var I=y.lowestDailyPrice;if(I>0){var z=$$(".lowest_daily_price_container");if(z.length==0){if(ta.id("PRICE_ANNOUNCE")!=null){var D='\u623F\u4EF7<em class="lowest_daily_price_container">'+I+"</em>\u5143\u8D77";ta.id("PRICE_ANNOUNCE").innerHTML=D}}else{z.each(function(K){if(K!=null){K.innerHTML=I}})}}else{if(ta.id("PRICE_ANNOUNCE")!=null){ta.id("PRICE_ANNOUNCE").innerHTML="\u6682\u65E0\u623F\u4EF7"}}var J=y.crResultByAuthors;var G=y.cntAvailableProviders;var E=y.cntPartiallyAvailableProviders;if(J!=null){var F=["daodaoResult","daodaoResult_lightbox"];F.each(function(L){var K="#"+L+" ul li";$$(K).each(function(O){var P=O.get("author");var T=O.get("slot");var N=J[P];var U=false;var M=0;var R=false;if(N){var Q=N.availabilityInfo;if(Q.hasAvailableRoom){U=true}else{if(Q.hasPartiallyAvailableRoom){U="'partial'"}}M=N.rateInfo.lowestPrice;if(I>0&&M==I){R=true}}if(I>0){var S="dd.commerce.checkrates.popOneWithHACResult("+T+", event, this, "+modelLocId+", "+U+", "+M+", "+R+", "+G+", "+E+")";O.setProperty("onclick",S);if(Browser.ie6||Browser.ie7){O.onclick=function(){dd.commerce.checkrates.popOneWithHACResult(T,event,this,modelLocId,U,M,R,G,E)}}}else{var S="dd.commerce.checkrates.popOneWithHACResult("+T+", event, this, "+modelLocId+", false, 0, false, 0, 0)";O.setProperty("onclick",S);if(Browser.ie6||Browser.ie7){O.onclick=function(){dd.commerce.checkrates.popOneWithHACResult(T,event,this,modelLocId,false,0,false,0,0)}}}})});for(var A in J){var H=J[A];var C=$$(".availability_"+A);if(C!=null){C.each(function(K){K.innerHTML="";K.removeClass("available");K.removeClass("partiallyAvailable");var L=H.availabilityInfo;if(L.hasAvailableRoom){K.innerHTML="";K.addClass("available")}else{if(L.hasPartiallyAvailableRoom){K.innerHTML="";K.addClass("partiallyAvailable")}}})}}["hac_result_debug","hac_result_debug_lightbox"].each(function(P){var K=ta.id(P);if(K!=null){var N="";for(var Q in J){var M=J[Q];var O=M.providerName;var L=M.rateInfo.lowestPrice;N+=("("+O+":"+L+")")}K.innerHTML=N}})}u.hide()}}).send()}}else{p.show(g)}}catch(f){ta.util.error.record(f,"calendar select for DaoDao CR Redesign")}}},loadFields:function(){var b=parseInt(this.dayField.value.replace(/^0/,""));var a=this.monthField.value.split(/\//);if(a.length!=2){return}var c=parseInt(a[1]);a=parseInt(a[0].replace(/^0/,""));this.calendar.selectedDate=new Date(c,a-1,b);return this},updateFields:function(){if(!this.calendar.selectedDate){this.loadFields()}if(!this.calendar.selectedDate){return}var a=this.calendar.selectedDate.getMonth()+1;if(a<10){a="0"+a}this.dayField.value=this.calendar.selectedDate.getDate();this.monthField.value=a+"/"+this.calendar.selectedDate.getFullYear();this.input.value=formatDate(this.calendar.selectedDate.getDate(),this.calendar.selectedDate.getMonth(),this.calendar.selectedDate.getFullYear())},clearFields:function(){this.input.value=JS_DateFormat},validate:function(){var b=this.input.value.match(DATE_FORMAT.pattern);if(b){var c=parseInt(b[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(b[DATE_FORMAT.month].replace(/^0/,""));var d=parseInt(b[DATE_FORMAT.year].replace(/^0/,""));if(c>0&&c<32&&a>0&&a<13){if(c<10){c="0"+c}if(a<10){a="0"+a}if(d<100){d+=2000}this.dayField.value=c;this.monthField.value=a+"/"+d;this.loadFields();if(!this.calendar.isValid()){return sInvalidDates}}else{return sInvalidDates}}else{return sInvalidDates}return null}});ta.overlays.createCalendar=function(b,a){new Event(b).preventDefault();a.onfocus="";new ta.overlays.CalendarOverlay($(a).getParent(".cal"),{autoShowCal:true})};ta.overlays.calendarSelect=function(g,f,a,c,b){if(ta.has("checkrates.calendarActionRecord")){ta.util.cookie.removePIDCookie();ta.commerce.checkrates.actionRecord(ta.retrieve("checkrates.calendarActionRecord"))}$(b).getParent(".overlay").overlay.calendar.select(g,new Date(f,a,c))};ta.overlays.calendarPrev=function(b,a){$(a).getParent(".overlay").overlay.calendar.prev()};ta.overlays.calendarNext=function(b,a){$(a).getParent(".overlay").overlay.calendar.next()};ta.overlays.PairedCalendar=new Class({Implements:[Options,Events],options:{validate:false,allowSameDay:false,calendarOptions:null,defaultSpan:1,keepDelta:false,clearDatesId:"clearDates",overlayOptions:{}},initialize:function(b,a){this.setOptions(a);b=ta.id(b);this.form=b.get("tag")=="form"?b:b.getParent("form");var c=Object.merge({onSelect:this.adjustRange.bind(this)},this.options.overlayOptions);if(this.options.calendarOptions){c.calendarOptions=this.options.calendarOptions}this.form.getElements(".cal").each(function(d){var g=new ta.overlays.CalendarOverlay(d,c);g.input.onfocus="";if(d.hasClass("first")){this.before=g}else{this.after=g;if(ta.has("isDaoDaoCRRedesign")){this.after.theOtherCal=this.before;this.before.theOtherCal=this.after;var f=this.form.get("qc_area");this.after.qcArea=f;this.before.qcArea=f}}if(b==g.input||b==g.icn){g.show()}},this);if(this.form){this.form.calendar=this;if(this.options.validate){this.form.addEvent("submit",this.validate.bind(this));this.errorDiv=this.form.getElement(".error_msg")}}},getOverlayForCalendar:function(a){if(this.before.calendar==a){return this.before}if(this.after.calendar==a){return this.after}return null},adjustRange:function(c){this.requireFullLoad();if(this.form.searchAll){if(this.form.searchAll.type=="checkbox"){this.form.searchAll.checked=false}else{if(this.form.searchAll.type=="hidden"){this.form.searchAll.value="false"}}}var b=ta.id(this.options.clearDatesId);if(b){b.style.visibility="visible"}if(!this.sameDayEnabled()&&this.after.calendar.selectedDate&&this.after.calendar.selectedDate.getTime()==this.after.calendar.options.firstDate.getTime()){this.before.calendar.selectedDate=new Date(this.before.calendar.options.firstDate);if(this.options.keepDelta){this.options.defaultSpan=1}var j=new Date(this.after.calendar.options.firstDate);j.setDate(j.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=j;this.before.updateFields();this.after.updateFields()}else{if(c==this.before){if(this.options.keepDelta||!this.isBeforeValid()){var j=new Date(this.before.calendar.selectedDate);j.setDate(j.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=j}this.after.updateFields()}else{if(c==this.after){if(!this.isAfterValid()){var j=new Date(this.after.calendar.selectedDate);j.setDate(j.getDate()-this.options.defaultSpan);if(j.getTime()<this.before.calendar.options.firstDate.getTime()){j=new Date(this.before.calendar.options.firstDate.getTime())}this.before.calendar.selectedDate=j}this.before.updateFields()}}}if(this.options.keepDelta&&this.before.calendar.selectedDate){this.options.defaultSpan=ta.util.date.getDaysInRange(this.before.calendar.selectedDate,this.after.calendar.selectedDate)-1;if(this.sameDayEnabled()){if(this.options.defaultSpan<0){this.options.defaultSpan=0}}else{if(this.options.defaultSpan<1){this.options.defaultSpan=1}}}this.fireEvent("onUpdate",this);var g=ta.retrieve("calendar.onUpdateCallback");if(g){for(var f=0;f<g.length;f++){if(window[g[f]]){window[g[f]](this,c)}}}this.updateMinStay(this.before.calendar.selectedDate,this.after.calendar.selectedDate);try{var a="before";if(c==this.after){a="after"}ta.commerce.checkrates.triggerAvailCheck.call(this,a);ta.commerce.checkrates.triggerAvailCheck.delay(1500,this,false);ta.store("avail.check.query.complete",true)}catch(h){ta.util.error.record(h,"availability check - paired cal")}},updateMinStay:function(a,c){var b=ta.id("minStay");if(b&&a&&c){b.disabled=true;b.selectedIndex=this.getMinStayIndex(a,c)}},getMinStayIndex:function(a,c){var b=ta.util.date.getDaysInRange(a,c)-1;if(b<7){return b}else{if(b<28){return 7}else{return 8}}},isOneWay:function(){return this.form.oneWay&&this.form.oneWay.checked},sameDayEnabled:function(){return this.options.allowSameDay||this.isOneWay()},searchAllEnabled:function(){return this.form.searchAll&&(this.form.searchAll.checked||(this.form.searchAll.type=="hidden"&&this.form.searchAll.value=="true"))},updateFields:function(){this.before.updateFields();this.after.updateFields()},clearFields:function(){this.before.clearFields();this.after.clearFields()},requireFullLoad:function(){if(!this.before.calendar.selectedDate){this.before.loadFields()}if(!this.after.calendar.selectedDate){this.after.loadFields()}},isBeforeValid:function(){this.requireFullLoad();if(!this.after.calendar.selectedDate){return true}return(this.before.calendar.selectedDate<this.after.calendar.selectedDate)||(this.sameDayEnabled()&&this.before.calendar.selectedDate.getTime()<=this.after.calendar.selectedDate.getTime())},isAfterValid:function(){this.requireFullLoad();if(!this.before.calendar.selectedDate){return true}return(this.after.calendar.selectedDate>this.before.calendar.selectedDate)||(this.sameDayEnabled()&&this.after.calendar.selectedDate.getTime()>=this.before.calendar.selectedDate.getTime())},validate:function(d){if(this.searchAllEnabled()){return true}var a=this.before.validate();var b=this.after.validate();var c=true;if(this.isOneWay()){if(a!=null){c=false;this.setError(a)}}else{if(a!=null||b!=null){c=false;this.setError(a||b)}else{if(!this.isAfterValid()){c=false;this.setError(sInvalidDates)}}}if(!c&&d){new Event(d).stop()}return c},setError:function(a){if(!this.errorDiv){return}this.errorDiv.setContent(a).show()},toggleSearchAll:function(){if(this.searchAllEnabled()){this.before.clearFields();this.after.clearFields()}else{this.requireFullLoad();this.before.updateFields();this.after.updateFields()}}});ta.overlays.createSimplePairedCalendar=function(b,a){new Event(b).stop();new ta.overlays.PairedCalendar(a)};ta.overlays.createSpannedPairedCalendar=function(c,a,b){new Event(c).stop();new ta.overlays.PairedCalendar(a,{defaultSpan:b})};ta.overlays.createPairedCalendar=function(c,b,a){if(!a){a={validate:true}}new Event(c).preventDefault();return new ta.overlays.PairedCalendar(b,a)};ta.overlays.toggleOffSearchAll=function(a){if(a.calendar&&a.searchAll){if(a.searchAll.type=="checkbox"){a.searchAll.checked=false}else{if(a.searchAll.type=="hidden"){a.searchAll.value="false"}}a.calendar.toggleSearchAll()}};ta.overlays.toggleOnSearchAll=function(a){a=ta.id(a);var b=a.getParent("form");if(!b.calendar){new ta.overlays.PairedCalendar(a,{validate:true,clearDatesId:a})}if(b.calendar&&b.searchAll){if(b.searchAll.type=="checkbox"){b.searchAll.checked=true}else{if(b.searchAll.type=="hidden"){b.searchAll.value="true"}}b.calendar.toggleSearchAll()}};ta.overlays.toggleSearchAll=function(d,b,a){b=ta.id(b);b.onclick="";var c=b.getParent("form");if(!a){a={validate:true}}if(!c.calendar){new ta.overlays.PairedCalendar(b,a)}c.calendar.toggleSearchAll(b);b.addEvent("click",c.calendar.toggleSearchAll.bind(c.calendar))};ta.overlays.clearDates=function(c,a){ta.overlays.toggleOnSearchAll(a);ta.id(a).style.visibility="hidden";var b=ta.id("minStay");if(b!==null){b.disabled=false;b.selectedIndex=0;filtersChanged(c)}};ta.overlays.PermanentOverlay=new Class({Extends:ta.overlays.AbsoluteOverlay,initialize:function(a,b){this.parent(Object.merge({permanent:true},a),b)}});ta.overlays.SkinnyOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,initialize:function(a,b){this.parent(a,b);this.container.setStyle("max-width","120px");if(Browser.ie6){this.shim.setStyle("max-width","120px")}}});ta.overlays.Registration=new Class({Implements:[Options,Events],Binds:["response","failure"],options:{flow:null,url:"/Registration",isOverlay:true,pageTarget:null,responseCallback:null,completeCallback:null,customOverlayOptions:{}},initialize:function(a){this.setOptions(a);if(this.options.isOverlay){this.overlay=new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:false,style:"s4 dg",attachCloseEvent:false},this.options.customOverlayOptions));if(this.overlay.closeBtn){this.overlay.closeBtn.addEvent("click",this.cancel.bind(this))}}},getRequestData:function(){var a={flow:this.options.flow};if(ta.has("registration.data")){a=Object.merge(a,ta.retrieve("registration.data"))}if(ta.has("page.geo")){a.geo=ta.retrieve("page.geo")}a.source=pageServlet;a=[a];Array.from(arguments).each(function(b){a.push(b)});return a},request:function(b,a){ta.store("registration.method","request");new Request({url:this.options.url,method:"get",evalScripts:true,data:this.getRequestData(a,{action:b}),onSuccess:this.response,onFailure:this.failure}).send();return this},post:function(a){if(ta.has("facebook.authcode.param")){a=Object.merge(a,{FBAuthCode:ta.remove("facebook.authcode.param")})}ta.store("registration.method","post");new Request({url:this.options.url,method:"post",evalScripts:true,data:this.getRequestData(a),onSuccess:this.response,onFailure:this.failure}).send();return this},cancel:function(){ta.store("registration.method","cancel");new Request({url:this.options.url,method:"get",evalScripts:true,data:this.getRequestData({CANCEL:"y",action:ta.retrieve("registration.action")}),onSuccess:this.response,onFailure:this.failure}).send();return this},log:function(a){new Request({url:this.options.url,method:"get",evalScripts:false,data:this.getRequestData({action:"LOG",pageAction:a})}).send();return this},response:function(a){if(!ta.remove("registration.noop")){if(this.options.isOverlay){this.overlay.loadRemoteSuccess(a);if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{this.options.pageTarget.innerHTML=a}}if(this.options.responseCallback){setTimeout(this.options.responseCallback,1)}if(ta.has("registration.afterUpdate")){ta.remove("registration.afterUpdate").each(function(b){setTimeout(b,1)})}},close:function(){if(this.options.isOverlay){this.overlay.hide()}this.fireEvent("onComplete");if(this.options.completeCallback){this.options.completeCallback()}},failure:function(c){var a=0;var d=ta.remove("registration.method");try{a=c.status}catch(b){}if(a==503){this.overlay.loadRemoteSuccess('<div style="padding:6px;">'+JS_maintenance+"</div>");if(this.overlay.closeBtn){this.overlay.closeBtn.removeEvents("click");this.overlay.closeBtn.addEvent("click",ta.overlays.registration.close)}if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{if(d=="cancel"){ta.overlays.registration.close()}ta.util.error.ajaxFailure.partial("Registration:"+d)}}});ta.overlays.registration={getInstance:function(a){var b=ta.retrieve("registration.instance");if(!b){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}b=new ta.overlays.Registration(a);ta.store("registration.instance",b)}return b},connect:function(a,d,c){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}if(ta.has("facebook.available")&&ta.retrieve("facebook.available")){var f={fbAvailable:true}}else{if(ta.has("registration.forceFBAvailable")){var f={fbAvailableForce:ta.remove("registration.forceFBAvailable")}}}var b="SIGNIN";ta.remove("registration.data");ta.overlays.registration.getInstance(a).request(d||b,Object.merge({},c,f))},post:function(b,a){var c=a||window.event;if(c){new Event(c).stop()}ta.overlays.registration.getInstance().post(b)},request:function(c,b,a){if(c=="SIGNUP"||c=="SIGNIN"){b=Object.merge({fbAvailable:ta.has("facebook.available")&&ta.retrieve("facebook.available")},b)}ta.overlays.registration.getInstance(a).request(c,b)},deferredRequest:function(d,b,f,c,a){ta.overlays.registration.getInstance(a).request(f,c,a)},cancel:function(){ta.overlays.registration.getInstance().cancel(false)},log:function(a){ta.overlays.registration.getInstance().log(a)},close:function(){var a=ta.remove("registration.instance");if(a){a.close()}},switchFlow:function(a){ta.overlays.registration.getInstance().options.flow=a},logAndPost:function(a,c,b){ta.overlays.registration.getInstance(a).log(c).post(b)}};ta.servlet.Registration={realNameDone:function(a){if(ta.id("use_real_name")&&ta.id("use_real_name").getProperty("checked")||ta.id("chooseNameFB")){ta.overlays.registration.post(ta.id("RealName"),a)}else{ta.overlays.registration.cancel()}},screenEdit:function(a){ta.id("screen").set("value","");ta.id("screen").focus();ta.id(a).hide()}};ta.overlays.PopoutOverlay=new Class({Extends:ta.overlays.Overlay,options:{backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.placeholder.setStyles({marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.source.setStyles({marginBottom:0,marginTop:0});if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(a){this.sourceCoords=this.source.getCoordinates();this.placeholder.setStyles({width:this.sourceCoords.width,height:this.sourceCoords.height});this.inner.adopt(this.source);this.parent(a)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"})},position:function(){var b=parseInt(this.container.getStyle("borderTopWidth").replace(/px/,""));var a=parseInt(this.container.getStyle("borderLeftWidth").replace(/px/,""));this.container.setStyles({left:this.sourceCoords.left-a,top:this.sourceCoords.top-b,width:this.sourceCoords.width,display:"block"});this.parent()}});ta.overlays.PopoutWithOverlay=new Class({Extends:ta.overlays.Overlay,options:{position:"topleft",edge:"topright",offset:{x:-10,y:0},scrollOffset:-20,backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.popout=new Element("div",{styles:{position:"absolute",zIndex:"10002",fontSize:"0.75em",display:"none"}}).inject(document.body);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(b){this.parent(b);var a=this.source.getCoordinates();this.placeholder.setStyles({width:a.width,height:a.height,marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.popout.setStyles({left:a.left,top:a.top,width:a.width,display:"block"}).adopt(this.source)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"});this.popout.setStyle("display","none")},position:function(){var a=this.source.getCoordinates();this.container.setStyles({left:null,top:a.top+this.options.offset.y,right:window.getWidth()-(a.left+this.options.offset.x)});this.parent();window.scrollTo(0,a.top+this.options.offset.y+this.options.scrollOffset)}});ta.overlays.CoverOverlay=new Class({Extends:ta.overlays.Overlay,options:{autoShow:true,xOff:0,yOff:0},initialize:function(a,b){this.parent(a,b);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}if(this.options.autoShow){this.show()}},position:function(){var b=this.source.getCoordinates();var a=this.container.getCoordinates();this.container.setStyles({left:b.left+(b.width/2-a.width/2)+this.options.xOff,top:b.top+(b.height/2-a.height/2)+this.options.yOff})},updateBackdrop:function(){var a=this.source.getCoordinates();this.backdrop.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})}});ta.commerce.Vendor=new Class({Implements:Options,options:{checkboxID:false,additionalOffer:false,defaultChecked:false,minDaysOut:0,maxDaysOut:0},initialize:function(c,d,f,a,b){this.setOptions(c);this.name=d;this.url=f;this.window=null;this.slot=null;this.opened=false;this.vendorName=a;this.propertyId=b;this.isFlight=false},isChecked:function(){if(this.options.checkboxID){var a=ta.id(this.options.checkboxID);if(!a){a=ta.id(this.options.checkboxID+"_pop")}if(!a){a=ta.id(this.options.checkboxID+"_icr")}if(a){try{var b=ta.id(a).getParent("li");if(b&&b.style.display=="none"){return false}}catch(c){ta.util.error.record(c,"cr checkbox hidden check")}return a.checked}}return this.options.defaultChecked&&(this.options.available||ta.retrieve("checkrates.datesChanged"))},isAvailable:function(){if(!this.isOpened()){return true}return false},isOpened:function(){try{if(!this.opened||!this.hasWindow()){return false}}catch(a){}return true},isDefaultChecked:function(){return this.options.defaultChecked},isHidden:function(){var a=ta.id(this.options.checkboxID);if(!a){a=ta.id(this.options.checkboxID+"_pop")}if(!a){a=ta.id(this.options.checkboxID+"_icr")}if(a){try{var b=ta.id(a).getParent("li");if(b){if(b.style.display=="none"){return true}else{if(this.options.hide){if(b.style.display=="block"){return false}else{return true}}}}}catch(c){ta.util.error.record(c,"checkbox hide check")}}return false},hasWindow:function(){if(!this.window||!this.window.windowObject||!("closed" in this.window.windowObject)||this.window.windowObject.closed){return false}return true},getUrl:function(f){var d=this.url;if(this.isFlight){d+="&"+f.getFlightData()}else{if(f.type!="checkdeals"){var c=f.getUserData();if(!c){c=ta.retrieve("checkrates.avUserData")}d+="&"+c;var g="QC_Inline";var a=f.trigger;if(a){var b=false;if(b=a.className.match(/custom_area_(\w+)/)){g=b[1]}}d=ta.commerce.checkrates.addCustomUrlParams(d,g)}else{if(ta.has("photo.viewer.isPhotoLBClick")){d=ta.commerce.checkrates.addCustomUrlParams(d,"QC_Inline")}}}return d},errorString:function(){var a=[];if(this.name){a.push("&name_");a.push(this.name)}if(this.slot){a.push("&slot_full")}if(this.propertyId){a.push("&propId_");a.push(this.propertyId)}var b=a.join("");if(b&&b[0]){return b.slice(1)}return"noInfo"},hasDateLimits:function(){return this.options.minDaysOut>0||this.options.maxDaysOut>0}});ta.commerce.VendorSet=new Class({Implements:Options,options:{vendorSet:false},initialize:function(b,a){this.setOptions(b);this.vendorSetId=a;if(this.options.vendorSet){this.vendors=this.options.vendorSet}this.vendorsUnchecked=[];this.vendorsDefaultUnchecked=[]},getVendors:function(){if(!this.vendors){this.vendors=ta.retrieve("checkrates.vendors."+this.vendorSetId)}return this.vendors},getVendorsUnchecked:function(){var c=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var a=0;a<c.length;a++){var b=c[a];if(!b.isChecked()&&!b.isHidden()){this.vendorsUnchecked.push(b)}}return this.vendorsUnchecked},getVendorsDefaultUnchecked:function(){try{var d=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var a=0;a<d.length;a++){var c=d[a];if(!c.isChecked()&&!c.isHidden()&&!c.isDefaultChecked()){this.vendorsDefaultUnchecked.push(c)}}return this.vendorsDefaultUnchecked}catch(b){ta.util.error.record(b,"vendorSet - default unchecked")}},getCheckedInfo:function(p){var q=0;var o=0;var b=0;var c=[];var j=[];var r=[];var d=[];var a=[];try{var m=this.getVendors();for(var f=0;f<m.length;f++){var l=m[f];d.push(l.name);d.push("__");if(l.isChecked()){q++;c.push(l.name);c.push("__")}else{a.push(l.name);a.push("__")}if(l.window&&l.window.closed){l.window=null}else{if(l.isOpened()){o++;j.push(l.name);j.push("__")}}}var k=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var f=0;f<k.length;f++){var g=k[f];if(g.isHidden()){b++;r.push(g.name);r.push("__")}}if(c.length>0){c.pop()}if(j.length>0){j.pop()}if(r.length>0){r.pop()}if(d.length>0){d.pop()}if(a.length>0){a.pop()}if(p=="unavail_set"){return{vendorsAvailable:d.join(""),vendorsOpened:j.join("")}}else{if(p=="unchecked"){return{vendorsUnchecked:a.join("")}}else{if(p=="count"){return q}else{if(p=="tpw_string"){return c.join("")}else{if(p=="open_count"){return o}else{if(p=="check_more"){return{vendorsChecked:c.join(""),vendorsOpened:j.join(""),vendorsHidden:r.join("")}}else{if(p=="now_checking"){return{vendorsChecked:c.join("")}}}}}}}}}catch(h){}return{checked:q,tpw_string:c.join(""),open:o,tpw_open_string:j.join("")}},getCheckedCount:function(){return this.getCheckedInfo("count")},getCheckedString:function(){return this.getCheckedInfo("tpw_string")},oneChecked:function(){var a=this.getCheckedCount();if(a==0){alert(js_0001);return false}return true},getOpenCount:function(){return this.getCheckedInfo("open_count")},storeCheckBoxValues:function(){var a={};this.getVendors().each(function(b){a[b.name]=b.isChecked()});ta.store("checkBoxSet_"+this.vendorSetId,a)},errorString:function(){var a=[];var b=this.getVendors();if(!b||b.length<1){return"empty.vendor.set"}a.push("VSet::");b.each(function(d,c){a.push("V");a.push(c);a.push(":");a.push(d.errorString())});return a.join("")}});ta.commerce.CheckRatesData=new Class({Implements:Options,options:{type:"checkRates",evnt:false},initialize:function(f,b,h,c,a){this.setOptions(f);this.trigger=b;this.type=this.options.type;this.vendorSetId=h;this.isCheckMore=c;this.propId=h;this.isLimitChecked=a;this.maxAllowedWin=0;this.maxHoldingWin=2;this.useHoldingWin=false;this.cap=3;if(Browser.chrome){if(Browser.version==22){this.maxAllowedWin=2}else{if(Browser.version>22){this.maxAllowedWin=1}}}else{if(Browser.ie){this.maxAllowedWin=1}}var d=null;if(d=b.className.match(/id_(\d+)/)){this.propId=d[1]}if(this.vendorSetId){this.vendorSet=new ta.commerce.VendorSet({},this.vendorSetId)}if(this.trigger){var g=ta.id(this.trigger);this.formElem=g.getParent("form");if(this.formElem){this.infoField=this.formElem.getElement("span.error_msg")||this.formElem.getElement("span.error_msg_geo")}}},showInfo:function(a){if(this.infoField){this.infoField.addClass("errorSpan");this.infoField.setContent(a).show()}},hideInfo:function(){if(this.infoField){this.infoField.hide();this.infoField.removeClass("errorSpan")}},showErrors:function(g,b){var a=[];if(!ta.retrieve("ta.commerce.CheckRatesData.cssAsset")){ta.store("ta.commerce.CheckRatesData.cssAsset",Asset.css(CDNHOST+"/css2/common/validation_error.css"))}if(b instanceof Array&&b.constructor==Array){a=b}else{a.push(b)}for(var f=0;f<a.length;f++){var d=a[f];if(d){d.addClass("errorInput");var c=ta.id("lbl_"+d.id);if(c){c.addClass("errorLabel")}}}this.showInfo(g)},clearErrors:function(a,c){var b=ta.id("lbl_"+a.id);var d=ta.id("lbl_"+c.id);if(a){a.removeClass("errorInput")}if(c){c.removeClass("errorInput")}if(b){b.removeClass("errorLabel")}if(d){d.removeClass("errorLabel")}},validate:function(){if(!this.trigger||!this.vendorSetId||!this.getVendorSet()||!this.getVendorSet().getVendors()){try{var b="NoVendSet";if(this.getVendorSet()){b=this.getVendorSet().errorString()}var a="NoTrigger";if(this.trigger){a=ta.util.error.getSelectorString(this.trigger)}ta.util.error.record(null,"cr data validate",new Event(this.options.evnt),{trigger:a,vendorSetId:this.vendorSetId,vendorSet:b})}catch(c){}return false}if(!this.getVendorSet().oneChecked()||!this.validateDates()){return false}return true},getVendorSet:function(){if(this.reorderedVendorSet){return this.reorderedVendorSet}return this.vendorSet},getAvailVendorSet:function(){if(!this.availVendorSet){this.setAvailVendorSet()}return this.availVendorSet},getOriginalVendorSet:function(){return this.vendorSet},validateDates:function(){var b=ta.id("checkIn_"+this.vendorSetId);var c=ta.id("checkOut_"+this.vendorSetId);var a=false;checkInElemPer=ta.id("checkIn_"+this.vendorSetId+"_per");if(checkInElemPer){b=checkInElemPer;c=ta.id("checkOut_"+this.vendorSetId+"_per")}checkInElemPto=ta.id("checkIn_"+this.vendorSetId+"_pto");if(checkInElemPto){b=checkInElemPto;c=ta.id("checkOut_"+this.vendorSetId+"_pto")}if(!this.formElem||!b||!c||!b.value||!c.value){if(!b){b=ta.id("checkIn_"+this.vendorSetId+"_pop");c=ta.id("checkOut_"+this.vendorSetId+"_pop")}if(!this.formElem||!b||!c||!b.value||!c.value){return true}}this.inDate=this.parseDate(b.value);this.outDate=this.parseDate(c.value);this.clearErrors(b,c);this.errorMsg=this.dateErrorCheck(this.inDate);if(this.errorMsg){this.showErrors(this.errorMsg,b);a=true}this.errorMsg=this.dateErrorCheck(this.outDate);if(this.errorMsg){this.showErrors(this.errorMsg,c);a=true}if(this.inDate&&this.outDate&&(this.outDate.getTime()<=this.inDate.getTime())){this.errorMsg=js_0003;this.showErrors(this.errorMsg,[c,b]);a=true}if(window.cookieDomain==".daodao.com"&&a){new Request({url:"/ActionRecord?action=DaodaoInlineCRClick"}).send();var d=ta.retrieve("daodao.checkrate.error.nodate");if(d!=null){alert(d)}}return !a},parseDate:function(b){var d=false;if(DATE_FORMAT&&b){var c=b.match(DATE_FORMAT.pattern);if(c){var f=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var g=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(f>0&&f<32&&a>0&&a<13){if(f<10){f="0"+f}if(a<10){a="0"+a}if(g<100){g+=2000}d=new Date(a+"/"+f+"/"+g)}}}return d},dateErrorCheck:function(c){if(!c||isNaN(c)){if(js_invalid_dates_text_new2){return js_invalid_dates_text_new2}return" "}var b=new Date();b.setHours(0,0,0,0);var a=new Date(b.getFullYear(),b.getMonth(),b.getDate()+330);if(c.getTime()<b.getTime()){if(js_0002){return js_0002}return" "}if(a.getTime()<c.getTime()){if(js_0004){return js_0004}return" "}return false},getUserData:function(){if(!this.userData){var b=this.vendorSetId;var o=ta.id("qcInMonth_"+b);if(!o){b=this.vendorSetId+"_pop";o=ta.id("qcInMonth_"+b)}if(!o){return false}var h=ta.id("qcOutMonth_"+b);var d=ta.id("qcInDay_"+b);var q=ta.id("qcOutDay_"+b);var p=ta.id("qcAdults_"+b);var j=o.value.split(/\//);var f=h.value.split(/\//);var k=new Date(j[1],j[0]-1,d.value);var g=new Date(f[1],f[0]-1,q.value);var a=new Date();a.setHours(0,0,0,0);if(k.getTime()<a.getTime()||g.getTime()<a.getTime()){alert(js_0002);return false}var m=new Date((new Date()).getTime()+(330*86400000));if(k.getTime()>m.getTime()||g.getTime()>m.getTime()){alert(js_0004);return false}var c=[];c.push("inMonth=");c.push(j[0]);c.push("%20");c.push(j[1]);c.push("&inDay=");c.push(escape(d.value));c.push("&outMonth=");c.push(f[0]);c.push("%20");c.push(f[1]);c.push("&outDay=");c.push(escape(q.value));c.push("&adults=");c.push(p.selectedIndex+1);var l=ta.id("hacPid"+b);if(l==null){l=ta.id("hacPid")}if(l&&l.value){c.push("&pid=");c.push(l.value)}this.userData=c.join("")}return this.userData},getFlightData:function(){var a=this.vendorSetId;var j=ta.id("qcInMonth_"+a);if(!j){a=this.vendorSetId+"_pop";j=ta.id("qcInMonth_"+a)}if(!j){return false}var f=ta.id("qcOutMonth_"+a);var c=ta.id("qcInDay_"+a);var k=ta.id("qcOutDay_"+a);var g=j.value.split(/\//);var d=f.value.split(/\//);var b=[];b.push("date0=");b.push(g[1]);b.push(g[0]);b.push(escape(c.value));b.push("&date1=");b.push(d[1]);b.push(d[0]);b.push(escape(k.value));var h=ta.id("qcFlightOfferPid");if(h&&h.value){b.push("&pid=");b.push(h.value)}return b.join("")},resetVisitedFlags:function(){var c="checkrates.sUserData."+this.vendorSetId;var a=ta.retrieve(c);var b=this.getUserData();if(a&&a!=b){var d=this.getVendorSet().getVendors();for(x=0;x<d.length;x++){d[x].opened=false}}ta.store(c,b)},getCROpenCount:function(b){var a=0;b.each(function(d){var c=d.window;if(d&&d.bOpened&&c&&c.windowObject&&!c.windowObject.closed){a++}});return a},fixPopOrder:function(s){var c=this.getCheckedVendors();var p=ta.popups.PopUtil.getHoldingWindowSet();var m=this.getVendorSet().getOpenCount();var b=p.length+m;var g=this.getVendorSet().getCheckedCount();if((b+1)<g){var a=false;try{a=window.chrome}catch(o){}var l=2;var r=a?true:ta.popups.PopUtil.tryHoldingWindows(this.trigger,l);if(ta.has("checkrates.chrome_dates_entry_holding")){if(!p.length){s=2}}if(r&&s<c.length){if(this.isLimitChecked){c.reverse()}else{var h=c.splice(0,s).reverse();c=h.concat(c)}}else{if(r){c=c.reverse()}else{var q=[];for(var f=0;f<p.length+1;f++){q.push(c.shift())}for(var d=0;d<q.length;d++){c.unshift(q[d])}}}}else{c=c.reverse()}this.reorderedVendorSet=new ta.commerce.VendorSet({vendorSet:c},this.vendorSetId)},getCheckedVendors:function(){try{var a=this.getVendorSet().getVendors().slice();var b=[];a.map(function(f,d){if(f.isChecked()){b.push(f)}});return b}catch(c){ta.util.error.record(c,"getCheckedVendors")}},setAvailVendorSet:function(){try{var b=[];var h=this.getVendorSet().getVendors();var c=ta.retrieve("availability_check");if(c){for(var a=0;a<h.length;a++){var f=h[a];var g=c.unavailableProviders;if(!g||!g[f.name]){b.push(f)}}this.availVendorSet=new ta.commerce.VendorSet({vendorSet:b},this.vendorSetId)}}catch(d){ta.util.error.record(d,"availability check - crData set vendor set")}}});ta.commerce.checkrates={checkRatesClicked:function(d,b,a,c){ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:c,evnt:d},b,a,false,this.isLimitChecked(b)))},checkRatesCheckMore:function(d,b,a,c){this.initCheckMoreData();ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:c,evnt:d},b,a,true,this.isLimitChecked(b)))},isLimitChecked:function(a){if(ta.has("checkrates.limit_checked")&&a&&!a.className.match(/custom_area_QC_AlsoViewed_CheckMore/)&&!a.className.match(/custom_area_QC_AlsoViewed_LeaveBehind/)){return true}else{return false}},inTest:function(b,a){if(b&&b.trigger){return b.trigger.hasClass(a)}return false},changePID:function(a){var b=ta.id("hacPid");if(b){b.value=a}},checkDealsClicked:function(c,b,a){ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:"checkdeals",evnt:c},b,a,false))},checkRatesPhotoOverlayClicked:function(d,b,a,c){this.initCheckMoreData();ta.store("photo.viewer.isPhotoLBClick",true);ta.store("crPageServlet_orig",crPageServlet);crPageServlet="LocationPhotosLightbox";var f=ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:c,evnt:d},b,a,true,this.isLimitChecked(b)));ta.remove("photo.viewer.isPhotoLBClick");if(ta.photos.viewer){ta.photos.viewer.afterCheckRates(f)}},restoreCRPageServlet:function(){var a=ta.retrieve("crPageServlet_orig");if(a){crPageServlet=a}},initCheckMoreData:function(){this.checkMoreData={uncheckedProviders:null,alsoViewed:null,VR:null}},displayVendors:function(c){var a=document.getElement(".overlay");if(a&&a.overlay&&a.overlay.pin){a.overlay.pin()}if(!c.validate()){return false}c.hideInfo();try{this.popwindows(c);this.addBoomerangTag(c)}catch(b){}return true},popwindows:function(f){try{if(ta.commerce.checkrates.isAvailCheckTest()&&!window.chrome&&!ta.has("avail.check.query.complete")){if(!ta.has("availability_check")){if(!ta.has("commerce.ac.attempts")){ta.store("commerce.ac.attempts",0);ta.commerce.checkrates.triggerAvailCheck(false)}else{ta.store("commerce.ac.attempts",ta.retrieve("commerce.ac.attempts")+1)}if(ta.retrieve("commerce.ac.attempts")<30){ta.commerce.checkrates.popwindows.delay(100,this,[f]);return}}ta.remove("commerce.ac.attempts")}}catch(d){ta.util.error.record(d,"availability check - popwindows")}if(ta.has("pav.overlay")){ta.retrieve("pav.overlay").hide()}f.resetVisitedFlags();ta.store("checkrates.flightData",f.getFlightData());var a=ta.id("msgbox");if(f.type=="providerWindow"){ta.commerce.commerceHelper.openProviderWindowTest(f);if(js_0014&&a){a.hide().empty()}return false}if(js_0005&&a){a.setContent(js_0005).show()}var b=f.getVendorSet().getVendors().length;if(ta.commerce.checkrates.isAvailCheckTest()){var c=f.getAvailVendorSet();if(c&&c.getVendors()){b=c.getCheckedCount();if(isNaN(b)||b>3){b=3}}}else{if(f.isLimitChecked){b=0}else{if(/win_test_(\d+)/.test(f.trigger.className)){b=parseInt(RegExp.$1)}else{if(f.type=="alsoViewed"){b=3}}}}if(typeof(isIPad)!="undefined"&&isIPad){if(!(typeof(iPadOSVersion)!="undefined"&&iPadOSVersion>=5)){b=1}}if(b>1||f.isLimitChecked){f.fixPopOrder(b)}this.popAll(f,b);if(a){a.hide().empty()}return true},popAll:function(a,p){var h=false;if(/custom_area_(\S+)\s/.test(a.trigger.className)){h=RegExp.$1}var o=a.getVendorSet().getVendors();try{if(ta.commerce.checkrates.isAvailCheckTest()){o=a.getAvailVendorSet().getVendors()}}catch(j){}ta.store("checkrates.avUserData",a.getUserData());ta.store("checkrates.avId",a.propId);ta.trackPhysicalCommerce("CheckRates",h,1);var b=a.maxAllowedWin;if(!b){a.useHoldingWin=true}else{var l=a.getCheckedVendors().length;if(l>a.cap){l=a.cap}if(l>=(b+a.maxHoldingWin)){a.useHoldingWin=true}else{if(l==(b+a.maxHoldingWin-1)){a.useHoldingWin=true;a.skipHoldingWin=true}}}var d=0;for(var f=0;f<o.length;f++){var k=o[f];if(k.isChecked()&&k.isAvailable()){if((p-1<d)&&!a.isLimitChecked){this.popBlock(a);return false}var m=this.popOne(k,a);if(!m){this.popBlock(a);return false}else{ta.trackAttemptedCommerce("CheckRates",h,k.name,f+1);d++}}}var g=false;try{g=(window.cookieDomain==".daodao.com"&&(a.trigger.hasClass("smartdeals_checkmore")||window.pageServlet!="SmartDeals"))&&serverPool!=null&&serverPool.toLowerCase()==="b"&&p<o.length}catch(c){}if(a.isCheckMore||g){this.popBlock(a)}else{if(a.type!="checkdeals"){this.launchAVLBTest(a)}}if(ta.has("pcr.overlay")){ta.retrieve("pcr.overlay").hide()}return true},hideLoading:function(c){var a=document.id(c);if(a){var b=a.getElement(".loading");b.set("styles",{display:"none"})}},showLoading:function(d){var a=document.id(d);if(a){var c=a.getElement(".loading");var b=a.getElement(".grn_chevronRgt");c.set("styles",{display:"block"});b.set("styles",{display:"none"})}},showArrow:function(d){var a=document.id(d);if(a){var c=a.getElement(".loading");var b=a.getElement(".grn_chevronRgt");c.set("styles",{display:"none"});b.set("styles",{display:"block"})}},getDelaySecs:function(){var a=ta.id("CHECK_MORE_SITES_LB");if(a&&a.hasClass("dont_animate")){return 0}return 2000},showRemainingCheckMore:function(){var b=this.checkMoreData;var f=document.id("UNCHECKED_PROVIDERS");var a=document.id("ALSO_VIEWED_LB");var c=ta.id("VR_CROSS_SELL");var d=this.getDelaySecs();b.uncheckedProviders=f;b.alsoViewed=a;b.VR=c;if(f){this.showUncheckedProviders.delay(d,this)}else{if(a){this.showAlsoViewed.delay(d,this)}else{if(c){this.showVR.delay(d,this)}}}try{this.loadPackages(false)}catch(g){ta.util.error.record(g,"hotel packages - loadPackages")}},loadPackages:function(b){if(this.shouldSendPackagesRequest()){var g=$$(".packages");this.checkMoreData.packages=g;var j=ta.id("PACKAGES_HOTEL_ID");var m=ta.id("PACKAGES_HOTEL_NAME");var r=ta.id("PACKAGES_CHECK_IN_DATE");var d=ta.id("PACKAGES_CHECK_OUT_DATE");var k=ta.id("PACKAGES_ADULTS");var p=ta.id("PACKAGES_GEO");if(j&&m&&r&&d&&k&&p){var l=j.get("value");var q=m.get("value");var c=r.get("value");var o=d.get("value");var h=k.get("value");var f=p.get("value");var a=[];$$("#ALSO_VIEWED_LIST a").each(function(s){var t=/-d([0-9]+)-/.exec(s.href);if(t&&t[1]&&t[1]!=""){a.push(t[1])}});setTimeout(function(){new Request({url:"/ExpediaPackagesAjax",onSuccess:function(s){try{ta.commerce.checkrates.handlePackages(s,0)}catch(t){ta.util.error.record(t,"hotel packages - handlePackages")}},onFailure:function(s){ta.util.error.record(s.responseText,"hotel packages - call to /ExpediaPackagesAjax")},data:{hotelId:l,hotelName:q,checkInDate:c,checkOutDate:o,adults:h,geo:f,alsoViewedIds:a.join(","),isAlsoViewed:b},evalScripts:true,method:"get"}).send()},500)}}},shouldSendPackagesRequest:function(){var a=$$(".packages").length>0;return a},hasPackagesReturned:function(){return this.hasPackagesResults()||this.hasPackagesNoResults()},hasPackagesResults:function(){return $$("#QUICK_CHECK_LB_PACKAGES .checking_sites").length>0},hasPackagesNoResults:function(){return ta.id("PACKAGES_NO_RESULTS")!=null},isPackagesShowing:function(){var a=ta.id("QUICK_CHECK_LB_PACKAGES");return a&&a.hasClass("show_section")},hasVRCrossSell:function(){return ta.id("VR_CROSS_SELL")!=null},transitionToPackages:function(){this.showPackages.delay(this.getDelaySecs(),this,true)},handlePackages:function(a,d){this.checkMoreData.packages.set("html",a);var b=ta.id("PACKAGES_REQUERY_KEY");if(b){var c=b.get("value");if(d<20){setTimeout(function(){new Request({url:c,onSuccess:function(f){try{ta.commerce.checkrates.handlePackages(f,d+1)}catch(g){ta.util.error.record(g,"hotel packages - handlePackages")}},onFailure:function(f){ta.util.error.record(f.responseText,"hotel packages - requery to /ExpediaPackagesAjax")},evalScripts:true,method:"get"}).send()},1000)}}else{if(!ta.id("CHECK_MORE_SITES_LB")){setTimeout(function(){if(!ta.id("AVLB_HERO_PHOTOS")&&$$("#ALSO_VIEWED_PACKAGES .checking_sites")&&$("ALSO_VIEWED_AD")&&$("ALSO_VIEWED_AD").getSize().x>0){$$("#ALSO_VIEWED_PACKAGES .checking_sites").addClass("withAd")}var g=ta.id("ALSO_VIEWED_PACKAGES");if(g&&!ta.commerce.checkrates.hasPackagesNoResults()){g.show()}else{var f=ta.id("VR_CONTAINER");if(f){f.show()}}},2000)}}},showPackagesLoop:function(a){try{if(this.hasPackagesNoResults()){if(this.hasVRCrossSell()){this.showVR()}return}var b=ta.id("QUICK_CHECK_LB_PACKAGES");if(b&&b.hasClass("show_section")){return}if(this.hasPackagesReturned()&&!this.hasPackagesNoResults()){this.showPackages(false)}else{if(a==0){return}else{this.showPackagesLoop.delay(1000,this,a--)}}}catch(c){ta.util.error.record(c,"hotel packages - showPackagesLoop")}},showPackages:function(b){try{var c=$$(".packages")[0];var a=$$(".packages .checking_sites")[0].getSize().y;c.addClass("show_section");c.removeClass("hide_section");var f=new Fx.Tween(c,{duration:"long",property:"height"});f.start(0,a);if(b){f.addEvent("complete",this.transitionToAlsoViewed.bind(this))}}catch(d){ta.util.error.record(d,"hotel packages - showPackages");if(b){this.showAlsoViewed()}}},packagesClick:function(){try{var v="ExpediaPackageMeta2";var a=ta.id("hiddenReferrer");var h=ta.id("hiddenOrigin");var k=ta.id("hiddenDestination");var c=ta.id("hiddenPercentageSaved");var g=ta.id("hiddenGeo");var f=a.get("value");var w=h.get("value");var s=k.get("value");var y=g.get("value");var q=parseFloat(c.get("value"));var u=$$(".packages .savings");var l=u&&u.length>0?true:false;var r="Expedia";var j=ta.id("hiddenSource");if(j){r=j.get("value")}var m=ta.id("CHECK_MORE_SITES_LB")!=null;var b="";var o="";if(m&&l){b="QC_AlsoViewed_Packages1a";o="16221"}else{if(m){b="QC_AlsoViewed_Packages1b";o="16222"}else{if(l){b="QC_AlsoViewed_Packages2a";o="16269"}else{b="QC_AlsoViewed_Packages2b";o="16270"}}}if(r=="Orbitz"){b+="ORB"}var d="";if(q<7.5){d=1}else{if(q<10){d=2}else{if(q<12.5){d=3}else{if(q<15){d=4}else{d=5}}}}var p=window.open("about:blank","packages","width=800,height=600,scrollbars=1");new Request.JSONP({url:"/CheapFlightsCommerce",callbackKey:"jsonp",data:{AirProvider:v,from:f,area:b,slot:d,cnt:"1",Orig:w,Dest:s,geo:y,pid:o},onSuccess:function(z){try{var B=ta.id("hiddenDetailsUrl");if(B){var A=B.get("value");if(typeof(z)!="undefined"&&z!=null){if(typeof(z.icmcid)!="undefined"&&z.icmcid){A+="&icmcid="+z.icmcid}if(typeof(z.icmdtl)!="undefined"&&z.icmdtl){A+="&icmdtl="+z.icmdtl}}p.location=A}}catch(C){ta.util.error.record(C,"hotel packages - commerceClickCallback")}},method:"get"}).send()}catch(t){ta.util.error.record(t,"hotel packages - packagesClick")}return false},avafState:0,avafTimer:null,avafIn:function(c,a){try{if(ta.commerce.checkrates.avafState!=0){return}if(a==0){ta.commerce.checkrates.avafExpand()}else{ta.commerce.checkrates.avafWait(c,a)}}catch(b){ta.util.error.record(b,"also viewed - avafIn")}},avafWait:function(c,a){try{ta.commerce.checkrates.avafState=1;ta.commerce.checkrates.avafTimer=setTimeout(function(){ta.commerce.checkrates.avafExpand(c)},a)}catch(b){ta.util.error.record(b,"also viewed - avafWait")}},avafOut:function(d){try{if(ta.commerce.checkrates.avafState!=1){return}if(ta.commerce.checkrates.avafTimer==null){return}if(!d){d=window.event}if(!d){return}var a=(d.relatedTarget)?d.relatedTarget:d.toElement;var c=ta.id("ALSO_VIEWED_LIST");while(a&&a!=c&&a.nodeName!="BODY"){a=a.parentNode}if(a==c){return}clearTimeout(ta.commerce.checkrates.avafTimer);ta.commerce.checkrates.avafTimer=null;ta.commerce.checkrates.avafState=0}catch(b){ta.util.error.record(b,"also viewed - avafOut")}},avafExpand:function(c){try{ta.commerce.checkrates.avafState=2;var a=ta.id("expand_av_on_hover");if(!a){return}a.removeClass("hidden");a.addClass("expanding");var f=a.getSize().y;a.removeClass("expanding");a.addClass("show");var d=new Fx.Tween(a,{duration:"long",property:"height"});d.start(0,f)}catch(b){ta.util.error.record(b,"also viewed - avafExpand")}},showUncheckedProviders:function(){var d=this.checkMoreData.uncheckedProviders;var b=this.checkMoreData.alsoViewed;var c=ta.retrieve("vrCrossSellNew");if(d){var a=d.getSize().y;d.addClass("show_section");d.removeClass("hide_section");var f=new Fx.Tween(d,{duration:"long",property:"height"});f.start(0,a);if(this.hasPackagesResults()){f.addEvent("complete",this.transitionToPackages.bind(this))}else{if(b&&!c){f.addEvent("complete",this.transitionToAlsoViewed.bind(this))}else{f.addEvent("complete",this.transitionToVR.bind(this))}}}},actionRecord:function(a){new Request({url:"/ActionRecord?action="+a}).send()},transitionToAlsoViewed:function(){this.showAlsoViewed.delay(this.getDelaySecs(),this)},showAlsoViewed:function(){var a=this.checkMoreData.alsoViewed;var c=ta.retrieve("vrCrossSellNew");if(a){var b=a.getSize().y;a.addClass("show_section");a.removeClass("hide_section");var f=new Fx.Tween(a,{duration:"long",property:"height"});f.start(0,b);try{if(!this.isPackagesShowing()){if(this.shouldSendPackagesRequest()){f.addEvent("complete",this.showPackagesLoop.bind(this,10))}else{if(!c){f.addEvent("complete",this.transitionToVR.bind(this))}}}}catch(d){ta.util.error.record(d,"hotel packages - shouldSendPackagesRequest")}}},transitionToVR:function(){if(this.checkMoreData.VR){if(screen.height>=768){this.showVR.delay(2000,this)}else{this.actionRecord("VR_CROSS_SELL_SMALL_SCREEN")}}},showVR:function(){var b=this.checkMoreData.VR;var a=this.checkMoreData.alsoViewed;var d=ta.retrieve("vrCrossSellNew");if(b){var c=b.getSize().y;b.addClass("show_section");b.removeClass("hide_section");var f=new Fx.Tween(b,{duration:"long",property:"height"});f.start(0,c);ta.overlays.Factory.recordVRCrossSell();if(a&&d){f.addEvent("complete",this.transitionToAlsoViewed.bind(this))}}},recordClose:function(){if(ta.has("pav.overlay")){ta.retrieve("pav.overlay").hide()}this.actionRecord("CheckMore_Close")},buildURLForQuickCheckData:function(c,o,m){var j=c.getUserData();var f="";j=ta.retrieve("checkrates.avUserData");var p=m||c.getVendorSet().getCheckedInfo(o);if(p){f="&vendorsChecked="+p.vendorsChecked+"&vendorsOpened="+p.vendorsOpened+"&vendorsHidden="+p.vendorsHidden;if(ta.commerce.checkrates.isAvailCheckTest()){try{var a=c.getAvailVendorSet().getCheckedInfo("unavail_set");var b=c.getOriginalVendorSet().getCheckedInfo("unchecked");f="&vendorsChecked="+p.vendorsChecked+"&vendorsOpened="+a.vendorsOpened+"&vendorsHidden="+p.vendorsHidden+"&vendorsAvailable="+a.vendorsAvailable+"&vendorsUnchecked="+b.vendorsUnchecked}catch(h){}}}var d=pageServlet;if(crPageServlet){d=crPageServlet}if(!d){d="unknown"}var q="&avLocId=";var g=ta.retrieve("checkrates.avId");if(g){q+=g}else{q+=c.vendorSetId}var l="QC_Button";var k=false;if(k=c.trigger.className.match(/custom_area_(\w+)/)){l=k[1]}return"detail="+c.vendorSetId+"&storedUserData="+encodeURIComponent(j)+f+"&a="+l+"&s="+d+"&av=true"+q},removePCR:function(){var a=ta.retrieve("pcr.overlay");if(a){a.hide()}},popBlock:function(h){try{if(h.trigger.className.match(/custom_area_QC_Inline_Geo/)&&!(crPageServlet=="Hotel_Review"||crPageServlet=="ShowUserReviewsHotels")){return}}catch(g){ta.util.error.record(g,"popBlock - could not check criteria")}try{if(h.isLimitChecked&&!ta.has("checkrates.limit_checked_ie_no_cleanup")){var j=ta.popups.PopUtil.getHoldingWindowSet();while(j.length){var f=j[j.length-1].windowObject;f.close();f=null;j.pop()}}}catch(g){ta.util.error.record(g,"cr close excess holding windows")}h.getVendorSet().storeCheckBoxValues();var a=h.getVendorSet().getCheckedInfo("check_more");var b="/CheckMore?"+this.buildURLForQuickCheckData(h,"check_more",a);var d=h.getOriginalVendorSet().getVendorsUnchecked();var c=h.getOriginalVendorSet().getVendorsDefaultUnchecked();if(!ta.has("force_popup_to_check_more")){if(this.inTest(h,"cmAVTest")&&a&&a.vendorsChecked&&a.vendorsOpened&&((!h.isLimitChecked&&a.vendorsChecked==a.vendorsOpened)||(h.isLimitChecked&&(a.vendorsChecked==a.vendorsOpened)&&!d.length))||(ta.has("checkrates.limit_checked_w_unchecked_excluded")&&(a.vendorsChecked==a.vendorsOpened)&&(d.join("")==c.join("")))){this.launchAVLBTest(h);return}if(/avLightboxSwap/.test(h.trigger.className)){this.launchAVLBTest(h);return}}if(h.type=="checkdeals"){b="ABS:vpages/quickcheckdeals_ie.html"}ta.run("ta.overlays.Factory.loadCheckMoreOverlay",{},h,b)},daodaoPopOne:function(d,a,f,c){var g=new ta.commerce.CheckRatesData({evnt:a},f,c);if(!g.validate()||d<0){return}var h=g.getVendorSet().getVendors();var b=h[d].name;h[d].name="";ta.commerce.checkrates.popOne(h[d],g);h[d].name=b},daodaoPopTPW:function(o,g,u,s){var l=new ta.commerce.CheckRatesData({type:s,evnt:o},g,u,true);if(!l.validate()){return false}var m=l.getVendorSet().getVendors();var c=0;for(var p=0;p<m.length;p++){var j=m[p];if(j.isChecked()&&j.isAvailable()){c=p;j.opened=true;break}}var t=m[c];var q="daodaoTPW";var d=ta.retrieve("daodaoTPW");var k="/DaoDaoTabbedProviderWindow?first="+t.name+"&locId="+u+"&"+l.getUserData();try{if(d!=null){try{d.windowObject=window.open(k,q,"left=0,top=0,width="+screen.width+",height="+screen.height);d.windowObject.focus()}catch(r){ta.util.error.record(r,"daodao pop tpw one - reuse popup");return false}}else{var h=ta.popups.PopUtil.getHoldingWindowSet();var a=screen.width;if(h.length>0){d=h[h.length-1].repurpose(k,a)}else{var f=1;try{if(window.chrome){f=0}}catch(r){}var b={customWidth:a,customHeight:screen.height,name:q,url:k,scrollbars:f,left:0,top:0};d=ta.popups.PopUtil.createCheckRatesWindow(b)}}}catch(r){ta.util.error.record(r,"pop tpw - general");return false}if(d&&d.windowObject){ta.store("daodaoTPW",d);return d}return false},updateInlineFormElementRadio:function(d){var a=d.getElement("input[type=radio]");if(a){var f=a.id.substring(a.id.length-4);if(this.crSyncExtensions.contains(f)){var b=a.id.substring(0,a.id.length-4);var c=ta.id(b);if(c){c.checked=a.checked;var g=$$("#CHECK_RATES_CONT_SYNC form")[0];if(g){var h=g.getElement("#"+b+"_icr");h.checked=c.checked}}}else{var b=a.id;var c=ta.id(b);this.crSyncExtensions.each(function(k){var j=b+k;j=ta.id(j);if(j){j.checked=c.checked}})}}},popOne:function(a,b){try{if(a.hasWindow()){try{var c=a.window;c.windowObject=window.open(a.getUrl(b),c.name,c.winArgs);c.windowObject.focus()}catch(f){ta.util.error.record(f,"pop one - reuse popup");return false}}else{var g=a.name;var h=ta.popups.PopUtil.getProviderWindowDims(g,true);var d=ta.popups.PopUtil.getHoldingWindowSet();if(d.length>0&&b.useHoldingWin){a.window=d[d.length-1].repurpose(a.getUrl(b),h.customWidth,h.customHeight);if(b.skipHoldingWin){b.useHoldingWin=false}}else{var k=1;try{if(window.chrome){k=0}}catch(f){}var h=ta.popups.PopUtil.getProviderWindowDims(g,false);var j={customWidth:h.customWidth,customHeight:h.customHeight,widthOffset:h.widthOffset,heightOffset:h.heightOffset,name:g,url:a.getUrl(b),scrollbars:k};a.window=ta.popups.PopUtil.createCheckRatesWindow(j)}}}catch(f){ta.util.error.record(f,"pop one - general");return false}if(a.window&&a.window.windowObject){a.opened=true;return a.window}return false},addBoomerangTag:function(g){var a={};var b=ta.id("checkIn_"+g.vendorSetId);var f=ta.id("checkOut_"+g.vendorSetId);var d=ta.id("qcAdults_"+g.vendorSetId);if(!(b&&f&&d)){b=ta.id("checkIn_"+g.vendorSetId+"_pop");f=ta.id("checkOut_"+g.vendorSetId+"_pop");d=ta.id("qcAdults_"+g.vendorSetId+"_pop")}if(b&&f&&d){a.checkIn=b.value;a.checkOut=f.value;a.adults=d.value}else{return}var c={url:"/HotelCheckRates?Action=AddBoomerangTag",data:a};c.onSuccess=function(k,h){var j=ta.id("BOOMERANGTAG");if(!j){j=new Element("div",{id:"BOOMERANGTAG"});j.inject(document.body)}if(!j){return}j.innerHTML=k};new Request(c).send()},launchAVLBTest:function(c){var b=c.propId;if(pageServlet&&b&&window.cookieDomain!=".daodao.com"){var a="http://"+document.domain+"/AlsoViewedLB?d="+b+"&s="+pageServlet+"&"+c.getUserData()+"&checkRatesType=checkRates";if(ta.has("page.geo")){a+="&geo="+ta.retrieve("page.geo")}ta.run("ta.overlays.Factory.launchAVLBCompleteFn",{},a)}},openProviderWindowUrl:function(k,f,b,h){var j=ta.asInt("commerce.provWinNum");j++;ta.store("commerce.provWinNum",j);var a=ta.retrieve("commerce.previousTpwNumbers");var d=a+"_"+j;if(!a){d=j}var g="TAProviderWindow_"+d;k=k+"&otpwn="+d;var l=window.open(k,g,this.getProviderWinArgs(d));l.focus();ta.store("commerce.TPWindow",l);var c=(function(){try{if(l.closed){clearTimeout(c)}else{var o=l.location.href;window.status=o}}catch(m){clearTimeout(c);new Request({url:"/ActionRecord?action=fbProvWin|id_"+f+"|ctrId_"+b+"|cv_"+h}).send()}}).periodical(1500);return l},addCustomUrlParams:function(c,b){var d=new RegExp("(&|\\?)area=[^&]*");c=c.replace(d,"$1area="+b);if(crPageServlet){var a=new RegExp("(&|\\?)from=[^&]*");c=c.replace(a,"$1from=HotelDateSearch_"+crPageServlet)}return c},checkMoreClickRe:function(d,a,f,p){new Event(d).preventDefault();if(a){var h="QC_Button";var g=false;if(g=a.className.match(/custom_area_(\w+)/)){h=g[1]}var k=false;if(k=a.className.match(/custom_refer_(\w+)/)){crPageServlet=k[1]}var b=ta.id(a).hasClass("flightOffer");var j;if(b){j=a.href+"&"+ta.retrieve("checkrates.flightData")}else{var c=ta.retrieve("checkrates.avUserData");j=this.addCustomUrlParams(a.href,h)+"&"+c}var o=1;try{if(window.chrome){o=0}}catch(d){}var l=ta.popups.PopUtil.getProviderWindowDims(f,false);var m={customWidth:l.customWidth,customHeight:l.customHeight,widthOffset:l.widthOffset,heightOffset:l.heightOffset,name:f,url:j,scrollbars:o};var q=ta.popups.PopUtil.createCheckRatesWindow(m)}},checkMoreClick:function(D,s,B,E,g,a){new Event(D).preventDefault();if(s){if(a){ta.commerce.checkrates.showLoading(s.id)}var A="QC_Button";var F=false;if(F=s.className.match(/custom_area_(\w+)/)){A=F[1]}var k=false;if(k=s.className.match(/custom_refer_(\w+)/)){crPageServlet=k[1]}var f=ta.id(s).hasClass("flightOffer");var m;if(f){m=s.href+"&"+ta.retrieve("checkrates.flightData")}else{var q=ta.retrieve("checkrates.avUserData");m=this.addCustomUrlParams(s.href,A)+"&"+q}var p=1;try{if(window.chrome){p=0}}catch(D){}var z=ta.popups.PopUtil.getProviderWindowDims(B,false);var h={customWidth:z.customWidth,customHeight:z.customHeight,widthOffset:z.widthOffset,heightOffset:z.heightOffset,name:B,url:m,scrollbars:p};var l=ta.popups.PopUtil.createCheckRatesWindow(h);if(l&&a){ta.commerce.checkrates.showArrow(s.id)}if(f){ta.id(s).removeClass("sprite-findflights_ylwCnr").addClass("sprite-findflights_ylwCnrChk")}else{ta.id(s).removeClass(E).addClass(g)}if(ta.id(s).getParent("#QUICK_CHECK_LB_PARTNERS")){var G=0;var b=0;var u=document.id("QUICK_CHECK_LB_PARTNERS");var C=u.getElements(".unClickedCount");C.each(function(H){if(ta.id(H).hasClass(E)){G++}if(ta.id(H).hasClass(g)){b++}},this);if(a){if(b>1){var o=document.getElement(".chkOpenedSitesDesc");var y=document.getElement(".oneMoreOpened");ta.id(o).removeClass("hideOne");ta.id(y).addClass("hideOne")}var w=document.getElement(".cs_ps .openedSites");w.innerHTML=b}if(G<1){var v=ta.id("emptyAlsoViewed");if(v){var c=ta.retrieve("overlays.current");if(c){c.hide();ta.remove("overlays.current")}}else{var r=document.getElement(".chkSitesDesc");if(r){r.addClass("hideOne")}var d=document.getElement(".oneMore");if(d){d.addClass("hideOne")}}return}else{if(G<2){var r=document.getElement(".chkSitesDesc");if(r){r.addClass("hideOne")}var d=document.getElement(".oneMore");if(d){d.removeClass("hideOne")}}else{var j=document.getElement(".cs_ps .opnSites");j.innerHTML=G}}}if(window.cookieDomain==".daodao.com"){if(ta.id(s).getElements("span")[0].hasClass("show-price-org")){ta.id(s).getElements("span")[0].removeClass("show-price-org").addClass("show-price-black")}var t=ta.id(s).getParent("li").getParent("ul").getElements(".show-price-org").length;ta.id("remainingCount").set("html",t)}}},showProviders:function(){if(this.validateDates()){var a=$$("div.geoProviderHidden");if(a){a.removeClass("geoProviderHidden");a.addClass("geoProvider")}var c=ta.id("HotelDateSearch")||ta.id("HotelDateSearch_icr");if(c){var b=c.getElement("span.error_msg_geo");if(b){b.hide()}}}},validateDates:function(){var b=ta.id("checkIn_"+this.geoId)||ta.id("checkIn_"+this.geoId+"_icr");var f=ta.id("checkOut_"+this.geoId)||ta.id("checkOut_"+this.geoId+"_icr");if(!b||!f||!b.value||!f.value){return false}var d=this.parseDate(b.value);var c=this.parseDate(f.value);var a=this.dateErrorCheck(d);var g=this.dateErrorCheck(c);if(a&&g){return true}else{return false}},parseDate:function(b){var d=false;if(DATE_FORMAT&&b){var c=b.match(DATE_FORMAT.pattern);if(c){var f=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var g=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(f>0&&f<32&&a>0&&a<13){if(f<10){f="0"+f}if(a<10){a="0"+a}if(g<100){g+=2000}d=new Date(a+"/"+f+"/"+g)}}}return d},dateErrorCheck:function(c){if(!c||isNaN(c)){return false}var b=new Date();b.setHours(0,0,0,0);var a=new Date(b.getFullYear(),b.getMonth(),b.getDate()+330);if(c.getTime()<b.getTime()){return false}if(a.getTime()<c.getTime()){return false}return true},updateHiddenDateFields:function(g,b){var f=this.parseDate(b.value);var a=this.dateErrorCheck(f);if(a&&typeof(a)=="string"){if(a.replace(/^\s+|\s+$/g,"").length>0){alert(a)}return}if(window.cookieDomain==".daodao.com"){var c=ta.id("HotelDateSearch");if(c&&c.hasClass("show-meta-prices")){ta.run("dd.hotels.halfmeta.showDaoDaoMetaPrices")}}var d=ta.id(b).overlay;if(d&&d.calendar){d.calendar.select(null,f)}},crSyncExtensions:new Array("_pop","_icr","_pto","_per","_amo","_cro"),_showSuppressedProviders:function(a){if(ta.retrieve("checkrates.datesChanged")){return}try{var b=ta.id(a);b.getElements(".unavailable").each(function(d){d.removeClass("unavailable");if(d.hasClass("js_ua_checked")){d.getElements("input").set("checked",true)}ta.commerce.checkrates.updateCRFormElement(d)});ta.store("checkrates.datesChanged",true)}catch(c){ta.util.error.record(c,"_showSuppressedProviders")}},findInlineCRLocationId:function(){var f=null;var g=ta.id("HotelDateSearch");if(g){var a=g.getElements("input[type=text]");for(var d=a.length;d--;){var b=a[d];var c=b.id.match(/_(\d+)/);if(c.length){f=c[1];break}}}return f},updateCRCalendar:function(c){if(c.form){ta.commerce.checkrates._showSuppressedProviders(c.form)}try{var b=c.before;var a=b.dayField;if(a&&/qcInDay_(\d+)/.test(a.id)){ta.commerce.checkrates.checkCRLimits(RegExp.$1)}}catch(d){ta.util.error.record(d,"update cal crLimits check")}ta.commerce.checkrates.updateCRFormElement(this)},checkCRLimits:function(g){try{if(!g){return}var d=new Date();var p=document.getElement('input[id*="qcInDay_'+g+'"]').value;var q=document.getElement('input[id*="qcInMonth_'+g+'"]').value;q=q.split("/");d.setDate(p);d.setMonth(q[0]-1);d.setFullYear(q[1]);var o=ta.retrieve("checkrates.vendors."+g);for(var h=0;h<o.length;h++){var m=o[h];if(m.hasDateLimits()){var c='input[id*="'+m.options.checkboxID+'"]';var f=document.getElement(c);if(f){var l=true;var b;var a=m.options.minDaysOut;if(a>0){b=new Date();b.setDate(b.getDate()+a);l=(d>=b)}var k=m.options.maxDaysOut;if(k>0&&l){b=new Date();b.setDate(b.getDate()+k);l=(d<=b)}f.getParent("li").style.display=(l?"block":"none")}}}}catch(j){ta.util.error.record(j,"check crLimits")}},updateCRFormElement:function(f){try{f=ta.id(f);var o=f.get("tag").toLowerCase();if(o=="li"){f=f.getElement("input[type=checkbox]")}var g=f.id.split("_")[0];var j=this.findInlineCRLocationId();var m=g+"_"+j;var d=f.id;var b=d.substring(d.length-4);var r=[m,m+"_icr",m+"_per"];if(this.crSyncExtensions.contains(b)){for(var h=r.length;h--;){var m=r[h];if(m!=d){var q=ta.id(m);if(q){if(o=="li"&&b!="_pop"){q.checked=f.checked;var p=f.getParent("li");if(p&&!p.hasClass("unavailable")){var c=q.getParent("li");if(c){c.removeClass("unavailable")}}}else{if(o=="select"){q.selectedIndex=f.selectedIndex}else{if(o=="input"){var a=f.form;if(window.cookieDomain==".daodao.com"){if(a.hasClass("show-meta-prices")){ta.run("dd.hotels.halfmeta.showDaoDaoMetaPrices")}}var l=m.substring(m.length-4);if(!this.crSyncExtensions.contains(l)){l=""}this.updateCRFormElement_In(j,f,b,l)}}}}}}}}catch(k){ta.util.error.record(k,"updateCRFormElement")}},updateCRForm:function(a){try{var r=ta.id("HotelDateSearch"+a);var q=ta.id("HotelDateSearch");var f=["select","input[type=checkbox]","input[type=hidden]","input[type=text]"];if(r&&q){for(var l=f.length;l--;){var c=f[l];var t=q.getElements(c);var d=r.getElements(c);for(var h=d.length;h--;){var s=d[h];var p=s.id.split("_")[0];for(var g=t.length;g--;){var o=t[g];if(o.id.contains(p)){if(c=="input[type=checkbox]"){var u=o.getParent("li");if(u&&!u.hasClass("unavailable")){var b=s.getParent("li");if(b){b.removeClass("unavailable")}}}if(c=="select"){s.selectedIndex=o.selectedIndex}else{if(c=="input[type=checkbox]"&&a!="_pop"){s.checked=o.checked}else{if(!s.id.contains("hacPid")){s.value=o.value}}}}}}}}}catch(m){ta.util.error.record(m,"updateCRForm")}},updateCRFormElement_In:function(l,t,o,q){try{var m=t.id.match(/_(\d+)/)[1];var c=ta.id("checkIn_"+l+q);var b=ta.id("checkOut_"+l+q);var p=ta.id("checkIn_"+m+o);var j=ta.id("checkOut_"+m+o);var f=ta.id("qcInDay_"+l+q);var r=ta.id("qcOutDay_"+l+q);var g=ta.id("qcInDay_"+m+o);var d=ta.id("qcOutDay_"+m+o);var h=ta.id("qcInMonth_"+l+q);var u=ta.id("qcOutMonth_"+l+q);var k=ta.id("qcInMonth_"+m+o);var a=ta.id("qcOutMonth_"+m+o);if(c&&p&&b&&j&&f&&g&&r&&d&&h&&k&&u&&a){c.value=p.value;b.value=j.value;f.value=g.value;r.value=d.value;h.value=k.value;u.value=a.value}}catch(s){ta.util.error.record(s,"updateCRFormElement_In")}},availCheck:function(b){var a=ta.id("availability")&&ta.id("availability").value=="1";var d=ta.id(b).getElement(".overlaySrc");if(a&&d){var c=d.innerHTML;d.innerHTML=c.replace(/cid=(\w+_)?&amp;/,"")}},positionCheckRates:function(){try{var j=window.getScroll();var l=false;try{l=window.location.href}catch(h){}if(l){var f=ta.retrieve("pcr.initialUrl");if(!f){f=l;ta.store("pcr.initialUrl",f)}if(f!=l){ta.store("pcr.initialYPos",j.y);ta.store("pcr.initialUrl",l)}}var d=true;var a=ta.retrieve("pcr.initialYPos");if(a&&a>0){d=(Math.abs(a-j.y)>=100)}var b=j.y>=ta.retrieve("pcr.scrollPoint")&&d;var c=$$(".overlayBG");if(b&&!ta.retrieve("pcr.overlay").visible&&!ta.has("pcr.keepHidden")&&!c.length){ta.store("pcr.initialYPos",-1);if(typeof(persistentCRCss)!="undefined"&&!ta.retrieve("ta.persCrCssAsset")){ta.store("ta.persCrCssAsset",Asset.css(persistentCRCss))}ta.retrieve("pcr.overlay").show();ta.commerce.checkrates.updateCRForm("_per");if(!ta.id("PERSISTENT_CHECK_RATES_WRAP").hasClass("pcrStatic")){ta.retrieve("pcr.overlay").container.set("tween",{duration:"300",transition:"bounce:out"});ta.retrieve("pcr.overlay").container.setStyle("margin-top",-125);ta.retrieve("pcr.overlay").container.tween("margin-top",0)}var g=ta.id("PERSISTENT_CHECK_RATES_WRAP").getParent();if(!g.getElement(".gradient")){var k=new Element("div.gradient");k.inject(g,"bottom")}if(!ta.retrieve("pcr.firstShow")){ta.trackEventOnPage("PersistentCheckRates","shown","",1,true);ta.store("pcr.firstShow",true)}}else{if(!b&&ta.retrieve("pcr.overlay").visible){ta.retrieve("pcr.overlay").hide()}}}catch(h){window.removeEvent("scroll",ta.commerce.checkrates.positionCheckRates);ta.util.error.record(h,"pcr - positionCheckRates");return false}},_updateSecondaryFormElement_CB:function(){var a=ta.id("CHECK_RATES_CONT");if(a){var b=a.getElements("input.chk");b.each(function(g,d){var f=ta.id(g.id+"_pop");var c=ta.id(g.id+"_per");if(f){f.checked=g.checked}if(c){c.checked=g.checked}})}},availCheckQuery:function(d,b,a,c,g,f){new Request.JSON({url:"/AvailabilityCheckJson",method:"get",data:{checkin:d,checkout:b,adults:a,country:g,geo:f,action:c},onSuccess:function(j,h){if(c&&c=="peek"){ta.store("availability_check",j)}}}).send()},isAvailCheckTest:function(){if(!ta.has("avail.check.test")){var a=ta.id("CHECK_RATES_CONT");if(a&&a.hasClass("avail_check")){ta.store("avail.check.test",true)}else{ta.store("avail.check.test",false)}}return ta.retrieve("avail.check.test")},triggerAvailCheck:function(g){try{if(ta.commerce.checkrates.isAvailCheckTest()){var d=ta.id("CHECK_RATES_CONT");var k=ta.commerce.checkrates.normalizeDate(d.getElement("input.checkIn").value);if(!k){return false}var a=new Date(k.getTime());a.setDate(k.getDate()+2);if(d.getElement("input.checkOut").value.match(/\d+/)){a=ta.commerce.checkrates.normalizeDate(d.getElement("input.checkOut").value);if(!a){return false}}var j="2";var h=d.getElement("select");if(h&&!isNaN(h.value)){j=h.value}var c="0";if(accomIdMatch=d.className.match(/did_(\d+)/)){c=accomIdMatch[1]}var l="191";if(countryIdMatch=d.className.match(/cid_(\d+)/)){l=countryIdMatch[1]}var b="peek";if(g){b="query";if(g=="before"){a.setDate(k.getDate()+2)}}ta.commerce.checkrates.availCheckQuery(ta.commerce.checkrates.tacDateFormat(k),ta.commerce.checkrates.tacDateFormat(a),j,b,l,c)}}catch(f){ta.util.error.record(f,"availability select date click")}},tacDateFormat:function(a){var c=a.getDate();var d=a.getMonth();d=d+"";if(d.length<2){d="0"+d}var b=a.getFullYear();return b+"-"+d+"-"+c},normalizeDate:function(b){if(!b||typeof b!="string"){return false}try{var c=b.match(DATE_FORMAT.pattern);if(c){var f=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var g=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(f>0&&f<32&&a>0&&a<13){if(g<100){g+=2000}return new Date(g,a,f)}else{return false}}else{return false}}catch(d){}return false},availCheckChangeDates:function(){try{document.getElement(".overlay").overlay.hide()}catch(a){ta.util.error.record(a,"availCheckChangeDates")}}};ta.queueForLoad(function(){var c=false;try{c=window.location.href}catch(b){}if(c){var a=ta.retrieve("pcr.initialUrl");if(!a){a=c;ta.store("pcr.initialUrl",a)}}});ta.common.flyout.memberOverlay=ta.overlays.Factory.memberOverlay;ta.common.flyout.intlPopup=ta.overlays.Factory.intlPopup;ta.common.flyout.showRecentLocationEmailOverlay=ta.overlays.Factory.showRecentLocationEmailOverlay;ta.common.flyout.clearRecentLocations=ta.overlays.Factory.clearRecentLocations;ta.commerce.checkrates.createPairedCalendar=ta.overlays.Factory.createPairedCalendar;ta.commerce.checkrates.pcrInit=ta.overlays.Factory.loadPCROverlay;ta.common.sendmessage.showSendMessage=ta.overlays.Factory.showSendMessage;ta.servlet.Hotel.showRoomTipsOverlay=ta.overlays.Factory.showRoomTipsOverlay;ta.servlet.Hotel.showReviewSummary=ta.overlays.Factory.showReviewSummary;ta.servlet.Hotel.showTranslationReviewSummary=ta.overlays.Factory.showTranslationReviewSummary;tamgShowLightbox=ta.overlays.Factory.tamgShowLightbox;ta.util.taLnk={mouseover:function(b){$(b).addClass("underline")},mouseout:function(b){$(b).removeClass("underline")}};var StringBuffer=new Class({initialize:function(a){this.strings=new Array();if(a){this.append(a)}},append:function(a){this.strings.push(a);return this},toString:function(){return this.strings.join("")},isEmpty:function(){return this.strings.length==0}});var Table=new Class({Implements:[Options],options:{properties:{cellpadding:0,cellspacing:0,border:0},rows:[]},initialize:function(a){this.setOptions(a);this.table=new Element("table").setProperties(this.options.properties);this.tbody=new Element("tbody").inject(this.table);this.options.rows.each(this.push.bind(this))},push:function(d,c,a){var b=new Element("tr").inject(c||this.tbody);d.each(function(f){var g=new Element(a?"th":"td").inject(b);if(f.properties){g.setProperties(f.properties)}if(f.content){g.setContent(f.content)}else{g.setContent(f)}});return this},pushHead:function(a){if(!this.thead){this.thead=new Element("thead").inject(this.table,"top")}this.push(a,this.thead,true);return this},pushFoot:function(a){if(!this.tfoot){this.tfoot=new Element("tfoot").inject(this.table)}this.push(a,this.tfoot);return this},pushCaption:function(a){new Element("caption").setContent(a).inject(this.table,"top");return this}});var TabSet=new Class({Implements:[Options,Events],options:{onActive:function(){},onBackground:function(){},show:0,collapsable:false},initialize:function(){var a,b,c;Array.each(arguments,function(g,f){switch(typeOf(g)){case"object":a=g;break;default:var d=$$(g);if(!b){b=d}else{c=d}}});this.togglers=b||[];this.elements=c||[];this.setOptions(a);this.elements.each(function(f,d){this.togglers[d].addEvent("click",this.display.bind(this).partial(Function._,d));if(this.options.show===d){f.show();this.previous=d;this.fireEvent("onActive",[null,this.togglers[d],f])}else{f.hide()}},this)},display:function(b,a){if(this.options.collapsable&&a==this.previous){if(this.elements[a].isHidden()){this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);this.elements[a].show()}else{this.fireEvent("onBackground",[b,this.togglers[a],this.elements[a]]);this.elements[a].hide()}return this}if(this.previous||this.previous===0){this.elements[this.previous].hide();this.fireEvent("onBackground",[b,this.togglers[this.previous],this.elements[this.previous]])}this.previous=a;this.elements[a].show();this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);return this}});var ToggleSet=new Class({initialize:function(b,c,a){this.index=a||0;this.togglers=b||[];this.elements=c||[];this.togglers.each(function(f,d){this.togglers[d].addEvent("click",this.display.bind(this,d));this.elements[d].hide()},this)},add:function(c,b){var a=this.togglers.length;this.togglers.push(c);this.elements.push(b);c.addEvent("click",this.display.bind(this,a));b.hide()},expand:function(a){this.togglers[a].addClass("open");this.elements[a].show();return this},collapse:function(a){this.elements[a].hide();this.togglers[a].removeClass("open");return this},display:function(a){if(this.previous==a){if(this.elements[a].isHidden()){this.expand(a)}else{this.collapse(a)}}else{if(this.previous||this.previous===0){this.collapse(this.previous)}this.previous=a;this.expand(a)}return this}});var Slider=new Class({Implements:[Options,Events],Binds:["clickedElement","draggedKnob"],options:{onChange:function(){},onComplete:function(){},onTick:function(a){this.knob.setStyle(this.p,a)},mode:"horizontal",steps:100,offset:0},initialize:function(d,a,b){this.element=$(d);this.knob=$(a);this.setOptions(b);this.previousChange=-1;this.previousEnd=-1;this.step=-1;this.element.addEvent("mousedown",this.clickedElement);var c,g;switch(this.options.mode){case"horizontal":this.z="x";this.p="left";c={x:"left",y:false};g="offsetWidth";break;case"vertical":this.z="y";this.p="top";c={x:false,y:"top"};g="offsetHeight"}this.max=this.element[g]-this.knob[g]+(this.options.offset*2);this.half=this.knob[g]/2;this.getPos=this.element["get"+this.p.capitalize()].bind(this.element);this.knob.setStyle("position","relative").setStyle(this.p,-this.options.offset);var f={};f[this.z]=[-this.options.offset,this.max-this.options.offset];this.drag=new Drag(this.knob,{limit:f,modifiers:c,snap:0,onStart:this.draggedKnob(),onDrag:this.draggedKnob(),onComplete:function(){this.draggedKnob();this.end()}.bind(this)});if(this.options.initialize){this.options.initialize.call(this)}},set:function(a){this.step=a.limit(0,this.options.steps);this.checkStep();this.end();this.fireEvent("onTick",this.toPosition(this.step));return this},setDefault:function(a){if(a>this.options.steps){a=this.options.steps}else{if(a<0){a=0}}this.step=a;this.end();this.knob.setStyle(this.p,this.toPosition(this.step)+"px");return this},scrolledElement:function(a){if(a.wheel<0){this.set(this.step+1)}else{if(a.wheel>0){this.set(this.step-1)}}a.stop()},clickedElement:function(b){var a=b.page[this.z]-this.getPos()-this.half;a=a.limit(-this.options.offset,this.max-this.options.offset);this.step=this.toStep(a);this.checkStep();this.end();this.set(this.step)},draggedKnob:function(){if(!this.drag){return}this.step=this.toStep(this.drag.value.now[this.z]);this.checkStep();this.setDefault(this.step)},checkStep:function(){if(this.previousChange!=this.step){this.previousChange=this.step;this.fireEvent("onChange",this.step)}},end:function(){if(this.previousEnd!==this.step){this.previousEnd=this.step;this.fireEvent("onComplete",this.step+"")}},toStep:function(a){return Math.round((a+this.options.offset)/this.max*this.options.steps)},toPosition:function(a){return this.max*a/this.options.steps}});var rules={};var rulesN={};var ajaxRules={};var Behavior=new Class({register:function(b){this.rules=b;for(var a in this.rules){this.reload(a)}for(var c in rulesN){this.reloadN(c)}return this},reload:function(c){var a=$$(c);for(var d=0;d<a.length;d++){try{this.rules[c](a[d])}catch(b){ta.util.error.record(b,"rules",null,{element:ta.util.error.getSelectorString(a[d]),ruleCount:d})}}return a.length},reloadN:function(b){var a=0;while(n=ta.id(b+(a++))){rulesN[b](n)}return a-1},apply:function(a){processLinks(a);for(var b in this.rules){window.applyLastRule=b;a.getElements(b).each(function(c){this.rules[b](c)},this)}for(var b in ajaxRules){window.applyLastRule=b;a.getElements(b).each(function(c){ajaxRules[b](c)},this)}}});window.behavior=new Behavior();TAReadyEvent=window.TAReadyEvent||"domready";if(Browser.ie&&(typeof semHotelBoxFocus!="undefined")&&semHotelBoxFocus){ta.queueForLoad(behaviorFunction,"Behavior")}else{window.addEvent(TAReadyEvent,behaviorFunction)}var bfCount=0;function behaviorFunction(){if(typeof performancePingbackInit!="undefined"){performancePingbackInit.behaviorStart=new Number(new Date())}if(Browser.ie&&(!$("FOOT")||!$("FOOT").readyState||$("FOOT").readyState!="complete")&&bfCount<10){bfCount++;behaviorFunction.delay(30);return}if(window.hideOnLoad){Array.from(hideOnLoad).each(function(c){var b=$(c);if(b){b.hide()}})}if(!Browser.ie6){searchFocus()}processLinks(document);behavior.register(rules);var a=$("MAIN");if((window.location.hash=="#Calculator")&&($("HOMEPAGE")||(a&&a.hasClass("VacationRentals"))||$("HOTEL_LANDER"))){showDHTMLOverlayOnLoad=function(){};if(typeof vrCalculator!="undefined"){vrCalculator()}}if(typeof performancePingbackInit!="undefined"){performancePingbackInit.behaviorEnd=new Number(new Date());performancePingbackInit.domreadyTimeSet=true;checkAndSendPerformancePingback()}}function searchFocus(){var a=ta.id("mainSearch");if(a&&a.className.match(/\b(focusOnLoad)\b/)){try{a.focus()}catch(b){}}}function checkAndSendPerformancePingback(){if(typeof performancePingbackInit!="undefined"&&performancePingbackInit.enabled&&performancePingbackInit.domreadyTimeSet&&performancePingbackInit.loadTimeSet){var a=performancePingbackInit.behaviorStart-performancePingbackInit.start;var b=performancePingbackInit.loadEnd-performancePingbackInit.start;var d=performancePingbackInit.behaviorEnd-performancePingbackInit.behaviorStart;var c="/PerformancePingback?ppuid="+performancePingbackInit.uid+"&load="+b+"&domready="+a+"&behavior="+d+"&servlet="+performancePingbackInit.servlet;new Request({url:c}).send()}}function onPageLoaded(){if(typeof performancePingbackInit!="undefined"){performancePingbackInit.loadEnd=new Number(new Date());performancePingbackInit.loadTimeSet=true;checkAndSendPerformancePingback()}}window.addEvent("load",onPageLoaded);rulesN.EOBF=function(a){var b=a.innerHTML+"@tripadvisor"+a.title;new Element("a",{href:"mailto:"+b}).setContent(b).replaces(a)};var linkMap={};var popupIndex=0;function popup(s,u,p,m,h,g,b,d,c,r){try{new Event(s).preventDefault();var a="",l=this.className.match(/sz(\d+)x(\d+)/),k=ta.id(document.body),j,t,f;if(l){p=l[1];m=l[2]}if(this.href.indexOf("p=HotelsCom")>-1){p=Math.max(p,960);m=Math.max(m,window.getHeight(),600)}if(p){a+=",width="+p}if(m){a+=",height="+m}if(h){a+=",screenX="+h+",left="+h}if(g){a+=",screenY="+g+",top="+g}if(a!==""){if(c){a="toolbar=1,resizable=1,menubar=1,location=1,status=1,scrollbars=1"+a}else{a="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+(b?0:1)+a}}if(!d){d=this.href}t=u||("p"+(popupIndex++));if(r&&Browser.ie){f=new Element("a",{target:t,href:d});f.inject(k,"bottom");j=window.open("",t,a);f.click();f.destroy()}else{j=window.open(d,t,a)}if(j!==null){try{j.opener=self}catch(o){}j.focus()}}catch(q){ta.util.error.record(q,"behavior popup",s);throw q}}linkMap.js_popup=function(a,b){popup.attempt(b,a)};linkMap.js_popComm=function(a,b){popup.attempt([b,null,950,610,null,null,null,null,true],a)};linkMap.js_popMap=function(a,b){Cookie.write("mapPopup","1",{domain:cookieDomain});popup.attempt([b,"map",820,960],a)};linkMap.js_popNoScroll=function(a,b){popup.attempt([b,null,null,null,null,null,true],a)};linkMap.js_popCR=function(a,b){popup.attempt([b,"cr",245,610,5,5],a)};linkMap.js_email=function(a,b){popup.attempt([b,"email",580,460,30,25],a)};linkMap.js_popReview=function(a,b){popup.attempt([b,"review",550,395,30,25],a)};linkMap.js_popPhoto=function(a,b){popup.attempt([b,"photo",650,350],a)};linkMap.js_popGallery=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",782,820],a)};linkMap.js_popGalleryComm=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",780,950],a)};linkMap.js_popDMO=function(a,b){popup.attempt([b,"dmo",400,400],a)};linkMap.js_popNxTall=function(a,b){popup.attempt([b,330,680],a)};linkMap.js_popNxWide=function(a,b){popup.attempt([b,730,380],a)};linkMap.js_popNxLogin=function(a,b){popup.attempt([b,"login",795,645],a)};linkMap.js_popFraud=function(a,b){popup.attempt([b,"fraud",640,460],a)};linkMap.js_popDestGd=function(a,b){popup.attempt([b,"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2],a)};linkMap.js_popSmall=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,600,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,500,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popProfPhoto=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,450,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popPartner=function(a,b){if(screen.width>1024){popup.attempt([b,null,980,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{popup.attempt([b,null,620,450,210,5,false,false,true],a)}}return a};linkMap.js_noTAPD=function(a,b){Cookie.dispose("TAPD",{domain:cookieDomain})};rules["a#TERMS"]=function(a){a.addEvent("click",popup.bind(a).partial(Function._,"terms",300,300,30,25))};linkMap.js_ajaxSubmit=function(a,f){if(!a.className.match(/\bform_(\w+)\b/)){return}var d=$(RegExp.$1);var c={url:a.href,data:d,onFailure:function(h){if(d){d.removeClass("ajaxInFlight")}ta.util.error.ajaxFailure("behavior:js_ajaxSubmit",h)}};var g=window["callback"+d.id];if(a.className.match(/method_(\w+)\b/)){c.method=RegExp["$1"]}if(a.className.match(/\btgt_(\w+)\b/)){c.update=RegExp["$1"]}else{c.onSuccess=function(h){if(d){d.removeClass("ajaxInFlight")}ta.overlays.showInLightbox(h);if(g&&typeOf(g)=="function"){g()}}}new Event(f).preventDefault();var b=window["validate"+d.id];if(b&&typeOf(b)=="function"&&b.apply(d)==false){return}d.addClass("ajaxInFlight");if(a.className.match(/\bevalScripts\b/)){c.evalScripts=true}(c.update?new Request.HTML(c):new Request(c)).send()};linkMap.js_ajax=function(a,b){new Event(b).preventDefault();if(!(tgt=a.className.match(/\btgt_(\w+)\b/))){return}tgt=$(tgt[1]);new Request.HTML({url:a.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajax")}).send()};linkMap.js_ajaxlogin=function(b,c){new Event(c).preventDefault();if(!(tgt=b.className.match(/\btgt_(\w+)\b/))){return}var a=b.href;tgt=$(tgt[1]);new Request({url:b.href,onSuccess:function(d,g){var f=(d.indexOf("<!--nologin-->")<0);if(!f){login(["tt","ajax","returnTo",a+"&rd=1","greeting","showuserreviews_vote_25ee"])}else{tgt.innerHTML=d}},onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajaxLogin")}).send()};linkMap.js_ajaxReport=function(a,b){ajaxReport.attempt(b,a)};var ajaxReport=function(a){new Event(a).preventDefault();ta.overlays.loadInLightbox(this.href)};function toggle(a){new Event(a).preventDefault();this.toggleClass("off")}var toggleMeRule=function(a){if(false==a.hasClass("defaultOpen")){a.addClass("off")}a.getElements(".show").addEvent("click",toggle.bind(a));a.getElements(".hide").addEvent("click",toggle.bind(a))};rules["#TOGGLEME"]=toggleMeRule;rules["#TOGGLEME2"]=toggleMeRule;ajaxRules["div.js_swapBlocks"]=function(b){var a=b.getElement(".js_swapOut");var c=b.getElement(".js_swapIn");var d=b.getElement("a.js_swapTrigger");var f=b.getElement("a.js_swapBackTrigger");if(a&&c&&d){d.addEvent("click",function(g){new Event(g).preventDefault();window.removedBit=a.dispose();c.show()});d.removeClass("js_swapTrigger")}if(a&&c&&f){f.addEvent("click",function(g){new Event(g).preventDefault();c.hide();$("parentOfSwapOut").appendChild(window.removedBit)});f.removeClass("js_swapBackTrigger")}};ajaxRules["#PM_UNBLOCK"]=function(a){a.addEvent("submit",function(c){new Event(c).stop();var b=$("PM_UNBLOCK");if(b.unblock.value=="1"){new Request({url:"/SendMessageRD",data:b,onSuccess:ta.overlays.showInLightbox,onFailure:ta.util.error.ajaxFailure.partial("behavior:#PM_UNBLOCK")}).request()}else{$("unblock-intercept").hide();$("blockedreply").show();b.unblock.value="1"}})};function enableCommunity(c,a){var b=c;if(!a){b=function(d){enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("behavior:enableCommunity")}).send()}function enableCommunityResponse(res,callback){var isf=document.getElementById("inviteStatusField");if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){isf.innerHTML=data.ERROR;isf.style.display="block"}}else{isf.innerHTML=JS_community_on;isf.style.display="block"}}function getRelativeURL(){return window.location.pathname+window.location.search+window.location.hash}var follow=function(a){return function(){window.location=$(a).href}};function showToggleBlock(a){$$(".js_toggleBlocks .js_toggleBlock").each(function(c,b){c.hide();if(c.hasClass(a)){c.show()}})}linkMap.js_toggleBlockTrigger=function(b,c){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(d){a=d});showToggleBlock(a)};rules["#SWAPBLOCK .js_toggleBlock"]=function(b){if(b.hasClass("js_toggleBlockSelected")){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(c){a=c});showToggleBlock(a)}};var showLastSavesRD=function(){var a=$("LAST_SAVES_PLACEHOLDER");if(typeof savesIncluded!="undefined"){if(!a){return renderLastSaves(SAVES_RECENT_SAVES)}else{a.innerHTML=renderLastSaves(SAVES_RECENT_SAVES);flyout.positionCorners()}}else{if(!a){new Asset.javascript(savesJS);showLastSavesRD.delay(125);return new Element("div",{id:"LAST_SAVES_PLACEHOLDER"})}}};var showSavesWidget=function(d,g,c,b,h,f,a){if(typeof savesIncluded!="undefined"){showSavesWidget2(d,g,c,b,h,f,a)}else{new Asset.javascript(savesJS);showSavesWidget.delay(125,null,[d,g,c,b,h,f,a])}};var savesInlineLoginOnClickHandler=function(c,a,b){if(typeof savesIncluded!="undefined"){savesInlineLoginOnClickHandler2(c,a,b)}else{new Asset.javascript(savesJS);savesInlineLoginOnClickHandler.delay(125,null,[c,a,b])}};linkMap.js_trackDirPop=function(a,b){if(actionToRecord=a.className.match(/ar_(\w+)/)){actionToRecord=actionToRecord[1];new Request({url:"/ActionRecord?action="+actionToRecord}).send()}};function clearPopupForm(){$$("#POPUP_FORM #pass").setProperty("value","");$$("#DHTMLPOPUP .error-message").empty()}linkMap.js_clearPopupForm=function(a,b){clearPopupForm()};function setPopupFormAction(a){$$("#POPUP_FORM #action").setProperty("value",a)}linkMap.js_popupFormAction1=function(a,b){setPopupFormAction("1")};linkMap.js_popupFormAction2=function(a,b){setPopupFormAction("2")};var replaceContent=ta.util.element.replaceContent;linkMap.js_replaceContent=function(d,f){var b=d.className.match(/id_([^\s"]*)?/);if(!b||b.length!=2){throw new Error("Links with behavior js_replaceContent must also have a style class id_??? to indicate which element's contents should be replaced")}b=b[1];var c=$(b);var a=d.href;if(a){replaceContent(f,c,a)}f.stop()};var doBehavior=function(b){var b=new Event(b||window.event);var a=ta.id(b.target);if(a.get("tag")!="a"){a=a.getParent("a")}if(/pid(\d+)/.test(a.className)){ta.util.cookie.setPIDCookie(RegExp.$1)}(a.className.match(/(js_\w+)/g)||[]).each(function(d){linkMap[d](a,b)})};function _processLink(a){if(a.className.indexOf("js_")>=0||a.className.indexOf("pid")>=0){if(a.addEventListener){a.addEventListener("click",doBehavior,false)}else{a.attachEvent("onclick",doBehavior)}try{if(a.className.match(/\b(js_pop)/)&&window.noPopClass){a.className=a.className+" "+window.noPopClass}}catch(b){ta.util.error.record(b,"_processLink - add no pop class")}}}function processLinks(a){var b=Array.from(a.getElementsByTagName("a"));b.each(_processLink);return b.length}if(typeof behavior=="undefined"){ta.queueForLoad(function(){processLinks(document)},"ProcessLinkBehavior")}ta.queueForLoad(function(){Cookie.dispose("TATypeAhead");if(window==window.top&&!window.opener){var g=Cookie.read("ajaxAction");if(g){Cookie.dispose("ajaxAction",{domain:cookieDomain,path:"/"});g=g.split("|");try{var a=g.slice(1);a.unshift({});a.unshift(g[0]);ta.run.apply(null,a)}catch(d){ta.util.error.record(d,"ajaxAction",null,{funcName:g[0]})}}}if(Browser.firefox||Browser.safari||Browser.chrome){var f=window.location.hash;if(f.length>1){f=f.substring(1)}var b=ta.id(f);if(b&&b.getTop()!=window.getScrollTop()){window.scrollTo(0,b.getTop())}}if(/^#save/.test(location.hash)){doSavesPostLoginPopup()}freshVSCookieCheck()},"On_Load_Popups");ta.queueForLoad(function(){if(typeof cpu_run!="undefined"){cpu_run()}},"Commerce Popunder");function freshVSCookieCheck(){if(typeof freshVSTrackingCookie!="undefined"&&freshVSTrackingCookie){var a=new Cookie("v1st").readRaw();if(a){new Request({url:"/VSCookieRequest"}).send()}}}function royBatty(){if(typeof taSecureToken=="undefined"||!taSecureToken){return}try{var d=Cookie.read("roybatty");if(!d){Cookie.write("roybatty",taSecureToken+",1",{domain:cookieDomain});new Request({url:"/CookiePingback"}).send()}else{var b=d.split(",");if(b&&b.length==2){var a=parseInt(b[1],10);Cookie.write("roybatty",taSecureToken+","+a,{domain:cookieDomain})}else{ta.util.error.record(null,"royBatty -- Bad value in cookie: "+d)}}}catch(c){ta.util.error.record(c,"javascript exection bot detection error")}}ta.queueForLoad(function(){if(typeof royBatty!="undefined"){royBatty()}},"RoyBatty");var doSavesPostLoginPopup=function(){if(typeof savesIncluded!="undefined"){handleSavesPostLoginPopup()}else{new Asset.javascript(savesJS);doSavesPostLoginPopup.delay(125)}};if(window.showPopup){showPopup()}var popupConfig={};function DHTMLOverlayRequest(g,f,c,d){var b="?";if(popupConfig.servletUrl.contains(b)){b="&"}if(popupConfig.servletUrl.contains("fromServlet=")){var a=popupConfig.servletUrl+b+"Action="+g}else{var a=popupConfig.servletUrl+b+"Action="+g+"&fromServlet="+pageServlet}new Request({url:a,onSuccess:f,onFailure:c,data:d,evalScripts:true}).send()}function showDHTMLPopup(b,g,d,a,f){try{popupConfig.servlet=b;popupConfig.servletUrl=g;popupConfig.lightbox=d;popupConfig.options=a;if(a&&a.loading&&f){f=new Event(f);ta.id(a.loading).show().inject(document.body).setStyles({left:f.page.x+20,top:f.page.y})}DHTMLOverlayRequest("Open",DHTMLOverlayResponse,null,a?a.data:null)}catch(c){ta.util.error.record(c,"showDHTMLPopup - "+b,f)}}var DHTMLOverlayResponse=function(h){if(!ta.overlays||!ta.overlays.Factory){ta.load("ta-overlays",function(){DHTMLOverlayResponse(h)});return}if(popupConfig.options&&popupConfig.options.forward&&window.popupForward){window.location=window.popupForward}$$("#FLYOUT").each(function(l,k){l.dispose()});window.lightbox.deactivate();$$(".overlay").each(function(l,k){if(l.overlay&&l.overlay.hide){l.overlay.hide()}else{if(l.hide){l.hide()}else{l.dispose()}}});if(popupConfig.options&&popupConfig.options.loading){ta.id(popupConfig.options.loading).hide()}var d;var c={};if(popupConfig.lightbox){c.backdrop=ta.overlays.BACKDROP_ALWAYS}if(popupConfig.options&&popupConfig.options.delayedPosition){c.delayedPosition=popupConfig.options.delayedPosition}if(popupConfig.options&&popupConfig.options.permanent){c.permanent=popupConfig.options.permanent}if(popupConfig.options&&popupConfig.options.center){c.autoShow=false;d=new ta.overlays.CenteredOverlay(c)}else{if(popupConfig.options&&popupConfig.options.permanent){c.xOffset=ta.id("PAGE").getLeft()+100;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.PermanentOverlay(c)}else{if(popupConfig.options&&popupConfig.options.daodaoPopup){c.xOffset=ta.id("PAGE").getLeft()+240;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.AbsoluteOverlay(c)}else{c.xOffset=ta.id("PAGE").getLeft()+100;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.AbsoluteOverlay(c)}}}d.loadRemoteSuccess(h);d.show();var j=function(){if(typeof dhtmlRedirectLink!="undefined"){window.location=dhtmlRedirectLink;return}if(this.inner.getElement(".refreshOnClose")){document.location.reload();return}if(typeof addPopupCloseClass!="undefined"&&!this.inner.getElement(".silentClose")){DHTMLOverlayRequest("Close")}if(this.inner.getElement(".popupBackOnClose")){if(/(?:^|;)\\s*TAReturnTo=\%1\%([^;]*)/.test(document.cookie)){window.location=decodeURIComponent(RegExp.$1)}else{window.location="/"}}};d.addEvent("onHide",j);if(popupConfig.servlet){d.container.addClass(popupConfig.servlet);d.container.addClass("np");if(popupConfig.servlet=="RuleBasedPopup"&&popupConfig.options&&popupConfig.options.cmsDisplayName){d.container.addClass(popupConfig.options.cmsDisplayName)}d.inner.getElements(".popupConvert").each(function(l,k){l.addEvent("click",function(){DHTMLOverlayRequest("Convert")})});d.inner.getElements(".popupDecline").each(function(l,k){l.addEvent("click",function(){DHTMLOverlayRequest("Decline")})});d.inner.getElements(".dhtmlclose").each(function(l,k){l.addEvent("click",function(){var m=d;m.hide()})});var b=function(l){var k=(l.charCode)?l.charCode:((l.which)?l.which:l.keyCode);if(k==13||k==10){f(l)}};var g=function(l){var k=(l.charCode)?l.charCode:((l.which)?l.which:l.keyCode);if(k==13||k==10){new Event(l).preventDefault()}};d.inner.getElements(".popupSubmitOnEnter").each(function(l,k){l.addEvent("keydown",b)});var a=function(k){$$("#POPUP_FORM #sendpass").setProperty("value","true");f(k)};d.inner.getElements(".popupSendForgotEmail").each(function(l,k){l.addEvent("click",a)});var f=function(k){new Event(k).preventDefault();d.inner.getElements(".popupSubmit").each(function(m,l){m.removeEvent("click",f)});d.inner.getElements(".popupSendForgotEmail").each(function(m,l){m.removeEvent("click",a)});d.inner.getElements(".popupSubmitOnEnter").each(function(m,l){m.removeEvent("keydown",b);m.addEvent("keydown",g)});d.inner.getElements(".focusClear").each(function(m,l){m.setProperty("value","")});if(popupConfig.options&&popupConfig.options.disableOnHideForSubmit){d.removeEvent("onHide",j)}DHTMLOverlayRequest("Submit",DHTMLOverlayResponse,null,d.inner.getElementById("POPUP_FORM"))};d.inner.getElements(".popupSubmit").each(function(l,k){l.addEvent("click",f)})}if(popupConfig.options&&popupConfig.options.callback){popupConfig.options.callback(d.container)}};function showOwnersDHTMLPopup(b,c){var a={callback:enableAffilBox};showDHTMLPopup(b,c,true,a)}function enableAffilBox(c){if(typeof c=="undefined"||c==null){return}for(var a=0;a<3;a++){var d="affil_"+a;var b=c.getElementById(d);if(b!=null&&b!=false&&b!=""){b.style.visibility="visible"}}}var cpu_win;function verifyPopunderExists(b){try{if(cpu_win&&cpu_win.location){return}}catch(a){}new Request({url:"/ActionRecord?action=EXITWINDOWLOG_popunderfollowup|fail|delay="+b}).send()}function doCookieCheck(){Cookie.write("SessionTest","true",{duration:0});if(Cookie.read("SessionTest")){Cookie.dispose("SessionTest");return true}return false}var blurPopunder=function(){try{var a=window.open("about:blank");if(a){a.focus();a.close()}}catch(b){ta.util.error.record(b,"commercePopunder - FF/Chrome blur failed")}};var suppressPopOnClick=function(d){var c=new Event(d||window.event);var b=ta.id(c.target);if(b){if(window.noPopClass&&(b.hasClass&&b.hasClass(window.noPopClass))||(b.getParent&&b.getParent("."+window.noPopClass))){return"no_cpu_class"}var a=b.onclick;if(a&&a.toString&&a.toString().match(/window\.open/g)){return"onclick_script"}if(b.target&&"a"===b.get("tag")){return"has_target"}}return false};if(typeof cpu_enabled!="undefined"&&cpu_enabled){var cpu_paused=false;var cpu_go_impl=function(g,d){try{if(cpu_enabled&&d=="unload"&&Browser.chrome){return"Chrome_unload"}if(cpu_paused&&d=="unload"&&!isTakeOver){return"paused"}if(!doCookieCheck()){return"failed_cookie_check"}var A=new Cookie("CommercePopunder").readRaw();if(A&&isTakeOver&&d=="click"){return"already_popped"}else{if(A&&!isTakeOver){if(A!="SuppressUnload"||d!="click"){return"already_popped"}}}if(d=="click"){try{var b=suppressPopOnClick(g);if(b){return b}}catch(z){ta.util.error.record(z,"commercePopunder - suppressPopOnClick");return"error"}}if(typeof blockPU!="undefined"&&blockPU){return"block_pu"}var H="";if(typeof pageServlet!="undefined"&&pageServlet!==null){H=pageServlet}var c=typeof IS_MTPU_ENABLED!="undefined"&&IS_MTPU_ENABLED&&typeof MTPU_RULE!="undefined"&&MTPU_RULE>0;var v=c;var j=new Cookie("TASession").readRaw();if(j&&/\*PD(\d+)\.(\d+)/.test(j)&&/\*CC\.(\d+)/.test(j)&&!v){return"commerce_click_happened"}if((!j||!(/\*LL\.(\d+)/.test(j)))&&!v){return"bug_28579"}var m=1;var C=1;try{if(Browser.ie7){m=250;C=100}if(Browser.safari||Browser.chrome){m=85;C=100}}catch(z){ta.util.error.record(z,"commercePopunder - access to window attributes",g,{type:d})}var r=0,p=0;try{r=(window.screenLeft||window.screenX);p=(window.screenTop||window.screenY)}catch(D){ta.util.error.record(z,"commercePopunder - setting nX and nY",g,{type:d});r=undefined;p=undefined}var l=0,k=0;try{if(typeof(r)=="undefined"){r=0;p=0;l=r+window.screen.availWidth-m;k=p+window.screen.availHeight-C}else{l=r+window.getWidth()-m;k=p+window.getHeight()-C}}catch(z){ta.util.error.record(z,"commercePopunder - setting x and y",g,{type:d});l=200;k=200}try{if(Browser.ie7){k=k-95;l=l+13}else{if(Browser.safari||Browser.chrome){k=k-16}else{l=5000;k=5000}}}catch(z){ta.util.error.record(z,"commercePopunder - access to window attributes",g,{type:d})}if(!q){q=""}try{if(window.localStorage){localStorage.setItem("CommercePopunder.timeStamp",new Date().getTime())}}catch(f){ta.util.error.record(f,"commercePopunder - localStorage after before pop",null,{},"WARN")}var G="";if(typeof overlayBackupLoc!=undefined&&overlayBackupLoc){G="&backupLoc="+overlayBackupLoc}var o="";try{var B=window.escape(window.location.href);o="http://"+window.location.hostname+"/CommercePopunderEnhanced?mainWindowReturnTo="+B+"&fromServlet="+H+G}catch(z){ta.util.error.record(z,"commercePopunder - error accessing window.location setting cpu_uri",g,{type:d})}var u=790;var s=660;if(c){if(typeof geoParam!="undefined"&&geoParam){o="http://"+window.location.hostname+"/RuleBasedPopunder?Rule="+MTPU_RULE+"&fromServlet="+H+geoParam+G}else{o="http://"+window.location.hostname+"/RuleBasedPopunder?Rule="+MTPU_RULE+"&fromServlet="+H+G}}if(d=="click"){o=o+"&onclick=1"}var t=(o.test(/RuleBasedPopunder\?Rule=286/)||o.test(/RuleBasedPopunder\?Rule=287/))?true:false;if(t){u=740;s=700;if(Browser.ie){u=u+10}}try{var F=1;var E=1;if(ta.browser&&ta.browser.isIE9orHigher&&ta.browser.isIE9orHigher()){F=0}else{if(Browser.chrome||Browser.firefox){if(Browser.chrome){E=0}m=u;C=s;l=r+(window.getWidth()-u)/2;k=p+(window.getHeight()-s)/2}}cpu_win=window.open(o,"CommercePopunder","toolbar=1,location=1,directories=1,status=1,menubar="+F+",resizable=1,copyhistory=1,scrollbars="+E+",width="+m+",height="+C+",left="+l+",top="+k);var a=1;var q=window.cookieDomain;if(!q){q=""}if(cpu_win!=null){try{try{if(((Browser.firefox&&Browser.version>3.6)||(Browser.chrome&&(Browser.version<17||Browser.version>20)))&&d=="click"){blurPopunder()}}catch(f){ta.util.error.record(f,"commercePopunder - FF/Chrome did not blur")}cpu_win.opener=self;cpu_win.blur();window.focus();try{if(!Browser.chrome&&!Browser.firefox){cpu_win.moveTo(r+(window.getWidth()-u)/2,p+(window.getHeight()-s)/2);cpu_win.resizeTo(u,s)}}catch(f){ta.util.error.record(f,"commercePopunder - after pop, resize/move")}}catch(f){ta.util.error.record(f,"commercePopunder - after pop",null,{},"WARN")}Cookie.write("CommercePopunder","SuppressAll",{domain:q,duration:a})}else{ta.util.error.record(null,"commercePopunder - past rules, no pop",null,{},"WARN");if(d=="unload"){try{if(window.localStorage){localStorage.setItem("CommercePopunder.timeStamp",new Date().getTime())}}catch(f){ta.util.error.record(f,"commercePopunder - localStorage after pop unload fail",null,{},"WARN")}Cookie.write("CommercePopunder","SuppressUnload",{domain:q,duration:a})}}}catch(z){ta.util.error.record(z,"commercePopunder - pop window",g,{type:d})}}catch(f){ta.util.error.record(f,"commercePopunder - general",g,{type:d})}};var cpu_go=function(c,a){var b=cpu_go_impl(c,a);if(false&&document.getElement("#MAIN .poolR")&&b&&!ta.has("popunder.actionrecord")&&(b<4||b>6)){ta.store("popunder.actionrecord",true);new Request({url:"/ActionRecord?action=CPU_block_"+b}).send()}};var cpu_resume=function(){window.cpu_paused=false};var cpu_pause=function(c){var b=new Event(c||window.event);var a=ta.id(b.target);if(!cpu_paused&&a&&(a.get("tag")=="a"||a.getParent("a"))){window.cpu_paused=true;cpu_resume.delay(1000)}};var cpu_run=function(){window.addEvent("beforeunload",function(a){cpu_go(a,"unload")});document.addEvent("click",cpu_pause);document.addEvent("click",function(a){cpu_go(a,"click")})}}function expandIframe(c,a,b){if(document.getElementById(c)){document.getElementById(c).width=a;document.getElementById(c).height=b}}function collapseAd(c){var a=ta.id(c);if(a==null){return}var b=ta.id(a.parentNode);if(b&&b.hasClass&&b.hasClass("adServer")){b.addClass("taEmpty")}else{ta.util.error.record(null,"ta.common.ads.collapseAd:fail",null,{},"WARN")}}function injectAds(){var ads=$$(".adServer .details");if(ads.length==0){return}var url="adp/adp.html";if(adpHtml){url=adpHtml}var domainParam=window.documentDomainChanged?"dd+":"";for(var i=0;i<ads.length;i++){var innerDiv=ta.id(ads[i]).getParent(".adInner");if(innerDiv&&innerDiv.hasClass("deferAd")){continue}var id=ads[i].id+"_iframe";if(ta.id(id)){continue}var el=document.createElement("iframe");el.setAttribute("id",id);el.setAttribute("name",id);el.setAttribute("height",0);el.setAttribute("width",0);el.setAttribute("scrolling","no");el.setAttribute("border","0");el.setAttribute("marginheight","0");el.setAttribute("marginwidth","0");el.setAttribute("frameBorder","0");el.setAttribute("src","http://"+document.location.host+"/"+url+"#"+domainParam+eval(ads[i].id));ads[i].getParent().appendChild(el)}}function injectAdsTargeted(elmt,onload){if(!elmt){return}var ads=elmt.getElements(".adServer .details");if(ads.length==0){return}var url="adp/adp.html";if(adpHtml){url=adpHtml}var domainParam=window.documentDomainChanged?"dd+":"";for(var i=0;i<ads.length;i++){var el=document.createElement("iframe");var id=ads[i].id+"_iframe";el.setAttribute("id",id);el.setAttribute("name",id);el.setAttribute("height",0);el.setAttribute("width",0);el.setAttribute("scrolling","no");el.setAttribute("border","0");el.setAttribute("marginheight","0");el.setAttribute("marginwidth","0");el.setAttribute("frameBorder","0");el.setAttribute("src","http://"+document.location.host+"/"+url+"#"+domainParam+eval(ads[i].id));if(onload){ta.id(el).addEvent("load",onload)}ads[i].getParent().appendChild(el)}}window.addEvent("load",function(){injectAds.delay(10)});ta.common.ads={loadMonikers:function(){try{var b=ta.retrieve("ads.monikerUrl");if(b!=null){ta.common.ads._doLoadMonikers(b)}}catch(a){ta.util.error.record(a,"dynamic load of page monikers",null,"URL: $iFrameURL","INFO")}},_doLoadMonikers:function(a){if(!a){return}try{var b=document.createElement("iframe");b.setAttribute("id","Monikers");b.setAttribute("width","1");b.setAttribute("height","1");document.body.appendChild(b);b.setAttribute("src",a)}catch(c){ta.util.error.record(null,"ta.common.ads._doLoadMonikers: failed to append iframe to body.")}},getMetaContent:function(c){var g=document.getElementsByTagName("meta");for(var b=0;b<g.length;b++){var f=g[b];var a=f.name;var d=new RegExp(c,"i");if(a.match(d)){return f.content.replace(/["<>]/g,"")}}return""},loadMonikersAdcomHelper:function(){var a=ta.common.ads.getMetaContent("keywords");var c=ta.common.ads.getMetaContent("description");var d=document.location.href;var f=document.referrer;var b="/uvpages/adcom.html?pageRef="+encodeURIComponent(f)+"&keywords="+encodeURIComponent(a)+"&description="+encodeURIComponent(c)+"&pageUrl="+encodeURIComponent(d);ta.common.ads._doLoadMonikers(b)},refreshAds:function(c,a){for(var b=0;b<c.length;b++){ta.common.ads.refreshAd(document.getElement(c[b]),a)}},refreshAd:function(m,g){if(!m){return}try{var f=ta.id(m).getElement(".adServer");f.removeClass("taEmpty");if(f.hasClass("noFrame")){ta.util.error.record(c,"ta.common.ads.refreshAd: ad to refresh must be in an iframe",null,{servlet:pageServlet});return}var h=m.getElement("script");var l=document.createElement("script");var d=h.text;for(var b in g){var k=g[b];d=ta.common.ads._replaceAdParam(d,b,k)}var j=m.id||m.className;var a=f.getElement(".details");a.inject(f.empty(),"top");l.type="text/javascript";l.text=d;a.empty().adopt(l);if(m.style.display=="none"){m.show()}injectAdsTargeted(m)}catch(c){ta.util.error.record(c,"ta.common.ads.refreshAd")}},_replaceAdParam:function(g,a,f){var b=a+"=";var d=encodeURI(f);if(g.indexOf(b)==-1){return g.replace(/;sz=/gi,";"+b+d+";sz=")}else{var c=new RegExp(b+"\\w+;","gi");return g.replace(c,b+d+";")}},refreshAdAjax:function(b,a,c,d){new Request({url:"/InjectAdAjax?t="+a+"&adParamKey="+c+"&adParamVal="+d,method:"get",evalScripts:true,onSuccess:function(f,g){var h=document.getElement(b);if(h){h.empty();h.set("html",f);injectAdsTargeted(h)}else{ta.util.error.record(null,"ta.common.ads.refreshAdAjax: target not found")}},onFailure:function(f,g){ta.util.error.record(null,"ta.common.ads.refreshAdAjax: request failed")}}).send()},deferAds:function(){var k=ta.retrieve("deferAds.ads");var j=500;if(!k){return}try{var h=false;for(var f=0,g=k.length;f<g;f++){var c=k[f];if(c.getTop()<=(window.getScroll().y+window.getHeight())){if(c.hasClass("deferAd")){injectAdsTargeted(c);if(c.id=="ad300X250-bottom"){var a=ta.retrieve("scrollAd.enableScroll");if(a){window.ta_handleScroll=ta.common.scrollAd.handleScroll;setTimeout(function(){window.addEvent("scroll",window.ta_handleScroll)},j)}}}h=true;delete k[f]}}if(h){var b=[];for(var f=0,g=k.length;f<g;f++){if(typeof k[f]!="undefined"){b.push(k[f])}}ta.store("deferAds.ads",b);if(b.length<1){window.removeEvent("scroll",window.ta_handleAdDefer)}}}catch(d){ta.util.error.record(e,"ta.common.Ads.deferAds: Error with defer")}}};linkMap.js_modifySub=function(a,b){modifySub.apply(a,[b])};rules["#NEWSLETTER_CALLOUT input.memberUpdateEmail[type=text]"]=function(a){$("memberUpdatesEmailDefault").hide();$(a.form).addEvent("submit",function(b){if(a.value==$("memberUpdatesEmailDefault").innerHTML){a.value=""}})};function alertIfEmpty(a){if(a&&a.value==""){if(msg=a.className.match(/\bmsg_([\w\d]+)\b/)){alert(window[msg[1]])}else{alert("The field can not be empty")}return false}return true}function addNonMember(c,b){if(!b){b=this}popupConfig.clickedElement=b;new Event(c).preventDefault();var a="/MemberBenefitsPopup";if(/pid(\d+)/.test(b.className)){a+="?pid="+RegExp.$1}showDHTMLPopup("MemberBenefitsPopup",a,true)}function processPopDestMOGLink(b,a){if(!a){a=this}if(!loggedIn){addNonMember(b,a)}else{processGuideLink(b,a)}}function clickNonMember(){setTimeout("window.lightbox.deactivate()",500);if(popupConfig.clickedElement==null){return}var a=popupConfig.clickedElement;popupConfig.clickedElement=null;$$("#TRAVEL_GUIDES_LANDER .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});$$("#TRAVEL_GUIDES_FLY .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});if(a.className.match(/\bclickPopDestMOGLink\b/)){processPopDestMOGLink(null,a)}else{if(a.get("tag")=="a"){window.location=a.getProperty("href")}else{a.click()}}}function processPopDestMOGLink(b,a){if(!a){a=this}if(!loggedIn){addNonMember(b,a)}else{processGuideLink(b,a)}}rules["#TRAVEL_GUIDES_LANDER .clickNonMember"]=rules["#TRAVEL_GUIDES_FLY .clickNonMember"]=function(a){if(a.get("tag")!="a"||!a.className.match(/\bskipATag\b/)){a.addEvent("click",addNonMember)}};rules["#TRAVEL_GUIDES_LANDER .clickPopDestMOGLink"]=function(a){a.addEvent("click",processPopDestMOGLink)};rules["#HELP_CENTER dl.js_toggleset"]=function(a){var c=0;var b=new ToggleSet(a.getElements("dt"),a.getElements("dd"));if(window.location.hash&&(hash=window.location.hash.match(/c(\d+)/))){b.display(parseInt(hash[1]))}};rules["#TAB_CONTAINER"]=ta.widgets.tabContainer;linkMap.js_replaceContentSet=function(c,f){var d=c.className.match(/set_([^\s"]*)?/);if(!d||d.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class set_??? to indicate the set of elements the contents of which should be replaced")}var a=c.className.match(/id_([^\s"]*)?/);if(!a||a.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}a=a[1];var b=$(a);if(!b){throw new Error("Element of id "+a+" does not exist.")}d=d[1];replaceContentSet(d,f,b.id)};var replaceContentSet=function(h,j,f){j=new Event(j);var b=$$("a.set_"+h);for(var c=0;c<b.length;c++){var k=b[c];var g=k.className.match(/id_([^\s"]*)?/);if(!g||g.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}g=g[1];var d=$(g);var a=k.href;if(c==b.length-1&&f){d.addEvent("onContentReplaced",function(){window.setTimeout(function(){window.location.hash=f},200)})}else{if(f){d.removeEvents("onContentReplaced")}}if(a){replaceContent(j,d,a)}}j.stop()};function vrCalculator(c,g){var f=g!=null?new Event(g):null;if(c&&/pid(\d+)/.test(c.className)){ta.util.cookie.setPIDCookie(RegExp.$1)}var b="";var a=$("homePageVRCalcPromo");if(!a){a=$("calculatorOverviewPromo")}if(!a){a=$("calculatorLanderPromo")}if(a&&$("vrCalculatorForm")){var d=a.getElement("#geoName");if(d.hasClass("focusClear")){d.value="";d.removeClass("focusClear")}b="&geoName="+a.getElement("#geoName").value}new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,onReady:function(){this.inner.getElement("input").focus()}}).loadRemoteContent("/VacationRentalCalculator?restart=true"+b);if(f){f.stop()}return false}linkMap.js_submitVRCalculator=function(b,g){var d=g!=null?new Event(g):null;var h=$("vrCalculator");var c=h.getElement("form");var f=h.getElement(".serverErrorMsg");if(f){f.style.display="none"}if(c.geoName.value==""){h.getElement(".errorMsg").style.display=""}else{var a=c.action+"?"+c.toQueryString();replaceContent(g,h.getParent(),a)}if(d){d.stop()}return false};var SocialHistory=function(){var q={f:["http://www.facebook.com/","https://login.facebook.com/login.php","http://www.facebook.com/home.php"]};var m={};function o(v,u,t){if(v.currentStyle){var w=v.currentStyle[t]}else{if(window.getComputedStyle){var w=u.defaultView.getComputedStyle(v,null).getPropertyValue(t)}}return w}function k(t){t.parentNode.removeChild(t)}function r(){var t=document.createElement("iframe");t.style.position="absolute";t.style.visibility="hidden";document.body.appendChild(t);if(t.contentDocument){t.doc=t.contentDocument}else{if(t.contentWindow){t.doc=t.contentWindow.document}}t.doc.open();t.doc.write("<style>");t.doc.write("a{color: #000000; display:none;}");t.doc.write("a:visited {color: #FF0000; display:inline;}");t.doc.write("</style>");t.doc.close();return t}var h=r();function c(u,v){var t=h.doc.createElement("a");t.href=u;t.innerHTML=a;h.doc.body.appendChild(t)}for(var a in q){var p=q[a];for(var j=0;j<p.length;j++){c(p[j],a);if(p[j].match(/www\./)){var f=p[j].replace(/www\./,"");c(f,a)}else{var d=p[j].indexOf("//")+2;var g=p[j].substring(0,d)+"www."+p[j].substring(d);c(g,a)}}}var s=h.doc.body.childNodes;for(var j=0;j<s.length;j++){var l=o(s[j],h.doc,"display");var b=l!="none";if(b){m[s[j].innerHTML]=true}}k(h);return new (function(){var t=[];for(var u in m){t.push(u)}this.visitedSites=function(){return t};this.doesVisit=function(w){if(typeof(q[w])=="undefined"){return -1}return typeof(m[w])!="undefined"};var v=[];for(var u in q){v.push(u)}this.checkedSites=function(){return v}})()};function sniffFacebook(){var d=false;try{var a=SocialHistory();var b=a.visitedSites();if(b[0]=="f"){d=true}}catch(c){}return d}function registerOnLoad(b,a){if(ta&&ta.queueForLoad){ta.queueForLoad(b,a)}else{window.addEvent("load",b)}}function registerOnUnload(a){window.addEvent("unload",a)}function getScrollOffset(){return[window.getScrollLeft(),window.getScrollTop()]}function isIn(j,m,a){var d=getScrollOffset();m=$(m);var h=findPos(m);var f=h[0]-d[0];var k=h[1]-d[1];var c=f+m.clientWidth;var g=k+m.clientHeight;if(a){if(typeof(a)=="number"){f=f-a;k=k-a;c=c+a;g=g+a}else{if(a instanceof Array&&(a.length==2||a.length==4)){k=k-a[0];c=c+a[1];f=f-(a.length==4?a[3]:a[1]);g=g+(a.length==4?a[2]:a[0])}}}return(j[0]>=f&&j[0]<=c&&j[1]>=k&&j[1]<=g)}function setDetails(b,d,a,c){new Event(b).stop();$("title").value=d;$("category").value=a;$("space").value=c;$("newPage").submit()}function setOneTimeCookie(a,b){Cookie.write(a,b,{domain:cookieDomain,time:5});return true}var getChildByClass=function(f,d,c){if(!d||d.length==0){if(c==f.tagName){return f}}else{if(f.className&&(!c||c==f.tagName)){var g=-1;do{g=f.className.indexOf(d,g+1);if(g>=0&&(g==0||f.className.charCodeAt(g-1)==32)&&(g+d.length==f.className.length||f.className.charCodeAt(g+d.length)==32)){return f}}while(g>=0)}}for(var b=0;b<f.childNodes.length;b++){var a=getChildByClass(f.childNodes[b],d,c);if(a){return a}}return null};function showPrivacyPolicy(){window.open("/pages/privacy.html","PrivacyPolicy","toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars=3,width=800,height=600,screenX=30,screenY=25,left=30,top=25")}ta.common.header={clear:function(b,a){a=ta.id(a);a.value="";a.removeClass("hasDefault");a.removeEvent("focus","ta.common.header.clear")},clearIfEquals:function(c,a,b){if(a.value==b){ta.run("ta.common.header.clear",{},c,a)}},setSearchText:function(d,b,c){b=ta.id(b);var a=b.getParent().getNext("input");a.value=c;a.addClass("hasDefault");a.addEvent("focus",function(f){ta.call("ta.common.header.clear",f,a)})},changeSearchType:function(j,b,g){b=ta.id(b);var d=b.getParent("form"),a=b.getParent().getNext("input"),f=a.getParent().getNext(),h=a.retrieve("nameTA"),c=a.retrieve("geoTA");ta.run("ta.common.header.setSearchText",{},j,b,g);if(b.id=="dropGeoRadio"){if(h){h.pause()}if(c){c.resume()}else{if(!ta.retrieve("hotelGeoTA")){ta.store("hotelGeoTA",true);ta.run("ta.widgets.typeahead.factory.location_mutable",{onComplete:function(k){a.store("geoTA",k)}},j,a,"GEO",function(){},{minLength:3})}}d.action="/HACSearch";f.show()}else{if(c){c.pause()}if(h){h.resume()}else{if(!ta.retrieve("hotelNameTA")){ta.store("hotelNameTA",true);ta.run("ta.widgets.typeahead.factory.standard_mutable",{onComplete:function(k){a.store("nameTA",k)}},j,a,"LOCATION","ta.widgets.typeahead.events.onSelectHotelDrop",{minLength:3,xargs:"&types=hotel"})}}d.action="/Search";f.hide()}},createDrop:function(c,a){a=ta.id(a);var b=a.getNext().getElement(".subNav");ta.run("ta.overlays.Factory.createDropDown",{},c,a,b)},firstClickHotelText:function(g,b,f){b=ta.id(b);var d=b.getParent("form"),a=ta.id("dropGeoRadio"),c=ta.retrieve("hotelNameTA");hasGeoTA=b.retrieve("hotelGeoTA");if(a.checked){if(!hasGeoTA){ta.store("hotelGeoTA",true);ta.run("ta.widgets.typeahead.factory.location_mutable",{onComplete:function(h){b.store("geoTA",h)}},g,b,"GEO",function(){},{minLength:3})}}else{if(!c){ta.store("hotelNameTA",true);ta.run("ta.widgets.typeahead.factory.standard_mutable",{onComplete:function(h){b.store("nameTA")}},g,b,"LOCATION","ta.widgets.typeahead.events.onSelectHotelDrop",{minLength:3,xargs:"&types=hotel"})}}ta.run("ta.common.header.clear",{},g,b);b.removePropertyEvent("focus","ta.common.header.firstClickHotelText")},stopEventProp:function(b,a){new Event(b).stopPropagation()},submitAndSetPid:function(c,b,a){setPID(a);form=b.getParent("form");if(a&&a==18898&&ta.id("dropVracGeo").value==""){window.location="/VacationRentals"}else{form.submit()}},showFriendsOverlay:function(){var b=ta.id("FRIENDSTAB");var c=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,showArrow:true,arrowClass:"ttarrow",activate:ta.overlays.ACTIVATE_BOTH,style:"fbtt"},b);ta.store("friendsToolTip",c);if(ta.retrieve("friends_1st_resize")){var a=false;window.addEvent("resize",function(){if(!a){a=true}else{ta.common.header.hideFriendsToolTip(true)}})}else{window.addEvent("resize",function(){ta.common.header.hideFriendsToolTip(true)})}},checkFriendsToolTip:function(){if(!ta.util.localstorage||!ta.util.localstorage.canUseLocalStore()){return}var b=false;try{var a="taFriendsToolTipShown";if(!localStorage.getItem(a)){localStorage.setItem(a,true);b=true}}catch(c){ta.util.error.record(c,"checkFriendsToolTip - localStorage",null,{},"WARN")}if(b){if(!ta.overlays||!ta.overlays.RelativeOverlayBelow){if(typeof(taExtraOverlayJs)!="undefined"){new Asset.javascript(taExtraOverlayJs,{onload:ta.common.header.showFriendsOverlay})}}else{ta.common.header.showFriendsOverlay()}}},hideFriendsToolTip:function(b){var a=ta.retrieve("friendsToolTip");if(a){a.hide();window.removeEvent("resize",ta.common.header.hideFriendsToolTip)}var c=ta.id("FRIENDSTAB");if(c&&(typeof(b)=="undefined"||(b!=true))){c.addClass("hidenew")}},adjustFriendsLink:function(b){var a=$("TAIPPREFS");if(a){if(a.hasClass("auth_ip")){ta.util.cookie.setPIDCookie(18783)}else{if(a.hasClass("auth_fbc")){ta.util.cookie.setPIDCookie(15210)}else{return true}}window.location="/Friends";return false}return true}};
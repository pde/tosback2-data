var JSON;JSON||(JSON={});
(function(){function a(a){return a<10?"0"+a:a}function b(a){i.lastIndex=0;return i.test(a)?'"'+a.replace(i,function(a){var b=k[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,g){var k,l,i,u,y=j,v,n=g[a];n&&typeof n==="object"&&typeof n.toJSON==="function"&&(n=n.toJSON(a));typeof o==="function"&&(n=o.call(g,a,n));switch(typeof n){case "string":return b(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);case "object":if(!n)return"null";
j+=e;v=[];if(Object.prototype.toString.apply(n)==="[object Array]"){u=n.length;for(k=0;k<u;k+=1)v[k]=c(k,n)||"null";i=v.length===0?"[]":j?"[\n"+j+v.join(",\n"+j)+"\n"+y+"]":"["+v.join(",")+"]";j=y;return i}if(o&&typeof o==="object"){u=o.length;for(k=0;k<u;k+=1)typeof o[k]==="string"&&(l=o[k],(i=c(l,n))&&v.push(b(l)+(j?": ":":")+i))}else for(l in n)Object.prototype.hasOwnProperty.call(n,l)&&(i=c(l,n))&&v.push(b(l)+(j?": ":":")+i);i=v.length===0?"{}":j?"{\n"+j+v.join(",\n"+j)+"\n"+y+"}":"{"+v.join(",")+
"}";j=y;return i}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j,e,k={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,b,g){var k;e=j="";if(typeof g==="number")for(k=0;k<g;k+=1)e+=" ";else typeof g==="string"&&(e=g);if((o=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("JSON.stringify");return c("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,b){function e(a,c){var g,k,i=a[c];if(i&&typeof i==="object")for(g in i)Object.prototype.hasOwnProperty.call(i,g)&&(k=e(i,g),k!==void 0?i[g]=k:delete i[g]);return b.call(a,c,i)}var c,a=String(a);g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),typeof b==="function"?e({"":c},""):c;throw new SyntaxError("JSON.parse");}})();
(function(){var a=this,b=a._,c={},g=Array.prototype,i=Object.prototype,j=g.push,e=g.slice,k=g.concat,o=i.toString,t=i.hasOwnProperty,x=g.forEach,w=g.map,l=g.reduce,q=g.reduceRight,u=g.filter,y=g.every,v=g.some,n=g.indexOf,E=g.lastIndexOf,i=Array.isArray,I=Object.keys,A=Function.prototype.bind,h=function(a){if(a instanceof h)return a;if(!(this instanceof h))return new h(a);this._wrapped=a};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=h;exports._=
h}else a._=h;h.VERSION="1.4.4";var p=h.each=h.forEach=function(a,b,s){if(a!=null)if(x&&a.forEach===x)a.forEach(b,s);else if(a.length===+a.length)for(var e=0,g=a.length;e<g;e++){if(b.call(s,a[e],e,a)===c)break}else for(e in a)if(h.has(a,e)&&b.call(s,a[e],e,a)===c)break};h.map=h.collect=function(a,b,h){var e=[];if(a==null)return e;if(w&&a.map===w)return a.map(b,h);p(a,function(a,m,c){e[e.length]=b.call(h,a,m,c)});return e};h.reduce=h.foldl=h.inject=function(a,b,s,e){var c=arguments.length>2;a==null&&
(a=[]);if(l&&a.reduce===l)return e&&(b=h.bind(b,e)),c?a.reduce(b,s):a.reduce(b);p(a,function(a,m,h){c?s=b.call(e,s,a,m,h):(s=a,c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return s};h.reduceRight=h.foldr=function(a,b,s,e){var c=arguments.length>2;a==null&&(a=[]);if(q&&a.reduceRight===q)return e&&(b=h.bind(b,e)),c?a.reduceRight(b,s):a.reduceRight(b);var g=a.length;if(g!==+g)var k=h.keys(a),g=k.length;p(a,function(h,i,l){i=k?k[--g]:--g;c?s=b.call(e,s,a[i],i,l):(s=
a[i],c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return s};h.find=h.detect=function(a,b,h){var e;F(a,function(a,m,c){if(b.call(h,a,m,c))return e=a,!0});return e};h.filter=h.select=function(a,b,h){var e=[];if(a==null)return e;if(u&&a.filter===u)return a.filter(b,h);p(a,function(a,m,c){b.call(h,a,m,c)&&(e[e.length]=a)});return e};h.reject=function(a,b,e){return h.filter(a,function(a,m,h){return!b.call(e,a,m,h)},e)};h.every=h.all=function(a,b,e){b||(b=h.identity);
var g=!0;if(a==null)return g;if(y&&a.every===y)return a.every(b,e);p(a,function(a,m,h){if(!(g=g&&b.call(e,a,m,h)))return c});return!!g};var F=h.some=h.any=function(a,b,e){b||(b=h.identity);var g=!1;if(a==null)return g;if(v&&a.some===v)return a.some(b,e);p(a,function(a,m,h){if(g||(g=b.call(e,a,m,h)))return c});return!!g};h.contains=h.include=function(a,b){if(a==null)return!1;if(n&&a.indexOf===n)return a.indexOf(b)!=-1;return F(a,function(a){return a===b})};h.invoke=function(a,b){var c=e.call(arguments,
2),g=h.isFunction(b);return h.map(a,function(a){return(g?b:a[b]).apply(a,c)})};h.pluck=function(a,b){return h.map(a,function(a){return a[b]})};h.where=function(a,b,e){if(h.isEmpty(b))return e?null:[];return h[e?"find":"filter"](a,function(a){for(var m in b)if(b[m]!==a[m])return!1;return!0})};h.findWhere=function(a,b){return h.where(a,b,!0)};h.max=function(a,b,e){if(!b&&h.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&h.isEmpty(a))return-Infinity;var c={computed:-Infinity,
value:-Infinity};p(a,function(a,m,h){m=b?b.call(e,a,m,h):a;m>=c.computed&&(c={value:a,computed:m})});return c.value};h.min=function(a,b,e){if(!b&&h.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&h.isEmpty(a))return Infinity;var c={computed:Infinity,value:Infinity};p(a,function(a,m,h){m=b?b.call(e,a,m,h):a;m<c.computed&&(c={value:a,computed:m})});return c.value};h.shuffle=function(a){var b,e=0,c=[];p(a,function(a){b=h.random(e++);c[e-1]=c[b];c[b]=a});return c};var B=
function(a){return h.isFunction(a)?a:function(b){return b[a]}};h.sortBy=function(a,b,e){var c=B(b);return h.pluck(h.map(a,function(a,b,m){return{value:a,index:b,criteria:c.call(e,a,b,m)}}).sort(function(a,b){var m=a.criteria,e=b.criteria;if(m!==e){if(m>e||m===void 0)return 1;if(m<e||e===void 0)return-1}return a.index<b.index?-1:1}),"value")};var G=function(a,b,e,c){var g={},k=B(b||h.identity);p(a,function(b,h){var J=k.call(e,b,h,a);c(g,J,b)});return g};h.groupBy=function(a,b,e){return G(a,b,e,function(a,
b,m){(h.has(a,b)?a[b]:a[b]=[]).push(m)})};h.countBy=function(a,b,e){return G(a,b,e,function(a,b){h.has(a,b)||(a[b]=0);a[b]++})};h.sortedIndex=function(a,b,e,c){for(var e=e==null?h.identity:B(e),b=e.call(c,b),g=0,k=a.length;g<k;){var i=g+k>>>1;e.call(c,a[i])<b?g=i+1:k=i}return g};h.toArray=function(a){if(!a)return[];if(h.isArray(a))return e.call(a);if(a.length===+a.length)return h.map(a,h.identity);return h.values(a)};h.size=function(a){if(a==null)return 0;return a.length===+a.length?a.length:h.keys(a).length};
h.first=h.head=h.take=function(a,b,h){if(a!=null)return b!=null&&!h?e.call(a,0,b):a[0]};h.initial=function(a,b,h){return e.call(a,0,a.length-(b==null||h?1:b))};h.last=function(a,b,h){if(a!=null)return b!=null&&!h?e.call(a,Math.max(a.length-b,0)):a[a.length-1]};h.rest=h.tail=h.drop=function(a,b,h){return e.call(a,b==null||h?1:b)};h.compact=function(a){return h.filter(a,h.identity)};var H=function(a,b,e){p(a,function(a){h.isArray(a)?b?j.apply(e,a):H(a,b,e):e.push(a)});return e};h.flatten=function(a,
b){return H(a,b,[])};h.without=function(a){return h.difference(a,e.call(arguments,1))};h.uniq=h.unique=function(a,b,e,c){h.isFunction(b)&&(c=e,e=b,b=!1);var e=e?h.map(a,e,c):a,g=[],k=[];p(e,function(e,c){if(b?!c||k[k.length-1]!==e:!h.contains(k,e))k.push(e),g.push(a[c])});return g};h.union=function(){return h.uniq(k.apply(g,arguments))};h.intersection=function(a){var b=e.call(arguments,1);return h.filter(h.uniq(a),function(a){return h.every(b,function(b){return h.indexOf(b,a)>=0})})};h.difference=
function(a){var b=k.apply(g,e.call(arguments,1));return h.filter(a,function(a){return!h.contains(b,a)})};h.zip=function(){for(var a=e.call(arguments),b=h.max(h.pluck(a,"length")),c=Array(b),g=0;g<b;g++)c[g]=h.pluck(a,""+g);return c};h.object=function(a,b){if(a==null)return{};for(var e={},h=0,c=a.length;h<c;h++)b?e[a[h]]=b[h]:e[a[h][0]]=a[h][1];return e};h.indexOf=function(a,b,e){if(a==null)return-1;var c=0,g=a.length;if(e)if(typeof e=="number")c=e<0?Math.max(0,g+e):e;else return c=h.sortedIndex(a,
b),a[c]===b?c:-1;if(n&&a.indexOf===n)return a.indexOf(b,e);for(;c<g;c++)if(a[c]===b)return c;return-1};h.lastIndexOf=function(a,b,e){if(a==null)return-1;var h=e!=null;if(E&&a.lastIndexOf===E)return h?a.lastIndexOf(b,e):a.lastIndexOf(b);for(e=h?e:a.length;e--;)if(a[e]===b)return e;return-1};h.range=function(a,b,e){arguments.length<=1&&(b=a||0,a=0);for(var e=arguments[2]||1,h=Math.max(Math.ceil((b-a)/e),0),c=0,g=Array(h);c<h;)g[c++]=a,a+=e;return g};h.bind=function(a,b){if(a.bind===A&&A)return A.apply(a,
e.call(arguments,1));var h=e.call(arguments,2);return function(){return a.apply(b,h.concat(e.call(arguments)))}};h.partial=function(a){var b=e.call(arguments,1);return function(){return a.apply(this,b.concat(e.call(arguments)))}};h.bindAll=function(a){var b=e.call(arguments,1);b.length===0&&(b=h.functions(a));p(b,function(b){a[b]=h.bind(a[b],a)});return a};h.memoize=function(a,b){var e={};b||(b=h.identity);return function(){var c=b.apply(this,arguments);return h.has(e,c)?e[c]:e[c]=a.apply(this,arguments)}};
h.delay=function(a,b){var h=e.call(arguments,2);return setTimeout(function(){return a.apply(null,h)},b)};h.defer=function(a){return h.delay.apply(h,[a,1].concat(e.call(arguments,1)))};h.throttle=function(a,b){var e,h,c,g,k=0,i=function(){k=new Date;c=null;g=a.apply(e,h)};return function(){var l=new Date,o=b-(l-k);e=this;h=arguments;o<=0?(clearTimeout(c),c=null,k=l,g=a.apply(e,h)):c||(c=setTimeout(i,o));return g}};h.debounce=function(a,b,e){var h,c;return function(){var g=this,k=arguments,i=e&&!h;
clearTimeout(h);h=setTimeout(function(){h=null;e||(c=a.apply(g,k))},b);i&&(c=a.apply(g,k));return c}};h.once=function(a){var b=!1,e;return function(){if(b)return e;b=!0;e=a.apply(this,arguments);a=null;return e}};h.wrap=function(a,b){return function(){var e=[a];j.apply(e,arguments);return b.apply(this,e)}};h.compose=function(){var a=arguments;return function(){for(var b=arguments,e=a.length-1;e>=0;e--)b=[a[e].apply(this,b)];return b[0]}};h.after=function(a,b){if(a<=0)return b();return function(){if(--a<
1)return b.apply(this,arguments)}};h.keys=I||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],e;for(e in a)h.has(a,e)&&(b[b.length]=e);return b};h.values=function(a){var b=[],e;for(e in a)h.has(a,e)&&b.push(a[e]);return b};h.pairs=function(a){var b=[],e;for(e in a)h.has(a,e)&&b.push([e,a[e]]);return b};h.invert=function(a){var b={},e;for(e in a)h.has(a,e)&&(b[a[e]]=e);return b};h.functions=h.methods=function(a){var b=[],e;for(e in a)h.isFunction(a[e])&&b.push(e);return b.sort()};
h.extend=function(a){p(e.call(arguments,1),function(b){if(b)for(var e in b)a[e]=b[e]});return a};h.pick=function(a){var b={},h=k.apply(g,e.call(arguments,1));p(h,function(e){e in a&&(b[e]=a[e])});return b};h.omit=function(a){var b={},c=k.apply(g,e.call(arguments,1)),i;for(i in a)h.contains(c,i)||(b[i]=a[i]);return b};h.defaults=function(a){p(e.call(arguments,1),function(b){if(b)for(var e in b)a[e]==null&&(a[e]=b[e])});return a};h.clone=function(a){if(!h.isObject(a))return a;return h.isArray(a)?a.slice():
h.extend({},a)};h.tap=function(a,b){b(a);return a};var C=function(a,b,e,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof h)a=a._wrapped;if(b instanceof h)b=b._wrapped;var g=o.call(a);if(g!=o.call(b))return!1;switch(g){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&
a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;for(var k=e.length;k--;)if(e[k]==a)return c[k]==b;e.push(a);c.push(b);var k=0,i=!0;if(g=="[object Array]"){if(k=a.length,i=k==b.length)for(;k--;)if(!(i=C(a[k],b[k],e,c)))break}else{var g=a.constructor,l=b.constructor;if(g!==l&&(!h.isFunction(g)||!(g instanceof g&&h.isFunction(l)&&l instanceof l)))return!1;for(var t in a)if(h.has(a,t)&&(k++,!(i=h.has(b,t)&&C(a[t],b[t],e,c))))break;if(i){for(t in b)if(h.has(b,t)&&!k--)break;
i=!k}}e.pop();c.pop();return i};h.isEqual=function(a,b){return C(a,b,[],[])};h.isEmpty=function(a){if(a==null)return!0;if(h.isArray(a)||h.isString(a))return a.length===0;for(var b in a)if(h.has(a,b))return!1;return!0};h.isElement=function(a){return!!(a&&a.nodeType===1)};h.isArray=i||function(a){return o.call(a)=="[object Array]"};h.isObject=function(a){return a===Object(a)};p(["Arguments","Function","String","Number","Date","RegExp"],function(a){h["is"+a]=function(b){return o.call(b)=="[object "+
a+"]"}});if(!h.isArguments(arguments))h.isArguments=function(a){return!(!a||!h.has(a,"callee"))};if(typeof/./!=="function")h.isFunction=function(a){return typeof a==="function"};h.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};h.isNaN=function(a){return h.isNumber(a)&&a!=+a};h.isBoolean=function(a){return a===!0||a===!1||o.call(a)=="[object Boolean]"};h.isNull=function(a){return a===null};h.isUndefined=function(a){return a===void 0};h.has=function(a,b){return t.call(a,b)};h.noConflict=
function(){a._=b;return this};h.identity=function(a){return a};h.times=function(a,b,e){for(var h=Array(a),c=0;c<a;c++)h[c]=b.call(e,c);return h};h.random=function(a,b){b==null&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var z={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};z.unescape=h.invert(z.escape);var K={escape:RegExp("["+h.keys(z.escape).join("")+"]","g"),unescape:RegExp("("+h.keys(z.unescape).join("|")+")","g")};h.each(["escape","unescape"],function(a){h[a]=
function(b){if(b==null)return"";return(""+b).replace(K[a],function(b){return z[a][b]})}});h.result=function(a,b){if(a==null)return null;var e=a[b];return h.isFunction(e)?e.call(a):e};h.mixin=function(a){p(h.functions(a),function(b){var e=h[b]=a[b];h.prototype[b]=function(){var a=[this._wrapped];j.apply(a,arguments);a=e.apply(h,a);return this._chain?h(a).chain():a}})};var L=0;h.uniqueId=function(a){var b=++L+"";return a?a+b:b};h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;h.template=function(a,b,e){var c,e=h.defaults({},e,h.templateSettings),g=RegExp([(e.escape||D).source,(e.interpolate||D).source,(e.evaluate||D).source].join("|")+"|$","g"),k=0,i="__p+='";a.replace(g,function(b,e,c,h,g){i+=a.slice(k,g).replace(N,function(a){return"\\"+M[a]});e&&(i+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'");c&&(i+="'+\n((__t=("+
c+"))==null?'':__t)+\n'");h&&(i+="';\n"+h+"\n__p+='");k=g+b.length;return b});i+="';\n";e.variable||(i="with(obj||{}){\n"+i+"}\n");i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{c=new Function(e.variable||"obj","_",i)}catch(l){throw l.source=i,l;}if(b)return c(b,h);b=function(a){return c.call(this,a,h)};b.source="function("+(e.variable||"obj")+"){\n"+i+"}";return b};h.chain=function(a){return h(a).chain()};h.mixin(h);p(["pop","push",
"reverse","shift","sort","splice","unshift"],function(a){var b=g[a];h.prototype[a]=function(){var e=this._wrapped;b.apply(e,arguments);(a=="shift"||a=="splice")&&e.length===0&&delete e[0];return this._chain?h(e).chain():e}});p(["concat","join","slice"],function(a){var b=g[a];h.prototype[a]=function(){var a=b.apply(this._wrapped,arguments);return this._chain?h(a).chain():a}});h.extend(h.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);
(function(){var a={},b=window,c=b.document,g;a.disabled=!1;a.set=function(){};a.get=function(){};a.remove=function(){};a.clear=function(){};a.transact=function(b,e,c){var g=a.get(b);c==null&&(c=e,e=null);typeof g=="undefined"&&(g=e||{});c(g);a.set(b,g)};a.getAll=function(){};a.serialize=function(a){return JSON.stringify(a)};a.deserialize=function(a){if(typeof a=="string")return JSON.parse(a)};var i;try{i="localStorage"in b&&b.localStorage}catch(j){i=!1}if(i)g=b.localStorage,a.set=function(b,e){if(e===
void 0)return a.remove(b);g.setItem(b,a.serialize(e))},a.get=function(b){return a.deserialize(g.getItem(b))},a.remove=function(a){g.removeItem(a)},a.clear=function(){g.clear()},a.getAll=function(){for(var b={},e=0;e<g.length;++e){var c=g.key(e);b[c]=a.get(c)}return b};else{var e;try{e="globalStorage"in b&&b.globalStorage&&b.globalStorage[b.location.hostname]}catch(k){e=!1}if(e)g=b.globalStorage[b.location.hostname],a.set=function(b,e){if(e===void 0)return a.remove(b);g[b]=a.serialize(e)},a.get=function(b){return a.deserialize(g[b]&&
g[b].value)},a.remove=function(a){delete g[a]},a.clear=function(){for(var a in g)delete g[a]},a.getAll=function(){for(var b={},e=0;e<g.length;++e){var c=g.key(e);b[c]=a.get(c)}return b};else if(c.documentElement.addBehavior){var o,t;try{t=new ActiveXObject("htmlfile"),t.open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>'),t.close(),o=t.w.frames[0].document,g=o.createElement("div")}catch(x){g=c.createElement("div"),o=c.body}b=function(b){return function(){var e=
Array.prototype.slice.call(arguments,0);e.unshift(g);o.appendChild(g);g.addBehavior("#default#userData");g.load("localStorage");e=b.apply(a,e);o.removeChild(g);return e}};a.set=b(function(b,e,c){e="_"+e;if(c===void 0)return a.remove(e);b.setAttribute(e,a.serialize(c));b.save("localStorage")});a.get=b(function(b,e){return a.deserialize(b.getAttribute("_"+e))});a.remove=b(function(a,b){a.removeAttribute("_"+b);a.save("localStorage")});a.clear=b(function(a){var b=a.XMLDocument.documentElement.attributes;
a.load("localStorage");for(var e=0,c;c=b[e];e++)a.removeAttribute(c.name);a.save("localStorage")});a.getAll=b(function(b){var e=b.XMLDocument.documentElement.attributes;b.load("localStorage");for(var b={},c=0,g;g=e[c];++c)b[g]=a.get(g);return b})}}try{a.set("__storejs__","__storejs__");if(a.get("__storejs__")!="__storejs__")a.disabled=!0;a.remove("__storejs__")}catch(w){a.disabled=!0}typeof module!="undefined"&&typeof module!="function"?module.exports=a:typeof define==="function"&&define.amd?define(a):
this.store=a})();r=window.r||{};r.setup=function(a){reddit=r.config=a;_.each(["debug","warn","error"],function(b){r[b]=(b!="debug"||a.debug)&&window.console&&console[b]?_.bind(console[b],console):function(){}});r.config.currentOrigin=location.protocol+"//"+location.host;r.analytics.breadcrumbs.init()};r.setupBackbone=function(){Backbone.ajax=function(a){var b=r.preload.read(a.url);if(b!=null)a.success(b);else return Backbone.$.ajax(a)}};
$(function(){r.setupBackbone();r.login.ui.init();r.analytics.init();r.ui.init();r.interestbar.init();r.apps.init();r.wiki.init();r.gold.init()});r.preload={timestamp:new Date,maxAge:3E5,data:{},isExpired:function(){return new Date-this.timestamp<this.maxAge},set:function(a){_.extend(this.data,a)},read:function(a){var b=this.data[a];if(a[0]=="#")return b;if(!this.isExpired())return b}};r.ui={};r.ui.Base=function(a){this.$el=$(a)};
r.ui.collapsibleSideBox=function(a){var b=$("#"+a);return new r.ui.Collapse(b.find(".title"),b.find(".content"),a)};r.ui.Collapse=function(a,b,c){r.ui.Base.call(this,a);this.target=b;this.key="ui.collapse."+c;this.isCollapsed=store.get(this.key)==!0;this.$el.click($.proxy(this,"toggle",null,!1));this.toggle(this.isCollapsed,!0)};
r.ui.Collapse.prototype={animDuration:200,toggle:function(a,b){a==null&&(a=!this.isCollapsed);var c=b?0:this.animDuration;a?$(this.target).slideUp(c):$(this.target).slideDown(c);this.isCollapsed=a;store.set(this.key,a);this.update()},update:function(){this.$el.find(".collapse-button").text(this.isCollapsed?"+":"-")}};r.strings=function(a,b){var c=r.strings.index[a];return b?r.utils.pyStrFormat(c,b):c};r.strings.index={};r.strings.set=function(a){_.extend(r.strings.index,a);this.permissions=this.index.permissions};
r.analytics={trackers:{},_pendingTrackers:{},init:function(){$(document).delegate(".promotedlink.promoted","onshow",_.bind(function(a){this.fetchTrackersOrFirePixel(a.target)},this));$(".promotedlink.promoted:visible").trigger("onshow");$("form.google-checkout").on("submit",this.fireGoogleCheckout);$("form.gold-checkout").one("submit",this.fireGoldCheckout)},fetchTrackingHash:function(a){var b=$(a),a=b.data("fullname"),b=b.data("cid");a+="-"+(b||"");r.config.is_fake||(a+="-"+r.config.post_site);a in
this.trackers||(this._pendingTrackers[a]=this.trackers[a]=new $.Deferred,this.fetchTrackingHashes());return this.trackers[a]},fetchTrackingHashes:_.debounce(function(){var a=this._pendingTrackers;$.ajax({url:r.config.fetch_trackers_url,type:"get",dataType:"jsonp",data:{ids:_.keys(a)},success:function(b){_.each(b,function(b,g){a[g].resolve(g,b)})}});this._pendingTrackers={}},0),fetchTrackersOrFirePixel:function(a){this.fetchTrackingHash(a).done(_.bind(function(b,c){this.fireTrackingPixel(a,b,c)},this))},
fireTrackingPixel:function(a,b,c){a=$(a);if(!a.data("trackerFired")){(new Image).src=r.config.adtracker_url+"?"+$.param({id:b,hash:c,r:Math.round(Math.random()*2147483647)});var g=a.find("a.title"),i=g.html(),j=g.attr("href"),b=r.config.clicktracker_url+"?"+$.param({id:b,hash:c,url:j});save_href(g);g.attr("href",b);g.html()!=i&&g.html(i);c=a.find("a.thumbnail");save_href(c);c.attr("href",b);a.data("trackerFired",!0)}},fireUITrackingPixel:function(a,b){(new Image).src=r.config.uitracker_url+"?"+$.param(_.extend({act:a,
sr:b,r:Math.round(Math.random()*2147483647)},r.analytics.breadcrumbs.toParams()))},fireGoldCheckout:function(a){var b=$(this),c=b.data("vendor");b.parent().addClass("working");_gaq.push(["_trackPageview","/gold/external/"+c]);_gaq.push(function(){b.submit()});_gat&&_gat._getTracker&&a.preventDefault()},fireGoogleCheckout:function(){$(this).parent().addClass("working");_gaq.push(function(){var a=_gaq._getAsyncTracker();setUrchinInputCode(a)})}};
r.analytics.breadcrumbs={selector:".thing, .side, .sr-list, .srdrop, .tagline, .md, .organic-listing, .gadget, .sr-interest-bar, a, button, input",maxLength:3,sendLength:2,init:function(){this.hasSessionStorage=this._checkSessionStorage();this.data=this._load();this.data[0]&&this.data[0].url==window.location||this._storeBreadcrumb();$(document).delegate("a, button","click",$.proxy(function(a){this.storeLastClick($(a.target))},this))},_checkSessionStorage:function(){try{return sessionStorage.setItem("__test__",
"test"),sessionStorage.removeItem("__test__"),!0}catch(a){return!1}},_load:function(){if(!this.hasSessionStorage)return[{stored:!1}];var a;try{a=JSON.parse(sessionStorage.breadcrumbs)}catch(b){a=[]}_.isArray(a)||(a=[]);return a},store:function(){this.hasSessionStorage&&(sessionStorage.breadcrumbs=JSON.stringify(this.data))},_storeBreadcrumb:function(){var a={url:location.toString()};if("referrer"in document){var b=!document.referrer.match("^"+r.config.currentOrigin),c=this.data[0]&&document.referrer!=
this.data[0].url;if(b||c)a.ref=document.referrer}this.data.unshift(a);this.data=this.data.slice(0,this.maxLength);this.store()},storeLastClick:function(a){try{this.data[0].click=r.utils.querySelectorFromEl(a,this.selector),this.store()}catch(b){}},lastClickFullname:function(){var a=_.find(this.data,function(a){return a.click});if(a)return(a=a.click.match(/.*data-fullname="(\w+)"/))&&a[1]},toParams:function(){params=[];for(var a=0;a<this.sendLength;a++)_.each(this.data[a],function(b,c){params["c"+
a+"_"+c]=b});return params}};
(function(a){function b(){return function(b){if(b.jquery){var c={};c[0]=jQuery;a.map(b.jquery,function(b){var e=b[0],g=b[1],i=b[2],b=b[3];if(typeof b=="string")b=a.unsafe(b);else for(var l=0;b.length&&l<b.length;l++)b[l]=a.unsafe(b[l]);i=="call"?c[g]=c[e].apply(c[e]._obj,b):i=="attr"?(c[g]=c[e][b],c[g]?c[g]._obj=c[e]:a.debug("unrecognized")):i=="refresh"?a.refresh():a.debug("unrecognized")})}}}a.log=function(a){window.console?window.console.debug?window.console.debug(a):window.console.log&&window.console.log(a):
alert(a)};a.debug=function(b){if(a.with_default(reddit.debug,!1))return a.log(b)};a.fn.debug=function(){a.debug(a(this));return a(this)};a.redirect=function(a){window.location=a};a.fn.redirect=function(b){a(this).filter("form").find(".status").show().html("redirecting...");if(a(this).attr("target")=="_top"){for(var c=window;c!=c.parent;)c=c.parent;c.location=b}else a.redirect(b);return a(this)};a.refresh=function(){window.location.reload(!0)};a.defined=function(a){return typeof a!="undefined"};a.with_default=
function(b,c){return a.defined(b)?b:c};a.websafe=function(a){typeof a=="string"&&(a=a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;"));return a||""};a.unsafe=function(a){typeof a=="string"&&(a=a.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"));return a||""};a.uniq=function(a,b){for(var c=[],g={},i=b?b:a.length,j=0;j<a.length&&c.length<i;j++)g[a[j]]||(g[a[j]]=!0,c.push(a[j]));return c};(function(b,c){a.fn.show=function(c,
g){a(this).trigger("onshow");return b.call(this,c,g)};a.fn.hide=function(b,e){a(this).trigger("onhide");return c.call(this,b,e)}})(a.fn.show,a.fn.hide);var c={};a.handleResponse=b;a.request=function(e,g,i,j,x,w,l){var q=e,u=i;if(rate_limit(e))l&&l("ratelimit");else if(!(window!=window.top&&!reddit.cnameframe&&!reddit.external_frame)){if(!(u=!a.with_default(j,!1)))u=c[q]?!1:c[q]=!0;j=u;g=a.with_default(g,{});i=a.with_default(i,b(q));x=a.with_default(x,"json");typeof i!="function"&&(i=b(q));u=function(a){delete c[q];
return i(a)};errorhandler_in=a.with_default(l,function(){});l=function(a){delete c[q];return errorhandler_in(a)};w=a.with_default(w,!1);if(reddit.post_site)g.r=reddit.post_site;if(reddit.cnameframe)g.cnameframe=1;if(reddit.logged)g.uh=reddit.modhash;g.renderstyle=reddit.renderstyle;j&&a.ajax({type:w?"GET":"POST",url:"/api/"+e,data:g,success:u,error:l,dataType:x})}};rate_limit=function(){var a={vote:333,comment:5E3,ignore:0,ban:0,unban:0,assignad:0},b={},c=Date;return function(g){var i=new c,j=g in
a?a[g]:333,l=b[g];b[g]=i;return l&&i-l<j}}();a.fn.vote=function(b,c,g,i){if(reddit.logged&&a(this).hasClass("arrow")){var j=a(this).hasClass("up")?1:a(this).hasClass("down")?-1:0,w=a(this).all_things_by_id(),l=w.children().not(".child").find(".arrow"),q=j==1?"up":"upmod";l.filter("."+q).removeClass(q).addClass(j==1?"upmod":"up");q=j==-1?"down":"downmod";l.filter("."+q).removeClass(q).addClass(j==-1?"downmod":"down");reddit.logged&&(w.each(function(){var b=a(this).find(".entry:first, .midcol:first");
j>0?b.addClass("likes").removeClass("dislikes unvoted"):j<0?b.addClass("dislikes").removeClass("likes unvoted"):b.addClass("unvoted").removeClass("likes dislikes")}),a.defined(i)||(i=w.filter(":first").thing_id(),b+=g?"":"-"+i,a.request("vote",{id:i,dir:j,vh:b})));c&&c(w,j)}};a.fn.show_unvotable_message=function(){a(this).thing().find(".entry:first .unvotable-message").css("display","inline-block")};a.fn.thing=function(){return this.parents(".thing:first")};a.fn.all_things_by_id=function(){return this.thing().add(a.things(this.thing_id()))};
a.fn.thing_id=function(b){var b=a.with_default(b,"thing"),c=this.hasClass("thing")?this:this.thing();b!="thing"&&(c=c.find("."+b+":first"));if(c.length)return b=a.grep(c.get(0).className.match(/\S+/g),function(a){return a.match(/^id-/)}),b.length?b[0].slice(3,b[0].length):"";return""};a.things=function(){var b=a.map(arguments,function(a){return".thing.id-"+a}).join(", ");return a(b)};a.fn.same_author=function(){var b=a(this).thing_id("author"),c=[];a(".author.id-"+b).each(function(){c.push(".thing.id-"+
a(this).thing_id())});return a(c.join(", "))};a.fn.things=function(){return this.find(a.map(arguments,function(a){return".thing.id-"+a}).join(", "))};a.listing=function(b){b=b||"";if(b.slice(0,1)=="#"||b.slice(0,1)==".")b=b.slice(1,b.length);var c=b;b.slice(0,9)!="siteTable"?c="siteTable"+(b?"_"+b:""):b=b.slice(10,b.length);var g=a("#"+c).filter(":first");g.length==0&&(g=a.things(b).find(".child").append(document.createElement("div")).children(":last").addClass("sitetable").attr("id",c));return g};
var g=function(){};a.fn.set_thing_init=function(b){g=b;a(this).find(".thing:not(.stub)").each(function(){b(this)})};a.fn.new_thing_child=function(b,c){var g=this.thing_id(),i=c?a.listing(g):this.thing().find(".child:first");return(typeof b=="string"?i.prepend(b).children(":first"):b.hide().prependTo(i).show().find('input[name="parent"]').val(g).end()).randomize_ids()};a.fn.randomize_ids=function(){var b=(Math.random()+"").split(".")[1];a(this).find("*[id]").each(function(){a(this).attr("id",a(this).attr("id")+
b)}).end().find("label").each(function(){a(this).attr("for",a(this).attr("for")+b)});return a(this)};a.fn.replace_things=function(b,c,i,j){var x=this;return a.map(b,function(b){var e=b.data,b=a(x).things(e.id);j&&(b=b.filter(".stub"));if(b.length==0){var q=a.things(e.parent);q.length&&(b=a("<div></div>"),q.find(".child:first").append(b))}b.after(a.unsafe(e.content));e=b.next();c&&(e.show().children(".midcol, .entry").hide().end().children(".child:first").html(b.children(".child:first").remove().html()).end(),
i&&(b.hide(),e.children(".midcol, .entry").show()),e.find(".rank:first").html(b.find(".rank:first").html()));i?(b.hide(),c?e.children(".midcol, .entry").show():e.show()):e.hide();b.remove();g(e);a(document).trigger("new_thing",e);return e})};a.insert_things=function(b,c){return a.map(b,function(b){var b=b.data,e=a.listing(b.parent),e=c?e.append(a.unsafe(b.content)).children(".thing:last"):e.prepend(a.unsafe(b.content)).children(".thing:first");g(e.hide().show());a(document).trigger("new_thing",e);
return e})};a.fn.delete_table_row=function(b){var c=this.parents("tr:first").get(0),g=this.parents("table").get(0);c?a(c).fadeOut(function(){g.deleteRow(c.rowIndex);b&&b()}):b&&b()};a.fn.insert_table_rows=function(b,c){var g=this.is("table")?this.filter("table"):this.parents("table:first");a.map(g.get(),function(g){a.map(b,function(b){var e=c;e<0&&(e=Math.max(g.rows.length+e+1,0));var e=Math.min(e,g.rows.length),i=g.insertRow(e);a(i).hide().attr("id",b.id).addClass(b.css_class);a.map(b.cells,function(b){a(i.insertCell(i.cells.length)).html(a.unsafe(b)).trigger("insert-cell")});
a(i).trigger("insert-row");a(i).fadeIn()})});return this};a.fn.captcha=function(a){var b=this.find(".capimage");a&&b.attr("src","/captcha/"+a+".png").parents("form").find('input[name="iden"]').val(a);return b};a.fn.insertAtCursor=function(b){return a(this).filter("textarea").each(function(){var c=a(this).get(0),g=c.scrollTop;if(document.selection)c.focus(),document.selection.createRange().text=b;else if(c.selectionStart){var i=c.selectionStart;c.value=c.value.substring(0,c.selectionStart)+b+c.value.substring(c.selectionEnd,
c.value.length);i+=b.length;c.setSelectionRange(i,i)}else c.value+=b;if(c.scrollHeight)c.scrollTop=g;a(this).focus()}).end()};a.fn.select_line=function(b){return a(this).filter("textarea").each(function(){var c="\n",g=1,i=0;a.browser.msie&&(c="\r",g=0,i=1);for(var c=a(this).val().split(c),j=0;j<b-1;j++)i+=c[j].length+g;j=i;b<=c.length&&(j+=c[b-1].length+g);a(this).focus();this.createTextRange?(g=this.createTextRange(),g.move("character",i),i=this.createTextRange(),i.move("character",j),g.setEndPoint("StartToEnd",
i),g.select()):this.selectionStart&&this.setSelectionRange(i,j);if(this.scrollHeight)this.scrollTop=(b-2)*(this.scrollHeight/c.length)})};a.apply_stylesheet=function(b){var c=a("head").children("link[title], style[title]").filter(":first").attr("title")||"preferred stylesheet";if(document.styleSheets[0].cssText)for(var g=document.styleSheets,i=0;i<g.length;i++){if(g[i].title==c){g[i].cssText=b;break}}else a("head").children('*[title="'+c+'"]').remove(),a('<style type="text/css" media="screen"></style>').attr("title",
c).text(b).appendTo("head")};a.rehighlight_new_comments=function(){checked=a(".comment-visits-box input:checked");checked.length>0&&highlight_new_comments(checked[0].value)};var i;a.default_cookie_domain=function(a){a&&(i=a)};var j="_";a.cookie_name_prefix=function(a){a&&(j=a+"_")};a.cookie_write=function(b){if(b.name){var c={};c.expires=b.expires;c.domain=b.domain||i;c.path=b.path||"/";var g=j+b.name,b=b.data;b===null||b==""?b=null:typeof b!="string"&&(b=JSON.stringify(b));a.cookie(g,b,c)}};a.cookie_read=
function(b,c){var g=a.cookie((c||j)+b);try{g=JSON.parse(g)}catch(i){}return{name:b,data:g}}})(jQuery);function open_menu(a){$(a).siblings(".drop-choices").not(".inuse").css("top",a.offsetHeight+"px").each(function(){$(this).css("left",$(a).position().left+"px").css("top",$(a).height()+$(a).position().top+"px")}).addClass("active inuse")}
function close_menus(a){$(".drop-choices.inuse").not(".active").removeClass("inuse");$(".drop-choices.active").removeClass("active").trigger("close_menu");$(".flairselector").empty();$(a.target).closest("#search").length==0&&($("#moresearchinfo").slideUp(),$("#searchexpando").length==1?$("#searchexpando").slideUp(function(){$("#search_showmore").parent().show()}):$("#search_showmore").parent().show())}function hover_open_menu(){}
function select_tab_menu(a,b){var c="tabbedpane-"+b,g=$(a).parent().parent().parent();g.find(".tabmenu li").removeClass("selected");$(a).parent().addClass("selected");g.find(".tabbedpane").each(function(){this.style.display=this.id==c?"block":"none"})}function update_user(a){try{var b=$(a).find('input[name="user"]').val();a.action+="/"+b}catch(c){}return!0}function post_user(a,b){var c=$(a).find('input[name="user"]').val();return c==null?post_form(a,b):post_form(a,b+"/"+c)}
function post_form(a,b,c,g,i){try{return c==null&&(c=function(){return reddit.status_msg.submitting}),$(a).find(".error").not(".status").hide(),$(a).find(".status").html(c(a)).show(),simple_post_form(a,b,{},i)}catch(j){return!1}}
function get_form_fields(a,b,c){b=b||{};c||(c=function(){return!0});$(a).find("select, input, textarea").not(".gray, :disabled").each(function(){var a=$(this),i=a.attr("type");if(c(this))if(a.data("send-checked"))b[a.attr("name")]=a.is(":checked");else if(i!="radio"&&i!="checkbox"||a.is(":checked"))b[a.attr("name")]=a.val()});if(b.id==null)b.id=$(a).attr("id")?"#"+$(a).attr("id"):"";return b}
function form_error(a){return function(b){b=b=="ratelimit"?r.strings("rate_limit"):r.strings("an_error_occurred",{status:b.status});$(a).find(".status").text(b)}}function simple_post_form(a,b,c,g,i){$.request(b,get_form_fields(a,c),i,g,"json",!1,form_error(a));return!1}
function post_pseudo_form(a,b,c){$(a).find(".error").not(".status").hide();$(a).find(".status").html(reddit.status_msg.submitting).show();$.request(b,get_form_fields(a,{},function(b){b=$(b).parents("form:first");return b.length==0||b.get(0)==$(a).get(0)}),null,c,"json",!1,form_error(a));return!1}function post_multipart_form(a){$(a).find(".error").not(".status").hide();$(a).find(".status").html(reddit.status_msg.submitting).show();return!0}
function emptyInput(a,b){!$(a).val()||$(a).val()==b?$(a).addClass("gray").val(b).attr("rows",3):$(a).focus(function(){})}function showlang(){$(".lang-popup:first").show();return!1}function hidecover(a){$(a).parents(".cover-overlay").hide();return!1}function deleteRow(a){$(a).delete_table_row()}
function change_state(a,b,c,g,i){var j=$(a).parents("form").first(),e=j.find('input[name="id"]'),e=e.length?e.val():$(a).thing_id();simple_post_form(j,b,{id:e},void 0,i);c&&c(j.length?j:a,b);$.defined(g)||j.html(j.find('[name="executed"]').val());return!1}function unread_thing(a){a=$(a);a.hasClass("thing")||(a=a.thing());$(a).addClass("new unread")}
function read_thing(a){a=$(a);a.hasClass("thing")||(a=a.thing());$(a).hasClass("new")?$(a).removeClass("new"):$(a).removeClass("unread");$.request("read_message",{id:$(a).thing_id()})}function save_thing(a){$(a).thing().addClass("saved")}function unsave_thing(a){$(a).thing().removeClass("saved")}
function toggle_save(a){var b=$(a).parents("form").first().find('[name="executed"]'),c=b.val();$(a).thing().hasClass("saved")?change_state(a,"unsave",void 0,!0):change_state(a,"save",void 0,!0);$(a).thing().toggleClass("saved");b.val($(a).text());$(a).text(c)}function click_thing(a){var b=$(a);b.hasClass("thing")||(b=b.thing());b.hasClass("message")&&b.hasClass("recipient")&&(b.hasClass("unread")?b.removeClass("unread"):b.hasClass("new")&&read_thing(a))}
function hide_thing(a){$(a).thing().fadeOut(function(){$(this).toggleClass("hidden");unexpando_child(a)})}function toggle_label(a,b,c){$(a).parent().find(".option").toggle();$(a)[0].onclick=function(){return toggle_label(a,c,b)};b&&b(a)}function toggle(a,b,c){r.analytics.breadcrumbs.storeLastClick(a);var g=$(a).parent().andSelf().filter(".option").removeClass("active").siblings().addClass("active").get(0);if(c&&!g.onclick)g.onclick=function(){return toggle(g,c,b)};b&&b(a);return!1}
function cancelToggleForm(a,b,c,g){c&&$(a).filter("button").length&&(c=$(a).thing().find(c).children(":visible").filter(":first"),toggle(c));$(a).thing().find(b).each(function(){g&&g($(this));$(this).hide().remove()});return!1}function linkstatus(){return reddit.status_msg.submitting}
function subscribe(a){return function(){reddit.logged&&(reddit.cur_site==a&&$("body").addClass("subscriber"),$.things(a).find(".entry").addClass("likes"),$.request("subscribe",{sr:a,action:"sub"}),r.analytics.fireUITrackingPixel("sub",a))}}function unsubscribe(a){return function(){reddit.logged&&(reddit.cur_site==a&&$("body").removeClass("subscriber"),$.things(a).find(".entry").removeClass("likes"),$.request("subscribe",{sr:a,action:"unsub"}),r.analytics.fireUITrackingPixel("unsub",a))}}
function friend(a,b,c){return function(){reddit.logged&&(encoded=encodeURIComponent(document.referrer),$.request("friend?note="+encoded,{name:a,container:b,type:c}))}}function unfriend(a,b,c){return function(){$.request("unfriend",{name:a,container:b,type:c})}}function share(a){$.request("new_captcha");$(a).new_thing_child($(".sharelink:first").clone(!0).attr("id","sharelink_"+$(a).thing_id()),!1);$.request("new_captcha")}
function cancelShare(a){return cancelToggleForm(a,".sharelink",".share-button")}function reject_promo(a){$(a).thing().find(".rejection-form").show().find("textare").focus()}function cancel_reject_promo(a){$(a).thing().find(".rejection-form").hide()}function complete_reject_promo(a){$(a).thing().removeClass("accepted").addClass("rejected").find(".reject_promo").remove()}function helpon(a){$(a).parents(".usertext-edit:first").children(".markhelp:first").show()}
function helpoff(a){$(a).parents(".usertext-edit:first").children(".markhelp:first").hide()}function show_all_messages(a){var b=[];$(a).parents(".message").find(".entry .collapsed").hide().end().find(".noncollapsed, .midcol:first").filter(":hidden").each(function(){var a=$(this).show().thing_id();b.indexOf(a)==-1&&b.push(a)});b.length&&$.request("uncollapse_message",{id:b.join(",")});return!1}
function hide_all_messages(a){var b=[];$(a).parents(".message").find(".entry .collapsed").show().end().find(".noncollapsed, .midcol:first").filter(":visible").each(function(){var a=$(this).hide().thing_id();b.indexOf(a)==-1&&b.push(a)});b.length&&$.request("collapse_message",{id:b.join(",")});return!1}
function hidecomment(a){a=$(a).thing();a.hide().find(".noncollapsed:first, .midcol:first").hide().end().show().find(".entry:first .collapsed").show();a.hasClass("message")?$.request("collapse_message",{id:$(a).thing_id()}):a.find(".child:first").hide();return!1}
function showcomment(a){a=$(a).thing();a.find(".entry:first .collapsed").hide().end().find(".noncollapsed:first, .midcol:first").show().end().show();a.hasClass("message")?$.request("uncollapse_message",{id:$(a).thing_id()}):a.find(".child:first").show();return!1}function morechildren(a,b,c,g,i){$(a).html(reddit.status_msg.loading).css("color","red");a=$(a).parents(".thing.morechildren:first").thing_id();$.request("morechildren",{link_id:b,children:c,depth:g,id:a,pv_hex:i});return!1}
function moremessages(a){$(a).html(reddit.status_msg.loading).css("color","red");$.request("moremessages",{parent_id:$(a).thing_id()});return!1}function add_thing_to_cookie(a,b){var c=$(a).thing_id();if(c&&c.length)return add_thing_id_to_cookie(c,b)}function add_thing_id_to_cookie(a,b){var c=$.cookie_read(b);if(!c.data)c.data="";if(c.data.substring(0,a.length)!=a){c.data=a+","+c.data;var g=c.data.split(",");if(g.length>5)g=$.uniq(g,5),c.data=g.join(",");$.cookie_write(c)}}
function clicked_items(){var a=$.cookie_read("recentclicks2");if(a&&a.data){for(var a=a.data.split(","),b=a.length-1;b>=0;b--)(!a[b]||!a[b].length)&&a.splice(b,1);return a}else return[]}function clear_clicked_items(){var a=$.cookie_read("recentclicks2");a.data="";$.cookie_write(a);$(".gadget").remove()}
function updateEventHandlers(a){var a=$(a),b=a.parent();$(a).filter(".link").find("a.title, a.comments").mousedown(function(){$(this).addClass("click");add_thing_to_cookie(this,"recentclicks2")});b.filter(".organic-listing").length&&(a.find(".hide-button a, .del-button a.yes, .report-button a.yes").each(function(){$(this).get(0).onclick=null}),a.find(".hide-button a").click(function(){var a=$(this).get(0);change_state(a,"hide",function(){r.spotlight.next()})}),a.find(".del-button a.yes").click(function(){var a=
$(this).get(0);change_state(a,"del",function(){r.spotlight.next()})}),a.find(".report-button a.yes").click(function(){var a=$(this).get(0);change_state(a,"report",function(){r.spotlight.next()})}))}function last_click(){var a=r.analytics.breadcrumbs.lastClickFullname();a&&$("body").hasClass("listing-page")&&($(".last-clicked").removeClass("last-clicked"),$(".id-"+a).last().addClass("last-clicked"))}function login(){if(cnameframe)return!0;return post_user(this,"login")}
function register(){if(cnameframe)return!0;return post_user(this,"register")}function fetch_title(){var a=$("#url-field"),b=a.find(".NO_URL"),a=a.find(".title-status"),c=$("#url").val();if(c){if(!$('form#newlink textarea[name="title"]').val()||confirm("This will replace your existing title, proceed?"))a.show().text(reddit.status_msg.loading),b.hide(),$.request("fetch_title",{url:c})}else a.hide(),b.show().text("a url is required")}
function sr_cache(){if(!$.defined(reddit.sr_cache))reddit.sr_cache=[];return reddit.sr_cache}function highlight_reddit(a){$("#sr-drop-down").children(".sr-selected").removeClass("sr-selected");a&&$(a).addClass("sr-selected")}
function update_dropdown(a){var b=$("#sr-drop-down");if(a.length){var c=b.children(":first");c.removeClass("sr-selected");b.children().remove();$.each(a,function(g){if(!(g>10)){var g=a[g],j=c.clone();j.text(g);b.append(j)}});var g=$("#sr-autocomplete").outerHeight();b.css("top",g);b.show()}else b.hide()}function sr_search(a){var a=a.toLowerCase(),b=sr_cache();b[a]?update_dropdown(b[a]):$.request("search_reddit_names.json",{query:a},function(c){b[a]=c.names;update_dropdown(c.names)})}
function sr_name_up(a){var b=$("#sr-autocomplete").val(),c=window.old_sr_name||"";window.old_sr_name=b;if(b=="")hide_sr_name_list();else if(!(a.keyCode==38||a.keyCode==40||a.keyCode==9))if(a.keyCode==27&&reddit.orig_sr)$("#sr-autocomplete").val(reddit.orig_sr),hide_sr_name_list();else if(b!=c)reddit.orig_sr=b,sr_search($("#sr-autocomplete").val())}
function sr_name_down(a){var b=$("#sr-autocomplete");if(a.keyCode==38||a.keyCode==40){var a=a.keyCode==38&&"up"||"down",c=$("#sr-drop-down .sr-selected:first"),g=$("#sr-drop-down .sr-name-row:first"),i=$("#sr-drop-down .sr-name-row:last"),j=null,j=a=="down"?c.length?c.get(0)==i.get(0)?null:c.next(":first"):g:c.length?c.get(0)==g.get(0)?null:c.prev(":first"):i;highlight_reddit(j);j?b.val($.trim(j.text())):b.val(reddit.orig_sr);return!1}else if(a.keyCode==13)return $("#sr-autocomplete").trigger("sr-changed"),
hide_sr_name_list(),b.parents("form").submit(),!1}function hide_sr_name_list(){$("#sr-drop-down").hide()}function sr_dropdown_mdown(a){reddit.sr_mouse_row=a;return!1}function sr_dropdown_mup(a){reddit.sr_mouse_row==a&&(a=$(a).text(),$("#sr-autocomplete").val(a),$("#sr-drop-down").hide(),$("#sr-autocomplete").trigger("sr-changed"))}function set_sr_name(a){a=$(a).text();$("#sr-autocomplete").trigger("focus").val(a);$("#sr-autocomplete").trigger("sr-changed")}
function select_form_tab(a,b,c){a=$(a).parent();a.addClass("selected").siblings().removeClass("selected");a=a.parent("ul").next(".formtabs-content");a.find(b).show().find(":input").removeAttr("disabled").end();a.find(c).hide().find(":input").attr("disabled",!0)}function expando_cache(){if(!$.defined(reddit.thing_child_cache))reddit.thing_child_cache=[];return reddit.thing_child_cache}
function expando_child(a){var b=expando_cache(),c=$(a).thing();c.find(".expando-button").addClass("expanded").removeClass("collapsed").get(0).onclick=function(){unexpando_child(a)};var g=c.find(".expando"),i=c.thing_id()+"_cache";b[i]?(g.html($.unsafe(b[i])),$(document).trigger("expando_thing",c)):$.request("expando",{link_id:c.thing_id()},function(a){b[i]=a;g.html($.unsafe(a));$(document).trigger("expando_thing",c)},!1,"html");g.show();return!1}
function unexpando_child(a){var b=$(a).thing();b.find(".expando-button").addClass("collapsed").removeClass("expanded").get(0).onclick=function(){expando_child(a)};b.find(".expando").hide().empty()}
function show_edit_usertext(a){var b=a.find(".usertext-edit"),c=a.find(".usertext-body"),g=b.find("div > textarea"),i=Math.max(c.children(".md").width(),500),j=Math.max(c.children(".md").height(),100);c.hide();b.show();g.css("width","");g.css("height","");g.get(0).scrollHeight>g.height()&&(c=Math.max(i-5,g.width()),g.width(c),b.width(c),b=Math.max(j,g.height()),g.height(b));a.find(".cancel, .save").show().end().find(".help-toggle").show().end();g.focus()}
function hide_edit_usertext(a){a.find(".usertext-edit").hide().end().find(".usertext-body").show().end().find(".cancel, .save").hide().end().find(".help-toggle").hide().end().find(".markhelp").hide().end()}
function comment_reply_for_elem(a){var a=$(a),b=a.thing(),c=a.thing_id(),g=b.find(".child .usertext:first");if(!g.length||g.parent().thing_id()!=b.thing_id())g=$(".usertext.cloneable:first").clone(!0),a.new_thing_child(g),g.prop("thing_id").value=c,g.attr("id","commentreply_"+c),g.find(".error").hide();return g}function edit_usertext(a){a=$(a).thing();a.find(".edit-usertext:first").parent("li").andSelf().hide();show_edit_usertext(a.find(".usertext:first"))}
function cancel_usertext(a){a=$(a);a.thing().find(".edit-usertext:first").parent("li").andSelf().show();hide_edit_usertext(a.closest(".usertext"))}function save_usertext(a){$(a).thing().find(".edit-usertext:first").parent("li").andSelf().show()}function reply(a){var b=comment_reply_for_elem(a);show_edit_usertext(b);b.show();b.find(".cancel").get(0).onclick=function(){b.hide()};$(a).thing().find(".showreplies:visible").click();return!1}
function toggle_distinguish_span(a){a=$(a).parents("form")[0];$(a).children().toggle()}function set_distinguish(a,b){change_state(a,"distinguish/"+b);$(a).children().toggle()}function populate_click_gadget(){if($(".click-gadget").length){var a=clicked_items();a&&a.length&&(a=$.uniq(a,5),a.sort(),$.request("gadget/click/"+a.join(","),void 0,void 0,void 0,"json",!0))}}
var toolbar_p=function(a,b){this.toggle_linktitle=function(a){$(".title, .submit, .url, .linkicon").toggle();$(a).is(".pushed-button")?$(a).parents(".middle-side").removeClass("clickable"):($(a).parents(".middle-side").addClass("clickable"),$(".url").children("form").children("input").focus().select());return this.toggle_pushed(a)};this.toggle_pushed=function(a){a=$(a);a.is(".pushed-button")?a.removeClass("pushed-button").addClass("popped-button"):a.removeClass("popped-button").addClass("pushed-button");
return!1};this.push_button=function(a){$(a).removeClass("popped-button").addClass("pushed-button")};this.pop_button=function(a){$(a).removeClass("pushed-button").addClass("popped-button")};this.serendipity=function(){this.push_button(".serendipity");return!0};this.show_panel=function(){parent.inner_toolbar.document.body.cols=a};this.hide_panel=function(){parent.inner_toolbar.document.body.cols=b};this.resize_toolbar=function(){var a=$("body").height();parent.document.body.rows=a+"px, 100%"};this.login_msg=
function(){$(".toolbar-status-bar").show();$(".login-arrow").show();this.resize_toolbar();return!1};this.top_window=function(){for(var a=window;a!=a.parent;)a=a.parent;return a.parent};var c=null;this.panel_loadurl=function(a){try{return window.parent.inner_toolbar.reddit_panel.location==a?!1:(c!=null&&(this.pop_button(c),c=null),!0)}catch(b){return!0}};var g=0;this.comments_pushed=function(a){(g=!g)?(this.push_button(a),this.show_panel()):(this.pop_button(a),this.hide_panel())};this.gourl=function(a,
b){var c=$(a).find('input[type="text"]').val(),c=b+escape(c);this.top_window().location.href=c;return!1};this.pref_commentspanel_hide=function(){$.request("tb_commentspanel_hide")};this.pref_commentspanel_show=function(){$.request("tb_commentspanel_show")}};function clear_all_langs(a){$(a).parents("td").find('input[type="checkbox"]').prop("checked",!1)}function check_some_langs(a){$(a).parents("td").find("#some-langs").prop("checked",!0)}
function fetch_parent(a,b,c){$(a).css("color","red").html(reddit.status_msg.loading);var g=$(a).thing();if(g.find(".uncollapsed .parent").length==0){var i="";$.getJSON(b,function(b){$.each(b,function(){this&&this.data.children&&$.each(this.data.children,function(){if(this.data.name==c)i=this.data.body_html})});i&&g.find(".noncollapsed .md").first().before('<div class="parent rounded">'+$.unsafe(i)+"</div>");$(a).parent("li").andSelf().remove()})}return!1}
function big_mod_action(a,b){if(!a.hasClass("pressed"))a.addClass("pressed"),d={id:a.thing_id()},a.siblings(".status-msg").hide(),b==-1?(d.spam=!1,$.request("remove",d,null,!0),a.siblings(".removed").show()):b==-2?($.request("remove",d,null,!0),a.siblings(".spammed").show()):b==1&&($.request("approve",d,null,!0),a.siblings(".approved").show());a.siblings(".pretty-button").removeClass("pressed");return!1}
function big_mod_toggle(a,b,c){a.toggleClass("pressed");$.request(a.is(".pressed")?b:c,{id:a.thing_id()},null,!0);return!1}
$(function(){function a(){return toggle(this)}$("body").click(close_menus);$("body").set_thing_init(updateEventHandlers);"placeholder"in document.createElement("input")||$("textarea[placeholder], input[placeholder]").addClass("gray").each(function(){var a=$(this),c=a.attr("placeholder");a.val()==""&&a.val(c)});$("textarea.gray, input.gray").focus(function(){$(this).attr("rows",7).filter(".gray").removeClass("gray").val("")});reddit.logged&&$.cookie_name_prefix(reddit.logged);$.default_cookie_domain(reddit.cur_domain.split(":")[0]);
last_click();$(window).on("pageshow",function(){last_click()});$('#search input[name="q"]').focus(function(){$("#searchexpando").slideDown()});$("#search_showmore").click(function(a){$("#search_showmore").parent().hide();$("#moresearchinfo").slideDown();a.preventDefault()});$("#moresearchinfo").prepend('<a href="#" id="search_hidemore">[-]</a>');$("#search_hidemore").click(function(a){$("#search_showmore").parent().show();$("#moresearchinfo").slideUp();a.preventDefault()});$("#shortlink-text").click(function(){$(this).select()});
$("body").delegate(".ajax-yn-button","submit",function(){var a=$(this).find('input[name="_op"]').val();post_form(this,a);return!1}).delegate(".ajax-yn-button .togglebutton","click",a).delegate(".ajax-yn-button .no","click",a).delegate(".ajax-yn-button .yes","click",function(){$(this).closest("form").submit()})});
function show_friend(a){$("div.content .author.id-"+a).addClass("friend").next(".userattrs").each(function(){$(this).html()?$(this).find(".friend").length==0&&$(this).find("a:first").debug().before('<a class="friend" title="friend" href="/prefs/friends">F</a>,'):$(this).html(' [<a class="friend" title="friend" href="/prefs/friends">F</a>]')})}
function show_unfriend(a){$(".author.id-"+a).removeClass("friend").next(".userattrs").each(function(){$(this).find("a.friend").remove();$(this).find("a").length==0&&$(this).html("")})}
function show_saved(a){var a=$(".id-"+a),b=a.find(".buttons").first().find(".comment-save-button");form='<li class="comment-unsave-button"><form action="/post/unsave" method="post" class="state-button unsave-button">';form+='<input type="hidden" name="executed" value="unsaved"/><span>';form+='<a href="javascript:void(0)" onclick="return change_state(this, \'unsave\', unsave_thing);">unsave</a></span></form></li>';b.replaceWith(form);a.addClass("saved")}
function search_feedback(a,b){f=$("form#search");var c=f.find('input[name="q"]').val(),g=f.find('input[name="sort"]').val(),i=f.find('input[name="t"]').val();$.request("searchfeedback",{q:c,sort:g,t:i,approval:b},null,!0);a.siblings(".pretty-button").removeClass("pressed");a.siblings(".thanks").show();a.addClass("pressed");return!1}function highlight_new_comments(a){var b;for(b=0;b<=9;b++)items=$(".comment-period-"+b),a>=0&&b>=a?items.addClass("new-comment"):items.removeClass("new-comment")}
function save_href(a){a.attr("srcurl")||a.attr("srcurl",a.attr("href"));return a}function pure_domain(a){(a=a.match(/:\/\/([^/]+)/))&&(a=a[1].replace(/^www\./,""));return a}function parse_domain(a){var b=pure_domain(a);b||(a=a.match(/\/r\/([^/]+)/))&&(b="self."+a[1].toLowerCase());return b}r.spotlight={};
r.spotlight.init=function(){var a=$(".organic-listing");if(a.length){$(".organic-listing .arrow.prev").on("click",$.proxy(this,"prev"));$(".organic-listing .arrow.next").on("click",$.proxy(this,"next"));var b,c=r.analytics.breadcrumbs.lastClickFullname(),g=$(c?".id-"+c:null);g.length&&a.has(g).length?(r.debug("restoring spotlight selection to last click"),b={fullname:c}):b=this.chooseRandom();this.lineup=_.chain(this.lineup).reject(function(a){return _.isEqual(b,a)}).shuffle().unshift(b).value();
this.lineup.pos=0;r.spotlight._advance(0)}};r.spotlight.setup=function(a,b,c){this.link_by_camp={};this.weights={};this.organics=[];this.lineup=[];for(var g in a){var i=a[g][0],j=a[g][2],e=a[g][3];a[g][1]?(this.link_by_camp[j]=i,this.weights[j]=e,this.lineup.push({fullname:i,campaign:j})):(this.organics.push(i),this.lineup.push({fullname:i}))}this.lineup.push(".interestbar");this.interest_prob=b;this.promotion_prob=c;this.init()};
r.spotlight.chooseRandom=function(){$(".organic-listing");if(!_.isEmpty(this.weights)&&Math.random()<this.promotion_prob){var a=this.weighted_lottery(this.weights);return{fullname:this.link_by_camp[a],campaign:a}}else return Math.random()<this.interest_prob?".interestbar":{fullname:this.organics[Math.floor(Math.random()*this.organics.length)]}};
r.spotlight._materialize=function(a){if(!a||a instanceof $||a.promise)return a;var b=$(".organic-listing"),c;_.isString(a)?c=a:(c='[data-fullname="'+a.fullname+'"]',a.campaign&&(c+='[data-cid="'+a.campaign+'"]'));var g=b.find(c);if(g.length)return g;else if(a.campaign)return r.debug("fetching promo %s from campaign %s",a.fullname,a.campaign),$.get("/api/fetch_promo",{link:a.fullname,campaign:a.campaign}).pipe(function(a){g=$(a);g.hide().appendTo(b);return g});else r.error("unable to locate spotlight item",
c,a)};r.spotlight._advancePos=function(a){return(this.lineup.pos+a+this.lineup.length)%this.lineup.length};r.spotlight._materializePos=function(a){return this.lineup[a]=this._materialize(this.lineup[a])};
r.spotlight._advance=function(a){var b=$(".organic-listing"),c=b.find(".nextprev"),g=b.find(".thing:visible"),i=this._advancePos(a),j=this._materializePos(i),e=setTimeout(function(){c.toggleClass("working",j.state&&j.state()=="pending")},200);this.lineup.pos=i;$.when(j).done(_.bind(function(a){clearTimeout(e);this.lineup.pos==i&&(c.removeClass("working"),b.removeClass("loading"),a.find(".rank").width($("#siteTable .rank").width()).end(),g.hide(),a.show(),this.help(a),this.lineup.pos!=0&&(this._materializePos(this._advancePos(1)),
this._materializePos(this._advancePos(-1))))},this))};r.spotlight.next=$.proxy(r.spotlight,"_advance",1);r.spotlight.prev=$.proxy(r.spotlight,"_advance",-1);r.spotlight.help=function(a){var b=$("#spotlight-help");b.length&&$(function(){b.data("HelpBubble").hide(function(){b.find(".help-section").hide();a.hasClass("promoted")?b.find(".help-promoted").show():a.hasClass("interestbar")?b.find(".help-interestbar").show():b.find(".help-organic").show()})})};
r.spotlight.weighted_lottery=function(a){var b=Math.random(),c=0,g;for(g in a)if(weight=a[g],c+=weight,c>b)return g;r.warn("weighted_lottery fell through!")};

jQuery.cookie=function(a,b,c){if(arguments.length>1&&String(b)!=="[object Object]"){c=jQuery.extend({},c);if(b===null||b===void 0)c.expires=-1;if(typeof c.expires==="number"){var d=c.expires,e=c.expires=new Date;e.setDate(e.getDate()+d)}b=String(b);return document.cookie=[encodeURIComponent(a),"=",c.raw?b:encodeURIComponent(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};e=c.raw?function(a){return a}:
decodeURIComponent;return(d=RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?e(d[1]):null};
(function(a,b){function c(a,b){for(var c=decodeURI(a),c=h[b?"strict":"loose"].exec(c),d={attr:{},param:{},seg:{}},e=14;e--;)d.attr[f[e]]=c[e]||"";d.param.query={};d.param.fragment={};d.attr.query.replace(k,function(a,b,c){b&&(d.param.query[b]=c)});d.attr.fragment.replace(j,function(a,b,c){b&&(d.param.fragment[b]=c)});d.seg.path=d.attr.path.replace(/^\/+|\/+$/g,"").split("/");d.seg.fragment=d.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");d.attr.base=d.attr.host?d.attr.protocol+"://"+d.attr.host+
(d.attr.port?":"+d.attr.port:""):"";return d}function d(a){a=a.tagName;if(a!==b)return e[a.toLowerCase()];return a}var e={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},f=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],g={anchor:"fragment"},h={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},k=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g,j=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g;a.fn.url=function(b){var c="";this.length&&(c=a(this).attr(d(this[0]))||"");return a.url(c,b)};a.url=function(a,d){arguments.length===1&&a===!0&&(d=!0,a=b);a=a||window.location.toString();return{data:c(a,d||!1),attr:function(a){a=g[a]||
a;return a!==b?this.data.attr[a]:this.data.attr},param:function(a){return a!==b?this.data.param.query[a]:this.data.param.query},fparam:function(a){return a!==b?this.data.param.fragment[a]:this.data.param.fragment},segment:function(a){return a===b?this.data.seg.path:(a=a<0?this.data.seg.path.length+a:a-1,this.data.seg.path[a])},fsegment:function(a){return a===b?this.data.seg.fragment:(a=a<0?this.data.seg.fragment.length+a:a-1,this.data.seg.fragment[a])}}}})(jQuery);
r.utils={staticURL:function(a){return r.config.static_root+"/"+a},querySelectorFromEl:function(a,b){return $(a).parents().andSelf().filter(b||"*").map(function(a,b){var e=[],f=$(b),g=f.data("fullname"),h=f.attr("id"),f=f.attr("class");e.push(b.nodeName.toLowerCase());g?e.push('[data-fullname="'+g+'"]'):h?e.push("#"+h):f&&e.push("."+_.compact(f.split(/\s+/)).join("."));return e.join("")}).toArray().join(" ")},serializeForm:function(a){var b={};$.each(a.serializeArray(),function(a,d){b[d.name]=d.value});
return b},_pyStrFormatRe:/%\((\w+)\)s/,pyStrFormat:function(a,b){return a.replace(this._pyStrFormatRe,function(a,d){if(!(d in b))throw"missing format parameter";return b[d]})},_mdLinkRe:/\[(.*?)\]\((.*?)\)/g,formatMarkdownLinks:function(a){return _.escape(a).replace(this._mdLinkRe,function(a,c,d){return'<a href="'+d+'">'+c+"</a>"})}};r.strings=function(a,b){var c=r.strings.index[a];return b?r.utils.pyStrFormat(c,b):c};r.strings.index={};
r.strings.set=function(a){_.extend(r.strings.index,a);this.permissions=this.index.permissions};
r.ui.init=function(){$.cookie("reddit_first")?($.cookie("reddit_first",null,{domain:r.config.cur_domain}),store.set("ui.shown.welcome",!0)):store.get("ui.shown.welcome")!=!0&&($(".infobar.welcome").show(),store.set("ui.shown.welcome",!0));var a=window.matchMedia?matchMedia("(max-device-width: 700px)").matches:$(window).width()<700,b=$.url().attr("path")=="/";a&&b&&r.config.renderstyle!="compact"&&(a=$('<div class="infobar mellow">').html(r.utils.formatMarkdownLinks(r.strings("compact_suggest",{url:location+
".compact"}))),$("body > .content > :not(.infobar):first").before(a));r.ui.HelpBubble.init();r.ui.PermissionEditor.init()};r.ui.Form=function(a){r.ui.Base.call(this,a);this.$el.submit($.proxy(function(a){a.preventDefault();this.submit(a)},this))};
r.ui.Form.prototype=$.extend(new r.ui.Base,{workingDelay:200,setWorking:function(a){if(a){if(!this.$el.hasClass("working")&&!this._workingTimer)this._workingTimer=setTimeout($.proxy(function(){this.$el.addClass("working")},this),this.workingDelay)}else this._workingTimer&&(clearTimeout(this._workingTimer),delete this._workingTimer),this.$el.removeClass("working")},showStatus:function(a,b){this.$el.find(".status").show().toggleClass("error",!!b).text(a)},showErrors:function(a){statusMsgs=[];$.each(a,
$.proxy(function(a,c){var d=c[1],e=c[2],e=this.$el.find(".error."+c[0]+(e?".field-"+e:""));e.length?e.show().text(d):statusMsgs.push(d)},this));statusMsgs.length&&this.showStatus(statusMsgs.join(", "),!0)},resetErrors:function(){this.$el.find(".error").hide()},checkCaptcha:function(a){this.$el.has('input[name="captcha"]').length&&$.grep(a,function(a){return a[0]=="badCaptcha"})&&$.request("new_captcha",{id:this.$el.attr("id")})},serialize:function(){return this.$el.serializeArray()},submit:function(){this.resetErrors();
this.setWorking(!0);this._submit()},_submit:function(){},handleResult:function(a,b,c){a?(this.checkCaptcha(a.json.errors),this._handleResult(a)):(this.setWorking(!1),this._handleNetError(a,b,c))},_handleResult:function(a){this.showErrors(a.json.errors);this.setWorking(!1)},_handleNetError:function(a,b,c){this.showStatus(r.strings("an_error_occurred",{status:c.status}),!0)}});
r.ui.HelpBubble=function(a){r.ui.Base.call(this,a);this.$el.hover($.proxy(this,"queueShow"),$.proxy(this,"queueHide"));this.$parent=this.$el.parent();this.$parent.hover($.proxy(this,"queueShow"),$.proxy(this,"queueHide"));this.$parent.click($.proxy(this,"queueShow"))};r.ui.HelpBubble.init=function(){$(".help-bubble").each(function(a,b){$(b).data("HelpBubble",new r.ui.HelpBubble(b))})};
r.ui.HelpBubble.prototype=$.extend(new r.ui.Base,{showDelay:150,hideDelay:750,show:function(){this.cancelTimeout();$("body").append(this.$el);var a=this.$parent.offset();this.$el.show().offset({left:a.left+this.$parent.outerWidth(!0)-this.$el.outerWidth(!0),top:a.top+this.$parent.outerHeight(!0)+5})},hide:function(a){this.$el.fadeOut(150,$.proxy(function(){this.$el.hide();this.$parent.append(this.$el);a&&a()},this))},cancelTimeout:function(){if(this.timeout)clearTimeout(this.timeout),this.timeout=
null},queueShow:function(){this.cancelTimeout();this.timeout=setTimeout($.proxy(this,"show"),this.showDelay)},queueHide:function(){this.cancelTimeout();this.timeout=setTimeout($.proxy(this,"hide"),this.hideDelay)}});
r.ui.PermissionEditor=function(a){r.ui.Base.call(this,a);var b={};this.$el.find('input[type="hidden"]').each(function(a,d){b[d.name]=d.value});a=b.type;this.form_id=a+"-permissions-"+b.name;this.permission_info=r.strings.permissions.info[a];this.sorted_perm_keys=$.map(this.permission_info,function(a,b){return b});this.sorted_perm_keys.sort();this.original_perms=this._parsePerms(b.permissions);this.embedded=this.$el.find("form").length==0;this.$menu=null;this.embedded?(this.$permissions_field=this.$el.find('input[name="permissions"]'),
this.$menu_controller=this.$el.siblings(".permissions-edit")):this.$menu_controller=this.$el.closest("tr").find(".permissions-edit");this.$menu_controller.find("a").click($.proxy(this,"show"));this.updateSummary()};r.ui.PermissionEditor.init=function(){function a(a){$(a).find(".permissions").each(function(a,b){$(b).data("PermissionEditor",new r.ui.PermissionEditor(b))})}a("body");for(var b in r.strings.permissions.info)$("."+b+"-table").on("insert-row","tr",function(){a(this)})};
r.ui.PermissionEditor.prototype=$.extend(new r.ui.Base,{_parsePerms:function(a){var b={};a.split(",").forEach(function(a){b[a.substring(1)]=a[0]=="+"});return b.all?{all:!0}:b},_serializePerms:function(a){if(a.all)return"+all";else{var b=[],c;for(c in a)b.push((a[c]?"+":"-")+c);return b.join(",")}},_getNewPerms:function(){if(!this.$menu)return null;var a={};this.$menu.find('input[type="checkbox"]').each(function(b,c){a[$(c).attr("name")]=$(c).prop("checked")});return a},_makeMenuLabel:function(a){var b=
$.proxy(this,"updateSummary"),c=this.permission_info[a],d=$('<input type="checkbox">').attr("name",a).prop("checked",this.original_perms[a]),e=$("<label>").append(d).click(function(a){a.stopPropagation()});a=="all"?(d.change(function(){var a=d.is(":checked");e.siblings().toggleClass("disabled",a).find('input[type="checkbox"]').prop("disabled",a);b()}),e.append(document.createTextNode(r.strings.permissions.all_msg))):c&&(d.change(b),e.append(document.createTextNode(c.title)),e.attr("title",c.description));
return e},show:function(a){close_menus(a);this.$menu=$('<div class="permission-selector drop-choices">');this.$menu.append(this._makeMenuLabel("all"));for(var b in this.sorted_perm_keys)this.$menu.append(this._makeMenuLabel(this.sorted_perm_keys[b]));this.$menu.on("close_menu",$.proxy(this,"hide")).find("input").first().change().end();if(!this.embedded)a=this.$el.find("form").clone(),a.attr("id",this.form_id),a.click(function(a){a.stopPropagation()}),this.$menu.append("<hr>",a),this.$permissions_field=
this.$menu.find('input[name="permissions"]');this.$menu_controller.parent().append(this.$menu);open_menu(this.$menu_controller[0]);return!1},hide:function(){if(this.$menu){if(this.embedded)this.original_perms=this._getNewPerms(),this.$permissions_field.val(this._serializePerms(this.original_perms));this.$menu.remove();this.$menu=null;this.updateSummary()}},_renderBit:function(a){var b=this.permission_info[a],a=a=="all"?r.strings.permissions.all_msg:b?b.title:a,a=$('<span class="permission-bit"/>').text(a);
b&&a.attr("title",b.description);return a},updateSummary:function(){var a=this._getNewPerms(),b=[];if(a&&a.all)b.push(this._renderBit("all").toggleClass("added",this.original_perms.all!=!0));else{if(this.original_perms.all&&!a)b.push(this._renderBit("all"));else if(!this.original_perms.all)for(var c in this.original_perms)this.original_perms[c]&&(this.embedded&&(!a||a[c])&&b.push(this._renderBit(c)),this.embedded||b.push(this._renderBit(c).toggleClass("removed",a!=null&&!a[c])));if(a)for(c in a)this.permission_info[c]&&
a[c]&&!this.original_perms[c]&&b.push(this._renderBit(c).toggleClass("added",!this.embedded))}b.length||b.push($('<span class="permission-bit">').text(r.strings.permissions.none_msg).addClass("none"));c=$('<div class="permission-summary">');for(var d=0;d<b.length;d++)d>0&&c.append(", "),c.append(b[d]);c.toggleClass("edited",this.$menu!=null);this.$el.find(".permission-summary").replaceWith(c);a&&this.$permissions_field&&this.$permissions_field.val(this._serializePerms(a))},onCommit:function(a){this.$el.find('input[name="permissions"]').val(a);
this.original_perms=this._parsePerms(a);this.hide()}});
r.login={post:function(a,b,c){if(r.config.cnameframe&&!r.config.https_endpoint)a.$el.unbind(),a.$el.submit();else{var d=$('input[name="user"]',a.$el).val(),e=r.config.https_endpoint||"http://"+r.config.ajax_domain,d=e+"/api/"+b+"/"+d;if(r.config.currentOrigin==e||$.support.cors)b=a.serialize(),b.push({name:"api_type",value:"json"}),$.ajax({url:d,type:"POST",dataType:"json",data:b,success:c,error:function(a,b){c(!1,b,a)},xhrFields:{withCredentials:!0}});else{var f=$("<iframe>"),g=a.$el.clone(!0),a=
("resp"+Math.random()).replace(".","");f.css("display","none").attr("name",a).appendTo("body");f[0].contentWindow.name=a;g.unbind().css("display","none").attr("action",d).attr("target",a).appendTo("body");$("<input>").attr({type:"hidden",name:"api_type",value:"json"}).appendTo(g);$("<input>").attr({type:"hidden",name:"hoist",value:r.login.hoist.type}).appendTo(g);r.login.hoist.watch(b,function(a){r.config.debug||(f.remove(),g.remove());c(a)});g.submit()}}}};
r.login.hoist={type:"cookie",watch:function(a,b){var c="hoist_"+a,d=setInterval(function(){if(data=$.cookie(c)){try{data=JSON.parse(data)}catch(a){data=null}$.cookie(c,null,{domain:r.config.cur_domain,path:"/"});clearInterval(d);b(data)}},100)}};
r.login.ui={init:function(){if(!r.config.logged)$(".content form.login-form, .side form.login-form").each(function(a,b){new r.ui.LoginForm(b)}),$(".content form.register-form").each(function(a,b){new r.ui.RegisterForm(b)}),this.popup=new r.ui.LoginPopup($(".login-popup")[0]),$(document).delegate(".login-required","click",$.proxy(this,"loginRequiredAction"))},loginRequiredAction:function(a){if(r.config.logged)return!0;else{var a=$(a.target),b=a.attr("href"),c;b&&b!="#"?c=b:(a=a.thing(),a.length&&(c=
a.find(".comments").attr("href")));this.popup.showLogin(!0,c&&function(){window.location=c});return!1}}};r.ui.LoginForm=function(){r.ui.Form.apply(this,arguments)};
r.ui.LoginForm.prototype=$.extend(new r.ui.Form,{showErrors:function(a){r.ui.Form.prototype.showErrors.call(this,a);a.length&&this.$el.find(".recover-password").addClass("attention")},showStatus:function(){this.$el.find(".error").css("opacity",1);r.ui.Form.prototype.showStatus.apply(this,arguments)},resetErrors:function(){if(this.$el.hasClass("login-form-side")){var a=this.$el.find(".error");a.is(":visible")&&a.fadeTo(100,0.35)}else r.ui.Form.prototype.resetErrors.apply(this,arguments)},_submit:function(){r.login.post(this,
"login",$.proxy(this,"handleResult"))},_handleResult:function(a){if(a.json.errors.length)r.ui.Form.prototype._handleResult.call(this,a);else if(this.successCallback)this.successCallback(a);else{var a=r.config.extension?"/."+r.config.extension:"/",a=/\/login\/?$/.test($.url().attr("path"))?a:window.location,b=this.$el.find('input[name="dest"]').val();window.location=b||a}},_handleNetError:function(a,b,c){r.ui.Form.prototype._handleNetError.apply(this,arguments);c.status==0&&r.config.currentOrigin!=
r.config.https_endpoint&&$("<p>").append($("<a>").text(r.strings("login_fallback_msg")).attr("href",r.config.https_endpoint+"/login")).appendTo(this.$el.find(".status"))},focus:function(){this.$el.find('input[name="user"]').focus()}});r.ui.RegisterForm=function(){r.ui.Form.apply(this,arguments);this.checkUsernameDebounced=_.debounce($.proxy(this,"checkUsername"),500);this.$user=this.$el.find('[name="user"]');this.$user.on("keyup",$.proxy(this,"usernameChanged"));this.$submit=this.$el.find(".submit button")};
r.ui.RegisterForm.prototype=$.extend(new r.ui.Form,{usernameChanged:function(){var a=this.$user.val();if(a!=this._priorName)this._priorName=a,this.$el.find(".error.field-user").hide(),this.$submit.attr("disabled",!1),this.$el.removeClass("name-available name-taken"),this.checkUsernameDebounced(a),this.$el.toggleClass("name-checking",!!a)},checkUsername:function(a){a&&$.ajax({url:"/api/username_available.json",data:{user:a},success:$.proxy(this,"displayUsernameStatus"),complete:$.proxy(function(){this.$el.removeClass("name-checking")},
this)})},displayUsernameStatus:function(a){a.json&&a.json.errors?(this.showErrors(a.json.errors),this.$submit.attr("disabled",!0)):(this.$el.removeClass("name-available name-taken").addClass(a?"name-available":"name-taken"),this.$submit.attr("disabled",a==!1))},_submit:function(){r.login.post(this,"register",$.proxy(this,"handleResult"))},_handleResult:r.ui.LoginForm.prototype._handleResult,focus:r.ui.LoginForm.prototype.focus});
r.ui.LoginPopup=function(a){r.ui.Base.call(this,a);this.loginForm=new r.ui.LoginForm(this.$el.find("form.login-form:first"));this.registerForm=new r.ui.RegisterForm(this.$el.find("form.register-form:first"))};
r.ui.LoginPopup.prototype=$.extend(new r.ui.Base,{show:function(a,b){this.loginForm.successCallback=b;this.registerForm.successCallback=b;$.request("new_captcha",{id:this.$el.attr("id")});this.$el.find(".cover-msg").toggle(!!a).end().show()},showLogin:function(){this.show.apply(this,arguments);this.loginForm.focus()},showRegister:function(){this.show.apply(this,arguments);this.registerForm.focus()}});
$(function(){function a(a){$(a).parent().parent().addClass("edited");$(a).parent().parent().find(".status").empty()}function b(){$(this).data("saved")!=$(this).val()&&a(this)}function c(a){return function(){return post_form(this.parentNode,a)}}function d(a){return function(){$(this).removeClass("edited");return post_form(this,a)}}function e(){$(".flairselector li").removeClass("selected");$(this).addClass("selected");var a=$(this).parent().parent().siblings("form")[0];$(a).children('input[name="flair_template_id"]').val(this.id);
var a=$(a).children(".customizer"),b=a.children("input");$(this).hasClass("texteditable")?(a.addClass("texteditable"),b.removeAttr("disabled"),b.css("display","block"),b.val($.trim($(this).children(".flair").text())).select(),b.keyup(function(){$(".flairselection .flair").text($(b).val())})):(a.removeClass("texteditable"),b.attr("disabled","disabled").hide());a=$(".flairselector .flairremove").detach();$(".flairselection").html($(this).first().children().clone()).append(a);$(".flairselector .flairremove").css("display",
"inline-block");return!1}function f(){var a=$(this).parent().parent();$(a).children('input[name="flair_template_id"]').val("");$(a).children(".customizer").hide();a=$(".flairselector .flairremove").detach();$(a).hide();$(".flairselector li").removeClass("selected");$(".flairselection").empty().append(a)}function g(){$(this).parent().parent().siblings("input").val(this.id);post_form(this.parentNode.parentNode.parentNode,"selectflair");return!1}$(".flairlist").delegate(".flairtemplate form","submit",
d("flairtemplate")).delegate("form.clearflairtemplates","submit",d("clearflairtemplates")).delegate(".flairgrant .usertable form","submit",d("flair")).delegate(".flaircell input","focus",function(){a(this)}).delegate(".flaircell input","keyup",b).delegate(".flaircell input","change",b).delegate(".flairtemplate .flairdeletebtn","click",c("deleteflairtemplate")).delegate(".flairgrant .flairdeletebtn","click",c("deleteflair"));$(".flairtoggle").submit(function(){return post_form(this,"setflairenabled")});
$(".flairtoggle input").change(function(){$(this).parent().submit()});$(document).on("click",".tagline .flairselectbtn, .thing .flairselectbtn",function(a){function b(a){var c=$(a).children().length,d=Math.max(1,Math.min(3,Math.ceil(c/10))),e=Math.ceil(c/d),f=Math.max(150,$(a).width());$(a).width(f);if(d>1){$(a).css("float","left");for(var g=d*e-c,h=1;h<d;h++){var j=e;h<=g&&j--;var k=c-j;c-=j;j=$(a).children().slice(k).remove();$(j).width(f);$(a).after($("<ul>").css("float","left").append(j))}}return d*
(f+5)+50}close_menus(a);var c=this,d=$(c).siblings(".flairselector")[0];$(d).html('<img class="flairthrobber" src="'+r.utils.staticURL("throbber.gif")+'" />').addClass("active").height(18).width(18).css("padding-left",4).css("padding-top",4).css("padding-bottom",4).css("padding-right",4).css("left",$(c).position().left+$(c).width()-18+"px").css("top",$(c).position().top+"px");var l={};$(d).siblings("form").find("input").each(function(a,b){l[b.name]=b.value});$.request("flairselector",l,function(a){$(d).html(a);
var a=$(".flairselector ul"),a=Math.max(200,a.length?b(a):$(".error").width()+20),h=Math.max(100,$(c).position().left+$(c).width()-a);$(d).height("auto").width(a).css("left",h+"px").click(!1).find(".flairselection").click(!1).end().find("form").click(function(a){a.stopPropagation()}).submit(g).end().find(".customizer input").attr("disabled","disabled").end().find("li.selected").each(e).end().find("li:not(.error)").click(e).end().find(".flairremove").click(f).end()},!0,"html");return!1});$(".flairselector .dropdown").click(function(){open_menu(this);
$(this).addClass("active");return!1})});r.interestbar={init:function(){new r.ui.InterestBar($(".sr-interest-bar"))}};r.ui.InterestBar=function(){r.ui.Base.apply(this,arguments);this.$query=this.$el.find(".query");this.queryChangedDebounced=_.debounce($.proxy(this,"queryChanged"),500);this.$query.on("keyup",$.proxy(this,"keyPressed"));this.$query.on("focus",$.proxy(function(){this.$el.addClass("focus")},this)).on("blur",$.proxy(function(){this.$el.removeClass("focus")},this))};
r.ui.InterestBar.prototype={keyPressed:function(){var a=this.$query.val(),a=$.trim(a);if(a!=this._lastQuery)this._lastQuery=a,this.queryChangedDebounced(a),a&&a.length>1?this.$el.addClass("working"):(this.hideResults(),this.$el.removeClass("working error"))},queryChanged:function(a){a&&a.length>1&&$.ajax({url:"/api/subreddits_by_topic.json",data:{query:a},success:$.proxy(this,"displayResults"),error:$.proxy(this,"displayError")})},displayResults:function(a){this.$el.removeClass("working error");var b=
this.$el.find(".results li:first"),c=this.$el.find(".results li:last"),d=_.template('<li><a href="/r/<%= name %>" target="_blank">/r/<%= name %></a></li>');this.$el.find(".results").empty().append(b).append(_.map(a,d).join("")).append(c).slideDown(150)},hideResults:function(){this.$el.find(".results").slideUp(150)},displayError:function(a){this.$el.removeClass("working").addClass("error").find(".error-caption").text(r.strings("an_error_occurred_friendly",{status:a.status}));this.hideResults()}};
r.wiki={request:function(a){if(r.config.logged)a.data.uh=r.config.modhash;a.data.page=r.config.wiki_page;$.ajax(a)},baseApiUrl:function(){return r.wiki.baseUrl(!0)},baseUrl:function(a){var b="";a&&(b+="/api");b+="/wiki";r.config.is_fake||(b="/r/"+r.config.post_site+b);return b},init:function(){$("body").delegate(".wiki-page .revision_hide","click",this.toggleHide)},toggleHide:function(a){a.preventDefault();var a=$(this),b=r.wiki.baseApiUrl()+"/hide",c=a.parents(".revision");c.toggleClass("hidden");
r.wiki.request({url:b,type:"POST",dataType:"json",data:{revision:a.data("revision")},error:function(){c.toggleClass("hidden")},success:function(a){a.status?c.addClass("hidden"):c.removeClass("hidden")}})},addUser:function(a){a.preventDefault();$("#usereditallowerror").hide();var a=$(a.target),b=r.wiki.baseApiUrl()+"/alloweditor/add";r.wiki.request({url:b,type:"POST",data:{username:a.find('[name="username"]').val()},dataType:"json",error:function(){$("#usereditallowerror").show()},success:function(){location.reload()}})},
submitEdit:function(a){a.preventDefault();var b=$(a.target),a=r.wiki.baseApiUrl()+"/edit",c=$("#wiki_edit_conflict"),d=$("#wiki_special_error");c.hide();d.hide();params=r.utils.serializeForm(b);r.wiki.request({url:a,type:"POST",dataType:"json",data:params,success:function(){window.location=r.wiki.baseUrl()+"/"+r.config.wiki_page},statusCode:{409:function(a){var a=JSON.parse(a.responseText),d=b.children("#wiki_page_content");c.children("#youredit").val(d.val());c.children("#yourdiff").html(a.diffcontent);
b.children("#previous").val(a.newrevision);d.val(a.newcontent);c.fadeIn("slow")},415:function(a){var a=JSON.parse(a.responseText).special_errors,b=d.children("#specials");b.empty();for(i in a)b.append(a[i]+"<br/>");d.fadeIn("slow")},429:function(a){var a=JSON.parse(a.responseText).message,b=d.children("#specials");b.empty();b.text(a);d.fadeIn("slow")}}})},goCompare:function(){v1=$("input:radio[name=v1]:checked").val();v2=$("input:radio[name=v2]:checked").val();url=r.wiki.baseUrl()+"/"+r.config.wiki_page+
"?v="+v1;v2!=v1&&(url+="&v2="+v2);window.location=url}};
r.apps={init:function(){$(".authorized-app").delegate(".app-permissions li","mouseover mouseout",function(a){a.type=="mouseover"?$(this).find(".app-scope").show():$(this).find(".app-scope").hide()});$("#developed-apps").delegate(".edit-app-button","click",function(){$(this).toggleClass("collapsed").closest(".developed-app").removeClass("collapsed").find(".app-developers").remove().end().find(".edit-app").slideToggle().removeClass("collapsed").end()}).delegate(".edit-app-icon-button","click",function(){$(this).toggleClass("collapsed").closest(".developed-app").find(".ajax-upload-form").show()});
$("#create-app-button").click(function(){$(this).hide();$("#create-app").fadeIn()})},revoked:function(a){$(a).closest(".authorized-app").fadeOut()},deleted:function(a){$(a).closest(".developed-app").fadeOut()}};
r.gold={_googleCheckoutAnalyticsLoaded:!1,init:function(){$("div.content").on("click","a.give-gold, .gilded-comment-icon, .gold-payment .close-button",$.proxy(this,"_toggleCommentGoldForm"));$(".stripe-gold").click(function(){$("#stripe-payment").show()});$(".stripe-submit").on("click",this.makeStripeToken)},_toggleCommentGoldForm:function(a){var a=$(a.target),b=a.thing(),c=a.thing_id(),d="gold_form_"+c,e=$("#"+d);if(b.hasClass("user-gilded")||b.hasClass("deleted")||b.find(".author:first").text()==
r.config.logged)return!1;if(e.length)return e.toggle(),!1;if(!this._googleCheckoutAnalyticsLoaded)$.getScript("//checkout.google.com/files/digital/ga_post.js"),this._googleCheckoutAnalyticsLoaded=!0;var f=$(".gold-form.cloneable:first").clone(),b=a.thing().find(".entry .author:first").text();r.strings("gold_summary_comment_gift",{recipient:b});var g=f.find(".passthrough"),h=f.find('[name="cbbaseurl"]').val();f.removeClass("cloneable").attr("id",d).find("p:first-child em").text(b).end().find("button").attr("disabled",
"");g.val("");a.new_thing_child(f);f.show();var k=setTimeout(function(){f.addClass("working");f.find("button").addClass("disabled")},200);$.request("generate_payment_blob.json",{comment:c},function(a){clearTimeout(k);f.removeClass("working");g.val(a);f.find(".stripe-gold").on("click",function(){window.open("/gold/creditgild/"+a)});f.find(".coinbase-gold").on("click",function(){window.open(h+"?c="+a)});f.find("button").removeAttr("disabled").removeClass("disabled")});return!1},gildComment:function(a,
b,c){var d=$(".id-"+a);if(d.length){var a=d.children(".entry").find("p.tagline"),e=a.find(".gilded-comment-icon");c==null&&(c=e.data("count")||0,c++);d.addClass("gilded user-gilded");e.length||(e=$("<span>").addClass("gilded-comment-icon"),a.append(e));e.attr("title",b).data("count",c);c>1&&e.text("x"+c);d.children(".entry").find(".give-gold").parent().remove()}else console.log("couldn't gild comment "+a)},makeStripeToken:function(){var a=$("#stripe-payment"),b=a.find('[name="stripePublicKey"]').val(),
c=a.find(".stripe-submit"),d=a.find(".status"),e=a.find('[name="stripeToken"]'),f=a.find(".card-name").val(),g=a.find(".card-number").val(),h=a.find(".card-cvc").val(),k=a.find(".card-expiry-month").val(),j=a.find(".card-expiry-year").val(),m=a.find(".card-address_line1").val(),l=a.find(".card-address_line2").val(),n=a.find(".card-address_city").val(),o=a.find(".card-address_state").val(),p=a.find(".card-address_country").val(),q=a.find(".card-address_zip").val(),s=function(b,d){d.error?(c.removeAttr("disabled"),
b.html(d.error.message)):(e.val(d.id),post_form(a,"stripecharge/gold"))};Stripe.setPublishableKey(b);f?Stripe.validateCardNumber(g)?Stripe.validateExpiry(k,j)?Stripe.validateCVC(h)?m?n?o?p?q?(d.text(""),c.attr("disabled","disabled"),Stripe.createToken({name:f,number:g,cvc:h,exp_month:k,exp_year:j,address_line1:m,address_line2:l,address_city:n,address_state:o,address_country:p,address_zip:q},s)):d.text(r.strings("missing_credit_zip")):d.text(r.strings("missing_credit_country")):d.text(r.strings("missing_credit_state")):
d.text(r.strings("missing_credit_city")):d.text(r.strings("missing_credit_address")):d.text(r.strings("bad_credit_cvc")):d.text(r.strings("bad_credit_expiry")):d.text(r.strings("bad_credit_number")):d.text(r.strings("missing_credit_name"));return!1}};(function(a){a.gild_comment=function(b,c){r.gold.gildComment(b,c);a("#gold_form_"+b).fadeOut(400)}})(jQuery);
r.adzerk={origin:location.protocol=="https:"?"https://az.turbobytes.net":"http://static.adzerk.net",createSponsorshipAdFrame:function(){var a=$("<iframe>").attr({id:"ad_sponsorship",src:r.adzerk.origin+"/reddit/ads-load.html",frameBorder:0,scrolling:"no"});$(".side .sponsorshipbox").empty().append(a)}};$(window).on("message",function(a){a=a.originalEvent;a.origin==r.adzerk.origin&&(msg=a.data.split(":"),msg[0]=="ados.createAdFrame"&&r.adzerk.createSponsorshipAdFrame())});
$(function(){r.config.cursed&&($(".midcol .arrow").on("mouseover",function(a){var a=$(a.target),b=a.clone().css("position","absolute").css("margin",0).css(a.offset()).appendTo(a.parents(".content"));a.css("opacity",0);b.on("mouseover",function(){var a=Math.PI*2*Math.random();b.animate({"margin-left":"+="+20*Math.cos(a),"margin-top":"+="+20*Math.sin(a)},100)})}),$(".buttons a, form button, .pretty-form button").prop("onclick",null).on("click focus",function(a){$(a.currentTarget).blur().prop("tabindex",
"9999").css("white-space","nowrap").animate({"font-size":0,width:0,height:0,opacity:0},200);return!1}))});
r.strings.set({"missing_credit_zip": "missing zip code", "missing_credit_country": "missing country", "missing_credit_state": "missing state or province", "bad_credit_number": "invalid credit card number", "bad_credit_expiry": "invalid expiration date", "gold_summary_comment_gift": "Want to say thanks to *%(recipient)s* for this comment? Give them a month of [reddit gold](/gold/about).", "compact_suggest": "Looks like you're browsing on a small screen. Would you like to try [reddit's mobile interface](%(url)s)?", "an_error_occurred_friendly": "an error occurred. please try again later! (status: %(status)s)", "an_error_occurred": "an error occurred (status: %(status)s)", "missing_credit_city": "missing city", "login_fallback_msg": "try using our secure login form.", "bad_credit_cvc": "invalid cvc", "missing_credit_address": "missing address", "permissions": {"none_msg": "no permissions", "all_msg": "full permissions", "info": {"moderator": {"wiki": {"description": "manage the wiki and access to the wiki", "title": "wiki"}, "access": {"description": "manage the lists of contributors and banned users", "title": "access"}, "mail": {"description": "read and reply to moderator mail", "title": "mail"}, "config": {"description": "edit settings, sidebar, css, and images", "title": "config"}, "posts": {"description": "use the approve, remove, spam, distinguish, and nsfw buttons", "title": "posts"}, "flair": {"description": "manage user flair, link flair, and flair templates", "title": "flair"}}, "moderator_invite": {"wiki": {"description": "manage the wiki and access to the wiki", "title": "wiki"}, "access": {"description": "manage the lists of contributors and banned users", "title": "access"}, "mail": {"description": "read and reply to moderator mail", "title": "mail"}, "config": {"description": "edit settings, sidebar, css, and images", "title": "config"}, "posts": {"description": "use the approve, remove, spam, distinguish, and nsfw buttons", "title": "posts"}, "flair": {"description": "manage user flair, link flair, and flair templates", "title": "flair"}}}}, "missing_credit_name": "missing name"})

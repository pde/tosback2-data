var partnerXML='<partner_Partner_xref><Partner>';
partnerXML+='<Partner><PartnerSourceID>TXABI</PartnerSourceID><PartnerID>90459</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>PAALM</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>GASTA</PartnerSourceID><PartnerID>90683</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TXAMA</PartnerSourceID><PartnerID>90582</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ARLID</PartnerSourceID><PartnerID>90554</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>GAATH</PartnerSourceID><PartnerID>90604</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>GAAUG</PartnerSourceID><PartnerID>90612</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TXAUS</PartnerSourceID><PartnerID>90105</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MTBOZ</PartnerSourceID><PartnerID>90721</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>PABUT</PartnerSourceID><PartnerID>90433</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLCAP</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TXCOR</PartnerSourceID><PartnerID>90550</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>VACUL</PartnerSourceID><PartnerID>90527</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>IAWEB</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MIESC</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>VADAR</PartnerSourceID><PartnerID>90528</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ALDOT</PartnerSourceID><PartnerID>90510</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>PAERI</PartnerSourceID><PartnerID>90464</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>IAEST</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLJAJ</PartnerSourceID><PartnerID>90049</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NCHIC</PartnerSourceID><PartnerID>90518</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TXHOU</PartnerSourceID><PartnerID>90000</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NCCON</PartnerSourceID><PartnerID>90517</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>JRC</PartnerSourceID><PartnerID>90734</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WIKEN</PartnerSourceID><PartnerID>90233</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WABRE</PartnerSourceID><PartnerID>90552</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>1296344</PartnerSourceID><PartnerID>90416</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MOCAG</PartnerSourceID><PartnerID>90589</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NDMIN</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLNAP</PartnerSourceID><PartnerID>90542</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>INBNB</PartnerSourceID><PartnerID>90605</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ALOPE</PartnerSourceID><PartnerID>90514</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MNROC</PartnerSourceID><PartnerID>90379</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>VARIT</PartnerSourceID><PartnerID>90535</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLSAR</PartnerSourceID><PartnerID>90492</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>INSBT</PartnerSourceID><PartnerID>90575</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MNPAU</PartnerSourceID><PartnerID>90156</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TXSAN</PartnerSourceID><PartnerID>90551</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>CAPAS</PartnerSourceID><PartnerID>90494</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TNMEM</PartnerSourceID><PartnerID>90547</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MSCCD</PartnerSourceID><PartnerID>90135</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>OHFIN</PartnerSourceID><PartnerID>90421</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>OHCAM</PartnerSourceID><PartnerID>90249</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MIHOU</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MIIRO</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>VACHA</PartnerSourceID><PartnerID>90526</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NCFAY</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>wvwhe</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TNKNN</PartnerSourceID><PartnerID>90542</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>OHMAR</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>HIMAN</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NCMAR</PartnerSourceID><PartnerID>90519</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MIMAR</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>VALYD</PartnerSourceID><PartnerID>90532</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>VAWAY</PartnerSourceID><PartnerID>90538</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>SCCHA</PartnerSourceID><PartnerID>90349</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NYJAP</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>OHEAS</PartnerSourceID><PartnerID>90249</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>OHSAL</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ILSPR</PartnerSourceID><PartnerID>90108</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>GAGAI</PartnerSourceID><PartnerID>90079</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WVWEI</PartnerSourceID><PartnerID>90364</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>PAWIL</PartnerSourceID><PartnerID>90087</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NYALT</PartnerSourceID><PartnerID>90001</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WAKR</PartnerSourceID><PartnerID>90412</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>TXWIC</PartnerSourceID><PartnerID>90553</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NCWIN</PartnerSourceID><PartnerID>90522</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WRKO</PartnerSourceID><PartnerID>90629</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WSPATV</PartnerSourceID><PartnerID>90507</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WTKKFM</PartnerSourceID><PartnerID>90456</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>PAYOK</PartnerSourceID><PartnerID>90732</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLMIH</PartnerSourceID><PartnerID>90045</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WABEL</PartnerSourceID><PartnerID>90472</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>SCCOL</PartnerSourceID><PartnerID>90474</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>CAFRE</PartnerSourceID><PartnerID>90476</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>CAMOD</PartnerSourceID><PartnerID>90479</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>CASAB</PartnerSourceID><PartnerID>90482</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WATAC</PartnerSourceID><PartnerID>90483</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLBRA</PartnerSourceID><PartnerID>90484</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ILSPR</PartnerSourceID><PartnerID>90108</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ILROR</PartnerSourceID><PartnerID>90108</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MAQUI</PartnerSourceID><PartnerID>90108</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>CTNOR</PartnerSourceID><PartnerID>90108</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MABRO</PartnerSourceID><PartnerID>90108</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WSAW</PartnerSourceID><PartnerID>90447</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLTAM</PartnerSourceID><PartnerID>90426</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>NVLAS</PartnerSourceID><PartnerID>90277</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>INSID</PartnerSourceID><PartnerID>90531</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WNCNTV</PartnerSourceID><PartnerID>90777</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WCMHTV</PartnerSourceID><PartnerID>90061</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>OREUG</PartnerSourceID><PartnerID>90878</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>SCFLO</PartnerSourceID><PartnerID>90784</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WJARTV</PartnerSourceID><PartnerID>90053</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WIMIL</PartnerSourceID><PartnerID>90078</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>VADAR</PartnerSourceID><PartnerID>90528</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>RIJRJ</PartnerSourceID><PartnerID>90446</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WRGBTV</PartnerSourceID><PartnerID>90028</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WWMTTV</PartnerSourceID><PartnerID>90029</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ILALT</PartnerSourceID><PartnerID>90033</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WPECTV</PartnerSourceID><PartnerID>90039</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>KTVLTV</PartnerSourceID><PartnerID>90042</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>OHLIM</PartnerSourceID><PartnerID>90043</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>AAAA</PartnerSourceID><PartnerID>AAAAA</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WASECA</PartnerSourceID><PartnerID>90667</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>PAYOR</PartnerSourceID><PartnerID>90681</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>GACOV</PartnerSourceID><PartnerID>90684</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>GAHIN</PartnerSourceID><PartnerID>90686</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>CASCN</PartnerSourceID><PartnerID>90152</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>CAMAN</PartnerSourceID><PartnerID>90690</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>GACOV</PartnerSourceID><PartnerID>90691</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>10003188</PartnerSourceID><PartnerID>90693</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>WIEAU</PartnerSourceID><PartnerID>90694</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MSMCC</PartnerSourceID><PartnerID>90695</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>FLNAV</PartnerSourceID><PartnerID>90696</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>LAMOR</PartnerSourceID><PartnerID>90697</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>LAFRA</PartnerSourceID><PartnerID>90698</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>SCAIK</PartnerSourceID><PartnerID>90699</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>ARFOR</PartnerSourceID><PartnerID>90700</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>1153168</PartnerSourceID><PartnerID>90701</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>MIGHT</PartnerSourceID><PartnerID>90702</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>1153168</PartnerSourceID><PartnerID>90703</PartnerID></Partner>';
partnerXML+='<Partner><PartnerSourceID>AAAA</PartnerSourceID><PartnerID>0000</PartnerID></Partner>';
partnerXML+='</Partner></partner_Partner_xref>';
	if (window.DOMParser){
	  parser=new DOMParser();
	  xmlDoc=parser.parseFromString(partnerXML,"text/xml");
	}else{// Internet Explorer
	  xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
	  xmlDoc.async="false";
	  xmlDoc.loadXML(partnerXML); 
	} 

getPartnerId =function (whichPartner) {
	var whichPartnerTemp = '';
	whichPartnerTemp = whichPartner.toUpperCase();
	x=xmlDoc.getElementsByTagName("Partner");
	for (i=0;i<x.length;i++){ 
		if(whichPartnerTemp ==x[i].childNodes[0].childNodes[0].nodeValue){
			return x[i].childNodes[1].childNodes[0].nodeValue;
		}
	
	}
	return 'no match';  
}
var defaultStep=250;  
var step=defaultStep;  
/*getUrlVars = function() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
		if (value.charAt(value.length - 1) == "#"){
			value = value.substring(0,value.length-1);
		}
        vars[key.toLowerCase()] = value;
    });
    return vars;
}*/
findPos = function (obj) {
	var curleft = curtop = 0;
	if (obj.offsetParent) {
		do {
			curleft += obj.offsetLeft;
			curtop += obj.offsetTop;
		} while (obj = obj.offsetParent);
	}
	return [curleft,curtop];
}
openNdnWindow = function(url){
	$(".ndn_thumbScroller").stopTime('autoScroll');
	window.open(url,"ndnPlayer","height=700,width=600",false);	
	autoScroll = false;
}	
openNdnApWindow = function (url){
	$(".ndn_thumbScroller").stopTime('autoScroll');
	window.open(url,"apPlayer","height=1120,width=1020",false);
	autoScroll = false;
}	

//player variables
var allowFullScreen = new Boolean();

var urlvars = getUrlVars();

if (urlvars["freewheel"] == undefined || urlvars["wid"] == null || urlvars["wid"] == '') {
    var freewheel = "0";
} else {
    var freewheel = String(urlvars["freewheel"]);
}
var wid = "0";
if (urlvars["wid"] == undefined || urlvars["wid"] == null || urlvars["wid"] == '') {
   wid = "0";
} else {
   wid = String(urlvars["wid"]);
}
if (urlvars["sitesection"] == undefined) {
    var sitesection = "0";
} else {
    var sitesection = urlvars["sitesection"];
}
var playerWidth = "300";
if (urlvars["width"] == undefined) {
    if (urlvars["w"] == undefined){
		playerWidth = "300";
	}else{
		playerWidth = urlvars["w"];
	}
} else {
    playerWidth = urlvars["width"];
}
var playerHeight = "250";
if (urlvars["height"] == undefined) {
	if (urlvars["h"] == undefined){
		playerHeight = "360";
	} else{
		playerHeight = urlvars["h"];
	}
} else {
    playerHeight = urlvars["height"];
}
if (urlvars["vid"] == undefined) {
    var vidId = "0";
} else {
    var vidId = urlvars["vid"];
}
if (urlvars["cid"] == undefined) {
    var cid = "0";
} else {
    var cid = urlvars["cid"];
}
if (urlvars["thumbid"] == undefined) {
    var thumbId = "slider";
} else {
    var thumbId = urlvars["thumbid"];
}
if (urlvars["zoneid"] == undefined) {
    var ZoneID = "50974";
} else {
    var ZoneID = urlvars["zoneid"];
}
if (urlvars["guid"] == undefined) {
    var guid = "";
} else {
    var guid = urlvars["guid"];
}
if (urlvars["parent"] == undefined) {
    _parent = document.getElementsByTagName('body')[0];
} else {
    _parent = document.getElementById(urlvars["parent"]);
}
if (urlvars["embed"] == undefined){
	var embed = "iframe";
}else{
	var embed = urlvars["embed"];
}

var affiliateID = urlvars["f"];
if (affiliateID != undefined) {
	thumbId = "slider";
	var convertedFreeWheel;
	convertedFreeWheel = getPartnerId (affiliateID);
	if(convertedFreeWheel == 'no match'){
		freewheel = '90121';
	}else{
		freewheel = convertedFreeWheel;
	}
	if (thumbId == "slider" && wid=="0"){
		wid="3989";
	}
}

if (thumbId == "plist"){
	var ltype = "4";
	playerWidth = "300";	
	playerHeight = "250";
}else if (thumbId == "slider"){
	var ltype = "1";
	playerWidth = "300";	
	playerHeight = "250";
}else if (thumbId == "apslider"){
	var ltype = "1";
	playerWidth = "300";	
	playerHeight = "250";
}else if (thumbId == "headline"){
	var ltype = "3";
	playerWidth = "300";	
	playerHeight = "250";
}else if (thumbId == "horizontal500"){
	var ltype = "11";
}else if (thumbId == "horizontal400"){
	var ltype = "10";	
}else{
	var ltype = "2";
}
//Compatibilty mode detection
var agentStr = navigator.userAgent;
var mode;
var isIE9Compatibility = new Boolean(false);

if (agentStr.indexOf("Trident/5.0") > -1) {
	if (agentStr.indexOf("MSIE 7.0") > -1){
		mode = "IE9 Compatibility View";
		isIE9Compatibility = true;
	}else{
		mode = "IE9";
	}
	/*if (agentStr.indexOf("Trident/4.0") > -1) {
		if (agentStr.indexOf("MSIE 7.0") > -1){
			mode = "IE8 Compatibility View";
			isIE9Compatibility = true;
		}else{
		mode = "IE8";
		}
	}else{
		mode = "IE7";
	}*/
}
//alert("Browser Mode:\t" + mode  + "+isIE9Compatibility : \t" +isIE9Compatibility );
//document.title = "Browser Mode:\t" + mode;
//document.write(navigator.userAgent);

// Page view call
var urlArr = String(document.URL).split("?");
var furl = urlArr[0];
SavePageView(wid, furl, null, ((sitesection == '') ? null : sitesection), freewheel);
var rdm = String(Math.floor(Math.random()*1000000000));

var nn4 = (document.layers);
var nn6 = (document.getElementById && !document.all);
var ie4 = (document.all && !document.getElementById);
var ie5 = (document.all && document.getElementById);

var did = "1";
var autoPlay = new Boolean(false);
var continuousPlay = "6";
var allowEmbed = new Boolean(true);
var allowEmail = new Boolean(true);
var show_ads = new Boolean(true);
var landingURL = "";
var zoneid = "0";
var partnerlogo = "";

//initialize variables
var c2psource = "";
var vidsource = "";
var x = "";
var lastThumb = 999;
var thumbWidth=300;
var thumbHeight=200;
var controlsContent = "";
var thumbContent = "";
var thumbContent2 = "";
var socialWindow = "";
var linkString = "";
var embedString = "";
var thumbNum = 0;
var plistNum = 0;
var vidLoc = "";
var firstPlayClicked = new Boolean(false);
var adRunning = new Boolean(false);
var activePlaylist = 0;
var activeContent = 0;
var isIOS = new Boolean(false);
var isSafari = new Boolean(false);
var isIE = new Boolean(false);
var ieVer = "0";
var isFF = new Boolean(false);
var isPC = new Boolean(false);
var isMobile = new Boolean(false);
var isAndroid = new Boolean(false);
var autoScroll = new Boolean(true);
//production
var baseURL = "http://widget.newsinc.com/_cfvp/playlist16x9_player.html";
//test
//var baseURL = "http://dev.assets.newsinc.com/players/flash/playlist16x9_player.html";
var baseApURL = "http://landing.newsinc.com/apvideo/home.html";
var imageURL = "http://assets.newsinc.com/launchers/";
var informBaseURL = "http://videos.inform.com/relatedVideos";
var isPlaylistArr = new Boolean(false);
var isContentArr = new Boolean(false);
var playlistArr = new Array();
var contentArr = new Array();
var assetArr = new Array();
var isEnded = new Boolean(false);
var currentScrollNum = 0;
var scrollCount = 0;
var activeList = "ndn_thumbScroller";
var loopCount = 1;
var k=0;
var firstBuild = new Boolean(true);
var position = new Array();
var container = $('#ndn_container',_parent)[0];  //document.getElementById('ndn_container');
var thumbScroller = $('#ndn_thumbScroller',_parent)[0];  //document.getElementById('ndn_thumbScroller');
var thumbScroller2 = $('#ndn_thumbScroller2',_parent)[0];  //document.getElementById('ndn_thumbScroller2');
var thumbScroller3 = $('#ndn_thumbScroller3',_parent)[0];  //document.getElementById('ndn_thumbScroller2');
var thumbScroller4 = $('#ndn_thumbScroller4',_parent)[0];  //document.getElementById('ndn_thumbScroller2');
var thumbControls = $('#ndn_thumbControls',_parent)[0];  //document.getElementById('ndn_thumbControls');
var thumbContainer = $('#ndn_thumbContainer',_parent)[0];  //document.getElementById('ndn_thumbContainer');
var singleThumb = $('#ndn_singleThumb',_parent)[0];  //document.getElementById('ndn_singleThumb');
var singleContainer = $('#ndn_singleContainer',_parent)[0];  //document.getElementById('ndn_singleContainer');
var singleScroller = $('#ndn_singleScroller',_parent)[0];  //document.getElementById('ndn_singleScroller');
var selector = $('#ndn_selector',_parent)[0];  //document.getElementById('ndn_selector');
var playlistSelector = $('#ndn_playlistSelector',_parent)[0];  //document.getElementById('ndn_playlistSelector');
var contentCnt = 0;
var contentLength = 0;
var contentArr = new Array();
var orderArr = new Array();
var contentIdArr = new Array();
var contentIdArr2 = new Array();
var plistRetArr = new Array();
var isLanding = new Boolean(true);
var DistributorName = "";
var adCalled = new Boolean(false);
var curThumbAdNum = 0;
var firstScroll = new Boolean(true);
var secondScroll = new Boolean(true);
var isInform = new Boolean(false);
var topMatch = "false";
var htmlInit = new Boolean(false);
var flashInit = new Boolean(false);
var repeat = new Boolean(false);
var buildNum = 1;
var isRepeating = new Boolean(false);
var lastThumbNum = 0;

var firstLoad = new Boolean(true);
var auditudeLoaded = new Boolean(false);

var firstThumbLoaded = new Boolean(false);

var linearAdPlayed = new Boolean(false);

var launcherConfigValues = new Array();
//var comscoreOnFlag = new Boolean(false);
///For the streaming bumber assignment and config
var streamVideoId;
var streamVideoStartTime = "4"; // 3 second default
var streamSegmentLength = "7"; // 6 second default
var streamFadeDownDuration = "1.5";
var streamSlateAfterVideoHold = "20"; // time hold on black before showing thumbs default 2 sec. 
	
if (urlvars["topmatch"] == undefined){
	topMatch = "false";
}else{
	topMatch = urlvars["topmatch"];
}

var informArticleUrl = null;
//alert('Document Referrer ' + document.referrer);
if (_parent) {
	if (_parent.document.URL) {
		informArticleUrl = encodeURIComponent(_parent.document.URL);
	} else {
		informArticleUrl = encodeURIComponent(document.URL);
	}
}else {
//informUrl = encodeURIComponent(document.URL);
	informArticleUrl = encodeURIComponent(document.referrer);
}
//alert(informArticleUrl);

if(urlvars["url"] != undefined) {
	informArticleUrl = urlvars["url"];
}

if (urlvars["isinform"] == undefined) {
	//alert("isInform NOT __ available: " + urlvars["isinform"] + " : " + isInform);
	} else {
	
	isInform = urlvars["isinform"];
	isInform = true;
	//alert("isInform available: " + isInform);
}


getInternetExplorerVersion = function()
// Returns the version of Internet Explorer or a -1
// (indicating the use of another browser).
{
  var rv = -1; // Return value assumes failure.
  if (navigator.appName == 'Microsoft Internet Explorer')
  {
    var ua = navigator.userAgent;
    var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
    if (re.exec(ua) != null)
      rv = parseFloat( RegExp.$1 );
  }
  return rv;
}

//var browserOS = BrowserDetect.OS;
//var browserVersion = BrowserDetect.version;
//$iOS = deviceAgent.match(/(iphone|ipod|ipad)/);
if (navigator.userAgent.match(/like Mac OS X/i)) {
	isIOS = true;
}
if (navigator.userAgent.match(/Safari/i)){
	isSafari = true;
}
if (navigator.userAgent.match(/MSIE/i)){
	isIE = true;
	ieVer = getInternetExplorerVersion();
}
if (navigator.userAgent.match(/Firefox/i)){
	isFF = true;
}
if (navigator.userAgent.match(/(iphone|ipod|ipad)/i)){
	did = "2";
	isMobile = true;	
	//production
	baseURL = "http://widget.newsinc.com/_mob/16x9/player.html";
	//test
	//baseURL = "http://dev.assets.newsinc.com/players/mobile/16x9/player.html";
}
if (navigator.userAgent.match(/Android/i)){		
	var strAndroid  = navigator.userAgent.indexOf("Android ");
	var aVersion = navigator.userAgent.substr(strAndroid+8,1);		
	aVersion > 3 ? (did="2", isMobile = true, baseURL = "http://widget.newsinc.com/_mob/16x9/player.html") : isAndroid = true;	
}
if (navigator.userAgent.match(/Silk/i)){
	did = "2";
	isMobile = true;	
	baseURL = "http://widget.newsinc.com/_mob/16x9/player.html";
}

//alert(navigator.userAgent.match(/iPad/i));
//alert(navigator.userAgent.match(/iPhone OS 3_1_3/i));

//NOTE: this function will not be needed once the HTML5 data is in the database and on servers
fixVid = function(str){
	str = str.substr(0,str.length-3);
	str = str + "mp4";
	return(str);	
}

getTitle = function(){
	return playlistArr[activePlaylist].Content[activeContent].Name;
}

getDescript = function(){
	return 	playlistArr[activePlaylist].Content[activeContent].Description;
}
getVideoId = function(){
	//alert("you want videoId");
	sendVideoId();
}
sendVideoId = function () {
	thisMovie("ndn_adbox").sendVideoIdToSwf(streamVideoId);
	//alert("sendVideoId streamVideoId + " + streamVideoId);
}


pageInit = function () {
	htmlInit = true;
	if ((DistributorName != "") && (adCalled == false) && (flashInit == true)){
		adCalled = true;
		sendToActionScript();
	}
}
thisMovie = function (movieName) {
	if (navigator.appName.indexOf("Microsoft") != -1) {
		return window[movieName];
	} else {
		return document[movieName];
	}
}
var sendToActionScript = function () {
	// zoneId,"vidId","freewheel","sitesection","cid","wid","landingUrl","videoUrl","distName","provName","provCat");
	//thisMovie("ndn_adbox").sendToActionScript(50860,"23579178","10557","david_test2","994","2375","http://www.newsinc.com","http://video.newsinc.com/23579178.flv","testDistributor","testProvider","testProviderCat");
	//thisMovie("ndn_adbox").sendToActionScript(ZoneID,"23605024",freewheel,sitesection,cid,wid,landingURL,"http://video.newsinc.com/bumper/bumperNDN.f4v");
	//thisMovie("ndn_adbox").sendToActionScript(ZoneID,"23408962",freewheel,sitesection,cid,wid,landingURL,"http://video.newsinc.com/bumper/bumperNDN.f4v");
	/*TESTING null var junk;
	thisMovie("ndn_adbox").sendToActionScript(ZoneID,junk,freewheel,
	sitesection,cid,wid,landingURL,"http://video.newsinc.com/bumper/bumperNDN.f4v",
	streamVideoStartTime, streamSegmentLength, streamSlateAfterVideoHold, streamFadeDownDuration );	*/
	
	thisMovie("ndn_adbox").sendToActionScript(ZoneID,streamVideoId,freewheel,
	sitesection,cid,wid,landingURL,"http://video.newsinc.com/bumper/bumperNDN.f4v",
	streamVideoStartTime, streamSegmentLength, streamFadeDownDuration, streamSlateAfterVideoHold, baseURL);	
}

//process thumbnail launcher
thumbServices = function (data){
	position = findPos($('#ndn_container',_parent)[0]);
	container = $('#ndn_container',_parent)[0];  //document.getElementById('ndn_container');
	thumbScroller = $('#ndn_thumbScroller',_parent)[0];  //document.getElementById('ndn_thumbScroller');
	thumbScroller2 = $('#ndn_thumbScroller2',_parent)[0];  //document.getElementById('ndn_thumbScroller2');
	thumbScroller3 = $('#ndn_thumbScroller3',_parent)[0];  //document.getElementById('ndn_thumbScroller2');
	thumbScroller4 = $('#ndn_thumbScroller4',_parent)[0];  //document.getElementById('ndn_thumbScroller2');
	thumbControls = $('#ndn_thumbControls',_parent)[0];  //document.getElementById('ndn_thumbControls');
	thumbContainer = $('#ndn_thumbContainer',_parent)[0];  //document.getElementById('ndn_thumbContainer');
	singleThumb = $('#ndn_singleThumb',_parent)[0];  //document.getElementById('ndn_singleThumb');
	selector = $('#ndn_selector',_parent)[0];  //document.getElementById('ndn_selector');
	playlistSelector = $('#ndn_playlistSelector',_parent)[0];  //document.getElementById('ndn_playlistSelector');
	
	if (thumbId != "plist"){
		thumbContainer.removeChild(thumbScroller3);
		thumbContainer.removeChild(thumbScroller4);
	}
	
	DistributorName = data.DistributorName;
	freewheel = data.TrackingGroup;
	ZoneID = data.ZoneID;
	landingURL = data.LandingURL;
	//alert("data.DeliverySettings : " +  data.DeliverySettings);
	if(data.DeliverySettings != undefined){
		var videoStartTime = getConfigValue (data.DeliverySettings, 'videoStartTime');
		var segmentLength = getConfigValue (data.DeliverySettings, 'videoSegmentLength');
		var fadeDownDuration = getConfigValue (data.DeliverySettings, 'fadeDownDuration');
		var slateAfterVideoHold = getConfigValue (data.DeliverySettings, 'slateAfterVideoHold');
		if(videoStartTime != "" && videoStartTime != null){streamVideoStartTime = videoStartTime}
		
		if(segmentLength != "" && segmentLength != null){streamSegmentLength = segmentLength}
		
		if(fadeDownDuration != "" && fadeDownDuration != null){streamFadeDownDuration = fadeDownDuration}
		if(slateAfterVideoHold != "" && slateAfterVideoHold != null){streamSlateAfterVideoHold = slateAfterVideoHold}
	}	

	if (adCalled == false && thumbId != "horizontal" && thumbId != "vertical" && thumbId != "horizontal500"  && thumbId != "horizontal400"  && isMobile != true){
		//setupAutoPlay();
		pageInit();
	}

	//alert(data.SiteSectionName);
	if (sitesection == "0"){
		sitesection = data.SiteSectionName;
	}
	
	if (wid == "0"){
		wid = data.LauncherID;
	}
	
	if (data.Playlists.length > 1){
		isPlaylistArr = true;	
	}else{
		isPlaylistArr = false;	
	}
	
	//Contents":null,"PlaylistOrder":0,"Title":"Editor Picks","playlistid":507
	if (isPlaylistArr){
		for (p=0;p<data.Playlists.length;p++){
			playlistArr[p] = data.Playlists[p];
			playlistArr[p].PlaylistOrder = data.Playlists[p].PlaylistOrder;
			playlistArr[p].Title = data.Playlists[p].Title;
			playlistArr[p].playlistid = data.Playlists[p].playlistid;
			playlistArr[p].Contents = new Object();
		}
	}else{
		playlistArr[0] = data.Playlists[0];
		playlistArr[0].PlaylistOrder = data.Playlists[0].PlaylistOrder;
		playlistArr[0].Title = data.Playlists[0].Title;
		playlistArr[0].playlistid = data.Playlists[0].playlistid;
		playlistArr[0].Contents = new Object();
	}
	for (var c=0;c<playlistArr.length;c++){
		if (cid == playlistArr[c].playlistid){
			activePlaylist = c;
		}
	}
	if (data.Playlists.length == 0){
		container.innerHTML = "<img src='nocontent.png'>";
	}else{
		//create thumbnail scroller
		setThumbStyle(thumbId);
		cid = playlistArr[activePlaylist].playlistid;
		constructPlaylist();
	}
}

getConfigValue = function(dataArray, searchName){
	for (var k=0; k< dataArray.length; k++){
		if(dataArray[k].Name == searchName){
			return dataArray[k].Value;
		}
	}
	return null;
}

constructPlaylist = function (){
	//production
	if(isInform == false){
		//prod
		$.GetDataFromURL('http://LT.ndnps.newsinc.com/playlistcontents/show/'+freewheel+'/'+wid+'/' + playlistArr[activePlaylist].playlistid + '/0/' + did,playlistServices);
		//dev http://dev.mps.newsinc.com/
		//$.GetDataFromURL('http://dev.mps.newsinc.com/playlistcontents/show/'+freewheel+'/'+wid+'/' + playlistArr[activePlaylist].playlistid + '/0/' + did,playlistServices);
	}else{
		var service_url;
		var newsArticleURL = informArticleUrl;
		service_url = informBaseURL + "?url=" + newsArticleURL + "&output=json&submit=search" + "&wid=" + wid + "&freewheel=" + freewheel + "&did="+did + "&topMatch=" + topMatch;
		$.GetDataFromURL(service_url, playlistServices);
	}
}

getPlaylist = function (){
	if (playlistSelector.selectedIndex != -1){
		activePlaylist = playlistSelector.selectedIndex;
		cid = playlistArr[activePlaylist].playlistid;
		playlistArr[activePlaylist].Contents = [];
	}
	if(isInform == false){
	//production
	$.GetDataFromURL('http://LT.ndnps.newsinc.com/playlistcontents/show/'+freewheel+'/'+wid+'/' + cid + '/0/' + did,playlistServices);
	//dev
	//$.GetDataFromURL('http://dev.mps.newsinc.com/playlistcontents/show/'+freewheel+'/'+wid+'/' + cid + '/0/' + did,playlistServices);
	}else{
		//alert("Inform TRUE");
		var service_url;
		var newsArticleURL = informArticleUrl;
		service_url = informBaseURL+"?url=" + newsArticleURL + "&output=json&submit=search";
		$.GetDataFromURL(service_url, playlistServices);
	}
}

playlistServices = function (data){
	streamVideoId = data[0].ContentID;
	//sendVideoId();
	//sendToActionScript();
	contentLength = data.length;

	if (thumbId == "horizontal500" && isMobile == true && contentLength >= 8){
		contentLength = 8;
	}else if (((thumbId == "slider") || (thumbId == "apslider") || (thumbId == "horizontal500")) && contentLength > 6){
		contentLength = 6;
	}	
	if (thumbId == "horizontal400" && isMobile == true && contentLength >= 9){
		contentLength = 9;
	}else if ((thumbId == "horizontal400") && contentLength > 6){
		contentLength = 6;
	}	
	if (thumbId == "vertical" && isMobile == true && contentLength >= 10){
		contentLength = 10;
	}else if ((thumbId == "vertical") && contentLength > 8){
		contentLength = 8;
	}	
	if ((contentLength > 12) && ((thumbId == "headline")||(thumbId == "plist"))){
		contentLength = 12;
	}
	orderArr = [];
	contentIdArr = [];
	
	for(var c=0;c<contentLength;c++){
		orderArr[c] = data[c].ContentOrder;
		contentIdArr[c] = data[c].ContentID;
		playlistArr[activePlaylist].Contents[c] = data[c];
		constructContents(playlistArr[activePlaylist].Contents[c].ContentID);
	}
}

constructContents = function (ci){
	contentArr = [];
	contentIdArr2 = [];
	contentCnt = 0;
	//production
	$.GetDataFromURL('http://LT.ndnps.newsinc.com/content/show/0'+'/0/'+ ci + '/' + did,contentServices);
	//dev
	//$.GetDataFromURL('http://dev.mps.newsinc.com/content/show/0'+'/0/'+ ci + '/' + did,contentServices);
}

sortNumber = function (a,b)
{
return b - a;
}

contentServices = function (data){
	contentArr.push(data);
	contentIdArr2.push(data.ContentID);
	contentCnt++;
	if (contentCnt == contentLength){
		for (var e=0;e<contentLength;e++){
			for (var f=0;f<contentArr.length;f++){
				if (contentIdArr[e] == contentIdArr2[f]){
					playlistArr[activePlaylist].Contents[e] = contentArr[f];
					break;
				}
			}
		}
		if (thumbId == "vertical"){
				controlsContent = "<div class='ndn_"+thumbId+"Scroll'><a onclick=openNdnWindow('"+baseURL+"?cid="+cid+"&wid="+wid+"&sitesection="+sitesection+"&freewheel="+freewheel+"&external_url="+encodeURI(document.referrer)+"')><div class='ndn_viewAll'>VIEW ALL</div></a><a onmousedown=\"scrollDivUp('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollLeft' style='padding-left:27px;padding-top:5px;' border='0' src='"+imageURL+"scrollLeft.png'></a><a  onmousedown=\"scrollDivDown('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollRight' border='0' src='"+imageURL+"scrollRight.png' style='display:inline;'></a></div>";
		}else if (thumbId == "slider" || thumbId == "apslider"){
			controlsContent = "<div class='ndn_"+thumbId+"Scroll'><a onmousedown=\"scrollDivUp('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollLeft' border='0' src='"+imageURL+"scrollLeft.png' style='visibility:hidden;'></a><a onmousedown=\"scrollDivDown('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollRight' border='0' src='"+imageURL+"scrollRight.png' style='display:inline;'></a></div>";
		}else if (thumbId == "plist"){
			controlsContent = "<div class='ndn_"+thumbId+"Scroll'><a onmousedown=\"scrollDivUp('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollLeft' style='margin-left:0px;' border='0' src='"+imageURL+"scrollLeft.png'></a><a onmousedown=\"scrollDivDown('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollRight' border='0' src='"+imageURL+"scrollRight.png' style=display:inline;'margin-left:695px;'></a></div>";
		}else if (thumbId == "horizontal500"){
			controlsContent = "<div class='ndn_"+thumbId+"Scroll'><a onmousedown=\"scrollDivUp('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollLeft' style='margin-left:0px;' border='0' src='"+imageURL+"scrollLeftTall.png'></a><a onmousedown=\"scrollDivDown('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollRight' border='0' src='"+imageURL+"scrollRightTall.png' style='display:inline;margin-left:518px;'></a></div>";
		}else if (thumbId == "horizontal400"){
			controlsContent = "<div class='ndn_"+thumbId+"Scroll'><a onmousedown=\"scrollDivUp('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollLeft' style='margin-left:0px;' border='0' src='"+imageURL+"scrollLeftTall.png'></a><a onmousedown=\"scrollDivDown('ndn_thumbScroller',false)\" onmouseup='stopMe()'><img id='ndn_scrollRight' border='0' src='"+imageURL+"scrollRightTall.png' style='display:inline;margin-left:386px;'></a></div>";
		}
		thumbControls.innerHTML = controlsContent;
		if (thumbId == "hscroll"){
			thumbControls.style.cssFloat = "left";
		}
		buildPlaylist();
		if (thumbId == "apslider"){
			$(".ndn_apsliderhovertext",_parent).each(function(i, element) { $(element)[0].style.fontWeight = "bold"; });
		}
	}	
}

buildPlaylist = function (){
	lastThumb = contentLength;
	//alert("contentLength " + contentLength);
	if (thumbId == "horizontal500" && isMobile == true && lastThumb >= 8){
		lastThumb = 8;
	}else if ((lastThumb > 6) && ((thumbId == "slider")||(thumbId == "apslider")||(thumbId == "horizontal500"))){
		lastThumb = 6;
	}
	if (thumbId == "horizontal400" && isMobile == true && lastThumb >= 9){
		lastThumb = 9;
	}else if ((lastThumb > 6) && (thumbId == "horizontal400")){
		lastThumb = 6;
	}
	if (thumbId == "vertical" && isMobile == true && lastThumb >= 10){
		lastThumb = 10;
	}else if ((lastThumb > 8) && (thumbId == "vertical")){
		lastThumb = 8;
	}
	if (lastThumb > 12 && ((thumbId == "headline")||(thumbId == "plist"))){
		lastThumb = 12;
	}
//	if (thumbId == "plist" && isRepeating == false && (lastThumb == 5 || lastThumb == 7 || lastThumb == 9 || lastThumb == 11)){
	if (thumbId == "plist" && isRepeating == false && lastThumb > 4){
		repeat = true;
		isRepeating = true;
	}
	thumbContent = "<div id='ndn_thumbs'>";
	thumbContent2 = "<div id='ndn_thumbs'>";
	
	var thumbCount = 0;
	var plistThumbCount = 0;
	plistNum = 0;
	var thumbAdNum = 0;
	lastThumbNum = 0;
	var thisThumbNum = 0;
	if (thumbId == "plist" && repeat == true){
		lastThumbNum = lastThumb * 4;
	}else{
		lastThumbNum = lastThumb;
	}
	for (k=0;k<lastThumbNum;k++){
		if (((thumbCount < 2) && (thumbId == 'plist'))||(thumbId != 'plist')){
			if (thumbId == "horizontal500" && thumbCount == 2 && isMobile == false){
				thumbContent = thumbContent + "<div class='ndn_"+thumbId+"thumb' id='thumb_ad_" + thumbAdNum + "' style='margin-top:-4px;background-image:url(http://assets.newsinc.com/ndnThumb.jpg);background-repeat: no-repeat;background-position: 10px 0px;'></div>";
				thumbAdNum++;
				k--;
			}else if  (thumbId == "horizontal400" && thumbCount == 2 && isMobile == false){
				thumbContent = thumbContent + "<div class='ndn_"+thumbId+"thumb' id='thumb_ad_" + thumbAdNum + "' style='margin-top:-4px;background-image:url(http://assets.newsinc.com/ndnThumb.jpg);background-repeat: no-repeat;background-position: 10px 0px;'></div>";
				thumbAdNum++;
				k--;
			}else if (thumbId == "vertical" && thumbCount == 3 && isMobile == false){
				thumbContent = thumbContent + "<div class='ndn_"+thumbId+"thumb' id='thumb_ad_" + thumbAdNum + "' style='top:2px;margin-top:-2px;background-image:url(http://assets.newsinc.com/ndnThumb2.jpg);background-repeat: no-repeat;background-position: 0px -5px;'></div>";
				thumbAdNum++;
				k--;
			}else{
				if (affiliateID != undefined){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"thumb' id='ndn_thumb"+k+"'><a onclick=openNdnApWindow('"+baseApURL+"?f="+affiliateID+"&CID="+cid+"&WID="+wid+"&SPID="+playlistArr[activePlaylist].Contents[k].ContentID+"&VID="+playlistArr[activePlaylist].Contents[k].ContentID+"&freewheel="+freewheel+"&sitesection="+sitesection+"&external_url="+encodeURI(document.referrer)+"')>";
				}else if (thumbId == "plist"){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"thumb' id='ndn_thumb"+thisThumbNum+"'><a onclick=openNdnWindow('"+baseURL+"?CID="+cid+"&WID="+wid+"&VID="+playlistArr[activePlaylist].Contents[thisThumbNum].ContentID+"&freewheel="+freewheel+"&sitesection="+sitesection+"&external_url="+encodeURI(document.referrer)+"')>";
				}else{
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"thumb' id='ndn_thumb"+k+"'><a onclick=openNdnWindow('"+baseURL+"?CID="+cid+"&WID="+wid+"&VID="+playlistArr[activePlaylist].Contents[k].ContentID+"&freewheel="+freewheel+"&sitesection="+sitesection+"&external_url="+encodeURI(document.referrer)+"')>";
				}
				if (thumbId == "headline"){
					thumbContent = thumbContent + "<img class='ndn_"+thumbId+"hoverimage' border='0' src='"+imageURL+"playArrowSmall.png'>";
				}else if (thumbId == "apslider"){
					thumbContent = thumbContent + "<img class='ndn_"+thumbId+"hoverimage' border='0' src='"+imageURL+"playArrow.png'>";					
				}else{
					thumbContent = thumbContent + "<img class='ndn_"+thumbId+"hoverimage' border='0' src='"+imageURL+"playArrow.png'>";
				}
				//alert(fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,140,thumbId+"hovertext"));
				if (thumbId == "headline"){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,280,thumbId+"hovertext",999) + "</div>";
				}else if (thumbId == "slider"){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,280,thumbId+"hovertext",36) + "</div>";
				}else if (thumbId =="apslider"){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,280,thumbId+"hovertext",36) + "</div>";
				}else if (thumbId == "horizontal"){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,208,thumbId+"hovertext",999) + "</div>";
				}else if (thumbId == "plist"){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[thisThumbNum].Name,270,thumbId+"hovertext",36) + "</div>";
				}else if (thumbId == "horizontal400"){
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,270,thumbId+"hovertext",36) + "</div>";
				}else {
					thumbContent = thumbContent + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,275,thumbId+"hovertext",999) + "</div>";
				}
				if (thumbId == "slider"){
					thumbContent = thumbContent + "<img class='ndn_"+thumbId+"hoverlogo' src='"+playlistArr[activePlaylist].Contents[k].ProducerLogo+"' border='0' id='ndn_"+thumbId+"hoverlogo"+k+"'>";
				}
				if (thumbId == "slider" || thumbId == "apslider"){
					thumbContent = thumbContent + "<img class='ndn_"+thumbId+"thumbimg' border='0' src='"+ getAsset(activePlaylist,k,"stillFrame")+"'>";
				}else if (thumbId != "headline"){
					if (thumbId == "plist"){
						thumbContent = thumbContent + "<img class='ndn_"+thumbId+"thumbimg' border='0' src='"+ getAsset(activePlaylist,thisThumbNum,"thumbnail")+"'>";
					}else{
						thumbContent = thumbContent + "<img class='ndn_"+thumbId+"thumbimg' border='0' src='"+ getAsset(activePlaylist,k,"thumbnail")+"'>";
					}
				}
				if (thumbId == "apslider"){
					thumbContent = thumbContent + "<img class='ndn_"+thumbId+"hoverlogo' src='"+playlistArr[activePlaylist].Contents[k].ProducerLogo+"' border='0' id='ndn_"+thumbId+"hoverlogo"+k+"'>";
				}

				thumbContent = thumbContent + "</a></div>";	
				plistNum++;
			}
		}else{
			if (isLanding == true){
				if (thumbId == "plist"){
					thumbContent2 = thumbContent2 + "<div class='ndn_"+thumbId+"thumb' id='ndn_thumb"+k+"'><a onclick=openNdnWindow('"+baseURL+"?WID="+wid+"&VID="+playlistArr[activePlaylist].Contents[thisThumbNum].ContentID+"&freewheel="+freewheel+"&sitesection="+sitesection+"&external_url="+encodeURI(document.referrer)+"')>";
				}else{
					thumbContent2 = thumbContent2 + "<div class='ndn_"+thumbId+"thumb' id='ndn_thumb"+k+"'><a onclick=openNdnWindow('"+baseURL+"?WID="+wid+"&VID="+playlistArr[activePlaylist].Contents[k].ContentID+"&freewheel="+freewheel+"&sitesection="+sitesection+"&external_url="+encodeURI(document.referrer)+"')>";
				}
			}else{
				if (thumbId == "plist"){
					thumbContent2 = thumbContent2 + "<div class='ndn_"+thumbId+"thumb' id='ndn_thumb"+k+"'><a onclick=openNdnWindow('"+baseURL+"?WID="+wid+"&VID="+playlistArr[activePlaylist].Contents[thisThumbNum].ContentID+"&freewheel="+freewheel+"&sitesection="+sitesection+"&external_url="+encodeURI(document.referrer)+"')>";
				}else{
					thumbContent2 = thumbContent2 + "<div class='ndn_"+thumbId+"thumb' id='ndn_thumb"+k+"'><a onclick=openNdnWindow('"+baseURL+"?WID="+wid+"&VID="+playlistArr[activePlaylist].Contents[k].ContentID+"&freewheel="+freewheel+"&sitesection="+sitesection+"&external_url="+encodeURI(document.referrer)+"')>";
				}
			}
			thumbContent2 = thumbContent2 + "<img class='ndn_"+thumbId+"hoverimage' border='0' src='"+imageURL+"playArrow.png'>";
			if (thumbId == "plist"){
				thumbContent2 = thumbContent2 + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[thisThumbNum].Name,270,thumbId+"hovertext",36) + "</div>";
				thumbContent2 = thumbContent2 + "<img class='ndn_"+thumbId+"thumbimg' border='0' src='"+ getAsset(activePlaylist,thisThumbNum,"thumbnail")+"'>";
			}else{
				thumbContent2 = thumbContent2 + "<div class='ndn_"+thumbId+"hovertext'>" + fitStringToWidth(playlistArr[activePlaylist].Contents[k].Name,280,thumbId+"hovertext",36) + "</div>";
				thumbContent2 = thumbContent2 + "<img class='ndn_"+thumbId+"thumbimg' border='0' src='"+ getAsset(activePlaylist,k,"thumbnail")+"'>";
			}
			
			thumbContent2 = thumbContent2 + "</a></div>";	
		}
		thumbCount++;
		plistThumbCount++;
		if (thumbId == "plist" && plistThumbCount < lastThumb){
			thisThumbNum++;
		}else if (thumbId == "plist"){
			plistThumbCount = 0;
			thisThumbNum = 0;
		}
		if (thumbId == "horizontal400" && thumbCount == 3){
			
			thumbCount = 0;
			
		}else if(thumbId != "vertical" && thumbCount == 4){
			
			thumbCount = 0;

		}else if (thumbId == "vertical" && thumbCount == 5){
			
			thumbCount = 0;
			
		}
	}
	if (thumbId == "horizontal400" && lastThumb == 6 && isMobile == false){
		thumbContent = thumbContent + "<div class='ndn_"+thumbId+"thumb' id='thumb_ad_" + thumbAdNum + "' style='margin-top:-4px;background-image:url(http://assets.newsinc.com/ndnThumb.jpg);background-repeat: no-repeat;background-position: 10px 0px;'></div>";
		thumbAdNum++;
	}
	thumbContent = thumbContent + "</div>";
	thumbScroller.innerHTML = thumbContent;
	//$(".ndn_thumbContainer").scrollTo({top:String(position[1])+'px', left:String(position[0])+'px'},0,{duration:0});
	if (thumbId == "slider"){
		thumbScroller2.innerHTML = thumbContent;
		thumbScroller.style.width =  String(thumbWidth*lastThumb)+"px";
		thumbScroller2.style.width =  String(thumbWidth*lastThumb)+"px";
		thumbScroller2.style.left = String(thumbWidth*lastThumb)+"px";
	}else if (thumbId == "apslider"){
		$(".ndn_apsliderhovertext",_parent).each(function(i, element) { $(element)[0].style.fontWeight = "bold"; });		
		thumbScroller.style.width =  String(thumbWidth*lastThumb)+"px";
		thumbScroller2.style.width =  String(thumbWidth*lastThumb)+"px";
		thumbScroller2.style.left = String(thumbWidth*lastThumb)+"px";
	}else if ((thumbId == "plist") && (firstBuild == true)){
		if (playlistArr.length > 1){
			for (var i=0;i<playlistArr.length;i++){
				var optn = document.createElement("OPTION");
				optn.text = playlistArr[i].Title;
				optn.value = i;
				playlistSelector.options.add(optn);
				if (i == activePlaylist){
					playlistSelector.options[i].selected = true;
				}
			}
			thumbContainer.style.top = "0px";
			thumbScroller2.innerHTML = thumbContent2;
			thumbScroller3.innerHTML = thumbContent;
			thumbScroller4.innerHTML = thumbContent2;
			var scrollerWidth = 147.5*lastThumbNum/2;
			thumbScroller.style.width = String(scrollerWidth)+"px";
			thumbScroller2.style.width = String(scrollerWidth)+"px";
			thumbScroller3.style.width = String(scrollerWidth)+"px";
			thumbScroller4.style.width = String(scrollerWidth)+"px";
			
			thumbScroller3.style.left = String(scrollerWidth-lastThumb)+"px";
			thumbScroller3.style.top = "-190px";
			thumbScroller4.style.left = String(scrollerWidth-lastThumb)+"px";
			thumbScroller4.style.top = "-190px";
			
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "hidden";
			thumbControls.style.top = "-245px";
			playlistSelector.style.width = "235px";
			selector.style.visibility = "visible";
			playlistSelector.style.top = "-245px";
			playlistSelector.style.marginLeft = "8px";
			playlistSelector.style.height = "22px";
		}else{
			selector.innerHTML = fitStringToWidth(playlistArr[0].Title,240,thumbId+"hovertext",999);
			selector.style.left = "10px";
			selector.style.float = "left";
			selector.style.top = "-245px";
			selector.style.visibility = "visible";
			selector.style.zIndex = "22";
			thumbControls.style.top = "-245px";
			thumbScroller2.innerHTML = thumbContent2;
			thumbScroller3.innerHTML = thumbContent;
			thumbScroller4.innerHTML = thumbContent2;
			var scrollerWidth = 147.5*lastThumbNum/2;
			thumbScroller.style.width = String(scrollerWidth)+"px";
			thumbScroller2.style.width = String(scrollerWidth)+"px";
			thumbScroller3.style.width = String(scrollerWidth)+"px";
			thumbScroller4.style.width = String(scrollerWidth)+"px";
			
			thumbScroller3.style.left = String(scrollerWidth-lastThumb)+"px";
			thumbScroller3.style.top = "-190px";
			thumbScroller4.style.left = String(scrollerWidth-lastThumb)+"px";
			thumbScroller4.style.top = "-190px";
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "hidden";
			thumbScroller2.style.top = "30px";
			thumbContainer.style.top = "0px";
			thumbContainer.style.zIndex = "0";
		}
		$(".ndn_plistthumb",_parent).each(function(i, element) { $(element)[0].style.float = "left"; });
		firstBuild = false;
	}else if (thumbId == "plist"){
		thumbScroller2.innerHTML = thumbContent2;
		thumbScroller3.innerHTML = thumbContent;
		thumbScroller4.innerHTML = thumbContent2;
		var scrollerWidth = 147.5*lastThumbNum/2;
		thumbScroller.style.width = String(scrollerWidth)+"px";
		thumbScroller2.style.width = String(scrollerWidth)+"px";
		thumbScroller3.style.width = String(scrollerWidth)+"px";
		thumbScroller4.style.width = String(scrollerWidth)+"px";

		scrollCount = 0;
		activeList = "ndn_thumbScroller";
		loopCount = 1;
		
		thumbScroller.style.left = "0px";
		thumbScroller2.style.left = "0px";
		thumbScroller3.style.left = String(scrollerWidth-lastThumb)+"px";
		thumbScroller3.style.top = "-190px";
		thumbScroller4.style.left = String(scrollerWidth-lastThumb)+"px";
		thumbScroller4.style.top = "-190px";
		$(".ndn_plistthumb",_parent).each(function(i, element) { $(element)[0].style.float = "left"; });
		$(".ndn_thumbContainer").scrollTo({top:String(position[1])+'px', left:String(position[0])+'px'},0,{duration:0});
		$('#ndn_scrollLeft',_parent)[0].style.visibility = "hidden";
	}else if (thumbId == "vertical"){
		if(isMobile==false){
			showThumbAd("vertical");
			$(".ndn_thumbControls",_parent).each(function(i, element) { $(element)[0].style.float = "left"; });
		}
	}else if (thumbId == "horizontal500"){
		if(isMobile==false){
			showThumbAd("horizontal500");
		}
		var thumbsWidth = String((Number((thumbWidth)+6)*(lastThumb+thumbAdNum))+2)+"px";
		thumbScroller.style.width =  String((Number((thumbWidth)+6)*(lastThumb+thumbAdNum))+2)+"px";
		$("#ndn_thumbs",_parent).each(function(i, element) { $(element)[0].style.width = thumbsWidth + "px"; });
		thumbContainer.style.zIndex = "90";
	}else if (thumbId == "horizontal400"){
		if(isMobile==false){
			showThumbAd("horizontal400");
		}
		thumbScroller.style.width =  String((Number(thumbWidth)+7.4)*(lastThumb+thumbAdNum))+"px";
		thumbContainer.style.zIndex = "90";
	}
	if (thumbId == "plist" && isMobile == true){
		if (autoScroll == true && lastThumb > 4){
			autoScrollStart();
			autoScroll = false;
		}else{
			$(".ndn_thumbScroller").stopTime('autoScroll');
		}
	}else if (isMobile == true){
		if (thumbId == "slider" || thumbId == "apslider"){
			autoScrollStart();
			autoScroll = false;
		}
	}
}

setThumbStyle = function (thumbId){
	switch (thumbId)
	{
	case "vertical":
		thumbWidth = 140;
		thumbHeight = 105;
		step = 590;
		container.style.width = "160px";
		thumbScroller.style.height = "560px";
		thumbScroller.style.width = "140px";
		thumbContainer.style.height = "600px";
		thumbScroller.style.top = "5px";
		thumbScroller.style.float = "left";
		thumbScroller.style.marginLeft = "10px";
		thumbContainer.style.width = "160px";	
		thumbContainer.style.position = "relative";
		thumbControls.style.backgroundColor = "#FFF";
		thumbContainer.style.overflow = "visible";
		thumbScroller.style.overflow = "hidden";
		thumbControls.style.top = "-50px";
		thumbControls.style.float = "left";
		thumbControls.style.marginLeft = "10px";
		break;
	case "slider":
		selector.style.display = "none";
		thumbWidth = 300;
		thumbHeight = 200;
		thumbScroller.style.height = "250px";
		thumbScroller.style.backgroundColor = "#000";
		thumbScroller2.style.height = "250px";
		thumbScroller2.style.top = "-250px";
		if (position[1] > 250){
			thumbScroller2.style.top = "0px";
			thumbScroller.style.top = "250px";
		}else{
			thumbScroller2.style.top = "-" + String(250-position[1])+"px";
			thumbScroller.style.top = String(position[1])+"px";
		}
		
		thumbScroller2.style.backgroundColor = "#000";
		thumbContainer.style.height = "250px";
		thumbContainer.style.width = "300px";
		thumbContainer.style.backgroundColor = "#000";
		thumbControls.style.top = "-40px";
		break;
	case "apslider":
		selector.style.display = "none";
		thumbWidth = 300;
		thumbHeight = 200;
		thumbScroller.style.height = "250px";
		thumbScroller.style.backgroundColor = "#000";
		thumbScroller2.style.height = "250px";
		thumbScroller2.style.top = "-250px";
		if (position[1] > 250){
			thumbScroller2.style.top = "0px";
			thumbScroller.style.top = "250px";
		}else{
			thumbScroller2.style.top = "-" + String(250-position[1])+"px";
			thumbScroller.style.top = String(position[1])+"px";
		}
		
		thumbScroller2.style.backgroundColor = "#000";
		thumbContainer.style.height = "250px";
		thumbContainer.style.width = "300px";
		thumbContainer.style.backgroundColor = "#000";
		thumbControls.style.top = "-40px";
		break;
	case "plist":
		thumbWidth = 140;
		thumbHeight = 105;
		container.style.width = "300px";
		thumbScroller.style.height = "110px";
		thumbScroller.style.top = "30px";
		thumbScroller.style.display = "inline-block";
		thumbScroller.style.float = "left";
		thumbScroller2.style.height = "110px";
		thumbScroller2.style.top = "30px";
		thumbScroller2.style.display = "inline-block";
		thumbScroller2.style.float = "left";
		thumbScroller3.style.height = "110px";
		thumbScroller3.style.top = "30px";
		thumbScroller3.style.display = "inline-block";
		thumbScroller3.style.float = "left";
		thumbScroller4.style.height = "110px";
		thumbScroller4.style.top = "30px";
		thumbScroller4.style.display = "inline-block";
		thumbScroller4.style.backgroundColor = "#FFF";
		thumbScroller4.style.float = "left";
		thumbContainer.style.height = "250px";
		thumbContainer.style.width = "300px";	
		thumbContainer.style.position = "relative";
		thumbContainer.style.textAlign = "left";
		thumbContainer.style.top = "0px";
		thumbControls.style.top = "-255px";
		thumbControls.style.display = "inline";
		thumbScroller2.style.backgroundColor = "#FFF";
		break;
	case "headline":
		thumbWidth = 290;
		thumbHeight = 15;
		step = 0;
		container.style.width = "300px";
		thumbScroller.style.height = "250px";
		thumbScroller.style.width = "300px";
		thumbContainer.style.height = "250px";
		thumbContainer.style.width = "300px";	
		thumbContainer.style.position = "relative";
		thumbControls.style.display = "none";
		thumbContainer.style.overflow = "visible";
		thumbScroller.style.overflow = "hidden";
		thumbControls.style.visibility = "hidden";
		break;
	case "horizontal500":
		thumbWidth = 120;
		thumbHeight = 85;
		thumbContainer.style.width = "505px";
		thumbContainer.style.height = "90px";
		thumbContainer.style.left = "16px";
		thumbControls.style.top = "-90px";
		container.removeChild(selector);
		break;
	case "horizontal400":
		thumbWidth = 120;
		thumbHeight = 85;
		thumbContainer.style.width = "385px";
		thumbContainer.style.height = "90px";
		thumbContainer.style.left = "14px";
		thumbControls.style.top = "-90px";
		container.removeChild(selector);
		break;
	}
}


getAsset = function (playlistNum,contentNum,assetType){
	for(m=0;m<playlistArr[playlistNum].Contents[contentNum].Assets.length;m++){
		if (playlistArr[playlistNum].Contents[contentNum].Assets[m].AssetType == assetType){
			var url = playlistArr[playlistNum].Contents[contentNum].Assets[m].AssetLocation.replace(/\\/gi,'/');
			return(	url);
		}
	}
}

var deviceAgent = navigator.userAgent.toLowerCase();
timerDown="";  
timerUp="";  

stopMe = function (){ 
clearTimeout(timerDown)  
clearTimeout(timerUp) 
} 

document.onmousemove=function(){stopMe()}  

autoScrollStart = function (){
	//$(".ndn_thumbScroller").stopTime('autoScroll');	
	$(".ndn_thumbContainer").everyTime(8000, 'autoScroll', function() {
		scrollDivDown("ndn_thumbScroller",true);														
	});
}

scrollDivDown = function (id,auto){
	if (auto == false){
		$(".ndn_thumbContainer").stopTime('autoScroll');	
		autoScroll = false;
	}
	if (thumbId == "slider"){
		$('#ndn_scrollLeft',_parent)[0].style.visibility = "visible";
		scrollCount++;
		if (scrollCount == lastThumb){
			scrollCount = 0;
				var scrollerWidth = 300*lastThumbNum;
				if (activeList == "ndn_thumbScroller"){
					activeList = "ndn_thumbScroller2";
					//thumbScroller2.style.left = String(loopCount*scrollerWidth)+"px";
					$('#ndn_thumbScroller2',_parent)[0].style.left = String(loopCount*scrollerWidth)+"px";
				}else{
					activeList = "ndn_thumbScroller";
					//thumbScroller.style.left = String(loopCount*scrollerWidth)+"px";
					$('#ndn_thumbScroller',_parent)[0].style.left = String(loopCount*scrollerWidth)+"px";
				}
			loopCount++;
		}
		$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'+=300px'},0,{duration:1000});
	}else if (thumbId == "apslider"){
		$('#ndn_scrollLeft',_parent)[0].style.visibility = "visible";
		scrollCount++;
		if (scrollCount == lastThumb){
			scrollCount = 0;
				var scrollerWidth = 300*lastThumbNum;
				if (activeList == "ndn_thumbScroller"){
					activeList = "ndn_thumbScroller2";
					//thumbScroller2.style.left = String(loopCount*scrollerWidth)+"px";
					$('#ndn_thumbScroller2',_parent)[0].style.left = String(loopCount*scrollerWidth)+"px";
				}else{
					activeList = "ndn_thumbScroller";
					//thumbScroller.style.left = String(loopCount*scrollerWidth)+"px";
					$('#ndn_thumbScroller',_parent)[0].style.left = String(loopCount*scrollerWidth)+"px";
				}
			loopCount++;
		}
		$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'+=300px'},0,{duration:1000});
	}else if (thumbId == "plist"){
		$('#ndn_scrollLeft',_parent)[0].style.visibility = "visible";
		scrollCount++;
		if (scrollCount == lastThumbNum/4){
			scrollCount = 0;
			var scrollerWidth = 147.5*lastThumbNum/2;
			if (activeList == "ndn_thumbScroller"){
				activeList = "ndn_thumbScroller3";
				$('#ndn_thumbScroller3',_parent)[0].style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
				$('#ndn_thumbScroller4',_parent)[0].style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
				//thumbScroller3.style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
				//thumbScroller4.style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
			}else{
				activeList = "ndn_thumbScroller";
				$('#ndn_thumbScroller',_parent)[0].style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
				$('#ndn_thumbScroller2',_parent)[0].style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
				//thumbScroller.style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
				//thumbScroller2.style.left = String(loopCount*(scrollerWidth - lastThumb))+"px";
			}
			loopCount++;
		}
		$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'+=294px'},0,{duration:1000});
	}else if (thumbId == "vertical"){
		if (scrollCount == 0){
			$(".ndn_thumbScroller",_parent).scrollTo({top:'+=565px', left:String(position[0])+'px'},0,{duration:1000});
			scrollCount = 1;
			if (firstScroll == true){
				if (lastThumb > 7){
					document.getElementById('thumb_ad_1').innerHTML = "";
					document.getElementById('thumb_ad_1').innerHTML = document.getElementById('thumb_ad_0').innerHTML;
				}
				firstScroll = false;
			}
		}
	}else if (thumbId == "horizontal500"){
		if (scrollCount < 1){
			$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'+=506px'},0,{duration:1000});	
			scrollCount++;
		}
		if (firstScroll == true){
			if (lastThumb > 5){
				document.getElementById('thumb_ad_1').innerHTML = "";
				document.getElementById('thumb_ad_1').innerHTML = document.getElementById('thumb_ad_0').innerHTML;
			}
			firstScroll = false;
		}
	}else if (thumbId == "horizontal400"){
		if (scrollCount < 2){
			$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'+=379px'},0,{duration:1000});	
			scrollCount++;
		}
		if (firstScroll == true){
			if (lastThumb > 4){
				document.getElementById('thumb_ad_1').innerHTML = "";
				document.getElementById('thumb_ad_1').innerHTML = document.getElementById('thumb_ad_0').innerHTML;
			}
			firstScroll = false;
		}else if (secondScroll == true){
			if (lastThumb == 6){
				document.getElementById('thumb_ad_2').innerHTML = "";
				document.getElementById('thumb_ad_2').innerHTML = document.getElementById('thumb_ad_0').innerHTML;
			}
			secondScroll = false;
		}
	}else{
		$('#'+id,_parent)[0].scrollTop+=step; 
	}
}

scrollDivUp = function (id,auto){ 
	if (auto == false){
		$(".ndn_thumbContainer").stopTime('autoScroll');		
		autoScroll = false;
	}
	if (thumbId == "slider"){
		if (scrollCount == 0){
			scrollCount = lastThumbNum;
			var scrollerWidth = 300*lastThumbNum;
			if (activeList == "ndn_thumbScroller"){
				activeList = "ndn_thumbScroller2";
				thumbScroller2.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
			}else{
				activeList = "ndn_thumbScroller";
				thumbScroller.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
			}
			loopCount--;
		}
		scrollCount--;
		if (scrollCount == 0 && loopCount == 1){
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "hidden";
		}else{
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "visible";
		}
		$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'-=300px'},0,{duration:1000});	
	}else if (thumbId == "apslider"){
		if (scrollCount == 0){
			scrollCount = lastThumbNum;
			var scrollerWidth = 300*lastThumbNum;
			if (activeList == "ndn_thumbScroller"){
				activeList = "ndn_thumbScroller2";
				thumbScroller2.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
			}else{
				activeList = "ndn_thumbScroller";
				thumbScroller.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
			}
			loopCount--;
		}
		scrollCount--;
		if (scrollCount == 0 && loopCount == 1){
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "hidden";
		}else{
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "visible";
		}
		$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'-=300px'},0,{duration:1000});	
	}else if (thumbId == "plist"){
		if (scrollCount == 0){
			scrollCount = lastThumbNum/4;
			var scrollerWidth = 147.5*lastThumbNum/2;
			if (activeList == "ndn_thumbScroller"){
				activeList = "ndn_thumbScroller3";
				thumbScroller3.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
				thumbScroller4.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
			}else{
				activeList = "ndn_thumbScroller";
				thumbScroller.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
				thumbScroller2.style.left = String((loopCount-2)*(scrollerWidth - lastThumb))+"px";
			}
			loopCount--;
		}
		scrollCount--;
		if (scrollCount == 0 && loopCount == 1){
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "hidden";
		}else{
			$('#ndn_scrollLeft',_parent)[0].style.visibility = "visible";
		}
		$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'-=294px'},0,{duration:1000});	
	}else if (thumbId == "vertical"){
		if (scrollCount == 1){
			$(".ndn_thumbScroller",_parent).scrollTo({top:'-=565px', left:String(position[0])+'px'},0,{duration:1000});	
			scrollCount = 0;
		}
	}else if (thumbId == "horizontal"){
		$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'-=685px'},0,{duration:1000});	
	}else if (thumbId == "horizontal500"){
		if (scrollCount > 0){
			$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'-=506px'},0,{duration:1000});	
			scrollCount--;
		}
	}else if (thumbId == "horizontal400"){
		if (scrollCount > 0){
			$(".ndn_thumbContainer",_parent).scrollTo({top:String(position[1])+'px', left:'-=379px'},0,{duration:1000});	
			scrollCount--;
		}
	}else{
		$('#'+id,_parent)[0].scrollTop-=step;  
	}	
} 

fitStringToWidth = function (str,width,className,height) {
  function _escTag(s){ return s.replace("<","&lt;").replace(">","&gt;");}

  //Create a span element that will be used to get the width
  var span = document.createElement("span");
  //Allow a classname to be set to get the right font-size.
  if (className) span.className=className;
  span.style.display='inline';
  span.style.visibility = 'hidden';
  span.style.padding = '0px';
  document.body.appendChild(span);

  var result = _escTag(str); // default to the whole string
  //var result = str; // default to the whole string
  span.innerHTML = result;
  // Check if the string will fit in the allowed width. NOTE: if the width
  // can't be determinated (offsetWidth==0) the whole string will be returned.
  //alert(span.offsetWidth + "     " + span.offsetHeight + "     " + width + "     " + result);
  if (span.offsetWidth > width || span.offsetHeight > height) {
    var posStart = 0, posMid, posEnd = str.length, posLength;
    // Calculate (posEnd - posStart) integer division by 2 and
    // assign it to posLength. Repeat until posLength is zero.
    while (posLength = (posEnd - posStart) >> 1) {
      posMid = posStart + posLength;
      //Get the string from the begining up to posMid;
      span.innerHTML = _escTag(str.substring(0,posMid)) + '&hellip;';

      // Check if the current width is too wide (set new end)
      // or too narrow (set new start)
	  
      if ( span.offsetWidth > width ) posEnd = posMid; else posStart=posMid;
    }

    result = '<abbr title="' +
      str.replace("\"","&quot;") + '">' +
      _escTag(str.substring(0,posStart)) +
      '&hellip;<\/abbr>';
  }
  document.body.removeChild(span);
  return result; }

loadThumbs = function (){
	var lotame = "";
	var div = document.createElement("div");
	div.src = 'http://ad.crwdcntrl.net/5/to=y/p=3046';
	 document.body.appendChild(div);
	//production
	$.GetDataFromURL('http://LT.ndnps.newsinc.com/launcher/show/'+freewheel+'/'+wid+'/'+cid+'/'+did, thumbServices);
	//dev http://dev.mps.newsinc.com/
	//$.GetDataFromURL('http://dev.mps.newsinc.com/launcher/show/'+freewheel+'/'+wid+'/'+cid+'/'+did, thumbServices);
	rdm = String(Math.floor(Math.random()*1000000000));
	GAC = GetAnalyticsUserToken();
	if (GAC == null){
		GAC = SetAnalyticsCookie();
	}
	analyticsString = String("http://sana.newsinc.com/sana.html?wid="+wid+"&uut="+GAC+"&furl="+furl+"&purl=&ssid="+sitesection+"&anid="+freewheel+"&ltype="+ltype+"&plid="+cid+"&device="+did+"&rdm="+rdm);
	loadPage('swfviewFRM', null,analyticsString);
}

//Browser Detection
var BrowserDetect = {
	init: function () {
		this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
		this.version = this.searchVersion(navigator.userAgent)
			|| this.searchVersion(navigator.appVersion)
			|| "an unknown version";
		this.OS = this.searchString(this.dataOS) || "an unknown OS";
	},
	searchString: function (data) {
		for (var i=0;i<data.length;i++)	{
			var dataString = data[i].string;
			var dataProp = data[i].prop;
			this.versionSearchString = data[i].versionSearch || data[i].identity;
			if (dataString) {
				if (dataString.indexOf(data[i].subString) != -1)
					return data[i].identity;
			}
			else if (dataProp)
				return data[i].identity;
		}
	},
	searchVersion: function (dataString) {
		var index = dataString.indexOf(this.versionSearchString);
		if (index == -1) return;
		return parseFloat(dataString.substring(index+this.versionSearchString.length+1));
	},
	dataBrowser: [
		{
			string: navigator.userAgent,
			subString: "Chrome",
			identity: "Chrome"
		},
		{ 	string: navigator.userAgent,
			subString: "OmniWeb",
			versionSearch: "OmniWeb/",
			identity: "OmniWeb"
		},
		{
			string: navigator.vendor,
			subString: "Apple",
			identity: "Safari",
			versionSearch: "Version"
		},
		{
			prop: window.opera,
			identity: "Opera"
		},
		{
			string: navigator.vendor,
			subString: "iCab",
			identity: "iCab"
		},
		{
			string: navigator.vendor,
			subString: "KDE",
			identity: "Konqueror"
		},
		{
			string: navigator.userAgent,
			subString: "Firefox",
			identity: "Firefox"
		},
		{
			string: navigator.vendor,
			subString: "Camino",
			identity: "Camino"
		},
		{		// for newer Netscapes (6+)
			string: navigator.userAgent,
			subString: "Netscape",
			identity: "Netscape"
		},
		{
			string: navigator.userAgent,
			subString: "MSIE",
			identity: "Explorer",
			versionSearch: "MSIE"
		},
		{
			string: navigator.userAgent,
			subString: "Gecko",
			identity: "Mozilla",
			versionSearch: "rv"
		},
		{ 		// for older Netscapes (4-)
			string: navigator.userAgent,
			subString: "Mozilla",
			identity: "Netscape",
			versionSearch: "Mozilla"
		}
	],
	dataOS : [
		{
			string: navigator.platform,
			subString: "Win",
			identity: "Windows"
		},
		{
			string: navigator.platform,
			subString: "Mac",
			identity: "Mac"
		},
		{
			string: navigator.platform,
			subString: "iPod",
			identity: "iPod"
		},
		{
			string: navigator.platform,
			subString: "iPhone",
			identity: "iPhone"
		},
		{
			string: navigator.platform,
			subString: "iPad",
			identity: "iPad"
		},
		{
			string: navigator.platform,
			subString: "Linux",
			identity: "Linux"
		},
		{
			string: navigator.userAgent,
			subString: "iPhone",
			identity: "iPhone/iPod"
		}
	]

};
BrowserDetect.init();

// used in SWF view call

loadPage = function (id, nestref, url) {
	if ($('#' + id).length > 0) {
		$('#' + id).remove();
	}
	var frame = document.createElement("iframe");
	frame.id = id;
	frame.src = url;
	frame.height = 0;
	frame.width = 0;
	document.getElementsByTagName('body')[0].appendChild(frame);
}

document.write(unescape("%3Cscript src='" +
(document.location.protocol == "https:" ? "https://sb" : "http://b") +
".scorecardresearch.com/beacon.js' %3E%3C/script%3E"));
var myC5 = "09";
function callComscore(){
	COMSCORE.beacon({
	c1:1,
	c2: "11112732",
	c3: DistributorName,
	c4: playlistArr[activePlaylist].Contents[activeContent].ProducerName,
	c5: myC5,
	c6: playlistArr[activePlaylist].Contents[activeContent].ProducerCategory,
	c10: ""
	});
}
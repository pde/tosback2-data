/*1345154624,173213213*/

if (window.CavalryLogger) { CavalryLogger.start_js(["FLSOT"]); }

function AppUseTracker(){if(!AppUseTracker.instance)AppUseTracker.instance=this;return AppUseTracker.instance;}copyProperties(AppUseTracker.prototype,{instance:null,endpoint:'/ajax/apps/usage_update.php',INITIAL_PING:0,ONGOING_PING:1,DISCOVERY_PING:2,ENDING_PING:3,_application_id:0,_is_game:0,_do_log_on_session_end:0,_createRequest:function(a){return new AsyncRequest().setURI(this.endpoint).setMethod('POST').setData({app:this._application_id,is_game:this._is_game,type:a,condition:this._signal_on_page_transition});},init:function(a,b,c,d,e,f){if(window!=window.top)return;this.cleanup();PageTransitions.registerHandler(this.catchPageTransition.bind(this));this._application_id=a;this._is_game=b;this._do_log_on_session_end=f;this._timers.push(setTimeout(function(){this._createRequest(this.INITIAL_PING).send();var g=this._createRequest(this.ONGOING_PING);this._timers.push(setInterval(g.send.bind(g),d));}.bind(this),c));if(e)this._timers.push(setTimeout(function(){this._createRequest(this.DISCOVERY_PING).send();}.bind(this),e));if(this._do_log_on_session_end)onbeforeunloadRegister(this.onBeforeUnload.bind(this));},catchPageTransition:function(a){if(this._do_log_on_session_end)this._createRequest(this.ENDING_PING).send();this.cleanup();},onBeforeUnload:function(){if(this._do_log_on_session_end)this._createRequest(this.ENDING_PING).setOption('asynchronous',false).send();this.cleanup();},cleanup:function(){if(this._timers)for(i=0;i<this._timers.length;i++)clearInterval(this._timers[i]);this._timers=[];this._do_log_on_session_end=0;}});
__d("sprintf",[],function(a,b,c,d,e,f){function g(h,i){i=Array.prototype.slice.call(arguments,1);var j=0;return h.replace(/%s/g,function(k){return i[j++];});}e.exports=g;});
__d("Log",["sprintf"],function(a,b,c,d,e,f){var g=b('sprintf'),h={DEBUG:3,INFO:2,WARNING:1,ERROR:0};function i(k,l){var m=Array.prototype.slice.call(arguments,2),n=g.apply(null,m);if(j.level>=k&&window.console)console[l in console?l:'log'](n);}var j={level:-1,Level:h,debug:i.bind(null,h.DEBUG,'debug'),info:i.bind(null,h.INFO,'debug'),warn:i.bind(null,h.WARNING,'debug'),error:i.bind(null,h.ERROR,'debug')};e.exports=j;});
__d("resolveWindow",[],function(a,b,c,d,e,f){function g(h){var i=window,j=h.split('.');try{for(var l=0;l<j.length;l++){var m=j[l],n=/^frames\[['"]?([a-zA-Z0-9\-_]+)['"]?\]$/.exec(m);if(n){i=i.frames[n[1]];}else if(m==='opener'||m==='parent'||m==='top'){i=i[m];}else return null;}}catch(k){return null;}return i;}e.exports=g;});
__d("XD",["function-extensions","Arbiter","DOM","DOMDimensions","Log","URI","UserAgent","copyProperties","isInIframe","resolveWindow"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('DOM'),i=b('DOMDimensions'),j=b('Log'),k=b('URI'),l=b('UserAgent'),m=b('copyProperties'),n=b('isInIframe'),o=b('resolveWindow'),p='fb_xdm_frame_'+location.protocol.replace(':',''),q={_callbacks:[],_opts:{autoResize:false,allowShrink:true,channelUrl:null,hideOverflow:false,resizeTimeout:100,resizeWidth:false,expectResizeAck:false,resizeAckTimeout:6000},_lastResizeAckId:0,_resizeCount:0,_resizeTimestamp:0,_shrinker:null,init:function(s){this._opts=m(m({},this._opts),s);if(this._opts.autoResize)this._startResizeMonitor();g.subscribe('Connect.Unsafe.resize.ack',function(t,u){if(!u.id)u.id=this._resizeCount;if(u.id>this._lastResizeAckId)this._lastResizeAckId=u.id;}.bind(this));},send:function(s,t){t=t||this._opts.channelUrl;if(!t)return;var u={},v=new k(t);m(u,s);m(u,k.explodeQuery(v.getFragment()));var w=new k(u.origin),x=w.getDomain()+(w.getPort()?':'+w.getPort():''),y=o(u.relation.replace(/^parent\./,'')),z=y.frames[p];z?z.proxyMessage(k.implodeQuery(u),[x]):j.warn('No such frame "'+p+'" to proxyMessage to');},_computeSize:function(){var s=i.getDocumentDimensions(),t=0;if(this._opts.resizeWidth){var u=document.body;if(u.clientWidth<u.scrollWidth){t=s.width;}else{var v=u.childNodes;for(var w=0;w<v.length;w++){var x=v[w],y=x.offsetLeft+x.offsetWidth;if(y>t)t=y;}}t=Math.max(t,q.forced_min_width);}s.width=t;if(this._opts.allowShrink){if(!this._shrinker)this._shrinker=h.create('div');h.appendContent(document.body,this._shrinker);s.height=Math.max(this._shrinker.offsetTop,0);}return s;},_startResizeMonitor:function(){var s,t=document.documentElement;if(this._opts.hideOverflow){t.style.overflow='hidden';document.body.style.overflow='hidden';}setInterval((function(){var u=this._computeSize(),v=Date.now(),w=this._lastResizeAckId<this._resizeCount&&(v-this._resizeTimestamp)>this._opts.resizeAckTimeout;if(!s||(this._opts.expectResizeAck&&w)||(this._opts.allowShrink&&s.width!=u.width)||(!this._opts.allowShrink&&s.width<u.width)||(this._opts.allowShrink&&s.height!=u.height)||(!this._opts.allowShrink&&s.height<u.height)){s=u;this._resizeCount++;this._resizeTimestamp=v;var x={type:'resize',height:u.height,ackData:{id:this._resizeCount}};if(u.width&&u.width!=0)x.width=u.width;try{if(k(document.referrer).isFacebookURI()&&n()&&window.name&&window.parent.location&&window.parent.location.toString&&k(window.parent.location).isFacebookURI()){var z=window.parent.document.getElementsByTagName('iframe');for(var aa=0;aa<z.length;aa=aa+1)if(z[aa].name==window.name){if(this._opts.resizeWidth)z[aa].style.width=x.width+'px';z[aa].style.height=x.height+'px';}}this.send(x);}catch(y){this.send(x);}}}).bind(this),this._opts.resizeTimeout);}},r=m({},q);e.exports.UnverifiedXD=r;e.exports.XD=q;a.UnverifiedXD=r;a.XD=q;});
__d("legacy:connect-xd",["XD"],function(a,b,c,d){a.UnverifiedXD=b('XD').UnverifiedXD;a.XD=b('XD').XD;},3);
__d("legacy:primer",["Primer"],function(a,b,c,d){b('Primer');},3);
__d("legacy:startsWith",["startsWith"],function(a,b,c,d){a.startsWith=b('startsWith');},3);
if(!window.CommentAdminPanelController){window.CommentAdminPanelController=function(a){copyProperties(this,{locale:a.locale,channel:a.channel,controllerID:a.controllerID,commentIDs:a.commentIDs,domIDs:a.domIDs,duplicateComments:[],fetchMoreCommentsIsPending:{},blacklistedActors:a.blacklistedActors,actorToCommentInfoMap:a.actorToCommentIDMap,commentInfoMap:a.commentInfoMap,inAggregatedView:a.inAggregatedView,inModerationQueue:a.inModerationQueue,inContextualDialog:a.inContextualDialog,isTopLevelCommentPollingEnabled:false,loggedIn:a.loggedIn,newestCommentTimestamp:a.newestCommentTimestamp,realTimePollingParams:{},userOwnsPages:a.userOwnsPages,recentlyBlacklistedActors:a.blacklistedActors});Arbiter.subscribe(ChannelConstants.getArbiterType('comments_plugin_new_post'),function(b,c){if(c.obj.target===this.realTimePollingParams.target){if(ge(c.obj.comment_element_id))return;var d=copyProperties({},this.realTimePollingParams);d.post_fbid=c.obj.post_fbid;var e=c.obj.parent_comment_id;if(e){var f=ge(e);if(!f)return;var g=DOM.scry(f,'.fbFeedbackPager.uiMorePager');if(g.length>0)return;d.parent_comment_id=e;d.is_reply_thread=true;}else{if(!this.isTopLevelCommentPollingEnabled)return;d.is_reply_thread=false;}this.pollForComments(d);}}.bind(this));this.controlledRegion=$(this.controllerID);this.attachClickHandlers();if(this.inModerationQueue)this.registerModeratorQueueHandlers(true);if(this.inContextualDialog)this.attachContextualDialogHandlers();if(!this.inAggregatedView)UnverifiedXD.init({autoResize:true,channelUrl:a.channel,hideOverflow:true,resizeWidth:false});};copyProperties(CommentAdminPanelController,{allControllers:{},mainController:null,contextualControllers:{},initController:function(a){var b=new CommentAdminPanelController(a),c=a.controllerID;CommentAdminPanelController.allControllers[c]=b;if(b.inContextualDialog){CommentAdminPanelController.contextualControllers[c]=b;}else CommentAdminPanelController.mainController=b;},syncController:function(a,b){var c=CommentAdminPanelController.allControllers[a];c.attachClickHandlers();if(!c.isControllingModerationQueue())return;c.deselectComments(b);c.registerModeratorQueueHandlers(false);c.synchronizeModeratorQueueUI();},resetController:function(a){var b=CommentAdminPanelController.allControllers[a];b.resetController();},appendComments:function(a,b,c){var d=CommentAdminPanelController.allControllers[a];d.appendComments(b,c);},prependComments:function(a,b,c){var d=CommentAdminPanelController.allControllers[a];d.prependComments(b,c);},updateController:function(a,b,c,d,e,f,g){var h=CommentAdminPanelController.allControllers[a];h.updateController(b,c,d,e,f,g);if(!CommentAdminPanelController.mainController.loggedIn)MultiLoginPopup.reattachLoginInterceptors();if(!h.isControllingModerationQueue())return;h.registerModeratorQueueHandlers(false);h.synchronizeModeratorQueueUI();},updatePollingParamsCommentas:function(a,b){var c=CommentAdminPanelController.allControllers[a];c.updatePollingParamsCommentas(b);},registerMoreCommentsLinkHandler:function(a,b){var c=CommentAdminPanelController.allControllers[a];c.registerMoreCommentsLinkHandler(b);},setRealTimePollingParams:function(a,b){var c=CommentAdminPanelController.allControllers[a];c.setRealTimePollingParams(b);},enableTopLevelCommentPolling:function(a){var b=CommentAdminPanelController.allControllers[a];b.enableTopLevelCommentPolling();},disableTopLevelCommentPolling:function(a){var b=CommentAdminPanelController.allControllers[a];b.disableTopLevelCommentPolling();},replaceContentMaybe:function(a,b){var c=DOM.scry(document.documentElement,a)[0];if(c)DOM.replace(c,b);},notifyCommentCreated:function(a){if(!CommentAdminPanelController.mainController.channel)return;UnverifiedXD.send({type:'commentCreated',href:a.href,parentCommentID:a.parentCommentID,commentID:a.commentID});},notifyCommentRemoved:function(a){if(!CommentAdminPanelController.mainController.channel)return;UnverifiedXD.send({type:'commentRemoved',href:a.href,commentID:a.commentID});},markAsShowingAllReplies:function(a){var b=a+' a.fbUpDownVoteOption',c=DOM.scry(document.documentElement,b),d=a+' li.fbUpDownVoteOption a.itemAnchor',e=DOM.scry(document.documentElement,d),f=c.concat(e);for(var g=0;g<f.length;g++){var h=f[g],i=new URI(h.getAttribute('ajaxify'));i.addQueryData({show_all_replies:1});h.setAttribute('ajaxify',i.toString());}},setLoggedIn:function(a){CommentAdminPanelController.mainController.loggedIn=a;}});copyProperties(CommentAdminPanelController.prototype,{isControllingModerationQueue:function(){var a=this==CommentAdminPanelController.mainController&&this.inModerationQueue;return a;},resetController:function(){this.commentIDs=[];this.domIDs=[];},updateController:function(a,b,c,d,e,f){a.forEach(function(h){this.commentIDs.push(h);},this);b.forEach(function(h){this.domIDs.push(h);},this);copyProperties(this.blacklistedActors,d);for(var g in e){if(!this.actorToCommentInfoMap[g])this.actorToCommentInfoMap[g]=[];e[g].forEach(function(h){this.actorToCommentInfoMap[g].push(h);},this);}this.newestCommentTimestamp=Math.max(this.newestCommentTimestamp,c);copyProperties(this.commentInfoMap,f);this.attachClickHandlers();},updatePollingParamsCommentas:function(a){this.realTimePollingParams.commentas=a;},attachClickHandlers:function(){for(var a=0;a<this.domIDs.length;a++){var b='li[id="'+this.domIDs[a]+'"]',c=DOM.scry(this.controlledRegion,b);if(c.length===0)continue;var d=c[0],e=DOM.scry(d,'a.uiCloseButton');Event.listen(d,'mouseleave',this.closeStickyMenuFlyouts.bind(this,e));var f=DOM.scry(d,'.fbModerateDropdownContainer');if(f.length>0){var g=f[0],h=DOM.find(g,'.fbModerateDropdownLink');Event.listen(h,'mouseover',function(q,event){CSS.addClass(q,'fbUnderlineText');}.curry(h));Event.listen(h,'mouseout',function(q,event){CSS.removeClass(q,'fbUnderlineText');}.curry(h));var i=DOM.find(g,'.fbModerationDropdownList');Event.listen(h,'click',this.exposeDropDownMenu.bind(this,h,i));Event.listen(i.parentNode,'mouseleave',this.concealDropDownMenu.bind(this,h,i));this.attachDropDownHandlers(d,this.commentIDs[a],i);}var j=this.commentInfoMap[this.commentIDs[a]].actor,k=!!this.recentlyBlacklistedActors[j];if(k){var l=DOM.scry(d,'.fbUndoBlacklistLink');if(l.length>0){var m=l[0];Event.listen(m,'click',this.toggleBlackListAndSync.bind(this,this.commentIDs[a]));}}}var n=DOM.scry(this.controlledRegion,'.fbReplyButton'),o=DOM.scry(this.controlledRegion,'.fbReplyAfterLoginButton');for(var p=0;p<n.length;p++)if(this.loggedIn){CSS.show(n[p]);CSS.hide(o[p]);}else{CSS.hide(n[p]);CSS.show(o[p]);}},closeStickyMenuFlyouts:function(a,event){Toggler.hide();for(var b=0;b<a.length;b++)a[b].blur();},attachDropDownHandlers:function(a,b,c){var d=DOM.scry(c,'.fbBanUser');if(d.length>0){var e=d[0],f=DOM.find(e,'^.fbFeedbackPost');if(startsWith(f.id,b))Event.listen(e,'click',this.toggleBlackListAndSync.bind(this,b));}},exposeDropDownMenu:function(a,b,event){if(CSS.shown(b))return this.concealDropDownMenu(a,b,event);Event.stop(event);CSS.show(b);b.focus();a.blur();return false;},concealDropDownMenu:function(a,b,event){Event.stop(event);CSS.removeClass(a,'fbUnderlineText');CSS.hide(b);a.blur();return false;},registerMoreCommentsLinkHandler:function(a){var b=a.pager_id;if(!ge(b))return;var c=$(b);Event.listen(c,'click',this.fetchMoreComments.bind(this,a,c));},deselectComments:function(a){for(var b=0;b<a.length;b++)delete this.selectedCommentsMap[a[b]];},registerModeratorQueueHandlers:function(a){if(a)this.selectedCommentsMap={};this.selectableComments=this.findSelectableComments();this.selectableCheckboxes=[];this.selectAllCheckBoxes=DOM.scry(this.controlledRegion,'.fbSelectAllCheckbox');this.approveButtons=DOM.scry(this.controlledRegion,'.fbApproveButton');this.removeButtons=DOM.scry(this.controlledRegion,'.fbRemoveButton');for(var b=0;b<this.selectableComments.length;b++){var c=this.selectableComments[b].id,d=!!this.selectedCommentsMap[c];this.setCommentSelection(this.selectableComments[b],d);var e=DOM.find(this.selectableComments[b],'.fbCommentCheckbox');Event.listen(e,'click',this.toggleCommentSelection.bind(this));Event.listen(this.selectableComments[b],'click',this.toggleCommentSelection.bind(this));e.checked=d;this.selectableCheckboxes.push(e);}for(var f=0;f<this.selectAllCheckBoxes.length;f++){this.selectAllCheckBoxes[f].checked=false;this.selectAllCheckBoxes[f].disabled=this.selectableComments.length===0;Event.listen(this.selectAllCheckBoxes[f],'click',this.toggleSelectAllCheckbox.bind(this,this.selectAllCheckBoxes[f]));}for(var g=0;g<this.approveButtons.length;g++)Event.listen(this.approveButtons[g],'click',this.setBulkPrivacy.bind(this,false));for(var h=0;h<this.removeButtons.length;h++)Event.listen(this.removeButtons[h],'click',this.setBulkPrivacy.bind(this,true));},findSelectableComments:function(){var a=DOM.scry(this.controlledRegion,'.fbTopLevelComment'),b=[];for(var c=0;c<a.length;c++)if((DOM.scry(a[c],'.fbCommentCheckbox').length===1)&&(DOM.scry(a[c],'.fbCommentOverlay').length===0))b.push(a[c]);return b;},toggleCommentSelection:function(event){var a={a:true},b=event.getTarget(),c=b.tagName.toLowerCase(),d=b.parentNode.tagName.toLowerCase();if(a[c]||a[d])return;var e=CSS.hasClass(b,'fbFeedbackPost')?b:DOM.find(b,'^.fbFeedbackPost'),f=this.commentIsSelected(e),g=!f;this.setCommentSelection(e,g);this.synchronizeModeratorQueueUI();if(CSS.hasClass(b,'fbCommentCheckbox'))Event.stop(event);},commentIsSelected:function(a){return CSS.hasClass(a,'fbCommentSelected');},setCommentSelection:function(a,b){if(b){this.selectComment(a);}else this.deselectComment(a);},selectComment:function(a){CSS.addClass(a,'fbCommentSelected');this.selectedCommentsMap[a.id]=true;DOM.find(a,'.fbCommentCheckbox').checked=true;},deselectComment:function(a){CSS.removeClass(a,'fbCommentSelected');delete this.selectedCommentsMap[a.id];DOM.find(a,'.fbCommentCheckbox').checked=false;},toggleSelectAllCheckbox:function(a,event){Event.stop(event);var b=a.checked;for(var c=0;c<this.selectableComments.length;c++){this.setCommentSelection(this.selectableComments[c],a.checked);this.selectableCheckboxes[c].checked=b;}this.synchronizeBulkModerationCheckboxes(b);this.synchronizeBulkModerationButtons(b);},synchronizeModeratorQueueUI:function(){var a=0;for(var b=0;b<this.selectableCheckboxes.length;b++)if(this.selectableCheckboxes[b].checked)a++;var c=this.selectableCheckboxes.length>0&&a==this.selectableCheckboxes.length;this.synchronizeBulkModerationCheckboxes(c);this.synchronizeBulkModerationButtons(a>0);},synchronizeBulkModerationCheckboxes:function(a){for(var b=0;b<this.selectAllCheckBoxes.length;b++)this.selectAllCheckBoxes[b].checked=a;},synchronizeBulkModerationButtons:function(a){for(var b=0;b<this.approveButtons.length;b++)Button.setEnabled(this.approveButtons[b],a);for(var c=0;c<this.removeButtons.length;c++)Button.setEnabled(this.removeButtons[c],a);},setBulkPrivacy:function(a,event){Event.stop(event);this.synchronizeBulkModerationButtons(false);selectedCommentIDs=[];for(var b in this.selectedCommentsMap)selectedCommentIDs.push(b);var c={is_private:a,in_moderation_queue:true,comment_ids:selectedCommentIDs,uniqids:selectedCommentIDs,controller_id:this.controllerID,locale:this.locale,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new AsyncRequest().setURI('/ajax/connect/comments/set_bulk_private.php').setData(c).send();return false;},toggleBlackListAndSync:function(a,event){Event.stop(event);var b=this.commentInfoMap[a].actor,c={blacklist:!this.blacklistedActors[b],in_moderation_queue:this.inModerationQueue,comment_id:a,other_comment_ids:this.getOtherCommentsByActor(b,a),uniqid:a,controller_id:this.controllerID,locale:this.locale,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new AsyncRequest().setURI('/ajax/connect/comments/set_blacklist.php').setData(c).setHandler(function(d){this.blacklistedActors[b]=!this.blacklistedActors[b];if(this.blacklistedActors[b]){this.recentlyBlacklistedActors[b]=true;}else delete this.recentlyBlacklistedActors[b];}.bind(this)).send();return false;},getOtherCommentsByActor:function(a,b){return this.actorToCommentInfoMap[a].filter(function(c){return c!=b;});},fetchMoreComments:function(a,b,event){Event.kill(event);CSS.addClass(b,'async_saving');if(this.fetchMoreCommentsIsPending[a.pager_id]===true)return;this.fetchMoreCommentsIsPending[a.pager_id]=true;var c={is_reply_thread:false,in_moderation_queue:false,view_as_moderator:false};copyProperties(c,a);c.recently_blacklisted=this.getRecentlyBlacklistedActors();c.offset=this.getVisibleCommentCount(c);if(!c.aggregate_view)delete c.aggregate_view;if(!c.comment_id)delete c.comment_id;if(!c.is_reply_thread)c.comment_ids=this.commentIDs;new AsyncRequest().setURI('/ajax/connect/feedback.php').setReadOnly(true).setData(c).setHandler(function(d){this.fetchMoreCommentsIsPending[a.pager_id]=false;}.bind(this)).send();},getVisibleCommentCount:function(a){var b=this.getCommentsSelector(a),c=this.getCollapsedCommentsSelector(a),d=DOM.scry($(a.controller_id),b);d=d.concat(DOM.scry($(a.controller_id),c));var e=0;for(var f=0;f<d.length;f++)if(!CSS.hasClass(d[f],'fbCommentIgnored'))e++;return e;},getCommentsSelector:function(a){var b=a.is_reply_thread?'li.fbCommentReply':'li.fbTopLevelComment';if(a.controller_id!=a.uniqid)b='div[id="'+a.uniqid+'"] '+b;return b;},getCollapsedCommentsSelector:function(a){var b=a.is_reply_thread?'div.fbCommentReply':'div.fbTopLevelComment';if(a.controller_id!=a.uniqid)b='div[id="'+a.uniqid+'"] '+b;return b;},getRecentlyBlacklistedActors:function(){var a=[];for(var b in this.recentlyBlacklistedActors)a.push(b);return a;},attachContextualDialogHandlers:function(){this.documentClickListener=Event.listen(document.documentElement,'click',this.closeContextualDialog.bind(this));},closeContextualDialog:function(event){var a=event.getTarget(),b=Parent.byClass(a,'fbCommentContext');if(!b)this.destroyContextualDialog();},destroyContextualDialog:function(){this.documentClickListener.remove();delete this.documentClickListener;var a=this.controllerID;Feedback.closeContextualDialog(a);},setRealTimePollingParams:function(a){this.realTimePollingParams=a;},enableTopLevelCommentPolling:function(){this.isTopLevelCommentPollingEnabled=true;},disableTopLevelCommentPolling:function(){this.isTopLevelCommentPollingEnabled=false;},appendComments:function(a,b){var c=ge(a);if(!c)return;var d=DOM.scry(c,'.fbFeedbackReplies')[0];if(!d)return;DOM.appendContent(d,b);},prependComments:function(a,b){var c=DOM.scry(document.documentElement,a)[0];if(!c)return;var d=b.getNodes(),e=[];for(var f=d.length;f-->0;){var g={id:DOM.getID(d[f]),element:d[f]};e.push(g);var h=ge(g.id);if(h){CSS.hide(g.element);this.duplicateComments.push(g.element);for(var i=0;i<e.length;++i)DOM.insertAfter(h,e[i].element);e=[];}}for(f=0;f<e.length;++f)DOM.prependContent(c,e[f].element);setTimeout(this.removeDuplicateComments.bind(this),0);},removeDuplicateComments:function(){for(var a=0;a<this.duplicateComments.length;++a)DOM.remove(this.duplicateComments[a]);this.duplicateComments=[];},pollForComments:function(a){data={locale:this.locale};copyProperties(data,a);if(!data.is_reply_thread)data.comment_ids=this.commentIDs;data.newest_comment_timestamp=this.newestCommentTimestamp;handler=this.handlePollResponse.bind(this);errorHandler=this.handlePollError.bind(this);finallyHandler=this.handlePollFinally.bind(this);new AsyncRequest().setURI('/plugins/comments/poll').setReadOnly(true).setData(data).setMethod('GET').setHandler(handler).setErrorHandler(errorHandler).setFinallyHandler(finallyHandler).send();},handlePollResponse:function(a){},handlePollError:function(a){},handlePollFinally:function(a){}});}
WindowComm={_callbacks:{},makeHandler:function(a,b){b=b||'opener';var c='f'+(Math.random()*(1<<30)).toString(16).replace('.','');WindowComm._callbacks[c]=a;return new URI('/connect/window_comm.php').setQueryData({_id:c,_relation:b}).getQualifiedURI().toString();},_recv:function(a){var b=new URI(a).getQueryData();WindowComm._callbacks[b._id](b);}};
__d("PopupWindow",["DOMDimensions","DOMQuery","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('DOMDimensions'),h=b('DOMQuery'),i=b('UserAgent'),j=b('copyProperties'),k={_opts:{allowShrink:true,strategy:'vector',timeout:100,widthElement:null},init:function(l){j(k._opts,l);setInterval(k._resizeCheck,k._opts.timeout);},_resizeCheck:function(){var l=g.getViewportDimensions(),m=k._getDocumentSize(),n=m.height-l.height,o=m.width-l.width;if(o<0&&!k._opts.widthElement)o=0;o=o>1?o:0;if(!k._opts.allowShrink&&n<0)n=0;if(n||o)try{window.console&&window.console.firebug;window.resizeBy(o,n);if(o)window.moveBy(o/-2,0);}catch(p){}},_getDocumentSize:function(){var l=g.getDocumentDimensions();if(k._opts.strategy==='offsetHeight')l.height=document.body.offsetHeight;if(k._opts.widthElement){var m=h.scry(document.body,k._opts.widthElement)[0];if(m)l.width=g.getElementDimensions(m).width;}if(window.Dialog&&Dialog.max_bottom&&Dialog.max_bottom>l.height)l.height=Dialog.max_bottom;return l;},open:function(l,m,n){var o=typeof window.screenX!='undefined'?window.screenX:window.screenLeft,p=typeof window.screenY!='undefined'?window.screenY:window.screenTop,q=typeof window.outerWidth!='undefined'?window.outerWidth:document.body.clientWidth,r=typeof window.outerHeight!='undefined'?window.outerHeight:(document.body.clientHeight-22),s=parseInt(o+((q-n)/2),10),t=parseInt(p+((r-m)/2.5),10),u=('width='+n+',height='+m+',left='+s+',top='+t);return window.open(l,'_blank',u);}};e.exports=k;});
__d("legacy:popup-resizer",["PopupWindow"],function(a,b,c,d){a.PopupResizer=b('PopupWindow');},3);
ConnectLogin={init:function(a){this.appID=a.appID;this.addToProfile=a.addToProfile;this.oneClick=a.oneClick;this.channelUrl=a.channelUrl;XD.init(a);},login:function(a,b,c){if(this.oneClick&&!b){this._oneClick(a);}else this._openPopup(a,b,c);},logout:function(){XD.send({type:'logout'});},_oneClick:function(a){new AsyncRequest().setURI('/ajax/api/tos.php').setData({app_id:this.appID,grant_perm:1}).setHandler(function(b){ConnectLogin._refreshLoginStatus();a&&a();}).send();},_openPopup:function(a,b,c){c=c||{};var d=WindowComm.makeHandler(function(h){ConnectLogin._closePopup();if(ConnectLogin.appID)ConnectLogin._refreshLoginStatus();a&&a();}),e=WindowComm.makeHandler(function(h){ConnectLogin._closePopup();}),f=new URI('/login.php');f.setQueryData({api_key:this.appID,next:d,channel_url:e,cancel_url:e,req_perms:b,v:'1.0',fbconnect:1,add_to_profile:this.addToProfile,display:'popup'});f.addQueryData(c);var g=this._getSize(c);this._popup=PopupResizer.open(f.toString(),g.height,g.width);},_closePopup:function(){if(this._popup){this._popup.close();this._popup=null;}},_refreshLoginStatus:function(){if(this.channelUrl){XD.send({type:'refreshLoginStatus'});}else window.location.reload();},_getSize:function(a){if(a.social_plugin=='registration'){return {width:640,height:370};}else return {width:610,height:280};}};
add_properties('Feedback',{registerComment:function(a,b){Feedback.comments[a]=b;return Feedback;},getRegisteredComment:function(a){return Feedback.comments[a];},deleteClickHandler:function(a,b,c,d,e,f){var g=new Dialog().setTitle("Delete post?").setBody("Are you sure you want to delete this post?").setButtons([Dialog.newButton('delete',"Delete"),Dialog.CANCEL]).setHandler(function(event){new AsyncRequest().setURI('/ajax/connect/feedback.php').setData({command:'delete',url:a,uniqid:d,owns_pages:e,controller_id:c,locale:f,comment_id:b}).send();}.bind(this)).show();},resizeCommentas:function(a){var b=DOM.scry(a,'div.post')[0];if(b){var c=Vector2.getElementDimensions(b).x;if(c){var d=DOM.find(b,'.commentas'),e=Vector2.getElementDimensions(d).x;if((c-e)<190&&(c-190)>60){Style.set(d,'width',c-190+'px');var f=DOM.scry(d,'span.commentas_inner')[0];if(f){var g=Vector2.getElementDimensions(f).x;Style.set(d,'width',g+'px');}}}}},exposeContextualDialogReply:function(a){var b=$(a),c=b.parentNode.parentNode;CSS.show(DOM.find(c,"form"));DOM.find(c,"textarea").focus();return false;},concealContextualDialogReply:function(a){var b=$(a),c=b.parentNode.parentNode,d=DOM.find(c,"form"),e=DOM.find(c,"textarea"),f=e.value.length;if(!Input.getValue(e))CSS.hide(d);return false;},closeContextualDialog:function(a){var b=ContextualDialogX.getInstance($(a));b.hide();return false;},_clickLocked:false,attachOptInClickListener:function(a){Event.listen(a,'click',function(b){Event.kill(b);if(!this._clickLocked){this._clickLocked=true;setTimeout(function(){this._clickLocked=false;}.bind(this),1000);PlatformOptInPopup.open('feedback','opt.in');}});},attachReplyListener:function(a){if(!a)return;var b=DOM.find(a,'textarea');a.suppressBlur=false;Event.listen(a,'click',function(c){var d=c.getTarget(),e=Parent.byClass(d,'commentas')!==null,f=Parent.byClass(d,'uiButton')!==null,g=Parent.byClass(d,'uiSelector')!==null;a.suppressBlur=e||f||g;});Event.listen(b,'blur',function(c,d){if(a.interval)return;a.interval=setInterval((function(e,f){if(e.suppressBlur||Input.getValue(f)||f==document.activeElement)return;CSS.hide(e);e.suppressBlur=false;clearInterval(e.interval);delete e.interval;}).curry(a,c),100);}.curry(b));},attachReplyClickListener:function(a,b,c){if(!a)return;var d=DOM.find(a,'textarea');Event.listen(b,'click',function(e){CSS.show(a);d.focus();if(!c.isViewer&&c.isReply){var f=MentionsInput.getInstance(d);if(f){var g=f.getMentions();if(!g[c.uid]&&Input.getValue(d)===''){f.addMention(c);Input.setValue(d,Input.getValue(d)+' ');}}else Input.setValue(d,c.text+' ');}e.preventDefault();});},resetInput:function(a){var b=MentionsInput.getInstance(a);if(b){b.reset({flattened:'',mention_data:{}});}else Input.setValue(a,'');}});if(!window.Feedback.comments)window.Feedback.comments={};
function PaymentsFlowsBase(a){this.context_id=a;}copyProperties(PaymentsFlowsBase.prototype,{DIALOG_ENDPOINT:'/fbml/ajax/dialog/',ASYNC_ENDPOINT:'/ajax/flows/',oscifPrices:{},methodConfigs:{},itemUpdateNeeded:false,context_id:null,anySelectedMethod:{},onPurchaseSubmit:function(a,b){this.disableButton(this.ADD_CREDITS_BUTTON);if(!a)a=this.getPaymentMethod();var c=this.methodConfigs[a];if(c&&c.open_popup){if(!b.add_num_credits)b.add_num_credits=this.getAddNumCredits();this.openPopup(c,b);return false;}var d=this.getPricepointDropdown(a),e={};if(d)e.provider_add_num_credits=d.value;this.submitDialogRequest(e);return false;},forceFlowStep:function(a,b){b=b?b:{};b.force_flow_step=a;this.submitDialogRequest(b);return false;},updatePricepoints:function(){var a=this.getFormData(),b=function(c){DOM.setContent(ge(PaymentsFlows.BANK_PRICEPOINTS),HTML(c.getPayload()));};if(!a.currency)return;this.submitAsyncRequest({currency:a.currency,update_pricepoints:1},b);},updateItem:function(){var a=function(c){DOM.setContent(ge(PaymentsFlows.ITEM_ID),HTML(c.getPayload()));},b=this.getPaymentMethod();this.submitAsyncRequest({payment_method:b,amount:this.getAddNumCredits(),country_update:this.getCountryUpdate(b),update_item:1},a);},oscifUpdateMobileCountry:function(){var a=function(d){var e=d.getPayload();if(e){var f=e.item_update,g=e.dropdowns_update,h=e.is_price_only?ge(PaymentsFlows.ITEM_PRICE_ID):ge(PaymentsFlows.ITEM_ID);h&&DOM.setContent(h,HTML(f));var i=ge(PaymentsFlows.MOBILE_DROPDOWN_CONTAINER);i&&DOM.replace(i,HTML(g));}},b=this.getPaymentMethod(),c=this.getCountryUpdate(b);this.submitAsyncRequest({payment_method:b,amount:this.getAddNumCredits(),country_update:c,update_item_and_dropdowns:1},a);},onUpdatePaymentMethod:function(a,b){this.anySelectedMethod[a]=1;for(var c in this.anySelectedMethod){var d=this.getDropdownContainer(c);d&&CSS.conditionShow(d,a==c);}if(b){this.itemUpdateNeeded&&this.updateItem(a);}else{var e=$('payment_body_and_buttons'),f=DOM.scry(e,'.default_pricepoint'),g=false;for(var h=0;h<f.length;h++)g=g||f[h].id.lastIndexOf(a)!=-1;f=DOM.scry(e,'.local_cur_amt');for(var i=0;i<f.length;i++)CSS.conditionShow(f[i],g);}},setPaymentMethodConfig:function(a){this.methodConfigs=a;},setOscifPriceConfig:function(a){this.oscifPrices=a;},setItemUpdateNeeded:function(a){this.itemUpdateNeeded=a;},getPaymentMethod:function(){var a=this.getFormData();return a.payment_method;},getAddNumCredits:function(){var a=this.getFormData();if(a.add_num_credits)return a.add_num_credits;return this.getOscifAddNumCredits();},getOscifAddNumCredits:function(){var a=this.getPaymentMethod(),b=this.getPricepointDropdown(a);if(!b){return this.oscifPrices.price;}else return parseInt(b.value,10);},getCountryUpdate:function(a){country_update=ge(a+'_country_dropdown');if(country_update)country_update=country_update.value;return country_update;},getPricepointDropdown:function(a){return ge(a+'_dropdown');},getDropdownContainer:function(a){return ge(a+'_dropdown_container');},submitAsyncRequest:function(a,b){a.context=this.getFormData().context;var c=new AsyncRequest().setURI(this.ASYNC_ENDPOINT).setHandler(b).setData(a).send();},ADD_CREDITS_BUTTON:'add_credits',OSCIF_BALANCE_CHECKBOX:'sweep_balance',OSCIF_CHECKBOX_TOOLTIP:'checkbox-tooltip',OSCIF_PRICE_TOOLTIP:'price-tooltip',OSCIF_PRICE:'price',BANK_POPUP_BLOCK_MESSAGE:'popup_message',SECURITY_VERI_TEXT:'password_popup',SECURITY_VERI_FAILED_TEXT:'password_failed',BANK_PRICEPOINTS:'payment_pricepoints',ITEM_ID:'fbpayments_item',ITEM_PRICE_ID:'fbpayments_item_price',MOBILE_DROPDOWN_CONTAINER:'mobile_dropdown_container',BOOST_PRICE:'boost_price',BOOST_BUTTON:'boost',SYNC_BUTTON:'sync_card',openPopup:function(a,b){},processPopup:function(a){},processIFrame:function(a){},getFormData:function(){},submitDialogRequest:function(a){},enableButton:function(a){},disableButton:function(a){},changeButtonText:function(a,b){},showSecurityVeriFailed:function(){ge(this.SECURITY_VERI_TEXT)&&CSS.hide(this.SECURITY_VERI_TEXT);ge(this.SECURITY_VERI_FAILED_TEXT)&&CSS.show(this.SECURITY_VERI_FAILED_TEXT);},iFrameTimerId:0,iFrameTimeout:5000,checkPayThreshold:10,checkPayInterval:2000,checkPayCount:0,checkPaymentStatus:function(){var a=function(){ge('checking_payment_status')&&CSS.show('checking_payment_status');var c=PaymentsFlows.checkPayCount>=PaymentsFlows.checkPayThreshold,d={force_async_notify:+c,payment_provider_completed:1,check_pay_count:PaymentsFlows.checkPayCount};if(c){PaymentsFlows.checkPayCount=0;PaymentsFlows.submitDialogRequest(d,'checkPayment');}else PaymentsFlows.submitAsyncRequest(d,b);},b=function(c){var d=c.getPayload();ge('checking_payment_status')&&CSS.hide('checking_payment_status');PaymentsFlows.checkPayCount++;if(d.awaiting_payment){ge('payment_progress_bar')&&DOM.setContent($('payment_progress_bar'),HTML(d.progress_bar));setTimeout(a,PaymentsFlows.checkPayInterval);}else{PaymentsFlows.checkPayCount=0;new Dialog().setTitle(d.title).setBody(d.body).setButtons(d.buttons).setWideDialog(true).show();}};setTimeout(a,this.checkPayInterval);},iFrameInit:function(a){if(a){var b=function(){c.unsubscribe();clearTimeout(PaymentsFlows.iFrameTimerId);},c=Arbiter.subscribe('Connect.Unsafe.PAYMENT_PROVIDER_INIT',b.bind(this)),d=function(){b();var e={payment_provider_error:1,payment_provider_ec:1,payment_provider_msg:'Provider timed out'};PaymentsFlows.forceFlowStep('WalletFlow',e);};d.defer(this.iFrameTimeout);}}});
function PaymentsFlowsAsync(a){this.parent.construct(this,a);}Class.extend(PaymentsFlowsAsync,'PaymentsFlowsBase');copyProperties(PaymentsFlowsAsync.prototype,{forceFlowStep:function(a,b){this.closePopup();return this.parent.forceFlowStep(a,b);},popup:null,pollingInterval:100,popupTimerId:0,_setupPopupOpenChecks:function(a,b){this.popupTimerId=setInterval(function(){if(!a())this.onPopupClose(b);}.bind(this),this.pollingInterval);if(!a()){this.showBlockedPopupMessage();this.enableButton(b);}else this.hideBlockedPopupMessage();},_showPopup:function(a,b){var c=800,d=550,e=1,f=1,g=1;if(b!=null)if(b.is_paypal_digital_goods_flow){c=420;d=550;e=0;f=0;g=0;}else if(b.is_paypal){c=955;d=750;}else if(b.is_promotion){c=550;d=800;}var h=0,i=0;if(window.screenLeft){h=window.screenLeft;i=window.screenTop;}else if(window.screenX){h=window.screenX;i=window.screenY;}var j=Vector2.getViewportDimensions().x,k=Vector2.getViewportDimensions().y;h=h+(j-c)/2;i=i+(k-d)/2;this.popup=window.open(a.toString(),'CreditsFlowPopupWindow','location=yes,'+'top='+i+','+'left='+h+','+'width='+c+','+'height='+d+','+'resizable='+e+','+'toolbar='+f+','+'menubar='+g+','+'scrollbars=yes',true);},openPopup:function(a,b){var c;if(b.is_sync_flow){uri=URI("/giftcredits/index.php");uri.setDomain(URI.getRequestURI().getDomain());uri.setProtocol('https');uri.addQueryData(uri.addQueryData({context_id:b.context_id}));uri.addQueryData({is_redirect_secure:URI.getRequestURI().isSecure()});c=this.SYNC_BUTTON;this.disableButton(c);}else{var d=a.popup_url;uri=URI(d);uri.addQueryData(b);uri.addQueryData({use_payment_engine:a.use_payment_engine});c=this.ADD_CREDITS_BUTTON;}this._showPopup(uri,a);this._setupPopupOpenChecks(function(){return this.popup&&(!this.popup.closed);}.bind(this),c);return false;},onPopupClose:function(a){if(this.popupTimerId!==0){clearInterval(this.popupTimerId);this.popupTimerId=0;}this.enableButton(a);},closePopup:function(a){this.onPopupClose(this.ADD_CREDITS_BUTTON);if(this.popup){this.popup.close();if(!this.popup.closed){var b=new URI('/payments/message.php');if(!a)b.addQueryData('cancel',1);this.popup.location=b.toString();}this.popup=null;}},processGiftcardIFrame:function(a){if(a.gc_result_code==="0"&&a.gc_fwd_url){window.goURI(a.gc_fwd_url);return false;}return true;},processIFrame:function(a){if(!this.processGiftcardIFrame(a))return;this.closePopup(!a.cancel);this.enableButton(this.ADD_CREDITS_BUTTON);if(!a.cancel){if(a.change_method){this.forceFlowStep('WalletFlow');}else this.submitDialogRequest(a);}else{if(a.cancel_dialog){this.submitDialogRequest({cancel:'cancel'});return false;}this.showSecurityVeriFailed();}},processPopup:function(a){if(!a.cancel&&a.context_id!=this.context_id)return;this.processIFrame(a);},getFormData:function(){var a=Dialog.getCurrent();return a.getFormData();},submitDialogRequest:function(a){var b=Dialog.getCurrent(),c=b.getBody();Form.createHiddenInputs(a,c);b._submitForm('POST',this.DIALOG_ENDPOINT);},enableButton:function(a){var b=Dialog.getCurrent(),c=b.getButtonElement(a);c&&Button.setEnabled(c,true);},disableButton:function(a){var b=Dialog.getCurrent(),c=b.getButtonElement(a);c&&Button.setEnabled(c,false);},changeButtonText:function(a,b){var c=Dialog.getCurrent(),d=c.getButtonElement(a);d&&Button.setLabel(d,b);},showBlockedPopupMessage:function(){var a=ge(this.BANK_POPUP_BLOCK_MESSAGE);if(a)CSS.show(a);},hideBlockedPopupMessage:function(){var a=ge(this.BANK_POPUP_BLOCK_MESSAGE);if(a)CSS.hide(a);}});
GiftCredits={dialog:null,callback:null,purchaseLock:false,purchaseLockExpiryThreshold:5000,purchaseLockTimeoutId:null,cancelSurveyId:null,promoAppId:null,getPurchaseCreditPrompt:function(a,b,c,d){GiftCredits.main(a,null,null,null,c,null,null,null,'BuyCredits',{},d);},getPurchaseCreditPromptPopup:function(a,b,c){var d=550,e=150,f=typeof window.screenX!='undefined'?window.screenX:window.screenLeft,g=typeof window.screenY!='undefined'?window.screenY:window.screenTop,h=typeof window.outerWidth!='undefined'?window.outerWidth:document.documentElement.clientWidth,i=typeof window.outerHeight!='undefined'?window.outerHeight:(document.documentElement.clientHeight-22),j=(f<0)?window.screen.width+f:f,k=parseInt(j+((h-d)/2),10),l=parseInt(g+((i-e)/2.5),10),m=('width='+d+',height='+e+',left='+k+',top='+l+',scrollbars=1'),n=URI().setSubdomain('www').setPath('/dialog/pay').addQueryData({app_id:a,action:'BuyCredits',next:'http://www.facebook.com/',display:'popup',internal_popup:'true',dev_purchase_params:JSON.stringify(b),additional_params:JSON.stringify(c)}).toString();window.open(n,'pay',m);},redeemGiftcard:function(a,b){GiftCredits.main(a,null,null,document.location.toString(),null,null,null,null,'RedeemGiftcard',{},b);},getPrompt:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){GiftCredits.main(a,b,c,d,e,f,g,h,i,j,k,l,m,n);},main:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){if(GiftCredits.isPurchaseLocked())return false;GiftCredits.setPurchaseLock(true);var o={_path:'pay',method:'pay',display:'async',app_id:a,receiver:b,api_key:g,credits_purchase:n,action:i,next:d,dev_purchase_params:JSON.stringify(j),additional_params:JSON.stringify(k),order_info:JSON.stringify(c),product:l,package_id:m,canvas_url_path:document.location.pathname},p=new AsyncRequest().setURI('/fbml/ajax/dialog/').setData(o).setMethod('GET').setReadOnly(true).setStatusElement('commerce_get_more_loading');GiftCredits.callback=e;GiftCredits.dialog=new Dialog().setAsync(p).setModal(true).setCancelHandler(GiftCredits.onCancel).setCloseHandler(e).show();},onCancel:function(a){var b=Dialog.getCurrent();if(b&&!(b.getButtonElement(Dialog.CANCEL)||a))return false;if(GiftCredits.callback){var c={error_code:1383010,error_message:'User canceled the order.'};GiftCredits.callback(c);}GiftCredits.setPurchaseLock(false);if(a)GiftCredits.dialog.hide();if(GiftCredits.cancelSurveyId){var d=new AsyncRequest("/survey/surveyDialog").setData({survey_id:GiftCredits.cancelSurveyId});new Dialog().setAsync(d).show();}else if(GiftCredits.promoAppId){var e=URI('/payments/promotion/').setSubdomain('www').setQueryData({app_id:GiftCredits.promoAppId,placement:'cancel_button',package_name:'zero_promo'});new PaymentsFlowsAsync(0)._showPopup(e,{is_promotion:true});}},isPurchaseLocked:function(){return GiftCredits.purchaseLock;},setPurchaseLock:function(a){GiftCredits.purchaseLock=a;if(a){GiftCredits.purchaseLockTimeoutId=setTimeout(function(){GiftCredits.setPurchaseLock(false);},GiftCredits.purchaseLockExpiryThreshold);}else clearTimeout(GiftCredits.purchaseLockTimeoutId);return true;}};function triggerCreditsPromptFromXd(a,b){callback=function(c){XD.send({response:JSON.stringify(c)},b.channel);};GiftCredits.getPrompt(b.app_id,b.receiver,b.order_info,b.back_url,callback,null,null,null,b.action,b.dev_purchase_params,b.additional_params,b.product,b.subscription_id,b.credits_purchase);}onloadRegister_DEPRECATED(function(){Arbiter.subscribe('Connect.Unsafe.Pay.Prompt',triggerCreditsPromptFromXd);});
__d("CanvasIFrameLogger",["reportData"],function(a,b,c,d,e,f){var g=b('reportData'),h={log:function(i,j,k){var l={tti_ms:i,app_id:j,is_early_flush:!!a._is_auto_flush,browser:k||'unknown'};g('app_tti',{gt:l});}};e.exports=h;});
__d("DOMEventListener",[],function(a,b,c,d,e,f){var g,h;if(window.addEventListener){g=function(j,k,l){j.addEventListener(k,l,false);};h=function(j,k,l){j.removeEventListener(k,l,false);};}else if(window.attachEvent){g=function(j,k,l){j.attachEvent('on'+k,l);};h=function(j,k,l){j.detachEvent('on'+k,l);};}var i={add:function(j,k,l){g(j,k,l);return {remove:function(){h(j,k,l);j=null;}};},remove:h};e.exports=i;});
__d("PluginPerms",["DOMEvent","DOMEventListener","PopupWindow","URI","bind","copyProperties"],function(a,b,c,d,e,f){var g=b('DOMEvent'),h=b('DOMEventListener'),i=b('PopupWindow'),j=b('URI'),k=b('bind'),l=b('copyProperties');function m(n,o){l(this,{return_params:j.getRequestURI().getQueryData(),login_params:{},perms_params:{},perms:[],plugin:n,app:o});this.addReturnParams({ret:'perms'});delete this.return_params.hash;}l(m.prototype,{addReturnParams:function(n){l(this.return_params,n);},addLoginParams:function(n){l(this.login_params,n);},addPermsParams:function(n){l(this.perms_params,n);},addPerms:function(n){this.perms.push.apply(this.perms,n);},start:function(){var n=j('/dialog/plugin.perms').addQueryData(this.perms_params).addQueryData({display:'popup',app_id:this.app,perms:this.perms.join(','),secure:j.getRequestURI().isSecure(),social_plugin:this.plugin,return_params:JSON.stringify(this.return_params),login_params:JSON.stringify(this.login_params)});this.popup=i.open(n.toString(),210,450);h.add(window,'message',function(event){if((/\.facebook\.com$/).test(event.origin))if(/^FB_POPUP:/.test(event.data)){var o=JSON.parse(event.data.substring(9));if('reload' in o)document.location.replace(o.reload);}});}});m.starter=function(n,o,p,q,r,s){var t=new m(n,o);t.addReturnParams(q||{});t.addLoginParams(r||{});t.addPermsParams(s||{});t.addPerms(p||[]);return k(t,t.start);};m.listen=function(n,o,p,q,r,s,t){h.add(n,'click',function(u){new g(u).kill();m.starter(o,p,q,r,s,t)();});};e.exports=m;});
__d("UnverifiedXD",["XD","XDUnverifiedChannel"],function(a,b,c,d,e,f){var g=b('XD').UnverifiedXD,h=c('XDUnverifiedChannel').channel;g.init({channelUrl:h});e.exports=g;});
__d("PluginResize",["Log","UnverifiedXD","bind","copyProperties","curry"],function(a,b,c,d,e,f){var g=b('Log'),h=b('UnverifiedXD'),i=b('bind'),j=b('copyProperties'),k=b('curry');function l(o){o=o||document.body;return o.offsetWidth+o.offsetLeft;}function m(o){o=o||document.body;return o.offsetHeight+o.offsetTop;}function n(o,p,event){this.calcWidth=o||l;this.calcHeight=p||m;this.width=undefined;this.height=undefined;this.event=event||'resize';}j(n.prototype,{resize:function(){var o=this.calcWidth(),p=this.calcHeight();if(o!==this.width||p!==this.height){g.debug('Resizing Plugin: (%s, %s, %s)',o,p,this.event);this.width=o;this.height=p;h.send({type:this.event,width:o,height:p});}return this;},auto:function(o){setInterval(i(this,this.resize),o||250);return this;}});n.auto=function(o,event,p){return new n(k(l,o),k(m,o),event).resize().auto(p);};n.autoHeight=function(o,p,event,q){return new n(function(){return o;},k(m,p),event).resize().auto(q);};e.exports=n;});
__d("PluginShareButton",["DOMEvent","DOMEventListener","PluginResize","PopupWindow","UserAgent"],function(a,b,c,d,e,f){var g=b('DOMEvent'),h=b('DOMEventListener'),i=b('PluginResize'),j=b('PopupWindow'),k=b('UserAgent'),l={listen:function(m,n){var o=m.href;h.add(m,'click',function(p){new g(p).kill();j.open(o,340,670);});},resize:function(m){var n=k.firefox()||k.ie()>=9?1:0;new i(function(){return m.offsetWidth+m.offsetLeft+n;},function(){return m.offsetHeight+m.offsetTop;}).resize().auto();}};e.exports=l;});
__d("PluginXDReady",["Arbiter","UnverifiedXD"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('UnverifiedXD'),i={handleMessage:function(j){if(!j.method)return;try{g.inform('Connect.Unsafe.'+j.method,JSON.parse(j.params),g.BEHAVIOR_PERSISTENT);}catch(k){}}};a.XdArbiter=i;h.send({xd_action:'plugin_ready',name:window.name});e.exports=null;});
WidgetArbiter={_findSiblings:function(){if(WidgetArbiter._siblings)return;WidgetArbiter._siblings=[];for(var a=parent.frames.length-1;a>=0;a--)try{if(parent.frames[a]&&parent.frames[a].Arbiter&&parent.frames[a].Arbiter.inform)WidgetArbiter._siblings.push(parent.frames[a].Arbiter);}catch(b){}},inform:function(){WidgetArbiter._findSiblings();var a=$A(arguments);WidgetArbiter._siblings.forEach(function(b){b.inform.apply(b,a);});}};
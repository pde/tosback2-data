var RE={"%09":/\t/g,"%20":/ /g,"%23":/\#/g,"%26":/\&/g,"%2B":/\+/g,"%3F":/\?/g,"%5C":/\\/g};function getQuerystring(key,default_){if(default_==null){default_="";}key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)");var qs=regex.exec(window.location.href);if(qs==null){return default_;}else{return qs[1];}}function GetQueryString(key){var hu=window.location.search.substring(1);var gy=hu.split("&");var ft;var len=gy.length;for(i=0;i<len;i++){ft=gy[i].split("=");if(ft[0]==key){return ft[1];}}}var baseUrl=GetBaseUrl();function GetBaseUrl(){var elems;var strBaseUrl="";var docAll=document.all;if(docAll){elems=docAll.tags("meta");}else{if(document.documentElement){elems=document.getElementsByTagName("meta");}}if(typeof(elems)!="undefined"){var len=elems.length;for(var i=1;i<=len;i++){var meta=elems.item(i-1);if(meta.name){if(meta.name.indexOf("BaseUrl")==0){strBaseUrl=meta.content;}}}}return strBaseUrl;}$.ajaxSetup({type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",processData:false,dataFilter:function(data){var msg;if(typeof(JSON)!=="undefined"&&typeof(JSON.parse)==="function"){msg=JSON.parse(data);}else{msg=eval("("+data+")");}if(msg.hasOwnProperty("d")){return msg.d;}else{return msg;}}});function SelectedItemCheckWishList(ddlOther,ddlSize,ddlColor){var bNoErrors=true;if(ddlOther.style.display=="block"){if(ddlOther.options[0].selected){bNoErrors=false;}}if(ddlSize.style.display=="block"){if(ddlSize.options[0].selected){bNoErrors=false;}}if(ddlColor.style.display=="block"){if(ddlColor.options[0].selected){bNoErrors=false;}}if(bNoErrors){$("#SelectItemFavorites").animate({height:0},500);return true;}else{$("#SelectItemFavorites").animate({height:30},500);return false;}}function IsSku(ItemNumber){var bReturnValue=false;if(typeof window.GetSkuCtrlPrefix=="function"){var ControlID=GetSkuCtrlPrefix("hidIsSku"+ItemNumber);var bIsSku=document.getElementById(ControlID);if(bIsSku!=null){bReturnValue=true;}}return bReturnValue;}function SelectedItemCheckShoppingCart(ddlOther,ddlSize,ddlColor){var bNoErrors=true;if(ddlOther.style.display=="block"){if(ddlOther.options[0].selected){bNoErrors=false;}}if(ddlSize.style.display=="block"){if(ddlSize.options[0].selected){bNoErrors=false;}}if(ddlColor.style.display=="block"){if(ddlColor.options[0].selected){bNoErrors=false;}}if(bNoErrors){$("#SelectItemCart").animate({height:0},500);return true;}else{$("#SelectItemCart").animate({height:30},500);return false;}}function checkEnsembleAddToCart(){var bNoErrors=false;var ListOfItems=new Array();var index=0;$(".qtyTextBox").each(function(idx,item){if(item.value!=""){if(!isNaN(item.value)){if(item.value>0){bNoErrors=true;ListOfItems[index]=new Array(5);ListOfItems[index][0]=item.id.substr(item.id.length-5);ListOfItems[index][1]=item.value;index+=1;}else{bNoErrors=false;return false;}}else{bNoErrors=false;return false;}}});var ItemNumber;var ddlOther;var ddlSize;var ddlColor;if(ListOfItems.length>0){var len=ListOfItems.length;for(i=0;i<len;i++){if(IsSku(ListOfItems[i][0])){ItemNumber=ListOfItems[i][0];ddlOther=document.getElementById(GetSkuCtrlPrefix("ddlOther"+ItemNumber));ddlSize=document.getElementById(GetSkuCtrlPrefix("ddlSize"+ItemNumber));ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+ItemNumber));if(SelectedItemCheckShoppingCart(ddlOther,ddlSize,ddlColor)){if(ddlOther!=null){if(ddlOther.style.display=="block"){ListOfItems[i][2]=$("#"+GetSkuCtrlPrefix("ddlOther"+ItemNumber)+" option:selected").val();}}if(ddlSize!=null){if(ddlSize.style.display=="block"){ListOfItems[i][3]=$("#"+GetSkuCtrlPrefix("ddlSize"+ItemNumber)+" option:selected").val();}}if(ddlColor!=null){if(ddlColor.style.display=="block"){ListOfItems[i][4]=$("#"+GetSkuCtrlPrefix("ddlColor"+ItemNumber)+" option:selected").val();}}}else{bNoErrors=false;}}}}if(bNoErrors){$("#dvSelectBtm").animate({height:0},200);$("#dvSelectTop").animate({height:0},200);return ListOfItems;}else{$("#dvSelectBtm").animate({height:25},200);$("#dvSelectTop").animate({height:25},200);return null;}}function ToggleDescriptionById(prodId){if(eval("pv_descToggle_"+prodId)==false){$("#dvDescToggle_"+prodId).animate({height:225},500);window["pv_descToggle_"+prodId]=true;document.getElementById("aDescToggle_"+prodId).innerHTML="Hide Product Details";}else{$("#dvDescToggle_"+prodId).animate({height:0},500);window["pv_descToggle_"+prodId]=false;document.getElementById("aDescToggle_"+prodId).innerHTML="View Product Details";}}function imageProtectMouseDown(){if(window.event.button=="2"){var d=new Date();window.alert("Copyright "+d.getFullYear()+" Winston Brands Inc.  All Rights Reserved.  Reproduction in part or in whole is strictly prohibited.");}}var QASWindow;function popUpQAS(URL){var id="QASWindow";if(QASWindow&&QASWindow.open){QASWindow.close;}QASWindow=window.open(baseUrl+URL,id,"toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=400,left = 299.5,top = 150");}function PopUpLargerView(url){var newWin=window.open(baseUrl+url,"win","toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=1,resizable=1,height=600px,width=800px");self.name="newWin";}function popUp(URL){popUpWidthHeight(URL,500,400,0);}function popUp(URL,scroll){popUpWidthHeight(URL,500,400,1);}function VerisignPopUp(url){sealWin=window.open(url,"win","toolbar=0,location=1,directories=0,status=1,menubar=1,scrollbars=1,resizable=1,width=515,height=470");self.name="mainWin";}function popUpWidthHeight(URL,strWidth,strHeight,scroll){var day=new Date();var id=day.getTime();eval("page"+id+" = window.open(baseUrl + URL, '"+id+"', 'toolbar=0,scrollbars="+scroll+",location=0,statusbar=0,menubar=0,resizable=0,width="+strWidth+",height="+strHeight+",left=209.5,top=120');");}function UpdatePrice(price){document.frmMain.price.value=price;}function AddToBasketProductContent(){var qtyBox=document.getElementById("quantity");var quantity=qtyBox.options[qtyBox.selectedIndex].value;var itemNumber=document.getElementById("itemnumber").value;var price=document.getElementById("price").value;document.location.href=baseUrl+"shopCart.aspx?Add=TRUE&Item="+itemNumber+"&Price="+price+"&Qty="+quantity+"&SubTotal="+(price*quantity);}function Trim(value){return $.trim(value);}String.prototype.trim=function(){return Trim(this);};function ClearText(a){var b="InputBoxBlack";if(a.className.indexOf("FormInput")>-1){b=b+" FormInput";}switch(a.value){case"Type Gift Message":a.value="";a.className=b;break;case"Enter Promo Code":a.value="";a.className=b;break;case"Search keyword or item #":a.value="";break;case"Enter Email Address":a.value="";a.className=b;break;case"MyEmail@Website.com":a.value="";a.className=b;break;case"Type your gift message here.":a.value="";a.className=b;break;default:}}function checkValidity(a){var b=null;if(a=="top"){b=document.getElementById("NttTop");}else{if(a=="btm"){b=document.getElementById("NttBtm");}else{b=document.getElementById("NttSub");}}var c=b.value;var d=0;var e="";e=c.replace(new RegExp("<","g"),"");e=e.replace(new RegExp(">","g"),"");var len=c.length;for(y=0;y<len;y++){if(c.charAt(y)==" "){d++;}}if(d==e.length||e.length==0||e=="Search keyword or item #"){alert("Please enter a Keyword or an Item #.");return false;}else{var f=e.trim().replace(/&/g,"amp").replace(/-/g,"^").replace(/ /g,"-").replace("/","%7C");var g=GetBaseUrl();if(a=="top"){var h=document.getElementById("searchTop");h.action=g+f+"/search.aspx";h.submit();}else{if(a=="btm"){var i=document.getElementById("searchBtm");i.action=g+f+"/search.aspx";i.submit();}else{var j=document.getElementById("searchSub");j.action=g+f+"/search.aspx";j.submit();}}}}function emailCheck(a){var b=/^(.+)@(.+)$/;var c='\\(\\)<>@,;:\\\\\\"\\.\\[\\]';var d="[^\\s"+c+"]";var e='("[^"]*")';var f=/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/;var g=d+"+";var h="("+g+"|"+e+")";var j=new RegExp("^"+h+"(\\."+h+")*$");var k=new RegExp("^"+g+"(\\."+g+")*$");var l=a.match(b);if(l==null){return false;}var m=l[1];var n=l[2];if(m.match(j)==null){return false;}var o=n.match(f);if(o!=null){for(var i=1;i<=4;i++){if(o[i]>255){return false;}}return true;}var p=n.match(k);if(p==null){return false;}var q=new RegExp(g,"g");var r=n.match(q);var s=r.length;if(r[r.length-1].length<2||r[r.length-1].length>3&&r[r.length-1]!="coop"){return false;}if(s<2){var t="This address is missing a hostname!";return false;}return true;}function checkFormSubmit(a){var b=null;if(a=="top"){b=document.getElementById("txtemailtop");var errorTop=document.getElementById("errorTop");if(emailCheck(b.value)){if(document.all){errorTop.innerText="";}else{errorTop.textContent="";}return true;}else{if(document.all){errorTop.innerText="Invalid email address.";}else{errorTop.textContent="Invalid email address.";}return false;}}else{b=document.getElementById("txtemailbtm");var errorBtm=document.getElementById("errorBtm");if(emailCheck(b.value)){if(document.all){errorBtm.innerText="";}else{errorBtm.textContent="";}return true;}else{if(document.all){errorBtm.innerText="Invalid email address.";}else{errorBtm.textContent="Invalid email address.";}return false;}}}function checkFormClick(a){if(checkFormSubmit(a)){var b=null;var c="";var d=document.getElementById("signUpUseg");if(d!=null){c=d.value;}if(a=="top"){b=document.getElementById("txtemailtop");if(c!=""){document.frmEmailClubTop.action=baseUrl+"SubscriptionLandingPage.aspx?email="+b.value+"&cm_lm="+b.value+"&useg="+c;}else{document.frmEmailClubTop.action=baseUrl+"SubscriptionLandingPage.aspx?email="+b.value+"&cm_lm="+b.value;}}else{b=document.getElementById("txtemailbtm");if(c!=""){document.frmEmailClubBtm.action=baseUrl+"SubscriptionLandingPage.aspx?email="+b.value+"&cm_lm="+b.value+"&useg="+c;}else{document.frmEmailClubBtm.action=baseUrl+"SubscriptionLandingPage.aspx?email="+b.value+"&cm_lm="+b.value;}}return true;}else{return false;}}function RegistrationFormClick(){var a="";var b=document.getElementById("registrantUseg");if(b!=null){a=b.value;}if(a!=""){document.aspnetForm.action=baseUrl+"CustomerRegistration.aspx?useg="+a;}else{document.aspnetForm.action=baseUrl+"CustomerRegistration.aspx";}return true;}function UpdateSkus(Skus,elem,skuType,sItemNumber){if(skuType=="Other"){if(!elem.options[0].selected){var i=0;var len=elem.options.length;for(var j=0;j<len;j++){if(elem.options[j].selected==true){i=j-1;}}if(Skus.Skus.Others[i].Sizes.length>0&&Trim(Skus.Skus.Others[i].Sizes[0].Text).length>0){var ddlSize=document.getElementById(GetSkuCtrlPrefix("ddlSize"+sItemNumber));ddlSize.disabled=false;ddlSize.length=0;var newDefaultOption=document.createElement("option");newDefaultOption.value="-1";newDefaultOption.text="Select Size";if($.browser.msie){if($.browser.version<8){newDefaultOption.text+="              ";}}try{ddlSize.add(newDefaultOption,null);}catch(ex){ddlSize.add(newDefaultOption);}var lenSizes=Skus.Skus.Others[i].Sizes.length;for(var k=0;k<lenSizes;k++){var newSizeOption=document.createElement("option");newSizeOption.value=Skus.Skus.Others[i].Sizes[k].Value;newSizeOption.text=Skus.Skus.Others[i].Sizes[k].Text;if(Skus.Skus.Others[i].Sizes[k].Text.indexOf("Sold Out")>-1){newSizeOption.disabled=true;}try{ddlSize.add(newSizeOption,null);}catch(ex){ddlSize.add(newSizeOption);}}ddlSize.options[0].selected=true;}else{if((Skus.Skus.Others[i].Sizes.length>0&&Trim(Skus.Skus.Others[i].Sizes[0].Text).length==0)||Skus.Skus.Others[i].Sizes[0].Colors.length>0){var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));ddlColor.disabled=false;ddlColor.length=0;var newDefaultOption=document.createElement("option");newDefaultOption.value="-1";newDefaultOption.text="Select Color";if($.browser.msie){if($.browser.version<8){newDefaultOption.text+="             ";}}try{ddlColor.add(newDefaultOption,null);}catch(ex){ddlColor.add(newDefaultOption);}var lenColors=Skus.Skus.Others[i].Sizes[0].Colors.length;for(var k=0;k<lenColors;k++){var newColorOption=document.createElement("option");newColorOption.value=Skus.Skus.Others[i].Sizes[0].Colors[k].Value;newColorOption.text=Skus.Skus.Others[i].Sizes[0].Colors[k].Text;if(Skus.Skus.Others[i].Sizes[0].Colors[k].Text.indexOf("Sold Out")>-1){newColorOption.disabled=true;}try{ddlColor.add(newColorOption,null);}catch(ex){ddlColor.add(newColorOption);}}ddlColor.options[0].selected=true;}}}else{var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));ddlColor.disabled=true;ddlColor.options[0].selected=true;var ddlSize=document.getElementById(GetSkuCtrlPrefix("ddlSize"+sItemNumber));ddlSize.disabled=true;ddlSize.options[0].selected=true;}}else{if(skuType="Size"){if(!elem.options[0].selected){var ddlOther=document.getElementById(GetSkuCtrlPrefix("ddlOther"+sItemNumber));var indexOther=0;var lenOther=ddlOther.options.length;for(var j=0;j<lenOther;j++){if(ddlOther.options[j].selected==true){indexOther=j-1;}}if(indexOther==-1){indexOther=0;}var indexSize=0;var lenSize=elem.options.length;for(var j=0;j<lenSize;j++){if(elem.options[j].selected==true){indexSize=j-1;}}if(Skus.Skus.Others[indexOther].Sizes[indexSize].Colors.length>0){var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));ddlColor.disabled=false;ddlColor.length=0;var newDefaultOption=document.createElement("option");newDefaultOption.value="-1";newDefaultOption.text="Select Color";if($.browser.msie){if($.browser.version<8){newDefaultOption.text+="             ";}}try{ddlColor.add(newDefaultOption,null);}catch(ex){ddlColor.add(newDefaultOption);}var lenColors=Skus.Skus.Others[indexOther].Sizes[indexSize].Colors.length;for(var k=0;k<lenColors;k++){var newColorOption=document.createElement("option");newColorOption.value=Skus.Skus.Others[indexOther].Sizes[indexSize].Colors[k].Value;newColorOption.text=Skus.Skus.Others[indexOther].Sizes[indexSize].Colors[k].Text;if(Skus.Skus.Others[indexOther].Sizes[indexSize].Colors[k].Text.indexOf("Sold Out")>-1){newColorOption.disabled=true;}try{ddlColor.add(newColorOption,null);}catch(ex){ddlColor.add(newColorOption);}}ddlColor.options[0].selected=true;}}else{var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));ddlColor.disabled=true;ddlColor.options[0].selected=true;}}}}function PopulateSkuSelects(Skus,sItemNumber){var ddlOther=document.getElementById(GetSkuCtrlPrefix("ddlOther"+sItemNumber));var ddlSize=document.getElementById(GetSkuCtrlPrefix("ddlSize"+sItemNumber));var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));SetIEDropDownFix(sItemNumber);if(Skus!=null){var lenOthers=Skus.Skus.Others.length;for(var i=0;i<lenOthers;i++){if(Skus.Skus.Others[0].Text.length!=0){var newOtherOption=document.createElement("option");newOtherOption.value=Skus.Skus.Others[i].Value;newOtherOption.text=Skus.Skus.Others[i].Text;if(Skus.Skus.Others[i].Text.indexOf("Sold Out")>-1){newOtherOption.disabled=true;}try{ddlOther.add(newOtherOption,null);}catch(ex){ddlOther.add(newOtherOption);}ddlOther.style.display="block";if(Skus.Skus.Others[i].Sizes.length>0){if(Skus.Skus.Others[i].Sizes[0].Text.length>0){ddlSize.style.display="block";if(Skus.Skus.Others[i].Sizes[0].Colors.length>0){ddlColor.style.display="block";}}else{if(Skus.Skus.Others[i].Sizes[0].Colors.length>0){ddlColor.style.display="block";}}}else{if(Skus.Skus.Others[i].Sizes[0].Colors.length>0){if(Skus.Skus.Others[i].Sizes[0].Colors[0].Text.length>0){ddlColor.style.display="block";}}}}}if(ddlOther.options.length==1){ddlOther.style.display="none";var lenSizes=Skus.Skus.Others[0].Sizes.length;for(var i=0;i<lenSizes;i++){if(Skus.Skus.Others[0].Sizes[i].Text.length!=0){var newSizeOption=document.createElement("option");newSizeOption.value=Skus.Skus.Others[0].Sizes[i].Value;newSizeOption.text=Skus.Skus.Others[0].Sizes[i].Text;if(Skus.Skus.Others[0].Sizes[i].Text.indexOf("Sold Out")>-1){newSizeOption.disabled=true;}try{ddlSize.add(newSizeOption,null);}catch(ex){ddlSize.add(newSizeOption);}ddlSize.style.display="block";ddlSize.disabled=false;if(Skus.Skus.Others[0].Sizes[0].Colors.length>0){if(Skus.Skus.Others[0].Sizes[0].Colors[0].Text.length>0){ddlColor.style.display="block";}}}}if(ddlSize.options.length==1){var lenColors=Skus.Skus.Others[0].Sizes[0].Colors.length;for(var i=0;i<lenColors;i++){if(Skus.Skus.Others[0].Sizes[0].Colors[i].Text.length!=0){var newColorOption=document.createElement("option");newColorOption.value=Skus.Skus.Others[0].Sizes[0].Colors[i].Value;newColorOption.text=Skus.Skus.Others[0].Sizes[0].Colors[i].Text;if(Skus.Skus.Others[0].Sizes[0].Colors[i].Text.indexOf("Sold Out")>-1){newColorOption.disabled=true;}try{ddlColor.add(newColorOption,null);}catch(ex){ddlColor.add(newColorOption);}ddlColor.style.display="block";ddlColor.disabled=false;}}}}}else{ddlOther.style.display="none";ddlSize.style.display="none";ddlColor.style.display="none";}}function SetIEDropDownFix(sItemNumber){var ddlOther=document.getElementById(GetSkuCtrlPrefix("ddlOther"+sItemNumber));var ddlSize=document.getElementById(GetSkuCtrlPrefix("ddlSize"+sItemNumber));var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));if($.browser.msie){$("select.DropDownList").each(function(){$(this).mousedown(function(){$(this).toggleClass("IESelectHack",true);}).blur(function(){$(this).toggleClass("IESelectHack",false);}).change(function(){$(this).toggleClass("IESelectHack",false);});});if($.browser.version<8){if(ddlOther.options[0].text=="Select Design"){ddlOther.options[0].text+="           ";}else{ddlOther.options[0].text+="              ";}ddlSize.options[0].text+="              ";ddlColor.options[0].text+="             ";}}}function UpdatePriceForSkus(sItemNumber){var ddlOther=document.getElementById(GetSkuCtrlPrefix("ddlOther"+sItemNumber));var ddlSize=document.getElementById(GetSkuCtrlPrefix("ddlSize"+sItemNumber));var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));var tmpPrice="";if(ddlColor.style.display=="block"){tmpPrice=$("#"+GetSkuCtrlPrefix("ddlColor"+sItemNumber)+" option:selected").text();}else{if(ddlSize.style.display=="block"){tmpPrice=$("#"+GetSkuCtrlPrefix("ddlSize"+sItemNumber)+" option:selected").text();}else{if(ddlOther.style.display=="block"){tmpPrice=$("#"+GetSkuCtrlPrefix("ddlOther"+sItemNumber)+" option:selected").text();}}}if(tmpPrice!=""){var startIndex=tmpPrice.indexOf("$")+1;var endIndex=tmpPrice.indexOf(".",startIndex)+2;endIndex=endIndex-startIndex+1;tmpPrice=tmpPrice.substr(startIndex,endIndex);}return tmpPrice;}function ShowPowerReviews(){$("#PopupContainer").css("display","block");$("#PowerReviews").fadeIn(300);}function SetPowerReviewsLink(id){var elem=document.getElementById(id);if(elem!=null){elem.href="javascript:ShowPowerReviews()";}}function ShowPowerReviewById(prodId){$("#PopupContainer").css("display","block");$("#PowerReviews_"+prodId).fadeIn(300);}function HidePopupPRbyId(prodId){$("#PowerReviews_"+prodId).fadeOut(300);$("#PopupContainer").css("display","none");}function HidePopupPR(){$("#PowerReviews").fadeOut(300);$("#PopupContainer").css("display","none");}function HidePopup(){$("#AddToCartPopup").fadeOut(300);$("#PopupContainer").css("display","none");}function ResetError(){$("#Loading").css("display","none");$("#AjaxError").css("display","none");$("#Top").html(" You have just added the following to your shopping cart:");$("#Top").removeClass("AjaxErrorTop");}function ShowError(result){$("#Loading").css("display","none");$("#AjaxError").css("display","block");$("#Top").html("WE APOLOGIZE FOR THE INCONVENIENCE…");$("#Top").addClass("AjaxErrorTop");}function RedirectToWishList(sItemNumber,sRelativeUrl){var hidItemNumber="";if(IsSku(sItemNumber)){var ddlOther=document.getElementById(GetSkuCtrlPrefix("ddlOther"+sItemNumber));var ddlSize=document.getElementById(GetSkuCtrlPrefix("ddlSize"+sItemNumber));var ddlColor=document.getElementById(GetSkuCtrlPrefix("ddlColor"+sItemNumber));var sRedirectParams="";if(SelectedItemCheckWishList(ddlOther,ddlSize,ddlColor)){if(ddlOther.style.display=="block"){sRedirectParams+="&Other="+$("#"+GetSkuCtrlPrefix("ddlOther"+sItemNumber)+" option:selected").val();}if(ddlSize.style.display=="block"){sRedirectParams+="&Size="+$("#"+GetSkuCtrlPrefix("ddlSize"+sItemNumber)+" option:selected").val();}if(ddlColor.style.display=="block"){sRedirectParams+="&Color="+$("#"+GetSkuCtrlPrefix("ddlColor"+sItemNumber)+" option:selected").val();}location.href="https:/"+sRelativeUrl+"wishlist.aspx?ItemNumber="+sItemNumber+"&Action=ADD"+sRedirectParams;}}else{location.href="https:/"+sRelativeUrl+"wishlist.aspx?ItemNumber="+sItemNumber+"&Action=ADD";}return false;}function GetSkuCtrlPrefix(elem){var prefix;var objCtrlPrefix=document.getElementById("skuCtrlPrefix");var newElem;$(".skuCtrlPrefix").each(function(idx,item){prefix="";newElem=document.getElementById(item.value+elem);if(newElem){prefix=item.value+elem;return false;}});return prefix;}function CheckSearch(url){var NttTop=$("#NttTop").val();NttTop=NttTop.replace(/^\s+|\s+$/g,"");var ajaxManager=$.manageAjax.create("ajaxManager",{queue:true,abortOld:true,url:url,cacheResponse:true,async:true});ajaxManager.clear("ajaxManager",{shouldAbort:true});if(NttTop.length>2){if(NttTop.trim()==NttTop){if(isNaN(NttTop.substring(1,3))){var dot="{'objSearchTerm': '"+NttTop.replace("'s","-s").replace("'","")+"'}";ajaxManager.add({data:dot,success:ShowSuggestion,error:ShowSearchError});}}}else{$("#Suggestions").empty();}}function CopyValueToSearch(){var newText=this.innerHTML.toLowerCase().replace("&amp;","&");newText=newText.replace(new RegExp("<b>","gi"),"");newText=newText.replace(new RegExp("</b>","gi"),"");$("#NttTop").val(newText);$("#Suggestions").empty();tSearch("top");}function ShowSuggestion(result){var NttTop=$("#NttTop").val();$("#Suggestions").empty();if(result.SearchResults.length>0){var divSuggestions=document.getElementById("Suggestions");var ulSuggestions=document.createElement("ul");ulSuggestions.id="ulSuggestions";var strSplit="";for(var i=0;i<result.SearchResults.length;i++){var liSearchTerm=document.createElement("li");if(result.SearchResults[i].Category==true){liSearchTerm.className="Category";}liSearchTerm.innerHTML=result.SearchResults[i].SearchTerm;strSplit=NttTop.split(" ");for(var j=0;j<strSplit.length;j++){if(strSplit[j]!=""&&strSplit[j]!="b"&&strSplit[j]!="/"){if(strSplit[j]=="&"){strSplit[j]="&amp;";}liSearchTerm.innerHTML=liSearchTerm.innerHTML.replace(new RegExp(strSplit[j],"gi"),"<b>"+strSplit[j].toUpperCase()+"</b>");}}liSearchTerm.onclick=CopyValueToSearch;ulSuggestions.appendChild(liSearchTerm);}divSuggestions.appendChild(ulSuggestions);$("#Suggestions").css("display","block");}}function ShowSearchError(){}function getCursorPosition(ctrl){var CaretPos=0;if(document.selection){ctrl.focus();var Sel=document.selection.createRange();Sel.moveStart("character",-ctrl.value.length);CaretPos=Sel.text.length;}else{if(ctrl.selectionStart||ctrl.selectionStart=="0"){CaretPos=ctrl.selectionStart;}}return(CaretPos);}function setCursorPosition(ctrl,pos){if(ctrl.setSelectionRange){ctrl.focus();ctrl.setSelectionRange(pos,pos);}else{if(ctrl.createTextRange){var range=ctrl.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select();}}}